var du=Object.defineProperty;var hu=(_,o,$)=>o in _?du(_,o,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[o]=$;var os=(_,o,$)=>(hu(_,typeof o!="symbol"?o+"":o,$),$),Co=(_,o,$)=>{if(!o.has(_))throw TypeError("Cannot "+$)};var jn=(_,o,$)=>(Co(_,o,"read from private field"),$?$.call(_):o.get(_)),xs=(_,o,$)=>{if(o.has(_))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(_):o.set(_,$)},zn=(_,o,$,j)=>(Co(_,o,"write to private field"),j?j.call(_,$):o.set(_,$),$),ao=(_,o,$,j)=>({set _(et){zn(_,o,et,$)},get _(){return jn(_,o,j)}});function _mergeNamespaces(_,o){for(var $=0;$<o.length;$++){const j=o[$];if(typeof j!="string"&&!Array.isArray(j)){for(const et in j)if(et!=="default"&&!(et in _)){const tt=Object.getOwnPropertyDescriptor(j,et);tt&&Object.defineProperty(_,et,tt.get?tt:{enumerable:!0,get:()=>j[et]})}}}return Object.freeze(Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const et of document.querySelectorAll('link[rel="modulepreload"]'))j(et);new MutationObserver(et=>{for(const tt of et)if(tt.type==="childList")for(const rt of tt.addedNodes)rt.tagName==="LINK"&&rt.rel==="modulepreload"&&j(rt)}).observe(document,{childList:!0,subtree:!0});function $(et){const tt={};return et.integrity&&(tt.integrity=et.integrity),et.referrerPolicy&&(tt.referrerPolicy=et.referrerPolicy),et.crossOrigin==="use-credentials"?tt.credentials="include":et.crossOrigin==="anonymous"?tt.credentials="omit":tt.credentials="same-origin",tt}function j(et){if(et.ep)return;et.ep=!0;const tt=$(et);fetch(et.href,tt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}function getAugmentedNamespace(_){if(_.__esModule)return _;var o=_.default;if(typeof o=="function"){var $=function j(){if(this instanceof j){var et=[null];et.push.apply(et,arguments);var tt=Function.bind.apply(o,et);return new tt}return o.apply(this,arguments)};$.prototype=o.prototype}else $={};return Object.defineProperty($,"__esModule",{value:!0}),Object.keys(_).forEach(function(j){var et=Object.getOwnPropertyDescriptor(_,j);Object.defineProperty($,j,et.get?et:{enumerable:!0,get:function(){return _[j]}})}),$}var jsxRuntimeExports={},jsxRuntime={get exports(){return jsxRuntimeExports},set exports(_){jsxRuntimeExports=_}},reactJsxRuntime_production_min={},reactExports={},react={get exports(){return reactExports},set exports(_){reactExports=_}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$3=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$2=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$2=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2(_){return _===null||typeof _!="object"?null:(_=z$2&&_[z$2]||_["@@iterator"],typeof _=="function"?_:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(_,o,$){this.props=_,this.context=o,this.refs=D$1,this.updater=$||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(_,o){if(typeof _!="object"&&typeof _!="function"&&_!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_,o,"setState")};E$1.prototype.forceUpdate=function(_){this.updater.enqueueForceUpdate(this,_,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(_,o,$){this.props=_,this.context=o,this.refs=D$1,this.updater=$||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$3={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(_,o,$){var j,et={},tt=null,rt=null;if(o!=null)for(j in o.ref!==void 0&&(rt=o.ref),o.key!==void 0&&(tt=""+o.key),o)J.call(o,j)&&!L$1.hasOwnProperty(j)&&(et[j]=o[j]);var nt=arguments.length-2;if(nt===1)et.children=$;else if(1<nt){for(var it=Array(nt),st=0;st<nt;st++)it[st]=arguments[st+2];et.children=it}if(_&&_.defaultProps)for(j in nt=_.defaultProps,nt)et[j]===void 0&&(et[j]=nt[j]);return{$$typeof:l$2,type:_,key:tt,ref:rt,props:et,_owner:K$3.current}}function N$2(_,o){return{$$typeof:l$2,type:_.type,key:o,ref:_.ref,props:_.props,_owner:_._owner}}function O$1(_){return typeof _=="object"&&_!==null&&_.$$typeof===l$2}function escape$3(_){var o={"=":"=0",":":"=2"};return"$"+_.replace(/[=:]/g,function($){return o[$]})}var P$1=/\/+/g;function Q$1(_,o){return typeof _=="object"&&_!==null&&_.key!=null?escape$3(""+_.key):o.toString(36)}function R$2(_,o,$,j,et){var tt=typeof _;(tt==="undefined"||tt==="boolean")&&(_=null);var rt=!1;if(_===null)rt=!0;else switch(tt){case"string":case"number":rt=!0;break;case"object":switch(_.$$typeof){case l$2:case n$2:rt=!0}}if(rt)return rt=_,et=et(rt),_=j===""?"."+Q$1(rt,0):j,I$1(et)?($="",_!=null&&($=_.replace(P$1,"$&/")+"/"),R$2(et,o,$,"",function(st){return st})):et!=null&&(O$1(et)&&(et=N$2(et,$+(!et.key||rt&&rt.key===et.key?"":(""+et.key).replace(P$1,"$&/")+"/")+_)),o.push(et)),1;if(rt=0,j=j===""?".":j+":",I$1(_))for(var nt=0;nt<_.length;nt++){tt=_[nt];var it=j+Q$1(tt,nt);rt+=R$2(tt,o,$,it,et)}else if(it=A$2(_),typeof it=="function")for(_=it.call(_),nt=0;!(tt=_.next()).done;)tt=tt.value,it=j+Q$1(tt,nt++),rt+=R$2(tt,o,$,it,et);else if(tt==="object")throw o=String(_),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return rt}function S$1(_,o,$){if(_==null)return _;var j=[],et=0;return R$2(_,j,"","",function(tt){return o.call($,tt,et++)}),j}function T$1(_){if(_._status===-1){var o=_._result;o=o(),o.then(function($){(_._status===0||_._status===-1)&&(_._status=1,_._result=$)},function($){(_._status===0||_._status===-1)&&(_._status=2,_._result=$)}),_._status===-1&&(_._status=0,_._result=o)}if(_._status===1)return _._result.default;throw _._result}var U$1={current:null},V$5={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$5,ReactCurrentOwner:K$3};react_production_min.Children={map:S$1,forEach:function(_,o,$){S$1(_,function(){o.apply(this,arguments)},$)},count:function(_){var o=0;return S$1(_,function(){o++}),o},toArray:function(_){return S$1(_,function(o){return o})||[]},only:function(_){if(!O$1(_))throw Error("React.Children.only expected to receive a single React element child.");return _}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r$3;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$2;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(_,o,$){if(_==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+_+".");var j=C$1({},_.props),et=_.key,tt=_.ref,rt=_._owner;if(o!=null){if(o.ref!==void 0&&(tt=o.ref,rt=K$3.current),o.key!==void 0&&(et=""+o.key),_.type&&_.type.defaultProps)var nt=_.type.defaultProps;for(it in o)J.call(o,it)&&!L$1.hasOwnProperty(it)&&(j[it]=o[it]===void 0&&nt!==void 0?nt[it]:o[it])}var it=arguments.length-2;if(it===1)j.children=$;else if(1<it){nt=Array(it);for(var st=0;st<it;st++)nt[st]=arguments[st+2];j.children=nt}return{$$typeof:l$2,type:_.type,key:et,ref:tt,props:j,_owner:rt}};react_production_min.createContext=function(_){return _={$$typeof:u,_currentValue:_,_currentValue2:_,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},_.Provider={$$typeof:t$2,_context:_},_.Consumer=_};react_production_min.createElement=M$1;react_production_min.createFactory=function(_){var o=M$1.bind(null,_);return o.type=_,o};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(_){return{$$typeof:v$2,render:_}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(_){return{$$typeof:y$2,_payload:{_status:-1,_result:_},_init:T$1}};react_production_min.memo=function(_,o){return{$$typeof:x$1,type:_,compare:o===void 0?null:o}};react_production_min.startTransition=function(_){var o=V$5.transition;V$5.transition={};try{_()}finally{V$5.transition=o}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(_,o){return U$1.current.useCallback(_,o)};react_production_min.useContext=function(_){return U$1.current.useContext(_)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(_){return U$1.current.useDeferredValue(_)};react_production_min.useEffect=function(_,o){return U$1.current.useEffect(_,o)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(_,o,$){return U$1.current.useImperativeHandle(_,o,$)};react_production_min.useInsertionEffect=function(_,o){return U$1.current.useInsertionEffect(_,o)};react_production_min.useLayoutEffect=function(_,o){return U$1.current.useLayoutEffect(_,o)};react_production_min.useMemo=function(_,o){return U$1.current.useMemo(_,o)};react_production_min.useReducer=function(_,o,$){return U$1.current.useReducer(_,o,$)};react_production_min.useRef=function(_){return U$1.current.useRef(_)};react_production_min.useState=function(_){return U$1.current.useState(_)};react_production_min.useSyncExternalStore=function(_,o,$){return U$1.current.useSyncExternalStore(_,o,$)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";(function(_){_.exports=react_production_min})(react);const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$2=reactExports,k$1=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$3=Object.prototype.hasOwnProperty,n$1=f$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1(_,o,$){var j,et={},tt=null,rt=null;$!==void 0&&(tt=""+$),o.key!==void 0&&(tt=""+o.key),o.ref!==void 0&&(rt=o.ref);for(j in o)m$3.call(o,j)&&!p$2.hasOwnProperty(j)&&(et[j]=o[j]);if(_&&_.defaultProps)for(j in o=_.defaultProps,o)et[j]===void 0&&(et[j]=o[j]);return{$$typeof:k$1,type:_,key:tt,ref:rt,props:et,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;(function(_){_.exports=reactJsxRuntime_production_min})(jsxRuntime);const Fragment=jsxRuntimeExports.Fragment,jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs;var client={},reactDomExports={},reactDom={get exports(){return reactDomExports},set exports(_){reactDomExports=_}},reactDom_production_min={},schedulerExports={},scheduler={get exports(){return schedulerExports},set exports(_){schedulerExports=_}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(_){function o($t,Ct){var xt=$t.length;$t.push(Ct);e:for(;0<xt;){var vt=xt-1>>>1,dt=$t[vt];if(0<et(dt,Ct))$t[vt]=Ct,$t[xt]=dt,xt=vt;else break e}}function $($t){return $t.length===0?null:$t[0]}function j($t){if($t.length===0)return null;var Ct=$t[0],xt=$t.pop();if(xt!==Ct){$t[0]=xt;e:for(var vt=0,dt=$t.length,wt=dt>>>1;vt<wt;){var qt=2*(vt+1)-1,Pt=$t[qt],Gt=qt+1,Wt=$t[Gt];if(0>et(Pt,xt))Gt<dt&&0>et(Wt,Pt)?($t[vt]=Wt,$t[Gt]=xt,vt=Gt):($t[vt]=Pt,$t[qt]=xt,vt=qt);else if(Gt<dt&&0>et(Wt,xt))$t[vt]=Wt,$t[Gt]=xt,vt=Gt;else break e}}return Ct}function et($t,Ct){var xt=$t.sortIndex-Ct.sortIndex;return xt!==0?xt:$t.id-Ct.id}if(typeof performance=="object"&&typeof performance.now=="function"){var tt=performance;_.unstable_now=function(){return tt.now()}}else{var rt=Date,nt=rt.now();_.unstable_now=function(){return rt.now()-nt}}var it=[],st=[],ot=1,at=null,ct=3,ut=!1,ft=!1,ht=!1,mt=typeof setTimeout=="function"?setTimeout:null,gt=typeof clearTimeout=="function"?clearTimeout:null,Et=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function St($t){for(var Ct=$(st);Ct!==null;){if(Ct.callback===null)j(st);else if(Ct.startTime<=$t)j(st),Ct.sortIndex=Ct.expirationTime,o(it,Ct);else break;Ct=$(st)}}function At($t){if(ht=!1,St($t),!ft)if($(it)!==null)ft=!0,bt(kt);else{var Ct=$(st);Ct!==null&&_t(At,Ct.startTime-$t)}}function kt($t,Ct){ft=!1,ht&&(ht=!1,gt(Dt),Dt=-1),ut=!0;var xt=ct;try{for(St(Ct),at=$(it);at!==null&&(!(at.expirationTime>Ct)||$t&&!Nt());){var vt=at.callback;if(typeof vt=="function"){at.callback=null,ct=at.priorityLevel;var dt=vt(at.expirationTime<=Ct);Ct=_.unstable_now(),typeof dt=="function"?at.callback=dt:at===$(it)&&j(it),St(Ct)}else j(it);at=$(it)}if(at!==null)var wt=!0;else{var qt=$(st);qt!==null&&_t(At,qt.startTime-Ct),wt=!1}return wt}finally{at=null,ct=xt,ut=!1}}var Rt=!1,Tt=null,Dt=-1,Ot=5,jt=-1;function Nt(){return!(_.unstable_now()-jt<Ot)}function It(){if(Tt!==null){var $t=_.unstable_now();jt=$t;var Ct=!0;try{Ct=Tt(!0,$t)}finally{Ct?yt():(Rt=!1,Tt=null)}}else Rt=!1}var yt;if(typeof Et=="function")yt=function(){Et(It)};else if(typeof MessageChannel<"u"){var lt=new MessageChannel,pt=lt.port2;lt.port1.onmessage=It,yt=function(){pt.postMessage(null)}}else yt=function(){mt(It,0)};function bt($t){Tt=$t,Rt||(Rt=!0,yt())}function _t($t,Ct){Dt=mt(function(){$t(_.unstable_now())},Ct)}_.unstable_IdlePriority=5,_.unstable_ImmediatePriority=1,_.unstable_LowPriority=4,_.unstable_NormalPriority=3,_.unstable_Profiling=null,_.unstable_UserBlockingPriority=2,_.unstable_cancelCallback=function($t){$t.callback=null},_.unstable_continueExecution=function(){ft||ut||(ft=!0,bt(kt))},_.unstable_forceFrameRate=function($t){0>$t||125<$t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ot=0<$t?Math.floor(1e3/$t):5},_.unstable_getCurrentPriorityLevel=function(){return ct},_.unstable_getFirstCallbackNode=function(){return $(it)},_.unstable_next=function($t){switch(ct){case 1:case 2:case 3:var Ct=3;break;default:Ct=ct}var xt=ct;ct=Ct;try{return $t()}finally{ct=xt}},_.unstable_pauseExecution=function(){},_.unstable_requestPaint=function(){},_.unstable_runWithPriority=function($t,Ct){switch($t){case 1:case 2:case 3:case 4:case 5:break;default:$t=3}var xt=ct;ct=$t;try{return Ct()}finally{ct=xt}},_.unstable_scheduleCallback=function($t,Ct,xt){var vt=_.unstable_now();switch(typeof xt=="object"&&xt!==null?(xt=xt.delay,xt=typeof xt=="number"&&0<xt?vt+xt:vt):xt=vt,$t){case 1:var dt=-1;break;case 2:dt=250;break;case 5:dt=1073741823;break;case 4:dt=1e4;break;default:dt=5e3}return dt=xt+dt,$t={id:ot++,callback:Ct,priorityLevel:$t,startTime:xt,expirationTime:dt,sortIndex:-1},xt>vt?($t.sortIndex=xt,o(st,$t),$(it)===null&&$t===$(st)&&(ht?(gt(Dt),Dt=-1):ht=!0,_t(At,xt-vt))):($t.sortIndex=dt,o(it,$t),ft||ut||(ft=!0,bt(kt))),$t},_.unstable_shouldYield=Nt,_.unstable_wrapCallback=function($t){var Ct=ct;return function(){var xt=ct;ct=Ct;try{return $t.apply(this,arguments)}finally{ct=xt}}}})(scheduler_production_min);(function(_){_.exports=scheduler_production_min})(scheduler);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca$1=schedulerExports;function p$1(_){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+_,$=1;$<arguments.length;$++)o+="&args[]="+encodeURIComponent(arguments[$]);return"Minified React error #"+_+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(_,o){ha(_,o),ha(_+"Capture",o)}function ha(_,o){for(ea[_]=o,_=0;_<o.length;_++)da.add(o[_])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(_){return ja.call(ma,_)?!0:ja.call(la,_)?!1:ka.test(_)?ma[_]=!0:(la[_]=!0,!1)}function pa(_,o,$,j){if($!==null&&$.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return j?!1:$!==null?!$.acceptsBooleans:(_=_.toLowerCase().slice(0,5),_!=="data-"&&_!=="aria-");default:return!1}}function qa(_,o,$,j){if(o===null||typeof o>"u"||pa(_,o,$,j))return!0;if(j)return!1;if($!==null)switch($.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v$1(_,o,$,j,et,tt,rt){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=j,this.attributeNamespace=et,this.mustUseProperty=$,this.propertyName=_,this.type=o,this.sanitizeURL=tt,this.removeEmptyString=rt}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){z$1[_]=new v$1(_,0,!1,_,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var o=_[0];z$1[o]=new v$1(o,1,!1,_[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(_){z$1[_]=new v$1(_,2,!1,_.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){z$1[_]=new v$1(_,2,!1,_,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){z$1[_]=new v$1(_,3,!1,_.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(_){z$1[_]=new v$1(_,3,!0,_,null,!1,!1)});["capture","download"].forEach(function(_){z$1[_]=new v$1(_,4,!1,_,null,!1,!1)});["cols","rows","size","span"].forEach(function(_){z$1[_]=new v$1(_,6,!1,_,null,!1,!1)});["rowSpan","start"].forEach(function(_){z$1[_]=new v$1(_,5,!1,_.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var o=_.replace(ra,sa);z$1[o]=new v$1(o,1,!1,_,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var o=_.replace(ra,sa);z$1[o]=new v$1(o,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(_){var o=_.replace(ra,sa);z$1[o]=new v$1(o,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(_){z$1[_]=new v$1(_,1,!1,_.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(_){z$1[_]=new v$1(_,1,!1,_.toLowerCase(),null,!0,!0)});function ta(_,o,$,j){var et=z$1.hasOwnProperty(o)?z$1[o]:null;(et!==null?et.type!==0:j||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(qa(o,$,et,j)&&($=null),j||et===null?oa(o)&&($===null?_.removeAttribute(o):_.setAttribute(o,""+$)):et.mustUseProperty?_[et.propertyName]=$===null?et.type===3?!1:"":$:(o=et.attributeName,j=et.attributeNamespace,$===null?_.removeAttribute(o):(et=et.type,$=et===3||et===4&&$===!0?"":""+$,j?_.setAttributeNS(j,o,$):_.setAttribute(o,$))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(_){return _===null||typeof _!="object"?null:(_=Ja&&_[Ja]||_["@@iterator"],typeof _=="function"?_:null)}var A$1=Object.assign,La;function Ma(_){if(La===void 0)try{throw Error()}catch($){var o=$.stack.trim().match(/\n( *(at )?)/);La=o&&o[1]||""}return`
`+La+_}var Na=!1;function Oa(_,o){if(!_||Na)return"";Na=!0;var $=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(st){var j=st}Reflect.construct(_,[],o)}else{try{o.call()}catch(st){j=st}_.call(o.prototype)}else{try{throw Error()}catch(st){j=st}_()}}catch(st){if(st&&j&&typeof st.stack=="string"){for(var et=st.stack.split(`
`),tt=j.stack.split(`
`),rt=et.length-1,nt=tt.length-1;1<=rt&&0<=nt&&et[rt]!==tt[nt];)nt--;for(;1<=rt&&0<=nt;rt--,nt--)if(et[rt]!==tt[nt]){if(rt!==1||nt!==1)do if(rt--,nt--,0>nt||et[rt]!==tt[nt]){var it=`
`+et[rt].replace(" at new "," at ");return _.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",_.displayName)),it}while(1<=rt&&0<=nt);break}}}finally{Na=!1,Error.prepareStackTrace=$}return(_=_?_.displayName||_.name:"")?Ma(_):""}function Pa(_){switch(_.tag){case 5:return Ma(_.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return _=Oa(_.type,!1),_;case 11:return _=Oa(_.type.render,!1),_;case 1:return _=Oa(_.type,!0),_;default:return""}}function Qa(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case Ca:return(_.displayName||"Context")+".Consumer";case Ba:return(_._context.displayName||"Context")+".Provider";case Da:var o=_.render;return _=_.displayName,_||(_=o.displayName||o.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case Ga:return o=_.displayName||null,o!==null?o:Qa(_.type)||"Memo";case Ha:o=_._payload,_=_._init;try{return Qa(_(o))}catch{}}return null}function Ra(_){var o=_.type;switch(_.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=o.render,_=_.displayName||_.name||"",o.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(o);case 8:return o===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Sa(_){switch(typeof _){case"boolean":case"number":case"string":case"undefined":return _;case"object":return _;default:return""}}function Ta(_){var o=_.type;return(_=_.nodeName)&&_.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(_){var o=Ta(_)?"checked":"value",$=Object.getOwnPropertyDescriptor(_.constructor.prototype,o),j=""+_[o];if(!_.hasOwnProperty(o)&&typeof $<"u"&&typeof $.get=="function"&&typeof $.set=="function"){var et=$.get,tt=$.set;return Object.defineProperty(_,o,{configurable:!0,get:function(){return et.call(this)},set:function(rt){j=""+rt,tt.call(this,rt)}}),Object.defineProperty(_,o,{enumerable:$.enumerable}),{getValue:function(){return j},setValue:function(rt){j=""+rt},stopTracking:function(){_._valueTracker=null,delete _[o]}}}}function Va(_){_._valueTracker||(_._valueTracker=Ua(_))}function Wa(_){if(!_)return!1;var o=_._valueTracker;if(!o)return!0;var $=o.getValue(),j="";return _&&(j=Ta(_)?_.checked?"true":"false":_.value),_=j,_!==$?(o.setValue(_),!0):!1}function Xa(_){if(_=_||(typeof document<"u"?document:void 0),typeof _>"u")return null;try{return _.activeElement||_.body}catch{return _.body}}function Ya(_,o){var $=o.checked;return A$1({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:$??_._wrapperState.initialChecked})}function Za(_,o){var $=o.defaultValue==null?"":o.defaultValue,j=o.checked!=null?o.checked:o.defaultChecked;$=Sa(o.value!=null?o.value:$),_._wrapperState={initialChecked:j,initialValue:$,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ab(_,o){o=o.checked,o!=null&&ta(_,"checked",o,!1)}function bb(_,o){ab(_,o);var $=Sa(o.value),j=o.type;if($!=null)j==="number"?($===0&&_.value===""||_.value!=$)&&(_.value=""+$):_.value!==""+$&&(_.value=""+$);else if(j==="submit"||j==="reset"){_.removeAttribute("value");return}o.hasOwnProperty("value")?cb$1(_,o.type,$):o.hasOwnProperty("defaultValue")&&cb$1(_,o.type,Sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(_.defaultChecked=!!o.defaultChecked)}function db(_,o,$){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var j=o.type;if(!(j!=="submit"&&j!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+_._wrapperState.initialValue,$||o===_.value||(_.value=o),_.defaultValue=o}$=_.name,$!==""&&(_.name=""),_.defaultChecked=!!_._wrapperState.initialChecked,$!==""&&(_.name=$)}function cb$1(_,o,$){(o!=="number"||Xa(_.ownerDocument)!==_)&&($==null?_.defaultValue=""+_._wrapperState.initialValue:_.defaultValue!==""+$&&(_.defaultValue=""+$))}var eb=Array.isArray;function fb(_,o,$,j){if(_=_.options,o){o={};for(var et=0;et<$.length;et++)o["$"+$[et]]=!0;for($=0;$<_.length;$++)et=o.hasOwnProperty("$"+_[$].value),_[$].selected!==et&&(_[$].selected=et),et&&j&&(_[$].defaultSelected=!0)}else{for($=""+Sa($),o=null,et=0;et<_.length;et++){if(_[et].value===$){_[et].selected=!0,j&&(_[et].defaultSelected=!0);return}o!==null||_[et].disabled||(o=_[et])}o!==null&&(o.selected=!0)}}function gb(_,o){if(o.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},o,{value:void 0,defaultValue:void 0,children:""+_._wrapperState.initialValue})}function hb(_,o){var $=o.value;if($==null){if($=o.children,o=o.defaultValue,$!=null){if(o!=null)throw Error(p$1(92));if(eb($)){if(1<$.length)throw Error(p$1(93));$=$[0]}o=$}o==null&&(o=""),$=o}_._wrapperState={initialValue:Sa($)}}function ib(_,o){var $=Sa(o.value),j=Sa(o.defaultValue);$!=null&&($=""+$,$!==_.value&&(_.value=$),o.defaultValue==null&&_.defaultValue!==$&&(_.defaultValue=$)),j!=null&&(_.defaultValue=""+j)}function jb(_){var o=_.textContent;o===_._wrapperState.initialValue&&o!==""&&o!==null&&(_.value=o)}function kb(_){switch(_){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(_,o){return _==null||_==="http://www.w3.org/1999/xhtml"?kb(o):_==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":_}var mb,nb=function(_){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,$,j,et){MSApp.execUnsafeLocalFunction(function(){return _(o,$,j,et)})}:_}(function(_,o){if(_.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in _)_.innerHTML=o;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mb.firstChild;_.firstChild;)_.removeChild(_.firstChild);for(;o.firstChild;)_.appendChild(o.firstChild)}});function ob(_,o){if(o){var $=_.firstChild;if($&&$===_.lastChild&&$.nodeType===3){$.nodeValue=o;return}}_.textContent=o}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(_){qb.forEach(function(o){o=o+_.charAt(0).toUpperCase()+_.substring(1),pb[o]=pb[_]})});function rb(_,o,$){return o==null||typeof o=="boolean"||o===""?"":$||typeof o!="number"||o===0||pb.hasOwnProperty(_)&&pb[_]?(""+o).trim():o+"px"}function sb(_,o){_=_.style;for(var $ in o)if(o.hasOwnProperty($)){var j=$.indexOf("--")===0,et=rb($,o[$],j);$==="float"&&($="cssFloat"),j?_.setProperty($,et):_[$]=et}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(_,o){if(o){if(tb[_]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(p$1(137,_));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(p$1(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(p$1(61))}if(o.style!=null&&typeof o.style!="object")throw Error(p$1(62))}}function vb(_,o){if(_.indexOf("-")===-1)return typeof o.is=="string";switch(_){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(_){return _=_.target||_.srcElement||window,_.correspondingUseElement&&(_=_.correspondingUseElement),_.nodeType===3?_.parentNode:_}var yb=null,zb=null,Ab=null;function Bb(_){if(_=Cb(_)){if(typeof yb!="function")throw Error(p$1(280));var o=_.stateNode;o&&(o=Db(o),yb(_.stateNode,_.type,o))}}function Eb(_){zb?Ab?Ab.push(_):Ab=[_]:zb=_}function Fb(){if(zb){var _=zb,o=Ab;if(Ab=zb=null,Bb(_),o)for(_=0;_<o.length;_++)Bb(o[_])}}function Gb(_,o){return _(o)}function Hb(){}var Ib=!1;function Jb(_,o,$){if(Ib)return _(o,$);Ib=!0;try{return Gb(_,o,$)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(_,o){var $=_.stateNode;if($===null)return null;var j=Db($);if(j===null)return null;$=j[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(_=_.type,j=!(_==="button"||_==="input"||_==="select"||_==="textarea")),_=!j;break e;default:_=!1}if(_)return null;if($&&typeof $!="function")throw Error(p$1(231,o,typeof $));return $}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb$1(_,o,$,j,et,tt,rt,nt,it){var st=Array.prototype.slice.call(arguments,3);try{o.apply($,st)}catch(ot){this.onError(ot)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(_){Ob=!0,Pb=_}};function Tb(_,o,$,j,et,tt,rt,nt,it){Ob=!1,Pb=null,Nb$1.apply(Sb,arguments)}function Ub(_,o,$,j,et,tt,rt,nt,it){if(Tb.apply(this,arguments),Ob){if(Ob){var st=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=st)}}function Vb(_){var o=_,$=_;if(_.alternate)for(;o.return;)o=o.return;else{_=o;do o=_,o.flags&4098&&($=o.return),_=o.return;while(_)}return o.tag===3?$:null}function Wb(_){if(_.tag===13){var o=_.memoizedState;if(o===null&&(_=_.alternate,_!==null&&(o=_.memoizedState)),o!==null)return o.dehydrated}return null}function Xb(_){if(Vb(_)!==_)throw Error(p$1(188))}function Yb(_){var o=_.alternate;if(!o){if(o=Vb(_),o===null)throw Error(p$1(188));return o!==_?null:_}for(var $=_,j=o;;){var et=$.return;if(et===null)break;var tt=et.alternate;if(tt===null){if(j=et.return,j!==null){$=j;continue}break}if(et.child===tt.child){for(tt=et.child;tt;){if(tt===$)return Xb(et),_;if(tt===j)return Xb(et),o;tt=tt.sibling}throw Error(p$1(188))}if($.return!==j.return)$=et,j=tt;else{for(var rt=!1,nt=et.child;nt;){if(nt===$){rt=!0,$=et,j=tt;break}if(nt===j){rt=!0,j=et,$=tt;break}nt=nt.sibling}if(!rt){for(nt=tt.child;nt;){if(nt===$){rt=!0,$=tt,j=et;break}if(nt===j){rt=!0,j=tt,$=et;break}nt=nt.sibling}if(!rt)throw Error(p$1(189))}}if($.alternate!==j)throw Error(p$1(190))}if($.tag!==3)throw Error(p$1(188));return $.stateNode.current===$?_:o}function Zb(_){return _=Yb(_),_!==null?$b(_):null}function $b(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var o=$b(_);if(o!==null)return o;_=_.sibling}return null}var ac=ca$1.unstable_scheduleCallback,bc=ca$1.unstable_cancelCallback,cc$1=ca$1.unstable_shouldYield,dc=ca$1.unstable_requestPaint,B=ca$1.unstable_now,ec$4=ca$1.unstable_getCurrentPriorityLevel,fc=ca$1.unstable_ImmediatePriority,gc$1=ca$1.unstable_UserBlockingPriority,hc=ca$1.unstable_NormalPriority,ic=ca$1.unstable_LowPriority,jc=ca$1.unstable_IdlePriority,kc=null,lc=null;function mc(_){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,_,void 0,(_.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(_){return _>>>=0,_===0?32:31-(pc(_)/qc|0)|0}var rc=64,sc=4194304;function tc(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function uc(_,o){var $=_.pendingLanes;if($===0)return 0;var j=0,et=_.suspendedLanes,tt=_.pingedLanes,rt=$&268435455;if(rt!==0){var nt=rt&~et;nt!==0?j=tc(nt):(tt&=rt,tt!==0&&(j=tc(tt)))}else rt=$&~et,rt!==0?j=tc(rt):tt!==0&&(j=tc(tt));if(j===0)return 0;if(o!==0&&o!==j&&!(o&et)&&(et=j&-j,tt=o&-o,et>=tt||et===16&&(tt&4194240)!==0))return o;if(j&4&&(j|=$&16),o=_.entangledLanes,o!==0)for(_=_.entanglements,o&=j;0<o;)$=31-oc(o),et=1<<$,j|=_[$],o&=~et;return j}function vc(_,o){switch(_){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(_,o){for(var $=_.suspendedLanes,j=_.pingedLanes,et=_.expirationTimes,tt=_.pendingLanes;0<tt;){var rt=31-oc(tt),nt=1<<rt,it=et[rt];it===-1?(!(nt&$)||nt&j)&&(et[rt]=vc(nt,o)):it<=o&&(_.expiredLanes|=nt),tt&=~nt}}function xc(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function yc(){var _=rc;return rc<<=1,!(rc&4194240)&&(rc=64),_}function zc(_){for(var o=[],$=0;31>$;$++)o.push(_);return o}function Ac(_,o,$){_.pendingLanes|=o,o!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,o=31-oc(o),_[o]=$}function Bc(_,o){var $=_.pendingLanes&~o;_.pendingLanes=o,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=o,_.mutableReadLanes&=o,_.entangledLanes&=o,o=_.entanglements;var j=_.eventTimes;for(_=_.expirationTimes;0<$;){var et=31-oc($),tt=1<<et;o[et]=0,j[et]=-1,_[et]=-1,$&=~tt}}function Cc(_,o){var $=_.entangledLanes|=o;for(_=_.entanglements;$;){var j=31-oc($),et=1<<j;et&o|_[j]&o&&(_[j]|=o),$&=~et}}var C=0;function Dc(_){return _&=-_,1<_?4<_?_&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(_,o){switch(_){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(o.pointerId)}}function Tc(_,o,$,j,et,tt){return _===null||_.nativeEvent!==tt?(_={blockedOn:o,domEventName:$,eventSystemFlags:j,nativeEvent:tt,targetContainers:[et]},o!==null&&(o=Cb(o),o!==null&&Fc(o)),_):(_.eventSystemFlags|=j,o=_.targetContainers,et!==null&&o.indexOf(et)===-1&&o.push(et),_)}function Uc(_,o,$,j,et){switch(o){case"focusin":return Lc=Tc(Lc,_,o,$,j,et),!0;case"dragenter":return Mc=Tc(Mc,_,o,$,j,et),!0;case"mouseover":return Nc=Tc(Nc,_,o,$,j,et),!0;case"pointerover":var tt=et.pointerId;return Oc.set(tt,Tc(Oc.get(tt)||null,_,o,$,j,et)),!0;case"gotpointercapture":return tt=et.pointerId,Pc.set(tt,Tc(Pc.get(tt)||null,_,o,$,j,et)),!0}return!1}function Vc(_){var o=Wc(_.target);if(o!==null){var $=Vb(o);if($!==null){if(o=$.tag,o===13){if(o=Wb($),o!==null){_.blockedOn=o,Ic(_.priority,function(){Gc($)});return}}else if(o===3&&$.stateNode.current.memoizedState.isDehydrated){_.blockedOn=$.tag===3?$.stateNode.containerInfo:null;return}}}_.blockedOn=null}function Xc(_){if(_.blockedOn!==null)return!1;for(var o=_.targetContainers;0<o.length;){var $=Yc(_.domEventName,_.eventSystemFlags,o[0],_.nativeEvent);if($===null){$=_.nativeEvent;var j=new $.constructor($.type,$);wb=j,$.target.dispatchEvent(j),wb=null}else return o=Cb($),o!==null&&Fc(o),_.blockedOn=$,!1;o.shift()}return!0}function Zc(_,o,$){Xc(_)&&$.delete(o)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(_,o){_.blockedOn===o&&(_.blockedOn=null,Jc||(Jc=!0,ca$1.unstable_scheduleCallback(ca$1.unstable_NormalPriority,$c)))}function bd(_){function o(et){return ad(et,_)}if(0<Kc.length){ad(Kc[0],_);for(var $=1;$<Kc.length;$++){var j=Kc[$];j.blockedOn===_&&(j.blockedOn=null)}}for(Lc!==null&&ad(Lc,_),Mc!==null&&ad(Mc,_),Nc!==null&&ad(Nc,_),Oc.forEach(o),Pc.forEach(o),$=0;$<Qc.length;$++)j=Qc[$],j.blockedOn===_&&(j.blockedOn=null);for(;0<Qc.length&&($=Qc[0],$.blockedOn===null);)Vc($),$.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(_,o,$,j){var et=C,tt=cd.transition;cd.transition=null;try{C=1,fd(_,o,$,j)}finally{C=et,cd.transition=tt}}function gd(_,o,$,j){var et=C,tt=cd.transition;cd.transition=null;try{C=4,fd(_,o,$,j)}finally{C=et,cd.transition=tt}}function fd(_,o,$,j){if(dd){var et=Yc(_,o,$,j);if(et===null)hd(_,o,j,id$3,$),Sc(_,j);else if(Uc(et,_,o,$,j))j.stopPropagation();else if(Sc(_,j),o&4&&-1<Rc.indexOf(_)){for(;et!==null;){var tt=Cb(et);if(tt!==null&&Ec(tt),tt=Yc(_,o,$,j),tt===null&&hd(_,o,j,id$3,$),tt===et)break;et=tt}et!==null&&j.stopPropagation()}else hd(_,o,j,null,$)}}var id$3=null;function Yc(_,o,$,j){if(id$3=null,_=xb(j),_=Wc(_),_!==null)if(o=Vb(_),o===null)_=null;else if($=o.tag,$===13){if(_=Wb(o),_!==null)return _;_=null}else if($===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;_=null}else o!==_&&(_=null);return id$3=_,null}function jd(_){switch(_){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$4()){case fc:return 1;case gc$1:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var _,o=ld,$=o.length,j,et="value"in kd?kd.value:kd.textContent,tt=et.length;for(_=0;_<$&&o[_]===et[_];_++);var rt=$-_;for(j=1;j<=rt&&o[$-j]===et[tt-j];j++);return md=et.slice(_,1<j?1-j:void 0)}function od(_){var o=_.keyCode;return"charCode"in _?(_=_.charCode,_===0&&o===13&&(_=13)):_=o,_===10&&(_=13),32<=_||_===13?_:0}function pd(){return!0}function qd(){return!1}function rd(_){function o($,j,et,tt,rt){this._reactName=$,this._targetInst=et,this.type=j,this.nativeEvent=tt,this.target=rt,this.currentTarget=null;for(var nt in _)_.hasOwnProperty(nt)&&($=_[nt],this[nt]=$?$(tt):tt[nt]);return this.isDefaultPrevented=(tt.defaultPrevented!=null?tt.defaultPrevented:tt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var $=this.nativeEvent;$&&($.preventDefault?$.preventDefault():typeof $.returnValue!="unknown"&&($.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var $=this.nativeEvent;$&&($.stopPropagation?$.stopPropagation():typeof $.cancelBubble!="unknown"&&($.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),o}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(_){return _.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(_){return _.relatedTarget===void 0?_.fromElement===_.srcElement?_.toElement:_.fromElement:_.relatedTarget},movementX:function(_){return"movementX"in _?_.movementX:(_!==yd&&(yd&&_.type==="mousemove"?(wd=_.screenX-yd.screenX,xd=_.screenY-yd.screenY):xd=wd=0,yd=_),wd)},movementY:function(_){return"movementY"in _?_.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(_){return"clipboardData"in _?_.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(_){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(_):(_=Od[_])?!!o[_]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(_){if(_.key){var o=Md[_.key]||_.key;if(o!=="Unidentified")return o}return _.type==="keypress"?(_=od(_),_===13?"Enter":String.fromCharCode(_)):_.type==="keydown"||_.type==="keyup"?Nd[_.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(_){return _.type==="keypress"?od(_):0},keyCode:function(_){return _.type==="keydown"||_.type==="keyup"?_.keyCode:0},which:function(_){return _.type==="keypress"?od(_):_.type==="keydown"||_.type==="keyup"?_.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td$1=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(_){return"deltaX"in _?_.deltaX:"wheelDeltaX"in _?-_.wheelDeltaX:0},deltaY:function(_){return"deltaY"in _?_.deltaY:"wheelDeltaY"in _?-_.wheelDeltaY:"wheelDelta"in _?-_.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge(_,o){switch(_){case"keyup":return $d.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(_){return _=_.detail,typeof _=="object"&&"data"in _?_.data:null}var ie=!1;function je(_,o){switch(_){case"compositionend":return he(o);case"keypress":return o.which!==32?null:(fe=!0,ee);case"textInput":return _=o.data,_===ee&&fe?null:_;default:return null}}function ke(_,o){if(ie)return _==="compositionend"||!ae&&ge(_,o)?(_=nd(),md=ld=kd=null,ie=!1,_):null;switch(_){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return de&&o.locale!=="ko"?null:o.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(_){var o=_&&_.nodeName&&_.nodeName.toLowerCase();return o==="input"?!!le[_.type]:o==="textarea"}function ne(_,o,$,j){Eb(j),o=oe(o,"onChange"),0<o.length&&($=new td("onChange","change",null,$,j),_.push({event:$,listeners:o}))}var pe=null,qe=null;function re$1(_){se(_,0)}function te(_){var o=ue(_);if(Wa(o))return _}function ve(_,o){if(_==="change")return o}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(_){if(_.propertyName==="value"&&te(qe)){var o=[];ne(o,qe,_,xb(_)),Jb(re$1,o)}}function Ce(_,o,$){_==="focusin"?(Ae(),pe=o,qe=$,pe.attachEvent("onpropertychange",Be)):_==="focusout"&&Ae()}function De(_){if(_==="selectionchange"||_==="keyup"||_==="keydown")return te(qe)}function Ee(_,o){if(_==="click")return te(o)}function Fe(_,o){if(_==="input"||_==="change")return te(o)}function Ge(_,o){return _===o&&(_!==0||1/_===1/o)||_!==_&&o!==o}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(_,o){if(He(_,o))return!0;if(typeof _!="object"||_===null||typeof o!="object"||o===null)return!1;var $=Object.keys(_),j=Object.keys(o);if($.length!==j.length)return!1;for(j=0;j<$.length;j++){var et=$[j];if(!ja.call(o,et)||!He(_[et],o[et]))return!1}return!0}function Je(_){for(;_&&_.firstChild;)_=_.firstChild;return _}function Ke(_,o){var $=Je(_);_=0;for(var j;$;){if($.nodeType===3){if(j=_+$.textContent.length,_<=o&&j>=o)return{node:$,offset:o-_};_=j}e:{for(;$;){if($.nextSibling){$=$.nextSibling;break e}$=$.parentNode}$=void 0}$=Je($)}}function Le(_,o){return _&&o?_===o?!0:_&&_.nodeType===3?!1:o&&o.nodeType===3?Le(_,o.parentNode):"contains"in _?_.contains(o):_.compareDocumentPosition?!!(_.compareDocumentPosition(o)&16):!1:!1}function Me(){for(var _=window,o=Xa();o instanceof _.HTMLIFrameElement;){try{var $=typeof o.contentWindow.location.href=="string"}catch{$=!1}if($)_=o.contentWindow;else break;o=Xa(_.document)}return o}function Ne(_){var o=_&&_.nodeName&&_.nodeName.toLowerCase();return o&&(o==="input"&&(_.type==="text"||_.type==="search"||_.type==="tel"||_.type==="url"||_.type==="password")||o==="textarea"||_.contentEditable==="true")}function Oe(_){var o=Me(),$=_.focusedElem,j=_.selectionRange;if(o!==$&&$&&$.ownerDocument&&Le($.ownerDocument.documentElement,$)){if(j!==null&&Ne($)){if(o=j.start,_=j.end,_===void 0&&(_=o),"selectionStart"in $)$.selectionStart=o,$.selectionEnd=Math.min(_,$.value.length);else if(_=(o=$.ownerDocument||document)&&o.defaultView||window,_.getSelection){_=_.getSelection();var et=$.textContent.length,tt=Math.min(j.start,et);j=j.end===void 0?tt:Math.min(j.end,et),!_.extend&&tt>j&&(et=j,j=tt,tt=et),et=Ke($,tt);var rt=Ke($,j);et&&rt&&(_.rangeCount!==1||_.anchorNode!==et.node||_.anchorOffset!==et.offset||_.focusNode!==rt.node||_.focusOffset!==rt.offset)&&(o=o.createRange(),o.setStart(et.node,et.offset),_.removeAllRanges(),tt>j?(_.addRange(o),_.extend(rt.node,rt.offset)):(o.setEnd(rt.node,rt.offset),_.addRange(o)))}}for(o=[],_=$;_=_.parentNode;)_.nodeType===1&&o.push({element:_,left:_.scrollLeft,top:_.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<o.length;$++)_=o[$],_.element.scrollLeft=_.left,_.element.scrollTop=_.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(_,o,$){var j=$.window===$?$.document:$.nodeType===9?$:$.ownerDocument;Te||Qe==null||Qe!==Xa(j)||(j=Qe,"selectionStart"in j&&Ne(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),Se&&Ie(Se,j)||(Se=j,j=oe(Re,"onSelect"),0<j.length&&(o=new td("onSelect","select",null,o,$),_.push({event:o,listeners:j}),o.target=Qe)))}function Ve(_,o){var $={};return $[_.toLowerCase()]=o.toLowerCase(),$["Webkit"+_]="webkit"+o,$["Moz"+_]="moz"+o,$}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(_){if(Xe[_])return Xe[_];if(!We[_])return _;var o=We[_],$;for($ in o)if(o.hasOwnProperty($)&&$ in Ye)return Xe[_]=o[$];return _}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(_,o){df.set(_,o),fa(o,[_])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(_,o,$){var j=_.type||"unknown-event";_.currentTarget=$,Ub(j,o,void 0,_),_.currentTarget=null}function se(_,o){o=(o&4)!==0;for(var $=0;$<_.length;$++){var j=_[$],et=j.event;j=j.listeners;e:{var tt=void 0;if(o)for(var rt=j.length-1;0<=rt;rt--){var nt=j[rt],it=nt.instance,st=nt.currentTarget;if(nt=nt.listener,it!==tt&&et.isPropagationStopped())break e;nf(et,nt,st),tt=it}else for(rt=0;rt<j.length;rt++){if(nt=j[rt],it=nt.instance,st=nt.currentTarget,nt=nt.listener,it!==tt&&et.isPropagationStopped())break e;nf(et,nt,st),tt=it}}}if(Qb)throw _=Rb,Qb=!1,Rb=null,_}function D(_,o){var $=o[of];$===void 0&&($=o[of]=new Set);var j=_+"__bubble";$.has(j)||(pf(o,_,2,!1),$.add(j))}function qf(_,o,$){var j=0;o&&(j|=4),pf($,_,j,o)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(_){if(!_[rf]){_[rf]=!0,da.forEach(function($){$!=="selectionchange"&&(mf.has($)||qf($,!1,_),qf($,!0,_))});var o=_.nodeType===9?_:_.ownerDocument;o===null||o[rf]||(o[rf]=!0,qf("selectionchange",!1,o))}}function pf(_,o,$,j){switch(jd(o)){case 1:var et=ed;break;case 4:et=gd;break;default:et=fd}$=et.bind(null,o,$,_),et=void 0,!Lb||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(et=!0),j?et!==void 0?_.addEventListener(o,$,{capture:!0,passive:et}):_.addEventListener(o,$,!0):et!==void 0?_.addEventListener(o,$,{passive:et}):_.addEventListener(o,$,!1)}function hd(_,o,$,j,et){var tt=j;if(!(o&1)&&!(o&2)&&j!==null)e:for(;;){if(j===null)return;var rt=j.tag;if(rt===3||rt===4){var nt=j.stateNode.containerInfo;if(nt===et||nt.nodeType===8&&nt.parentNode===et)break;if(rt===4)for(rt=j.return;rt!==null;){var it=rt.tag;if((it===3||it===4)&&(it=rt.stateNode.containerInfo,it===et||it.nodeType===8&&it.parentNode===et))return;rt=rt.return}for(;nt!==null;){if(rt=Wc(nt),rt===null)return;if(it=rt.tag,it===5||it===6){j=tt=rt;continue e}nt=nt.parentNode}}j=j.return}Jb(function(){var st=tt,ot=xb($),at=[];e:{var ct=df.get(_);if(ct!==void 0){var ut=td,ft=_;switch(_){case"keypress":if(od($)===0)break e;case"keydown":case"keyup":ut=Rd;break;case"focusin":ft="focus",ut=Fd;break;case"focusout":ft="blur",ut=Fd;break;case"beforeblur":case"afterblur":ut=Fd;break;case"click":if($.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=Vd;break;case $e:case af:case bf:ut=Hd;break;case cf:ut=Xd;break;case"scroll":ut=vd;break;case"wheel":ut=Zd;break;case"copy":case"cut":case"paste":ut=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=Td$1}var ht=(o&4)!==0,mt=!ht&&_==="scroll",gt=ht?ct!==null?ct+"Capture":null:ct;ht=[];for(var Et=st,St;Et!==null;){St=Et;var At=St.stateNode;if(St.tag===5&&At!==null&&(St=At,gt!==null&&(At=Kb(Et,gt),At!=null&&ht.push(tf(Et,At,St)))),mt)break;Et=Et.return}0<ht.length&&(ct=new ut(ct,ft,null,$,ot),at.push({event:ct,listeners:ht}))}}if(!(o&7)){e:{if(ct=_==="mouseover"||_==="pointerover",ut=_==="mouseout"||_==="pointerout",ct&&$!==wb&&(ft=$.relatedTarget||$.fromElement)&&(Wc(ft)||ft[uf]))break e;if((ut||ct)&&(ct=ot.window===ot?ot:(ct=ot.ownerDocument)?ct.defaultView||ct.parentWindow:window,ut?(ft=$.relatedTarget||$.toElement,ut=st,ft=ft?Wc(ft):null,ft!==null&&(mt=Vb(ft),ft!==mt||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(ut=null,ft=st),ut!==ft)){if(ht=Bd,At="onMouseLeave",gt="onMouseEnter",Et="mouse",(_==="pointerout"||_==="pointerover")&&(ht=Td$1,At="onPointerLeave",gt="onPointerEnter",Et="pointer"),mt=ut==null?ct:ue(ut),St=ft==null?ct:ue(ft),ct=new ht(At,Et+"leave",ut,$,ot),ct.target=mt,ct.relatedTarget=St,At=null,Wc(ot)===st&&(ht=new ht(gt,Et+"enter",ft,$,ot),ht.target=St,ht.relatedTarget=mt,At=ht),mt=At,ut&&ft)t:{for(ht=ut,gt=ft,Et=0,St=ht;St;St=vf(St))Et++;for(St=0,At=gt;At;At=vf(At))St++;for(;0<Et-St;)ht=vf(ht),Et--;for(;0<St-Et;)gt=vf(gt),St--;for(;Et--;){if(ht===gt||gt!==null&&ht===gt.alternate)break t;ht=vf(ht),gt=vf(gt)}ht=null}else ht=null;ut!==null&&wf(at,ct,ut,ht,!1),ft!==null&&mt!==null&&wf(at,mt,ft,ht,!0)}}e:{if(ct=st?ue(st):window,ut=ct.nodeName&&ct.nodeName.toLowerCase(),ut==="select"||ut==="input"&&ct.type==="file")var kt=ve;else if(me(ct))if(we)kt=Fe;else{kt=De;var Rt=Ce}else(ut=ct.nodeName)&&ut.toLowerCase()==="input"&&(ct.type==="checkbox"||ct.type==="radio")&&(kt=Ee);if(kt&&(kt=kt(_,st))){ne(at,kt,$,ot);break e}Rt&&Rt(_,ct,st),_==="focusout"&&(Rt=ct._wrapperState)&&Rt.controlled&&ct.type==="number"&&cb$1(ct,"number",ct.value)}switch(Rt=st?ue(st):window,_){case"focusin":(me(Rt)||Rt.contentEditable==="true")&&(Qe=Rt,Re=st,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(at,$,ot);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(at,$,ot)}var Tt;if(ae)e:{switch(_){case"compositionstart":var Dt="onCompositionStart";break e;case"compositionend":Dt="onCompositionEnd";break e;case"compositionupdate":Dt="onCompositionUpdate";break e}Dt=void 0}else ie?ge(_,$)&&(Dt="onCompositionEnd"):_==="keydown"&&$.keyCode===229&&(Dt="onCompositionStart");Dt&&(de&&$.locale!=="ko"&&(ie||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&ie&&(Tt=nd()):(kd=ot,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Rt=oe(st,Dt),0<Rt.length&&(Dt=new Ld(Dt,_,null,$,ot),at.push({event:Dt,listeners:Rt}),Tt?Dt.data=Tt:(Tt=he($),Tt!==null&&(Dt.data=Tt)))),(Tt=ce?je(_,$):ke(_,$))&&(st=oe(st,"onBeforeInput"),0<st.length&&(ot=new Ld("onBeforeInput","beforeinput",null,$,ot),at.push({event:ot,listeners:st}),ot.data=Tt))}se(at,o)})}function tf(_,o,$){return{instance:_,listener:o,currentTarget:$}}function oe(_,o){for(var $=o+"Capture",j=[];_!==null;){var et=_,tt=et.stateNode;et.tag===5&&tt!==null&&(et=tt,tt=Kb(_,$),tt!=null&&j.unshift(tf(_,tt,et)),tt=Kb(_,o),tt!=null&&j.push(tf(_,tt,et))),_=_.return}return j}function vf(_){if(_===null)return null;do _=_.return;while(_&&_.tag!==5);return _||null}function wf(_,o,$,j,et){for(var tt=o._reactName,rt=[];$!==null&&$!==j;){var nt=$,it=nt.alternate,st=nt.stateNode;if(it!==null&&it===j)break;nt.tag===5&&st!==null&&(nt=st,et?(it=Kb($,tt),it!=null&&rt.unshift(tf($,it,nt))):et||(it=Kb($,tt),it!=null&&rt.push(tf($,it,nt)))),$=$.return}rt.length!==0&&_.push({event:o,listeners:rt})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(_){return(typeof _=="string"?_:""+_).replace(xf,`
`).replace(yf,"")}function Af(_,o,$){if(o=zf(o),zf(_)!==o&&$)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(_,o){return _==="textarea"||_==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(_){return Hf.resolve(null).then(_).catch(If)}:Ff;function If(_){setTimeout(function(){throw _})}function Kf(_,o){var $=o,j=0;do{var et=$.nextSibling;if(_.removeChild($),et&&et.nodeType===8)if($=et.data,$==="/$"){if(j===0){_.removeChild(et),bd(o);return}j--}else $!=="$"&&$!=="$?"&&$!=="$!"||j++;$=et}while($);bd(o)}function Lf(_){for(;_!=null;_=_.nextSibling){var o=_.nodeType;if(o===1||o===3)break;if(o===8){if(o=_.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return _}function Mf(_){_=_.previousSibling;for(var o=0;_;){if(_.nodeType===8){var $=_.data;if($==="$"||$==="$!"||$==="$?"){if(o===0)return _;o--}else $==="/$"&&o++}_=_.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(_){var o=_[Of];if(o)return o;for(var $=_.parentNode;$;){if(o=$[uf]||$[Of]){if($=o.alternate,o.child!==null||$!==null&&$.child!==null)for(_=Mf(_);_!==null;){if($=_[Of])return $;_=Mf(_)}return o}_=$,$=_.parentNode}return null}function Cb(_){return _=_[Of]||_[uf],!_||_.tag!==5&&_.tag!==6&&_.tag!==13&&_.tag!==3?null:_}function ue(_){if(_.tag===5||_.tag===6)return _.stateNode;throw Error(p$1(33))}function Db(_){return _[Pf]||null}var Sf=[],Tf=-1;function Uf(_){return{current:_}}function E(_){0>Tf||(_.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(_,o){Tf++,Sf[Tf]=_.current,_.current=o}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(_,o){var $=_.type.contextTypes;if(!$)return Vf;var j=_.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===o)return j.__reactInternalMemoizedMaskedChildContext;var et={},tt;for(tt in $)et[tt]=o[tt];return j&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=o,_.__reactInternalMemoizedMaskedChildContext=et),et}function Zf(_){return _=_.childContextTypes,_!=null}function $f(){E(Wf),E(H)}function ag(_,o,$){if(H.current!==Vf)throw Error(p$1(168));G(H,o),G(Wf,$)}function bg(_,o,$){var j=_.stateNode;if(o=o.childContextTypes,typeof j.getChildContext!="function")return $;j=j.getChildContext();for(var et in j)if(!(et in o))throw Error(p$1(108,Ra(_)||"Unknown",et));return A$1({},$,j)}function cg(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,_),G(Wf,Wf.current),!0}function dg(_,o,$){var j=_.stateNode;if(!j)throw Error(p$1(169));$?(_=bg(_,o,Xf),j.__reactInternalMemoizedMergedChildContext=_,E(Wf),E(H),G(H,_)):E(Wf),G(Wf,$)}var eg=null,fg=!1,gg=!1;function hg(_){eg===null?eg=[_]:eg.push(_)}function ig(_){fg=!0,hg(_)}function jg(){if(!gg&&eg!==null){gg=!0;var _=0,o=C;try{var $=eg;for(C=1;_<$.length;_++){var j=$[_];do j=j(!0);while(j!==null)}eg=null,fg=!1}catch(et){throw eg!==null&&(eg=eg.slice(_+1)),ac(fc,jg),et}finally{C=o,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(_,o){kg[lg++]=ng,kg[lg++]=mg,mg=_,ng=o}function ug(_,o,$){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=_;var j=rg;_=sg;var et=32-oc(j)-1;j&=~(1<<et),$+=1;var tt=32-oc(o)+et;if(30<tt){var rt=et-et%5;tt=(j&(1<<rt)-1).toString(32),j>>=rt,et-=rt,rg=1<<32-oc(o)+et|$<<et|j,sg=tt+_}else rg=1<<tt|$<<et|j,sg=_}function vg(_){_.return!==null&&(tg(_,1),ug(_,1,0))}function wg(_){for(;_===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;_===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(_,o){var $=Bg(5,null,null,0);$.elementType="DELETED",$.stateNode=o,$.return=_,o=_.deletions,o===null?(_.deletions=[$],_.flags|=16):o.push($)}function Cg(_,o){switch(_.tag){case 5:var $=_.type;return o=o.nodeType!==1||$.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(_.stateNode=o,xg=_,yg=Lf(o.firstChild),!0):!1;case 6:return o=_.pendingProps===""||o.nodeType!==3?null:o,o!==null?(_.stateNode=o,xg=_,yg=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?($=qg!==null?{id:rg,overflow:sg}:null,_.memoizedState={dehydrated:o,treeContext:$,retryLane:1073741824},$=Bg(18,null,null,0),$.stateNode=o,$.return=_,_.child=$,xg=_,yg=null,!0):!1;default:return!1}}function Dg(_){return(_.mode&1)!==0&&(_.flags&128)===0}function Eg(_){if(I){var o=yg;if(o){var $=o;if(!Cg(_,o)){if(Dg(_))throw Error(p$1(418));o=Lf($.nextSibling);var j=xg;o&&Cg(_,o)?Ag(j,$):(_.flags=_.flags&-4097|2,I=!1,xg=_)}}else{if(Dg(_))throw Error(p$1(418));_.flags=_.flags&-4097|2,I=!1,xg=_}}}function Fg(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;xg=_}function Gg(_){if(_!==xg)return!1;if(!I)return Fg(_),I=!0,!1;var o;if((o=_.tag!==3)&&!(o=_.tag!==5)&&(o=_.type,o=o!=="head"&&o!=="body"&&!Ef(_.type,_.memoizedProps)),o&&(o=yg)){if(Dg(_))throw Hg(),Error(p$1(418));for(;o;)Ag(_,o),o=Lf(o.nextSibling)}if(Fg(_),_.tag===13){if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(p$1(317));e:{for(_=_.nextSibling,o=0;_;){if(_.nodeType===8){var $=_.data;if($==="/$"){if(o===0){yg=Lf(_.nextSibling);break e}o--}else $!=="$"&&$!=="$!"&&$!=="$?"||o++}_=_.nextSibling}yg=null}}else yg=xg?Lf(_.stateNode.nextSibling):null;return!0}function Hg(){for(var _=yg;_;)_=Lf(_.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(_){zg===null?zg=[_]:zg.push(_)}var Kg=ua.ReactCurrentBatchConfig;function Lg(_,o){if(_&&_.defaultProps){o=A$1({},o),_=_.defaultProps;for(var $ in _)o[$]===void 0&&(o[$]=_[$]);return o}return o}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(_){var o=Mg.current;E(Mg),_._currentValue=o}function Sg(_,o,$){for(;_!==null;){var j=_.alternate;if((_.childLanes&o)!==o?(_.childLanes|=o,j!==null&&(j.childLanes|=o)):j!==null&&(j.childLanes&o)!==o&&(j.childLanes|=o),_===$)break;_=_.return}}function Tg(_,o){Ng=_,Pg=Og=null,_=_.dependencies,_!==null&&_.firstContext!==null&&(_.lanes&o&&(Ug=!0),_.firstContext=null)}function Vg(_){var o=_._currentValue;if(Pg!==_)if(_={context:_,memoizedValue:o,next:null},Og===null){if(Ng===null)throw Error(p$1(308));Og=_,Ng.dependencies={lanes:0,firstContext:_}}else Og=Og.next=_;return o}var Wg=null;function Xg(_){Wg===null?Wg=[_]:Wg.push(_)}function Yg(_,o,$,j){var et=o.interleaved;return et===null?($.next=$,Xg(o)):($.next=et.next,et.next=$),o.interleaved=$,Zg(_,j)}function Zg(_,o){_.lanes|=o;var $=_.alternate;for($!==null&&($.lanes|=o),$=_,_=_.return;_!==null;)_.childLanes|=o,$=_.alternate,$!==null&&($.childLanes|=o),$=_,_=_.return;return $.tag===3?$.stateNode:null}var $g=!1;function ah(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(_,o){_=_.updateQueue,o.updateQueue===_&&(o.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function ch(_,o){return{eventTime:_,lane:o,tag:0,payload:null,callback:null,next:null}}function dh$1(_,o,$){var j=_.updateQueue;if(j===null)return null;if(j=j.shared,K$2&2){var et=j.pending;return et===null?o.next=o:(o.next=et.next,et.next=o),j.pending=o,Zg(_,$)}return et=j.interleaved,et===null?(o.next=o,Xg(j)):(o.next=et.next,et.next=o),j.interleaved=o,Zg(_,$)}function eh(_,o,$){if(o=o.updateQueue,o!==null&&(o=o.shared,($&4194240)!==0)){var j=o.lanes;j&=_.pendingLanes,$|=j,o.lanes=$,Cc(_,$)}}function fh(_,o){var $=_.updateQueue,j=_.alternate;if(j!==null&&(j=j.updateQueue,$===j)){var et=null,tt=null;if($=$.firstBaseUpdate,$!==null){do{var rt={eventTime:$.eventTime,lane:$.lane,tag:$.tag,payload:$.payload,callback:$.callback,next:null};tt===null?et=tt=rt:tt=tt.next=rt,$=$.next}while($!==null);tt===null?et=tt=o:tt=tt.next=o}else et=tt=o;$={baseState:j.baseState,firstBaseUpdate:et,lastBaseUpdate:tt,shared:j.shared,effects:j.effects},_.updateQueue=$;return}_=$.lastBaseUpdate,_===null?$.firstBaseUpdate=o:_.next=o,$.lastBaseUpdate=o}function gh(_,o,$,j){var et=_.updateQueue;$g=!1;var tt=et.firstBaseUpdate,rt=et.lastBaseUpdate,nt=et.shared.pending;if(nt!==null){et.shared.pending=null;var it=nt,st=it.next;it.next=null,rt===null?tt=st:rt.next=st,rt=it;var ot=_.alternate;ot!==null&&(ot=ot.updateQueue,nt=ot.lastBaseUpdate,nt!==rt&&(nt===null?ot.firstBaseUpdate=st:nt.next=st,ot.lastBaseUpdate=it))}if(tt!==null){var at=et.baseState;rt=0,ot=st=it=null,nt=tt;do{var ct=nt.lane,ut=nt.eventTime;if((j&ct)===ct){ot!==null&&(ot=ot.next={eventTime:ut,lane:0,tag:nt.tag,payload:nt.payload,callback:nt.callback,next:null});e:{var ft=_,ht=nt;switch(ct=o,ut=$,ht.tag){case 1:if(ft=ht.payload,typeof ft=="function"){at=ft.call(ut,at,ct);break e}at=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=ht.payload,ct=typeof ft=="function"?ft.call(ut,at,ct):ft,ct==null)break e;at=A$1({},at,ct);break e;case 2:$g=!0}}nt.callback!==null&&nt.lane!==0&&(_.flags|=64,ct=et.effects,ct===null?et.effects=[nt]:ct.push(nt))}else ut={eventTime:ut,lane:ct,tag:nt.tag,payload:nt.payload,callback:nt.callback,next:null},ot===null?(st=ot=ut,it=at):ot=ot.next=ut,rt|=ct;if(nt=nt.next,nt===null){if(nt=et.shared.pending,nt===null)break;ct=nt,nt=ct.next,ct.next=null,et.lastBaseUpdate=ct,et.shared.pending=null}}while(1);if(ot===null&&(it=at),et.baseState=it,et.firstBaseUpdate=st,et.lastBaseUpdate=ot,o=et.shared.interleaved,o!==null){et=o;do rt|=et.lane,et=et.next;while(et!==o)}else tt===null&&(et.shared.lanes=0);hh|=rt,_.lanes=rt,_.memoizedState=at}}function ih(_,o,$){if(_=o.effects,o.effects=null,_!==null)for(o=0;o<_.length;o++){var j=_[o],et=j.callback;if(et!==null){if(j.callback=null,j=$,typeof et!="function")throw Error(p$1(191,et));et.call(j)}}}var jh=new aa.Component().refs;function kh(_,o,$,j){o=_.memoizedState,$=$(j,o),$=$==null?o:A$1({},o,$),_.memoizedState=$,_.lanes===0&&(_.updateQueue.baseState=$)}var nh={isMounted:function(_){return(_=_._reactInternals)?Vb(_)===_:!1},enqueueSetState:function(_,o,$){_=_._reactInternals;var j=L(),et=lh(_),tt=ch(j,et);tt.payload=o,$!=null&&(tt.callback=$),o=dh$1(_,tt,et),o!==null&&(mh(o,_,et,j),eh(o,_,et))},enqueueReplaceState:function(_,o,$){_=_._reactInternals;var j=L(),et=lh(_),tt=ch(j,et);tt.tag=1,tt.payload=o,$!=null&&(tt.callback=$),o=dh$1(_,tt,et),o!==null&&(mh(o,_,et,j),eh(o,_,et))},enqueueForceUpdate:function(_,o){_=_._reactInternals;var $=L(),j=lh(_),et=ch($,j);et.tag=2,o!=null&&(et.callback=o),o=dh$1(_,et,j),o!==null&&(mh(o,_,j,$),eh(o,_,j))}};function oh(_,o,$,j,et,tt,rt){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(j,tt,rt):o.prototype&&o.prototype.isPureReactComponent?!Ie($,j)||!Ie(et,tt):!0}function ph(_,o,$){var j=!1,et=Vf,tt=o.contextType;return typeof tt=="object"&&tt!==null?tt=Vg(tt):(et=Zf(o)?Xf:H.current,j=o.contextTypes,tt=(j=j!=null)?Yf(_,et):Vf),o=new o($,tt),_.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=nh,_.stateNode=o,o._reactInternals=_,j&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=et,_.__reactInternalMemoizedMaskedChildContext=tt),o}function qh(_,o,$,j){_=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps($,j),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps($,j),o.state!==_&&nh.enqueueReplaceState(o,o.state,null)}function rh$1(_,o,$,j){var et=_.stateNode;et.props=$,et.state=_.memoizedState,et.refs=jh,ah(_);var tt=o.contextType;typeof tt=="object"&&tt!==null?et.context=Vg(tt):(tt=Zf(o)?Xf:H.current,et.context=Yf(_,tt)),et.state=_.memoizedState,tt=o.getDerivedStateFromProps,typeof tt=="function"&&(kh(_,o,tt,$),et.state=_.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof et.getSnapshotBeforeUpdate=="function"||typeof et.UNSAFE_componentWillMount!="function"&&typeof et.componentWillMount!="function"||(o=et.state,typeof et.componentWillMount=="function"&&et.componentWillMount(),typeof et.UNSAFE_componentWillMount=="function"&&et.UNSAFE_componentWillMount(),o!==et.state&&nh.enqueueReplaceState(et,et.state,null),gh(_,$,et,j),et.state=_.memoizedState),typeof et.componentDidMount=="function"&&(_.flags|=4194308)}function sh$1(_,o,$){if(_=$.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if($._owner){if($=$._owner,$){if($.tag!==1)throw Error(p$1(309));var j=$.stateNode}if(!j)throw Error(p$1(147,_));var et=j,tt=""+_;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===tt?o.ref:(o=function(rt){var nt=et.refs;nt===jh&&(nt=et.refs={}),rt===null?delete nt[tt]:nt[tt]=rt},o._stringRef=tt,o)}if(typeof _!="string")throw Error(p$1(284));if(!$._owner)throw Error(p$1(290,_))}return _}function th(_,o){throw _=Object.prototype.toString.call(o),Error(p$1(31,_==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":_))}function uh(_){var o=_._init;return o(_._payload)}function vh$1(_){function o(gt,Et){if(_){var St=gt.deletions;St===null?(gt.deletions=[Et],gt.flags|=16):St.push(Et)}}function $(gt,Et){if(!_)return null;for(;Et!==null;)o(gt,Et),Et=Et.sibling;return null}function j(gt,Et){for(gt=new Map;Et!==null;)Et.key!==null?gt.set(Et.key,Et):gt.set(Et.index,Et),Et=Et.sibling;return gt}function et(gt,Et){return gt=wh(gt,Et),gt.index=0,gt.sibling=null,gt}function tt(gt,Et,St){return gt.index=St,_?(St=gt.alternate,St!==null?(St=St.index,St<Et?(gt.flags|=2,Et):St):(gt.flags|=2,Et)):(gt.flags|=1048576,Et)}function rt(gt){return _&&gt.alternate===null&&(gt.flags|=2),gt}function nt(gt,Et,St,At){return Et===null||Et.tag!==6?(Et=xh(St,gt.mode,At),Et.return=gt,Et):(Et=et(Et,St),Et.return=gt,Et)}function it(gt,Et,St,At){var kt=St.type;return kt===ya?ot(gt,Et,St.props.children,At,St.key):Et!==null&&(Et.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Ha&&uh(kt)===Et.type)?(At=et(Et,St.props),At.ref=sh$1(gt,Et,St),At.return=gt,At):(At=yh(St.type,St.key,St.props,null,gt.mode,At),At.ref=sh$1(gt,Et,St),At.return=gt,At)}function st(gt,Et,St,At){return Et===null||Et.tag!==4||Et.stateNode.containerInfo!==St.containerInfo||Et.stateNode.implementation!==St.implementation?(Et=zh(St,gt.mode,At),Et.return=gt,Et):(Et=et(Et,St.children||[]),Et.return=gt,Et)}function ot(gt,Et,St,At,kt){return Et===null||Et.tag!==7?(Et=Ah(St,gt.mode,At,kt),Et.return=gt,Et):(Et=et(Et,St),Et.return=gt,Et)}function at(gt,Et,St){if(typeof Et=="string"&&Et!==""||typeof Et=="number")return Et=xh(""+Et,gt.mode,St),Et.return=gt,Et;if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case va:return St=yh(Et.type,Et.key,Et.props,null,gt.mode,St),St.ref=sh$1(gt,null,Et),St.return=gt,St;case wa:return Et=zh(Et,gt.mode,St),Et.return=gt,Et;case Ha:var At=Et._init;return at(gt,At(Et._payload),St)}if(eb(Et)||Ka(Et))return Et=Ah(Et,gt.mode,St,null),Et.return=gt,Et;th(gt,Et)}return null}function ct(gt,Et,St,At){var kt=Et!==null?Et.key:null;if(typeof St=="string"&&St!==""||typeof St=="number")return kt!==null?null:nt(gt,Et,""+St,At);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case va:return St.key===kt?it(gt,Et,St,At):null;case wa:return St.key===kt?st(gt,Et,St,At):null;case Ha:return kt=St._init,ct(gt,Et,kt(St._payload),At)}if(eb(St)||Ka(St))return kt!==null?null:ot(gt,Et,St,At,null);th(gt,St)}return null}function ut(gt,Et,St,At,kt){if(typeof At=="string"&&At!==""||typeof At=="number")return gt=gt.get(St)||null,nt(Et,gt,""+At,kt);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case va:return gt=gt.get(At.key===null?St:At.key)||null,it(Et,gt,At,kt);case wa:return gt=gt.get(At.key===null?St:At.key)||null,st(Et,gt,At,kt);case Ha:var Rt=At._init;return ut(gt,Et,St,Rt(At._payload),kt)}if(eb(At)||Ka(At))return gt=gt.get(St)||null,ot(Et,gt,At,kt,null);th(Et,At)}return null}function ft(gt,Et,St,At){for(var kt=null,Rt=null,Tt=Et,Dt=Et=0,Ot=null;Tt!==null&&Dt<St.length;Dt++){Tt.index>Dt?(Ot=Tt,Tt=null):Ot=Tt.sibling;var jt=ct(gt,Tt,St[Dt],At);if(jt===null){Tt===null&&(Tt=Ot);break}_&&Tt&&jt.alternate===null&&o(gt,Tt),Et=tt(jt,Et,Dt),Rt===null?kt=jt:Rt.sibling=jt,Rt=jt,Tt=Ot}if(Dt===St.length)return $(gt,Tt),I&&tg(gt,Dt),kt;if(Tt===null){for(;Dt<St.length;Dt++)Tt=at(gt,St[Dt],At),Tt!==null&&(Et=tt(Tt,Et,Dt),Rt===null?kt=Tt:Rt.sibling=Tt,Rt=Tt);return I&&tg(gt,Dt),kt}for(Tt=j(gt,Tt);Dt<St.length;Dt++)Ot=ut(Tt,gt,Dt,St[Dt],At),Ot!==null&&(_&&Ot.alternate!==null&&Tt.delete(Ot.key===null?Dt:Ot.key),Et=tt(Ot,Et,Dt),Rt===null?kt=Ot:Rt.sibling=Ot,Rt=Ot);return _&&Tt.forEach(function(Nt){return o(gt,Nt)}),I&&tg(gt,Dt),kt}function ht(gt,Et,St,At){var kt=Ka(St);if(typeof kt!="function")throw Error(p$1(150));if(St=kt.call(St),St==null)throw Error(p$1(151));for(var Rt=kt=null,Tt=Et,Dt=Et=0,Ot=null,jt=St.next();Tt!==null&&!jt.done;Dt++,jt=St.next()){Tt.index>Dt?(Ot=Tt,Tt=null):Ot=Tt.sibling;var Nt=ct(gt,Tt,jt.value,At);if(Nt===null){Tt===null&&(Tt=Ot);break}_&&Tt&&Nt.alternate===null&&o(gt,Tt),Et=tt(Nt,Et,Dt),Rt===null?kt=Nt:Rt.sibling=Nt,Rt=Nt,Tt=Ot}if(jt.done)return $(gt,Tt),I&&tg(gt,Dt),kt;if(Tt===null){for(;!jt.done;Dt++,jt=St.next())jt=at(gt,jt.value,At),jt!==null&&(Et=tt(jt,Et,Dt),Rt===null?kt=jt:Rt.sibling=jt,Rt=jt);return I&&tg(gt,Dt),kt}for(Tt=j(gt,Tt);!jt.done;Dt++,jt=St.next())jt=ut(Tt,gt,Dt,jt.value,At),jt!==null&&(_&&jt.alternate!==null&&Tt.delete(jt.key===null?Dt:jt.key),Et=tt(jt,Et,Dt),Rt===null?kt=jt:Rt.sibling=jt,Rt=jt);return _&&Tt.forEach(function(It){return o(gt,It)}),I&&tg(gt,Dt),kt}function mt(gt,Et,St,At){if(typeof St=="object"&&St!==null&&St.type===ya&&St.key===null&&(St=St.props.children),typeof St=="object"&&St!==null){switch(St.$$typeof){case va:e:{for(var kt=St.key,Rt=Et;Rt!==null;){if(Rt.key===kt){if(kt=St.type,kt===ya){if(Rt.tag===7){$(gt,Rt.sibling),Et=et(Rt,St.props.children),Et.return=gt,gt=Et;break e}}else if(Rt.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Ha&&uh(kt)===Rt.type){$(gt,Rt.sibling),Et=et(Rt,St.props),Et.ref=sh$1(gt,Rt,St),Et.return=gt,gt=Et;break e}$(gt,Rt);break}else o(gt,Rt);Rt=Rt.sibling}St.type===ya?(Et=Ah(St.props.children,gt.mode,At,St.key),Et.return=gt,gt=Et):(At=yh(St.type,St.key,St.props,null,gt.mode,At),At.ref=sh$1(gt,Et,St),At.return=gt,gt=At)}return rt(gt);case wa:e:{for(Rt=St.key;Et!==null;){if(Et.key===Rt)if(Et.tag===4&&Et.stateNode.containerInfo===St.containerInfo&&Et.stateNode.implementation===St.implementation){$(gt,Et.sibling),Et=et(Et,St.children||[]),Et.return=gt,gt=Et;break e}else{$(gt,Et);break}else o(gt,Et);Et=Et.sibling}Et=zh(St,gt.mode,At),Et.return=gt,gt=Et}return rt(gt);case Ha:return Rt=St._init,mt(gt,Et,Rt(St._payload),At)}if(eb(St))return ft(gt,Et,St,At);if(Ka(St))return ht(gt,Et,St,At);th(gt,St)}return typeof St=="string"&&St!==""||typeof St=="number"?(St=""+St,Et!==null&&Et.tag===6?($(gt,Et.sibling),Et=et(Et,St),Et.return=gt,gt=Et):($(gt,Et),Et=xh(St,gt.mode,At),Et.return=gt,gt=Et),rt(gt)):$(gt,Et)}return mt}var Bh=vh$1(!0),Ch=vh$1(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(_){if(_===Dh)throw Error(p$1(174));return _}function Ih(_,o){switch(G(Gh,o),G(Fh,_),G(Eh,Dh),_=o.nodeType,_){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:lb(null,"");break;default:_=_===8?o.parentNode:o,o=_.namespaceURI||null,_=_.tagName,o=lb(o,_)}E(Eh),G(Eh,o)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh$1(_){Hh(Gh.current);var o=Hh(Eh.current),$=lb(o,_.type);o!==$&&(G(Fh,_),G(Eh,$))}function Lh(_){Fh.current===_&&(E(Eh),E(Fh))}var M=Uf(0);function Mh(_){for(var o=_;o!==null;){if(o.tag===13){var $=o.memoizedState;if($!==null&&($=$.dehydrated,$===null||$.data==="$?"||$.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===_)break;for(;o.sibling===null;){if(o.return===null||o.return===_)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Nh=[];function Oh(){for(var _=0;_<Nh.length;_++)Nh[_]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N$1=null,O=null,P=null,Sh=!1,Th$1=!1,Uh=0,Vh=0;function Q(){throw Error(p$1(321))}function Wh(_,o){if(o===null)return!1;for(var $=0;$<o.length&&$<_.length;$++)if(!He(_[$],o[$]))return!1;return!0}function Xh(_,o,$,j,et,tt){if(Rh=tt,N$1=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ph.current=_===null||_.memoizedState===null?Yh:Zh,_=$(j,et),Th$1){tt=0;do{if(Th$1=!1,Uh=0,25<=tt)throw Error(p$1(301));tt+=1,P=O=null,o.updateQueue=null,Ph.current=$h,_=$(j,et)}while(Th$1)}if(Ph.current=ai,o=O!==null&&O.next!==null,Rh=0,P=O=N$1=null,Sh=!1,o)throw Error(p$1(300));return _}function bi(){var _=Uh!==0;return Uh=0,_}function ci(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N$1.memoizedState=P=_:P=P.next=_,P}function di(){if(O===null){var _=N$1.alternate;_=_!==null?_.memoizedState:null}else _=O.next;var o=P===null?N$1.memoizedState:P.next;if(o!==null)P=o,O=_;else{if(_===null)throw Error(p$1(310));O=_,_={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N$1.memoizedState=P=_:P=P.next=_}return P}function ei(_,o){return typeof o=="function"?o(_):o}function fi(_){var o=di(),$=o.queue;if($===null)throw Error(p$1(311));$.lastRenderedReducer=_;var j=O,et=j.baseQueue,tt=$.pending;if(tt!==null){if(et!==null){var rt=et.next;et.next=tt.next,tt.next=rt}j.baseQueue=et=tt,$.pending=null}if(et!==null){tt=et.next,j=j.baseState;var nt=rt=null,it=null,st=tt;do{var ot=st.lane;if((Rh&ot)===ot)it!==null&&(it=it.next={lane:0,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null}),j=st.hasEagerState?st.eagerState:_(j,st.action);else{var at={lane:ot,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null};it===null?(nt=it=at,rt=j):it=it.next=at,N$1.lanes|=ot,hh|=ot}st=st.next}while(st!==null&&st!==tt);it===null?rt=j:it.next=nt,He(j,o.memoizedState)||(Ug=!0),o.memoizedState=j,o.baseState=rt,o.baseQueue=it,$.lastRenderedState=j}if(_=$.interleaved,_!==null){et=_;do tt=et.lane,N$1.lanes|=tt,hh|=tt,et=et.next;while(et!==_)}else et===null&&($.lanes=0);return[o.memoizedState,$.dispatch]}function gi(_){var o=di(),$=o.queue;if($===null)throw Error(p$1(311));$.lastRenderedReducer=_;var j=$.dispatch,et=$.pending,tt=o.memoizedState;if(et!==null){$.pending=null;var rt=et=et.next;do tt=_(tt,rt.action),rt=rt.next;while(rt!==et);He(tt,o.memoizedState)||(Ug=!0),o.memoizedState=tt,o.baseQueue===null&&(o.baseState=tt),$.lastRenderedState=tt}return[tt,j]}function hi(){}function ii(_,o){var $=N$1,j=di(),et=o(),tt=!He(j.memoizedState,et);if(tt&&(j.memoizedState=et,Ug=!0),j=j.queue,ji(ki.bind(null,$,j,_),[_]),j.getSnapshot!==o||tt||P!==null&&P.memoizedState.tag&1){if($.flags|=2048,li(9,mi.bind(null,$,j,et,o),void 0,null),R$1===null)throw Error(p$1(349));Rh&30||ni($,o,et)}return et}function ni(_,o,$){_.flags|=16384,_={getSnapshot:o,value:$},o=N$1.updateQueue,o===null?(o={lastEffect:null,stores:null},N$1.updateQueue=o,o.stores=[_]):($=o.stores,$===null?o.stores=[_]:$.push(_))}function mi(_,o,$,j){o.value=$,o.getSnapshot=j,oi(o)&&pi(_)}function ki(_,o,$){return $(function(){oi(o)&&pi(_)})}function oi(_){var o=_.getSnapshot;_=_.value;try{var $=o();return!He(_,$)}catch{return!0}}function pi(_){var o=Zg(_,1);o!==null&&mh(o,_,1,-1)}function qi(_){var o=ci();return typeof _=="function"&&(_=_()),o.memoizedState=o.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:_},o.queue=_,_=_.dispatch=ri.bind(null,N$1,_),[o.memoizedState,_]}function li(_,o,$,j){return _={tag:_,create:o,destroy:$,deps:j,next:null},o=N$1.updateQueue,o===null?(o={lastEffect:null,stores:null},N$1.updateQueue=o,o.lastEffect=_.next=_):($=o.lastEffect,$===null?o.lastEffect=_.next=_:(j=$.next,$.next=_,_.next=j,o.lastEffect=_)),_}function si(){return di().memoizedState}function ti(_,o,$,j){var et=ci();N$1.flags|=_,et.memoizedState=li(1|o,$,void 0,j===void 0?null:j)}function ui(_,o,$,j){var et=di();j=j===void 0?null:j;var tt=void 0;if(O!==null){var rt=O.memoizedState;if(tt=rt.destroy,j!==null&&Wh(j,rt.deps)){et.memoizedState=li(o,$,tt,j);return}}N$1.flags|=_,et.memoizedState=li(1|o,$,tt,j)}function vi(_,o){return ti(8390656,8,_,o)}function ji(_,o){return ui(2048,8,_,o)}function wi(_,o){return ui(4,2,_,o)}function xi(_,o){return ui(4,4,_,o)}function yi(_,o){if(typeof o=="function")return _=_(),o(_),function(){o(null)};if(o!=null)return _=_(),o.current=_,function(){o.current=null}}function zi(_,o,$){return $=$!=null?$.concat([_]):null,ui(4,4,yi.bind(null,o,_),$)}function Ai(){}function Bi(_,o){var $=di();o=o===void 0?null:o;var j=$.memoizedState;return j!==null&&o!==null&&Wh(o,j[1])?j[0]:($.memoizedState=[_,o],_)}function Ci(_,o){var $=di();o=o===void 0?null:o;var j=$.memoizedState;return j!==null&&o!==null&&Wh(o,j[1])?j[0]:(_=_(),$.memoizedState=[_,o],_)}function Di(_,o,$){return Rh&21?(He($,o)||($=yc(),N$1.lanes|=$,hh|=$,_.baseState=!0),o):(_.baseState&&(_.baseState=!1,Ug=!0),_.memoizedState=$)}function Ei(_,o){var $=C;C=$!==0&&4>$?$:4,_(!0);var j=Qh.transition;Qh.transition={};try{_(!1),o()}finally{C=$,Qh.transition=j}}function Fi(){return di().memoizedState}function Gi(_,o,$){var j=lh(_);if($={lane:j,action:$,hasEagerState:!1,eagerState:null,next:null},Hi(_))Ii(o,$);else if($=Yg(_,o,$,j),$!==null){var et=L();mh($,_,j,et),Ji($,o,j)}}function ri(_,o,$){var j=lh(_),et={lane:j,action:$,hasEagerState:!1,eagerState:null,next:null};if(Hi(_))Ii(o,et);else{var tt=_.alternate;if(_.lanes===0&&(tt===null||tt.lanes===0)&&(tt=o.lastRenderedReducer,tt!==null))try{var rt=o.lastRenderedState,nt=tt(rt,$);if(et.hasEagerState=!0,et.eagerState=nt,He(nt,rt)){var it=o.interleaved;it===null?(et.next=et,Xg(o)):(et.next=it.next,it.next=et),o.interleaved=et;return}}catch{}finally{}$=Yg(_,o,et,j),$!==null&&(et=L(),mh($,_,j,et),Ji($,o,j))}}function Hi(_){var o=_.alternate;return _===N$1||o!==null&&o===N$1}function Ii(_,o){Th$1=Sh=!0;var $=_.pending;$===null?o.next=o:(o.next=$.next,$.next=o),_.pending=o}function Ji(_,o,$){if($&4194240){var j=o.lanes;j&=_.pendingLanes,$|=j,o.lanes=$,Cc(_,$)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(_,o){return ci().memoizedState=[_,o===void 0?null:o],_},useContext:Vg,useEffect:vi,useImperativeHandle:function(_,o,$){return $=$!=null?$.concat([_]):null,ti(4194308,4,yi.bind(null,o,_),$)},useLayoutEffect:function(_,o){return ti(4194308,4,_,o)},useInsertionEffect:function(_,o){return ti(4,2,_,o)},useMemo:function(_,o){var $=ci();return o=o===void 0?null:o,_=_(),$.memoizedState=[_,o],_},useReducer:function(_,o,$){var j=ci();return o=$!==void 0?$(o):o,j.memoizedState=j.baseState=o,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:o},j.queue=_,_=_.dispatch=Gi.bind(null,N$1,_),[j.memoizedState,_]},useRef:function(_){var o=ci();return _={current:_},o.memoizedState=_},useState:qi,useDebugValue:Ai,useDeferredValue:function(_){return ci().memoizedState=_},useTransition:function(){var _=qi(!1),o=_[0];return _=Ei.bind(null,_[1]),ci().memoizedState=_,[o,_]},useMutableSource:function(){},useSyncExternalStore:function(_,o,$){var j=N$1,et=ci();if(I){if($===void 0)throw Error(p$1(407));$=$()}else{if($=o(),R$1===null)throw Error(p$1(349));Rh&30||ni(j,o,$)}et.memoizedState=$;var tt={value:$,getSnapshot:o};return et.queue=tt,vi(ki.bind(null,j,tt,_),[_]),j.flags|=2048,li(9,mi.bind(null,j,tt,$,o),void 0,null),$},useId:function(){var _=ci(),o=R$1.identifierPrefix;if(I){var $=sg,j=rg;$=(j&~(1<<32-oc(j)-1)).toString(32)+$,o=":"+o+"R"+$,$=Uh++,0<$&&(o+="H"+$.toString(32)),o+=":"}else $=Vh++,o=":"+o+"r"+$.toString(32)+":";return _.memoizedState=o},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(_){var o=di();return Di(o,O.memoizedState,_)},useTransition:function(){var _=fi(ei)[0],o=di().memoizedState;return[_,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(_){var o=di();return O===null?o.memoizedState=_:Di(o,O.memoizedState,_)},useTransition:function(){var _=gi(ei)[0],o=di().memoizedState;return[_,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(_,o){try{var $="",j=o;do $+=Pa(j),j=j.return;while(j);var et=$}catch(tt){et=`
Error generating stack: `+tt.message+`
`+tt.stack}return{value:_,source:o,stack:et,digest:null}}function Li(_,o,$){return{value:_,source:null,stack:$??null,digest:o??null}}function Mi(_,o){try{console.error(o.value)}catch($){setTimeout(function(){throw $})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(_,o,$){$=ch(-1,$),$.tag=3,$.payload={element:null};var j=o.value;return $.callback=function(){Pi||(Pi=!0,Qi=j),Mi(_,o)},$}function Ri(_,o,$){$=ch(-1,$),$.tag=3;var j=_.type.getDerivedStateFromError;if(typeof j=="function"){var et=o.value;$.payload=function(){return j(et)},$.callback=function(){Mi(_,o)}}var tt=_.stateNode;return tt!==null&&typeof tt.componentDidCatch=="function"&&($.callback=function(){Mi(_,o),typeof j!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var rt=o.stack;this.componentDidCatch(o.value,{componentStack:rt!==null?rt:""})}),$}function Ti(_,o,$){var j=_.pingCache;if(j===null){j=_.pingCache=new Ni;var et=new Set;j.set(o,et)}else et=j.get(o),et===void 0&&(et=new Set,j.set(o,et));et.has($)||(et.add($),_=Ui.bind(null,_,o,$),o.then(_,_))}function Vi(_){do{var o;if((o=_.tag===13)&&(o=_.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return _;_=_.return}while(_!==null);return null}function Wi(_,o,$,j,et){return _.mode&1?(_.flags|=65536,_.lanes=et,_):(_===o?_.flags|=65536:(_.flags|=128,$.flags|=131072,$.flags&=-52805,$.tag===1&&($.alternate===null?$.tag=17:(o=ch(-1,1),o.tag=2,dh$1($,o,1))),$.lanes|=1),_)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(_,o,$,j){o.child=_===null?Ch(o,null,$,j):Bh(o,_.child,$,j)}function Zi(_,o,$,j,et){$=$.render;var tt=o.ref;return Tg(o,et),j=Xh(_,o,$,j,tt,et),$=bi(),_!==null&&!Ug?(o.updateQueue=_.updateQueue,o.flags&=-2053,_.lanes&=~et,$i(_,o,et)):(I&&$&&vg(o),o.flags|=1,Yi(_,o,j,et),o.child)}function aj(_,o,$,j,et){if(_===null){var tt=$.type;return typeof tt=="function"&&!bj(tt)&&tt.defaultProps===void 0&&$.compare===null&&$.defaultProps===void 0?(o.tag=15,o.type=tt,cj(_,o,tt,j,et)):(_=yh($.type,null,j,o,o.mode,et),_.ref=o.ref,_.return=o,o.child=_)}if(tt=_.child,!(_.lanes&et)){var rt=tt.memoizedProps;if($=$.compare,$=$!==null?$:Ie,$(rt,j)&&_.ref===o.ref)return $i(_,o,et)}return o.flags|=1,_=wh(tt,j),_.ref=o.ref,_.return=o,o.child=_}function cj(_,o,$,j,et){if(_!==null){var tt=_.memoizedProps;if(Ie(tt,j)&&_.ref===o.ref)if(Ug=!1,o.pendingProps=j=tt,(_.lanes&et)!==0)_.flags&131072&&(Ug=!0);else return o.lanes=_.lanes,$i(_,o,et)}return dj(_,o,$,j,et)}function ej(_,o,$){var j=o.pendingProps,et=j.children,tt=_!==null?_.memoizedState:null;if(j.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=$;else{if(!($&1073741824))return _=tt!==null?tt.baseLanes|$:$,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:_,cachePool:null,transitions:null},o.updateQueue=null,G(fj,gj),gj|=_,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=tt!==null?tt.baseLanes:$,G(fj,gj),gj|=j}else tt!==null?(j=tt.baseLanes|$,o.memoizedState=null):j=$,G(fj,gj),gj|=j;return Yi(_,o,et,$),o.child}function hj(_,o){var $=o.ref;(_===null&&$!==null||_!==null&&_.ref!==$)&&(o.flags|=512,o.flags|=2097152)}function dj(_,o,$,j,et){var tt=Zf($)?Xf:H.current;return tt=Yf(o,tt),Tg(o,et),$=Xh(_,o,$,j,tt,et),j=bi(),_!==null&&!Ug?(o.updateQueue=_.updateQueue,o.flags&=-2053,_.lanes&=~et,$i(_,o,et)):(I&&j&&vg(o),o.flags|=1,Yi(_,o,$,et),o.child)}function ij(_,o,$,j,et){if(Zf($)){var tt=!0;cg(o)}else tt=!1;if(Tg(o,et),o.stateNode===null)jj(_,o),ph(o,$,j),rh$1(o,$,j,et),j=!0;else if(_===null){var rt=o.stateNode,nt=o.memoizedProps;rt.props=nt;var it=rt.context,st=$.contextType;typeof st=="object"&&st!==null?st=Vg(st):(st=Zf($)?Xf:H.current,st=Yf(o,st));var ot=$.getDerivedStateFromProps,at=typeof ot=="function"||typeof rt.getSnapshotBeforeUpdate=="function";at||typeof rt.UNSAFE_componentWillReceiveProps!="function"&&typeof rt.componentWillReceiveProps!="function"||(nt!==j||it!==st)&&qh(o,rt,j,st),$g=!1;var ct=o.memoizedState;rt.state=ct,gh(o,j,rt,et),it=o.memoizedState,nt!==j||ct!==it||Wf.current||$g?(typeof ot=="function"&&(kh(o,$,ot,j),it=o.memoizedState),(nt=$g||oh(o,$,nt,j,ct,it,st))?(at||typeof rt.UNSAFE_componentWillMount!="function"&&typeof rt.componentWillMount!="function"||(typeof rt.componentWillMount=="function"&&rt.componentWillMount(),typeof rt.UNSAFE_componentWillMount=="function"&&rt.UNSAFE_componentWillMount()),typeof rt.componentDidMount=="function"&&(o.flags|=4194308)):(typeof rt.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=j,o.memoizedState=it),rt.props=j,rt.state=it,rt.context=st,j=nt):(typeof rt.componentDidMount=="function"&&(o.flags|=4194308),j=!1)}else{rt=o.stateNode,bh(_,o),nt=o.memoizedProps,st=o.type===o.elementType?nt:Lg(o.type,nt),rt.props=st,at=o.pendingProps,ct=rt.context,it=$.contextType,typeof it=="object"&&it!==null?it=Vg(it):(it=Zf($)?Xf:H.current,it=Yf(o,it));var ut=$.getDerivedStateFromProps;(ot=typeof ut=="function"||typeof rt.getSnapshotBeforeUpdate=="function")||typeof rt.UNSAFE_componentWillReceiveProps!="function"&&typeof rt.componentWillReceiveProps!="function"||(nt!==at||ct!==it)&&qh(o,rt,j,it),$g=!1,ct=o.memoizedState,rt.state=ct,gh(o,j,rt,et);var ft=o.memoizedState;nt!==at||ct!==ft||Wf.current||$g?(typeof ut=="function"&&(kh(o,$,ut,j),ft=o.memoizedState),(st=$g||oh(o,$,st,j,ct,ft,it)||!1)?(ot||typeof rt.UNSAFE_componentWillUpdate!="function"&&typeof rt.componentWillUpdate!="function"||(typeof rt.componentWillUpdate=="function"&&rt.componentWillUpdate(j,ft,it),typeof rt.UNSAFE_componentWillUpdate=="function"&&rt.UNSAFE_componentWillUpdate(j,ft,it)),typeof rt.componentDidUpdate=="function"&&(o.flags|=4),typeof rt.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof rt.componentDidUpdate!="function"||nt===_.memoizedProps&&ct===_.memoizedState||(o.flags|=4),typeof rt.getSnapshotBeforeUpdate!="function"||nt===_.memoizedProps&&ct===_.memoizedState||(o.flags|=1024),o.memoizedProps=j,o.memoizedState=ft),rt.props=j,rt.state=ft,rt.context=it,j=st):(typeof rt.componentDidUpdate!="function"||nt===_.memoizedProps&&ct===_.memoizedState||(o.flags|=4),typeof rt.getSnapshotBeforeUpdate!="function"||nt===_.memoizedProps&&ct===_.memoizedState||(o.flags|=1024),j=!1)}return kj(_,o,$,j,tt,et)}function kj(_,o,$,j,et,tt){hj(_,o);var rt=(o.flags&128)!==0;if(!j&&!rt)return et&&dg(o,$,!1),$i(_,o,tt);j=o.stateNode,Xi.current=o;var nt=rt&&typeof $.getDerivedStateFromError!="function"?null:j.render();return o.flags|=1,_!==null&&rt?(o.child=Bh(o,_.child,null,tt),o.child=Bh(o,null,nt,tt)):Yi(_,o,nt,tt),o.memoizedState=j.state,et&&dg(o,$,!0),o.child}function lj(_){var o=_.stateNode;o.pendingContext?ag(_,o.pendingContext,o.pendingContext!==o.context):o.context&&ag(_,o.context,!1),Ih(_,o.containerInfo)}function mj(_,o,$,j,et){return Ig(),Jg(et),o.flags|=256,Yi(_,o,$,j),o.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(_){return{baseLanes:_,cachePool:null,transitions:null}}function pj(_,o,$){var j=o.pendingProps,et=M.current,tt=!1,rt=(o.flags&128)!==0,nt;if((nt=rt)||(nt=_!==null&&_.memoizedState===null?!1:(et&2)!==0),nt?(tt=!0,o.flags&=-129):(_===null||_.memoizedState!==null)&&(et|=1),G(M,et&1),_===null)return Eg(o),_=o.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?(o.mode&1?_.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(rt=j.children,_=j.fallback,tt?(j=o.mode,tt=o.child,rt={mode:"hidden",children:rt},!(j&1)&&tt!==null?(tt.childLanes=0,tt.pendingProps=rt):tt=qj(rt,j,0,null),_=Ah(_,j,$,null),tt.return=o,_.return=o,tt.sibling=_,o.child=tt,o.child.memoizedState=oj($),o.memoizedState=nj,_):rj(o,rt));if(et=_.memoizedState,et!==null&&(nt=et.dehydrated,nt!==null))return sj(_,o,rt,j,nt,et,$);if(tt){tt=j.fallback,rt=o.mode,et=_.child,nt=et.sibling;var it={mode:"hidden",children:j.children};return!(rt&1)&&o.child!==et?(j=o.child,j.childLanes=0,j.pendingProps=it,o.deletions=null):(j=wh(et,it),j.subtreeFlags=et.subtreeFlags&14680064),nt!==null?tt=wh(nt,tt):(tt=Ah(tt,rt,$,null),tt.flags|=2),tt.return=o,j.return=o,j.sibling=tt,o.child=j,j=tt,tt=o.child,rt=_.child.memoizedState,rt=rt===null?oj($):{baseLanes:rt.baseLanes|$,cachePool:null,transitions:rt.transitions},tt.memoizedState=rt,tt.childLanes=_.childLanes&~$,o.memoizedState=nj,j}return tt=_.child,_=tt.sibling,j=wh(tt,{mode:"visible",children:j.children}),!(o.mode&1)&&(j.lanes=$),j.return=o,j.sibling=null,_!==null&&($=o.deletions,$===null?(o.deletions=[_],o.flags|=16):$.push(_)),o.child=j,o.memoizedState=null,j}function rj(_,o){return o=qj({mode:"visible",children:o},_.mode,0,null),o.return=_,_.child=o}function tj(_,o,$,j){return j!==null&&Jg(j),Bh(o,_.child,null,$),_=rj(o,o.pendingProps.children),_.flags|=2,o.memoizedState=null,_}function sj(_,o,$,j,et,tt,rt){if($)return o.flags&256?(o.flags&=-257,j=Li(Error(p$1(422))),tj(_,o,rt,j)):o.memoizedState!==null?(o.child=_.child,o.flags|=128,null):(tt=j.fallback,et=o.mode,j=qj({mode:"visible",children:j.children},et,0,null),tt=Ah(tt,et,rt,null),tt.flags|=2,j.return=o,tt.return=o,j.sibling=tt,o.child=j,o.mode&1&&Bh(o,_.child,null,rt),o.child.memoizedState=oj(rt),o.memoizedState=nj,tt);if(!(o.mode&1))return tj(_,o,rt,null);if(et.data==="$!"){if(j=et.nextSibling&&et.nextSibling.dataset,j)var nt=j.dgst;return j=nt,tt=Error(p$1(419)),j=Li(tt,j,void 0),tj(_,o,rt,j)}if(nt=(rt&_.childLanes)!==0,Ug||nt){if(j=R$1,j!==null){switch(rt&-rt){case 4:et=2;break;case 16:et=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:et=32;break;case 536870912:et=268435456;break;default:et=0}et=et&(j.suspendedLanes|rt)?0:et,et!==0&&et!==tt.retryLane&&(tt.retryLane=et,Zg(_,et),mh(j,_,et,-1))}return uj(),j=Li(Error(p$1(421))),tj(_,o,rt,j)}return et.data==="$?"?(o.flags|=128,o.child=_.child,o=vj.bind(null,_),et._reactRetry=o,null):(_=tt.treeContext,yg=Lf(et.nextSibling),xg=o,I=!0,zg=null,_!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=_.id,sg=_.overflow,qg=o),o=rj(o,j.children),o.flags|=4096,o)}function wj(_,o,$){_.lanes|=o;var j=_.alternate;j!==null&&(j.lanes|=o),Sg(_.return,o,$)}function xj(_,o,$,j,et){var tt=_.memoizedState;tt===null?_.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:j,tail:$,tailMode:et}:(tt.isBackwards=o,tt.rendering=null,tt.renderingStartTime=0,tt.last=j,tt.tail=$,tt.tailMode=et)}function yj(_,o,$){var j=o.pendingProps,et=j.revealOrder,tt=j.tail;if(Yi(_,o,j.children,$),j=M.current,j&2)j=j&1|2,o.flags|=128;else{if(_!==null&&_.flags&128)e:for(_=o.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&wj(_,$,o);else if(_.tag===19)wj(_,$,o);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===o)break e;for(;_.sibling===null;){if(_.return===null||_.return===o)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}j&=1}if(G(M,j),!(o.mode&1))o.memoizedState=null;else switch(et){case"forwards":for($=o.child,et=null;$!==null;)_=$.alternate,_!==null&&Mh(_)===null&&(et=$),$=$.sibling;$=et,$===null?(et=o.child,o.child=null):(et=$.sibling,$.sibling=null),xj(o,!1,et,$,tt);break;case"backwards":for($=null,et=o.child,o.child=null;et!==null;){if(_=et.alternate,_!==null&&Mh(_)===null){o.child=et;break}_=et.sibling,et.sibling=$,$=et,et=_}xj(o,!0,$,null,tt);break;case"together":xj(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function jj(_,o){!(o.mode&1)&&_!==null&&(_.alternate=null,o.alternate=null,o.flags|=2)}function $i(_,o,$){if(_!==null&&(o.dependencies=_.dependencies),hh|=o.lanes,!($&o.childLanes))return null;if(_!==null&&o.child!==_.child)throw Error(p$1(153));if(o.child!==null){for(_=o.child,$=wh(_,_.pendingProps),o.child=$,$.return=o;_.sibling!==null;)_=_.sibling,$=$.sibling=wh(_,_.pendingProps),$.return=o;$.sibling=null}return o.child}function zj(_,o,$){switch(o.tag){case 3:lj(o),Ig();break;case 5:Kh$1(o);break;case 1:Zf(o.type)&&cg(o);break;case 4:Ih(o,o.stateNode.containerInfo);break;case 10:var j=o.type._context,et=o.memoizedProps.value;G(Mg,j._currentValue),j._currentValue=et;break;case 13:if(j=o.memoizedState,j!==null)return j.dehydrated!==null?(G(M,M.current&1),o.flags|=128,null):$&o.child.childLanes?pj(_,o,$):(G(M,M.current&1),_=$i(_,o,$),_!==null?_.sibling:null);G(M,M.current&1);break;case 19:if(j=($&o.childLanes)!==0,_.flags&128){if(j)return yj(_,o,$);o.flags|=128}if(et=o.memoizedState,et!==null&&(et.rendering=null,et.tail=null,et.lastEffect=null),G(M,M.current),j)break;return null;case 22:case 23:return o.lanes=0,ej(_,o,$)}return $i(_,o,$)}var Aj,Bj,Cj,Dj;Aj=function(_,o){for(var $=o.child;$!==null;){if($.tag===5||$.tag===6)_.appendChild($.stateNode);else if($.tag!==4&&$.child!==null){$.child.return=$,$=$.child;continue}if($===o)break;for(;$.sibling===null;){if($.return===null||$.return===o)return;$=$.return}$.sibling.return=$.return,$=$.sibling}};Bj=function(){};Cj=function(_,o,$,j){var et=_.memoizedProps;if(et!==j){_=o.stateNode,Hh(Eh.current);var tt=null;switch($){case"input":et=Ya(_,et),j=Ya(_,j),tt=[];break;case"select":et=A$1({},et,{value:void 0}),j=A$1({},j,{value:void 0}),tt=[];break;case"textarea":et=gb(_,et),j=gb(_,j),tt=[];break;default:typeof et.onClick!="function"&&typeof j.onClick=="function"&&(_.onclick=Bf)}ub($,j);var rt;$=null;for(st in et)if(!j.hasOwnProperty(st)&&et.hasOwnProperty(st)&&et[st]!=null)if(st==="style"){var nt=et[st];for(rt in nt)nt.hasOwnProperty(rt)&&($||($={}),$[rt]="")}else st!=="dangerouslySetInnerHTML"&&st!=="children"&&st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(ea.hasOwnProperty(st)?tt||(tt=[]):(tt=tt||[]).push(st,null));for(st in j){var it=j[st];if(nt=et!=null?et[st]:void 0,j.hasOwnProperty(st)&&it!==nt&&(it!=null||nt!=null))if(st==="style")if(nt){for(rt in nt)!nt.hasOwnProperty(rt)||it&&it.hasOwnProperty(rt)||($||($={}),$[rt]="");for(rt in it)it.hasOwnProperty(rt)&&nt[rt]!==it[rt]&&($||($={}),$[rt]=it[rt])}else $||(tt||(tt=[]),tt.push(st,$)),$=it;else st==="dangerouslySetInnerHTML"?(it=it?it.__html:void 0,nt=nt?nt.__html:void 0,it!=null&&nt!==it&&(tt=tt||[]).push(st,it)):st==="children"?typeof it!="string"&&typeof it!="number"||(tt=tt||[]).push(st,""+it):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&(ea.hasOwnProperty(st)?(it!=null&&st==="onScroll"&&D("scroll",_),tt||nt===it||(tt=[])):(tt=tt||[]).push(st,it))}$&&(tt=tt||[]).push("style",$);var st=tt;(o.updateQueue=st)&&(o.flags|=4)}};Dj=function(_,o,$,j){$!==j&&(o.flags|=4)};function Ej(_,o){if(!I)switch(_.tailMode){case"hidden":o=_.tail;for(var $=null;o!==null;)o.alternate!==null&&($=o),o=o.sibling;$===null?_.tail=null:$.sibling=null;break;case"collapsed":$=_.tail;for(var j=null;$!==null;)$.alternate!==null&&(j=$),$=$.sibling;j===null?o||_.tail===null?_.tail=null:_.tail.sibling=null:j.sibling=null}}function S(_){var o=_.alternate!==null&&_.alternate.child===_.child,$=0,j=0;if(o)for(var et=_.child;et!==null;)$|=et.lanes|et.childLanes,j|=et.subtreeFlags&14680064,j|=et.flags&14680064,et.return=_,et=et.sibling;else for(et=_.child;et!==null;)$|=et.lanes|et.childLanes,j|=et.subtreeFlags,j|=et.flags,et.return=_,et=et.sibling;return _.subtreeFlags|=j,_.childLanes=$,o}function Fj(_,o,$){var j=o.pendingProps;switch(wg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(o),null;case 1:return Zf(o.type)&&$f(),S(o),null;case 3:return j=o.stateNode,Jh(),E(Wf),E(H),Oh(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(_===null||_.child===null)&&(Gg(o)?o.flags|=4:_===null||_.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(_,o),S(o),null;case 5:Lh(o);var et=Hh(Gh.current);if($=o.type,_!==null&&o.stateNode!=null)Cj(_,o,$,j,et),_.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!j){if(o.stateNode===null)throw Error(p$1(166));return S(o),null}if(_=Hh(Eh.current),Gg(o)){j=o.stateNode,$=o.type;var tt=o.memoizedProps;switch(j[Of]=o,j[Pf]=tt,_=(o.mode&1)!==0,$){case"dialog":D("cancel",j),D("close",j);break;case"iframe":case"object":case"embed":D("load",j);break;case"video":case"audio":for(et=0;et<lf.length;et++)D(lf[et],j);break;case"source":D("error",j);break;case"img":case"image":case"link":D("error",j),D("load",j);break;case"details":D("toggle",j);break;case"input":Za(j,tt),D("invalid",j);break;case"select":j._wrapperState={wasMultiple:!!tt.multiple},D("invalid",j);break;case"textarea":hb(j,tt),D("invalid",j)}ub($,tt),et=null;for(var rt in tt)if(tt.hasOwnProperty(rt)){var nt=tt[rt];rt==="children"?typeof nt=="string"?j.textContent!==nt&&(tt.suppressHydrationWarning!==!0&&Af(j.textContent,nt,_),et=["children",nt]):typeof nt=="number"&&j.textContent!==""+nt&&(tt.suppressHydrationWarning!==!0&&Af(j.textContent,nt,_),et=["children",""+nt]):ea.hasOwnProperty(rt)&&nt!=null&&rt==="onScroll"&&D("scroll",j)}switch($){case"input":Va(j),db(j,tt,!0);break;case"textarea":Va(j),jb(j);break;case"select":case"option":break;default:typeof tt.onClick=="function"&&(j.onclick=Bf)}j=et,o.updateQueue=j,j!==null&&(o.flags|=4)}else{rt=et.nodeType===9?et:et.ownerDocument,_==="http://www.w3.org/1999/xhtml"&&(_=kb($)),_==="http://www.w3.org/1999/xhtml"?$==="script"?(_=rt.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild)):typeof j.is=="string"?_=rt.createElement($,{is:j.is}):(_=rt.createElement($),$==="select"&&(rt=_,j.multiple?rt.multiple=!0:j.size&&(rt.size=j.size))):_=rt.createElementNS(_,$),_[Of]=o,_[Pf]=j,Aj(_,o,!1,!1),o.stateNode=_;e:{switch(rt=vb($,j),$){case"dialog":D("cancel",_),D("close",_),et=j;break;case"iframe":case"object":case"embed":D("load",_),et=j;break;case"video":case"audio":for(et=0;et<lf.length;et++)D(lf[et],_);et=j;break;case"source":D("error",_),et=j;break;case"img":case"image":case"link":D("error",_),D("load",_),et=j;break;case"details":D("toggle",_),et=j;break;case"input":Za(_,j),et=Ya(_,j),D("invalid",_);break;case"option":et=j;break;case"select":_._wrapperState={wasMultiple:!!j.multiple},et=A$1({},j,{value:void 0}),D("invalid",_);break;case"textarea":hb(_,j),et=gb(_,j),D("invalid",_);break;default:et=j}ub($,et),nt=et;for(tt in nt)if(nt.hasOwnProperty(tt)){var it=nt[tt];tt==="style"?sb(_,it):tt==="dangerouslySetInnerHTML"?(it=it?it.__html:void 0,it!=null&&nb(_,it)):tt==="children"?typeof it=="string"?($!=="textarea"||it!=="")&&ob(_,it):typeof it=="number"&&ob(_,""+it):tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&tt!=="autoFocus"&&(ea.hasOwnProperty(tt)?it!=null&&tt==="onScroll"&&D("scroll",_):it!=null&&ta(_,tt,it,rt))}switch($){case"input":Va(_),db(_,j,!1);break;case"textarea":Va(_),jb(_);break;case"option":j.value!=null&&_.setAttribute("value",""+Sa(j.value));break;case"select":_.multiple=!!j.multiple,tt=j.value,tt!=null?fb(_,!!j.multiple,tt,!1):j.defaultValue!=null&&fb(_,!!j.multiple,j.defaultValue,!0);break;default:typeof et.onClick=="function"&&(_.onclick=Bf)}switch($){case"button":case"input":case"select":case"textarea":j=!!j.autoFocus;break e;case"img":j=!0;break e;default:j=!1}}j&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return S(o),null;case 6:if(_&&o.stateNode!=null)Dj(_,o,_.memoizedProps,j);else{if(typeof j!="string"&&o.stateNode===null)throw Error(p$1(166));if($=Hh(Gh.current),Hh(Eh.current),Gg(o)){if(j=o.stateNode,$=o.memoizedProps,j[Of]=o,(tt=j.nodeValue!==$)&&(_=xg,_!==null))switch(_.tag){case 3:Af(j.nodeValue,$,(_.mode&1)!==0);break;case 5:_.memoizedProps.suppressHydrationWarning!==!0&&Af(j.nodeValue,$,(_.mode&1)!==0)}tt&&(o.flags|=4)}else j=($.nodeType===9?$:$.ownerDocument).createTextNode(j),j[Of]=o,o.stateNode=j}return S(o),null;case 13:if(E(M),j=o.memoizedState,_===null||_.memoizedState!==null&&_.memoizedState.dehydrated!==null){if(I&&yg!==null&&o.mode&1&&!(o.flags&128))Hg(),Ig(),o.flags|=98560,tt=!1;else if(tt=Gg(o),j!==null&&j.dehydrated!==null){if(_===null){if(!tt)throw Error(p$1(318));if(tt=o.memoizedState,tt=tt!==null?tt.dehydrated:null,!tt)throw Error(p$1(317));tt[Of]=o}else Ig(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;S(o),tt=!1}else zg!==null&&(Gj(zg),zg=null),tt=!0;if(!tt)return o.flags&65536?o:null}return o.flags&128?(o.lanes=$,o):(j=j!==null,j!==(_!==null&&_.memoizedState!==null)&&j&&(o.child.flags|=8192,o.mode&1&&(_===null||M.current&1?T===0&&(T=3):uj())),o.updateQueue!==null&&(o.flags|=4),S(o),null);case 4:return Jh(),Bj(_,o),_===null&&sf(o.stateNode.containerInfo),S(o),null;case 10:return Rg(o.type._context),S(o),null;case 17:return Zf(o.type)&&$f(),S(o),null;case 19:if(E(M),tt=o.memoizedState,tt===null)return S(o),null;if(j=(o.flags&128)!==0,rt=tt.rendering,rt===null)if(j)Ej(tt,!1);else{if(T!==0||_!==null&&_.flags&128)for(_=o.child;_!==null;){if(rt=Mh(_),rt!==null){for(o.flags|=128,Ej(tt,!1),j=rt.updateQueue,j!==null&&(o.updateQueue=j,o.flags|=4),o.subtreeFlags=0,j=$,$=o.child;$!==null;)tt=$,_=j,tt.flags&=14680066,rt=tt.alternate,rt===null?(tt.childLanes=0,tt.lanes=_,tt.child=null,tt.subtreeFlags=0,tt.memoizedProps=null,tt.memoizedState=null,tt.updateQueue=null,tt.dependencies=null,tt.stateNode=null):(tt.childLanes=rt.childLanes,tt.lanes=rt.lanes,tt.child=rt.child,tt.subtreeFlags=0,tt.deletions=null,tt.memoizedProps=rt.memoizedProps,tt.memoizedState=rt.memoizedState,tt.updateQueue=rt.updateQueue,tt.type=rt.type,_=rt.dependencies,tt.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),$=$.sibling;return G(M,M.current&1|2),o.child}_=_.sibling}tt.tail!==null&&B()>Hj&&(o.flags|=128,j=!0,Ej(tt,!1),o.lanes=4194304)}else{if(!j)if(_=Mh(rt),_!==null){if(o.flags|=128,j=!0,$=_.updateQueue,$!==null&&(o.updateQueue=$,o.flags|=4),Ej(tt,!0),tt.tail===null&&tt.tailMode==="hidden"&&!rt.alternate&&!I)return S(o),null}else 2*B()-tt.renderingStartTime>Hj&&$!==1073741824&&(o.flags|=128,j=!0,Ej(tt,!1),o.lanes=4194304);tt.isBackwards?(rt.sibling=o.child,o.child=rt):($=tt.last,$!==null?$.sibling=rt:o.child=rt,tt.last=rt)}return tt.tail!==null?(o=tt.tail,tt.rendering=o,tt.tail=o.sibling,tt.renderingStartTime=B(),o.sibling=null,$=M.current,G(M,j?$&1|2:$&1),o):(S(o),null);case 22:case 23:return Ij(),j=o.memoizedState!==null,_!==null&&_.memoizedState!==null!==j&&(o.flags|=8192),j&&o.mode&1?gj&1073741824&&(S(o),o.subtreeFlags&6&&(o.flags|=8192)):S(o),null;case 24:return null;case 25:return null}throw Error(p$1(156,o.tag))}function Jj(_,o){switch(wg(o),o.tag){case 1:return Zf(o.type)&&$f(),_=o.flags,_&65536?(o.flags=_&-65537|128,o):null;case 3:return Jh(),E(Wf),E(H),Oh(),_=o.flags,_&65536&&!(_&128)?(o.flags=_&-65537|128,o):null;case 5:return Lh(o),null;case 13:if(E(M),_=o.memoizedState,_!==null&&_.dehydrated!==null){if(o.alternate===null)throw Error(p$1(340));Ig()}return _=o.flags,_&65536?(o.flags=_&-65537|128,o):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(o.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$4=null;function Mj(_,o){var $=_.ref;if($!==null)if(typeof $=="function")try{$(null)}catch(j){W(_,o,j)}else $.current=null}function Nj(_,o,$){try{$()}catch(j){W(_,o,j)}}var Oj=!1;function Pj(_,o){if(Cf=dd,_=Me(),Ne(_)){if("selectionStart"in _)var $={start:_.selectionStart,end:_.selectionEnd};else e:{$=($=_.ownerDocument)&&$.defaultView||window;var j=$.getSelection&&$.getSelection();if(j&&j.rangeCount!==0){$=j.anchorNode;var et=j.anchorOffset,tt=j.focusNode;j=j.focusOffset;try{$.nodeType,tt.nodeType}catch{$=null;break e}var rt=0,nt=-1,it=-1,st=0,ot=0,at=_,ct=null;t:for(;;){for(var ut;at!==$||et!==0&&at.nodeType!==3||(nt=rt+et),at!==tt||j!==0&&at.nodeType!==3||(it=rt+j),at.nodeType===3&&(rt+=at.nodeValue.length),(ut=at.firstChild)!==null;)ct=at,at=ut;for(;;){if(at===_)break t;if(ct===$&&++st===et&&(nt=rt),ct===tt&&++ot===j&&(it=rt),(ut=at.nextSibling)!==null)break;at=ct,ct=at.parentNode}at=ut}$=nt===-1||it===-1?null:{start:nt,end:it}}else $=null}$=$||{start:0,end:0}}else $=null;for(Df={focusedElem:_,selectionRange:$},dd=!1,V$4=o;V$4!==null;)if(o=V$4,_=o.child,(o.subtreeFlags&1028)!==0&&_!==null)_.return=o,V$4=_;else for(;V$4!==null;){o=V$4;try{var ft=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var ht=ft.memoizedProps,mt=ft.memoizedState,gt=o.stateNode,Et=gt.getSnapshotBeforeUpdate(o.elementType===o.type?ht:Lg(o.type,ht),mt);gt.__reactInternalSnapshotBeforeUpdate=Et}break;case 3:var St=o.stateNode.containerInfo;St.nodeType===1?St.textContent="":St.nodeType===9&&St.documentElement&&St.removeChild(St.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(At){W(o,o.return,At)}if(_=o.sibling,_!==null){_.return=o.return,V$4=_;break}V$4=o.return}return ft=Oj,Oj=!1,ft}function Qj(_,o,$){var j=o.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var et=j=j.next;do{if((et.tag&_)===_){var tt=et.destroy;et.destroy=void 0,tt!==void 0&&Nj(o,$,tt)}et=et.next}while(et!==j)}}function Rj(_,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var $=o=o.next;do{if(($.tag&_)===_){var j=$.create;$.destroy=j()}$=$.next}while($!==o)}}function Sj(_){var o=_.ref;if(o!==null){var $=_.stateNode;switch(_.tag){case 5:_=$;break;default:_=$}typeof o=="function"?o(_):o.current=_}}function Tj(_){var o=_.alternate;o!==null&&(_.alternate=null,Tj(o)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(o=_.stateNode,o!==null&&(delete o[Of],delete o[Pf],delete o[of],delete o[Qf],delete o[Rf])),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function Uj(_){return _.tag===5||_.tag===3||_.tag===4}function Vj(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||Uj(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function Wj(_,o,$){var j=_.tag;if(j===5||j===6)_=_.stateNode,o?$.nodeType===8?$.parentNode.insertBefore(_,o):$.insertBefore(_,o):($.nodeType===8?(o=$.parentNode,o.insertBefore(_,$)):(o=$,o.appendChild(_)),$=$._reactRootContainer,$!=null||o.onclick!==null||(o.onclick=Bf));else if(j!==4&&(_=_.child,_!==null))for(Wj(_,o,$),_=_.sibling;_!==null;)Wj(_,o,$),_=_.sibling}function Xj(_,o,$){var j=_.tag;if(j===5||j===6)_=_.stateNode,o?$.insertBefore(_,o):$.appendChild(_);else if(j!==4&&(_=_.child,_!==null))for(Xj(_,o,$),_=_.sibling;_!==null;)Xj(_,o,$),_=_.sibling}var X=null,Yj=!1;function Zj(_,o,$){for($=$.child;$!==null;)ak(_,o,$),$=$.sibling}function ak(_,o,$){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,$)}catch{}switch($.tag){case 5:U||Mj($,o);case 6:var j=X,et=Yj;X=null,Zj(_,o,$),X=j,Yj=et,X!==null&&(Yj?(_=X,$=$.stateNode,_.nodeType===8?_.parentNode.removeChild($):_.removeChild($)):X.removeChild($.stateNode));break;case 18:X!==null&&(Yj?(_=X,$=$.stateNode,_.nodeType===8?Kf(_.parentNode,$):_.nodeType===1&&Kf(_,$),bd(_)):Kf(X,$.stateNode));break;case 4:j=X,et=Yj,X=$.stateNode.containerInfo,Yj=!0,Zj(_,o,$),X=j,Yj=et;break;case 0:case 11:case 14:case 15:if(!U&&(j=$.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){et=j=j.next;do{var tt=et,rt=tt.destroy;tt=tt.tag,rt!==void 0&&(tt&2||tt&4)&&Nj($,o,rt),et=et.next}while(et!==j)}Zj(_,o,$);break;case 1:if(!U&&(Mj($,o),j=$.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=$.memoizedProps,j.state=$.memoizedState,j.componentWillUnmount()}catch(nt){W($,o,nt)}Zj(_,o,$);break;case 21:Zj(_,o,$);break;case 22:$.mode&1?(U=(j=U)||$.memoizedState!==null,Zj(_,o,$),U=j):Zj(_,o,$);break;default:Zj(_,o,$)}}function bk(_){var o=_.updateQueue;if(o!==null){_.updateQueue=null;var $=_.stateNode;$===null&&($=_.stateNode=new Lj),o.forEach(function(j){var et=ck.bind(null,_,j);$.has(j)||($.add(j),j.then(et,et))})}}function dk(_,o){var $=o.deletions;if($!==null)for(var j=0;j<$.length;j++){var et=$[j];try{var tt=_,rt=o,nt=rt;e:for(;nt!==null;){switch(nt.tag){case 5:X=nt.stateNode,Yj=!1;break e;case 3:X=nt.stateNode.containerInfo,Yj=!0;break e;case 4:X=nt.stateNode.containerInfo,Yj=!0;break e}nt=nt.return}if(X===null)throw Error(p$1(160));ak(tt,rt,et),X=null,Yj=!1;var it=et.alternate;it!==null&&(it.return=null),et.return=null}catch(st){W(et,o,st)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)ek(o,_),o=o.sibling}function ek(_,o){var $=_.alternate,j=_.flags;switch(_.tag){case 0:case 11:case 14:case 15:if(dk(o,_),fk(_),j&4){try{Qj(3,_,_.return),Rj(3,_)}catch(ht){W(_,_.return,ht)}try{Qj(5,_,_.return)}catch(ht){W(_,_.return,ht)}}break;case 1:dk(o,_),fk(_),j&512&&$!==null&&Mj($,$.return);break;case 5:if(dk(o,_),fk(_),j&512&&$!==null&&Mj($,$.return),_.flags&32){var et=_.stateNode;try{ob(et,"")}catch(ht){W(_,_.return,ht)}}if(j&4&&(et=_.stateNode,et!=null)){var tt=_.memoizedProps,rt=$!==null?$.memoizedProps:tt,nt=_.type,it=_.updateQueue;if(_.updateQueue=null,it!==null)try{nt==="input"&&tt.type==="radio"&&tt.name!=null&&ab(et,tt),vb(nt,rt);var st=vb(nt,tt);for(rt=0;rt<it.length;rt+=2){var ot=it[rt],at=it[rt+1];ot==="style"?sb(et,at):ot==="dangerouslySetInnerHTML"?nb(et,at):ot==="children"?ob(et,at):ta(et,ot,at,st)}switch(nt){case"input":bb(et,tt);break;case"textarea":ib(et,tt);break;case"select":var ct=et._wrapperState.wasMultiple;et._wrapperState.wasMultiple=!!tt.multiple;var ut=tt.value;ut!=null?fb(et,!!tt.multiple,ut,!1):ct!==!!tt.multiple&&(tt.defaultValue!=null?fb(et,!!tt.multiple,tt.defaultValue,!0):fb(et,!!tt.multiple,tt.multiple?[]:"",!1))}et[Pf]=tt}catch(ht){W(_,_.return,ht)}}break;case 6:if(dk(o,_),fk(_),j&4){if(_.stateNode===null)throw Error(p$1(162));et=_.stateNode,tt=_.memoizedProps;try{et.nodeValue=tt}catch(ht){W(_,_.return,ht)}}break;case 3:if(dk(o,_),fk(_),j&4&&$!==null&&$.memoizedState.isDehydrated)try{bd(o.containerInfo)}catch(ht){W(_,_.return,ht)}break;case 4:dk(o,_),fk(_);break;case 13:dk(o,_),fk(_),et=_.child,et.flags&8192&&(tt=et.memoizedState!==null,et.stateNode.isHidden=tt,!tt||et.alternate!==null&&et.alternate.memoizedState!==null||(gk=B())),j&4&&bk(_);break;case 22:if(ot=$!==null&&$.memoizedState!==null,_.mode&1?(U=(st=U)||ot,dk(o,_),U=st):dk(o,_),fk(_),j&8192){if(st=_.memoizedState!==null,(_.stateNode.isHidden=st)&&!ot&&_.mode&1)for(V$4=_,ot=_.child;ot!==null;){for(at=V$4=ot;V$4!==null;){switch(ct=V$4,ut=ct.child,ct.tag){case 0:case 11:case 14:case 15:Qj(4,ct,ct.return);break;case 1:Mj(ct,ct.return);var ft=ct.stateNode;if(typeof ft.componentWillUnmount=="function"){j=ct,$=ct.return;try{o=j,ft.props=o.memoizedProps,ft.state=o.memoizedState,ft.componentWillUnmount()}catch(ht){W(j,$,ht)}}break;case 5:Mj(ct,ct.return);break;case 22:if(ct.memoizedState!==null){hk(at);continue}}ut!==null?(ut.return=ct,V$4=ut):hk(at)}ot=ot.sibling}e:for(ot=null,at=_;;){if(at.tag===5){if(ot===null){ot=at;try{et=at.stateNode,st?(tt=et.style,typeof tt.setProperty=="function"?tt.setProperty("display","none","important"):tt.display="none"):(nt=at.stateNode,it=at.memoizedProps.style,rt=it!=null&&it.hasOwnProperty("display")?it.display:null,nt.style.display=rb("display",rt))}catch(ht){W(_,_.return,ht)}}}else if(at.tag===6){if(ot===null)try{at.stateNode.nodeValue=st?"":at.memoizedProps}catch(ht){W(_,_.return,ht)}}else if((at.tag!==22&&at.tag!==23||at.memoizedState===null||at===_)&&at.child!==null){at.child.return=at,at=at.child;continue}if(at===_)break e;for(;at.sibling===null;){if(at.return===null||at.return===_)break e;ot===at&&(ot=null),at=at.return}ot===at&&(ot=null),at.sibling.return=at.return,at=at.sibling}}break;case 19:dk(o,_),fk(_),j&4&&bk(_);break;case 21:break;default:dk(o,_),fk(_)}}function fk(_){var o=_.flags;if(o&2){try{e:{for(var $=_.return;$!==null;){if(Uj($)){var j=$;break e}$=$.return}throw Error(p$1(160))}switch(j.tag){case 5:var et=j.stateNode;j.flags&32&&(ob(et,""),j.flags&=-33);var tt=Vj(_);Xj(_,tt,et);break;case 3:case 4:var rt=j.stateNode.containerInfo,nt=Vj(_);Wj(_,nt,rt);break;default:throw Error(p$1(161))}}catch(it){W(_,_.return,it)}_.flags&=-3}o&4096&&(_.flags&=-4097)}function ik(_,o,$){V$4=_,jk(_)}function jk(_,o,$){for(var j=(_.mode&1)!==0;V$4!==null;){var et=V$4,tt=et.child;if(et.tag===22&&j){var rt=et.memoizedState!==null||Kj;if(!rt){var nt=et.alternate,it=nt!==null&&nt.memoizedState!==null||U;nt=Kj;var st=U;if(Kj=rt,(U=it)&&!st)for(V$4=et;V$4!==null;)rt=V$4,it=rt.child,rt.tag===22&&rt.memoizedState!==null?kk(et):it!==null?(it.return=rt,V$4=it):kk(et);for(;tt!==null;)V$4=tt,jk(tt),tt=tt.sibling;V$4=et,Kj=nt,U=st}lk(_)}else et.subtreeFlags&8772&&tt!==null?(tt.return=et,V$4=tt):lk(_)}}function lk(_){for(;V$4!==null;){var o=V$4;if(o.flags&8772){var $=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:U||Rj(5,o);break;case 1:var j=o.stateNode;if(o.flags&4&&!U)if($===null)j.componentDidMount();else{var et=o.elementType===o.type?$.memoizedProps:Lg(o.type,$.memoizedProps);j.componentDidUpdate(et,$.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var tt=o.updateQueue;tt!==null&&ih(o,tt,j);break;case 3:var rt=o.updateQueue;if(rt!==null){if($=null,o.child!==null)switch(o.child.tag){case 5:$=o.child.stateNode;break;case 1:$=o.child.stateNode}ih(o,rt,$)}break;case 5:var nt=o.stateNode;if($===null&&o.flags&4){$=nt;var it=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":it.autoFocus&&$.focus();break;case"img":it.src&&($.src=it.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var st=o.alternate;if(st!==null){var ot=st.memoizedState;if(ot!==null){var at=ot.dehydrated;at!==null&&bd(at)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||o.flags&512&&Sj(o)}catch(ct){W(o,o.return,ct)}}if(o===_){V$4=null;break}if($=o.sibling,$!==null){$.return=o.return,V$4=$;break}V$4=o.return}}function hk(_){for(;V$4!==null;){var o=V$4;if(o===_){V$4=null;break}var $=o.sibling;if($!==null){$.return=o.return,V$4=$;break}V$4=o.return}}function kk(_){for(;V$4!==null;){var o=V$4;try{switch(o.tag){case 0:case 11:case 15:var $=o.return;try{Rj(4,o)}catch(it){W(o,$,it)}break;case 1:var j=o.stateNode;if(typeof j.componentDidMount=="function"){var et=o.return;try{j.componentDidMount()}catch(it){W(o,et,it)}}var tt=o.return;try{Sj(o)}catch(it){W(o,tt,it)}break;case 5:var rt=o.return;try{Sj(o)}catch(it){W(o,rt,it)}}}catch(it){W(o,o.return,it)}if(o===_){V$4=null;break}var nt=o.sibling;if(nt!==null){nt.return=o.return,V$4=nt;break}V$4=o.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K$2=0,R$1=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K$2&6?B():Bk!==-1?Bk:Bk=B()}function lh(_){return _.mode&1?K$2&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(_=C,_!==0||(_=window.event,_=_===void 0?16:jd(_.type)),_):1}function mh(_,o,$,j){if(50<zk)throw zk=0,Ak=null,Error(p$1(185));Ac(_,$,j),(!(K$2&2)||_!==R$1)&&(_===R$1&&(!(K$2&2)&&(rk|=$),T===4&&Dk(_,Z)),Ek(_,j),$===1&&K$2===0&&!(o.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(_,o){var $=_.callbackNode;wc(_,o);var j=uc(_,_===R$1?Z:0);if(j===0)$!==null&&bc($),_.callbackNode=null,_.callbackPriority=0;else if(o=j&-j,_.callbackPriority!==o){if($!=null&&bc($),o===1)_.tag===0?ig(Fk.bind(null,_)):hg(Fk.bind(null,_)),Jf(function(){!(K$2&6)&&jg()}),$=null;else{switch(Dc(j)){case 1:$=fc;break;case 4:$=gc$1;break;case 16:$=hc;break;case 536870912:$=jc;break;default:$=hc}$=Gk($,Hk.bind(null,_))}_.callbackPriority=o,_.callbackNode=$}}function Hk(_,o){if(Bk=-1,Ck=0,K$2&6)throw Error(p$1(327));var $=_.callbackNode;if(Ik()&&_.callbackNode!==$)return null;var j=uc(_,_===R$1?Z:0);if(j===0)return null;if(j&30||j&_.expiredLanes||o)o=Jk(_,j);else{o=j;var et=K$2;K$2|=2;var tt=Kk();(R$1!==_||Z!==o)&&(vk=null,Hj=B()+500,Lk(_,o));do try{Mk();break}catch(nt){Nk(_,nt)}while(1);Qg(),nk.current=tt,K$2=et,Y!==null?o=0:(R$1=null,Z=0,o=T)}if(o!==0){if(o===2&&(et=xc(_),et!==0&&(j=et,o=Ok(_,et))),o===1)throw $=qk,Lk(_,0),Dk(_,j),Ek(_,B()),$;if(o===6)Dk(_,j);else{if(et=_.current.alternate,!(j&30)&&!Pk(et)&&(o=Jk(_,j),o===2&&(tt=xc(_),tt!==0&&(j=tt,o=Ok(_,tt))),o===1))throw $=qk,Lk(_,0),Dk(_,j),Ek(_,B()),$;switch(_.finishedWork=et,_.finishedLanes=j,o){case 0:case 1:throw Error(p$1(345));case 2:Qk(_,uk,vk);break;case 3:if(Dk(_,j),(j&130023424)===j&&(o=gk+500-B(),10<o)){if(uc(_,0)!==0)break;if(et=_.suspendedLanes,(et&j)!==j){L(),_.pingedLanes|=_.suspendedLanes&et;break}_.timeoutHandle=Ff(Qk.bind(null,_,uk,vk),o);break}Qk(_,uk,vk);break;case 4:if(Dk(_,j),(j&4194240)===j)break;for(o=_.eventTimes,et=-1;0<j;){var rt=31-oc(j);tt=1<<rt,rt=o[rt],rt>et&&(et=rt),j&=~tt}if(j=et,j=B()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*mk(j/1960))-j,10<j){_.timeoutHandle=Ff(Qk.bind(null,_,uk,vk),j);break}Qk(_,uk,vk);break;case 5:Qk(_,uk,vk);break;default:throw Error(p$1(329))}}}return Ek(_,B()),_.callbackNode===$?Hk.bind(null,_):null}function Ok(_,o){var $=tk;return _.current.memoizedState.isDehydrated&&(Lk(_,o).flags|=256),_=Jk(_,o),_!==2&&(o=uk,uk=$,o!==null&&Gj(o)),_}function Gj(_){uk===null?uk=_:uk.push.apply(uk,_)}function Pk(_){for(var o=_;;){if(o.flags&16384){var $=o.updateQueue;if($!==null&&($=$.stores,$!==null))for(var j=0;j<$.length;j++){var et=$[j],tt=et.getSnapshot;et=et.value;try{if(!He(tt(),et))return!1}catch{return!1}}}if($=o.child,o.subtreeFlags&16384&&$!==null)$.return=o,o=$;else{if(o===_)break;for(;o.sibling===null;){if(o.return===null||o.return===_)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Dk(_,o){for(o&=~sk,o&=~rk,_.suspendedLanes|=o,_.pingedLanes&=~o,_=_.expirationTimes;0<o;){var $=31-oc(o),j=1<<$;_[$]=-1,o&=~j}}function Fk(_){if(K$2&6)throw Error(p$1(327));Ik();var o=uc(_,0);if(!(o&1))return Ek(_,B()),null;var $=Jk(_,o);if(_.tag!==0&&$===2){var j=xc(_);j!==0&&(o=j,$=Ok(_,j))}if($===1)throw $=qk,Lk(_,0),Dk(_,o),Ek(_,B()),$;if($===6)throw Error(p$1(345));return _.finishedWork=_.current.alternate,_.finishedLanes=o,Qk(_,uk,vk),Ek(_,B()),null}function Rk(_,o){var $=K$2;K$2|=1;try{return _(o)}finally{K$2=$,K$2===0&&(Hj=B()+500,fg&&jg())}}function Sk(_){xk!==null&&xk.tag===0&&!(K$2&6)&&Ik();var o=K$2;K$2|=1;var $=pk.transition,j=C;try{if(pk.transition=null,C=1,_)return _()}finally{C=j,pk.transition=$,K$2=o,!(K$2&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(_,o){_.finishedWork=null,_.finishedLanes=0;var $=_.timeoutHandle;if($!==-1&&(_.timeoutHandle=-1,Gf($)),Y!==null)for($=Y.return;$!==null;){var j=$;switch(wg(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&$f();break;case 3:Jh(),E(Wf),E(H),Oh();break;case 5:Lh(j);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(j.type._context);break;case 22:case 23:Ij()}$=$.return}if(R$1=_,Y=_=wh(_.current,null),Z=gj=o,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(o=0;o<Wg.length;o++)if($=Wg[o],j=$.interleaved,j!==null){$.interleaved=null;var et=j.next,tt=$.pending;if(tt!==null){var rt=tt.next;tt.next=et,j.next=rt}$.pending=j}Wg=null}return _}function Nk(_,o){do{var $=Y;try{if(Qg(),Ph.current=ai,Sh){for(var j=N$1.memoizedState;j!==null;){var et=j.queue;et!==null&&(et.pending=null),j=j.next}Sh=!1}if(Rh=0,P=O=N$1=null,Th$1=!1,Uh=0,ok.current=null,$===null||$.return===null){T=1,qk=o,Y=null;break}e:{var tt=_,rt=$.return,nt=$,it=o;if(o=Z,nt.flags|=32768,it!==null&&typeof it=="object"&&typeof it.then=="function"){var st=it,ot=nt,at=ot.tag;if(!(ot.mode&1)&&(at===0||at===11||at===15)){var ct=ot.alternate;ct?(ot.updateQueue=ct.updateQueue,ot.memoizedState=ct.memoizedState,ot.lanes=ct.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var ut=Vi(rt);if(ut!==null){ut.flags&=-257,Wi(ut,rt,nt,tt,o),ut.mode&1&&Ti(tt,st,o),o=ut,it=st;var ft=o.updateQueue;if(ft===null){var ht=new Set;ht.add(it),o.updateQueue=ht}else ft.add(it);break e}else{if(!(o&1)){Ti(tt,st,o),uj();break e}it=Error(p$1(426))}}else if(I&&nt.mode&1){var mt=Vi(rt);if(mt!==null){!(mt.flags&65536)&&(mt.flags|=256),Wi(mt,rt,nt,tt,o),Jg(Ki(it,nt));break e}}tt=it=Ki(it,nt),T!==4&&(T=2),tk===null?tk=[tt]:tk.push(tt),tt=rt;do{switch(tt.tag){case 3:tt.flags|=65536,o&=-o,tt.lanes|=o;var gt=Oi(tt,it,o);fh(tt,gt);break e;case 1:nt=it;var Et=tt.type,St=tt.stateNode;if(!(tt.flags&128)&&(typeof Et.getDerivedStateFromError=="function"||St!==null&&typeof St.componentDidCatch=="function"&&(Si===null||!Si.has(St)))){tt.flags|=65536,o&=-o,tt.lanes|=o;var At=Ri(tt,nt,o);fh(tt,At);break e}}tt=tt.return}while(tt!==null)}Tk($)}catch(kt){o=kt,Y===$&&$!==null&&(Y=$=$.return);continue}break}while(1)}function Kk(){var _=nk.current;return nk.current=ai,_===null?ai:_}function uj(){(T===0||T===3||T===2)&&(T=4),R$1===null||!(hh&268435455)&&!(rk&268435455)||Dk(R$1,Z)}function Jk(_,o){var $=K$2;K$2|=2;var j=Kk();(R$1!==_||Z!==o)&&(vk=null,Lk(_,o));do try{Uk();break}catch(et){Nk(_,et)}while(1);if(Qg(),K$2=$,nk.current=j,Y!==null)throw Error(p$1(261));return R$1=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc$1();)Vk(Y)}function Vk(_){var o=Wk(_.alternate,_,gj);_.memoizedProps=_.pendingProps,o===null?Tk(_):Y=o,ok.current=null}function Tk(_){var o=_;do{var $=o.alternate;if(_=o.return,o.flags&32768){if($=Jj($,o),$!==null){$.flags&=32767,Y=$;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{T=6,Y=null;return}}else if($=Fj($,o,gj),$!==null){Y=$;return}if(o=o.sibling,o!==null){Y=o;return}Y=o=_}while(o!==null);T===0&&(T=5)}function Qk(_,o,$){var j=C,et=pk.transition;try{pk.transition=null,C=1,Xk(_,o,$,j)}finally{pk.transition=et,C=j}return null}function Xk(_,o,$,j){do Ik();while(xk!==null);if(K$2&6)throw Error(p$1(327));$=_.finishedWork;var et=_.finishedLanes;if($===null)return null;if(_.finishedWork=null,_.finishedLanes=0,$===_.current)throw Error(p$1(177));_.callbackNode=null,_.callbackPriority=0;var tt=$.lanes|$.childLanes;if(Bc(_,tt),_===R$1&&(Y=R$1=null,Z=0),!($.subtreeFlags&2064)&&!($.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),tt=($.flags&15990)!==0,$.subtreeFlags&15990||tt){tt=pk.transition,pk.transition=null;var rt=C;C=1;var nt=K$2;K$2|=4,ok.current=null,Pj(_,$),ek($,_),Oe(Df),dd=!!Cf,Df=Cf=null,_.current=$,ik($),dc(),K$2=nt,C=rt,pk.transition=tt}else _.current=$;if(wk&&(wk=!1,xk=_,yk=et),tt=_.pendingLanes,tt===0&&(Si=null),mc($.stateNode),Ek(_,B()),o!==null)for(j=_.onRecoverableError,$=0;$<o.length;$++)et=o[$],j(et.value,{componentStack:et.stack,digest:et.digest});if(Pi)throw Pi=!1,_=Qi,Qi=null,_;return yk&1&&_.tag!==0&&Ik(),tt=_.pendingLanes,tt&1?_===Ak?zk++:(zk=0,Ak=_):zk=0,jg(),null}function Ik(){if(xk!==null){var _=Dc(yk),o=pk.transition,$=C;try{if(pk.transition=null,C=16>_?16:_,xk===null)var j=!1;else{if(_=xk,xk=null,yk=0,K$2&6)throw Error(p$1(331));var et=K$2;for(K$2|=4,V$4=_.current;V$4!==null;){var tt=V$4,rt=tt.child;if(V$4.flags&16){var nt=tt.deletions;if(nt!==null){for(var it=0;it<nt.length;it++){var st=nt[it];for(V$4=st;V$4!==null;){var ot=V$4;switch(ot.tag){case 0:case 11:case 15:Qj(8,ot,tt)}var at=ot.child;if(at!==null)at.return=ot,V$4=at;else for(;V$4!==null;){ot=V$4;var ct=ot.sibling,ut=ot.return;if(Tj(ot),ot===st){V$4=null;break}if(ct!==null){ct.return=ut,V$4=ct;break}V$4=ut}}}var ft=tt.alternate;if(ft!==null){var ht=ft.child;if(ht!==null){ft.child=null;do{var mt=ht.sibling;ht.sibling=null,ht=mt}while(ht!==null)}}V$4=tt}}if(tt.subtreeFlags&2064&&rt!==null)rt.return=tt,V$4=rt;else e:for(;V$4!==null;){if(tt=V$4,tt.flags&2048)switch(tt.tag){case 0:case 11:case 15:Qj(9,tt,tt.return)}var gt=tt.sibling;if(gt!==null){gt.return=tt.return,V$4=gt;break e}V$4=tt.return}}var Et=_.current;for(V$4=Et;V$4!==null;){rt=V$4;var St=rt.child;if(rt.subtreeFlags&2064&&St!==null)St.return=rt,V$4=St;else e:for(rt=Et;V$4!==null;){if(nt=V$4,nt.flags&2048)try{switch(nt.tag){case 0:case 11:case 15:Rj(9,nt)}}catch(kt){W(nt,nt.return,kt)}if(nt===rt){V$4=null;break e}var At=nt.sibling;if(At!==null){At.return=nt.return,V$4=At;break e}V$4=nt.return}}if(K$2=et,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,_)}catch{}j=!0}return j}finally{C=$,pk.transition=o}}return!1}function Yk(_,o,$){o=Ki($,o),o=Oi(_,o,1),_=dh$1(_,o,1),o=L(),_!==null&&(Ac(_,1,o),Ek(_,o))}function W(_,o,$){if(_.tag===3)Yk(_,_,$);else for(;o!==null;){if(o.tag===3){Yk(o,_,$);break}else if(o.tag===1){var j=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Si===null||!Si.has(j))){_=Ki($,_),_=Ri(o,_,1),o=dh$1(o,_,1),_=L(),o!==null&&(Ac(o,1,_),Ek(o,_));break}}o=o.return}}function Ui(_,o,$){var j=_.pingCache;j!==null&&j.delete(o),o=L(),_.pingedLanes|=_.suspendedLanes&$,R$1===_&&(Z&$)===$&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-gk?Lk(_,0):sk|=$),Ek(_,o)}function Zk(_,o){o===0&&(_.mode&1?(o=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):o=1);var $=L();_=Zg(_,o),_!==null&&(Ac(_,o,$),Ek(_,$))}function vj(_){var o=_.memoizedState,$=0;o!==null&&($=o.retryLane),Zk(_,$)}function ck(_,o){var $=0;switch(_.tag){case 13:var j=_.stateNode,et=_.memoizedState;et!==null&&($=et.retryLane);break;case 19:j=_.stateNode;break;default:throw Error(p$1(314))}j!==null&&j.delete(o),Zk(_,$)}var Wk;Wk=function(_,o,$){if(_!==null)if(_.memoizedProps!==o.pendingProps||Wf.current)Ug=!0;else{if(!(_.lanes&$)&&!(o.flags&128))return Ug=!1,zj(_,o,$);Ug=!!(_.flags&131072)}else Ug=!1,I&&o.flags&1048576&&ug(o,ng,o.index);switch(o.lanes=0,o.tag){case 2:var j=o.type;jj(_,o),_=o.pendingProps;var et=Yf(o,H.current);Tg(o,$),et=Xh(null,o,j,_,et,$);var tt=bi();return o.flags|=1,typeof et=="object"&&et!==null&&typeof et.render=="function"&&et.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Zf(j)?(tt=!0,cg(o)):tt=!1,o.memoizedState=et.state!==null&&et.state!==void 0?et.state:null,ah(o),et.updater=nh,o.stateNode=et,et._reactInternals=o,rh$1(o,j,_,$),o=kj(null,o,j,!0,tt,$)):(o.tag=0,I&&tt&&vg(o),Yi(null,o,et,$),o=o.child),o;case 16:j=o.elementType;e:{switch(jj(_,o),_=o.pendingProps,et=j._init,j=et(j._payload),o.type=j,et=o.tag=$k(j),_=Lg(j,_),et){case 0:o=dj(null,o,j,_,$);break e;case 1:o=ij(null,o,j,_,$);break e;case 11:o=Zi(null,o,j,_,$);break e;case 14:o=aj(null,o,j,Lg(j.type,_),$);break e}throw Error(p$1(306,j,""))}return o;case 0:return j=o.type,et=o.pendingProps,et=o.elementType===j?et:Lg(j,et),dj(_,o,j,et,$);case 1:return j=o.type,et=o.pendingProps,et=o.elementType===j?et:Lg(j,et),ij(_,o,j,et,$);case 3:e:{if(lj(o),_===null)throw Error(p$1(387));j=o.pendingProps,tt=o.memoizedState,et=tt.element,bh(_,o),gh(o,j,null,$);var rt=o.memoizedState;if(j=rt.element,tt.isDehydrated)if(tt={element:j,isDehydrated:!1,cache:rt.cache,pendingSuspenseBoundaries:rt.pendingSuspenseBoundaries,transitions:rt.transitions},o.updateQueue.baseState=tt,o.memoizedState=tt,o.flags&256){et=Ki(Error(p$1(423)),o),o=mj(_,o,j,$,et);break e}else if(j!==et){et=Ki(Error(p$1(424)),o),o=mj(_,o,j,$,et);break e}else for(yg=Lf(o.stateNode.containerInfo.firstChild),xg=o,I=!0,zg=null,$=Ch(o,null,j,$),o.child=$;$;)$.flags=$.flags&-3|4096,$=$.sibling;else{if(Ig(),j===et){o=$i(_,o,$);break e}Yi(_,o,j,$)}o=o.child}return o;case 5:return Kh$1(o),_===null&&Eg(o),j=o.type,et=o.pendingProps,tt=_!==null?_.memoizedProps:null,rt=et.children,Ef(j,et)?rt=null:tt!==null&&Ef(j,tt)&&(o.flags|=32),hj(_,o),Yi(_,o,rt,$),o.child;case 6:return _===null&&Eg(o),null;case 13:return pj(_,o,$);case 4:return Ih(o,o.stateNode.containerInfo),j=o.pendingProps,_===null?o.child=Bh(o,null,j,$):Yi(_,o,j,$),o.child;case 11:return j=o.type,et=o.pendingProps,et=o.elementType===j?et:Lg(j,et),Zi(_,o,j,et,$);case 7:return Yi(_,o,o.pendingProps,$),o.child;case 8:return Yi(_,o,o.pendingProps.children,$),o.child;case 12:return Yi(_,o,o.pendingProps.children,$),o.child;case 10:e:{if(j=o.type._context,et=o.pendingProps,tt=o.memoizedProps,rt=et.value,G(Mg,j._currentValue),j._currentValue=rt,tt!==null)if(He(tt.value,rt)){if(tt.children===et.children&&!Wf.current){o=$i(_,o,$);break e}}else for(tt=o.child,tt!==null&&(tt.return=o);tt!==null;){var nt=tt.dependencies;if(nt!==null){rt=tt.child;for(var it=nt.firstContext;it!==null;){if(it.context===j){if(tt.tag===1){it=ch(-1,$&-$),it.tag=2;var st=tt.updateQueue;if(st!==null){st=st.shared;var ot=st.pending;ot===null?it.next=it:(it.next=ot.next,ot.next=it),st.pending=it}}tt.lanes|=$,it=tt.alternate,it!==null&&(it.lanes|=$),Sg(tt.return,$,o),nt.lanes|=$;break}it=it.next}}else if(tt.tag===10)rt=tt.type===o.type?null:tt.child;else if(tt.tag===18){if(rt=tt.return,rt===null)throw Error(p$1(341));rt.lanes|=$,nt=rt.alternate,nt!==null&&(nt.lanes|=$),Sg(rt,$,o),rt=tt.sibling}else rt=tt.child;if(rt!==null)rt.return=tt;else for(rt=tt;rt!==null;){if(rt===o){rt=null;break}if(tt=rt.sibling,tt!==null){tt.return=rt.return,rt=tt;break}rt=rt.return}tt=rt}Yi(_,o,et.children,$),o=o.child}return o;case 9:return et=o.type,j=o.pendingProps.children,Tg(o,$),et=Vg(et),j=j(et),o.flags|=1,Yi(_,o,j,$),o.child;case 14:return j=o.type,et=Lg(j,o.pendingProps),et=Lg(j.type,et),aj(_,o,j,et,$);case 15:return cj(_,o,o.type,o.pendingProps,$);case 17:return j=o.type,et=o.pendingProps,et=o.elementType===j?et:Lg(j,et),jj(_,o),o.tag=1,Zf(j)?(_=!0,cg(o)):_=!1,Tg(o,$),ph(o,j,et),rh$1(o,j,et,$),kj(null,o,j,!0,_,$);case 19:return yj(_,o,$);case 22:return ej(_,o,$)}throw Error(p$1(156,o.tag))};function Gk(_,o){return ac(_,o)}function al(_,o,$,j){this.tag=_,this.key=$,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(_,o,$,j){return new al(_,o,$,j)}function bj(_){return _=_.prototype,!(!_||!_.isReactComponent)}function $k(_){if(typeof _=="function")return bj(_)?1:0;if(_!=null){if(_=_.$$typeof,_===Da)return 11;if(_===Ga)return 14}return 2}function wh(_,o){var $=_.alternate;return $===null?($=Bg(_.tag,o,_.key,_.mode),$.elementType=_.elementType,$.type=_.type,$.stateNode=_.stateNode,$.alternate=_,_.alternate=$):($.pendingProps=o,$.type=_.type,$.flags=0,$.subtreeFlags=0,$.deletions=null),$.flags=_.flags&14680064,$.childLanes=_.childLanes,$.lanes=_.lanes,$.child=_.child,$.memoizedProps=_.memoizedProps,$.memoizedState=_.memoizedState,$.updateQueue=_.updateQueue,o=_.dependencies,$.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},$.sibling=_.sibling,$.index=_.index,$.ref=_.ref,$}function yh(_,o,$,j,et,tt){var rt=2;if(j=_,typeof _=="function")bj(_)&&(rt=1);else if(typeof _=="string")rt=5;else e:switch(_){case ya:return Ah($.children,et,tt,o);case za:rt=8,et|=8;break;case Aa:return _=Bg(12,$,o,et|2),_.elementType=Aa,_.lanes=tt,_;case Ea:return _=Bg(13,$,o,et),_.elementType=Ea,_.lanes=tt,_;case Fa:return _=Bg(19,$,o,et),_.elementType=Fa,_.lanes=tt,_;case Ia:return qj($,et,tt,o);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case Ba:rt=10;break e;case Ca:rt=9;break e;case Da:rt=11;break e;case Ga:rt=14;break e;case Ha:rt=16,j=null;break e}throw Error(p$1(130,_==null?_:typeof _,""))}return o=Bg(rt,$,o,et),o.elementType=_,o.type=j,o.lanes=tt,o}function Ah(_,o,$,j){return _=Bg(7,_,j,o),_.lanes=$,_}function qj(_,o,$,j){return _=Bg(22,_,j,o),_.elementType=Ia,_.lanes=$,_.stateNode={isHidden:!1},_}function xh(_,o,$){return _=Bg(6,_,null,o),_.lanes=$,_}function zh(_,o,$){return o=Bg(4,_.children!==null?_.children:[],_.key,o),o.lanes=$,o.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},o}function bl(_,o,$,j,et){this.tag=o,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=j,this.onRecoverableError=et,this.mutableSourceEagerHydrationData=null}function cl(_,o,$,j,et,tt,rt,nt,it){return _=new bl(_,o,$,nt,it),o===1?(o=1,tt===!0&&(o|=8)):o=0,tt=Bg(3,null,null,o),_.current=tt,tt.stateNode=_,tt.memoizedState={element:j,isDehydrated:$,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(tt),_}function dl(_,o,$){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:j==null?null:""+j,children:_,containerInfo:o,implementation:$}}function el(_){if(!_)return Vf;_=_._reactInternals;e:{if(Vb(_)!==_||_.tag!==1)throw Error(p$1(170));var o=_;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Zf(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(p$1(171))}if(_.tag===1){var $=_.type;if(Zf($))return bg(_,$,o)}return o}function fl(_,o,$,j,et,tt,rt,nt,it){return _=cl($,j,!0,_,et,tt,rt,nt,it),_.context=el(null),$=_.current,j=L(),et=lh($),tt=ch(j,et),tt.callback=o??null,dh$1($,tt,et),_.current.lanes=et,Ac(_,et,j),Ek(_,j),_}function gl(_,o,$,j){var et=o.current,tt=L(),rt=lh(et);return $=el($),o.context===null?o.context=$:o.pendingContext=$,o=ch(tt,rt),o.payload={element:_},j=j===void 0?null:j,j!==null&&(o.callback=j),_=dh$1(et,o,rt),_!==null&&(mh(_,et,rt,tt),eh(_,et,rt)),rt}function hl$1(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return _.child.stateNode;default:return _.child.stateNode}}function il(_,o){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var $=_.retryLane;_.retryLane=$!==0&&$<o?$:o}}function jl(_,o){il(_,o),(_=_.alternate)&&il(_,o)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(_){console.error(_)};function ml(_){this._internalRoot=_}nl.prototype.render=ml.prototype.render=function(_){var o=this._internalRoot;if(o===null)throw Error(p$1(409));gl(_,o,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var _=this._internalRoot;if(_!==null){this._internalRoot=null;var o=_.containerInfo;Sk(function(){gl(null,_,null,null)}),o[uf]=null}};function nl(_){this._internalRoot=_}nl.prototype.unstable_scheduleHydration=function(_){if(_){var o=Hc();_={blockedOn:null,target:_,priority:o};for(var $=0;$<Qc.length&&o!==0&&o<Qc[$].priority;$++);Qc.splice($,0,_),$===0&&Vc(_)}};function ol(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)}function pl(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11&&(_.nodeType!==8||_.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(_,o,$,j,et){if(et){if(typeof j=="function"){var tt=j;j=function(){var st=hl$1(rt);tt.call(st)}}var rt=fl(o,j,_,0,null,!1,!1,"",ql);return _._reactRootContainer=rt,_[uf]=rt.current,sf(_.nodeType===8?_.parentNode:_),Sk(),rt}for(;et=_.lastChild;)_.removeChild(et);if(typeof j=="function"){var nt=j;j=function(){var st=hl$1(it);nt.call(st)}}var it=cl(_,0,!1,null,null,!1,!1,"",ql);return _._reactRootContainer=it,_[uf]=it.current,sf(_.nodeType===8?_.parentNode:_),Sk(function(){gl(o,it,$,j)}),it}function sl$1(_,o,$,j,et){var tt=$._reactRootContainer;if(tt){var rt=tt;if(typeof et=="function"){var nt=et;et=function(){var it=hl$1(rt);nt.call(it)}}gl(o,rt,_,et)}else rt=rl($,o,_,et,j);return hl$1(rt)}Ec=function(_){switch(_.tag){case 3:var o=_.stateNode;if(o.current.memoizedState.isDehydrated){var $=tc(o.pendingLanes);$!==0&&(Cc(o,$|1),Ek(o,B()),!(K$2&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var j=Zg(_,1);if(j!==null){var et=L();mh(j,_,1,et)}}),jl(_,1)}};Fc=function(_){if(_.tag===13){var o=Zg(_,134217728);if(o!==null){var $=L();mh(o,_,134217728,$)}jl(_,134217728)}};Gc=function(_){if(_.tag===13){var o=lh(_),$=Zg(_,o);if($!==null){var j=L();mh($,_,o,j)}jl(_,o)}};Hc=function(){return C};Ic=function(_,o){var $=C;try{return C=_,o()}finally{C=$}};yb=function(_,o,$){switch(o){case"input":if(bb(_,$),o=$.name,$.type==="radio"&&o!=null){for($=_;$.parentNode;)$=$.parentNode;for($=$.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<$.length;o++){var j=$[o];if(j!==_&&j.form===_.form){var et=Db(j);if(!et)throw Error(p$1(90));Wa(j),bb(j,et)}}}break;case"textarea":ib(_,$);break;case"select":o=$.value,o!=null&&fb(_,!!$.multiple,o,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(_){return _=Zb(_),_===null?null:_.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(_,o){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(o))throw Error(p$1(200));return dl(_,o,null,$)};reactDom_production_min.createRoot=function(_,o){if(!ol(_))throw Error(p$1(299));var $=!1,j="",et=ll;return o!=null&&(o.unstable_strictMode===!0&&($=!0),o.identifierPrefix!==void 0&&(j=o.identifierPrefix),o.onRecoverableError!==void 0&&(et=o.onRecoverableError)),o=cl(_,1,!1,null,null,$,!1,j,et),_[uf]=o.current,sf(_.nodeType===8?_.parentNode:_),new ml(o)};reactDom_production_min.findDOMNode=function(_){if(_==null)return null;if(_.nodeType===1)return _;var o=_._reactInternals;if(o===void 0)throw typeof _.render=="function"?Error(p$1(188)):(_=Object.keys(_).join(","),Error(p$1(268,_)));return _=Zb(o),_=_===null?null:_.stateNode,_};reactDom_production_min.flushSync=function(_){return Sk(_)};reactDom_production_min.hydrate=function(_,o,$){if(!pl(o))throw Error(p$1(200));return sl$1(null,_,o,!0,$)};reactDom_production_min.hydrateRoot=function(_,o,$){if(!ol(_))throw Error(p$1(405));var j=$!=null&&$.hydratedSources||null,et=!1,tt="",rt=ll;if($!=null&&($.unstable_strictMode===!0&&(et=!0),$.identifierPrefix!==void 0&&(tt=$.identifierPrefix),$.onRecoverableError!==void 0&&(rt=$.onRecoverableError)),o=fl(o,null,_,1,$??null,et,!1,tt,rt),_[uf]=o.current,sf(_),j)for(_=0;_<j.length;_++)$=j[_],et=$._getVersion,et=et($._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[$,et]:o.mutableSourceEagerHydrationData.push($,et);return new nl(o)};reactDom_production_min.render=function(_,o,$){if(!pl(o))throw Error(p$1(200));return sl$1(null,_,o,!1,$)};reactDom_production_min.unmountComponentAtNode=function(_){if(!pl(_))throw Error(p$1(40));return _._reactRootContainer?(Sk(function(){sl$1(null,null,_,!1,function(){_._reactRootContainer=null,_[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(_,o,$,j){if(!pl($))throw Error(p$1(200));if(_==null||_._reactInternals===void 0)throw Error(p$1(38));return sl$1(_,o,$,!1,j)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";(function(_){function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch($){console.error($)}}o(),_.exports=reactDom_production_min})(reactDom);const ReactDOM=getDefaultExportFromCjs(reactDomExports);var createRoot,m$2=reactDomExports;createRoot=client.createRoot=m$2.createRoot,client.hydrateRoot=m$2.hydrateRoot;/**
 * @remix-run/router v1.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$5(){return _extends$5=Object.assign?Object.assign.bind():function(_){for(var o=1;o<arguments.length;o++){var $=arguments[o];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends$5.apply(this,arguments)}var Action;(function(_){_.Pop="POP",_.Push="PUSH",_.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(_){_===void 0&&(_={});function o(j,et){let{pathname:tt,search:rt,hash:nt}=j.location;return createLocation("",{pathname:tt,search:rt,hash:nt},et.state&&et.state.usr||null,et.state&&et.state.key||"default")}function $(j,et){return typeof et=="string"?et:createPath(et)}return getUrlBasedHistory(o,$,null,_)}function invariant$1(_,o){if(_===!1||_===null||typeof _>"u")throw new Error(o)}function warning$1(_,o){if(!_){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function createKey$1(){return Math.random().toString(36).substr(2,8)}function getHistoryState(_,o){return{usr:_.state,key:_.key,idx:o}}function createLocation(_,o,$,j){return $===void 0&&($=null),_extends$5({pathname:typeof _=="string"?_:_.pathname,search:"",hash:""},typeof o=="string"?parsePath(o):o,{state:$,key:o&&o.key||j||createKey$1()})}function createPath(_){let{pathname:o="/",search:$="",hash:j=""}=_;return $&&$!=="?"&&(o+=$.charAt(0)==="?"?$:"?"+$),j&&j!=="#"&&(o+=j.charAt(0)==="#"?j:"#"+j),o}function parsePath(_){let o={};if(_){let $=_.indexOf("#");$>=0&&(o.hash=_.substr($),_=_.substr(0,$));let j=_.indexOf("?");j>=0&&(o.search=_.substr(j),_=_.substr(0,j)),_&&(o.pathname=_)}return o}function getUrlBasedHistory(_,o,$,j){j===void 0&&(j={});let{window:et=document.defaultView,v5Compat:tt=!1}=j,rt=et.history,nt=Action.Pop,it=null,st=ot();st==null&&(st=0,rt.replaceState(_extends$5({},rt.state,{idx:st}),""));function ot(){return(rt.state||{idx:null}).idx}function at(){nt=Action.Pop;let mt=ot(),gt=mt==null?null:mt-st;st=mt,it&&it({action:nt,location:ht.location,delta:gt})}function ct(mt,gt){nt=Action.Push;let Et=createLocation(ht.location,mt,gt);$&&$(Et,mt),st=ot()+1;let St=getHistoryState(Et,st),At=ht.createHref(Et);try{rt.pushState(St,"",At)}catch{et.location.assign(At)}tt&&it&&it({action:nt,location:ht.location,delta:1})}function ut(mt,gt){nt=Action.Replace;let Et=createLocation(ht.location,mt,gt);$&&$(Et,mt),st=ot();let St=getHistoryState(Et,st),At=ht.createHref(Et);rt.replaceState(St,"",At),tt&&it&&it({action:nt,location:ht.location,delta:0})}function ft(mt){let gt=et.location.origin!=="null"?et.location.origin:et.location.href,Et=typeof mt=="string"?mt:createPath(mt);return invariant$1(gt,"No window.location.(origin|href) available to create URL for href: "+Et),new URL(Et,gt)}let ht={get action(){return nt},get location(){return _(et,rt)},listen(mt){if(it)throw new Error("A history only accepts one active listener");return et.addEventListener(PopStateEventType,at),it=mt,()=>{et.removeEventListener(PopStateEventType,at),it=null}},createHref(mt){return o(et,mt)},createURL:ft,encodeLocation(mt){let gt=ft(mt);return{pathname:gt.pathname,search:gt.search,hash:gt.hash}},push:ct,replace:ut,go(mt){return rt.go(mt)}};return ht}var ResultType;(function(_){_.data="data",_.deferred="deferred",_.redirect="redirect",_.error="error"})(ResultType||(ResultType={}));function matchRoutes(_,o,$){$===void 0&&($="/");let j=typeof o=="string"?parsePath(o):o,et=stripBasename(j.pathname||"/",$);if(et==null)return null;let tt=flattenRoutes(_);rankRouteBranches(tt);let rt=null;for(let nt=0;rt==null&&nt<tt.length;++nt)rt=matchRouteBranch(tt[nt],safelyDecodeURI(et));return rt}function flattenRoutes(_,o,$,j){o===void 0&&(o=[]),$===void 0&&($=[]),j===void 0&&(j="");let et=(tt,rt,nt)=>{let it={relativePath:nt===void 0?tt.path||"":nt,caseSensitive:tt.caseSensitive===!0,childrenIndex:rt,route:tt};it.relativePath.startsWith("/")&&(invariant$1(it.relativePath.startsWith(j),'Absolute route path "'+it.relativePath+'" nested under path '+('"'+j+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),it.relativePath=it.relativePath.slice(j.length));let st=joinPaths([j,it.relativePath]),ot=$.concat(it);tt.children&&tt.children.length>0&&(invariant$1(tt.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+st+'".')),flattenRoutes(tt.children,o,ot,st)),!(tt.path==null&&!tt.index)&&o.push({path:st,score:computeScore$1(st,tt.index),routesMeta:ot})};return _.forEach((tt,rt)=>{var nt;if(tt.path===""||!((nt=tt.path)!=null&&nt.includes("?")))et(tt,rt);else for(let it of explodeOptionalSegments(tt.path))et(tt,rt,it)}),o}function explodeOptionalSegments(_){let o=_.split("/");if(o.length===0)return[];let[$,...j]=o,et=$.endsWith("?"),tt=$.replace(/\?$/,"");if(j.length===0)return et?[tt,""]:[tt];let rt=explodeOptionalSegments(j.join("/")),nt=[];return nt.push(...rt.map(it=>it===""?tt:[tt,it].join("/"))),et&&nt.push(...rt),nt.map(it=>_.startsWith("/")&&it===""?"/":it)}function rankRouteBranches(_){_.sort((o,$)=>o.score!==$.score?$.score-o.score:compareIndexes(o.routesMeta.map(j=>j.childrenIndex),$.routesMeta.map(j=>j.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=_=>_==="*";function computeScore$1(_,o){let $=_.split("/"),j=$.length;return $.some(isSplat)&&(j+=splatPenalty),o&&(j+=indexRouteValue),$.filter(et=>!isSplat(et)).reduce((et,tt)=>et+(paramRe.test(tt)?dynamicSegmentValue:tt===""?emptySegmentValue:staticSegmentValue),j)}function compareIndexes(_,o){return _.length===o.length&&_.slice(0,-1).every((j,et)=>j===o[et])?_[_.length-1]-o[o.length-1]:0}function matchRouteBranch(_,o){let{routesMeta:$}=_,j={},et="/",tt=[];for(let rt=0;rt<$.length;++rt){let nt=$[rt],it=rt===$.length-1,st=et==="/"?o:o.slice(et.length)||"/",ot=matchPath({path:nt.relativePath,caseSensitive:nt.caseSensitive,end:it},st);if(!ot)return null;Object.assign(j,ot.params);let at=nt.route;tt.push({params:j,pathname:joinPaths([et,ot.pathname]),pathnameBase:normalizePathname(joinPaths([et,ot.pathnameBase])),route:at}),ot.pathnameBase!=="/"&&(et=joinPaths([et,ot.pathnameBase]))}return tt}function matchPath(_,o){typeof _=="string"&&(_={path:_,caseSensitive:!1,end:!0});let[$,j]=compilePath(_.path,_.caseSensitive,_.end),et=o.match($);if(!et)return null;let tt=et[0],rt=tt.replace(/(.)\/+$/,"$1"),nt=et.slice(1);return{params:j.reduce((st,ot,at)=>{if(ot==="*"){let ct=nt[at]||"";rt=tt.slice(0,tt.length-ct.length).replace(/(.)\/+$/,"$1")}return st[ot]=safelyDecodeURIComponent(nt[at]||"",ot),st},{}),pathname:tt,pathnameBase:rt,pattern:_}}function compilePath(_,o,$){o===void 0&&(o=!1),$===void 0&&($=!0),warning$1(_==="*"||!_.endsWith("*")||_.endsWith("/*"),'Route path "'+_+'" will be treated as if it were '+('"'+_.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+_.replace(/\*$/,"/*")+'".'));let j=[],et="^"+_.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(rt,nt)=>(j.push(nt),"/([^\\/]+)"));return _.endsWith("*")?(j.push("*"),et+=_==="*"||_==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):$?et+="\\/*$":_!==""&&_!=="/"&&(et+="(?:(?=\\/|$))"),[new RegExp(et,o?void 0:"i"),j]}function safelyDecodeURI(_){try{return decodeURI(_)}catch(o){return warning$1(!1,'The URL path "'+_+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),_}}function safelyDecodeURIComponent(_,o){try{return decodeURIComponent(_)}catch($){return warning$1(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+_+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+$+").")),_}}function stripBasename(_,o){if(o==="/")return _;if(!_.toLowerCase().startsWith(o.toLowerCase()))return null;let $=o.endsWith("/")?o.length-1:o.length,j=_.charAt($);return j&&j!=="/"?null:_.slice($)||"/"}function resolvePath$2(_,o){o===void 0&&(o="/");let{pathname:$,search:j="",hash:et=""}=typeof _=="string"?parsePath(_):_;return{pathname:$?$.startsWith("/")?$:resolvePathname($,o):o,search:normalizeSearch(j),hash:normalizeHash(et)}}function resolvePathname(_,o){let $=o.replace(/\/+$/,"").split("/");return _.split("/").forEach(et=>{et===".."?$.length>1&&$.pop():et!=="."&&$.push(et)}),$.length>1?$.join("/"):"/"}function getInvalidPathError(_,o,$,j){return"Cannot include a '"+_+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(j)+"].  Please separate it out to the ")+("`to."+$+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(_){return _.filter((o,$)=>$===0||o.route.path&&o.route.path.length>0)}function resolveTo(_,o,$,j){j===void 0&&(j=!1);let et;typeof _=="string"?et=parsePath(_):(et=_extends$5({},_),invariant$1(!et.pathname||!et.pathname.includes("?"),getInvalidPathError("?","pathname","search",et)),invariant$1(!et.pathname||!et.pathname.includes("#"),getInvalidPathError("#","pathname","hash",et)),invariant$1(!et.search||!et.search.includes("#"),getInvalidPathError("#","search","hash",et)));let tt=_===""||et.pathname==="",rt=tt?"/":et.pathname,nt;if(j||rt==null)nt=$;else{let at=o.length-1;if(rt.startsWith("..")){let ct=rt.split("/");for(;ct[0]==="..";)ct.shift(),at-=1;et.pathname=ct.join("/")}nt=at>=0?o[at]:"/"}let it=resolvePath$2(et,nt),st=rt&&rt!=="/"&&rt.endsWith("/"),ot=(tt||rt===".")&&$.endsWith("/");return!it.pathname.endsWith("/")&&(st||ot)&&(it.pathname+="/"),it}const joinPaths=_=>_.join("/").replace(/\/\/+/g,"/"),normalizePathname=_=>_.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=_=>!_||_==="?"?"":_.startsWith("?")?_:"?"+_,normalizeHash=_=>!_||_==="#"?"":_.startsWith("#")?_:"#"+_;function isRouteErrorResponse(_){return _!=null&&typeof _.status=="number"&&typeof _.statusText=="string"&&typeof _.internal=="boolean"&&"data"in _}/**
 * React Router v6.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function isPolyfill(_,o){return _===o&&(_!==0||1/_===1/o)||_!==_&&o!==o}const is$2=typeof Object.is=="function"?Object.is:isPolyfill,{useState,useEffect,useLayoutEffect,useDebugValue}=React$1;function useSyncExternalStore$2(_,o,$){const j=o(),[{inst:et},tt]=useState({inst:{value:j,getSnapshot:o}});return useLayoutEffect(()=>{et.value=j,et.getSnapshot=o,checkIfSnapshotChanged(et)&&tt({inst:et})},[_,j,o]),useEffect(()=>(checkIfSnapshotChanged(et)&&tt({inst:et}),_(()=>{checkIfSnapshotChanged(et)&&tt({inst:et})})),[_]),useDebugValue(j),j}function checkIfSnapshotChanged(_){const o=_.getSnapshot,$=_.value;try{const j=o();return!is$2($,j)}catch{return!0}}function useSyncExternalStore$1(_,o,$){return o()}const canUseDOM$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServerEnvironment=!canUseDOM$1,shim=isServerEnvironment?useSyncExternalStore$1:useSyncExternalStore$2;"useSyncExternalStore"in React$1&&(_=>_.useSyncExternalStore)(React$1);const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[]}),RouteErrorContext=reactExports.createContext(null);function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(_){for(var o=1;o<arguments.length;o++){var $=arguments[o];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends$4.apply(this,arguments)}function useHref(_,o){let{relative:$}=o===void 0?{}:o;useInRouterContext()||invariant$1(!1);let{basename:j,navigator:et}=reactExports.useContext(NavigationContext),{hash:tt,pathname:rt,search:nt}=useResolvedPath(_,{relative:$}),it=rt;return j!=="/"&&(it=rt==="/"?j:joinPaths([j,rt])),et.createHref({pathname:it,search:nt,hash:tt})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant$1(!1),reactExports.useContext(LocationContext).location}function useNavigate(){useInRouterContext()||invariant$1(!1);let{basename:_,navigator:o}=reactExports.useContext(NavigationContext),{matches:$}=reactExports.useContext(RouteContext),{pathname:j}=useLocation(),et=JSON.stringify(getPathContributingMatches($).map(nt=>nt.pathnameBase)),tt=reactExports.useRef(!1);return reactExports.useEffect(()=>{tt.current=!0}),reactExports.useCallback(function(nt,it){if(it===void 0&&(it={}),!tt.current)return;if(typeof nt=="number"){o.go(nt);return}let st=resolveTo(nt,JSON.parse(et),j,it.relative==="path");_!=="/"&&(st.pathname=st.pathname==="/"?_:joinPaths([_,st.pathname])),(it.replace?o.replace:o.push)(st,it.state,it)},[_,o,et,j])}function useParams(){let{matches:_}=reactExports.useContext(RouteContext),o=_[_.length-1];return o?o.params:{}}function useResolvedPath(_,o){let{relative:$}=o===void 0?{}:o,{matches:j}=reactExports.useContext(RouteContext),{pathname:et}=useLocation(),tt=JSON.stringify(getPathContributingMatches(j).map(rt=>rt.pathnameBase));return reactExports.useMemo(()=>resolveTo(_,JSON.parse(tt),et,$==="path"),[_,tt,et,$])}function useRoutes(_,o){useInRouterContext()||invariant$1(!1);let{navigator:$}=reactExports.useContext(NavigationContext),j=reactExports.useContext(DataRouterStateContext),{matches:et}=reactExports.useContext(RouteContext),tt=et[et.length-1],rt=tt?tt.params:{};tt&&tt.pathname;let nt=tt?tt.pathnameBase:"/";tt&&tt.route;let it=useLocation(),st;if(o){var ot;let ht=typeof o=="string"?parsePath(o):o;nt==="/"||(ot=ht.pathname)!=null&&ot.startsWith(nt)||invariant$1(!1),st=ht}else st=it;let at=st.pathname||"/",ct=nt==="/"?at:at.slice(nt.length)||"/",ut=matchRoutes(_,{pathname:ct}),ft=_renderMatches(ut&&ut.map(ht=>Object.assign({},ht,{params:Object.assign({},rt,ht.params),pathname:joinPaths([nt,$.encodeLocation?$.encodeLocation(ht.pathname).pathname:ht.pathname]),pathnameBase:ht.pathnameBase==="/"?nt:joinPaths([nt,$.encodeLocation?$.encodeLocation(ht.pathnameBase).pathname:ht.pathnameBase])})),et,j||void 0);return o&&ft?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$4({pathname:"/",search:"",hash:"",state:null,key:"default"},st),navigationType:Action.Pop}},ft):ft}function DefaultErrorComponent(){let _=useRouteError(),o=isRouteErrorResponse(_)?_.status+" "+_.statusText:_ instanceof Error?_.message:JSON.stringify(_),$=_ instanceof Error?_.stack:null,et={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},tt=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},o),$?reactExports.createElement("pre",{style:et},$):null,tt)}class RenderErrorBoundary extends reactExports.Component{constructor(o){super(o),this.state={location:o.location,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,$){return $.location!==o.location?{error:o.error,location:o.location}:{error:o.error||$.error,location:$.location}}componentDidCatch(o,$){console.error("React Router caught the following error during render",o,$)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(_){let{routeContext:o,match:$,children:j}=_,et=reactExports.useContext(DataRouterContext);return et&&et.static&&et.staticContext&&($.route.errorElement||$.route.ErrorBoundary)&&(et.staticContext._deepestRenderedBoundaryId=$.route.id),reactExports.createElement(RouteContext.Provider,{value:o},j)}function _renderMatches(_,o,$){if(o===void 0&&(o=[]),_==null)if($!=null&&$.errors)_=$.matches;else return null;let j=_,et=$==null?void 0:$.errors;if(et!=null){let tt=j.findIndex(rt=>rt.route.id&&(et==null?void 0:et[rt.route.id]));tt>=0||invariant$1(!1),j=j.slice(0,Math.min(j.length,tt+1))}return j.reduceRight((tt,rt,nt)=>{let it=rt.route.id?et==null?void 0:et[rt.route.id]:null,st=null;$&&(rt.route.ErrorBoundary?st=reactExports.createElement(rt.route.ErrorBoundary,null):rt.route.errorElement?st=rt.route.errorElement:st=reactExports.createElement(DefaultErrorComponent,null));let ot=o.concat(j.slice(0,nt+1)),at=()=>{let ct=tt;return it?ct=st:rt.route.Component?ct=reactExports.createElement(rt.route.Component,null):rt.route.element&&(ct=rt.route.element),reactExports.createElement(RenderedRoute,{match:rt,routeContext:{outlet:tt,matches:ot},children:ct})};return $&&(rt.route.ErrorBoundary||rt.route.errorElement||nt===0)?reactExports.createElement(RenderErrorBoundary,{location:$.location,component:st,error:it,children:at(),routeContext:{outlet:null,matches:ot}}):at()},null)}var DataRouterHook$1;(function(_){_.UseBlocker="useBlocker",_.UseRevalidator="useRevalidator"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(_){_.UseBlocker="useBlocker",_.UseLoaderData="useLoaderData",_.UseActionData="useActionData",_.UseRouteError="useRouteError",_.UseNavigation="useNavigation",_.UseRouteLoaderData="useRouteLoaderData",_.UseMatches="useMatches",_.UseRevalidator="useRevalidator"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterState(_){let o=reactExports.useContext(DataRouterStateContext);return o||invariant$1(!1),o}function useRouteContext(_){let o=reactExports.useContext(RouteContext);return o||invariant$1(!1),o}function useCurrentRouteId(_){let o=useRouteContext(),$=o.matches[o.matches.length-1];return $.route.id||invariant$1(!1),$.route.id}function useRouteError(){var _;let o=reactExports.useContext(RouteErrorContext),$=useDataRouterState(DataRouterStateHook$1.UseRouteError),j=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return o||((_=$.errors)==null?void 0:_[j])}function Router(_){let{basename:o="/",children:$=null,location:j,navigationType:et=Action.Pop,navigator:tt,static:rt=!1}=_;useInRouterContext()&&invariant$1(!1);let nt=o.replace(/^\/*/,"/"),it=reactExports.useMemo(()=>({basename:nt,navigator:tt,static:rt}),[nt,tt,rt]);typeof j=="string"&&(j=parsePath(j));let{pathname:st="/",search:ot="",hash:at="",state:ct=null,key:ut="default"}=j,ft=reactExports.useMemo(()=>{let ht=stripBasename(st,nt);return ht==null?null:{location:{pathname:ht,search:ot,hash:at,state:ct,key:ut},navigationType:et}},[nt,st,ot,at,ct,ut,et]);return ft==null?null:reactExports.createElement(NavigationContext.Provider,{value:it},reactExports.createElement(LocationContext.Provider,{children:$,value:ft}))}var AwaitRenderStatus;(function(_){_[_.pending=0]="pending",_[_.success=1]="success",_[_.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});/**
 * React Router DOM v6.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(_){for(var o=1;o<arguments.length;o++){var $=arguments[o];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends$3.apply(this,arguments)}function _objectWithoutPropertiesLoose$1(_,o){if(_==null)return{};var $={},j=Object.keys(_),et,tt;for(tt=0;tt<j.length;tt++)et=j[tt],!(o.indexOf(et)>=0)&&($[et]=_[et]);return $}function isModifiedEvent(_){return!!(_.metaKey||_.altKey||_.ctrlKey||_.shiftKey)}function shouldProcessLinkClick(_,o){return _.button===0&&(!o||o==="_self")&&!isModifiedEvent(_)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function BrowserRouter(_){let{basename:o,children:$,window:j}=_,et=reactExports.useRef();et.current==null&&(et.current=createBrowserHistory({window:j,v5Compat:!0}));let tt=et.current,[rt,nt]=reactExports.useState({action:tt.action,location:tt.location});return reactExports.useLayoutEffect(()=>tt.listen(nt),[tt]),reactExports.createElement(Router,{basename:o,children:$,location:rt.location,navigationType:rt.action,navigator:tt})}const isBrowser$6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link$1=reactExports.forwardRef(function(o,$){let{onClick:j,relative:et,reloadDocument:tt,replace:rt,state:nt,target:it,to:st,preventScrollReset:ot}=o,at=_objectWithoutPropertiesLoose$1(o,_excluded),{basename:ct}=reactExports.useContext(NavigationContext),ut,ft=!1;if(typeof st=="string"&&ABSOLUTE_URL_REGEX.test(st)&&(ut=st,isBrowser$6)){let Et=new URL(window.location.href),St=st.startsWith("//")?new URL(Et.protocol+st):new URL(st),At=stripBasename(St.pathname,ct);St.origin===Et.origin&&At!=null?st=At+St.search+St.hash:ft=!0}let ht=useHref(st,{relative:et}),mt=useLinkClickHandler(st,{replace:rt,state:nt,target:it,preventScrollReset:ot,relative:et});function gt(Et){j&&j(Et),Et.defaultPrevented||mt(Et)}return reactExports.createElement("a",_extends$3({},at,{href:ut||ht,onClick:ft||tt?j:gt,ref:$,target:it}))});var DataRouterHook;(function(_){_.UseScrollRestoration="useScrollRestoration",_.UseSubmitImpl="useSubmitImpl",_.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(_){_.UseFetchers="useFetchers",_.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(_,o){let{target:$,replace:j,state:et,preventScrollReset:tt,relative:rt}=o===void 0?{}:o,nt=useNavigate(),it=useLocation(),st=useResolvedPath(_,{relative:rt});return reactExports.useCallback(ot=>{if(shouldProcessLinkClick(ot,$)){ot.preventDefault();let at=j!==void 0?j:createPath(it)===createPath(st);nt(_,{replace:at,state:et,preventScrollReset:tt,relative:rt})}},[it,nt,st,j,et,$,_,tt,rt])}var buffer$2={},base64Js={};base64Js.byteLength=byteLength$1;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup$3=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code$a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$1=0,len=code$a.length;i$1<len;++i$1)lookup$3[i$1]=code$a[i$1],revLookup[code$a.charCodeAt(i$1)]=i$1;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(_){var o=_.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var $=_.indexOf("=");$===-1&&($=o);var j=$===o?0:4-$%4;return[$,j]}function byteLength$1(_){var o=getLens(_),$=o[0],j=o[1];return($+j)*3/4-j}function _byteLength(_,o,$){return(o+$)*3/4-$}function toByteArray(_){var o,$=getLens(_),j=$[0],et=$[1],tt=new Arr(_byteLength(_,j,et)),rt=0,nt=et>0?j-4:j,it;for(it=0;it<nt;it+=4)o=revLookup[_.charCodeAt(it)]<<18|revLookup[_.charCodeAt(it+1)]<<12|revLookup[_.charCodeAt(it+2)]<<6|revLookup[_.charCodeAt(it+3)],tt[rt++]=o>>16&255,tt[rt++]=o>>8&255,tt[rt++]=o&255;return et===2&&(o=revLookup[_.charCodeAt(it)]<<2|revLookup[_.charCodeAt(it+1)]>>4,tt[rt++]=o&255),et===1&&(o=revLookup[_.charCodeAt(it)]<<10|revLookup[_.charCodeAt(it+1)]<<4|revLookup[_.charCodeAt(it+2)]>>2,tt[rt++]=o>>8&255,tt[rt++]=o&255),tt}function tripletToBase64(_){return lookup$3[_>>18&63]+lookup$3[_>>12&63]+lookup$3[_>>6&63]+lookup$3[_&63]}function encodeChunk(_,o,$){for(var j,et=[],tt=o;tt<$;tt+=3)j=(_[tt]<<16&16711680)+(_[tt+1]<<8&65280)+(_[tt+2]&255),et.push(tripletToBase64(j));return et.join("")}function fromByteArray(_){for(var o,$=_.length,j=$%3,et=[],tt=16383,rt=0,nt=$-j;rt<nt;rt+=tt)et.push(encodeChunk(_,rt,rt+tt>nt?nt:rt+tt));return j===1?(o=_[$-1],et.push(lookup$3[o>>2]+lookup$3[o<<4&63]+"==")):j===2&&(o=(_[$-2]<<8)+_[$-1],et.push(lookup$3[o>>10]+lookup$3[o>>4&63]+lookup$3[o<<2&63]+"=")),et.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(_,o,$,j,et){var tt,rt,nt=et*8-j-1,it=(1<<nt)-1,st=it>>1,ot=-7,at=$?et-1:0,ct=$?-1:1,ut=_[o+at];for(at+=ct,tt=ut&(1<<-ot)-1,ut>>=-ot,ot+=nt;ot>0;tt=tt*256+_[o+at],at+=ct,ot-=8);for(rt=tt&(1<<-ot)-1,tt>>=-ot,ot+=j;ot>0;rt=rt*256+_[o+at],at+=ct,ot-=8);if(tt===0)tt=1-st;else{if(tt===it)return rt?NaN:(ut?-1:1)*(1/0);rt=rt+Math.pow(2,j),tt=tt-st}return(ut?-1:1)*rt*Math.pow(2,tt-j)};ieee754.write=function(_,o,$,j,et,tt){var rt,nt,it,st=tt*8-et-1,ot=(1<<st)-1,at=ot>>1,ct=et===23?Math.pow(2,-24)-Math.pow(2,-77):0,ut=j?0:tt-1,ft=j?1:-1,ht=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(nt=isNaN(o)?1:0,rt=ot):(rt=Math.floor(Math.log(o)/Math.LN2),o*(it=Math.pow(2,-rt))<1&&(rt--,it*=2),rt+at>=1?o+=ct/it:o+=ct*Math.pow(2,1-at),o*it>=2&&(rt++,it/=2),rt+at>=ot?(nt=0,rt=ot):rt+at>=1?(nt=(o*it-1)*Math.pow(2,et),rt=rt+at):(nt=o*Math.pow(2,at-1)*Math.pow(2,et),rt=0));et>=8;_[$+ut]=nt&255,ut+=ft,nt/=256,et-=8);for(rt=rt<<et|nt,st+=et;st>0;_[$+ut]=rt&255,ut+=ft,rt/=256,st-=8);_[$+ut-ft]|=ht*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(_){var o=base64Js,$=ieee754,j=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;_.Buffer=nt,_.SlowBuffer=Et,_.INSPECT_MAX_BYTES=50;var et=2147483647;_.kMaxLength=et,nt.TYPED_ARRAY_SUPPORT=tt(),!nt.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function tt(){try{var Zt=new Uint8Array(1),Bt={foo:function(){return 42}};return Object.setPrototypeOf(Bt,Uint8Array.prototype),Object.setPrototypeOf(Zt,Bt),Zt.foo()===42}catch{return!1}}Object.defineProperty(nt.prototype,"parent",{enumerable:!0,get:function(){if(nt.isBuffer(this))return this.buffer}}),Object.defineProperty(nt.prototype,"offset",{enumerable:!0,get:function(){if(nt.isBuffer(this))return this.byteOffset}});function rt(Zt){if(Zt>et)throw new RangeError('The value "'+Zt+'" is invalid for option "size"');var Bt=new Uint8Array(Zt);return Object.setPrototypeOf(Bt,nt.prototype),Bt}function nt(Zt,Bt,Ft){if(typeof Zt=="number"){if(typeof Bt=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return at(Zt)}return it(Zt,Bt,Ft)}nt.poolSize=8192;function it(Zt,Bt,Ft){if(typeof Zt=="string")return ct(Zt,Bt);if(ArrayBuffer.isView(Zt))return ft(Zt);if(Zt==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Zt);if(lr(Zt,ArrayBuffer)||Zt&&lr(Zt.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(lr(Zt,SharedArrayBuffer)||Zt&&lr(Zt.buffer,SharedArrayBuffer)))return ht(Zt,Bt,Ft);if(typeof Zt=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var zt=Zt.valueOf&&Zt.valueOf();if(zt!=null&&zt!==Zt)return nt.from(zt,Bt,Ft);var Qt=mt(Zt);if(Qt)return Qt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Zt[Symbol.toPrimitive]=="function")return nt.from(Zt[Symbol.toPrimitive]("string"),Bt,Ft);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Zt)}nt.from=function(Zt,Bt,Ft){return it(Zt,Bt,Ft)},Object.setPrototypeOf(nt.prototype,Uint8Array.prototype),Object.setPrototypeOf(nt,Uint8Array);function st(Zt){if(typeof Zt!="number")throw new TypeError('"size" argument must be of type number');if(Zt<0)throw new RangeError('The value "'+Zt+'" is invalid for option "size"')}function ot(Zt,Bt,Ft){return st(Zt),Zt<=0?rt(Zt):Bt!==void 0?typeof Ft=="string"?rt(Zt).fill(Bt,Ft):rt(Zt).fill(Bt):rt(Zt)}nt.alloc=function(Zt,Bt,Ft){return ot(Zt,Bt,Ft)};function at(Zt){return st(Zt),rt(Zt<0?0:gt(Zt)|0)}nt.allocUnsafe=function(Zt){return at(Zt)},nt.allocUnsafeSlow=function(Zt){return at(Zt)};function ct(Zt,Bt){if((typeof Bt!="string"||Bt==="")&&(Bt="utf8"),!nt.isEncoding(Bt))throw new TypeError("Unknown encoding: "+Bt);var Ft=St(Zt,Bt)|0,zt=rt(Ft),Qt=zt.write(Zt,Bt);return Qt!==Ft&&(zt=zt.slice(0,Qt)),zt}function ut(Zt){for(var Bt=Zt.length<0?0:gt(Zt.length)|0,Ft=rt(Bt),zt=0;zt<Bt;zt+=1)Ft[zt]=Zt[zt]&255;return Ft}function ft(Zt){if(lr(Zt,Uint8Array)){var Bt=new Uint8Array(Zt);return ht(Bt.buffer,Bt.byteOffset,Bt.byteLength)}return ut(Zt)}function ht(Zt,Bt,Ft){if(Bt<0||Zt.byteLength<Bt)throw new RangeError('"offset" is outside of buffer bounds');if(Zt.byteLength<Bt+(Ft||0))throw new RangeError('"length" is outside of buffer bounds');var zt;return Bt===void 0&&Ft===void 0?zt=new Uint8Array(Zt):Ft===void 0?zt=new Uint8Array(Zt,Bt):zt=new Uint8Array(Zt,Bt,Ft),Object.setPrototypeOf(zt,nt.prototype),zt}function mt(Zt){if(nt.isBuffer(Zt)){var Bt=gt(Zt.length)|0,Ft=rt(Bt);return Ft.length===0||Zt.copy(Ft,0,0,Bt),Ft}if(Zt.length!==void 0)return typeof Zt.length!="number"||cr(Zt.length)?rt(0):ut(Zt);if(Zt.type==="Buffer"&&Array.isArray(Zt.data))return ut(Zt.data)}function gt(Zt){if(Zt>=et)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+et.toString(16)+" bytes");return Zt|0}function Et(Zt){return+Zt!=Zt&&(Zt=0),nt.alloc(+Zt)}nt.isBuffer=function(Bt){return Bt!=null&&Bt._isBuffer===!0&&Bt!==nt.prototype},nt.compare=function(Bt,Ft){if(lr(Bt,Uint8Array)&&(Bt=nt.from(Bt,Bt.offset,Bt.byteLength)),lr(Ft,Uint8Array)&&(Ft=nt.from(Ft,Ft.offset,Ft.byteLength)),!nt.isBuffer(Bt)||!nt.isBuffer(Ft))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Bt===Ft)return 0;for(var zt=Bt.length,Qt=Ft.length,nr=0,gr=Math.min(zt,Qt);nr<gr;++nr)if(Bt[nr]!==Ft[nr]){zt=Bt[nr],Qt=Ft[nr];break}return zt<Qt?-1:Qt<zt?1:0},nt.isEncoding=function(Bt){switch(String(Bt).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},nt.concat=function(Bt,Ft){if(!Array.isArray(Bt))throw new TypeError('"list" argument must be an Array of Buffers');if(Bt.length===0)return nt.alloc(0);var zt;if(Ft===void 0)for(Ft=0,zt=0;zt<Bt.length;++zt)Ft+=Bt[zt].length;var Qt=nt.allocUnsafe(Ft),nr=0;for(zt=0;zt<Bt.length;++zt){var gr=Bt[zt];if(lr(gr,Uint8Array))nr+gr.length>Qt.length?nt.from(gr).copy(Qt,nr):Uint8Array.prototype.set.call(Qt,gr,nr);else if(nt.isBuffer(gr))gr.copy(Qt,nr);else throw new TypeError('"list" argument must be an Array of Buffers');nr+=gr.length}return Qt};function St(Zt,Bt){if(nt.isBuffer(Zt))return Zt.length;if(ArrayBuffer.isView(Zt)||lr(Zt,ArrayBuffer))return Zt.byteLength;if(typeof Zt!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Zt);var Ft=Zt.length,zt=arguments.length>2&&arguments[2]===!0;if(!zt&&Ft===0)return 0;for(var Qt=!1;;)switch(Bt){case"ascii":case"latin1":case"binary":return Ft;case"utf8":case"utf-8":return Vt(Zt).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ft*2;case"hex":return Ft>>>1;case"base64":return Lt(Zt).length;default:if(Qt)return zt?-1:Vt(Zt).length;Bt=(""+Bt).toLowerCase(),Qt=!0}}nt.byteLength=St;function At(Zt,Bt,Ft){var zt=!1;if((Bt===void 0||Bt<0)&&(Bt=0),Bt>this.length||((Ft===void 0||Ft>this.length)&&(Ft=this.length),Ft<=0)||(Ft>>>=0,Bt>>>=0,Ft<=Bt))return"";for(Zt||(Zt="utf8");;)switch(Zt){case"hex":return Ct(this,Bt,Ft);case"utf8":case"utf-8":return lt(this,Bt,Ft);case"ascii":return _t(this,Bt,Ft);case"latin1":case"binary":return $t(this,Bt,Ft);case"base64":return yt(this,Bt,Ft);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xt(this,Bt,Ft);default:if(zt)throw new TypeError("Unknown encoding: "+Zt);Zt=(Zt+"").toLowerCase(),zt=!0}}nt.prototype._isBuffer=!0;function kt(Zt,Bt,Ft){var zt=Zt[Bt];Zt[Bt]=Zt[Ft],Zt[Ft]=zt}nt.prototype.swap16=function(){var Bt=this.length;if(Bt%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Ft=0;Ft<Bt;Ft+=2)kt(this,Ft,Ft+1);return this},nt.prototype.swap32=function(){var Bt=this.length;if(Bt%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Ft=0;Ft<Bt;Ft+=4)kt(this,Ft,Ft+3),kt(this,Ft+1,Ft+2);return this},nt.prototype.swap64=function(){var Bt=this.length;if(Bt%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Ft=0;Ft<Bt;Ft+=8)kt(this,Ft,Ft+7),kt(this,Ft+1,Ft+6),kt(this,Ft+2,Ft+5),kt(this,Ft+3,Ft+4);return this},nt.prototype.toString=function(){var Bt=this.length;return Bt===0?"":arguments.length===0?lt(this,0,Bt):At.apply(this,arguments)},nt.prototype.toLocaleString=nt.prototype.toString,nt.prototype.equals=function(Bt){if(!nt.isBuffer(Bt))throw new TypeError("Argument must be a Buffer");return this===Bt?!0:nt.compare(this,Bt)===0},nt.prototype.inspect=function(){var Bt="",Ft=_.INSPECT_MAX_BYTES;return Bt=this.toString("hex",0,Ft).replace(/(.{2})/g,"$1 ").trim(),this.length>Ft&&(Bt+=" ... "),"<Buffer "+Bt+">"},j&&(nt.prototype[j]=nt.prototype.inspect),nt.prototype.compare=function(Bt,Ft,zt,Qt,nr){if(lr(Bt,Uint8Array)&&(Bt=nt.from(Bt,Bt.offset,Bt.byteLength)),!nt.isBuffer(Bt))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Bt);if(Ft===void 0&&(Ft=0),zt===void 0&&(zt=Bt?Bt.length:0),Qt===void 0&&(Qt=0),nr===void 0&&(nr=this.length),Ft<0||zt>Bt.length||Qt<0||nr>this.length)throw new RangeError("out of range index");if(Qt>=nr&&Ft>=zt)return 0;if(Qt>=nr)return-1;if(Ft>=zt)return 1;if(Ft>>>=0,zt>>>=0,Qt>>>=0,nr>>>=0,this===Bt)return 0;for(var gr=nr-Qt,br=zt-Ft,vr=Math.min(gr,br),Nr=this.slice(Qt,nr),ar=Bt.slice(Ft,zt),er=0;er<vr;++er)if(Nr[er]!==ar[er]){gr=Nr[er],br=ar[er];break}return gr<br?-1:br<gr?1:0};function Rt(Zt,Bt,Ft,zt,Qt){if(Zt.length===0)return-1;if(typeof Ft=="string"?(zt=Ft,Ft=0):Ft>2147483647?Ft=2147483647:Ft<-2147483648&&(Ft=-2147483648),Ft=+Ft,cr(Ft)&&(Ft=Qt?0:Zt.length-1),Ft<0&&(Ft=Zt.length+Ft),Ft>=Zt.length){if(Qt)return-1;Ft=Zt.length-1}else if(Ft<0)if(Qt)Ft=0;else return-1;if(typeof Bt=="string"&&(Bt=nt.from(Bt,zt)),nt.isBuffer(Bt))return Bt.length===0?-1:Tt(Zt,Bt,Ft,zt,Qt);if(typeof Bt=="number")return Bt=Bt&255,typeof Uint8Array.prototype.indexOf=="function"?Qt?Uint8Array.prototype.indexOf.call(Zt,Bt,Ft):Uint8Array.prototype.lastIndexOf.call(Zt,Bt,Ft):Tt(Zt,[Bt],Ft,zt,Qt);throw new TypeError("val must be string, number or Buffer")}function Tt(Zt,Bt,Ft,zt,Qt){var nr=1,gr=Zt.length,br=Bt.length;if(zt!==void 0&&(zt=String(zt).toLowerCase(),zt==="ucs2"||zt==="ucs-2"||zt==="utf16le"||zt==="utf-16le")){if(Zt.length<2||Bt.length<2)return-1;nr=2,gr/=2,br/=2,Ft/=2}function vr(tr,ur){return nr===1?tr[ur]:tr.readUInt16BE(ur*nr)}var Nr;if(Qt){var ar=-1;for(Nr=Ft;Nr<gr;Nr++)if(vr(Zt,Nr)===vr(Bt,ar===-1?0:Nr-ar)){if(ar===-1&&(ar=Nr),Nr-ar+1===br)return ar*nr}else ar!==-1&&(Nr-=Nr-ar),ar=-1}else for(Ft+br>gr&&(Ft=gr-br),Nr=Ft;Nr>=0;Nr--){for(var er=!0,Xt=0;Xt<br;Xt++)if(vr(Zt,Nr+Xt)!==vr(Bt,Xt)){er=!1;break}if(er)return Nr}return-1}nt.prototype.includes=function(Bt,Ft,zt){return this.indexOf(Bt,Ft,zt)!==-1},nt.prototype.indexOf=function(Bt,Ft,zt){return Rt(this,Bt,Ft,zt,!0)},nt.prototype.lastIndexOf=function(Bt,Ft,zt){return Rt(this,Bt,Ft,zt,!1)};function Dt(Zt,Bt,Ft,zt){Ft=Number(Ft)||0;var Qt=Zt.length-Ft;zt?(zt=Number(zt),zt>Qt&&(zt=Qt)):zt=Qt;var nr=Bt.length;zt>nr/2&&(zt=nr/2);for(var gr=0;gr<zt;++gr){var br=parseInt(Bt.substr(gr*2,2),16);if(cr(br))return gr;Zt[Ft+gr]=br}return gr}function Ot(Zt,Bt,Ft,zt){return Yt(Vt(Bt,Zt.length-Ft),Zt,Ft,zt)}function jt(Zt,Bt,Ft,zt){return Yt(Ut(Bt),Zt,Ft,zt)}function Nt(Zt,Bt,Ft,zt){return Yt(Lt(Bt),Zt,Ft,zt)}function It(Zt,Bt,Ft,zt){return Yt(Mt(Bt,Zt.length-Ft),Zt,Ft,zt)}nt.prototype.write=function(Bt,Ft,zt,Qt){if(Ft===void 0)Qt="utf8",zt=this.length,Ft=0;else if(zt===void 0&&typeof Ft=="string")Qt=Ft,zt=this.length,Ft=0;else if(isFinite(Ft))Ft=Ft>>>0,isFinite(zt)?(zt=zt>>>0,Qt===void 0&&(Qt="utf8")):(Qt=zt,zt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var nr=this.length-Ft;if((zt===void 0||zt>nr)&&(zt=nr),Bt.length>0&&(zt<0||Ft<0)||Ft>this.length)throw new RangeError("Attempt to write outside buffer bounds");Qt||(Qt="utf8");for(var gr=!1;;)switch(Qt){case"hex":return Dt(this,Bt,Ft,zt);case"utf8":case"utf-8":return Ot(this,Bt,Ft,zt);case"ascii":case"latin1":case"binary":return jt(this,Bt,Ft,zt);case"base64":return Nt(this,Bt,Ft,zt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return It(this,Bt,Ft,zt);default:if(gr)throw new TypeError("Unknown encoding: "+Qt);Qt=(""+Qt).toLowerCase(),gr=!0}},nt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function yt(Zt,Bt,Ft){return Bt===0&&Ft===Zt.length?o.fromByteArray(Zt):o.fromByteArray(Zt.slice(Bt,Ft))}function lt(Zt,Bt,Ft){Ft=Math.min(Zt.length,Ft);for(var zt=[],Qt=Bt;Qt<Ft;){var nr=Zt[Qt],gr=null,br=nr>239?4:nr>223?3:nr>191?2:1;if(Qt+br<=Ft){var vr,Nr,ar,er;switch(br){case 1:nr<128&&(gr=nr);break;case 2:vr=Zt[Qt+1],(vr&192)===128&&(er=(nr&31)<<6|vr&63,er>127&&(gr=er));break;case 3:vr=Zt[Qt+1],Nr=Zt[Qt+2],(vr&192)===128&&(Nr&192)===128&&(er=(nr&15)<<12|(vr&63)<<6|Nr&63,er>2047&&(er<55296||er>57343)&&(gr=er));break;case 4:vr=Zt[Qt+1],Nr=Zt[Qt+2],ar=Zt[Qt+3],(vr&192)===128&&(Nr&192)===128&&(ar&192)===128&&(er=(nr&15)<<18|(vr&63)<<12|(Nr&63)<<6|ar&63,er>65535&&er<1114112&&(gr=er))}}gr===null?(gr=65533,br=1):gr>65535&&(gr-=65536,zt.push(gr>>>10&1023|55296),gr=56320|gr&1023),zt.push(gr),Qt+=br}return bt(zt)}var pt=4096;function bt(Zt){var Bt=Zt.length;if(Bt<=pt)return String.fromCharCode.apply(String,Zt);for(var Ft="",zt=0;zt<Bt;)Ft+=String.fromCharCode.apply(String,Zt.slice(zt,zt+=pt));return Ft}function _t(Zt,Bt,Ft){var zt="";Ft=Math.min(Zt.length,Ft);for(var Qt=Bt;Qt<Ft;++Qt)zt+=String.fromCharCode(Zt[Qt]&127);return zt}function $t(Zt,Bt,Ft){var zt="";Ft=Math.min(Zt.length,Ft);for(var Qt=Bt;Qt<Ft;++Qt)zt+=String.fromCharCode(Zt[Qt]);return zt}function Ct(Zt,Bt,Ft){var zt=Zt.length;(!Bt||Bt<0)&&(Bt=0),(!Ft||Ft<0||Ft>zt)&&(Ft=zt);for(var Qt="",nr=Bt;nr<Ft;++nr)Qt+=ir[Zt[nr]];return Qt}function xt(Zt,Bt,Ft){for(var zt=Zt.slice(Bt,Ft),Qt="",nr=0;nr<zt.length-1;nr+=2)Qt+=String.fromCharCode(zt[nr]+zt[nr+1]*256);return Qt}nt.prototype.slice=function(Bt,Ft){var zt=this.length;Bt=~~Bt,Ft=Ft===void 0?zt:~~Ft,Bt<0?(Bt+=zt,Bt<0&&(Bt=0)):Bt>zt&&(Bt=zt),Ft<0?(Ft+=zt,Ft<0&&(Ft=0)):Ft>zt&&(Ft=zt),Ft<Bt&&(Ft=Bt);var Qt=this.subarray(Bt,Ft);return Object.setPrototypeOf(Qt,nt.prototype),Qt};function vt(Zt,Bt,Ft){if(Zt%1!==0||Zt<0)throw new RangeError("offset is not uint");if(Zt+Bt>Ft)throw new RangeError("Trying to access beyond buffer length")}nt.prototype.readUintLE=nt.prototype.readUIntLE=function(Bt,Ft,zt){Bt=Bt>>>0,Ft=Ft>>>0,zt||vt(Bt,Ft,this.length);for(var Qt=this[Bt],nr=1,gr=0;++gr<Ft&&(nr*=256);)Qt+=this[Bt+gr]*nr;return Qt},nt.prototype.readUintBE=nt.prototype.readUIntBE=function(Bt,Ft,zt){Bt=Bt>>>0,Ft=Ft>>>0,zt||vt(Bt,Ft,this.length);for(var Qt=this[Bt+--Ft],nr=1;Ft>0&&(nr*=256);)Qt+=this[Bt+--Ft]*nr;return Qt},nt.prototype.readUint8=nt.prototype.readUInt8=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,1,this.length),this[Bt]},nt.prototype.readUint16LE=nt.prototype.readUInt16LE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,2,this.length),this[Bt]|this[Bt+1]<<8},nt.prototype.readUint16BE=nt.prototype.readUInt16BE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,2,this.length),this[Bt]<<8|this[Bt+1]},nt.prototype.readUint32LE=nt.prototype.readUInt32LE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,4,this.length),(this[Bt]|this[Bt+1]<<8|this[Bt+2]<<16)+this[Bt+3]*16777216},nt.prototype.readUint32BE=nt.prototype.readUInt32BE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,4,this.length),this[Bt]*16777216+(this[Bt+1]<<16|this[Bt+2]<<8|this[Bt+3])},nt.prototype.readIntLE=function(Bt,Ft,zt){Bt=Bt>>>0,Ft=Ft>>>0,zt||vt(Bt,Ft,this.length);for(var Qt=this[Bt],nr=1,gr=0;++gr<Ft&&(nr*=256);)Qt+=this[Bt+gr]*nr;return nr*=128,Qt>=nr&&(Qt-=Math.pow(2,8*Ft)),Qt},nt.prototype.readIntBE=function(Bt,Ft,zt){Bt=Bt>>>0,Ft=Ft>>>0,zt||vt(Bt,Ft,this.length);for(var Qt=Ft,nr=1,gr=this[Bt+--Qt];Qt>0&&(nr*=256);)gr+=this[Bt+--Qt]*nr;return nr*=128,gr>=nr&&(gr-=Math.pow(2,8*Ft)),gr},nt.prototype.readInt8=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,1,this.length),this[Bt]&128?(255-this[Bt]+1)*-1:this[Bt]},nt.prototype.readInt16LE=function(Bt,Ft){Bt=Bt>>>0,Ft||vt(Bt,2,this.length);var zt=this[Bt]|this[Bt+1]<<8;return zt&32768?zt|4294901760:zt},nt.prototype.readInt16BE=function(Bt,Ft){Bt=Bt>>>0,Ft||vt(Bt,2,this.length);var zt=this[Bt+1]|this[Bt]<<8;return zt&32768?zt|4294901760:zt},nt.prototype.readInt32LE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,4,this.length),this[Bt]|this[Bt+1]<<8|this[Bt+2]<<16|this[Bt+3]<<24},nt.prototype.readInt32BE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,4,this.length),this[Bt]<<24|this[Bt+1]<<16|this[Bt+2]<<8|this[Bt+3]},nt.prototype.readFloatLE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,4,this.length),$.read(this,Bt,!0,23,4)},nt.prototype.readFloatBE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,4,this.length),$.read(this,Bt,!1,23,4)},nt.prototype.readDoubleLE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,8,this.length),$.read(this,Bt,!0,52,8)},nt.prototype.readDoubleBE=function(Bt,Ft){return Bt=Bt>>>0,Ft||vt(Bt,8,this.length),$.read(this,Bt,!1,52,8)};function dt(Zt,Bt,Ft,zt,Qt,nr){if(!nt.isBuffer(Zt))throw new TypeError('"buffer" argument must be a Buffer instance');if(Bt>Qt||Bt<nr)throw new RangeError('"value" argument is out of bounds');if(Ft+zt>Zt.length)throw new RangeError("Index out of range")}nt.prototype.writeUintLE=nt.prototype.writeUIntLE=function(Bt,Ft,zt,Qt){if(Bt=+Bt,Ft=Ft>>>0,zt=zt>>>0,!Qt){var nr=Math.pow(2,8*zt)-1;dt(this,Bt,Ft,zt,nr,0)}var gr=1,br=0;for(this[Ft]=Bt&255;++br<zt&&(gr*=256);)this[Ft+br]=Bt/gr&255;return Ft+zt},nt.prototype.writeUintBE=nt.prototype.writeUIntBE=function(Bt,Ft,zt,Qt){if(Bt=+Bt,Ft=Ft>>>0,zt=zt>>>0,!Qt){var nr=Math.pow(2,8*zt)-1;dt(this,Bt,Ft,zt,nr,0)}var gr=zt-1,br=1;for(this[Ft+gr]=Bt&255;--gr>=0&&(br*=256);)this[Ft+gr]=Bt/br&255;return Ft+zt},nt.prototype.writeUint8=nt.prototype.writeUInt8=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,1,255,0),this[Ft]=Bt&255,Ft+1},nt.prototype.writeUint16LE=nt.prototype.writeUInt16LE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,2,65535,0),this[Ft]=Bt&255,this[Ft+1]=Bt>>>8,Ft+2},nt.prototype.writeUint16BE=nt.prototype.writeUInt16BE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,2,65535,0),this[Ft]=Bt>>>8,this[Ft+1]=Bt&255,Ft+2},nt.prototype.writeUint32LE=nt.prototype.writeUInt32LE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,4,4294967295,0),this[Ft+3]=Bt>>>24,this[Ft+2]=Bt>>>16,this[Ft+1]=Bt>>>8,this[Ft]=Bt&255,Ft+4},nt.prototype.writeUint32BE=nt.prototype.writeUInt32BE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,4,4294967295,0),this[Ft]=Bt>>>24,this[Ft+1]=Bt>>>16,this[Ft+2]=Bt>>>8,this[Ft+3]=Bt&255,Ft+4},nt.prototype.writeIntLE=function(Bt,Ft,zt,Qt){if(Bt=+Bt,Ft=Ft>>>0,!Qt){var nr=Math.pow(2,8*zt-1);dt(this,Bt,Ft,zt,nr-1,-nr)}var gr=0,br=1,vr=0;for(this[Ft]=Bt&255;++gr<zt&&(br*=256);)Bt<0&&vr===0&&this[Ft+gr-1]!==0&&(vr=1),this[Ft+gr]=(Bt/br>>0)-vr&255;return Ft+zt},nt.prototype.writeIntBE=function(Bt,Ft,zt,Qt){if(Bt=+Bt,Ft=Ft>>>0,!Qt){var nr=Math.pow(2,8*zt-1);dt(this,Bt,Ft,zt,nr-1,-nr)}var gr=zt-1,br=1,vr=0;for(this[Ft+gr]=Bt&255;--gr>=0&&(br*=256);)Bt<0&&vr===0&&this[Ft+gr+1]!==0&&(vr=1),this[Ft+gr]=(Bt/br>>0)-vr&255;return Ft+zt},nt.prototype.writeInt8=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,1,127,-128),Bt<0&&(Bt=255+Bt+1),this[Ft]=Bt&255,Ft+1},nt.prototype.writeInt16LE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,2,32767,-32768),this[Ft]=Bt&255,this[Ft+1]=Bt>>>8,Ft+2},nt.prototype.writeInt16BE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,2,32767,-32768),this[Ft]=Bt>>>8,this[Ft+1]=Bt&255,Ft+2},nt.prototype.writeInt32LE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,4,2147483647,-2147483648),this[Ft]=Bt&255,this[Ft+1]=Bt>>>8,this[Ft+2]=Bt>>>16,this[Ft+3]=Bt>>>24,Ft+4},nt.prototype.writeInt32BE=function(Bt,Ft,zt){return Bt=+Bt,Ft=Ft>>>0,zt||dt(this,Bt,Ft,4,2147483647,-2147483648),Bt<0&&(Bt=4294967295+Bt+1),this[Ft]=Bt>>>24,this[Ft+1]=Bt>>>16,this[Ft+2]=Bt>>>8,this[Ft+3]=Bt&255,Ft+4};function wt(Zt,Bt,Ft,zt,Qt,nr){if(Ft+zt>Zt.length)throw new RangeError("Index out of range");if(Ft<0)throw new RangeError("Index out of range")}function qt(Zt,Bt,Ft,zt,Qt){return Bt=+Bt,Ft=Ft>>>0,Qt||wt(Zt,Bt,Ft,4),$.write(Zt,Bt,Ft,zt,23,4),Ft+4}nt.prototype.writeFloatLE=function(Bt,Ft,zt){return qt(this,Bt,Ft,!0,zt)},nt.prototype.writeFloatBE=function(Bt,Ft,zt){return qt(this,Bt,Ft,!1,zt)};function Pt(Zt,Bt,Ft,zt,Qt){return Bt=+Bt,Ft=Ft>>>0,Qt||wt(Zt,Bt,Ft,8),$.write(Zt,Bt,Ft,zt,52,8),Ft+8}nt.prototype.writeDoubleLE=function(Bt,Ft,zt){return Pt(this,Bt,Ft,!0,zt)},nt.prototype.writeDoubleBE=function(Bt,Ft,zt){return Pt(this,Bt,Ft,!1,zt)},nt.prototype.copy=function(Bt,Ft,zt,Qt){if(!nt.isBuffer(Bt))throw new TypeError("argument should be a Buffer");if(zt||(zt=0),!Qt&&Qt!==0&&(Qt=this.length),Ft>=Bt.length&&(Ft=Bt.length),Ft||(Ft=0),Qt>0&&Qt<zt&&(Qt=zt),Qt===zt||Bt.length===0||this.length===0)return 0;if(Ft<0)throw new RangeError("targetStart out of bounds");if(zt<0||zt>=this.length)throw new RangeError("Index out of range");if(Qt<0)throw new RangeError("sourceEnd out of bounds");Qt>this.length&&(Qt=this.length),Bt.length-Ft<Qt-zt&&(Qt=Bt.length-Ft+zt);var nr=Qt-zt;return this===Bt&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Ft,zt,Qt):Uint8Array.prototype.set.call(Bt,this.subarray(zt,Qt),Ft),nr},nt.prototype.fill=function(Bt,Ft,zt,Qt){if(typeof Bt=="string"){if(typeof Ft=="string"?(Qt=Ft,Ft=0,zt=this.length):typeof zt=="string"&&(Qt=zt,zt=this.length),Qt!==void 0&&typeof Qt!="string")throw new TypeError("encoding must be a string");if(typeof Qt=="string"&&!nt.isEncoding(Qt))throw new TypeError("Unknown encoding: "+Qt);if(Bt.length===1){var nr=Bt.charCodeAt(0);(Qt==="utf8"&&nr<128||Qt==="latin1")&&(Bt=nr)}}else typeof Bt=="number"?Bt=Bt&255:typeof Bt=="boolean"&&(Bt=Number(Bt));if(Ft<0||this.length<Ft||this.length<zt)throw new RangeError("Out of range index");if(zt<=Ft)return this;Ft=Ft>>>0,zt=zt===void 0?this.length:zt>>>0,Bt||(Bt=0);var gr;if(typeof Bt=="number")for(gr=Ft;gr<zt;++gr)this[gr]=Bt;else{var br=nt.isBuffer(Bt)?Bt:nt.from(Bt,Qt),vr=br.length;if(vr===0)throw new TypeError('The value "'+Bt+'" is invalid for argument "value"');for(gr=0;gr<zt-Ft;++gr)this[gr+Ft]=br[gr%vr]}return this};var Gt=/[^+/0-9A-Za-z-_]/g;function Wt(Zt){if(Zt=Zt.split("=")[0],Zt=Zt.trim().replace(Gt,""),Zt.length<2)return"";for(;Zt.length%4!==0;)Zt=Zt+"=";return Zt}function Vt(Zt,Bt){Bt=Bt||1/0;for(var Ft,zt=Zt.length,Qt=null,nr=[],gr=0;gr<zt;++gr){if(Ft=Zt.charCodeAt(gr),Ft>55295&&Ft<57344){if(!Qt){if(Ft>56319){(Bt-=3)>-1&&nr.push(239,191,189);continue}else if(gr+1===zt){(Bt-=3)>-1&&nr.push(239,191,189);continue}Qt=Ft;continue}if(Ft<56320){(Bt-=3)>-1&&nr.push(239,191,189),Qt=Ft;continue}Ft=(Qt-55296<<10|Ft-56320)+65536}else Qt&&(Bt-=3)>-1&&nr.push(239,191,189);if(Qt=null,Ft<128){if((Bt-=1)<0)break;nr.push(Ft)}else if(Ft<2048){if((Bt-=2)<0)break;nr.push(Ft>>6|192,Ft&63|128)}else if(Ft<65536){if((Bt-=3)<0)break;nr.push(Ft>>12|224,Ft>>6&63|128,Ft&63|128)}else if(Ft<1114112){if((Bt-=4)<0)break;nr.push(Ft>>18|240,Ft>>12&63|128,Ft>>6&63|128,Ft&63|128)}else throw new Error("Invalid code point")}return nr}function Ut(Zt){for(var Bt=[],Ft=0;Ft<Zt.length;++Ft)Bt.push(Zt.charCodeAt(Ft)&255);return Bt}function Mt(Zt,Bt){for(var Ft,zt,Qt,nr=[],gr=0;gr<Zt.length&&!((Bt-=2)<0);++gr)Ft=Zt.charCodeAt(gr),zt=Ft>>8,Qt=Ft%256,nr.push(Qt),nr.push(zt);return nr}function Lt(Zt){return o.toByteArray(Wt(Zt))}function Yt(Zt,Bt,Ft,zt){for(var Qt=0;Qt<zt&&!(Qt+Ft>=Bt.length||Qt>=Zt.length);++Qt)Bt[Qt+Ft]=Zt[Qt];return Qt}function lr(Zt,Bt){return Zt instanceof Bt||Zt!=null&&Zt.constructor!=null&&Zt.constructor.name!=null&&Zt.constructor.name===Bt.name}function cr(Zt){return Zt!==Zt}var ir=function(){for(var Zt="0123456789abcdef",Bt=new Array(256),Ft=0;Ft<16;++Ft)for(var zt=Ft*16,Qt=0;Qt<16;++Qt)Bt[zt+Qt]=Zt[Ft]+Zt[Qt];return Bt}()})(buffer$2);var browserExports$3={},browser$i={get exports(){return browserExports$3},set exports(_){browserExports$3=_}},process$3=browser$i.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cachedSetTimeout=setTimeout:cachedSetTimeout=defaultSetTimout}catch{cachedSetTimeout=defaultSetTimout}try{typeof clearTimeout=="function"?cachedClearTimeout=clearTimeout:cachedClearTimeout=defaultClearTimeout}catch{cachedClearTimeout=defaultClearTimeout}})();function runTimeout(_){if(cachedSetTimeout===setTimeout)return setTimeout(_,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(_,0);try{return cachedSetTimeout(_,0)}catch{try{return cachedSetTimeout.call(null,_,0)}catch{return cachedSetTimeout.call(this,_,0)}}}function runClearTimeout(_){if(cachedClearTimeout===clearTimeout)return clearTimeout(_);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(_);try{return cachedClearTimeout(_)}catch{try{return cachedClearTimeout.call(null,_)}catch{return cachedClearTimeout.call(this,_)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var _=runTimeout(cleanUpNextTick);draining=!0;for(var o=queue.length;o;){for(currentQueue=queue,queue=[];++queueIndex<o;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,o=queue.length}currentQueue=null,draining=!1,runClearTimeout(_)}}process$3.nextTick=function(_){var o=new Array(arguments.length-1);if(arguments.length>1)for(var $=1;$<arguments.length;$++)o[$-1]=arguments[$];queue.push(new Item(_,o)),queue.length===1&&!draining&&runTimeout(drainQueue)};function Item(_,o){this.fun=_,this.array=o}Item.prototype.run=function(){this.fun.apply(null,this.array)};process$3.title="browser";process$3.browser=!0;process$3.env={};process$3.argv=[];process$3.version="";process$3.versions={};function noop$9(){}process$3.on=noop$9;process$3.addListener=noop$9;process$3.once=noop$9;process$3.off=noop$9;process$3.removeListener=noop$9;process$3.removeAllListeners=noop$9;process$3.emit=noop$9;process$3.prependListener=noop$9;process$3.prependOnceListener=noop$9;process$3.listeners=function(_){return[]};process$3.binding=function(_){throw new Error("process.binding is not supported")};process$3.cwd=function(){return"/"};process$3.chdir=function(_){throw new Error("process.chdir is not supported")};process$3.umask=function(){return 0};var _globalThis=function(_){function o(){var j=this||self;return delete _.prototype.__magic__,j}if(typeof globalThis=="object")return globalThis;if(this)return o();_.defineProperty(_.prototype,"__magic__",{configurable:!0,get:o});var $=__magic__;return $}(Object),_global=_globalThis;function sheetForTag(_){if(_.sheet)return _.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===_)return document.styleSheets[o]}function createStyleElement(_){var o=document.createElement("style");return o.setAttribute("data-emotion",_.key),_.nonce!==void 0&&o.setAttribute("nonce",_.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var StyleSheet=function(){function _($){var j=this;this._insertTag=function(et){var tt;j.tags.length===0?j.insertionPoint?tt=j.insertionPoint.nextSibling:j.prepend?tt=j.container.firstChild:tt=j.before:tt=j.tags[j.tags.length-1].nextSibling,j.container.insertBefore(et,tt),j.tags.push(et)},this.isSpeedy=$.speedy===void 0?!0:$.speedy,this.tags=[],this.ctr=0,this.nonce=$.nonce,this.key=$.key,this.container=$.container,this.prepend=$.prepend,this.insertionPoint=$.insertionPoint,this.before=null}var o=_.prototype;return o.hydrate=function(j){j.forEach(this._insertTag)},o.insert=function(j){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var et=this.tags[this.tags.length-1];if(this.isSpeedy){var tt=sheetForTag(et);try{tt.insertRule(j,tt.cssRules.length)}catch{}}else et.appendChild(document.createTextNode(j));this.ctr++},o.flush=function(){this.tags.forEach(function(j){return j.parentNode&&j.parentNode.removeChild(j)}),this.tags=[],this.ctr=0},_}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT$1="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",abs=Math.abs,from$9=String.fromCharCode,assign$3=Object.assign;function hash$8(_,o){return(((o<<2^charat(_,0))<<2^charat(_,1))<<2^charat(_,2))<<2^charat(_,3)}function trim(_){return _.trim()}function match$2(_,o){return(_=o.exec(_))?_[0]:_}function replace(_,o,$){return _.replace(o,$)}function indexof(_,o){return _.indexOf(o)}function charat(_,o){return _.charCodeAt(o)|0}function substr(_,o,$){return _.slice(o,$)}function strlen(_){return _.length}function sizeof(_){return _.length}function append(_,o){return o.push(_),_}function combine(_,o){return _.map(o).join("")}var line=1,column=1,length$8=0,position$1=0,character=0,characters="";function node$2(_,o,$,j,et,tt,rt){return{value:_,root:o,parent:$,type:j,props:et,children:tt,line,column,length:rt,return:""}}function copy(_,o){return assign$3(node$2("",null,null,"",null,null,0),_,{length:-_.length},o)}function char(){return character}function prev$1(){return character=position$1>0?charat(characters,--position$1):0,column--,character===10&&(column=1,line--),character}function next(){return character=position$1<length$8?charat(characters,position$1++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position$1)}function caret(){return position$1}function slice$2(_,o){return substr(characters,_,o)}function token(_){switch(_){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc$2(_){return line=column=1,length$8=strlen(characters=_),position$1=0,[]}function dealloc(_){return characters="",_}function delimit(_){return trim(slice$2(position$1-1,delimiter(_===91?_+2:_===40?_+1:_)))}function whitespace(_){for(;(character=peek())&&character<33;)next();return token(_)>2||token(character)>3?"":" "}function escaping(_,o){for(;--o&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice$2(_,caret()+(o<6&&peek()==32&&next()==32))}function delimiter(_){for(;next();)switch(character){case _:return position$1;case 34:case 39:_!==34&&_!==39&&delimiter(character);break;case 40:_===41&&delimiter(_);break;case 92:next();break}return position$1}function commenter(_,o){for(;next()&&_+character!==47+10;)if(_+character===42+42&&peek()===47)break;return"/*"+slice$2(o,position$1-1)+"*"+from$9(_===47?_:next())}function identifier(_){for(;!token(peek());)next();return slice$2(_,position$1)}function compile(_){return dealloc(parse$9("",null,null,null,[""],_=alloc$2(_),0,[0],_))}function parse$9(_,o,$,j,et,tt,rt,nt,it){for(var st=0,ot=0,at=rt,ct=0,ut=0,ft=0,ht=1,mt=1,gt=1,Et=0,St="",At=et,kt=tt,Rt=j,Tt=St;mt;)switch(ft=Et,Et=next()){case 40:if(ft!=108&&Tt.charCodeAt(at-1)==58){indexof(Tt+=replace(delimit(Et),"&","&\f"),"&\f")!=-1&&(gt=-1);break}case 34:case 39:case 91:Tt+=delimit(Et);break;case 9:case 10:case 13:case 32:Tt+=whitespace(ft);break;case 92:Tt+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),o,$),it);break;default:Tt+="/"}break;case 123*ht:nt[st++]=strlen(Tt)*gt;case 125*ht:case 59:case 0:switch(Et){case 0:case 125:mt=0;case 59+ot:ut>0&&strlen(Tt)-at&&append(ut>32?declaration(Tt+";",j,$,at-1):declaration(replace(Tt," ","")+";",j,$,at-2),it);break;case 59:Tt+=";";default:if(append(Rt=ruleset(Tt,o,$,st,ot,et,nt,St,At=[],kt=[],at),tt),Et===123)if(ot===0)parse$9(Tt,o,Rt,Rt,At,tt,at,nt,kt);else switch(ct){case 100:case 109:case 115:parse$9(_,Rt,Rt,j&&append(ruleset(_,Rt,Rt,0,0,et,nt,St,et,At=[],at),kt),et,kt,at,nt,j?At:kt);break;default:parse$9(Tt,Rt,Rt,Rt,[""],kt,0,nt,kt)}}st=ot=ut=0,ht=gt=1,St=Tt="",at=rt;break;case 58:at=1+strlen(Tt),ut=ft;default:if(ht<1){if(Et==123)--ht;else if(Et==125&&ht++==0&&prev$1()==125)continue}switch(Tt+=from$9(Et),Et*ht){case 38:gt=ot>0?1:(Tt+="\f",-1);break;case 44:nt[st++]=(strlen(Tt)-1)*gt,gt=1;break;case 64:peek()===45&&(Tt+=delimit(next())),ct=peek(),ot=at=strlen(St=Tt+=identifier(caret())),Et++;break;case 45:ft===45&&strlen(Tt)==2&&(ht=0)}}return tt}function ruleset(_,o,$,j,et,tt,rt,nt,it,st,ot){for(var at=et-1,ct=et===0?tt:[""],ut=sizeof(ct),ft=0,ht=0,mt=0;ft<j;++ft)for(var gt=0,Et=substr(_,at+1,at=abs(ht=rt[ft])),St=_;gt<ut;++gt)(St=trim(ht>0?ct[gt]+" "+Et:replace(Et,/&\f/g,ct[gt])))&&(it[mt++]=St);return node$2(_,o,$,et===0?RULESET:nt,it,st,ot)}function comment(_,o,$){return node$2(_,o,$,COMMENT$1,from$9(char()),substr(_,2,-2),0)}function declaration(_,o,$,j){return node$2(_,o,$,DECLARATION,substr(_,0,j),substr(_,j+1,-1),j)}function prefix(_,o){switch(hash$8(_,o)){case 5103:return WEBKIT+"print-"+_+_;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+_+_;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+_+MOZ+_+MS+_+_;case 6828:case 4268:return WEBKIT+_+MS+_+_;case 6165:return WEBKIT+_+MS+"flex-"+_+_;case 5187:return WEBKIT+_+replace(_,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+_;case 5443:return WEBKIT+_+MS+"flex-item-"+replace(_,/flex-|-self/,"")+_;case 4675:return WEBKIT+_+MS+"flex-line-pack"+replace(_,/align-content|flex-|-self/,"")+_;case 5548:return WEBKIT+_+MS+replace(_,"shrink","negative")+_;case 5292:return WEBKIT+_+MS+replace(_,"basis","preferred-size")+_;case 6060:return WEBKIT+"box-"+replace(_,"-grow","")+WEBKIT+_+MS+replace(_,"grow","positive")+_;case 4554:return WEBKIT+replace(_,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+_;case 6187:return replace(replace(replace(_,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),_,"")+_;case 5495:case 3959:return replace(_,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(_,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+_+_;case 4095:case 3583:case 4068:case 2532:return replace(_,/(.+)-inline(.+)/,WEBKIT+"$1$2")+_;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(_)-1-o>6)switch(charat(_,o+1)){case 109:if(charat(_,o+4)!==45)break;case 102:return replace(_,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(_,o+3)==108?"$3":"$2-$3"))+_;case 115:return~indexof(_,"stretch")?prefix(replace(_,"stretch","fill-available"),o)+_:_}break;case 4949:if(charat(_,o+1)!==115)break;case 6444:switch(charat(_,strlen(_)-3-(~indexof(_,"!important")&&10))){case 107:return replace(_,":",":"+WEBKIT)+_;case 101:return replace(_,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(_,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+_}break;case 5936:switch(charat(_,o+11)){case 114:return WEBKIT+_+MS+replace(_,/[svh]\w+-[tblr]{2}/,"tb")+_;case 108:return WEBKIT+_+MS+replace(_,/[svh]\w+-[tblr]{2}/,"tb-rl")+_;case 45:return WEBKIT+_+MS+replace(_,/[svh]\w+-[tblr]{2}/,"lr")+_}return WEBKIT+_+MS+_+_}return _}function serialize$2(_,o){for(var $="",j=sizeof(_),et=0;et<j;et++)$+=o(_[et],et,_,o)||"";return $}function stringify(_,o,$,j){switch(_.type){case IMPORT:case DECLARATION:return _.return=_.return||_.value;case COMMENT$1:return"";case KEYFRAMES:return _.return=_.value+"{"+serialize$2(_.children,j)+"}";case RULESET:_.value=_.props.join(",")}return strlen($=serialize$2(_.children,j))?_.return=_.value+"{"+$+"}":""}function middleware(_){var o=sizeof(_);return function($,j,et,tt){for(var rt="",nt=0;nt<o;nt++)rt+=_[nt]($,j,et,tt)||"";return rt}}function rulesheet(_){return function(o){o.root||(o=o.return)&&_(o)}}function prefixer(_,o,$,j){if(_.length>-1&&!_.return)switch(_.type){case DECLARATION:_.return=prefix(_.value,_.length);break;case KEYFRAMES:return serialize$2([copy(_,{value:replace(_.value,"@","@"+WEBKIT)})],j);case RULESET:if(_.length)return combine(_.props,function(et){switch(match$2(et,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize$2([copy(_,{props:[replace(et,/:(read-\w+)/,":"+MOZ+"$1")]})],j);case"::placeholder":return serialize$2([copy(_,{props:[replace(et,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(_,{props:[replace(et,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(_,{props:[replace(et,/:(plac\w+)/,MS+"input-$1")]})],j)}return""})}}var weakMemoize=function(o){var $=new WeakMap;return function(j){if($.has(j))return $.get(j);var et=o(j);return $.set(j,et),et}};function memoize$2(_){var o=Object.create(null);return function($){return o[$]===void 0&&(o[$]=_($)),o[$]}}var identifierWithPointTracking=function(o,$,j){for(var et=0,tt=0;et=tt,tt=peek(),et===38&&tt===12&&($[j]=1),!token(tt);)next();return slice$2(o,position$1)},toRules=function(o,$){var j=-1,et=44;do switch(token(et)){case 0:et===38&&peek()===12&&($[j]=1),o[j]+=identifierWithPointTracking(position$1-1,$,j);break;case 2:o[j]+=delimit(et);break;case 4:if(et===44){o[++j]=peek()===58?"&\f":"",$[j]=o[j].length;break}default:o[j]+=from$9(et)}while(et=next());return o},getRules=function(o,$){return dealloc(toRules(alloc$2(o),$))},fixedElements=new WeakMap,compat=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var $=o.value,j=o.parent,et=o.column===j.column&&o.line===j.line;j.type!=="rule";)if(j=j.parent,!j)return;if(!(o.props.length===1&&$.charCodeAt(0)!==58&&!fixedElements.get(j))&&!et){fixedElements.set(o,!0);for(var tt=[],rt=getRules($,tt),nt=j.props,it=0,st=0;it<rt.length;it++)for(var ot=0;ot<nt.length;ot++,st++)o.props[st]=tt[it]?rt[it].replace(/&\f/g,nt[ot]):nt[ot]+" "+rt[it]}}},removeLabel=function(o){if(o.type==="decl"){var $=o.value;$.charCodeAt(0)===108&&$.charCodeAt(2)===98&&(o.return="",o.value="")}},defaultStylisPlugins=[prefixer],createCache=function(o){var $=o.key;if($==="css"){var j=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(j,function(ht){var mt=ht.getAttribute("data-emotion");mt.indexOf(" ")!==-1&&(document.head.appendChild(ht),ht.setAttribute("data-s",""))})}var et=o.stylisPlugins||defaultStylisPlugins,tt={},rt,nt=[];rt=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+$+' "]'),function(ht){for(var mt=ht.getAttribute("data-emotion").split(" "),gt=1;gt<mt.length;gt++)tt[mt[gt]]=!0;nt.push(ht)});var it,st=[compat,removeLabel];{var ot,at=[stringify,rulesheet(function(ht){ot.insert(ht)})],ct=middleware(st.concat(et,at)),ut=function(mt){return serialize$2(compile(mt),ct)};it=function(mt,gt,Et,St){ot=Et,ut(mt?mt+"{"+gt.styles+"}":gt.styles),St&&(ft.inserted[gt.name]=!0)}}var ft={key:$,sheet:new StyleSheet({key:$,container:rt,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:tt,registered:{},insert:it};return ft.sheet.hydrate(nt),ft};function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(_){for(var o=1;o<arguments.length;o++){var $=arguments[o];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends$2.apply(this,arguments)}var reactIsExports={},reactIs$1={get exports(){return reactIsExports},set exports(_){reactIsExports=_}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$1=typeof Symbol=="function"&&Symbol.for,c$1=b$1?Symbol.for("react.element"):60103,d$1=b$1?Symbol.for("react.portal"):60106,e=b$1?Symbol.for("react.fragment"):60107,f$1=b$1?Symbol.for("react.strict_mode"):60108,g$3=b$1?Symbol.for("react.profiler"):60114,h$1=b$1?Symbol.for("react.provider"):60109,k=b$1?Symbol.for("react.context"):60110,l=b$1?Symbol.for("react.async_mode"):60111,m$1=b$1?Symbol.for("react.concurrent_mode"):60111,n=b$1?Symbol.for("react.forward_ref"):60112,p=b$1?Symbol.for("react.suspense"):60113,q=b$1?Symbol.for("react.suspense_list"):60120,r$2=b$1?Symbol.for("react.memo"):60115,t$1=b$1?Symbol.for("react.lazy"):60116,v=b$1?Symbol.for("react.block"):60121,w$1=b$1?Symbol.for("react.fundamental"):60117,x=b$1?Symbol.for("react.responder"):60118,y$1=b$1?Symbol.for("react.scope"):60119;function z(_){if(typeof _=="object"&&_!==null){var o=_.$$typeof;switch(o){case c$1:switch(_=_.type,_){case l:case m$1:case e:case g$3:case f$1:case p:return _;default:switch(_=_&&_.$$typeof,_){case k:case n:case t$1:case r$2:case h$1:return _;default:return o}}case d$1:return o}}}function A(_){return z(_)===m$1}reactIs_production_min.AsyncMode=l;reactIs_production_min.ConcurrentMode=m$1;reactIs_production_min.ContextConsumer=k;reactIs_production_min.ContextProvider=h$1;reactIs_production_min.Element=c$1;reactIs_production_min.ForwardRef=n;reactIs_production_min.Fragment=e;reactIs_production_min.Lazy=t$1;reactIs_production_min.Memo=r$2;reactIs_production_min.Portal=d$1;reactIs_production_min.Profiler=g$3;reactIs_production_min.StrictMode=f$1;reactIs_production_min.Suspense=p;reactIs_production_min.isAsyncMode=function(_){return A(_)||z(_)===l};reactIs_production_min.isConcurrentMode=A;reactIs_production_min.isContextConsumer=function(_){return z(_)===k};reactIs_production_min.isContextProvider=function(_){return z(_)===h$1};reactIs_production_min.isElement=function(_){return typeof _=="object"&&_!==null&&_.$$typeof===c$1};reactIs_production_min.isForwardRef=function(_){return z(_)===n};reactIs_production_min.isFragment=function(_){return z(_)===e};reactIs_production_min.isLazy=function(_){return z(_)===t$1};reactIs_production_min.isMemo=function(_){return z(_)===r$2};reactIs_production_min.isPortal=function(_){return z(_)===d$1};reactIs_production_min.isProfiler=function(_){return z(_)===g$3};reactIs_production_min.isStrictMode=function(_){return z(_)===f$1};reactIs_production_min.isSuspense=function(_){return z(_)===p};reactIs_production_min.isValidElementType=function(_){return typeof _=="string"||typeof _=="function"||_===e||_===m$1||_===g$3||_===f$1||_===p||_===q||typeof _=="object"&&_!==null&&(_.$$typeof===t$1||_.$$typeof===r$2||_.$$typeof===h$1||_.$$typeof===k||_.$$typeof===n||_.$$typeof===w$1||_.$$typeof===x||_.$$typeof===y$1||_.$$typeof===v)};reactIs_production_min.typeOf=z;(function(_){_.exports=reactIs_production_min})(reactIs$1);var reactIs=reactIsExports,FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS;TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;var isBrowser$5=!0;function getRegisteredStyles(_,o,$){var j="";return $.split(" ").forEach(function(et){_[et]!==void 0?o.push(_[et]+";"):j+=et+" "}),j}var registerStyles=function(o,$,j){var et=o.key+"-"+$.name;(j===!1||isBrowser$5===!1)&&o.registered[et]===void 0&&(o.registered[et]=$.styles)},insertStyles=function(o,$,j){registerStyles(o,$,j);var et=o.key+"-"+$.name;if(o.inserted[$.name]===void 0){var tt=$;do o.insert($===tt?"."+et:"",tt,o.sheet,!0),tt=tt.next;while(tt!==void 0)}};function murmur2(_){for(var o=0,$,j=0,et=_.length;et>=4;++j,et-=4)$=_.charCodeAt(j)&255|(_.charCodeAt(++j)&255)<<8|(_.charCodeAt(++j)&255)<<16|(_.charCodeAt(++j)&255)<<24,$=($&65535)*1540483477+(($>>>16)*59797<<16),$^=$>>>24,o=($&65535)*1540483477+(($>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(et){case 3:o^=(_.charCodeAt(j+2)&255)<<16;case 2:o^=(_.charCodeAt(j+1)&255)<<8;case 1:o^=_.charCodeAt(j)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(o){return o.charCodeAt(1)===45},isProcessableValue=function(o){return o!=null&&typeof o!="boolean"},processStyleName=memoize$2(function(_){return isCustomProperty(_)?_:_.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function(o,$){switch(o){case"animation":case"animationName":if(typeof $=="string")return $.replace(animationRegex,function(j,et,tt){return cursor={name:et,styles:tt,next:cursor},et})}return unitlessKeys[o]!==1&&!isCustomProperty(o)&&typeof $=="number"&&$!==0?$+"px":$},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(_,o,$){if($==null)return"";if($.__emotion_styles!==void 0)return $;switch(typeof $){case"boolean":return"";case"object":{if($.anim===1)return cursor={name:$.name,styles:$.styles,next:cursor},$.name;if($.styles!==void 0){var j=$.next;if(j!==void 0)for(;j!==void 0;)cursor={name:j.name,styles:j.styles,next:cursor},j=j.next;var et=$.styles+";";return et}return createStringFromObject(_,o,$)}case"function":{if(_!==void 0){var tt=cursor,rt=$(_);return cursor=tt,handleInterpolation(_,o,rt)}break}}if(o==null)return $;var nt=o[$];return nt!==void 0?nt:$}function createStringFromObject(_,o,$){var j="";if(Array.isArray($))for(var et=0;et<$.length;et++)j+=handleInterpolation(_,o,$[et])+";";else for(var tt in $){var rt=$[tt];if(typeof rt!="object")o!=null&&o[rt]!==void 0?j+=tt+"{"+o[rt]+"}":isProcessableValue(rt)&&(j+=processStyleName(tt)+":"+processStyleValue(tt,rt)+";");else if(Array.isArray(rt)&&typeof rt[0]=="string"&&(o==null||o[rt[0]]===void 0))for(var nt=0;nt<rt.length;nt++)isProcessableValue(rt[nt])&&(j+=processStyleName(tt)+":"+processStyleValue(tt,rt[nt])+";");else{var it=handleInterpolation(_,o,rt);switch(tt){case"animation":case"animationName":{j+=processStyleName(tt)+":"+it+";";break}default:j+=tt+"{"+it+"}"}}}return j}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function(o,$,j){if(o.length===1&&typeof o[0]=="object"&&o[0]!==null&&o[0].styles!==void 0)return o[0];var et=!0,tt="";cursor=void 0;var rt=o[0];rt==null||rt.raw===void 0?(et=!1,tt+=handleInterpolation(j,$,rt)):tt+=rt[0];for(var nt=1;nt<o.length;nt++)tt+=handleInterpolation(j,$,o[nt]),et&&(tt+=rt[nt]);labelPattern.lastIndex=0;for(var it="",st;(st=labelPattern.exec(tt))!==null;)it+="-"+st[1];var ot=murmur2(tt)+it;return{name:ot,styles:tt,next:cursor}},syncFallback=function(o){return o()},useInsertionEffect=React$1["useInsertionEffect"]?React$1["useInsertionEffect"]:!1,useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||syncFallback,useInsertionEffectWithLayoutFallback=useInsertionEffect||reactExports.useLayoutEffect,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function(o){return reactExports.forwardRef(function($,j){var et=reactExports.useContext(EmotionCacheContext);return o($,et,j)})},ThemeContext=reactExports.createContext({}),getTheme$1=function(o,$){if(typeof $=="function"){var j=$(o);return j}return _extends$2({},o,$)},createCacheWithTheme=weakMemoize(function(_){return weakMemoize(function(o){return getTheme$1(_,o)})}),ThemeProvider$1=function(o){var $=reactExports.useContext(ThemeContext);return o.theme!==$&&($=createCacheWithTheme($)(o.theme)),reactExports.createElement(ThemeContext.Provider,{value:$},o.children)},Global=withEmotionCache(function(_,o){var $=_.styles,j=serializeStyles([$],void 0,reactExports.useContext(ThemeContext)),et=reactExports.useRef();return useInsertionEffectWithLayoutFallback(function(){var tt=o.key+"-global",rt=new o.sheet.constructor({key:tt,nonce:o.sheet.nonce,container:o.sheet.container,speedy:o.sheet.isSpeedy}),nt=!1,it=document.querySelector('style[data-emotion="'+tt+" "+j.name+'"]');return o.sheet.tags.length&&(rt.before=o.sheet.tags[0]),it!==null&&(nt=!0,it.setAttribute("data-emotion",tt),rt.hydrate([it])),et.current=[rt,nt],function(){rt.flush()}},[o]),useInsertionEffectWithLayoutFallback(function(){var tt=et.current,rt=tt[0],nt=tt[1];if(nt){tt[1]=!1;return}if(j.next!==void 0&&insertStyles(o,j.next,!0),rt.tags.length){var it=rt.tags[rt.tags.length-1].nextElementSibling;rt.before=it,rt.flush()}o.insert("",j,rt,!1)},[o,j.name]),null});function css$1(){for(var _=arguments.length,o=new Array(_),$=0;$<_;$++)o[$]=arguments[$];return serializeStyles(o)}var keyframes$2=function(){var o=css$1.apply(void 0,arguments),$="animation-"+o.name;return{name:$,styles:"@keyframes "+$+"{"+o.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},vhPolyfill=`
  :root {
    --chakra-vh: 100vh;
  }

  @supports (height: -webkit-fill-available) {
    :root {
      --chakra-vh: -webkit-fill-available;
    }
  }

  @supports (height: -moz-fill-available) {
    :root {
      --chakra-vh: -moz-fill-available;
    }
  }

  @supports (height: 100dvh) {
    :root {
      --chakra-vh: 100dvh;
    }
  }
`,CSSPolyfill=()=>jsx(Global,{styles:vhPolyfill}),CSSReset=()=>jsx(Global,{styles:`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        -moz-osx-font-smoothing: grayscale;
        touch-action: manipulation;
      }

      body {
        position: relative;
        min-height: 100%;
        font-feature-settings: 'kern';
      }

      *,
      *::before,
      *::after {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
      }

      main {
        display: block;
      }

      hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      pre,
      code,
      kbd,
      samp {
        font-family: SFMono-Regular,  Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      b,
      strong {
        font-weight: bold;
      }

      small {
        font-size: 80%;
      }

      sub,
      sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      sub {
        bottom: -0.25em;
      }

      sup {
        top: -0.5em;
      }

      img {
        border-style: none;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      button,
      input {
        overflow: visible;
      }

      button,
      select {
        text-transform: none;
      }

      button::-moz-focus-inner,
      [type="button"]::-moz-focus-inner,
      [type="reset"]::-moz-focus-inner,
      [type="submit"]::-moz-focus-inner {
        border-style: none;
        padding: 0;
      }

      fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      progress {
        vertical-align: baseline;
      }

      textarea {
        overflow: auto;
      }

      [type="checkbox"],
      [type="radio"] {
        box-sizing: border-box;
        padding: 0;
      }

      [type="number"]::-webkit-inner-spin-button,
      [type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      input[type="number"] {
        -moz-appearance: textfield;
      }

      [type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      [type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      details {
        display: block;
      }

      summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      body,
      blockquote,
      dl,
      dd,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      hr,
      figure,
      p,
      pre {
        margin: 0;
      }

      button {
        background: transparent;
        padding: 0;
      }

      fieldset {
        margin: 0;
        padding: 0;
      }

      ol,
      ul {
        margin: 0;
        padding: 0;
      }

      textarea {
        resize: vertical;
      }

      button,
      [role="button"] {
        cursor: pointer;
      }

      button::-moz-focus-inner {
        border: 0 !important;
      }

      table {
        border-collapse: collapse;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-size: inherit;
        font-weight: inherit;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      img,
      svg,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        display: block;
      }

      img,
      video {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible] :focus:not([data-focus-visible-added]):not([data-focus-visible-disabled]) {
        outline: none;
        box-shadow: none;
      }

      select::-ms-expand {
        display: none;
      }

      ${vhPolyfill}
    `});function getErrorMessage$1(_,o){return`${_} returned \`undefined\`. Seems you forgot to wrap component within ${o}`}function createContext$1(_={}){const{name:o,strict:$=!0,hookName:j="useContext",providerName:et="Provider",errorMessage:tt}=_,rt=reactExports.createContext(void 0);rt.displayName=o;function nt(){var it;const st=reactExports.useContext(rt);if(!st&&$){const ot=new Error(tt??getErrorMessage$1(j,et));throw ot.name="ContextError",(it=Error.captureStackTrace)==null||it.call(Error,ot,nt),ot}return st}return[rt.Provider,nt,rt]}var[PortalManagerContextProvider,usePortalManager]=createContext$1({strict:!1,name:"PortalManagerContext"});function PortalManager(_){const{children:o,zIndex:$}=_;return jsx(PortalManagerContextProvider,{value:{zIndex:$},children:o})}PortalManager.displayName="PortalManager";var useSafeLayoutEffect$2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:reactExports.useEffect,[PortalContextProvider,usePortalContext]=createContext$1({strict:!1,name:"PortalContext"}),PORTAL_CLASSNAME="chakra-portal",PORTAL_SELECTOR=".chakra-portal",Container=_=>jsx("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:_.zIndex,top:0,left:0,right:0},children:_.children}),DefaultPortal=_=>{const{appendToParentPortal:o,children:$}=_,[j,et]=reactExports.useState(null),tt=reactExports.useRef(null),[,rt]=reactExports.useState({});reactExports.useEffect(()=>rt({}),[]);const nt=usePortalContext(),it=usePortalManager();useSafeLayoutEffect$2(()=>{if(!j)return;const ot=j.ownerDocument,at=o?nt??ot.body:ot.body;if(!at)return;tt.current=ot.createElement("div"),tt.current.className=PORTAL_CLASSNAME,at.appendChild(tt.current),rt({});const ct=tt.current;return()=>{at.contains(ct)&&at.removeChild(ct)}},[j]);const st=it!=null&&it.zIndex?jsx(Container,{zIndex:it==null?void 0:it.zIndex,children:$}):$;return tt.current?reactDomExports.createPortal(jsx(PortalContextProvider,{value:tt.current,children:st}),tt.current):jsx("span",{ref:ot=>{ot&&et(ot)}})},ContainerPortal=_=>{const{children:o,containerRef:$,appendToParentPortal:j}=_,et=$.current,tt=et??(typeof window<"u"?document.body:void 0),rt=reactExports.useMemo(()=>{const it=et==null?void 0:et.ownerDocument.createElement("div");return it&&(it.className=PORTAL_CLASSNAME),it},[et]),[,nt]=reactExports.useState({});return useSafeLayoutEffect$2(()=>nt({}),[]),useSafeLayoutEffect$2(()=>{if(!(!rt||!tt))return tt.appendChild(rt),()=>{tt.removeChild(rt)}},[rt,tt]),tt&&rt?reactDomExports.createPortal(jsx(PortalContextProvider,{value:j?rt:null,children:o}),rt):null};function Portal(_){const o={appendToParentPortal:!0,..._},{containerRef:$,...j}=o;return $?jsx(ContainerPortal,{containerRef:$,...j}):jsx(DefaultPortal,{...j})}Portal.className=PORTAL_CLASSNAME;Portal.selector=PORTAL_SELECTOR;Portal.displayName="Portal";function useTheme(){const _=reactExports.useContext(ThemeContext);if(!_)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return _}var ColorModeContext=reactExports.createContext({});ColorModeContext.displayName="ColorModeContext";function useColorMode(){const _=reactExports.useContext(ColorModeContext);if(_===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return _}function useColorModeValue(_,o){const{colorMode:$}=useColorMode();return $==="dark"?o:_}var classNames={light:"chakra-ui-light",dark:"chakra-ui-dark"};function getColorModeUtils(_={}){const{preventTransition:o=!0}=_,$={setDataset:j=>{const et=o?$.preventTransition():void 0;document.documentElement.dataset.theme=j,document.documentElement.style.colorScheme=j,et==null||et()},setClassName(j){document.body.classList.add(j?classNames.dark:classNames.light),document.body.classList.remove(j?classNames.light:classNames.dark)},query(){return window.matchMedia("(prefers-color-scheme: dark)")},getSystemTheme(j){var et;return((et=$.query().matches)!=null?et:j==="dark")?"dark":"light"},addListener(j){const et=$.query(),tt=rt=>{j(rt.matches?"dark":"light")};return typeof et.addListener=="function"?et.addListener(tt):et.addEventListener("change",tt),()=>{typeof et.removeListener=="function"?et.removeListener(tt):et.removeEventListener("change",tt)}},preventTransition(){const j=document.createElement("style");return j.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(j),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(j)})})}}};return $}var STORAGE_KEY="chakra-ui-color-mode";function createLocalStorageManager(_){return{ssr:!1,type:"localStorage",get(o){if(!(globalThis!=null&&globalThis.document))return o;let $;try{$=localStorage.getItem(_)||o}catch{}return $||o},set(o){try{localStorage.setItem(_,o)}catch{}}}}var localStorageManager=createLocalStorageManager(STORAGE_KEY),noop$8=()=>{};function getTheme(_,o){return _.type==="cookie"&&_.ssr?_.get(o):o}function ColorModeProvider(_){const{value:o,children:$,options:{useSystemColorMode:j,initialColorMode:et,disableTransitionOnChange:tt}={},colorModeManager:rt=localStorageManager}=_,nt=et==="dark"?"dark":"light",[it,st]=reactExports.useState(()=>getTheme(rt,nt)),[ot,at]=reactExports.useState(()=>getTheme(rt)),{getSystemTheme:ct,setClassName:ut,setDataset:ft,addListener:ht}=reactExports.useMemo(()=>getColorModeUtils({preventTransition:tt}),[tt]),mt=et==="system"&&!it?ot:it,gt=reactExports.useCallback(At=>{const kt=At==="system"?ct():At;st(kt),ut(kt==="dark"),ft(kt),rt.set(kt)},[rt,ct,ut,ft]);useSafeLayoutEffect$2(()=>{et==="system"&&at(ct())},[]),reactExports.useEffect(()=>{const At=rt.get();if(At){gt(At);return}if(et==="system"){gt("system");return}gt(nt)},[rt,nt,et,gt]);const Et=reactExports.useCallback(()=>{gt(mt==="dark"?"light":"dark")},[mt,gt]);reactExports.useEffect(()=>{if(j)return ht(gt)},[j,ht,gt]);const St=reactExports.useMemo(()=>({colorMode:o??mt,toggleColorMode:o?noop$8:Et,setColorMode:o?noop$8:gt,forced:o!==void 0}),[mt,Et,gt,o]);return jsx(ColorModeContext.Provider,{value:St,children:$})}ColorModeProvider.displayName="ColorModeProvider";function useChakra(){const _=useColorMode(),o=useTheme();return{..._,theme:o}}function getBreakpointValue(_,o,$){var j,et;if(o==null)return o;const tt=rt=>{var nt,it;return(it=(nt=_.__breakpoints)==null?void 0:nt.asArray)==null?void 0:it[rt]};return(et=(j=tt(o))!=null?j:tt($))!=null?et:$}function getTokenValue(_,o,$){var j,et;if(o==null)return o;const tt=rt=>{var nt,it;return(it=(nt=_.__cssMap)==null?void 0:nt[rt])==null?void 0:it.value};return(et=(j=tt(o))!=null?j:tt($))!=null?et:$}function useToken(_,o,$){const j=useTheme();return getToken(_,o,$)(j)}function getToken(_,o,$){const j=Array.isArray(o)?o:[o],et=Array.isArray($)?$:[$];return tt=>{const rt=et.filter(Boolean),nt=j.map((it,st)=>{var ot,at;if(_==="breakpoints")return getBreakpointValue(tt,it,(ot=rt[st])!=null?ot:it);const ct=`${_}.${it}`;return getTokenValue(tt,ct,(at=rt[st])!=null?at:it)});return Array.isArray(o)?nt:nt[0]}}var cx=(..._)=>_.filter(Boolean).join(" ");function isDev(){return!1}function isObject$1(_){const o=typeof _;return _!=null&&(o==="object"||o==="function")&&!Array.isArray(_)}var warn=_=>{const{condition:o,message:$}=_;o&&isDev()&&console.warn($)};function runIfFn$2(_,...o){return isFunction$4(_)?_(...o):_}var isFunction$4=_=>typeof _=="function",dataAttr=_=>_?"":void 0,ariaAttr=_=>_?!0:void 0;function callAllHandlers$1(..._){return function($){_.some(j=>(j==null||j($),$==null?void 0:$.defaultPrevented))}}function callAll(..._){return function($){_.forEach(j=>{j==null||j($)})}}var lodash_mergewithExports={},lodash_mergewith={get exports(){return lodash_mergewithExports},set exports(_){lodash_mergewithExports=_}};(function(_,o){var $=200,j="__lodash_hash_undefined__",et=800,tt=16,rt=9007199254740991,nt="[object Arguments]",it="[object Array]",st="[object AsyncFunction]",ot="[object Boolean]",at="[object Date]",ct="[object Error]",ut="[object Function]",ft="[object GeneratorFunction]",ht="[object Map]",mt="[object Number]",gt="[object Null]",Et="[object Object]",St="[object Proxy]",At="[object RegExp]",kt="[object Set]",Rt="[object String]",Tt="[object Undefined]",Dt="[object WeakMap]",Ot="[object ArrayBuffer]",jt="[object DataView]",Nt="[object Float32Array]",It="[object Float64Array]",yt="[object Int8Array]",lt="[object Int16Array]",pt="[object Int32Array]",bt="[object Uint8Array]",_t="[object Uint8ClampedArray]",$t="[object Uint16Array]",Ct="[object Uint32Array]",xt=/[\\^$.*+?()[\]{}|]/g,vt=/^\[object .+?Constructor\]$/,dt=/^(?:0|[1-9]\d*)$/,wt={};wt[Nt]=wt[It]=wt[yt]=wt[lt]=wt[pt]=wt[bt]=wt[_t]=wt[$t]=wt[Ct]=!0,wt[nt]=wt[it]=wt[Ot]=wt[ot]=wt[jt]=wt[at]=wt[ct]=wt[ut]=wt[ht]=wt[mt]=wt[Et]=wt[At]=wt[kt]=wt[Rt]=wt[Dt]=!1;var qt=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,Pt=typeof self=="object"&&self&&self.Object===Object&&self,Gt=qt||Pt||Function("return this")(),Wt=o&&!o.nodeType&&o,Vt=Wt&&!0&&_&&!_.nodeType&&_,Ut=Vt&&Vt.exports===Wt,Mt=Ut&&qt.process,Lt=function(){try{var fr=Vt&&Vt.require&&Vt.require("util").types;return fr||Mt&&Mt.binding&&Mt.binding("util")}catch{}}(),Yt=Lt&&Lt.isTypedArray;function lr(fr,_r,xr){switch(xr.length){case 0:return fr.call(_r);case 1:return fr.call(_r,xr[0]);case 2:return fr.call(_r,xr[0],xr[1]);case 3:return fr.call(_r,xr[0],xr[1],xr[2])}return fr.apply(_r,xr)}function cr(fr,_r){for(var xr=-1,Yr=Array(fr);++xr<fr;)Yr[xr]=_r(xr);return Yr}function ir(fr){return function(_r){return fr(_r)}}function Zt(fr,_r){return fr==null?void 0:fr[_r]}function Bt(fr,_r){return function(xr){return fr(_r(xr))}}var Ft=Array.prototype,zt=Function.prototype,Qt=Object.prototype,nr=Gt["__core-js_shared__"],gr=zt.toString,br=Qt.hasOwnProperty,vr=function(){var fr=/[^.]+$/.exec(nr&&nr.keys&&nr.keys.IE_PROTO||"");return fr?"Symbol(src)_1."+fr:""}(),Nr=Qt.toString,ar=gr.call(Object),er=RegExp("^"+gr.call(br).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xt=Ut?Gt.Buffer:void 0,tr=Gt.Symbol,ur=Gt.Uint8Array,pr=Xt?Xt.allocUnsafe:void 0,yr=Bt(Object.getPrototypeOf,Object),wr=Object.create,Gr=Qt.propertyIsEnumerable,$r=Ft.splice,Er=tr?tr.toStringTag:void 0,Wr=function(){try{var fr=ds(Object,"defineProperty");return fr({},"",{}),fr}catch{}}(),Vr=Xt?Xt.isBuffer:void 0,Pr=Math.max,nn=Date.now,Kr=ds(Gt,"Map"),Dr=ds(Object,"create"),Qr=function(){function fr(){}return function(_r){if(!Kn(_r))return{};if(wr)return wr(_r);fr.prototype=_r;var xr=new fr;return fr.prototype=void 0,xr}}();function Or(fr){var _r=-1,xr=fr==null?0:fr.length;for(this.clear();++_r<xr;){var Yr=fr[_r];this.set(Yr[0],Yr[1])}}function Cr(){this.__data__=Dr?Dr(null):{},this.size=0}function Zr(fr){var _r=this.has(fr)&&delete this.__data__[fr];return this.size-=_r?1:0,_r}function Fr(fr){var _r=this.__data__;if(Dr){var xr=_r[fr];return xr===j?void 0:xr}return br.call(_r,fr)?_r[fr]:void 0}function Ar(fr){var _r=this.__data__;return Dr?_r[fr]!==void 0:br.call(_r,fr)}function Xr(fr,_r){var xr=this.__data__;return this.size+=this.has(fr)?0:1,xr[fr]=Dr&&_r===void 0?j:_r,this}Or.prototype.clear=Cr,Or.prototype.delete=Zr,Or.prototype.get=Fr,Or.prototype.has=Ar,Or.prototype.set=Xr;function Mr(fr){var _r=-1,xr=fr==null?0:fr.length;for(this.clear();++_r<xr;){var Yr=fr[_r];this.set(Yr[0],Yr[1])}}function Sr(){this.__data__=[],this.size=0}function Jr(fr){var _r=this.__data__,xr=gn(_r,fr);if(xr<0)return!1;var Yr=_r.length-1;return xr==Yr?_r.pop():$r.call(_r,xr,1),--this.size,!0}function Ur(fr){var _r=this.__data__,xr=gn(_r,fr);return xr<0?void 0:_r[xr][1]}function Rr(fr){return gn(this.__data__,fr)>-1}function en(fr,_r){var xr=this.__data__,Yr=gn(xr,fr);return Yr<0?(++this.size,xr.push([fr,_r])):xr[Yr][1]=_r,this}Mr.prototype.clear=Sr,Mr.prototype.delete=Jr,Mr.prototype.get=Ur,Mr.prototype.has=Rr,Mr.prototype.set=en;function Br(fr){var _r=-1,xr=fr==null?0:fr.length;for(this.clear();++_r<xr;){var Yr=fr[_r];this.set(Yr[0],Yr[1])}}function Ir(){this.size=0,this.__data__={hash:new Or,map:new(Kr||Mr),string:new Or}}function tn(fr){var _r=Yn(this,fr).delete(fr);return this.size-=_r?1:0,_r}function qr(fr){return Yn(this,fr).get(fr)}function Lr(fr){return Yn(this,fr).has(fr)}function sn(fr,_r){var xr=Yn(this,fr),Yr=xr.size;return xr.set(fr,_r),this.size+=xr.size==Yr?0:1,this}Br.prototype.clear=Ir,Br.prototype.delete=tn,Br.prototype.get=qr,Br.prototype.has=Lr,Br.prototype.set=sn;function Hr(fr){var _r=this.__data__=new Mr(fr);this.size=_r.size}function jr(){this.__data__=new Mr,this.size=0}function un(fr){var _r=this.__data__,xr=_r.delete(fr);return this.size=_r.size,xr}function dn(fr){return this.__data__.get(fr)}function fn(fr){return this.__data__.has(fr)}function an(fr,_r){var xr=this.__data__;if(xr instanceof Mr){var Yr=xr.__data__;if(!Kr||Yr.length<$-1)return Yr.push([fr,_r]),this.size=++xr.size,this;xr=this.__data__=new Br(Yr)}return xr.set(fr,_r),this.size=xr.size,this}Hr.prototype.clear=jr,Hr.prototype.delete=un,Hr.prototype.get=dn,Hr.prototype.has=fn,Hr.prototype.set=an;function pn(fr,_r){var xr=bs(fr),Yr=!xr&&ys(fr),cn=!xr&&!Yr&&Rs(fr),hn=!xr&&!Yr&&!cn&&Ps(fr),yn=xr||Yr||cn||hn,ln=yn?cr(fr.length,String):[],vn=ln.length;for(var Ln in fr)(_r||br.call(fr,Ln))&&!(yn&&(Ln=="length"||cn&&(Ln=="offset"||Ln=="parent")||hn&&(Ln=="buffer"||Ln=="byteLength"||Ln=="byteOffset")||hs(Ln,vn)))&&ln.push(Ln);return ln}function _n(fr,_r,xr){(xr!==void 0&&!Qn(fr[_r],xr)||xr===void 0&&!(_r in fr))&&En(fr,_r,xr)}function Tn(fr,_r,xr){var Yr=fr[_r];(!(br.call(fr,_r)&&Qn(Yr,xr))||xr===void 0&&!(_r in fr))&&En(fr,_r,xr)}function gn(fr,_r){for(var xr=fr.length;xr--;)if(Qn(fr[xr][0],_r))return xr;return-1}function En(fr,_r,xr){_r=="__proto__"&&Wr?Wr(fr,_r,{configurable:!0,enumerable:!0,value:xr,writable:!0}):fr[_r]=xr}var Cn=zs();function mn(fr){return fr==null?fr===void 0?Tt:gt:Er&&Er in Object(fr)?Hs(fr):qs(fr)}function xn(fr){return Xn(fr)&&mn(fr)==nt}function An(fr){if(!Kn(fr)||Cs(fr))return!1;var _r=ws(fr)?er:vt;return _r.test(Ys(fr))}function $n(fr){return Xn(fr)&&Is(fr.length)&&!!wt[mn(fr)]}function Rn(fr){if(!Kn(fr))return js(fr);var _r=As(fr),xr=[];for(var Yr in fr)Yr=="constructor"&&(_r||!br.call(fr,Yr))||xr.push(Yr);return xr}function Sn(fr,_r,xr,Yr,cn){fr!==_r&&Cn(_r,function(hn,yn){if(cn||(cn=new Hr),Kn(hn))In(fr,_r,yn,xr,Sn,Yr,cn);else{var ln=Yr?Yr(gs(fr,yn),hn,yn+"",fr,_r,cn):void 0;ln===void 0&&(ln=hn),_n(fr,yn,ln)}},Ds)}function In(fr,_r,xr,Yr,cn,hn,yn){var ln=gs(fr,xr),vn=gs(_r,xr),Ln=yn.get(vn);if(Ln){_n(fr,xr,Ln);return}var Mn=hn?hn(ln,vn,xr+"",fr,_r,yn):void 0,Un=Mn===void 0;if(Un){var _s=bs(vn),Es=!_s&&Rs(vn),Ms=!_s&&!Es&&Ps(vn);Mn=vn,_s||Es||Ms?bs(ln)?Mn=ln:Zs(ln)?Mn=Ts(ln):Es?(Un=!1,Mn=Ls(vn,!0)):Ms?(Un=!1,Mn=Ss(vn,!0)):Mn=[]:ks(vn)||ys(vn)?(Mn=ln,ys(ln)?Mn=ts(ln):(!Kn(ln)||ws(ln))&&(Mn=qn(vn))):Un=!1}Un&&(yn.set(vn,Mn),cn(Mn,vn,Yr,hn,yn),yn.delete(vn)),_n(fr,xr,Mn)}function kn(fr,_r){return Ws(Gs(fr,_r,Gn),fr+"")}var Pn=Wr?function(fr,_r){return Wr(fr,"toString",{configurable:!0,enumerable:!1,value:Xs(_r),writable:!0})}:Gn;function Ls(fr,_r){if(_r)return fr.slice();var xr=fr.length,Yr=pr?pr(xr):new fr.constructor(xr);return fr.copy(Yr),Yr}function Fs(fr){var _r=new fr.constructor(fr.byteLength);return new ur(_r).set(new ur(fr)),_r}function Ss(fr,_r){var xr=_r?Fs(fr.buffer):fr.buffer;return new fr.constructor(xr,fr.byteOffset,fr.length)}function Ts(fr,_r){var xr=-1,Yr=fr.length;for(_r||(_r=Array(Yr));++xr<Yr;)_r[xr]=fr[xr];return _r}function Us(fr,_r,xr,Yr){var cn=!xr;xr||(xr={});for(var hn=-1,yn=_r.length;++hn<yn;){var ln=_r[hn],vn=Yr?Yr(xr[ln],fr[ln],ln,xr,fr):void 0;vn===void 0&&(vn=fr[ln]),cn?En(xr,ln,vn):Tn(xr,ln,vn)}return xr}function Vs(fr){return kn(function(_r,xr){var Yr=-1,cn=xr.length,hn=cn>1?xr[cn-1]:void 0,yn=cn>2?xr[2]:void 0;for(hn=fr.length>3&&typeof hn=="function"?(cn--,hn):void 0,yn&&Ks(xr[0],xr[1],yn)&&(hn=cn<3?void 0:hn,cn=1),_r=Object(_r);++Yr<cn;){var ln=xr[Yr];ln&&fr(_r,ln,Yr,hn)}return _r})}function zs(fr){return function(_r,xr,Yr){for(var cn=-1,hn=Object(_r),yn=Yr(_r),ln=yn.length;ln--;){var vn=yn[fr?ln:++cn];if(xr(hn[vn],vn,hn)===!1)break}return _r}}function Yn(fr,_r){var xr=fr.__data__;return ps(_r)?xr[typeof _r=="string"?"string":"hash"]:xr.map}function ds(fr,_r){var xr=Zt(fr,_r);return An(xr)?xr:void 0}function Hs(fr){var _r=br.call(fr,Er),xr=fr[Er];try{fr[Er]=void 0;var Yr=!0}catch{}var cn=Nr.call(fr);return Yr&&(_r?fr[Er]=xr:delete fr[Er]),cn}function qn(fr){return typeof fr.constructor=="function"&&!As(fr)?Qr(yr(fr)):{}}function hs(fr,_r){var xr=typeof fr;return _r=_r??rt,!!_r&&(xr=="number"||xr!="symbol"&&dt.test(fr))&&fr>-1&&fr%1==0&&fr<_r}function Ks(fr,_r,xr){if(!Kn(xr))return!1;var Yr=typeof _r;return(Yr=="number"?vs(xr)&&hs(_r,xr.length):Yr=="string"&&_r in xr)?Qn(xr[_r],fr):!1}function ps(fr){var _r=typeof fr;return _r=="string"||_r=="number"||_r=="symbol"||_r=="boolean"?fr!=="__proto__":fr===null}function Cs(fr){return!!vr&&vr in fr}function As(fr){var _r=fr&&fr.constructor,xr=typeof _r=="function"&&_r.prototype||Qt;return fr===xr}function js(fr){var _r=[];if(fr!=null)for(var xr in Object(fr))_r.push(xr);return _r}function qs(fr){return Nr.call(fr)}function Gs(fr,_r,xr){return _r=Pr(_r===void 0?fr.length-1:_r,0),function(){for(var Yr=arguments,cn=-1,hn=Pr(Yr.length-_r,0),yn=Array(hn);++cn<hn;)yn[cn]=Yr[_r+cn];cn=-1;for(var ln=Array(_r+1);++cn<_r;)ln[cn]=Yr[cn];return ln[_r]=xr(yn),lr(fr,this,ln)}}function gs(fr,_r){if(!(_r==="constructor"&&typeof fr[_r]=="function")&&_r!="__proto__")return fr[_r]}var Ws=Zn(Pn);function Zn(fr){var _r=0,xr=0;return function(){var Yr=nn(),cn=tt-(Yr-xr);if(xr=Yr,cn>0){if(++_r>=et)return arguments[0]}else _r=0;return fr.apply(void 0,arguments)}}function Ys(fr){if(fr!=null){try{return gr.call(fr)}catch{}try{return fr+""}catch{}}return""}function Qn(fr,_r){return fr===_r||fr!==fr&&_r!==_r}var ys=xn(function(){return arguments}())?xn:function(fr){return Xn(fr)&&br.call(fr,"callee")&&!Gr.call(fr,"callee")},bs=Array.isArray;function vs(fr){return fr!=null&&Is(fr.length)&&!ws(fr)}function Zs(fr){return Xn(fr)&&vs(fr)}var Rs=Vr||Js;function ws(fr){if(!Kn(fr))return!1;var _r=mn(fr);return _r==ut||_r==ft||_r==st||_r==St}function Is(fr){return typeof fr=="number"&&fr>-1&&fr%1==0&&fr<=rt}function Kn(fr){var _r=typeof fr;return fr!=null&&(_r=="object"||_r=="function")}function Xn(fr){return fr!=null&&typeof fr=="object"}function ks(fr){if(!Xn(fr)||mn(fr)!=Et)return!1;var _r=yr(fr);if(_r===null)return!0;var xr=br.call(_r,"constructor")&&_r.constructor;return typeof xr=="function"&&xr instanceof xr&&gr.call(xr)==ar}var Ps=Yt?ir(Yt):$n;function ts(fr){return Us(fr,Ds(fr))}function Ds(fr){return vs(fr)?pn(fr,!0):Rn(fr)}var Qs=Vs(function(fr,_r,xr,Yr){Sn(fr,_r,xr,Yr)});function Xs(fr){return function(){return fr}}function Gn(fr){return fr}function Js(){return!1}_.exports=Qs})(lodash_mergewith,lodash_mergewithExports);const mergeWith=lodash_mergewithExports;var isImportant=_=>/!(important)?$/.test(_),withoutImportant=_=>typeof _=="string"?_.replace(/!(important)?$/,"").trim():_,tokenToCSSVar=(_,o)=>$=>{const j=String(o),et=isImportant(j),tt=withoutImportant(j),rt=_?`${_}.${tt}`:tt;let nt=isObject$1($.__cssMap)&&rt in $.__cssMap?$.__cssMap[rt].varRef:o;return nt=withoutImportant(nt),et?`${nt} !important`:nt};function createTransform(_){const{scale:o,transform:$,compose:j}=_;return(tt,rt)=>{var nt;const it=tokenToCSSVar(o,tt)(rt);let st=(nt=$==null?void 0:$(it,rt))!=null?nt:it;return j&&(st=j(st,rt)),st}}var pipe$3=(..._)=>o=>_.reduce(($,j)=>j($),o);function toConfig(_,o){return $=>{const j={property:$,scale:_};return j.transform=createTransform({scale:_,transform:o}),j}}var getRtl=({rtl:_,ltr:o})=>$=>$.direction==="rtl"?_:o;function logical(_){const{property:o,scale:$,transform:j}=_;return{scale:$,property:getRtl(o),transform:$?createTransform({scale:$,compose:j}):j}}var transformTemplate=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function getTransformTemplate(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...transformTemplate].join(" ")}function getTransformGpuTemplate(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...transformTemplate].join(" ")}var filterTemplate={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},backdropFilterTemplate={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function getRingTemplate(_){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":_,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var flexDirectionTemplate={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},directionMap={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},valueSet=new Set(Object.values(directionMap)),globalSet=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),trimSpace=_=>_.trim();function parseGradient(_,o){if(_==null||globalSet.has(_))return _;const j=/(^[a-z-A-Z]+)\((.*)\)/g.exec(_),et=j==null?void 0:j[1],tt=j==null?void 0:j[2];if(!et||!tt)return _;const rt=et.includes("-gradient")?et:`${et}-gradient`,[nt,...it]=tt.split(",").map(trimSpace).filter(Boolean);if((it==null?void 0:it.length)===0)return _;const st=nt in directionMap?directionMap[nt]:nt;it.unshift(st);const ot=it.map(at=>{if(valueSet.has(at))return at;const ct=at.indexOf(" "),[ut,ft]=ct!==-1?[at.substr(0,ct),at.substr(ct+1)]:[at],ht=isCSSFunction(ft)?ft:ft&&ft.split(" "),mt=`colors.${ut}`,gt=mt in o.__cssMap?o.__cssMap[mt].varRef:ut;return ht?[gt,...Array.isArray(ht)?ht:[ht]].join(" "):gt});return`${rt}(${ot.join(", ")})`}var isCSSFunction=_=>typeof _=="string"&&_.includes("(")&&_.includes(")"),gradientTransform=(_,o)=>parseGradient(_,o??{});function isCssVar(_){return/^var\(--.+\)$/.test(_)}var analyzeCSSValue=_=>{const o=parseFloat(_.toString()),$=_.toString().replace(String(o),"");return{unitless:!$,value:o,unit:$}},wrap$1=_=>o=>`${_}(${o})`,transformFunctions={filter(_){return _!=="auto"?_:filterTemplate},backdropFilter(_){return _!=="auto"?_:backdropFilterTemplate},ring(_){return getRingTemplate(transformFunctions.px(_))},bgClip(_){return _==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:_}},transform(_){return _==="auto"?getTransformTemplate():_==="auto-gpu"?getTransformGpuTemplate():_},vh(_){return _==="$100vh"?"var(--chakra-vh)":_},px(_){if(_==null)return _;const{unitless:o}=analyzeCSSValue(_);return o||typeof _=="number"?`${_}px`:_},fraction(_){return typeof _!="number"||_>1?_:`${_*100}%`},float(_,o){const $={left:"right",right:"left"};return o.direction==="rtl"?$[_]:_},degree(_){if(isCssVar(_)||_==null)return _;const o=typeof _=="string"&&!_.endsWith("deg");return typeof _=="number"||o?`${_}deg`:_},gradient:gradientTransform,blur:wrap$1("blur"),opacity:wrap$1("opacity"),brightness:wrap$1("brightness"),contrast:wrap$1("contrast"),dropShadow:wrap$1("drop-shadow"),grayscale:wrap$1("grayscale"),hueRotate:wrap$1("hue-rotate"),invert:wrap$1("invert"),saturate:wrap$1("saturate"),sepia:wrap$1("sepia"),bgImage(_){return _==null||isCSSFunction(_)||globalSet.has(_)?_:`url(${_})`},outline(_){const o=String(_)==="0"||String(_)==="none";return _!==null&&o?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:_}},flexDirection(_){var o;const{space:$,divide:j}=(o=flexDirectionTemplate[_])!=null?o:{},et={flexDirection:_};return $&&(et[$]=1),j&&(et[j]=1),et}},t={borderWidths:toConfig("borderWidths"),borderStyles:toConfig("borderStyles"),colors:toConfig("colors"),borders:toConfig("borders"),radii:toConfig("radii",transformFunctions.px),space:toConfig("space",pipe$3(transformFunctions.vh,transformFunctions.px)),spaceT:toConfig("space",pipe$3(transformFunctions.vh,transformFunctions.px)),degreeT(_){return{property:_,transform:transformFunctions.degree}},prop(_,o,$){return{property:_,scale:o,...o&&{transform:createTransform({scale:o,transform:$})}}},propT(_,o){return{property:_,transform:o}},sizes:toConfig("sizes",pipe$3(transformFunctions.vh,transformFunctions.px)),sizesT:toConfig("sizes",pipe$3(transformFunctions.vh,transformFunctions.fraction)),shadows:toConfig("shadows"),logical,blur:toConfig("blur",transformFunctions.blur)},background={background:t.colors("background"),backgroundColor:t.colors("backgroundColor"),backgroundImage:t.propT("backgroundImage",transformFunctions.bgImage),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:transformFunctions.bgClip},bgSize:t.prop("backgroundSize"),bgPosition:t.prop("backgroundPosition"),bg:t.colors("background"),bgColor:t.colors("backgroundColor"),bgPos:t.prop("backgroundPosition"),bgRepeat:t.prop("backgroundRepeat"),bgAttachment:t.prop("backgroundAttachment"),bgGradient:t.propT("backgroundImage",transformFunctions.gradient),bgClip:{transform:transformFunctions.bgClip}};Object.assign(background,{bgImage:background.backgroundImage,bgImg:background.backgroundImage});var border={border:t.borders("border"),borderWidth:t.borderWidths("borderWidth"),borderStyle:t.borderStyles("borderStyle"),borderColor:t.colors("borderColor"),borderRadius:t.radii("borderRadius"),borderTop:t.borders("borderTop"),borderBlockStart:t.borders("borderBlockStart"),borderTopLeftRadius:t.radii("borderTopLeftRadius"),borderStartStartRadius:t.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:t.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:t.radii("borderTopRightRadius"),borderStartEndRadius:t.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:t.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:t.borders("borderRight"),borderInlineEnd:t.borders("borderInlineEnd"),borderBottom:t.borders("borderBottom"),borderBlockEnd:t.borders("borderBlockEnd"),borderBottomLeftRadius:t.radii("borderBottomLeftRadius"),borderBottomRightRadius:t.radii("borderBottomRightRadius"),borderLeft:t.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:t.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:t.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:t.borders(["borderLeft","borderRight"]),borderInline:t.borders("borderInline"),borderY:t.borders(["borderTop","borderBottom"]),borderBlock:t.borders("borderBlock"),borderTopWidth:t.borderWidths("borderTopWidth"),borderBlockStartWidth:t.borderWidths("borderBlockStartWidth"),borderTopColor:t.colors("borderTopColor"),borderBlockStartColor:t.colors("borderBlockStartColor"),borderTopStyle:t.borderStyles("borderTopStyle"),borderBlockStartStyle:t.borderStyles("borderBlockStartStyle"),borderBottomWidth:t.borderWidths("borderBottomWidth"),borderBlockEndWidth:t.borderWidths("borderBlockEndWidth"),borderBottomColor:t.colors("borderBottomColor"),borderBlockEndColor:t.colors("borderBlockEndColor"),borderBottomStyle:t.borderStyles("borderBottomStyle"),borderBlockEndStyle:t.borderStyles("borderBlockEndStyle"),borderLeftWidth:t.borderWidths("borderLeftWidth"),borderInlineStartWidth:t.borderWidths("borderInlineStartWidth"),borderLeftColor:t.colors("borderLeftColor"),borderInlineStartColor:t.colors("borderInlineStartColor"),borderLeftStyle:t.borderStyles("borderLeftStyle"),borderInlineStartStyle:t.borderStyles("borderInlineStartStyle"),borderRightWidth:t.borderWidths("borderRightWidth"),borderInlineEndWidth:t.borderWidths("borderInlineEndWidth"),borderRightColor:t.colors("borderRightColor"),borderInlineEndColor:t.colors("borderInlineEndColor"),borderRightStyle:t.borderStyles("borderRightStyle"),borderInlineEndStyle:t.borderStyles("borderInlineEndStyle"),borderTopRadius:t.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:t.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:t.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:t.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(border,{rounded:border.borderRadius,roundedTop:border.borderTopRadius,roundedTopLeft:border.borderTopLeftRadius,roundedTopRight:border.borderTopRightRadius,roundedTopStart:border.borderStartStartRadius,roundedTopEnd:border.borderStartEndRadius,roundedBottom:border.borderBottomRadius,roundedBottomLeft:border.borderBottomLeftRadius,roundedBottomRight:border.borderBottomRightRadius,roundedBottomStart:border.borderEndStartRadius,roundedBottomEnd:border.borderEndEndRadius,roundedLeft:border.borderLeftRadius,roundedRight:border.borderRightRadius,roundedStart:border.borderInlineStartRadius,roundedEnd:border.borderInlineEndRadius,borderStart:border.borderInlineStart,borderEnd:border.borderInlineEnd,borderTopStartRadius:border.borderStartStartRadius,borderTopEndRadius:border.borderStartEndRadius,borderBottomStartRadius:border.borderEndStartRadius,borderBottomEndRadius:border.borderEndEndRadius,borderStartRadius:border.borderInlineStartRadius,borderEndRadius:border.borderInlineEndRadius,borderStartWidth:border.borderInlineStartWidth,borderEndWidth:border.borderInlineEndWidth,borderStartColor:border.borderInlineStartColor,borderEndColor:border.borderInlineEndColor,borderStartStyle:border.borderInlineStartStyle,borderEndStyle:border.borderInlineEndStyle});var color$1={color:t.colors("color"),textColor:t.colors("color"),fill:t.colors("fill"),stroke:t.colors("stroke")},effect={boxShadow:t.shadows("boxShadow"),mixBlendMode:!0,blendMode:t.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:t.prop("backgroundBlendMode"),opacity:!0};Object.assign(effect,{shadow:effect.boxShadow});var filter$3={filter:{transform:transformFunctions.filter},blur:t.blur("--chakra-blur"),brightness:t.propT("--chakra-brightness",transformFunctions.brightness),contrast:t.propT("--chakra-contrast",transformFunctions.contrast),hueRotate:t.degreeT("--chakra-hue-rotate"),invert:t.propT("--chakra-invert",transformFunctions.invert),saturate:t.propT("--chakra-saturate",transformFunctions.saturate),dropShadow:t.propT("--chakra-drop-shadow",transformFunctions.dropShadow),backdropFilter:{transform:transformFunctions.backdropFilter},backdropBlur:t.blur("--chakra-backdrop-blur"),backdropBrightness:t.propT("--chakra-backdrop-brightness",transformFunctions.brightness),backdropContrast:t.propT("--chakra-backdrop-contrast",transformFunctions.contrast),backdropHueRotate:t.degreeT("--chakra-backdrop-hue-rotate"),backdropInvert:t.propT("--chakra-backdrop-invert",transformFunctions.invert),backdropSaturate:t.propT("--chakra-backdrop-saturate",transformFunctions.saturate)},flexbox={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:transformFunctions.flexDirection},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:t.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0,gap:t.space("gap"),rowGap:t.space("rowGap"),columnGap:t.space("columnGap")};Object.assign(flexbox,{flexDir:flexbox.flexDirection});var grid={gridGap:t.space("gridGap"),gridColumnGap:t.space("gridColumnGap"),gridRowGap:t.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},interactivity={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:transformFunctions.outline},outlineOffset:!0,outlineColor:t.colors("outlineColor")},layout={width:t.sizesT("width"),inlineSize:t.sizesT("inlineSize"),height:t.sizes("height"),blockSize:t.sizes("blockSize"),boxSize:t.sizes(["width","height"]),minWidth:t.sizes("minWidth"),minInlineSize:t.sizes("minInlineSize"),minHeight:t.sizes("minHeight"),minBlockSize:t.sizes("minBlockSize"),maxWidth:t.sizes("maxWidth"),maxInlineSize:t.sizes("maxInlineSize"),maxHeight:t.sizes("maxHeight"),maxBlockSize:t.sizes("maxBlockSize"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,hideFrom:{scale:"breakpoints",transform:(_,o)=>{var $,j,et;return{[(et=(j=($=o.__breakpoints)==null?void 0:$.get(_))==null?void 0:j.minWQuery)!=null?et:`@media screen and (min-width: ${_})`]:{display:"none"}}}},hideBelow:{scale:"breakpoints",transform:(_,o)=>{var $,j,et;return{[(et=(j=($=o.__breakpoints)==null?void 0:$.get(_))==null?void 0:j.maxWQuery)!=null?et:`@media screen and (max-width: ${_})`]:{display:"none"}}}},verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:t.propT("float",transformFunctions.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(layout,{w:layout.width,h:layout.height,minW:layout.minWidth,maxW:layout.maxWidth,minH:layout.minHeight,maxH:layout.maxHeight,overscroll:layout.overscrollBehavior,overscrollX:layout.overscrollBehaviorX,overscrollY:layout.overscrollBehaviorY});var list={listStyleType:!0,listStylePosition:!0,listStylePos:t.prop("listStylePosition"),listStyleImage:!0,listStyleImg:t.prop("listStyleImage")};function get$6(_,o,$,j){const et=typeof o=="string"?o.split("."):[o];for(j=0;j<et.length&&_;j+=1)_=_[et[j]];return _===void 0?$:_}var memoize$1=_=>{const o=new WeakMap;return(j,et,tt,rt)=>{if(typeof j>"u")return _(j,et,tt);o.has(j)||o.set(j,new Map);const nt=o.get(j);if(nt.has(et))return nt.get(et);const it=_(j,et,tt,rt);return nt.set(et,it),it}},memoizedGet$1=memoize$1(get$6),srOnly={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},srFocusable={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},getWithPriority=(_,o,$)=>{const j={},et=memoizedGet$1(_,o,{});for(const tt in et)tt in $&&$[tt]!=null||(j[tt]=et[tt]);return j},others={srOnly:{transform(_){return _===!0?srOnly:_==="focusable"?srFocusable:{}}},layerStyle:{processResult:!0,transform:(_,o,$)=>getWithPriority(o,`layerStyles.${_}`,$)},textStyle:{processResult:!0,transform:(_,o,$)=>getWithPriority(o,`textStyles.${_}`,$)},apply:{processResult:!0,transform:(_,o,$)=>getWithPriority(o,_,$)}},position={position:!0,pos:t.prop("position"),zIndex:t.prop("zIndex","zIndices"),inset:t.spaceT("inset"),insetX:t.spaceT(["left","right"]),insetInline:t.spaceT("insetInline"),insetY:t.spaceT(["top","bottom"]),insetBlock:t.spaceT("insetBlock"),top:t.spaceT("top"),insetBlockStart:t.spaceT("insetBlockStart"),bottom:t.spaceT("bottom"),insetBlockEnd:t.spaceT("insetBlockEnd"),left:t.spaceT("left"),insetInlineStart:t.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:t.spaceT("right"),insetInlineEnd:t.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(position,{insetStart:position.insetInlineStart,insetEnd:position.insetInlineEnd});var ring={ring:{transform:transformFunctions.ring},ringColor:t.colors("--chakra-ring-color"),ringOffset:t.prop("--chakra-ring-offset-width"),ringOffsetColor:t.colors("--chakra-ring-offset-color"),ringInset:t.prop("--chakra-ring-inset")},space={margin:t.spaceT("margin"),marginTop:t.spaceT("marginTop"),marginBlockStart:t.spaceT("marginBlockStart"),marginRight:t.spaceT("marginRight"),marginInlineEnd:t.spaceT("marginInlineEnd"),marginBottom:t.spaceT("marginBottom"),marginBlockEnd:t.spaceT("marginBlockEnd"),marginLeft:t.spaceT("marginLeft"),marginInlineStart:t.spaceT("marginInlineStart"),marginX:t.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:t.spaceT("marginInline"),marginY:t.spaceT(["marginTop","marginBottom"]),marginBlock:t.spaceT("marginBlock"),padding:t.space("padding"),paddingTop:t.space("paddingTop"),paddingBlockStart:t.space("paddingBlockStart"),paddingRight:t.space("paddingRight"),paddingBottom:t.space("paddingBottom"),paddingBlockEnd:t.space("paddingBlockEnd"),paddingLeft:t.space("paddingLeft"),paddingInlineStart:t.space("paddingInlineStart"),paddingInlineEnd:t.space("paddingInlineEnd"),paddingX:t.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:t.space("paddingInline"),paddingY:t.space(["paddingTop","paddingBottom"]),paddingBlock:t.space("paddingBlock")};Object.assign(space,{m:space.margin,mt:space.marginTop,mr:space.marginRight,me:space.marginInlineEnd,marginEnd:space.marginInlineEnd,mb:space.marginBottom,ml:space.marginLeft,ms:space.marginInlineStart,marginStart:space.marginInlineStart,mx:space.marginX,my:space.marginY,p:space.padding,pt:space.paddingTop,py:space.paddingY,px:space.paddingX,pb:space.paddingBottom,pl:space.paddingLeft,ps:space.paddingInlineStart,paddingStart:space.paddingInlineStart,pr:space.paddingRight,pe:space.paddingInlineEnd,paddingEnd:space.paddingInlineEnd});var textDecoration={textDecorationColor:t.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:t.shadows("textShadow")},transform={clipPath:!0,transform:t.propT("transform",transformFunctions.transform),transformOrigin:!0,translateX:t.spaceT("--chakra-translate-x"),translateY:t.spaceT("--chakra-translate-y"),skewX:t.degreeT("--chakra-skew-x"),skewY:t.degreeT("--chakra-skew-y"),scaleX:t.prop("--chakra-scale-x"),scaleY:t.prop("--chakra-scale-y"),scale:t.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:t.degreeT("--chakra-rotate")},transition$1={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:t.prop("transitionDuration","transition.duration"),transitionProperty:t.prop("transitionProperty","transition.property"),transitionTimingFunction:t.prop("transitionTimingFunction","transition.easing")},typography$1={fontFamily:t.prop("fontFamily","fonts"),fontSize:t.prop("fontSize","fontSizes",transformFunctions.px),fontWeight:t.prop("fontWeight","fontWeights"),lineHeight:t.prop("lineHeight","lineHeights"),letterSpacing:t.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,textIndent:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,isTruncated:{transform(_){if(_===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"}},scroll={scrollBehavior:!0,scrollSnapAlign:!0,scrollSnapStop:!0,scrollSnapType:!0,scrollMargin:t.spaceT("scrollMargin"),scrollMarginTop:t.spaceT("scrollMarginTop"),scrollMarginBottom:t.spaceT("scrollMarginBottom"),scrollMarginLeft:t.spaceT("scrollMarginLeft"),scrollMarginRight:t.spaceT("scrollMarginRight"),scrollMarginX:t.spaceT(["scrollMarginLeft","scrollMarginRight"]),scrollMarginY:t.spaceT(["scrollMarginTop","scrollMarginBottom"]),scrollPadding:t.spaceT("scrollPadding"),scrollPaddingTop:t.spaceT("scrollPaddingTop"),scrollPaddingBottom:t.spaceT("scrollPaddingBottom"),scrollPaddingLeft:t.spaceT("scrollPaddingLeft"),scrollPaddingRight:t.spaceT("scrollPaddingRight"),scrollPaddingX:t.spaceT(["scrollPaddingLeft","scrollPaddingRight"]),scrollPaddingY:t.spaceT(["scrollPaddingTop","scrollPaddingBottom"])};function resolveReference(_){return isObject$1(_)&&_.reference?_.reference:String(_)}var toExpression=(_,...o)=>o.map(resolveReference).join(` ${_} `).replace(/calc/g,""),add$1=(..._)=>`calc(${toExpression("+",..._)})`,subtract$1=(..._)=>`calc(${toExpression("-",..._)})`,multiply$1=(..._)=>`calc(${toExpression("*",..._)})`,divide$1=(..._)=>`calc(${toExpression("/",..._)})`,negate$1=_=>{const o=resolveReference(_);return o!=null&&!Number.isNaN(parseFloat(o))?String(o).startsWith("-")?String(o).slice(1):`-${o}`:multiply$1(o,-1)},calc$1=Object.assign(_=>({add:(...o)=>calc$1(add$1(_,...o)),subtract:(...o)=>calc$1(subtract$1(_,...o)),multiply:(...o)=>calc$1(multiply$1(_,...o)),divide:(...o)=>calc$1(divide$1(_,...o)),negate:()=>calc$1(negate$1(_)),toString:()=>_.toString()}),{add:add$1,subtract:subtract$1,multiply:multiply$1,divide:divide$1,negate:negate$1});function replaceWhiteSpace$1(_,o="-"){return _.replace(/\s+/g,o)}function escape$2(_){const o=replaceWhiteSpace$1(_.toString());return escapeSymbol(escapeDot(o))}function escapeDot(_){return _.includes("\\.")?_:!Number.isInteger(parseFloat(_.toString()))?_.replace(".","\\."):_}function escapeSymbol(_){return _.replace(/[!-,/:-@[-^`{-~]/g,"\\$&")}function addPrefix$1(_,o=""){return[o,_].filter(Boolean).join("-")}function toVarReference(_,o){return`var(${_}${o?`, ${o}`:""})`}function toVarDefinition(_,o=""){return escape$2(`--${addPrefix$1(_,o)}`)}function cssVar$1(_,o,$){const j=toVarDefinition(_,$);return{variable:j,reference:toVarReference(j,o)}}function getLastItem(_){const o=_==null?0:_.length;return o?_[o-1]:void 0}function analyzeCSSValue2(_){const o=parseFloat(_.toString()),$=_.toString().replace(String(o),"");return{unitless:!$,value:o,unit:$}}function px$1(_){if(_==null)return _;const{unitless:o}=analyzeCSSValue2(_);return o||typeof _=="number"?`${_}px`:_}var sortByBreakpointValue=(_,o)=>parseInt(_[1],10)>parseInt(o[1],10)?1:-1,sortBps=_=>Object.fromEntries(Object.entries(_).sort(sortByBreakpointValue));function normalize(_){const o=sortBps(_);return Object.assign(Object.values(o),o)}function keys$1(_){const o=Object.keys(sortBps(_));return new Set(o)}function subtract2(_){var o;if(!_)return _;_=(o=px$1(_))!=null?o:_;const $=-.02;return typeof _=="number"?`${_+$}`:_.replace(/(\d+\.?\d*)/u,j=>`${parseFloat(j)+$}`)}function toMediaQueryString(_,o){const $=["@media screen"];return _&&$.push("and",`(min-width: ${px$1(_)})`),o&&$.push("and",`(max-width: ${px$1(o)})`),$.join(" ")}function analyzeBreakpoints(_){var o;if(!_)return null;_.base=(o=_.base)!=null?o:"0px";const $=normalize(_),j=Object.entries(_).sort(sortByBreakpointValue).map(([rt,nt],it,st)=>{var ot;let[,at]=(ot=st[it+1])!=null?ot:[];return at=parseFloat(at)>0?subtract2(at):void 0,{_minW:subtract2(nt),breakpoint:rt,minW:nt,maxW:at,maxWQuery:toMediaQueryString(null,at),minWQuery:toMediaQueryString(nt),minMaxQuery:toMediaQueryString(nt,at)}}),et=keys$1(_),tt=Array.from(et.values());return{keys:et,normalized:$,isResponsive(rt){const nt=Object.keys(rt);return nt.length>0&&nt.every(it=>et.has(it))},asObject:sortBps(_),asArray:normalize(_),details:j,get(rt){return j.find(nt=>nt.breakpoint===rt)},media:[null,...$.map(rt=>toMediaQueryString(rt)).slice(1)],toArrayValue(rt){if(!isObject$1(rt))throw new Error("toArrayValue: value must be an object");const nt=tt.map(it=>{var st;return(st=rt[it])!=null?st:null});for(;getLastItem(nt)===null;)nt.pop();return nt},toObjectValue(rt){if(!Array.isArray(rt))throw new Error("toObjectValue: value must be an array");return rt.reduce((nt,it,st)=>{const ot=tt[st];return ot!=null&&it!=null&&(nt[ot]=it),nt},{})}}}var state$1={hover:(_,o)=>`${_}:hover ${o}, ${_}[data-hover] ${o}`,focus:(_,o)=>`${_}:focus ${o}, ${_}[data-focus] ${o}`,focusVisible:(_,o)=>`${_}:focus-visible ${o}`,focusWithin:(_,o)=>`${_}:focus-within ${o}`,active:(_,o)=>`${_}:active ${o}, ${_}[data-active] ${o}`,disabled:(_,o)=>`${_}:disabled ${o}, ${_}[data-disabled] ${o}`,invalid:(_,o)=>`${_}:invalid ${o}, ${_}[data-invalid] ${o}`,checked:(_,o)=>`${_}:checked ${o}, ${_}[data-checked] ${o}`,indeterminate:(_,o)=>`${_}:indeterminate ${o}, ${_}[aria-checked=mixed] ${o}, ${_}[data-indeterminate] ${o}`,readOnly:(_,o)=>`${_}:read-only ${o}, ${_}[readonly] ${o}, ${_}[data-read-only] ${o}`,expanded:(_,o)=>`${_}:read-only ${o}, ${_}[aria-expanded=true] ${o}, ${_}[data-expanded] ${o}`,placeholderShown:(_,o)=>`${_}:placeholder-shown ${o}`},toGroup=_=>merge$4(o=>_(o,"&"),"[role=group]","[data-group]",".group"),toPeer=_=>merge$4(o=>_(o,"~ &"),"[data-peer]",".peer"),merge$4=(_,...o)=>o.map(_).join(", "),pseudoSelectors={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible, &[data-focus-visible]",_disabled:"&:disabled, &[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:toGroup(state$1.hover),_peerHover:toPeer(state$1.hover),_groupFocus:toGroup(state$1.focus),_peerFocus:toPeer(state$1.focus),_groupFocusVisible:toGroup(state$1.focusVisible),_peerFocusVisible:toPeer(state$1.focusVisible),_groupActive:toGroup(state$1.active),_peerActive:toPeer(state$1.active),_groupDisabled:toGroup(state$1.disabled),_peerDisabled:toPeer(state$1.disabled),_groupInvalid:toGroup(state$1.invalid),_peerInvalid:toPeer(state$1.invalid),_groupChecked:toGroup(state$1.checked),_peerChecked:toPeer(state$1.checked),_groupFocusWithin:toGroup(state$1.focusWithin),_peerFocusWithin:toPeer(state$1.focusWithin),_peerPlaceholderShown:toPeer(state$1.placeholderShown),_placeholder:"&::placeholder",_placeholderShown:"&:placeholder-shown",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &, &[dir=rtl]",_ltr:"[dir=ltr] &, &[dir=ltr]",_mediaDark:"@media (prefers-color-scheme: dark)",_mediaReduceMotion:"@media (prefers-reduced-motion: reduce)",_dark:".chakra-ui-dark &:not([data-theme]),[data-theme=dark] &:not([data-theme]),&[data-theme=dark]",_light:".chakra-ui-light &:not([data-theme]),[data-theme=light] &:not([data-theme]),&[data-theme=light]"},pseudoPropNames=Object.keys(pseudoSelectors);function tokenToCssVar(_,o){return cssVar$1(String(_).replace(/\./g,"-"),void 0,o)}function createThemeVars(_,o){let $={};const j={};for(const[et,tt]of Object.entries(_)){const{isSemantic:rt,value:nt}=tt,{variable:it,reference:st}=tokenToCssVar(et,o==null?void 0:o.cssVarPrefix);if(!rt){if(et.startsWith("space")){const ct=et.split("."),[ut,...ft]=ct,ht=`${ut}.-${ft.join(".")}`,mt=calc$1.negate(nt),gt=calc$1.negate(st);j[ht]={value:mt,var:it,varRef:gt}}$[it]=nt,j[et]={value:nt,var:it,varRef:st};continue}const ot=ct=>{const ft=[String(et).split(".")[0],ct].join(".");if(!_[ft])return ct;const{reference:mt}=tokenToCssVar(ft,o==null?void 0:o.cssVarPrefix);return mt},at=isObject$1(nt)?nt:{default:nt};$=mergeWith($,Object.entries(at).reduce((ct,[ut,ft])=>{var ht,mt;const gt=ot(ft);if(ut==="default")return ct[it]=gt,ct;const Et=(mt=(ht=pseudoSelectors)==null?void 0:ht[ut])!=null?mt:ut;return ct[Et]={[it]:gt},ct},{})),j[et]={value:st,var:it,varRef:st}}return{cssVars:$,cssMap:j}}function omit$1(_,o=[]){const $=Object.assign({},_);for(const j of o)j in $&&delete $[j];return $}function pick$1(_,o){const $={};for(const j of o)j in _&&($[j]=_[j]);return $}var tokens=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur","breakpoints"];function extractTokens(_){return pick$1(_,tokens)}function extractSemanticTokens(_){return _.semanticTokens}function omitVars(_){const{__cssMap:o,__cssVars:$,__breakpoints:j,...et}=_;return et}function flattenTokens({tokens:_,semanticTokens:o}){var $,j;const et=Object.entries(($=flatten$1(_))!=null?$:{}).map(([rt,nt])=>[rt,{isSemantic:!1,value:nt}]),tt=Object.entries((j=flatten$1(o,1))!=null?j:{}).map(([rt,nt])=>[rt,{isSemantic:!0,value:nt}]);return Object.fromEntries([...et,...tt])}function flatten$1(_,o=1/0){return!isObject$1(_)&&!Array.isArray(_)||!o?_:Object.entries(_).reduce(($,[j,et])=>(isObject$1(et)||Array.isArray(et)?Object.entries(flatten$1(et,o-1)).forEach(([tt,rt])=>{$[`${j}.${tt}`]=rt}):$[j]=et,$),{})}function toCSSVar(_){var o;const $=omitVars(_),j=extractTokens($),et=extractSemanticTokens($),tt=flattenTokens({tokens:j,semanticTokens:et}),rt=(o=$.config)==null?void 0:o.cssVarPrefix,{cssMap:nt,cssVars:it}=createThemeVars(tt,{cssVarPrefix:rt});return Object.assign($,{__cssVars:{...{"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"},...it},__cssMap:nt,__breakpoints:analyzeBreakpoints($.breakpoints)}),$}var systemProps=mergeWith({},background,border,color$1,flexbox,layout,filter$3,ring,interactivity,grid,others,position,effect,space,scroll,typography$1,textDecoration,transform,list,transition$1),layoutSystem=Object.assign({},space,layout,flexbox,grid,position),layoutPropNames=Object.keys(layoutSystem),propNames=[...Object.keys(systemProps),...pseudoPropNames],styleProps={...systemProps,...pseudoSelectors},isStyleProp=_=>_ in styleProps,expandResponsive=_=>o=>{if(!o.__breakpoints)return _;const{isResponsive:$,toArrayValue:j,media:et}=o.__breakpoints,tt={};for(const rt in _){let nt=runIfFn$2(_[rt],o);if(nt==null)continue;if(nt=isObject$1(nt)&&$(nt)?j(nt):nt,!Array.isArray(nt)){tt[rt]=nt;continue}const it=nt.slice(0,et.length).length;for(let st=0;st<it;st+=1){const ot=et==null?void 0:et[st];if(!ot){tt[rt]=nt[st];continue}tt[ot]=tt[ot]||{},nt[st]!=null&&(tt[ot][rt]=nt[st])}}return tt};function splitByComma(_){const o=[];let $="",j=!1;for(let et=0;et<_.length;et++){const tt=_[et];tt==="("?(j=!0,$+=tt):tt===")"?(j=!1,$+=tt):tt===","&&!j?(o.push($),$=""):$+=tt}return $=$.trim(),$&&o.push($),o}function isCssVar2(_){return/^var\(--.+\)$/.test(_)}var isCSSVariableTokenValue=(_,o)=>_.startsWith("--")&&typeof o=="string"&&!isCssVar2(o),resolveTokenValue=(_,o)=>{var $,j;if(o==null)return o;const et=it=>{var st,ot;return(ot=(st=_.__cssMap)==null?void 0:st[it])==null?void 0:ot.varRef},tt=it=>{var st;return(st=et(it))!=null?st:it},[rt,nt]=splitByComma(o);return o=(j=($=et(rt))!=null?$:tt(nt))!=null?j:tt(o),o};function getCss(_){const{configs:o={},pseudos:$={},theme:j}=_,et=(tt,rt=!1)=>{var nt,it,st;const ot=runIfFn$2(tt,j),at=expandResponsive(ot)(j);let ct={};for(let ut in at){const ft=at[ut];let ht=runIfFn$2(ft,j);ut in $&&(ut=$[ut]),isCSSVariableTokenValue(ut,ht)&&(ht=resolveTokenValue(j,ht));let mt=o[ut];if(mt===!0&&(mt={property:ut}),isObject$1(ht)){ct[ut]=(nt=ct[ut])!=null?nt:{},ct[ut]=mergeWith({},ct[ut],et(ht,!0));continue}let gt=(st=(it=mt==null?void 0:mt.transform)==null?void 0:it.call(mt,ht,j,ot))!=null?st:ht;gt=mt!=null&&mt.processResult?et(gt,!0):gt;const Et=runIfFn$2(mt==null?void 0:mt.property,j);if(!rt&&(mt!=null&&mt.static)){const St=runIfFn$2(mt.static,j);ct=mergeWith({},ct,St)}if(Et&&Array.isArray(Et)){for(const St of Et)ct[St]=gt;continue}if(Et){Et==="&"&&isObject$1(gt)?ct=mergeWith({},ct,gt):ct[Et]=gt;continue}if(isObject$1(gt)){ct=mergeWith({},ct,gt);continue}ct[ut]=gt}return ct};return et}var css=_=>o=>getCss({theme:o,pseudos:pseudoSelectors,configs:systemProps})(_);function defineStyle(_){return _}function defineStyleConfig(_){return _}function createMultiStyleConfigHelpers(_){return{definePartsStyle(o){return o},defineMultiStyleConfig(o){return{parts:_,...o}}}}function normalize2(_,o){if(Array.isArray(_))return _;if(isObject$1(_))return o(_);if(_!=null)return[_]}function getNextIndex$1(_,o){for(let $=o+1;$<_.length;$++)if(_[$]!=null)return $;return-1}function createResolver(_){const o=_.__breakpoints;return function(j,et,tt,rt){var nt,it;if(!o)return;const st={},ot=normalize2(tt,o.toArrayValue);if(!ot)return st;const at=ot.length,ct=at===1,ut=!!j.parts;for(let ft=0;ft<at;ft++){const ht=o.details[ft],mt=o.details[getNextIndex$1(ot,ft)],gt=toMediaQueryString(ht.minW,mt==null?void 0:mt._minW),Et=runIfFn$2((nt=j[et])==null?void 0:nt[ot[ft]],rt);if(Et){if(ut){(it=j.parts)==null||it.forEach(St=>{mergeWith(st,{[St]:ct?Et[St]:{[gt]:Et[St]}})});continue}if(!ut){ct?mergeWith(st,Et):st[gt]=Et;continue}st[gt]=Et}}return st}}function resolveStyleConfig(_){return o=>{var $;const{variant:j,size:et,theme:tt}=o,rt=createResolver(tt);return mergeWith({},runIfFn$2(($=_.baseStyle)!=null?$:{},o),rt(_,"sizes",et,o),rt(_,"variants",j,o))}}function omitThemingProps(_){return omit$1(_,["styleConfig","size","variant","colorScheme"])}var requiredChakraThemeKeys=["borders","breakpoints","colors","components","config","direction","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","shadows","sizes","space","styles","transition","zIndices"];function isChakraTheme(_){return isObject$1(_)?requiredChakraThemeKeys.every(o=>Object.prototype.hasOwnProperty.call(_,o)):!1}var zIndices={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},z_index_default=zIndices,breakpoints={base:"0em",sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"},breakpoints_default=breakpoints,colors={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},colors_default=colors,radii={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},radius_default=radii,shadows={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},shadows_default=shadows,transitionProperty={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},transitionTimingFunction={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},transitionDuration={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},transition={property:transitionProperty,easing:transitionTimingFunction,duration:transitionDuration},transition_default=transition,blur={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},blur_default=blur,borders$1={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},borders_default=borders$1,typography={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{"3xs":"0.45rem","2xs":"0.625rem",xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},typography_default=typography,spacing={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},largeSizes={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem",prose:"60ch"},container={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},sizes$m={...spacing,...largeSizes,container},sizes_default=sizes$m,foundations={breakpoints:breakpoints_default,zIndices:z_index_default,radii:radius_default,blur:blur_default,colors:colors_default,...typography_default,sizes:sizes_default,shadows:shadows_default,space:spacing,borders:borders_default,transition:transition_default};function anatomy(_,o={}){let $=!1;function j(){if(!$){$=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}function et(...ot){j();for(const at of ot)o[at]=it(at);return anatomy(_,o)}function tt(...ot){for(const at of ot)at in o||(o[at]=it(at));return anatomy(_,o)}function rt(){return Object.fromEntries(Object.entries(o).map(([at,ct])=>[at,ct.selector]))}function nt(){return Object.fromEntries(Object.entries(o).map(([at,ct])=>[at,ct.className]))}function it(ot){const ut=`chakra-${(["container","root"].includes(ot??"")?[_]:[_,ot]).filter(Boolean).join("__")}`;return{className:ut,selector:`.${ut}`,toString:()=>ot}}return{parts:et,toPart:it,extend:tt,selectors:rt,classnames:nt,get keys(){return Object.keys(o)},__type:{}}}var accordionAnatomy=anatomy("accordion").parts("root","container","button","panel").extend("icon"),alertAnatomy=anatomy("alert").parts("title","description","container").extend("icon","spinner"),avatarAnatomy=anatomy("avatar").parts("label","badge","container").extend("excessLabel","group"),breadcrumbAnatomy=anatomy("breadcrumb").parts("link","item","container").extend("separator");anatomy("button").parts();var checkboxAnatomy=anatomy("checkbox").parts("control","icon","container").extend("label");anatomy("progress").parts("track","filledTrack").extend("label");var drawerAnatomy=anatomy("drawer").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),editableAnatomy=anatomy("editable").parts("preview","input","textarea"),formAnatomy=anatomy("form").parts("container","requiredIndicator","helperText"),formErrorAnatomy=anatomy("formError").parts("text","icon"),inputAnatomy=anatomy("input").parts("addon","field","element"),listAnatomy=anatomy("list").parts("container","item","icon"),menuAnatomy=anatomy("menu").parts("button","list","item").extend("groupTitle","command","divider"),modalAnatomy=anatomy("modal").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),numberInputAnatomy=anatomy("numberinput").parts("root","field","stepperGroup","stepper");anatomy("pininput").parts("field");var popoverAnatomy=anatomy("popover").parts("content","header","body","footer").extend("popper","arrow","closeButton"),progressAnatomy=anatomy("progress").parts("label","filledTrack","track"),radioAnatomy=anatomy("radio").parts("container","control","label"),selectAnatomy=anatomy("select").parts("field","icon"),sliderAnatomy=anatomy("slider").parts("container","track","thumb","filledTrack","mark"),statAnatomy=anatomy("stat").parts("container","label","helpText","number","icon"),switchAnatomy=anatomy("switch").parts("container","track","thumb"),tableAnatomy=anatomy("table").parts("table","thead","tbody","tr","th","td","tfoot","caption"),tabsAnatomy=anatomy("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator"),tagAnatomy=anatomy("tag").parts("container","label","closeButton"),cardAnatomy=anatomy("card").parts("container","header","body","footer");function guard(_,o,$){return Math.min(Math.max(_,$),o)}class ColorError extends Error{constructor(o){super(`Failed to parse color: "${o}"`)}}var ColorError$1=ColorError;function parseToRgba(_){if(typeof _!="string")throw new ColorError$1(_);if(_.trim().toLowerCase()==="transparent")return[0,0,0,0];let o=_.trim();o=namedColorRegex.test(_)?nameToHex(_):_;const $=reducedHexRegex.exec(o);if($){const rt=Array.from($).slice(1);return[...rt.slice(0,3).map(nt=>parseInt(r$1(nt,2),16)),parseInt(r$1(rt[3]||"f",2),16)/255]}const j=hexRegex.exec(o);if(j){const rt=Array.from(j).slice(1);return[...rt.slice(0,3).map(nt=>parseInt(nt,16)),parseInt(rt[3]||"ff",16)/255]}const et=rgbaRegex.exec(o);if(et){const rt=Array.from(et).slice(1);return[...rt.slice(0,3).map(nt=>parseInt(nt,10)),parseFloat(rt[3]||"1")]}const tt=hslaRegex.exec(o);if(tt){const[rt,nt,it,st]=Array.from(tt).slice(1).map(parseFloat);if(guard(0,100,nt)!==nt)throw new ColorError$1(_);if(guard(0,100,it)!==it)throw new ColorError$1(_);return[...hslToRgb(rt,nt,it),Number.isNaN(st)?1:st]}throw new ColorError$1(_)}function hash$7(_){let o=5381,$=_.length;for(;$;)o=o*33^_.charCodeAt(--$);return(o>>>0)%2341}const colorToInt=_=>parseInt(_.replace(/_/g,""),36),compressedColorMap="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((_,o)=>{const $=colorToInt(o.substring(0,3)),j=colorToInt(o.substring(3)).toString(16);let et="";for(let tt=0;tt<6-j.length;tt++)et+="0";return _[$]=`${et}${j}`,_},{});function nameToHex(_){const o=_.toLowerCase().trim(),$=compressedColorMap[hash$7(o)];if(!$)throw new ColorError$1(_);return`#${$}`}const r$1=(_,o)=>Array.from(Array(o)).map(()=>_).join(""),reducedHexRegex=new RegExp(`^#${r$1("([a-f0-9])",3)}([a-f0-9])?$`,"i"),hexRegex=new RegExp(`^#${r$1("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),rgbaRegex=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${r$1(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),hslaRegex=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,namedColorRegex=/^[a-z]+$/i,roundColor=_=>Math.round(_*255),hslToRgb=(_,o,$)=>{let j=$/100;if(o===0)return[j,j,j].map(roundColor);const et=(_%360+360)%360/60,tt=(1-Math.abs(2*j-1))*(o/100),rt=tt*(1-Math.abs(et%2-1));let nt=0,it=0,st=0;et>=0&&et<1?(nt=tt,it=rt):et>=1&&et<2?(nt=rt,it=tt):et>=2&&et<3?(it=tt,st=rt):et>=3&&et<4?(it=rt,st=tt):et>=4&&et<5?(nt=rt,st=tt):et>=5&&et<6&&(nt=tt,st=rt);const ot=j-tt/2,at=nt+ot,ct=it+ot,ut=st+ot;return[at,ct,ut].map(roundColor)};function rgba$1(_,o,$,j){return`rgba(${guard(0,255,_).toFixed()}, ${guard(0,255,o).toFixed()}, ${guard(0,255,$).toFixed()}, ${parseFloat(guard(0,1,j).toFixed(3))})`}function transparentize$1(_,o){const[$,j,et,tt]=parseToRgba(_);return rgba$1($,j,et,tt-o)}function toHex$2(_){const[o,$,j,et]=parseToRgba(_);let tt=rt=>{const nt=guard(0,255,rt).toString(16);return nt.length===1?`0${nt}`:nt};return`#${tt(o)}${tt($)}${tt(j)}${et<1?tt(Math.round(et*255)):""}`}function dlv_es_default(_,o,$,j,et){for(o=o.split?o.split("."):o,j=0;j<o.length;j++)_=_?_[o[j]]:et;return _===et?$:_}var isEmptyObject=_=>Object.keys(_).length===0,getColor=(_,o,$)=>{const j=dlv_es_default(_,`colors.${o}`,o);try{return toHex$2(j),j}catch{return $??"#000000"}},getBrightness=_=>{const[o,$,j]=parseToRgba(_);return(o*299+$*587+j*114)/1e3},tone=_=>o=>{const $=getColor(o,_);return getBrightness($)<128?"dark":"light"},isDark=_=>o=>tone(_)(o)==="dark",transparentize=(_,o)=>$=>{const j=getColor($,_);return transparentize$1(j,1-o)};function generateStripe(_="1rem",o="rgba(255, 255, 255, 0.15)"){return{backgroundImage:`linear-gradient(
    45deg,
    ${o} 25%,
    transparent 25%,
    transparent 50%,
    ${o} 50%,
    ${o} 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:`${_} ${_}`}}var randomHex=()=>`#${Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")}`;function randomColor(_){const o=randomHex();return!_||isEmptyObject(_)?o:_.string&&_.colors?randomColorFromList(_.string,_.colors):_.string&&!_.colors?randomColorFromString(_.string):_.colors&&!_.string?randomFromList(_.colors):o}function randomColorFromString(_){let o=0;if(_.length===0)return o.toString();for(let j=0;j<_.length;j+=1)o=_.charCodeAt(j)+((o<<5)-o),o=o&o;let $="#";for(let j=0;j<3;j+=1){const et=o>>j*8&255;$+=`00${et.toString(16)}`.substr(-2)}return $}function randomColorFromList(_,o){let $=0;if(_.length===0)return o[0];for(let j=0;j<_.length;j+=1)$=_.charCodeAt(j)+(($<<5)-$),$=$&$;return $=($%o.length+o.length)%o.length,o[$]}function randomFromList(_){return _[Math.floor(Math.random()*_.length)]}function mode(_,o){return $=>$.colorMode==="dark"?o:_}function orient(_){const{orientation:o,vertical:$,horizontal:j}=_;return o?o==="vertical"?$:j:{}}function toRef(_){return isObject$1(_)&&_.reference?_.reference:String(_)}var toExpr=(_,...o)=>o.map(toRef).join(` ${_} `).replace(/calc/g,""),add=(..._)=>`calc(${toExpr("+",..._)})`,subtract=(..._)=>`calc(${toExpr("-",..._)})`,multiply=(..._)=>`calc(${toExpr("*",..._)})`,divide=(..._)=>`calc(${toExpr("/",..._)})`,negate=_=>{const o=toRef(_);return o!=null&&!Number.isNaN(parseFloat(o))?String(o).startsWith("-")?String(o).slice(1):`-${o}`:multiply(o,-1)},calc=Object.assign(_=>({add:(...o)=>calc(add(_,...o)),subtract:(...o)=>calc(subtract(_,...o)),multiply:(...o)=>calc(multiply(_,...o)),divide:(...o)=>calc(divide(_,...o)),negate:()=>calc(negate(_)),toString:()=>_.toString()}),{add,subtract,multiply,divide,negate});function isDecimal(_){return!Number.isInteger(parseFloat(_.toString()))}function replaceWhiteSpace(_,o="-"){return _.replace(/\s+/g,o)}function escape$1(_){const o=replaceWhiteSpace(_.toString());return o.includes("\\.")?_:isDecimal(_)?o.replace(".","\\."):_}function addPrefix(_,o=""){return[o,escape$1(_)].filter(Boolean).join("-")}function toVarRef(_,o){return`var(${escape$1(_)}${o?`, ${o}`:""})`}function toVar(_,o=""){return`--${addPrefix(_,o)}`}function cssVar(_,o){const $=toVar(_,o==null?void 0:o.prefix);return{variable:$,reference:toVarRef($,getFallback(o==null?void 0:o.fallback))}}function getFallback(_){return typeof _=="string"?_:_==null?void 0:_.reference}var{defineMultiStyleConfig:defineMultiStyleConfig$o,definePartsStyle:definePartsStyle$o}=createMultiStyleConfigHelpers(switchAnatomy.keys),$width=cssVar("switch-track-width"),$height=cssVar("switch-track-height"),$diff=cssVar("switch-track-diff"),diffValue=calc.subtract($width,$height),$translateX=cssVar("switch-thumb-x"),$bg$e=cssVar("switch-bg"),baseStyleTrack$2=_=>{const{colorScheme:o}=_;return{borderRadius:"full",p:"0.5",width:[$width.reference],height:[$height.reference],transitionProperty:"common",transitionDuration:"fast",[$bg$e.variable]:"colors.gray.300",_dark:{[$bg$e.variable]:"colors.whiteAlpha.400"},_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{[$bg$e.variable]:`colors.${o}.500`,_dark:{[$bg$e.variable]:`colors.${o}.200`}},bg:$bg$e.reference}},baseStyleThumb$1={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:[$height.reference],height:[$height.reference],_checked:{transform:`translateX(${$translateX.reference})`}},baseStyle$F=definePartsStyle$o(_=>({container:{[$diff.variable]:diffValue,[$translateX.variable]:$diff.reference,_rtl:{[$translateX.variable]:calc($diff).negate().toString()}},track:baseStyleTrack$2(_),thumb:baseStyleThumb$1})),sizes$l={sm:definePartsStyle$o({container:{[$width.variable]:"1.375rem",[$height.variable]:"sizes.3"}}),md:definePartsStyle$o({container:{[$width.variable]:"1.875rem",[$height.variable]:"sizes.4"}}),lg:definePartsStyle$o({container:{[$width.variable]:"2.875rem",[$height.variable]:"sizes.6"}})},switchTheme=defineMultiStyleConfig$o({baseStyle:baseStyle$F,sizes:sizes$l,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:defineMultiStyleConfig$n,definePartsStyle:definePartsStyle$n}=createMultiStyleConfigHelpers(tableAnatomy.keys),baseStyle$E=definePartsStyle$n({table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}}),numericStyles={"&[data-is-numeric=true]":{textAlign:"end"}},variantSimple=definePartsStyle$n(_=>{const{colorScheme:o}=_;return{th:{color:mode("gray.600","gray.400")(_),borderBottom:"1px",borderColor:mode(`${o}.100`,`${o}.700`)(_),...numericStyles},td:{borderBottom:"1px",borderColor:mode(`${o}.100`,`${o}.700`)(_),...numericStyles},caption:{color:mode("gray.600","gray.100")(_)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),variantStripe=definePartsStyle$n(_=>{const{colorScheme:o}=_;return{th:{color:mode("gray.600","gray.400")(_),borderBottom:"1px",borderColor:mode(`${o}.100`,`${o}.700`)(_),...numericStyles},td:{borderBottom:"1px",borderColor:mode(`${o}.100`,`${o}.700`)(_),...numericStyles},caption:{color:mode("gray.600","gray.100")(_)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:mode(`${o}.100`,`${o}.700`)(_)},td:{background:mode(`${o}.100`,`${o}.700`)(_)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),variants$f={simple:variantSimple,striped:variantStripe,unstyled:{}},sizes$k={sm:definePartsStyle$n({th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}}),md:definePartsStyle$n({th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}}),lg:definePartsStyle$n({th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}})},tableTheme=defineMultiStyleConfig$n({baseStyle:baseStyle$E,variants:variants$f,sizes:sizes$k,defaultProps:{variant:"simple",size:"md",colorScheme:"gray"}}),$fg$6=cssVar$1("tabs-color"),$bg$d=cssVar$1("tabs-bg"),$border$3=cssVar$1("tabs-border-color"),{defineMultiStyleConfig:defineMultiStyleConfig$m,definePartsStyle:definePartsStyle$m}=createMultiStyleConfigHelpers(tabsAnatomy.keys),baseStyleRoot$1=_=>{const{orientation:o}=_;return{display:o==="vertical"?"flex":"block"}},baseStyleTab=_=>{const{isFitted:o}=_;return{flex:o?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focusVisible:{zIndex:1,boxShadow:"outline"},_disabled:{cursor:"not-allowed",opacity:.4}}},baseStyleTablist=_=>{const{align:o="start",orientation:$}=_;return{justifyContent:{end:"flex-end",center:"center",start:"flex-start"}[o],flexDirection:$==="vertical"?"column":"row"}},baseStyleTabpanel={p:4},baseStyle$D=definePartsStyle$m(_=>({root:baseStyleRoot$1(_),tab:baseStyleTab(_),tablist:baseStyleTablist(_),tabpanel:baseStyleTabpanel})),sizes$j={sm:definePartsStyle$m({tab:{py:1,px:4,fontSize:"sm"}}),md:definePartsStyle$m({tab:{fontSize:"md",py:2,px:4}}),lg:definePartsStyle$m({tab:{fontSize:"lg",py:3,px:4}})},variantLine=definePartsStyle$m(_=>{const{colorScheme:o,orientation:$}=_,j=$==="vertical",et=$==="vertical"?"borderStart":"borderBottom",tt=j?"marginStart":"marginBottom";return{tablist:{[et]:"2px solid",borderColor:"inherit"},tab:{[et]:"2px solid",borderColor:"transparent",[tt]:"-2px",_selected:{[$fg$6.variable]:`colors.${o}.600`,_dark:{[$fg$6.variable]:`colors.${o}.300`},borderColor:"currentColor"},_active:{[$bg$d.variable]:"colors.gray.200",_dark:{[$bg$d.variable]:"colors.whiteAlpha.300"}},_disabled:{_active:{bg:"none"}},color:$fg$6.reference,bg:$bg$d.reference}}}),variantEnclosed=definePartsStyle$m(_=>{const{colorScheme:o}=_;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",[$border$3.variable]:"transparent",_selected:{[$fg$6.variable]:`colors.${o}.600`,[$border$3.variable]:"colors.white",_dark:{[$fg$6.variable]:`colors.${o}.300`,[$border$3.variable]:"colors.gray.800"},borderColor:"inherit",borderBottomColor:$border$3.reference},color:$fg$6.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),variantEnclosedColored=definePartsStyle$m(_=>{const{colorScheme:o}=_;return{tab:{border:"1px solid",borderColor:"inherit",[$bg$d.variable]:"colors.gray.50",_dark:{[$bg$d.variable]:"colors.whiteAlpha.50"},mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{[$bg$d.variable]:"colors.white",[$fg$6.variable]:`colors.${o}.600`,_dark:{[$bg$d.variable]:"colors.gray.800",[$fg$6.variable]:`colors.${o}.300`},borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"},color:$fg$6.reference,bg:$bg$d.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),variantSoftRounded=definePartsStyle$m(_=>{const{colorScheme:o,theme:$}=_;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:getColor($,`${o}.700`),bg:getColor($,`${o}.100`)}}}}),variantSolidRounded=definePartsStyle$m(_=>{const{colorScheme:o}=_;return{tab:{borderRadius:"full",fontWeight:"semibold",[$fg$6.variable]:"colors.gray.600",_dark:{[$fg$6.variable]:"inherit"},_selected:{[$fg$6.variable]:"colors.white",[$bg$d.variable]:`colors.${o}.600`,_dark:{[$fg$6.variable]:"colors.gray.800",[$bg$d.variable]:`colors.${o}.300`}},color:$fg$6.reference,bg:$bg$d.reference}}}),variantUnstyled$2=definePartsStyle$m({}),variants$e={line:variantLine,enclosed:variantEnclosed,"enclosed-colored":variantEnclosedColored,"soft-rounded":variantSoftRounded,"solid-rounded":variantSolidRounded,unstyled:variantUnstyled$2},tabsTheme=defineMultiStyleConfig$m({baseStyle:baseStyle$D,sizes:sizes$j,variants:variants$e,defaultProps:{size:"md",variant:"line",colorScheme:"blue"}}),baseStyle$C={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold"},$bg$c=cssVar$1("badge-bg"),$fg$5=cssVar$1("badge-color"),variantSolid$3=_=>{const{colorScheme:o,theme:$}=_,j=transparentize(`${o}.500`,.6)($);return{[$bg$c.variable]:`colors.${o}.500`,[$fg$5.variable]:"colors.white",_dark:{[$bg$c.variable]:j,[$fg$5.variable]:"colors.whiteAlpha.800"},bg:$bg$c.reference,color:$fg$5.reference}},variantSubtle$1=_=>{const{colorScheme:o,theme:$}=_,j=transparentize(`${o}.200`,.16)($);return{[$bg$c.variable]:`colors.${o}.100`,[$fg$5.variable]:`colors.${o}.800`,_dark:{[$bg$c.variable]:j,[$fg$5.variable]:`colors.${o}.200`},bg:$bg$c.reference,color:$fg$5.reference}},variantOutline$2=_=>{const{colorScheme:o,theme:$}=_,j=transparentize(`${o}.200`,.8)($);return{[$fg$5.variable]:`colors.${o}.500`,_dark:{[$fg$5.variable]:j},color:$fg$5.reference,boxShadow:`inset 0 0 0px 1px ${$fg$5.reference}`}},variants$d={solid:variantSolid$3,subtle:variantSubtle$1,outline:variantOutline$2},badgeTheme={baseStyle:baseStyle$C,variants:variants$d,defaultProps:{variant:"subtle",colorScheme:"gray"}},{defineMultiStyleConfig:defineMultiStyleConfig$l,definePartsStyle:definePartsStyle$l}=createMultiStyleConfigHelpers(tagAnatomy.keys),baseStyleContainer$4={fontWeight:"medium",lineHeight:1.2,outline:0,borderRadius:"md",_focusVisible:{boxShadow:"outline"}},baseStyleLabel$3={lineHeight:1.2,overflow:"visible"},baseStyleCloseButton$3={fontSize:"lg",w:"5",h:"5",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"1.5",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focusVisible:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},baseStyle$B=definePartsStyle$l({container:baseStyleContainer$4,label:baseStyleLabel$3,closeButton:baseStyleCloseButton$3}),sizes$i={sm:definePartsStyle$l({container:{minH:"5",minW:"5",fontSize:"xs",px:"2"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}}),md:definePartsStyle$l({container:{minH:"6",minW:"6",fontSize:"sm",px:"2"}}),lg:definePartsStyle$l({container:{minH:"8",minW:"8",fontSize:"md",px:"3"}})},variants$c={subtle:definePartsStyle$l(_=>{var o;return{container:(o=badgeTheme.variants)==null?void 0:o.subtle(_)}}),solid:definePartsStyle$l(_=>{var o;return{container:(o=badgeTheme.variants)==null?void 0:o.solid(_)}}),outline:definePartsStyle$l(_=>{var o;return{container:(o=badgeTheme.variants)==null?void 0:o.outline(_)}})},tagTheme=defineMultiStyleConfig$l({variants:variants$c,baseStyle:baseStyle$B,sizes:sizes$i,defaultProps:{size:"md",variant:"subtle",colorScheme:"gray"}}),{definePartsStyle:definePartsStyle$k,defineMultiStyleConfig:defineMultiStyleConfig$k}=createMultiStyleConfigHelpers(inputAnatomy.keys),baseStyle$A=definePartsStyle$k({field:{width:"100%",minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed"}}}),size={lg:{fontSize:"lg",px:"4",h:"12",borderRadius:"md"},md:{fontSize:"md",px:"4",h:"10",borderRadius:"md"},sm:{fontSize:"sm",px:"3",h:"8",borderRadius:"sm"},xs:{fontSize:"xs",px:"2",h:"6",borderRadius:"sm"}},sizes$h={lg:definePartsStyle$k({field:size.lg,addon:size.lg}),md:definePartsStyle$k({field:size.md,addon:size.md}),sm:definePartsStyle$k({field:size.sm,addon:size.sm}),xs:definePartsStyle$k({field:size.xs,addon:size.xs})};function getDefaults(_){const{focusBorderColor:o,errorBorderColor:$}=_;return{focusBorderColor:o||mode("blue.500","blue.300")(_),errorBorderColor:$||mode("red.500","red.300")(_)}}var variantOutline$1=definePartsStyle$k(_=>{const{theme:o}=_,{focusBorderColor:$,errorBorderColor:j}=getDefaults(_);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:mode("gray.300","whiteAlpha.400")(_)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:getColor(o,j),boxShadow:`0 0 0 1px ${getColor(o,j)}`},_focusVisible:{zIndex:1,borderColor:getColor(o,$),boxShadow:`0 0 0 1px ${getColor(o,$)}`}},addon:{border:"1px solid",borderColor:mode("inherit","whiteAlpha.50")(_),bg:mode("gray.100","whiteAlpha.300")(_)}}}),variantFilled=definePartsStyle$k(_=>{const{theme:o}=_,{focusBorderColor:$,errorBorderColor:j}=getDefaults(_);return{field:{border:"2px solid",borderColor:"transparent",bg:mode("gray.100","whiteAlpha.50")(_),_hover:{bg:mode("gray.200","whiteAlpha.100")(_)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:getColor(o,j)},_focusVisible:{bg:"transparent",borderColor:getColor(o,$)}},addon:{border:"2px solid",borderColor:"transparent",bg:mode("gray.100","whiteAlpha.50")(_)}}}),variantFlushed=definePartsStyle$k(_=>{const{theme:o}=_,{focusBorderColor:$,errorBorderColor:j}=getDefaults(_);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:getColor(o,j),boxShadow:`0px 1px 0px 0px ${getColor(o,j)}`},_focusVisible:{borderColor:getColor(o,$),boxShadow:`0px 1px 0px 0px ${getColor(o,$)}`}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent"}}}),variantUnstyled$1=definePartsStyle$k({field:{bg:"transparent",px:"0",height:"auto"},addon:{bg:"transparent",px:"0",height:"auto"}}),variants$b={outline:variantOutline$1,filled:variantFilled,flushed:variantFlushed,unstyled:variantUnstyled$1},inputTheme=defineMultiStyleConfig$k({baseStyle:baseStyle$A,sizes:sizes$h,variants:variants$b,defaultProps:{size:"md",variant:"outline"}}),_a$8,baseStyle$z={...(_a$8=inputTheme.baseStyle)==null?void 0:_a$8.field,paddingY:"2",minHeight:"20",lineHeight:"short",verticalAlign:"top"},_a2$2,_b$2,variants$a={outline:_=>{var o,$;return($=(o=inputTheme.variants)==null?void 0:o.outline(_).field)!=null?$:{}},flushed:_=>{var o,$;return($=(o=inputTheme.variants)==null?void 0:o.flushed(_).field)!=null?$:{}},filled:_=>{var o,$;return($=(o=inputTheme.variants)==null?void 0:o.filled(_).field)!=null?$:{}},unstyled:(_b$2=(_a2$2=inputTheme.variants)==null?void 0:_a2$2.unstyled.field)!=null?_b$2:{}},_a3,_b2,_c$1,_d$1,_e$1,_f$1,_g$1,_h$1,sizes$g={xs:(_b2=(_a3=inputTheme.sizes)==null?void 0:_a3.xs.field)!=null?_b2:{},sm:(_d$1=(_c$1=inputTheme.sizes)==null?void 0:_c$1.sm.field)!=null?_d$1:{},md:(_f$1=(_e$1=inputTheme.sizes)==null?void 0:_e$1.md.field)!=null?_f$1:{},lg:(_h$1=(_g$1=inputTheme.sizes)==null?void 0:_g$1.lg.field)!=null?_h$1:{}},textareaTheme={baseStyle:baseStyle$z,sizes:sizes$g,variants:variants$a,defaultProps:{size:"md",variant:"outline"}},$bg$b=cssVar("tooltip-bg"),$fg$4=cssVar("tooltip-fg"),$arrowBg$1=cssVar("popper-arrow-bg"),baseStyle$y={bg:$bg$b.reference,color:$fg$4.reference,[$bg$b.variable]:"colors.gray.700",[$fg$4.variable]:"colors.whiteAlpha.900",_dark:{[$bg$b.variable]:"colors.gray.300",[$fg$4.variable]:"colors.gray.900"},[$arrowBg$1.variable]:$bg$b.reference,px:"2",py:"0.5",borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"xs",zIndex:"tooltip"},tooltipTheme={baseStyle:baseStyle$y},{defineMultiStyleConfig:defineMultiStyleConfig$j,definePartsStyle:definePartsStyle$j}=createMultiStyleConfigHelpers(progressAnatomy.keys),filledStyle=_=>{const{colorScheme:o,theme:$,isIndeterminate:j,hasStripe:et}=_,tt=mode(generateStripe(),generateStripe("1rem","rgba(0,0,0,0.1)"))(_),rt=mode(`${o}.500`,`${o}.200`)(_),nt=`linear-gradient(
    to right,
    transparent 0%,
    ${getColor($,rt)} 50%,
    transparent 100%
  )`;return{...!j&&et&&tt,...j?{bgImage:nt}:{bgColor:rt}}},baseStyleLabel$2={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"},baseStyleTrack$1=_=>({bg:mode("gray.100","whiteAlpha.300")(_)}),baseStyleFilledTrack$1=_=>({transitionProperty:"common",transitionDuration:"slow",...filledStyle(_)}),baseStyle$x=definePartsStyle$j(_=>({label:baseStyleLabel$2,filledTrack:baseStyleFilledTrack$1(_),track:baseStyleTrack$1(_)})),sizes$f={xs:definePartsStyle$j({track:{h:"1"}}),sm:definePartsStyle$j({track:{h:"2"}}),md:definePartsStyle$j({track:{h:"3"}}),lg:definePartsStyle$j({track:{h:"4"}})},progressTheme=defineMultiStyleConfig$j({sizes:sizes$f,baseStyle:baseStyle$x,defaultProps:{size:"md",colorScheme:"blue"}}),isFunction$3=_=>typeof _=="function";function runIfFn$1(_,...o){return isFunction$3(_)?_(...o):_}var{definePartsStyle:definePartsStyle$i,defineMultiStyleConfig:defineMultiStyleConfig$i}=createMultiStyleConfigHelpers(checkboxAnatomy.keys),$size$2=cssVar$1("checkbox-size"),baseStyleControl$1=_=>{const{colorScheme:o}=_;return{w:$size$2.reference,h:$size$2.reference,transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:mode(`${o}.500`,`${o}.200`)(_),borderColor:mode(`${o}.500`,`${o}.200`)(_),color:mode("white","gray.900")(_),_hover:{bg:mode(`${o}.600`,`${o}.300`)(_),borderColor:mode(`${o}.600`,`${o}.300`)(_)},_disabled:{borderColor:mode("gray.200","transparent")(_),bg:mode("gray.200","whiteAlpha.300")(_),color:mode("gray.500","whiteAlpha.500")(_)}},_indeterminate:{bg:mode(`${o}.500`,`${o}.200`)(_),borderColor:mode(`${o}.500`,`${o}.200`)(_),color:mode("white","gray.900")(_)},_disabled:{bg:mode("gray.100","whiteAlpha.100")(_),borderColor:mode("gray.100","transparent")(_)},_focusVisible:{boxShadow:"outline"},_invalid:{borderColor:mode("red.500","red.300")(_)}}},baseStyleContainer$3={_disabled:{cursor:"not-allowed"}},baseStyleLabel$1={userSelect:"none",_disabled:{opacity:.4}},baseStyleIcon$5={transitionProperty:"transform",transitionDuration:"normal"},baseStyle$w=definePartsStyle$i(_=>({icon:baseStyleIcon$5,container:baseStyleContainer$3,control:runIfFn$1(baseStyleControl$1,_),label:baseStyleLabel$1})),sizes$e={sm:definePartsStyle$i({control:{[$size$2.variable]:"sizes.3"},label:{fontSize:"sm"},icon:{fontSize:"3xs"}}),md:definePartsStyle$i({control:{[$size$2.variable]:"sizes.4"},label:{fontSize:"md"},icon:{fontSize:"2xs"}}),lg:definePartsStyle$i({control:{[$size$2.variable]:"sizes.5"},label:{fontSize:"lg"},icon:{fontSize:"2xs"}})},checkboxTheme=defineMultiStyleConfig$i({baseStyle:baseStyle$w,sizes:sizes$e,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:defineMultiStyleConfig$h,definePartsStyle:definePartsStyle$h}=createMultiStyleConfigHelpers(radioAnatomy.keys),baseStyleControl=_=>{var o;const $=(o=runIfFn$1(checkboxTheme.baseStyle,_))==null?void 0:o.control;return{...$,borderRadius:"full",_checked:{...$==null?void 0:$._checked,_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}}}},baseStyle$v=definePartsStyle$h(_=>{var o,$,j,et;return{label:($=(o=checkboxTheme).baseStyle)==null?void 0:$.call(o,_).label,container:(et=(j=checkboxTheme).baseStyle)==null?void 0:et.call(j,_).container,control:baseStyleControl(_)}}),sizes$d={md:definePartsStyle$h({control:{w:"4",h:"4"},label:{fontSize:"md"}}),lg:definePartsStyle$h({control:{w:"5",h:"5"},label:{fontSize:"lg"}}),sm:definePartsStyle$h({control:{width:"3",height:"3"},label:{fontSize:"sm"}})},radioTheme=defineMultiStyleConfig$h({baseStyle:baseStyle$v,sizes:sizes$d,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:defineMultiStyleConfig$g,definePartsStyle:definePartsStyle$g}=createMultiStyleConfigHelpers(selectAnatomy.keys),$bg$a=cssVar$1("select-bg"),_a$7,baseStyleField$1={...(_a$7=inputTheme.baseStyle)==null?void 0:_a$7.field,appearance:"none",paddingBottom:"1px",lineHeight:"normal",bg:$bg$a.reference,[$bg$a.variable]:"colors.white",_dark:{[$bg$a.variable]:"colors.gray.700"},"> option, > optgroup":{bg:$bg$a.reference}},baseStyleIcon$4={width:"6",height:"100%",insetEnd:"2",position:"relative",color:"currentColor",fontSize:"xl",_disabled:{opacity:.5}},baseStyle$u=definePartsStyle$g({field:baseStyleField$1,icon:baseStyleIcon$4}),iconSpacing={paddingInlineEnd:"8"},_a2$1,_b$1,_c,_d,_e,_f,_g,_h,sizes$c={lg:{...(_a2$1=inputTheme.sizes)==null?void 0:_a2$1.lg,field:{...(_b$1=inputTheme.sizes)==null?void 0:_b$1.lg.field,...iconSpacing}},md:{...(_c=inputTheme.sizes)==null?void 0:_c.md,field:{...(_d=inputTheme.sizes)==null?void 0:_d.md.field,...iconSpacing}},sm:{...(_e=inputTheme.sizes)==null?void 0:_e.sm,field:{...(_f=inputTheme.sizes)==null?void 0:_f.sm.field,...iconSpacing}},xs:{...(_g=inputTheme.sizes)==null?void 0:_g.xs,field:{...(_h=inputTheme.sizes)==null?void 0:_h.xs.field,...iconSpacing},icon:{insetEnd:"1"}}},selectTheme=defineMultiStyleConfig$g({baseStyle:baseStyle$u,sizes:sizes$c,variants:inputTheme.variants,defaultProps:inputTheme.defaultProps}),$startColor=cssVar$1("skeleton-start-color"),$endColor=cssVar$1("skeleton-end-color"),baseStyle$t={[$startColor.variable]:"colors.gray.100",[$endColor.variable]:"colors.gray.400",_dark:{[$startColor.variable]:"colors.gray.800",[$endColor.variable]:"colors.gray.600"},background:$startColor.reference,borderColor:$endColor.reference,opacity:.7,borderRadius:"sm"},skeletonTheme={baseStyle:baseStyle$t},$bg$9=cssVar$1("skip-link-bg"),baseStyle$s={borderRadius:"md",fontWeight:"semibold",_focusVisible:{boxShadow:"outline",padding:"4",position:"fixed",top:"6",insetStart:"6",[$bg$9.variable]:"colors.white",_dark:{[$bg$9.variable]:"colors.gray.700"},bg:$bg$9.reference}},skipLinkTheme={baseStyle:baseStyle$s},{defineMultiStyleConfig:defineMultiStyleConfig$f,definePartsStyle:definePartsStyle$f}=createMultiStyleConfigHelpers(sliderAnatomy.keys),$thumbSize=cssVar$1("slider-thumb-size"),$trackSize=cssVar$1("slider-track-size"),$bg$8=cssVar$1("slider-bg"),baseStyleContainer$2=_=>{const{orientation:o}=_;return{display:"inline-block",position:"relative",cursor:"pointer",_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"},...orient({orientation:o,vertical:{h:"100%"},horizontal:{w:"100%"}})}},baseStyleTrack=_=>({...orient({orientation:_.orientation,horizontal:{h:$trackSize.reference},vertical:{w:$trackSize.reference}}),overflow:"hidden",borderRadius:"sm",[$bg$8.variable]:"colors.gray.200",_dark:{[$bg$8.variable]:"colors.whiteAlpha.200"},_disabled:{[$bg$8.variable]:"colors.gray.300",_dark:{[$bg$8.variable]:"colors.whiteAlpha.300"}},bg:$bg$8.reference}),baseStyleThumb=_=>{const{orientation:o}=_;return{...orient({orientation:o,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}}),w:$thumbSize.reference,h:$thumbSize.reference,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",outline:0,zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{bg:"gray.300"}}},baseStyleFilledTrack=_=>{const{colorScheme:o}=_;return{width:"inherit",height:"inherit",[$bg$8.variable]:`colors.${o}.500`,_dark:{[$bg$8.variable]:`colors.${o}.200`},bg:$bg$8.reference}},baseStyle$r=definePartsStyle$f(_=>({container:baseStyleContainer$2(_),track:baseStyleTrack(_),thumb:baseStyleThumb(_),filledTrack:baseStyleFilledTrack(_)})),sizeLg=definePartsStyle$f({container:{[$thumbSize.variable]:"sizes.4",[$trackSize.variable]:"sizes.1"}}),sizeMd=definePartsStyle$f({container:{[$thumbSize.variable]:"sizes.3.5",[$trackSize.variable]:"sizes.1"}}),sizeSm=definePartsStyle$f({container:{[$thumbSize.variable]:"sizes.2.5",[$trackSize.variable]:"sizes.0.5"}}),sizes$b={lg:sizeLg,md:sizeMd,sm:sizeSm},sliderTheme=defineMultiStyleConfig$f({baseStyle:baseStyle$r,sizes:sizes$b,defaultProps:{size:"md",colorScheme:"blue"}}),$size$1=cssVar("spinner-size"),baseStyle$q={width:[$size$1.reference],height:[$size$1.reference]},sizes$a={xs:{[$size$1.variable]:"sizes.3"},sm:{[$size$1.variable]:"sizes.4"},md:{[$size$1.variable]:"sizes.6"},lg:{[$size$1.variable]:"sizes.8"},xl:{[$size$1.variable]:"sizes.12"}},spinnerTheme={baseStyle:baseStyle$q,sizes:sizes$a,defaultProps:{size:"md"}},{defineMultiStyleConfig:defineMultiStyleConfig$e,definePartsStyle:definePartsStyle$e}=createMultiStyleConfigHelpers(statAnatomy.keys),baseStyleLabel={fontWeight:"medium"},baseStyleHelpText={opacity:.8,marginBottom:"2"},baseStyleNumber={verticalAlign:"baseline",fontWeight:"semibold"},baseStyleIcon$3={marginEnd:1,w:"3.5",h:"3.5",verticalAlign:"middle"},baseStyle$p=definePartsStyle$e({container:{},label:baseStyleLabel,helpText:baseStyleHelpText,number:baseStyleNumber,icon:baseStyleIcon$3}),sizes$9={md:definePartsStyle$e({label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}})},statTheme=defineMultiStyleConfig$e({baseStyle:baseStyle$p,sizes:sizes$9,defaultProps:{size:"md"}}),$bg$7=cssVar$1("kbd-bg"),baseStyle$o={[$bg$7.variable]:"colors.gray.100",_dark:{[$bg$7.variable]:"colors.whiteAlpha.100"},bg:$bg$7.reference,borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"},kbdTheme={baseStyle:baseStyle$o},baseStyle$n={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}},linkTheme={baseStyle:baseStyle$n},{defineMultiStyleConfig:defineMultiStyleConfig$d,definePartsStyle:definePartsStyle$d}=createMultiStyleConfigHelpers(listAnatomy.keys),baseStyleIcon$2={marginEnd:"2",display:"inline",verticalAlign:"text-bottom"},baseStyle$m=definePartsStyle$d({icon:baseStyleIcon$2}),listTheme=defineMultiStyleConfig$d({baseStyle:baseStyle$m}),{defineMultiStyleConfig:defineMultiStyleConfig$c,definePartsStyle:definePartsStyle$c}=createMultiStyleConfigHelpers(menuAnatomy.keys),$bg$6=cssVar$1("menu-bg"),$shadow$1=cssVar$1("menu-shadow"),baseStyleList={[$bg$6.variable]:"#fff",[$shadow$1.variable]:"shadows.sm",_dark:{[$bg$6.variable]:"colors.gray.700",[$shadow$1.variable]:"shadows.dark-lg"},color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px",bg:$bg$6.reference,boxShadow:$shadow$1.reference},baseStyleItem={py:"1.5",px:"3",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{[$bg$6.variable]:"colors.gray.100",_dark:{[$bg$6.variable]:"colors.whiteAlpha.100"}},_active:{[$bg$6.variable]:"colors.gray.200",_dark:{[$bg$6.variable]:"colors.whiteAlpha.200"}},_expanded:{[$bg$6.variable]:"colors.gray.100",_dark:{[$bg$6.variable]:"colors.whiteAlpha.100"}},_disabled:{opacity:.4,cursor:"not-allowed"},bg:$bg$6.reference},baseStyleGroupTitle={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},baseStyleCommand={opacity:.6},baseStyleDivider={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"2",opacity:.6},baseStyleButton$1={transitionProperty:"common",transitionDuration:"normal"},baseStyle$l=definePartsStyle$c({button:baseStyleButton$1,list:baseStyleList,item:baseStyleItem,groupTitle:baseStyleGroupTitle,command:baseStyleCommand,divider:baseStyleDivider}),menuTheme=defineMultiStyleConfig$c({baseStyle:baseStyle$l}),{defineMultiStyleConfig:defineMultiStyleConfig$b,definePartsStyle:definePartsStyle$b}=createMultiStyleConfigHelpers(modalAnatomy.keys),baseStyleOverlay$1={bg:"blackAlpha.600",zIndex:"modal"},baseStyleDialogContainer$1=_=>{const{isCentered:o,scrollBehavior:$}=_;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:o?"center":"flex-start",overflow:$==="inside"?"hidden":"auto",overscrollBehaviorY:"none"}},baseStyleDialog$1=_=>{const{scrollBehavior:o}=_;return{borderRadius:"md",bg:mode("white","gray.700")(_),color:"inherit",my:"16",zIndex:"modal",maxH:o==="inside"?"calc(100% - 7.5rem)":void 0,boxShadow:mode("lg","dark-lg")(_)}},baseStyleHeader$2={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},baseStyleCloseButton$2={position:"absolute",top:"2",insetEnd:"3"},baseStyleBody$2=_=>{const{scrollBehavior:o}=_;return{px:"6",py:"2",flex:"1",overflow:o==="inside"?"auto":void 0}},baseStyleFooter$2={px:"6",py:"4"},baseStyle$k=definePartsStyle$b(_=>({overlay:baseStyleOverlay$1,dialogContainer:runIfFn$1(baseStyleDialogContainer$1,_),dialog:runIfFn$1(baseStyleDialog$1,_),header:baseStyleHeader$2,closeButton:baseStyleCloseButton$2,body:runIfFn$1(baseStyleBody$2,_),footer:baseStyleFooter$2}));function getSize$4(_){return definePartsStyle$b(_==="full"?{dialog:{maxW:"100vw",minH:"$100vh",my:"0",borderRadius:"0"}}:{dialog:{maxW:_}})}var sizes$8={xs:getSize$4("xs"),sm:getSize$4("sm"),md:getSize$4("md"),lg:getSize$4("lg"),xl:getSize$4("xl"),"2xl":getSize$4("2xl"),"3xl":getSize$4("3xl"),"4xl":getSize$4("4xl"),"5xl":getSize$4("5xl"),"6xl":getSize$4("6xl"),full:getSize$4("full")},modalTheme=defineMultiStyleConfig$b({baseStyle:baseStyle$k,sizes:sizes$8,defaultProps:{size:"md"}}),{defineMultiStyleConfig:defineMultiStyleConfig$a,definePartsStyle:definePartsStyle$a}=createMultiStyleConfigHelpers(numberInputAnatomy.keys),$stepperWidth=cssVar("number-input-stepper-width"),$inputPadding=cssVar("number-input-input-padding"),inputPaddingValue=calc($stepperWidth).add("0.5rem").toString(),$bg$5=cssVar("number-input-bg"),$fg$3=cssVar("number-input-color"),$border$2=cssVar("number-input-border-color"),baseStyleRoot={[$stepperWidth.variable]:"sizes.6",[$inputPadding.variable]:inputPaddingValue},baseStyleField=_=>{var o,$;return($=(o=runIfFn$1(inputTheme.baseStyle,_))==null?void 0:o.field)!=null?$:{}},baseStyleStepperGroup={width:$stepperWidth.reference},baseStyleStepper={borderStart:"1px solid",borderStartColor:$border$2.reference,color:$fg$3.reference,bg:$bg$5.reference,[$fg$3.variable]:"colors.chakra-body-text",[$border$2.variable]:"colors.chakra-border-color",_dark:{[$fg$3.variable]:"colors.whiteAlpha.800",[$border$2.variable]:"colors.whiteAlpha.300"},_active:{[$bg$5.variable]:"colors.gray.200",_dark:{[$bg$5.variable]:"colors.whiteAlpha.300"}},_disabled:{opacity:.4,cursor:"not-allowed"}},baseStyle$j=definePartsStyle$a(_=>{var o;return{root:baseStyleRoot,field:(o=runIfFn$1(baseStyleField,_))!=null?o:{},stepperGroup:baseStyleStepperGroup,stepper:baseStyleStepper}});function getSize$3(_){var o,$,j;const et=(o=inputTheme.sizes)==null?void 0:o[_],tt={lg:"md",md:"md",sm:"sm",xs:"sm"},rt=(j=($=et.field)==null?void 0:$.fontSize)!=null?j:"md",nt=typography_default.fontSizes[rt];return definePartsStyle$a({field:{...et.field,paddingInlineEnd:$inputPadding.reference,verticalAlign:"top"},stepper:{fontSize:calc(nt).multiply(.75).toString(),_first:{borderTopEndRadius:tt[_]},_last:{borderBottomEndRadius:tt[_],mt:"-1px",borderTopWidth:1}}})}var sizes$7={xs:getSize$3("xs"),sm:getSize$3("sm"),md:getSize$3("md"),lg:getSize$3("lg")},numberInputTheme=defineMultiStyleConfig$a({baseStyle:baseStyle$j,sizes:sizes$7,variants:inputTheme.variants,defaultProps:inputTheme.defaultProps}),_a$6,baseStyle$i={...(_a$6=inputTheme.baseStyle)==null?void 0:_a$6.field,textAlign:"center"},sizes$6={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},_a2,_b,variants$9={outline:_=>{var o,$,j;return(j=($=runIfFn$1((o=inputTheme.variants)==null?void 0:o.outline,_))==null?void 0:$.field)!=null?j:{}},flushed:_=>{var o,$,j;return(j=($=runIfFn$1((o=inputTheme.variants)==null?void 0:o.flushed,_))==null?void 0:$.field)!=null?j:{}},filled:_=>{var o,$,j;return(j=($=runIfFn$1((o=inputTheme.variants)==null?void 0:o.filled,_))==null?void 0:$.field)!=null?j:{}},unstyled:(_b=(_a2=inputTheme.variants)==null?void 0:_a2.unstyled.field)!=null?_b:{}},pinInputTheme={baseStyle:baseStyle$i,sizes:sizes$6,variants:variants$9,defaultProps:inputTheme.defaultProps},{defineMultiStyleConfig:defineMultiStyleConfig$9,definePartsStyle:definePartsStyle$9}=createMultiStyleConfigHelpers(popoverAnatomy.keys),$popperBg=cssVar("popper-bg"),$arrowBg=cssVar("popper-arrow-bg"),$arrowShadowColor=cssVar("popper-arrow-shadow-color"),baseStylePopper={zIndex:10},baseStyleContent={[$popperBg.variable]:"colors.white",bg:$popperBg.reference,[$arrowBg.variable]:$popperBg.reference,[$arrowShadowColor.variable]:"colors.gray.200",_dark:{[$popperBg.variable]:"colors.gray.700",[$arrowShadowColor.variable]:"colors.whiteAlpha.300"},width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focusVisible:{outline:0,boxShadow:"outline"}},baseStyleHeader$1={px:3,py:2,borderBottomWidth:"1px"},baseStyleBody$1={px:3,py:2},baseStyleFooter$1={px:3,py:2,borderTopWidth:"1px"},baseStyleCloseButton$1={position:"absolute",borderRadius:"md",top:1,insetEnd:2,padding:2},baseStyle$h=definePartsStyle$9({popper:baseStylePopper,content:baseStyleContent,header:baseStyleHeader$1,body:baseStyleBody$1,footer:baseStyleFooter$1,closeButton:baseStyleCloseButton$1}),popoverTheme=defineMultiStyleConfig$9({baseStyle:baseStyle$h}),{definePartsStyle:definePartsStyle$8,defineMultiStyleConfig:defineMultiStyleConfig$8}=createMultiStyleConfigHelpers(drawerAnatomy.keys),$bg$4=cssVar$1("drawer-bg"),$bs=cssVar$1("drawer-box-shadow");function getSize$2(_){return definePartsStyle$8(_==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:_}})}var baseStyleOverlay={bg:"blackAlpha.600",zIndex:"overlay"},baseStyleDialogContainer={display:"flex",zIndex:"modal",justifyContent:"center"},baseStyleDialog=_=>{const{isFullHeight:o}=_;return{...o&&{height:"100vh"},zIndex:"modal",maxH:"100vh",color:"inherit",[$bg$4.variable]:"colors.white",[$bs.variable]:"shadows.lg",_dark:{[$bg$4.variable]:"colors.gray.700",[$bs.variable]:"shadows.dark-lg"},bg:$bg$4.reference,boxShadow:$bs.reference}},baseStyleHeader={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},baseStyleCloseButton={position:"absolute",top:"2",insetEnd:"3"},baseStyleBody={px:"6",py:"2",flex:"1",overflow:"auto"},baseStyleFooter={px:"6",py:"4"},baseStyle$g=definePartsStyle$8(_=>({overlay:baseStyleOverlay,dialogContainer:baseStyleDialogContainer,dialog:runIfFn$1(baseStyleDialog,_),header:baseStyleHeader,closeButton:baseStyleCloseButton,body:baseStyleBody,footer:baseStyleFooter})),sizes$5={xs:getSize$2("xs"),sm:getSize$2("md"),md:getSize$2("lg"),lg:getSize$2("2xl"),xl:getSize$2("4xl"),full:getSize$2("full")},drawerTheme=defineMultiStyleConfig$8({baseStyle:baseStyle$g,sizes:sizes$5,defaultProps:{size:"xs"}}),{definePartsStyle:definePartsStyle$7,defineMultiStyleConfig:defineMultiStyleConfig$7}=createMultiStyleConfigHelpers(editableAnatomy.keys),baseStylePreview={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal"},baseStyleInput={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},baseStyleTextarea={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},baseStyle$f=definePartsStyle$7({preview:baseStylePreview,input:baseStyleInput,textarea:baseStyleTextarea}),editableTheme=defineMultiStyleConfig$7({baseStyle:baseStyle$f}),{definePartsStyle:definePartsStyle$6,defineMultiStyleConfig:defineMultiStyleConfig$6}=createMultiStyleConfigHelpers(formAnatomy.keys),$fg$2=cssVar$1("form-control-color"),baseStyleRequiredIndicator={marginStart:"1",[$fg$2.variable]:"colors.red.500",_dark:{[$fg$2.variable]:"colors.red.300"},color:$fg$2.reference},baseStyleHelperText={mt:"2",[$fg$2.variable]:"colors.gray.600",_dark:{[$fg$2.variable]:"colors.whiteAlpha.600"},color:$fg$2.reference,lineHeight:"normal",fontSize:"sm"},baseStyle$e=definePartsStyle$6({container:{width:"100%",position:"relative"},requiredIndicator:baseStyleRequiredIndicator,helperText:baseStyleHelperText}),formTheme=defineMultiStyleConfig$6({baseStyle:baseStyle$e}),{definePartsStyle:definePartsStyle$5,defineMultiStyleConfig:defineMultiStyleConfig$5}=createMultiStyleConfigHelpers(formErrorAnatomy.keys),$fg$1=cssVar$1("form-error-color"),baseStyleText={[$fg$1.variable]:"colors.red.500",_dark:{[$fg$1.variable]:"colors.red.300"},color:$fg$1.reference,mt:"2",fontSize:"sm",lineHeight:"normal"},baseStyleIcon$1={marginEnd:"0.5em",[$fg$1.variable]:"colors.red.500",_dark:{[$fg$1.variable]:"colors.red.300"},color:$fg$1.reference},baseStyle$d=definePartsStyle$5({text:baseStyleText,icon:baseStyleIcon$1}),formErrorTheme=defineMultiStyleConfig$5({baseStyle:baseStyle$d}),baseStyle$c={fontSize:"md",marginEnd:"3",mb:"2",fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},formLabelTheme={baseStyle:baseStyle$c},baseStyle$b={fontFamily:"heading",fontWeight:"bold"},sizes$4={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},headingTheme={baseStyle:baseStyle$b,sizes:sizes$4,defaultProps:{size:"xl"}},{defineMultiStyleConfig:defineMultiStyleConfig$4,definePartsStyle:definePartsStyle$4}=createMultiStyleConfigHelpers(breadcrumbAnatomy.keys),baseStyleLink={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}},baseStyle$a=definePartsStyle$4({link:baseStyleLink}),breadcrumbTheme=defineMultiStyleConfig$4({baseStyle:baseStyle$a}),baseStyle$9={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}},variantGhost=_=>{const{colorScheme:o,theme:$}=_;if(o==="gray")return{color:mode("inherit","whiteAlpha.900")(_),_hover:{bg:mode("gray.100","whiteAlpha.200")(_)},_active:{bg:mode("gray.200","whiteAlpha.300")(_)}};const j=transparentize(`${o}.200`,.12)($),et=transparentize(`${o}.200`,.24)($);return{color:mode(`${o}.600`,`${o}.200`)(_),bg:"transparent",_hover:{bg:mode(`${o}.50`,j)(_)},_active:{bg:mode(`${o}.100`,et)(_)}}},variantOutline=_=>{const{colorScheme:o}=_,$=mode("gray.200","whiteAlpha.300")(_);return{border:"1px solid",borderColor:o==="gray"?$:"currentColor",".chakra-button__group[data-attached][data-orientation=horizontal] > &:not(:last-of-type)":{marginEnd:"-1px"},".chakra-button__group[data-attached][data-orientation=vertical] > &:not(:last-of-type)":{marginBottom:"-1px"},...runIfFn$1(variantGhost,_)}},accessibleColorMap={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}},variantSolid$2=_=>{var o;const{colorScheme:$}=_;if($==="gray"){const it=mode("gray.100","whiteAlpha.200")(_);return{bg:it,_hover:{bg:mode("gray.200","whiteAlpha.300")(_),_disabled:{bg:it}},_active:{bg:mode("gray.300","whiteAlpha.400")(_)}}}const{bg:j=`${$}.500`,color:et="white",hoverBg:tt=`${$}.600`,activeBg:rt=`${$}.700`}=(o=accessibleColorMap[$])!=null?o:{},nt=mode(j,`${$}.200`)(_);return{bg:nt,color:mode(et,"gray.800")(_),_hover:{bg:mode(tt,`${$}.300`)(_),_disabled:{bg:nt}},_active:{bg:mode(rt,`${$}.400`)(_)}}},variantLink=_=>{const{colorScheme:o}=_;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:mode(`${o}.500`,`${o}.200`)(_),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:mode(`${o}.700`,`${o}.500`)(_)}}},variantUnstyled={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:"0",p:"0"},variants$8={ghost:variantGhost,outline:variantOutline,solid:variantSolid$2,link:variantLink,unstyled:variantUnstyled},sizes$3={lg:{h:"12",minW:"12",fontSize:"lg",px:"6"},md:{h:"10",minW:"10",fontSize:"md",px:"4"},sm:{h:"8",minW:"8",fontSize:"sm",px:"3"},xs:{h:"6",minW:"6",fontSize:"xs",px:"2"}},buttonTheme={baseStyle:baseStyle$9,variants:variants$8,sizes:sizes$3,defaultProps:{variant:"solid",size:"md",colorScheme:"gray"}},{definePartsStyle:definePartsStyle$3,defineMultiStyleConfig:defineMultiStyleConfig$3}=createMultiStyleConfigHelpers(cardAnatomy.keys),$bg$3=cssVar$1("card-bg"),$padding=cssVar$1("card-padding"),$shadow=cssVar$1("card-shadow"),$radius=cssVar$1("card-radius"),$border$1=cssVar$1("card-border-width","0"),$borderColor=cssVar$1("card-border-color"),baseStyle$8=definePartsStyle$3({container:{[$bg$3.variable]:"colors.chakra-body-bg",backgroundColor:$bg$3.reference,boxShadow:$shadow.reference,borderRadius:$radius.reference,color:"chakra-body-text",borderWidth:$border$1.reference,borderColor:$borderColor.reference},body:{padding:$padding.reference,flex:"1 1 0%"},header:{padding:$padding.reference},footer:{padding:$padding.reference}}),sizes$2={sm:definePartsStyle$3({container:{[$radius.variable]:"radii.base",[$padding.variable]:"space.3"}}),md:definePartsStyle$3({container:{[$radius.variable]:"radii.md",[$padding.variable]:"space.5"}}),lg:definePartsStyle$3({container:{[$radius.variable]:"radii.xl",[$padding.variable]:"space.7"}})},variants$7={elevated:definePartsStyle$3({container:{[$shadow.variable]:"shadows.base",_dark:{[$bg$3.variable]:"colors.gray.700"}}}),outline:definePartsStyle$3({container:{[$border$1.variable]:"1px",[$borderColor.variable]:"colors.chakra-border-color"}}),filled:definePartsStyle$3({container:{[$bg$3.variable]:"colors.chakra-subtle-bg"}}),unstyled:{body:{[$padding.variable]:0},header:{[$padding.variable]:0},footer:{[$padding.variable]:0}}},cardTheme=defineMultiStyleConfig$3({baseStyle:baseStyle$8,variants:variants$7,sizes:sizes$2,defaultProps:{variant:"elevated",size:"md"}}),$size=cssVar("close-button-size"),$bg$2=cssVar("close-button-bg"),baseStyle$7={w:[$size.reference],h:[$size.reference],borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{[$bg$2.variable]:"colors.blackAlpha.100",_dark:{[$bg$2.variable]:"colors.whiteAlpha.100"}},_active:{[$bg$2.variable]:"colors.blackAlpha.200",_dark:{[$bg$2.variable]:"colors.whiteAlpha.200"}},_focusVisible:{boxShadow:"outline"},bg:$bg$2.reference},sizes$1={lg:{[$size.variable]:"sizes.10",fontSize:"md"},md:{[$size.variable]:"sizes.8",fontSize:"xs"},sm:{[$size.variable]:"sizes.6",fontSize:"2xs"}},closeButtonTheme={baseStyle:baseStyle$7,sizes:sizes$1,defaultProps:{size:"md"}},{variants:variants$6,defaultProps}=badgeTheme,baseStyle$6={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm"},codeTheme={baseStyle:baseStyle$6,variants:variants$6,defaultProps},baseStyle$5={w:"100%",mx:"auto",maxW:"prose",px:"4"},containerTheme={baseStyle:baseStyle$5},baseStyle$4={opacity:.6,borderColor:"inherit"},variantSolid$1={borderStyle:"solid"},variantDashed={borderStyle:"dashed"},variants$5={solid:variantSolid$1,dashed:variantDashed},dividerTheme={baseStyle:baseStyle$4,variants:variants$5,defaultProps:{variant:"solid"}},{definePartsStyle:definePartsStyle$2,defineMultiStyleConfig:defineMultiStyleConfig$2}=createMultiStyleConfigHelpers(accordionAnatomy.keys),baseStyleContainer$1={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},baseStyleButton={transitionProperty:"common",transitionDuration:"normal",fontSize:"md",_focusVisible:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:"4",py:"2"},baseStylePanel={pt:"2",px:"4",pb:"5"},baseStyleIcon={fontSize:"1.25em"},baseStyle$3=definePartsStyle$2({container:baseStyleContainer$1,button:baseStyleButton,panel:baseStylePanel,icon:baseStyleIcon}),accordionTheme=defineMultiStyleConfig$2({baseStyle:baseStyle$3}),{definePartsStyle:definePartsStyle$1,defineMultiStyleConfig:defineMultiStyleConfig$1}=createMultiStyleConfigHelpers(alertAnatomy.keys),$fg=cssVar$1("alert-fg"),$bg$1=cssVar$1("alert-bg"),baseStyle$2=definePartsStyle$1({container:{bg:$bg$1.reference,px:"4",py:"3"},title:{fontWeight:"bold",lineHeight:"6",marginEnd:"2"},description:{lineHeight:"6"},icon:{color:$fg.reference,flexShrink:0,marginEnd:"3",w:"5",h:"6"},spinner:{color:$fg.reference,flexShrink:0,marginEnd:"3",w:"5",h:"5"}});function getBg(_){const{theme:o,colorScheme:$}=_,j=transparentize(`${$}.200`,.16)(o);return{light:`colors.${$}.100`,dark:j}}var variantSubtle=definePartsStyle$1(_=>{const{colorScheme:o}=_,$=getBg(_);return{container:{[$fg.variable]:`colors.${o}.500`,[$bg$1.variable]:$.light,_dark:{[$fg.variable]:`colors.${o}.200`,[$bg$1.variable]:$.dark}}}}),variantLeftAccent=definePartsStyle$1(_=>{const{colorScheme:o}=_,$=getBg(_);return{container:{[$fg.variable]:`colors.${o}.500`,[$bg$1.variable]:$.light,_dark:{[$fg.variable]:`colors.${o}.200`,[$bg$1.variable]:$.dark},paddingStart:"3",borderStartWidth:"4px",borderStartColor:$fg.reference}}}),variantTopAccent=definePartsStyle$1(_=>{const{colorScheme:o}=_,$=getBg(_);return{container:{[$fg.variable]:`colors.${o}.500`,[$bg$1.variable]:$.light,_dark:{[$fg.variable]:`colors.${o}.200`,[$bg$1.variable]:$.dark},pt:"2",borderTopWidth:"4px",borderTopColor:$fg.reference}}}),variantSolid=definePartsStyle$1(_=>{const{colorScheme:o}=_;return{container:{[$fg.variable]:"colors.white",[$bg$1.variable]:`colors.${o}.500`,_dark:{[$fg.variable]:"colors.gray.900",[$bg$1.variable]:`colors.${o}.200`},color:$fg.reference}}}),variants$4={subtle:variantSubtle,"left-accent":variantLeftAccent,"top-accent":variantTopAccent,solid:variantSolid},alertTheme=defineMultiStyleConfig$1({baseStyle:baseStyle$2,variants:variants$4,defaultProps:{variant:"subtle",colorScheme:"blue"}}),{definePartsStyle,defineMultiStyleConfig}=createMultiStyleConfigHelpers(avatarAnatomy.keys),$border=cssVar$1("avatar-border-color"),$bg=cssVar$1("avatar-bg"),baseStyleBadge={borderRadius:"full",border:"0.2em solid",[$border.variable]:"white",_dark:{[$border.variable]:"colors.gray.800"},borderColor:$border.reference},baseStyleExcessLabel={[$bg.variable]:"colors.gray.200",_dark:{[$bg.variable]:"colors.whiteAlpha.400"},bgColor:$bg.reference},$avatarBg=cssVar$1("avatar-background"),baseStyleContainer=_=>{const{name:o,theme:$}=_,j=o?randomColor({string:o}):"colors.gray.400",et=isDark(j)($);let tt="white";return et||(tt="gray.800"),{bg:$avatarBg.reference,"&:not([data-loaded])":{[$avatarBg.variable]:j},color:tt,[$border.variable]:"colors.white",_dark:{[$border.variable]:"colors.gray.800"},borderColor:$border.reference,verticalAlign:"top"}},baseStyle$1=definePartsStyle(_=>({badge:runIfFn$1(baseStyleBadge,_),excessLabel:runIfFn$1(baseStyleExcessLabel,_),container:runIfFn$1(baseStyleContainer,_)}));function getSize$1(_){const o=_!=="100%"?sizes_default[_]:void 0;return definePartsStyle({container:{width:_,height:_,fontSize:`calc(${o??_} / 2.5)`},excessLabel:{width:_,height:_},label:{fontSize:`calc(${o??_} / 2.5)`,lineHeight:_!=="100%"?o??_:void 0}})}var sizes={"2xs":getSize$1(4),xs:getSize$1(6),sm:getSize$1(8),md:getSize$1(12),lg:getSize$1(16),xl:getSize$1(24),"2xl":getSize$1(32),full:getSize$1("100%")},avatarTheme=defineMultiStyleConfig({baseStyle:baseStyle$1,sizes,defaultProps:{size:"md"}}),components={Accordion:accordionTheme,Alert:alertTheme,Avatar:avatarTheme,Badge:badgeTheme,Breadcrumb:breadcrumbTheme,Button:buttonTheme,Checkbox:checkboxTheme,CloseButton:closeButtonTheme,Code:codeTheme,Container:containerTheme,Divider:dividerTheme,Drawer:drawerTheme,Editable:editableTheme,Form:formTheme,FormError:formErrorTheme,FormLabel:formLabelTheme,Heading:headingTheme,Input:inputTheme,Kbd:kbdTheme,Link:linkTheme,List:listTheme,Menu:menuTheme,Modal:modalTheme,NumberInput:numberInputTheme,PinInput:pinInputTheme,Popover:popoverTheme,Progress:progressTheme,Radio:radioTheme,Select:selectTheme,Skeleton:skeletonTheme,SkipLink:skipLinkTheme,Slider:sliderTheme,Spinner:spinnerTheme,Stat:statTheme,Switch:switchTheme,Table:tableTheme,Tabs:tabsTheme,Tag:tagTheme,Textarea:textareaTheme,Tooltip:tooltipTheme,Card:cardTheme},semanticTokens={colors:{"chakra-body-text":{_light:"gray.800",_dark:"whiteAlpha.900"},"chakra-body-bg":{_light:"white",_dark:"gray.800"},"chakra-border-color":{_light:"gray.200",_dark:"whiteAlpha.300"},"chakra-subtle-bg":{_light:"gray.100",_dark:"gray.700"},"chakra-placeholder-color":{_light:"gray.500",_dark:"whiteAlpha.400"}}},styles={global:{body:{fontFamily:"body",color:"chakra-body-text",bg:"chakra-body-bg",transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:"chakra-placeholder-color"},"*, *::before, &::after":{borderColor:"chakra-border-color",wordWrap:"break-word"}}},direction="ltr",config$2={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},theme$1={semanticTokens,direction,...foundations,components,styles,config:config$2};function isFunction$2(_){return typeof _=="function"}function pipe$2(..._){return o=>_.reduce(($,j)=>j($),o)}var createExtendTheme=_=>function(...$){let j=[...$],et=$[$.length-1];return isChakraTheme(et)&&j.length>1?j=j.slice(0,j.length-1):et=_,pipe$2(...j.map(tt=>rt=>isFunction$2(tt)?tt(rt):mergeThemeOverride(rt,tt)))(et)},extendTheme=createExtendTheme(theme$1);function mergeThemeOverride(..._){return mergeWith({},..._,mergeThemeCustomizer)}function mergeThemeCustomizer(_,o,$,j){if((isFunction$2(_)||isFunction$2(o))&&Object.prototype.hasOwnProperty.call(j,$))return(...et)=>{const tt=isFunction$2(_)?_(...et):_,rt=isFunction$2(o)?o(...et):o;return mergeWith({},tt,rt,mergeThemeCustomizer)}}function canUseDOM(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var isBrowser$4=canUseDOM();function omit(_,o){const $={};return Object.keys(_).forEach(j=>{o.includes(j)||($[j]=_[j])}),$}function get$5(_,o,$,j){const et=typeof o=="string"?o.split("."):[o];for(j=0;j<et.length&&_;j+=1)_=_[et[j]];return _===void 0?$:_}var memoize=_=>{const o=new WeakMap;return(j,et,tt,rt)=>{if(typeof j>"u")return _(j,et,tt);o.has(j)||o.set(j,new Map);const nt=o.get(j);if(nt.has(et))return nt.get(et);const it=_(j,et,tt,rt);return nt.set(et,it),it}},memoizedGet=memoize(get$5);function objectFilter(_,o){const $={};return Object.keys(_).forEach(j=>{const et=_[j];o(et,j,_)&&($[j]=et)}),$}var filterUndefined=_=>objectFilter(_,o=>o!=null);function isFunction$1(_){return typeof _=="function"}function runIfFn(_,...o){return isFunction$1(_)?_(...o):_}function callAllHandlers(..._){return function($){_.some(j=>(j==null||j($),$==null?void 0:$.defaultPrevented))}}var hasElementType=typeof Element<"u",hasMap=typeof Map=="function",hasSet=typeof Set=="function",hasArrayBuffer=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function equal$1(_,o){if(_===o)return!0;if(_&&o&&typeof _=="object"&&typeof o=="object"){if(_.constructor!==o.constructor)return!1;var $,j,et;if(Array.isArray(_)){if($=_.length,$!=o.length)return!1;for(j=$;j--!==0;)if(!equal$1(_[j],o[j]))return!1;return!0}var tt;if(hasMap&&_ instanceof Map&&o instanceof Map){if(_.size!==o.size)return!1;for(tt=_.entries();!(j=tt.next()).done;)if(!o.has(j.value[0]))return!1;for(tt=_.entries();!(j=tt.next()).done;)if(!equal$1(j.value[1],o.get(j.value[0])))return!1;return!0}if(hasSet&&_ instanceof Set&&o instanceof Set){if(_.size!==o.size)return!1;for(tt=_.entries();!(j=tt.next()).done;)if(!o.has(j.value[0]))return!1;return!0}if(hasArrayBuffer&&ArrayBuffer.isView(_)&&ArrayBuffer.isView(o)){if($=_.length,$!=o.length)return!1;for(j=$;j--!==0;)if(_[j]!==o[j])return!1;return!0}if(_.constructor===RegExp)return _.source===o.source&&_.flags===o.flags;if(_.valueOf!==Object.prototype.valueOf)return _.valueOf()===o.valueOf();if(_.toString!==Object.prototype.toString)return _.toString()===o.toString();if(et=Object.keys(_),$=et.length,$!==Object.keys(o).length)return!1;for(j=$;j--!==0;)if(!Object.prototype.hasOwnProperty.call(o,et[j]))return!1;if(hasElementType&&_ instanceof Element)return!1;for(j=$;j--!==0;)if(!((et[j]==="_owner"||et[j]==="__v"||et[j]==="__o")&&_.$$typeof)&&!equal$1(_[et[j]],o[et[j]]))return!1;return!0}return _!==_&&o!==o}var reactFastCompare=function(o,$){try{return equal$1(o,$)}catch(j){if((j.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw j}};function useStyleConfigImpl(_,o={}){var $;const{styleConfig:j,...et}=o,{theme:tt,colorMode:rt}=useChakra(),nt=_?memoizedGet(tt,`components.${_}`):void 0,it=j||nt,st=mergeWith({theme:tt,colorMode:rt},($=it==null?void 0:it.defaultProps)!=null?$:{},filterUndefined(omit(et,["children"]))),ot=reactExports.useRef({});if(it){const ct=resolveStyleConfig(it)(st);reactFastCompare(ot.current,ct)||(ot.current=ct)}return ot.current}function useStyleConfig(_,o={}){return useStyleConfigImpl(_,o)}function useMultiStyleConfig(_,o={}){return useStyleConfigImpl(_,o)}var allPropNames=new Set([...propNames,"textStyle","layerStyle","apply","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),validHTMLProps=new Set(["htmlWidth","htmlHeight","htmlSize","htmlTranslate"]);function shouldForwardProp(_){return validHTMLProps.has(_)||!allPropNames.has(_)}function compact(_){const o=Object.assign({},_);for(let $ in o)o[$]===void 0&&delete o[$];return o}function assignAfter(_,...o){if(_==null)throw new TypeError("Cannot convert undefined or null to object");const $={..._};for(const j of o)if(j!=null)for(const et in j)Object.prototype.hasOwnProperty.call(j,et)&&(et in $&&delete $[et],$[et]=j[et]);return $}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize$2(function(_){return reactPropsRegex.test(_)||_.charCodeAt(0)===111&&_.charCodeAt(1)===110&&_.charCodeAt(2)<91}),testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function(o){return o!=="theme"},getDefaultShouldForwardProp=function(o){return typeof o=="string"&&o.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function(o,$,j){var et;if($){var tt=$.shouldForwardProp;et=o.__emotion_forwardProp&&tt?function(rt){return o.__emotion_forwardProp(rt)&&tt(rt)}:tt}return typeof et!="function"&&j&&(et=o.__emotion_forwardProp),et},Insertion=function(o){var $=o.cache,j=o.serialized,et=o.isStringTag;return registerStyles($,j,et),useInsertionEffectAlwaysWithSyncFallback(function(){return insertStyles($,j,et)}),null},createStyled=function _(o,$){var j=o.__emotion_real===o,et=j&&o.__emotion_base||o,tt,rt;$!==void 0&&(tt=$.label,rt=$.target);var nt=composeShouldForwardProps(o,$,j),it=nt||getDefaultShouldForwardProp(et),st=!it("as");return function(){var ot=arguments,at=j&&o.__emotion_styles!==void 0?o.__emotion_styles.slice(0):[];if(tt!==void 0&&at.push("label:"+tt+";"),ot[0]==null||ot[0].raw===void 0)at.push.apply(at,ot);else{at.push(ot[0][0]);for(var ct=ot.length,ut=1;ut<ct;ut++)at.push(ot[ut],ot[0][ut])}var ft=withEmotionCache(function(ht,mt,gt){var Et=st&&ht.as||et,St="",At=[],kt=ht;if(ht.theme==null){kt={};for(var Rt in ht)kt[Rt]=ht[Rt];kt.theme=reactExports.useContext(ThemeContext)}typeof ht.className=="string"?St=getRegisteredStyles(mt.registered,At,ht.className):ht.className!=null&&(St=ht.className+" ");var Tt=serializeStyles(at.concat(At),mt.registered,kt);St+=mt.key+"-"+Tt.name,rt!==void 0&&(St+=" "+rt);var Dt=st&&nt===void 0?getDefaultShouldForwardProp(Et):it,Ot={};for(var jt in ht)st&&jt==="as"||Dt(jt)&&(Ot[jt]=ht[jt]);return Ot.className=St,Ot.ref=gt,reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Insertion,{cache:mt,serialized:Tt,isStringTag:typeof Et=="string"}),reactExports.createElement(Et,Ot))});return ft.displayName=tt!==void 0?tt:"Styled("+(typeof et=="string"?et:et.displayName||et.name||"Component")+")",ft.defaultProps=o.defaultProps,ft.__emotion_real=ft,ft.__emotion_base=et,ft.__emotion_styles=at,ft.__emotion_forwardProp=nt,Object.defineProperty(ft,"toString",{value:function(){return"."+rt}}),ft.withComponent=function(ht,mt){return _(ht,_extends$2({},$,mt,{shouldForwardProp:composeShouldForwardProps(ft,mt,!0)})).apply(void 0,at)},ft}},tags=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],newStyled=createStyled.bind();tags.forEach(function(_){newStyled[_]=newStyled(_)});var _a$5,emotion_styled=(_a$5=newStyled.default)!=null?_a$5:newStyled,toCSSObject=({baseStyle:_})=>o=>{const{theme:$,css:j,__css:et,sx:tt,...rt}=o,nt=objectFilter(rt,(at,ct)=>isStyleProp(ct)),it=runIfFn(_,o),st=assignAfter({},et,it,filterUndefined(nt),tt),ot=css(st)(o.theme);return j?[ot,j]:ot};function styled(_,o){const{baseStyle:$,...j}=o??{};j.shouldForwardProp||(j.shouldForwardProp=shouldForwardProp);const et=toCSSObject({baseStyle:$}),tt=emotion_styled(_,j)(et);return React.forwardRef(function(it,st){const{colorMode:ot,forced:at}=useColorMode();return React.createElement(tt,{ref:st,"data-theme":at?ot:void 0,...it})})}function factory$1(){const _=new Map;return new Proxy(styled,{apply(o,$,j){return styled(...j)},get(o,$){return _.has($)||_.set($,styled($)),_.get($)}})}var chakra=factory$1();function forwardRef(_){return reactExports.forwardRef(_)}function createContext(_={}){const{strict:o=!0,errorMessage:$="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:j}=_,et=reactExports.createContext(void 0);et.displayName=j;function tt(){var rt;const nt=reactExports.useContext(et);if(!nt&&o){const it=new Error($);throw it.name="ContextError",(rt=Error.captureStackTrace)==null||rt.call(Error,it,tt),it}return nt}return[et.Provider,tt,et]}function ThemeProvider(_){const{cssVarsRoot:o,theme:$,children:j}=_,et=reactExports.useMemo(()=>toCSSVar($),[$]);return jsxs(ThemeProvider$1,{theme:et,children:[jsx(CSSVars,{root:o}),j]})}function CSSVars({root:_=":host, :root"}){const o=[_,"[data-theme]"].join(",");return jsx(Global,{styles:$=>({[o]:$.__cssVars})})}createContext({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "});function createStylesContext(_){return createContext({name:`${_}StylesContext`,errorMessage:`useStyles: "styles" is undefined. Seems you forgot to wrap the components in "<${_} />" `})}function GlobalStyle(){const{colorMode:_}=useColorMode();return jsx(Global,{styles:o=>{const $=memoizedGet(o,"styles.global"),j=runIfFn($,{theme:o,colorMode:_});return j?css(j)(o):void 0}})}var EnvironmentContext=reactExports.createContext({getDocument(){return document},getWindow(){return window}});EnvironmentContext.displayName="EnvironmentContext";function EnvironmentProvider(_){const{children:o,environment:$,disabled:j}=_,et=reactExports.useRef(null),tt=reactExports.useMemo(()=>$||{getDocument:()=>{var nt,it;return(it=(nt=et.current)==null?void 0:nt.ownerDocument)!=null?it:document},getWindow:()=>{var nt,it;return(it=(nt=et.current)==null?void 0:nt.ownerDocument.defaultView)!=null?it:window}},[$]),rt=!j||!$;return jsxs(EnvironmentContext.Provider,{value:tt,children:[o,rt&&jsx("span",{id:"__chakra_env",hidden:!0,ref:et})]})}EnvironmentProvider.displayName="EnvironmentProvider";var ChakraProvider$1=_=>{const{children:o,colorModeManager:$,portalZIndex:j,resetCSS:et=!0,theme:tt={},environment:rt,cssVarsRoot:nt,disableEnvironment:it}=_,st=jsx(EnvironmentProvider,{environment:rt,disabled:it,children:o});return jsx(ThemeProvider,{theme:tt,cssVarsRoot:nt,children:jsxs(ColorModeProvider,{colorModeManager:$,options:tt.config,children:[et?jsx(CSSReset,{}):jsx(CSSPolyfill,{}),jsx(GlobalStyle,{}),j?jsx(PortalManager,{zIndex:j,children:st}):st]})})},findById=(_,o)=>_.find($=>$.id===o);function findToast(_,o){const $=getToastPosition(_,o),j=$?_[$].findIndex(et=>et.id===o):-1;return{position:$,index:j}}function getToastPosition(_,o){for(const[$,j]of Object.entries(_))if(findById(j,o))return $}function getToastStyle(_){const o=_.includes("right"),$=_.includes("left");let j="center";return o&&(j="flex-end"),$&&(j="flex-start"),{display:"flex",flexDirection:"column",alignItems:j}}function getToastListStyle(_){const $=_==="top"||_==="bottom"?"0 auto":void 0,j=_.includes("top")?"env(safe-area-inset-top, 0px)":void 0,et=_.includes("bottom")?"env(safe-area-inset-bottom, 0px)":void 0,tt=_.includes("left")?void 0:"env(safe-area-inset-right, 0px)",rt=_.includes("right")?void 0:"env(safe-area-inset-left, 0px)";return{position:"fixed",zIndex:5500,pointerEvents:"none",display:"flex",flexDirection:"column",margin:$,top:j,bottom:et,right:tt,left:rt}}function useCallbackRef$2(_,o=[]){const $=reactExports.useRef(_);return reactExports.useEffect(()=>{$.current=_}),reactExports.useCallback((...j)=>{var et;return(et=$.current)==null?void 0:et.call($,...j)},o)}function useTimeout(_,o){const $=useCallbackRef$2(_);reactExports.useEffect(()=>{if(o==null)return;let j=null;return j=window.setTimeout(()=>{$()},o),()=>{j&&window.clearTimeout(j)}},[o,$])}function useUpdateEffect(_,o){const $=reactExports.useRef(!1),j=reactExports.useRef(!1);reactExports.useEffect(()=>{if($.current&&j.current)return _();j.current=!0},o),reactExports.useEffect(()=>($.current=!0,()=>{$.current=!1}),[])}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(_,o){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,j){$.__proto__=j}||function($,j){for(var et in j)Object.prototype.hasOwnProperty.call(j,et)&&($[et]=j[et])},extendStatics(_,o)};function __extends(_,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");extendStatics(_,o);function $(){this.constructor=_}_.prototype=o===null?Object.create(o):($.prototype=o.prototype,new $)}var __assign$1=function(){return __assign$1=Object.assign||function(o){for(var $,j=1,et=arguments.length;j<et;j++){$=arguments[j];for(var tt in $)Object.prototype.hasOwnProperty.call($,tt)&&(o[tt]=$[tt])}return o},__assign$1.apply(this,arguments)};function __rest$1(_,o){var $={};for(var j in _)Object.prototype.hasOwnProperty.call(_,j)&&o.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&typeof Object.getOwnPropertySymbols=="function")for(var et=0,j=Object.getOwnPropertySymbols(_);et<j.length;et++)o.indexOf(j[et])<0&&Object.prototype.propertyIsEnumerable.call(_,j[et])&&($[j[et]]=_[j[et]]);return $}function __values(_){var o=typeof Symbol=="function"&&Symbol.iterator,$=o&&_[o],j=0;if($)return $.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&j>=_.length&&(_=void 0),{value:_&&_[j++],done:!_}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(_,o){var $=typeof Symbol=="function"&&_[Symbol.iterator];if(!$)return _;var j=$.call(_),et,tt=[],rt;try{for(;(o===void 0||o-- >0)&&!(et=j.next()).done;)tt.push(et.value)}catch(nt){rt={error:nt}}finally{try{et&&!et.done&&($=j.return)&&$.call(j)}finally{if(rt)throw rt.error}}return tt}function __spreadArray$1(_,o,$){if($||arguments.length===2)for(var j=0,et=o.length,tt;j<et;j++)(tt||!(j in o))&&(tt||(tt=Array.prototype.slice.call(o,0,j)),tt[j]=o[j]);return _.concat(tt||Array.prototype.slice.call(o))}var defaultEnvironment="production",env$1=typeof browserExports$3>"u"||browserExports$3.env===void 0?defaultEnvironment:"production",createDefinition=function(_){return{isEnabled:function(o){return _.some(function($){return!!o[$]})}}},featureDefinitions={measureLayout:createDefinition(["layout","layoutId","drag"]),animation:createDefinition(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"]),exit:createDefinition(["exit"]),drag:createDefinition(["drag","dragControls"]),focus:createDefinition(["whileFocus"]),hover:createDefinition(["whileHover","onHoverStart","onHoverEnd"]),tap:createDefinition(["whileTap","onTap","onTapStart","onTapCancel"]),pan:createDefinition(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),inView:createDefinition(["whileInView","onViewportEnter","onViewportLeave"])};function loadFeatures(_){for(var o in _)_[o]!==null&&(o==="projectionNodeConstructor"?featureDefinitions.projectionNodeConstructor=_[o]:featureDefinitions[o].Component=_[o])}var warning=function(){},invariant=function(){},LazyContext=reactExports.createContext({strict:!1}),featureNames=Object.keys(featureDefinitions),numFeatures=featureNames.length;function useFeatures(_,o,$){var j=[],et=reactExports.useContext(LazyContext);if(!o)return null;env$1!=="production"&&$&&et.strict;for(var tt=0;tt<numFeatures;tt++){var rt=featureNames[tt],nt=featureDefinitions[rt],it=nt.isEnabled,st=nt.Component;it(_)&&st&&j.push(reactExports.createElement(st,__assign$1({key:rt},_,{visualElement:o})))}return j}var MotionConfigContext=reactExports.createContext({transformPagePoint:function(_){return _},isStatic:!1,reducedMotion:"never"}),MotionContext=reactExports.createContext({});function useVisualElementContext(){return reactExports.useContext(MotionContext).visualElement}var PresenceContext=reactExports.createContext(null),isBrowser$3=typeof document<"u",useIsomorphicLayoutEffect=isBrowser$3?reactExports.useLayoutEffect:reactExports.useEffect,prefersReducedMotion={current:null},hasDetected=!1;function initPrefersReducedMotion(){if(hasDetected=!0,!!isBrowser$3)if(window.matchMedia){var _=window.matchMedia("(prefers-reduced-motion)"),o=function(){return prefersReducedMotion.current=_.matches};_.addListener(o),o()}else prefersReducedMotion.current=!1}function useReducedMotion(){!hasDetected&&initPrefersReducedMotion();var _=__read(reactExports.useState(prefersReducedMotion.current),1),o=_[0];return o}function useReducedMotionConfig(){var _=useReducedMotion(),o=reactExports.useContext(MotionConfigContext).reducedMotion;return o==="never"?!1:o==="always"?!0:_}function useVisualElement(_,o,$,j){var et=reactExports.useContext(LazyContext),tt=useVisualElementContext(),rt=reactExports.useContext(PresenceContext),nt=useReducedMotionConfig(),it=reactExports.useRef(void 0);j||(j=et.renderer),!it.current&&j&&(it.current=j(_,{visualState:o,parent:tt,props:$,presenceId:rt==null?void 0:rt.id,blockInitialAnimation:(rt==null?void 0:rt.initial)===!1,shouldReduceMotion:nt}));var st=it.current;return useIsomorphicLayoutEffect(function(){st==null||st.syncRender()}),reactExports.useEffect(function(){var ot;(ot=st==null?void 0:st.animationState)===null||ot===void 0||ot.animateChanges()}),useIsomorphicLayoutEffect(function(){return function(){return st==null?void 0:st.notifyUnmount()}},[]),st}function isRefObject(_){return typeof _=="object"&&Object.prototype.hasOwnProperty.call(_,"current")}function useMotionRef(_,o,$){return reactExports.useCallback(function(j){var et;j&&((et=_.mount)===null||et===void 0||et.call(_,j)),o&&(j?o.mount(j):o.unmount()),$&&(typeof $=="function"?$(j):isRefObject($)&&($.current=j))},[o])}function isVariantLabels(_){return Array.isArray(_)}function isVariantLabel(_){return typeof _=="string"||isVariantLabels(_)}function getCurrent(_){var o={};return _.forEachValue(function($,j){return o[j]=$.get()}),o}function getVelocity$1(_){var o={};return _.forEachValue(function($,j){return o[j]=$.getVelocity()}),o}function resolveVariantFromProps(_,o,$,j,et){var tt;return j===void 0&&(j={}),et===void 0&&(et={}),typeof o=="function"&&(o=o($??_.custom,j,et)),typeof o=="string"&&(o=(tt=_.variants)===null||tt===void 0?void 0:tt[o]),typeof o=="function"&&(o=o($??_.custom,j,et)),o}function resolveVariant(_,o,$){var j=_.getProps();return resolveVariantFromProps(j,o,$??j.custom,getCurrent(_),getVelocity$1(_))}function checkIfControllingVariants(_){var o;return typeof((o=_.animate)===null||o===void 0?void 0:o.start)=="function"||isVariantLabel(_.initial)||isVariantLabel(_.animate)||isVariantLabel(_.whileHover)||isVariantLabel(_.whileDrag)||isVariantLabel(_.whileTap)||isVariantLabel(_.whileFocus)||isVariantLabel(_.exit)}function checkIfVariantNode(_){return!!(checkIfControllingVariants(_)||_.variants)}function getCurrentTreeVariants(_,o){if(checkIfControllingVariants(_)){var $=_.initial,j=_.animate;return{initial:$===!1||isVariantLabel($)?$:void 0,animate:isVariantLabel(j)?j:void 0}}return _.inherit!==!1?o:{}}function useCreateMotionContext(_){var o=getCurrentTreeVariants(_,reactExports.useContext(MotionContext)),$=o.initial,j=o.animate;return reactExports.useMemo(function(){return{initial:$,animate:j}},[variantLabelsAsDependency($),variantLabelsAsDependency(j)])}function variantLabelsAsDependency(_){return Array.isArray(_)?_.join(" "):_}function useConstant(_){var o=reactExports.useRef(null);return o.current===null&&(o.current=_()),o.current}var globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1},id$2=1;function useProjectionId(){return useConstant(function(){if(globalProjectionState.hasEverUpdated)return id$2++})}var LayoutGroupContext=reactExports.createContext({}),SwitchLayoutGroupContext=reactExports.createContext({});function useProjection(_,o,$,j){var et,tt=o.layoutId,rt=o.layout,nt=o.drag,it=o.dragConstraints,st=o.layoutScroll,ot=reactExports.useContext(SwitchLayoutGroupContext);!j||!$||$!=null&&$.projection||($.projection=new j(_,$.getLatestValues(),(et=$.parent)===null||et===void 0?void 0:et.projection),$.projection.setOptions({layoutId:tt,layout:rt,alwaysMeasureLayout:!!nt||it&&isRefObject(it),visualElement:$,scheduleRender:function(){return $.scheduleRender()},animationType:typeof rt=="string"?rt:"both",initialPromotionConfig:ot,layoutScroll:st}))}var VisualElementHandler=function(_){__extends(o,_);function o(){return _!==null&&_.apply(this,arguments)||this}return o.prototype.getSnapshotBeforeUpdate=function(){return this.updateProps(),null},o.prototype.componentDidUpdate=function(){},o.prototype.updateProps=function(){var $=this.props,j=$.visualElement,et=$.props;j&&j.setProps(et)},o.prototype.render=function(){return this.props.children},o}(React.Component);function createMotionComponent(_){var o=_.preloadedFeatures,$=_.createVisualElement,j=_.projectionNodeConstructor,et=_.useRender,tt=_.useVisualState,rt=_.Component;o&&loadFeatures(o);function nt(it,st){var ot=useLayoutId(it);it=__assign$1(__assign$1({},it),{layoutId:ot});var at=reactExports.useContext(MotionConfigContext),ct=null,ut=useCreateMotionContext(it),ft=at.isStatic?void 0:useProjectionId(),ht=tt(it,at.isStatic);return!at.isStatic&&isBrowser$3&&(ut.visualElement=useVisualElement(rt,ht,__assign$1(__assign$1({},at),it),$),useProjection(ft,it,ut.visualElement,j||featureDefinitions.projectionNodeConstructor),ct=useFeatures(it,ut.visualElement,o)),reactExports.createElement(VisualElementHandler,{visualElement:ut.visualElement,props:__assign$1(__assign$1({},at),it)},ct,reactExports.createElement(MotionContext.Provider,{value:ut},et(rt,it,ft,useMotionRef(ht,ut.visualElement,st),ht,at.isStatic,ut.visualElement)))}return reactExports.forwardRef(nt)}function useLayoutId(_){var o,$=_.layoutId,j=(o=reactExports.useContext(LayoutGroupContext))===null||o===void 0?void 0:o.id;return j&&$!==void 0?j+"-"+$:$}function createMotionProxy(_){function o(j,et){return et===void 0&&(et={}),createMotionComponent(_(j,et))}if(typeof Proxy>"u")return o;var $=new Map;return new Proxy(o,{get:function(j,et){return $.has(et)||$.set(et,o(et)),$.get(et)}})}var lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function isSVGComponent(_){return typeof _!="string"||_.includes("-")?!1:!!(lowercaseSVGElements.indexOf(_)>-1||/[A-Z]/.test(_))}var scaleCorrectors={};function addScaleCorrector(_){Object.assign(scaleCorrectors,_)}var transformAxes=["","X","Y","Z"],order=["translate","scale","rotate","skew"],transformProps=["transformPerspective","x","y","z"];order.forEach(function(_){return transformAxes.forEach(function(o){return transformProps.push(_+o)})});function sortTransformProps(_,o){return transformProps.indexOf(_)-transformProps.indexOf(o)}var transformPropSet=new Set(transformProps);function isTransformProp(_){return transformPropSet.has(_)}var transformOriginProps=new Set(["originX","originY","originZ"]);function isTransformOriginProp(_){return transformOriginProps.has(_)}function isForcedMotionValue(_,o){var $=o.layout,j=o.layoutId;return isTransformProp(_)||isTransformOriginProp(_)||($||j!==void 0)&&(!!scaleCorrectors[_]||_==="opacity")}var isMotionValue=function(_){return!!(_!==null&&typeof _=="object"&&_.getVelocity)},translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function buildTransform(_,o,$,j){var et=_.transform,tt=_.transformKeys,rt=o.enableHardwareAcceleration,nt=rt===void 0?!0:rt,it=o.allowTransformNone,st=it===void 0?!0:it,ot="";tt.sort(sortTransformProps);for(var at=!1,ct=tt.length,ut=0;ut<ct;ut++){var ft=tt[ut];ot+="".concat(translateAlias[ft]||ft,"(").concat(et[ft],") "),ft==="z"&&(at=!0)}return!at&&nt?ot+="translateZ(0)":ot=ot.trim(),j?ot=j(et,$?"":ot):st&&$&&(ot="none"),ot}function buildTransformOrigin(_){var o=_.originX,$=o===void 0?"50%":o,j=_.originY,et=j===void 0?"50%":j,tt=_.originZ,rt=tt===void 0?0:tt;return"".concat($," ").concat(et," ").concat(rt)}function isCSSVariable$1(_){return _.startsWith("--")}var getValueAsType=function(_,o){return o&&typeof _=="number"?o.transform(_):_};const clamp$1=(_,o)=>$=>Math.max(Math.min($,o),_),sanitize$1=_=>_%1?Number(_.toFixed(5)):_,floatRegex=/(-)?([\d]*\.?[\d])+/g,colorRegex=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,singleColorRegex=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function isString$1(_){return typeof _=="string"}const number={test:_=>typeof _=="number",parse:parseFloat,transform:_=>_},alpha=Object.assign(Object.assign({},number),{transform:clamp$1(0,1)}),scale=Object.assign(Object.assign({},number),{default:1}),createUnitType=_=>({test:o=>isString$1(o)&&o.endsWith(_)&&o.split(" ").length===1,parse:parseFloat,transform:o=>`${o}${_}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage=Object.assign(Object.assign({},percent),{parse:_=>percent.parse(_)/100,transform:_=>percent.transform(_*100)}),isColorString=(_,o)=>$=>!!(isString$1($)&&singleColorRegex.test($)&&$.startsWith(_)||o&&Object.prototype.hasOwnProperty.call($,o)),splitColor=(_,o,$)=>j=>{if(!isString$1(j))return j;const[et,tt,rt,nt]=j.match(floatRegex);return{[_]:parseFloat(et),[o]:parseFloat(tt),[$]:parseFloat(rt),alpha:nt!==void 0?parseFloat(nt):1}},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:_,saturation:o,lightness:$,alpha:j=1})=>"hsla("+Math.round(_)+", "+percent.transform(sanitize$1(o))+", "+percent.transform(sanitize$1($))+", "+sanitize$1(alpha.transform(j))+")"},clampRgbUnit=clamp$1(0,255),rgbUnit=Object.assign(Object.assign({},number),{transform:_=>Math.round(clampRgbUnit(_))}),rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:_,green:o,blue:$,alpha:j=1})=>"rgba("+rgbUnit.transform(_)+", "+rgbUnit.transform(o)+", "+rgbUnit.transform($)+", "+sanitize$1(alpha.transform(j))+")"};function parseHex(_){let o="",$="",j="",et="";return _.length>5?(o=_.substr(1,2),$=_.substr(3,2),j=_.substr(5,2),et=_.substr(7,2)):(o=_.substr(1,1),$=_.substr(2,1),j=_.substr(3,1),et=_.substr(4,1),o+=o,$+=$,j+=j,et+=et),{red:parseInt(o,16),green:parseInt($,16),blue:parseInt(j,16),alpha:et?parseInt(et,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},color={test:_=>rgba.test(_)||hex.test(_)||hsla.test(_),parse:_=>rgba.test(_)?rgba.parse(_):hsla.test(_)?hsla.parse(_):hex.parse(_),transform:_=>isString$1(_)?_:_.hasOwnProperty("red")?rgba.transform(_):hsla.transform(_)},colorToken="${c}",numberToken="${n}";function test(_){var o,$,j,et;return isNaN(_)&&isString$1(_)&&(($=(o=_.match(floatRegex))===null||o===void 0?void 0:o.length)!==null&&$!==void 0?$:0)+((et=(j=_.match(colorRegex))===null||j===void 0?void 0:j.length)!==null&&et!==void 0?et:0)>0}function analyse$1(_){typeof _=="number"&&(_=`${_}`);const o=[];let $=0;const j=_.match(colorRegex);j&&($=j.length,_=_.replace(colorRegex,colorToken),o.push(...j.map(color.parse)));const et=_.match(floatRegex);return et&&(_=_.replace(floatRegex,numberToken),o.push(...et.map(number.parse))),{values:o,numColors:$,tokenised:_}}function parse$8(_){return analyse$1(_).values}function createTransformer(_){const{values:o,numColors:$,tokenised:j}=analyse$1(_),et=o.length;return tt=>{let rt=j;for(let nt=0;nt<et;nt++)rt=rt.replace(nt<$?colorToken:numberToken,nt<$?color.transform(tt[nt]):sanitize$1(tt[nt]));return rt}}const convertNumbersToZero=_=>typeof _=="number"?0:_;function getAnimatableNone$1(_){const o=parse$8(_);return createTransformer(_)(o.map(convertNumbersToZero))}const complex={test,parse:parse$8,createTransformer,getAnimatableNone:getAnimatableNone$1},maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(_){let[o,$]=_.slice(0,-1).split("(");if(o==="drop-shadow")return _;const[j]=$.match(floatRegex)||[];if(!j)return _;const et=$.replace(j,"");let tt=maxDefaults.has(o)?1:0;return j!==$&&(tt*=100),o+"("+tt+et+")"}const functionRegex=/([a-z-]*)\(.*?\)/g,filter$2=Object.assign(Object.assign({},complex),{getAnimatableNone:_=>{const o=_.match(functionRegex);return o?o.map(applyDefaultFilter).join(" "):_}});var int$1=__assign$1(__assign$1({},number),{transform:Math.round}),numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,size:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px,zIndex:int$1,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int$1};function buildHTMLStyles(_,o,$,j){var et,tt=_.style,rt=_.vars,nt=_.transform,it=_.transformKeys,st=_.transformOrigin;it.length=0;var ot=!1,at=!1,ct=!0;for(var ut in o){var ft=o[ut];if(isCSSVariable$1(ut)){rt[ut]=ft;continue}var ht=numberValueTypes[ut],mt=getValueAsType(ft,ht);if(isTransformProp(ut)){if(ot=!0,nt[ut]=mt,it.push(ut),!ct)continue;ft!==((et=ht.default)!==null&&et!==void 0?et:0)&&(ct=!1)}else isTransformOriginProp(ut)?(st[ut]=mt,at=!0):tt[ut]=mt}ot?tt.transform=buildTransform(_,$,ct,j):j?tt.transform=j({},""):!o.transform&&tt.transform&&(tt.transform="none"),at&&(tt.transformOrigin=buildTransformOrigin(st))}var createHtmlRenderState=function(){return{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}};function copyRawValuesOnly(_,o,$){for(var j in o)!isMotionValue(o[j])&&!isForcedMotionValue(j,$)&&(_[j]=o[j])}function useInitialMotionValues(_,o,$){var j=_.transformTemplate;return reactExports.useMemo(function(){var et=createHtmlRenderState();buildHTMLStyles(et,o,{enableHardwareAcceleration:!$},j);var tt=et.vars,rt=et.style;return __assign$1(__assign$1({},tt),rt)},[o])}function useStyle(_,o,$){var j=_.style||{},et={};return copyRawValuesOnly(et,j,_),Object.assign(et,useInitialMotionValues(_,o,$)),_.transformValues&&(et=_.transformValues(et)),et}function useHTMLProps(_,o,$){var j={},et=useStyle(_,o,$);return _.drag&&_.dragListener!==!1&&(j.draggable=!1,et.userSelect=et.WebkitUserSelect=et.WebkitTouchCallout="none",et.touchAction=_.drag===!0?"none":"pan-".concat(_.drag==="x"?"y":"x")),j.style=et,j}var validMotionProps=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","layoutDependency","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","dragSnapToOrigin","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover","whileInView","onViewportEnter","onViewportLeave","viewport","layoutScroll"]);function isValidMotionProp(_){return validMotionProps.has(_)}var shouldForward=function(_){return!isValidMotionProp(_)};function loadExternalIsValidProp(_){_&&(shouldForward=function(o){return o.startsWith("on")?!isValidMotionProp(o):_(o)})}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(_,o,$){var j={};for(var et in _)(shouldForward(et)||$===!0&&isValidMotionProp(et)||!o&&!isValidMotionProp(et)||_.draggable&&et.startsWith("onDrag"))&&(j[et]=_[et]);return j}function calcOrigin$1(_,o,$){return typeof _=="string"?_:px.transform(o+$*_)}function calcSVGTransformOrigin(_,o,$){var j=calcOrigin$1(o,_.x,_.width),et=calcOrigin$1($,_.y,_.height);return"".concat(j," ").concat(et)}var dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(_,o,$,j,et){$===void 0&&($=1),j===void 0&&(j=0),et===void 0&&(et=!0),_.pathLength=1;var tt=et?dashKeys:camelKeys;_[tt.offset]=px.transform(-j);var rt=px.transform(o),nt=px.transform($);_[tt.array]="".concat(rt," ").concat(nt)}function buildSVGAttrs(_,o,$,j){var et=o.attrX,tt=o.attrY,rt=o.originX,nt=o.originY,it=o.pathLength,st=o.pathSpacing,ot=st===void 0?1:st,at=o.pathOffset,ct=at===void 0?0:at,ut=__rest$1(o,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]);buildHTMLStyles(_,ut,$,j),_.attrs=_.style,_.style={};var ft=_.attrs,ht=_.style,mt=_.dimensions;ft.transform&&(mt&&(ht.transform=ft.transform),delete ft.transform),mt&&(rt!==void 0||nt!==void 0||ht.transform)&&(ht.transformOrigin=calcSVGTransformOrigin(mt,rt!==void 0?rt:.5,nt!==void 0?nt:.5)),et!==void 0&&(ft.x=et),tt!==void 0&&(ft.y=tt),it!==void 0&&buildSVGPath(ft,it,ot,ct,!1)}var createSvgRenderState=function(){return __assign$1(__assign$1({},createHtmlRenderState()),{attrs:{}})};function useSVGProps(_,o){var $=reactExports.useMemo(function(){var et=createSvgRenderState();return buildSVGAttrs(et,o,{enableHardwareAcceleration:!1},_.transformTemplate),__assign$1(__assign$1({},et.attrs),{style:__assign$1({},et.style)})},[o]);if(_.style){var j={};copyRawValuesOnly(j,_.style,_),$.style=__assign$1(__assign$1({},j),$.style)}return $}function createUseRender(_){_===void 0&&(_=!1);var o=function($,j,et,tt,rt,nt){var it=rt.latestValues,st=isSVGComponent($)?useSVGProps:useHTMLProps,ot=st(j,it,nt),at=filterProps(j,typeof $=="string",_),ct=__assign$1(__assign$1(__assign$1({},at),ot),{ref:tt});return et&&(ct["data-projection-id"]=et),reactExports.createElement($,ct)};return o}var CAMEL_CASE_PATTERN=/([a-z])([A-Z])/g,REPLACE_TEMPLATE="$1-$2",camelToDash=function(_){return _.replace(CAMEL_CASE_PATTERN,REPLACE_TEMPLATE).toLowerCase()};function renderHTML(_,o,$,j){var et=o.style,tt=o.vars;Object.assign(_.style,et,j&&j.getProjectionStyles($));for(var rt in tt)_.style.setProperty(rt,tt[rt])}var camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength"]);function renderSVG(_,o,$,j){renderHTML(_,o,void 0,j);for(var et in o.attrs)_.setAttribute(camelCaseAttributes.has(et)?et:camelToDash(et),o.attrs[et])}function scrapeMotionValuesFromProps$1(_){var o=_.style,$={};for(var j in o)(isMotionValue(o[j])||isForcedMotionValue(j,_))&&($[j]=o[j]);return $}function scrapeMotionValuesFromProps(_){var o=scrapeMotionValuesFromProps$1(_);for(var $ in _)if(isMotionValue(_[$])){var j=$==="x"||$==="y"?"attr"+$.toUpperCase():$;o[j]=_[$]}return o}function isAnimationControls(_){return typeof _=="object"&&typeof _.start=="function"}var isKeyframesTarget=function(_){return Array.isArray(_)},isCustomValue=function(_){return!!(_&&typeof _=="object"&&_.mix&&_.toValue)},resolveFinalValueInKeyframes=function(_){return isKeyframesTarget(_)?_[_.length-1]||0:_};function resolveMotionValue(_){var o=isMotionValue(_)?_.get():_;return isCustomValue(o)?o.toValue():o}function makeState(_,o,$,j){var et=_.scrapeMotionValuesFromProps,tt=_.createRenderState,rt=_.onMount,nt={latestValues:makeLatestValues(o,$,j,et),renderState:tt()};return rt&&(nt.mount=function(it){return rt(o,it,nt)}),nt}var makeUseVisualState=function(_){return function(o,$){var j=reactExports.useContext(MotionContext),et=reactExports.useContext(PresenceContext);return $?makeState(_,o,j,et):useConstant(function(){return makeState(_,o,j,et)})}};function makeLatestValues(_,o,$,j){var et={},tt=($==null?void 0:$.initial)===!1,rt=j(_);for(var nt in rt)et[nt]=resolveMotionValue(rt[nt]);var it=_.initial,st=_.animate,ot=checkIfControllingVariants(_),at=checkIfVariantNode(_);o&&at&&!ot&&_.inherit!==!1&&(it??(it=o.initial),st??(st=o.animate));var ct=tt||it===!1,ut=ct?st:it;if(ut&&typeof ut!="boolean"&&!isAnimationControls(ut)){var ft=Array.isArray(ut)?ut:[ut];ft.forEach(function(ht){var mt=resolveVariantFromProps(_,ht);if(mt){var gt=mt.transitionEnd;mt.transition;var Et=__rest$1(mt,["transitionEnd","transition"]);for(var St in Et){var At=Et[St];if(Array.isArray(At)){var kt=ct?At.length-1:0;At=At[kt]}At!==null&&(et[St]=At)}for(var St in gt)et[St]=gt[St]}})}return et}var svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onMount:function(_,o,$){var j=$.renderState,et=$.latestValues;try{j.dimensions=typeof o.getBBox=="function"?o.getBBox():o.getBoundingClientRect()}catch{j.dimensions={x:0,y:0,width:0,height:0}}buildSVGAttrs(j,et,{enableHardwareAcceleration:!1},_.transformTemplate),renderSVG(o,j)}})},htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState})};function createDomMotionConfig(_,o,$,j,et){var tt=o.forwardMotionProps,rt=tt===void 0?!1:tt,nt=isSVGComponent(_)?svgMotionConfig:htmlMotionConfig;return __assign$1(__assign$1({},nt),{preloadedFeatures:$,useRender:createUseRender(rt),createVisualElement:j,projectionNodeConstructor:et,Component:_})}var AnimationType;(function(_){_.Animate="animate",_.Hover="whileHover",_.Tap="whileTap",_.Drag="whileDrag",_.Focus="whileFocus",_.InView="whileInView",_.Exit="exit"})(AnimationType||(AnimationType={}));function addDomEvent(_,o,$,j){return j===void 0&&(j={passive:!0}),_.addEventListener(o,$,j),function(){return _.removeEventListener(o,$)}}function useDomEvent(_,o,$,j){reactExports.useEffect(function(){var et=_.current;if($&&et)return addDomEvent(et,o,$,j)},[_,o,$,j])}function useFocusGesture(_){var o=_.whileFocus,$=_.visualElement,j=function(){var tt;(tt=$.animationState)===null||tt===void 0||tt.setActive(AnimationType.Focus,!0)},et=function(){var tt;(tt=$.animationState)===null||tt===void 0||tt.setActive(AnimationType.Focus,!1)};useDomEvent($,"focus",o?j:void 0),useDomEvent($,"blur",o?et:void 0)}function isMouseEvent(_){return typeof PointerEvent<"u"&&_ instanceof PointerEvent?_.pointerType==="mouse":_ instanceof MouseEvent}function isTouchEvent(_){var o=!!_.touches;return o}function filterPrimaryPointer(_){return function(o){var $=o instanceof MouseEvent,j=!$||$&&o.button===0;j&&_(o)}}var defaultPagePoint={pageX:0,pageY:0};function pointFromTouch(_,o){o===void 0&&(o="page");var $=_.touches[0]||_.changedTouches[0],j=$||defaultPagePoint;return{x:j[o+"X"],y:j[o+"Y"]}}function pointFromMouse(_,o){return o===void 0&&(o="page"),{x:_[o+"X"],y:_[o+"Y"]}}function extractEventInfo(_,o){return o===void 0&&(o="page"),{point:isTouchEvent(_)?pointFromTouch(_,o):pointFromMouse(_,o)}}var wrapHandler=function(_,o){o===void 0&&(o=!1);var $=function(j){return _(j,extractEventInfo(j))};return o?filterPrimaryPointer($):$},supportsPointerEvents=function(){return isBrowser$3&&window.onpointerdown===null},supportsTouchEvents=function(){return isBrowser$3&&window.ontouchstart===null},supportsMouseEvents=function(){return isBrowser$3&&window.onmousedown===null},mouseEventNames={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},touchEventNames={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function getPointerEventName(_){return supportsPointerEvents()?_:supportsTouchEvents()?touchEventNames[_]:supportsMouseEvents()?mouseEventNames[_]:_}function addPointerEvent(_,o,$,j){return addDomEvent(_,getPointerEventName(o),wrapHandler($,o==="pointerdown"),j)}function usePointerEvent(_,o,$,j){return useDomEvent(_,getPointerEventName(o),$&&wrapHandler($,o==="pointerdown"),j)}function createLock$1(_){var o=null;return function(){var $=function(){o=null};return o===null?(o=_,$):!1}}var globalHorizontalLock=createLock$1("dragHorizontal"),globalVerticalLock=createLock$1("dragVertical");function getGlobalLock(_){var o=!1;if(_==="y")o=globalVerticalLock();else if(_==="x")o=globalHorizontalLock();else{var $=globalHorizontalLock(),j=globalVerticalLock();$&&j?o=function(){$(),j()}:($&&$(),j&&j())}return o}function isDragActive(){var _=getGlobalLock(!0);return _?(_(),!1):!0}function createHoverEvent(_,o,$){return function(j,et){var tt;!isMouseEvent(j)||isDragActive()||((tt=_.animationState)===null||tt===void 0||tt.setActive(AnimationType.Hover,o),$==null||$(j,et))}}function useHoverGesture(_){var o=_.onHoverStart,$=_.onHoverEnd,j=_.whileHover,et=_.visualElement;usePointerEvent(et,"pointerenter",o||j?createHoverEvent(et,!0,o):void 0,{passive:!o}),usePointerEvent(et,"pointerleave",$||j?createHoverEvent(et,!1,$):void 0,{passive:!$})}var isNodeOrChild=function(_,o){return o?_===o?!0:isNodeOrChild(_,o.parentElement):!1};function useUnmountEffect(_){return reactExports.useEffect(function(){return function(){return _()}},[])}const clamp=(_,o,$)=>Math.min(Math.max($,_),o),safeMin=.001,minDuration=.01,maxDuration=10,minDamping=.05,maxDamping=1;function findSpring({duration:_=800,bounce:o=.25,velocity:$=0,mass:j=1}){let et,tt;warning(_<=maxDuration*1e3);let rt=1-o;rt=clamp(minDamping,maxDamping,rt),_=clamp(minDuration,maxDuration,_/1e3),rt<1?(et=st=>{const ot=st*rt,at=ot*_,ct=ot-$,ut=calcAngularFreq(st,rt),ft=Math.exp(-at);return safeMin-ct/ut*ft},tt=st=>{const at=st*rt*_,ct=at*$+$,ut=Math.pow(rt,2)*Math.pow(st,2)*_,ft=Math.exp(-at),ht=calcAngularFreq(Math.pow(st,2),rt);return(-et(st)+safeMin>0?-1:1)*((ct-ut)*ft)/ht}):(et=st=>{const ot=Math.exp(-st*_),at=(st-$)*_+1;return-safeMin+ot*at},tt=st=>{const ot=Math.exp(-st*_),at=($-st)*(_*_);return ot*at});const nt=5/_,it=approximateRoot(et,tt,nt);if(_=_*1e3,isNaN(it))return{stiffness:100,damping:10,duration:_};{const st=Math.pow(it,2)*j;return{stiffness:st,damping:rt*2*Math.sqrt(j*st),duration:_}}}const rootIterations=12;function approximateRoot(_,o,$){let j=$;for(let et=1;et<rootIterations;et++)j=j-_(j)/o(j);return j}function calcAngularFreq(_,o){return _*Math.sqrt(1-o*o)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(_,o){return o.some($=>_[$]!==void 0)}function getSpringOptions(_){let o=Object.assign({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},_);if(!isSpringType(_,physicsKeys)&&isSpringType(_,durationKeys)){const $=findSpring(_);o=Object.assign(Object.assign(Object.assign({},o),$),{velocity:0,mass:1}),o.isResolvedFromDuration=!0}return o}function spring(_){var{from:o=0,to:$=1,restSpeed:j=2,restDelta:et}=_,tt=__rest$1(_,["from","to","restSpeed","restDelta"]);const rt={done:!1,value:o};let{stiffness:nt,damping:it,mass:st,velocity:ot,duration:at,isResolvedFromDuration:ct}=getSpringOptions(tt),ut=zero$2,ft=zero$2;function ht(){const mt=ot?-(ot/1e3):0,gt=$-o,Et=it/(2*Math.sqrt(nt*st)),St=Math.sqrt(nt/st)/1e3;if(et===void 0&&(et=Math.min(Math.abs($-o)/100,.4)),Et<1){const At=calcAngularFreq(St,Et);ut=kt=>{const Rt=Math.exp(-Et*St*kt);return $-Rt*((mt+Et*St*gt)/At*Math.sin(At*kt)+gt*Math.cos(At*kt))},ft=kt=>{const Rt=Math.exp(-Et*St*kt);return Et*St*Rt*(Math.sin(At*kt)*(mt+Et*St*gt)/At+gt*Math.cos(At*kt))-Rt*(Math.cos(At*kt)*(mt+Et*St*gt)-At*gt*Math.sin(At*kt))}}else if(Et===1)ut=At=>$-Math.exp(-St*At)*(gt+(mt+St*gt)*At);else{const At=St*Math.sqrt(Et*Et-1);ut=kt=>{const Rt=Math.exp(-Et*St*kt),Tt=Math.min(At*kt,300);return $-Rt*((mt+Et*St*gt)*Math.sinh(Tt)+At*gt*Math.cosh(Tt))/At}}}return ht(),{next:mt=>{const gt=ut(mt);if(ct)rt.done=mt>=at;else{const Et=ft(mt)*1e3,St=Math.abs(Et)<=j,At=Math.abs($-gt)<=et;rt.done=St&&At}return rt.value=rt.done?$:gt,rt},flipTarget:()=>{ot=-ot,[o,$]=[$,o],ht()}}}spring.needsInterpolation=(_,o)=>typeof _=="string"||typeof o=="string";const zero$2=_=>0,progress=(_,o,$)=>{const j=o-_;return j===0?1:($-_)/j},mix$1=(_,o,$)=>-$*_+$*o+_;function hueToRgb(_,o,$){return $<0&&($+=1),$>1&&($-=1),$<1/6?_+(o-_)*6*$:$<1/2?o:$<2/3?_+(o-_)*(2/3-$)*6:_}function hslaToRgba({hue:_,saturation:o,lightness:$,alpha:j}){_/=360,o/=100,$/=100;let et=0,tt=0,rt=0;if(!o)et=tt=rt=$;else{const nt=$<.5?$*(1+o):$+o-$*o,it=2*$-nt;et=hueToRgb(it,nt,_+1/3),tt=hueToRgb(it,nt,_),rt=hueToRgb(it,nt,_-1/3)}return{red:Math.round(et*255),green:Math.round(tt*255),blue:Math.round(rt*255),alpha:j}}const mixLinearColor=(_,o,$)=>{const j=_*_,et=o*o;return Math.sqrt(Math.max(0,$*(et-j)+j))},colorTypes=[hex,rgba,hsla],getColorType=_=>colorTypes.find(o=>o.test(_)),mixColor=(_,o)=>{let $=getColorType(_),j=getColorType(o),et=$.parse(_),tt=j.parse(o);$===hsla&&(et=hslaToRgba(et),$=rgba),j===hsla&&(tt=hslaToRgba(tt),j=rgba);const rt=Object.assign({},et);return nt=>{for(const it in rt)it!=="alpha"&&(rt[it]=mixLinearColor(et[it],tt[it],nt));return rt.alpha=mix$1(et.alpha,tt.alpha,nt),$.transform(rt)}},isNum=_=>typeof _=="number",combineFunctions=(_,o)=>$=>o(_($)),pipe$1=(..._)=>_.reduce(combineFunctions);function getMixer(_,o){return isNum(_)?$=>mix$1(_,o,$):color.test(_)?mixColor(_,o):mixComplex(_,o)}const mixArray=(_,o)=>{const $=[..._],j=$.length,et=_.map((tt,rt)=>getMixer(tt,o[rt]));return tt=>{for(let rt=0;rt<j;rt++)$[rt]=et[rt](tt);return $}},mixObject=(_,o)=>{const $=Object.assign(Object.assign({},_),o),j={};for(const et in $)_[et]!==void 0&&o[et]!==void 0&&(j[et]=getMixer(_[et],o[et]));return et=>{for(const tt in j)$[tt]=j[tt](et);return $}};function analyse(_){const o=complex.parse(_),$=o.length;let j=0,et=0,tt=0;for(let rt=0;rt<$;rt++)j||typeof o[rt]=="number"?j++:o[rt].hue!==void 0?tt++:et++;return{parsed:o,numNumbers:j,numRGB:et,numHSL:tt}}const mixComplex=(_,o)=>{const $=complex.createTransformer(o),j=analyse(_),et=analyse(o);return j.numHSL===et.numHSL&&j.numRGB===et.numRGB&&j.numNumbers>=et.numNumbers?pipe$1(mixArray(j.parsed,et.parsed),$):rt=>`${rt>0?o:_}`},mixNumber=(_,o)=>$=>mix$1(_,o,$);function detectMixerFactory(_){if(typeof _=="number")return mixNumber;if(typeof _=="string")return color.test(_)?mixColor:mixComplex;if(Array.isArray(_))return mixArray;if(typeof _=="object")return mixObject}function createMixers(_,o,$){const j=[],et=$||detectMixerFactory(_[0]),tt=_.length-1;for(let rt=0;rt<tt;rt++){let nt=et(_[rt],_[rt+1]);if(o){const it=Array.isArray(o)?o[rt]:o;nt=pipe$1(it,nt)}j.push(nt)}return j}function fastInterpolate([_,o],[$]){return j=>$(progress(_,o,j))}function slowInterpolate(_,o){const $=_.length,j=$-1;return et=>{let tt=0,rt=!1;if(et<=_[0]?rt=!0:et>=_[j]&&(tt=j-1,rt=!0),!rt){let it=1;for(;it<$&&!(_[it]>et||it===j);it++);tt=it-1}const nt=progress(_[tt],_[tt+1],et);return o[tt](nt)}}function interpolate(_,o,{clamp:$=!0,ease:j,mixer:et}={}){const tt=_.length;invariant(tt===o.length),invariant(!j||!Array.isArray(j)||j.length===tt-1),_[0]>_[tt-1]&&(_=[].concat(_),o=[].concat(o),_.reverse(),o.reverse());const rt=createMixers(o,j,et),nt=tt===2?fastInterpolate(_,rt):slowInterpolate(_,rt);return $?it=>nt(clamp(_[0],_[tt-1],it)):nt}const reverseEasing=_=>o=>1-_(1-o),mirrorEasing=_=>o=>o<=.5?_(2*o)/2:(2-_(2*(1-o)))/2,createExpoIn=_=>o=>Math.pow(o,_),createBackIn=_=>o=>o*o*((_+1)*o-_),createAnticipate=_=>{const o=createBackIn(_);return $=>($*=2)<1?.5*o($):.5*(2-Math.pow(2,-10*($-1)))},DEFAULT_OVERSHOOT_STRENGTH=1.525,BOUNCE_FIRST_THRESHOLD=4/11,BOUNCE_SECOND_THRESHOLD=8/11,BOUNCE_THIRD_THRESHOLD=9/10,linear=_=>_,easeIn=createExpoIn(2),easeOut=reverseEasing(easeIn),easeInOut=mirrorEasing(easeIn),circIn=_=>1-Math.sin(Math.acos(_)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circOut),backIn=createBackIn(DEFAULT_OVERSHOOT_STRENGTH),backOut=reverseEasing(backIn),backInOut=mirrorEasing(backIn),anticipate=createAnticipate(DEFAULT_OVERSHOOT_STRENGTH),ca=4356/361,cb=35442/1805,cc=16061/1805,bounceOut=_=>{if(_===1||_===0)return _;const o=_*_;return _<BOUNCE_FIRST_THRESHOLD?7.5625*o:_<BOUNCE_SECOND_THRESHOLD?9.075*o-9.9*_+3.4:_<BOUNCE_THIRD_THRESHOLD?ca*o-cb*_+cc:10.8*_*_-20.52*_+10.72},bounceIn=reverseEasing(bounceOut),bounceInOut=_=>_<.5?.5*(1-bounceOut(1-_*2)):.5*bounceOut(_*2-1)+.5;function defaultEasing(_,o){return _.map(()=>o||easeInOut).splice(0,_.length-1)}function defaultOffset(_){const o=_.length;return _.map(($,j)=>j!==0?j/(o-1):0)}function convertOffsetToTimes(_,o){return _.map($=>$*o)}function keyframes$1({from:_=0,to:o=1,ease:$,offset:j,duration:et=300}){const tt={done:!1,value:_},rt=Array.isArray(o)?o:[_,o],nt=convertOffsetToTimes(j&&j.length===rt.length?j:defaultOffset(rt),et);function it(){return interpolate(nt,rt,{ease:Array.isArray($)?$:defaultEasing(rt,$)})}let st=it();return{next:ot=>(tt.value=st(ot),tt.done=ot>=et,tt),flipTarget:()=>{rt.reverse(),st=it()}}}function decay({velocity:_=0,from:o=0,power:$=.8,timeConstant:j=350,restDelta:et=.5,modifyTarget:tt}){const rt={done:!1,value:o};let nt=$*_;const it=o+nt,st=tt===void 0?it:tt(it);return st!==it&&(nt=st-o),{next:ot=>{const at=-nt*Math.exp(-ot/j);return rt.done=!(at>et||at<-et),rt.value=rt.done?st:st+at,rt},flipTarget:()=>{}}}const types$2={keyframes:keyframes$1,spring,decay};function detectAnimationFromOptions(_){if(Array.isArray(_.to))return keyframes$1;if(types$2[_.type])return types$2[_.type];const o=new Set(Object.keys(_));return o.has("ease")||o.has("duration")&&!o.has("dampingRatio")?keyframes$1:o.has("dampingRatio")||o.has("stiffness")||o.has("mass")||o.has("damping")||o.has("restSpeed")||o.has("restDelta")?spring:keyframes$1}const defaultTimestep$1=1/60*1e3,getCurrentTime$1=typeof performance<"u"?()=>performance.now():()=>Date.now(),onNextFrame$1=typeof window<"u"?_=>window.requestAnimationFrame(_):_=>setTimeout(()=>_(getCurrentTime$1()),defaultTimestep$1);function createRenderStep$1(_){let o=[],$=[],j=0,et=!1,tt=!1;const rt=new WeakSet,nt={schedule:(it,st=!1,ot=!1)=>{const at=ot&&et,ct=at?o:$;return st&&rt.add(it),ct.indexOf(it)===-1&&(ct.push(it),at&&et&&(j=o.length)),it},cancel:it=>{const st=$.indexOf(it);st!==-1&&$.splice(st,1),rt.delete(it)},process:it=>{if(et){tt=!0;return}if(et=!0,[o,$]=[$,o],$.length=0,j=o.length,j)for(let st=0;st<j;st++){const ot=o[st];ot(it),rt.has(ot)&&(nt.schedule(ot),_())}et=!1,tt&&(tt=!1,nt.process(it))}};return nt}const maxElapsed$1=40;let useDefaultElapsed$1=!0,runNextFrame$1=!1,isProcessing$1=!1;const frame$1={delta:0,timestamp:0},stepsOrder$1=["read","update","preRender","render","postRender"],steps$1=stepsOrder$1.reduce((_,o)=>(_[o]=createRenderStep$1(()=>runNextFrame$1=!0),_),{}),sync$1=stepsOrder$1.reduce((_,o)=>{const $=steps$1[o];return _[o]=(j,et=!1,tt=!1)=>(runNextFrame$1||startLoop$1(),$.schedule(j,et,tt)),_},{}),cancelSync$1=stepsOrder$1.reduce((_,o)=>(_[o]=steps$1[o].cancel,_),{});stepsOrder$1.reduce((_,o)=>(_[o]=()=>steps$1[o].process(frame$1),_),{});const processStep$1=_=>steps$1[_].process(frame$1),processFrame$1=_=>{runNextFrame$1=!1,frame$1.delta=useDefaultElapsed$1?defaultTimestep$1:Math.max(Math.min(_-frame$1.timestamp,maxElapsed$1),1),frame$1.timestamp=_,isProcessing$1=!0,stepsOrder$1.forEach(processStep$1),isProcessing$1=!1,runNextFrame$1&&(useDefaultElapsed$1=!1,onNextFrame$1(processFrame$1))},startLoop$1=()=>{runNextFrame$1=!0,useDefaultElapsed$1=!0,isProcessing$1||onNextFrame$1(processFrame$1)},getFrameData$1=()=>frame$1;function loopElapsed(_,o,$=0){return _-o-$}function reverseElapsed(_,o,$=0,j=!0){return j?loopElapsed(o+-_,o,$):o-(_-o)+$}function hasRepeatDelayElapsed(_,o,$,j){return j?_>=o+$:_<=-$}const framesync=_=>{const o=({delta:$})=>_($);return{start:()=>sync$1.update(o,!0),stop:()=>cancelSync$1.update(o)}};function animate$1(_){var o,$,{from:j,autoplay:et=!0,driver:tt=framesync,elapsed:rt=0,repeat:nt=0,repeatType:it="loop",repeatDelay:st=0,onPlay:ot,onStop:at,onComplete:ct,onRepeat:ut,onUpdate:ft}=_,ht=__rest$1(_,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]);let{to:mt}=ht,gt,Et=0,St=ht.duration,At,kt=!1,Rt=!0,Tt;const Dt=detectAnimationFromOptions(ht);!(($=(o=Dt).needsInterpolation)===null||$===void 0)&&$.call(o,j,mt)&&(Tt=interpolate([0,100],[j,mt],{clamp:!1}),j=0,mt=100);const Ot=Dt(Object.assign(Object.assign({},ht),{from:j,to:mt}));function jt(){Et++,it==="reverse"?(Rt=Et%2===0,rt=reverseElapsed(rt,St,st,Rt)):(rt=loopElapsed(rt,St,st),it==="mirror"&&Ot.flipTarget()),kt=!1,ut&&ut()}function Nt(){gt.stop(),ct&&ct()}function It(lt){if(Rt||(lt=-lt),rt+=lt,!kt){const pt=Ot.next(Math.max(0,rt));At=pt.value,Tt&&(At=Tt(At)),kt=Rt?pt.done:rt<=0}ft==null||ft(At),kt&&(Et===0&&(St??(St=rt)),Et<nt?hasRepeatDelayElapsed(rt,St,st,Rt)&&jt():Nt())}function yt(){ot==null||ot(),gt=tt(It),gt.start()}return et&&yt(),{stop:()=>{at==null||at(),gt.stop()}}}function velocityPerSecond(_,o){return o?_*(1e3/o):0}function inertia({from:_=0,velocity:o=0,min:$,max:j,power:et=.8,timeConstant:tt=750,bounceStiffness:rt=500,bounceDamping:nt=10,restDelta:it=1,modifyTarget:st,driver:ot,onUpdate:at,onComplete:ct,onStop:ut}){let ft;function ht(St){return $!==void 0&&St<$||j!==void 0&&St>j}function mt(St){return $===void 0?j:j===void 0||Math.abs($-St)<Math.abs(j-St)?$:j}function gt(St){ft==null||ft.stop(),ft=animate$1(Object.assign(Object.assign({},St),{driver:ot,onUpdate:At=>{var kt;at==null||at(At),(kt=St.onUpdate)===null||kt===void 0||kt.call(St,At)},onComplete:ct,onStop:ut}))}function Et(St){gt(Object.assign({type:"spring",stiffness:rt,damping:nt,restDelta:it},St))}if(ht(_))Et({from:_,velocity:o,to:mt(_)});else{let St=et*o+_;typeof st<"u"&&(St=st(St));const At=mt(St),kt=At===$?-1:1;let Rt,Tt;const Dt=Ot=>{Rt=Tt,Tt=Ot,o=velocityPerSecond(Ot-Rt,getFrameData$1().delta),(kt===1&&Ot>At||kt===-1&&Ot<At)&&Et({from:Ot,to:At,velocity:o})};gt({type:"decay",from:_,velocity:o,timeConstant:tt,power:et,restDelta:it,modifyTarget:st,onUpdate:ht(St)?Dt:void 0})}return{stop:()=>ft==null?void 0:ft.stop()}}const isPoint=_=>_.hasOwnProperty("x")&&_.hasOwnProperty("y"),isPoint3D=_=>isPoint(_)&&_.hasOwnProperty("z"),distance1D=(_,o)=>Math.abs(_-o);function distance(_,o){if(isNum(_)&&isNum(o))return distance1D(_,o);if(isPoint(_)&&isPoint(o)){const $=distance1D(_.x,o.x),j=distance1D(_.y,o.y),et=isPoint3D(_)&&isPoint3D(o)?distance1D(_.z,o.z):0;return Math.sqrt(Math.pow($,2)+Math.pow(j,2)+Math.pow(et,2))}}const a=(_,o)=>1-3*o+3*_,b=(_,o)=>3*o-6*_,c=_=>3*_,calcBezier=(_,o,$)=>((a(o,$)*_+b(o,$))*_+c(o))*_,getSlope=(_,o,$)=>3*a(o,$)*_*_+2*b(o,$)*_+c(o),subdivisionPrecision=1e-7,subdivisionMaxIterations=10;function binarySubdivide(_,o,$,j,et){let tt,rt,nt=0;do rt=o+($-o)/2,tt=calcBezier(rt,j,et)-_,tt>0?$=rt:o=rt;while(Math.abs(tt)>subdivisionPrecision&&++nt<subdivisionMaxIterations);return rt}const newtonIterations=8,newtonMinSlope=.001;function newtonRaphsonIterate(_,o,$,j){for(let et=0;et<newtonIterations;++et){const tt=getSlope(o,$,j);if(tt===0)return o;const rt=calcBezier(o,$,j)-_;o-=rt/tt}return o}const kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1);function cubicBezier(_,o,$,j){if(_===o&&$===j)return linear;const et=new Float32Array(kSplineTableSize);for(let rt=0;rt<kSplineTableSize;++rt)et[rt]=calcBezier(rt*kSampleStepSize,_,$);function tt(rt){let nt=0,it=1;const st=kSplineTableSize-1;for(;it!==st&&et[it]<=rt;++it)nt+=kSampleStepSize;--it;const ot=(rt-et[it])/(et[it+1]-et[it]),at=nt+ot*kSampleStepSize,ct=getSlope(at,_,$);return ct>=newtonMinSlope?newtonRaphsonIterate(rt,at,_,$):ct===0?at:binarySubdivide(rt,nt,nt+kSampleStepSize,_,$)}return rt=>rt===0||rt===1?rt:calcBezier(tt(rt),o,j)}function useTapGesture(_){var o=_.onTap,$=_.onTapStart,j=_.onTapCancel,et=_.whileTap,tt=_.visualElement,rt=o||$||j||et,nt=reactExports.useRef(!1),it=reactExports.useRef(null),st={passive:!($||o||j||ft)};function ot(){var ht;(ht=it.current)===null||ht===void 0||ht.call(it),it.current=null}function at(){var ht;return ot(),nt.current=!1,(ht=tt.animationState)===null||ht===void 0||ht.setActive(AnimationType.Tap,!1),!isDragActive()}function ct(ht,mt){at()&&(isNodeOrChild(tt.getInstance(),ht.target)?o==null||o(ht,mt):j==null||j(ht,mt))}function ut(ht,mt){at()&&(j==null||j(ht,mt))}function ft(ht,mt){var gt;ot(),!nt.current&&(nt.current=!0,it.current=pipe$1(addPointerEvent(window,"pointerup",ct,st),addPointerEvent(window,"pointercancel",ut,st)),(gt=tt.animationState)===null||gt===void 0||gt.setActive(AnimationType.Tap,!0),$==null||$(ht,mt))}usePointerEvent(tt,"pointerdown",rt?ft:void 0,st),useUnmountEffect(ot)}var warned=new Set;function warnOnce(_,o,$){_||warned.has(o)||(console.warn(o),$&&console.warn($),warned.add(o))}var observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=function(_){var o;(o=observerCallbacks.get(_.target))===null||o===void 0||o(_)},fireAllObserverCallbacks=function(_){_.forEach(fireObserverCallback)};function initIntersectionObserver(_){var o=_.root,$=__rest$1(_,["root"]),j=o||document;observers.has(j)||observers.set(j,{});var et=observers.get(j),tt=JSON.stringify($);return et[tt]||(et[tt]=new IntersectionObserver(fireAllObserverCallbacks,__assign$1({root:o},$))),et[tt]}function observeIntersection(_,o,$){var j=initIntersectionObserver(o);return observerCallbacks.set(_,$),j.observe(_),function(){observerCallbacks.delete(_),j.unobserve(_)}}function useViewport(_){var o=_.visualElement,$=_.whileInView,j=_.onViewportEnter,et=_.onViewportLeave,tt=_.viewport,rt=tt===void 0?{}:tt,nt=reactExports.useRef({hasEnteredView:!1,isInView:!1}),it=!!($||j||et);rt.once&&nt.current.hasEnteredView&&(it=!1);var st=typeof IntersectionObserver>"u"?useMissingIntersectionObserver:useIntersectionObserver;st(it,nt.current,o,rt)}var thresholdNames={some:0,all:1};function useIntersectionObserver(_,o,$,j){var et=j.root,tt=j.margin,rt=j.amount,nt=rt===void 0?"some":rt,it=j.once;reactExports.useEffect(function(){if(_){var st={root:et==null?void 0:et.current,rootMargin:tt,threshold:typeof nt=="number"?nt:thresholdNames[nt]},ot=function(at){var ct,ut=at.isIntersecting;if(o.isInView!==ut&&(o.isInView=ut,!(it&&!ut&&o.hasEnteredView))){ut&&(o.hasEnteredView=!0),(ct=$.animationState)===null||ct===void 0||ct.setActive(AnimationType.InView,ut);var ft=$.getProps(),ht=ut?ft.onViewportEnter:ft.onViewportLeave;ht==null||ht(at)}};return observeIntersection($.getInstance(),st,ot)}},[_,et,tt,nt])}function useMissingIntersectionObserver(_,o,$,j){var et=j.fallback,tt=et===void 0?!0:et;reactExports.useEffect(function(){!_||!tt||(env$1!=="production"&&warnOnce(!1,"IntersectionObserver not available on this device. whileInView animations will trigger on mount."),requestAnimationFrame(function(){var rt;o.hasEnteredView=!0;var nt=$.getProps().onViewportEnter;nt==null||nt(null),(rt=$.animationState)===null||rt===void 0||rt.setActive(AnimationType.InView,!0)}))},[_])}var makeRenderlessComponent=function(_){return function(o){return _(o),null}},gestureAnimations={inView:makeRenderlessComponent(useViewport),tap:makeRenderlessComponent(useTapGesture),focus:makeRenderlessComponent(useFocusGesture),hover:makeRenderlessComponent(useHoverGesture)},counter$3=0,incrementId=function(){return counter$3++},useId$1=function(){return useConstant(incrementId)};function usePresence(){var _=reactExports.useContext(PresenceContext);if(_===null)return[!0,null];var o=_.isPresent,$=_.onExitComplete,j=_.register,et=useId$1();reactExports.useEffect(function(){return j(et)},[]);var tt=function(){return $==null?void 0:$(et)};return!o&&$?[!1,tt]:[!0]}function useIsPresent(){return isPresent(reactExports.useContext(PresenceContext))}function isPresent(_){return _===null?!0:_.isPresent}function shallowCompare(_,o){if(!Array.isArray(o))return!1;var $=o.length;if($!==_.length)return!1;for(var j=0;j<$;j++)if(o[j]!==_[j])return!1;return!0}var secondsToMilliseconds=function(_){return _*1e3},easingLookup={linear,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate,bounceIn,bounceInOut,bounceOut},easingDefinitionToFunction=function(_){if(Array.isArray(_)){invariant(_.length===4);var o=__read(_,4),$=o[0],j=o[1],et=o[2],tt=o[3];return cubicBezier($,j,et,tt)}else if(typeof _=="string")return easingLookup[_];return _},isEasingArray=function(_){return Array.isArray(_)&&typeof _[0]!="number"},isAnimatable=function(_,o){return _==="zIndex"?!1:!!(typeof o=="number"||Array.isArray(o)||typeof o=="string"&&complex.test(o)&&!o.startsWith("url("))},underDampedSpring=function(){return{type:"spring",stiffness:500,damping:25,restSpeed:10}},criticallyDampedSpring=function(_){return{type:"spring",stiffness:550,damping:_===0?2*Math.sqrt(550):30,restSpeed:10}},linearTween=function(){return{type:"keyframes",ease:"linear",duration:.3}},keyframes=function(_){return{type:"keyframes",duration:.8,values:_}},defaultTransitions$1={x:underDampedSpring,y:underDampedSpring,z:underDampedSpring,rotate:underDampedSpring,rotateX:underDampedSpring,rotateY:underDampedSpring,rotateZ:underDampedSpring,scaleX:criticallyDampedSpring,scaleY:criticallyDampedSpring,scale:criticallyDampedSpring,opacity:linearTween,backgroundColor:linearTween,color:linearTween,default:criticallyDampedSpring},getDefaultTransition=function(_,o){var $;return isKeyframesTarget(o)?$=keyframes:$=defaultTransitions$1[_]||defaultTransitions$1.default,__assign$1({to:o},$(o))},defaultValueTypes=__assign$1(__assign$1({},numberValueTypes),{color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter:filter$2,WebkitFilter:filter$2}),getDefaultValueType=function(_){return defaultValueTypes[_]};function getAnimatableNone(_,o){var $,j=getDefaultValueType(_);return j!==filter$2&&(j=complex),($=j.getAnimatableNone)===null||$===void 0?void 0:$.call(j,o)}function isTransitionDefined(_){_.when,_.delay,_.delayChildren,_.staggerChildren,_.staggerDirection,_.repeat,_.repeatType,_.repeatDelay,_.from;var o=__rest$1(_,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from"]);return!!Object.keys(o).length}function convertTransitionToAnimationOptions(_){var o=_.ease,$=_.times,j=_.yoyo,et=_.flip,tt=_.loop,rt=__rest$1(_,["ease","times","yoyo","flip","loop"]),nt=__assign$1({},rt);return $&&(nt.offset=$),rt.duration&&(nt.duration=secondsToMilliseconds(rt.duration)),rt.repeatDelay&&(nt.repeatDelay=secondsToMilliseconds(rt.repeatDelay)),o&&(nt.ease=isEasingArray(o)?o.map(easingDefinitionToFunction):easingDefinitionToFunction(o)),rt.type==="tween"&&(nt.type="keyframes"),(j||tt||et)&&(j?nt.repeatType="reverse":tt?nt.repeatType="loop":et&&(nt.repeatType="mirror"),nt.repeat=tt||j||et||rt.repeat),rt.type!=="spring"&&(nt.type="keyframes"),nt}function getDelayFromTransition(_,o){var $,j,et=getValueTransition(_,o)||{};return(j=($=et.delay)!==null&&$!==void 0?$:_.delay)!==null&&j!==void 0?j:0}function hydrateKeyframes(_){return Array.isArray(_.to)&&_.to[0]===null&&(_.to=__spreadArray$1([],__read(_.to),!1),_.to[0]=_.from),_}function getPopmotionAnimationOptions(_,o,$){var j;return Array.isArray(o.to)&&((j=_.duration)!==null&&j!==void 0||(_.duration=.8)),hydrateKeyframes(o),isTransitionDefined(_)||(_=__assign$1(__assign$1({},_),getDefaultTransition($,o.to))),__assign$1(__assign$1({},o),convertTransitionToAnimationOptions(_))}function getAnimation(_,o,$,j,et){var tt,rt=getValueTransition(j,_),nt=(tt=rt.from)!==null&&tt!==void 0?tt:o.get(),it=isAnimatable(_,$);nt==="none"&&it&&typeof $=="string"?nt=getAnimatableNone(_,$):isZero(nt)&&typeof $=="string"?nt=getZeroUnit($):!Array.isArray($)&&isZero($)&&typeof nt=="string"&&($=getZeroUnit(nt));var st=isAnimatable(_,nt);function ot(){var ct={from:nt,to:$,velocity:o.getVelocity(),onComplete:et,onUpdate:function(ut){return o.set(ut)}};return rt.type==="inertia"||rt.type==="decay"?inertia(__assign$1(__assign$1({},ct),rt)):animate$1(__assign$1(__assign$1({},getPopmotionAnimationOptions(rt,ct,_)),{onUpdate:function(ut){var ft;ct.onUpdate(ut),(ft=rt.onUpdate)===null||ft===void 0||ft.call(rt,ut)},onComplete:function(){var ut;ct.onComplete(),(ut=rt.onComplete)===null||ut===void 0||ut.call(rt)}}))}function at(){var ct,ut,ft=resolveFinalValueInKeyframes($);return o.set(ft),et(),(ct=rt==null?void 0:rt.onUpdate)===null||ct===void 0||ct.call(rt,ft),(ut=rt==null?void 0:rt.onComplete)===null||ut===void 0||ut.call(rt),{stop:function(){}}}return!st||!it||rt.type===!1?at:ot}function isZero(_){return _===0||typeof _=="string"&&parseFloat(_)===0&&_.indexOf(" ")===-1}function getZeroUnit(_){return typeof _=="number"?0:getAnimatableNone("",_)}function getValueTransition(_,o){return _[o]||_.default||_}function startAnimation(_,o,$,j){return j===void 0&&(j={}),o.start(function(et){var tt,rt,nt=getAnimation(_,o,$,j,et),it=getDelayFromTransition(j,_),st=function(){return rt=nt()};return it?tt=window.setTimeout(st,secondsToMilliseconds(it)):st(),function(){clearTimeout(tt),rt==null||rt.stop()}})}var isNumericalString=function(_){return/^\-?\d*\.?\d+$/.test(_)},isZeroValueString=function(_){return/^0[^.\s]+$/.test(_)};const defaultTimestep=1/60*1e3,getCurrentTime=typeof performance<"u"?()=>performance.now():()=>Date.now(),onNextFrame=typeof window<"u"?_=>window.requestAnimationFrame(_):_=>setTimeout(()=>_(getCurrentTime()),defaultTimestep);function createRenderStep(_){let o=[],$=[],j=0,et=!1,tt=!1;const rt=new WeakSet,nt={schedule:(it,st=!1,ot=!1)=>{const at=ot&&et,ct=at?o:$;return st&&rt.add(it),ct.indexOf(it)===-1&&(ct.push(it),at&&et&&(j=o.length)),it},cancel:it=>{const st=$.indexOf(it);st!==-1&&$.splice(st,1),rt.delete(it)},process:it=>{if(et){tt=!0;return}if(et=!0,[o,$]=[$,o],$.length=0,j=o.length,j)for(let st=0;st<j;st++){const ot=o[st];ot(it),rt.has(ot)&&(nt.schedule(ot),_())}et=!1,tt&&(tt=!1,nt.process(it))}};return nt}const maxElapsed=40;let useDefaultElapsed=!0,runNextFrame=!1,isProcessing=!1;const frame={delta:0,timestamp:0},stepsOrder=["read","update","preRender","render","postRender"],steps=stepsOrder.reduce((_,o)=>(_[o]=createRenderStep(()=>runNextFrame=!0),_),{}),sync=stepsOrder.reduce((_,o)=>{const $=steps[o];return _[o]=(j,et=!1,tt=!1)=>(runNextFrame||startLoop(),$.schedule(j,et,tt)),_},{}),cancelSync=stepsOrder.reduce((_,o)=>(_[o]=steps[o].cancel,_),{}),flushSync=stepsOrder.reduce((_,o)=>(_[o]=()=>steps[o].process(frame),_),{}),processStep=_=>steps[_].process(frame),processFrame=_=>{runNextFrame=!1,frame.delta=useDefaultElapsed?defaultTimestep:Math.max(Math.min(_-frame.timestamp,maxElapsed),1),frame.timestamp=_,isProcessing=!0,stepsOrder.forEach(processStep),isProcessing=!1,runNextFrame&&(useDefaultElapsed=!1,onNextFrame(processFrame))},startLoop=()=>{runNextFrame=!0,useDefaultElapsed=!0,isProcessing||onNextFrame(processFrame)},getFrameData=()=>frame;function addUniqueItem(_,o){_.indexOf(o)===-1&&_.push(o)}function removeItem(_,o){var $=_.indexOf(o);$>-1&&_.splice($,1)}var SubscriptionManager=function(){function _(){this.subscriptions=[]}return _.prototype.add=function(o){var $=this;return addUniqueItem(this.subscriptions,o),function(){return removeItem($.subscriptions,o)}},_.prototype.notify=function(o,$,j){var et=this.subscriptions.length;if(et)if(et===1)this.subscriptions[0](o,$,j);else for(var tt=0;tt<et;tt++){var rt=this.subscriptions[tt];rt&&rt(o,$,j)}},_.prototype.getSize=function(){return this.subscriptions.length},_.prototype.clear=function(){this.subscriptions.length=0},_}(),isFloat=function(_){return!isNaN(parseFloat(_))},MotionValue=function(){function _(o){var $=this;this.version="6.5.1",this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new SubscriptionManager,this.velocityUpdateSubscribers=new SubscriptionManager,this.renderSubscribers=new SubscriptionManager,this.canTrackVelocity=!1,this.updateAndNotify=function(j,et){et===void 0&&(et=!0),$.prev=$.current,$.current=j;var tt=getFrameData(),rt=tt.delta,nt=tt.timestamp;$.lastUpdated!==nt&&($.timeDelta=rt,$.lastUpdated=nt,sync.postRender($.scheduleVelocityCheck)),$.prev!==$.current&&$.updateSubscribers.notify($.current),$.velocityUpdateSubscribers.getSize()&&$.velocityUpdateSubscribers.notify($.getVelocity()),et&&$.renderSubscribers.notify($.current)},this.scheduleVelocityCheck=function(){return sync.postRender($.velocityCheck)},this.velocityCheck=function(j){var et=j.timestamp;et!==$.lastUpdated&&($.prev=$.current,$.velocityUpdateSubscribers.notify($.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=o,this.canTrackVelocity=isFloat(this.current)}return _.prototype.onChange=function(o){return this.updateSubscribers.add(o)},_.prototype.clearListeners=function(){this.updateSubscribers.clear()},_.prototype.onRenderRequest=function(o){return o(this.get()),this.renderSubscribers.add(o)},_.prototype.attach=function(o){this.passiveEffect=o},_.prototype.set=function(o,$){$===void 0&&($=!0),!$||!this.passiveEffect?this.updateAndNotify(o,$):this.passiveEffect(o,this.updateAndNotify)},_.prototype.get=function(){return this.current},_.prototype.getPrevious=function(){return this.prev},_.prototype.getVelocity=function(){return this.canTrackVelocity?velocityPerSecond(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},_.prototype.start=function(o){var $=this;return this.stop(),new Promise(function(j){$.hasAnimated=!0,$.stopAnimation=o(j)}).then(function(){return $.clearAnimation()})},_.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},_.prototype.isAnimating=function(){return!!this.stopAnimation},_.prototype.clearAnimation=function(){this.stopAnimation=null},_.prototype.destroy=function(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()},_}();function motionValue(_){return new MotionValue(_)}var testValueType=function(_){return function(o){return o.test(_)}},auto={test:function(_){return _==="auto"},parse:function(_){return _}},dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=function(_){return dimensionValueTypes.find(testValueType(_))},valueTypes=__spreadArray$1(__spreadArray$1([],__read(dimensionValueTypes),!1),[color,complex],!1),findValueType=function(_){return valueTypes.find(testValueType(_))};function setMotionValue(_,o,$){_.hasValue(o)?_.getValue(o).set($):_.addValue(o,motionValue($))}function setTarget(_,o){var $=resolveVariant(_,o),j=$?_.makeTargetAnimatable($,!1):{},et=j.transitionEnd,tt=et===void 0?{}:et;j.transition;var rt=__rest$1(j,["transitionEnd","transition"]);rt=__assign$1(__assign$1({},rt),tt);for(var nt in rt){var it=resolveFinalValueInKeyframes(rt[nt]);setMotionValue(_,nt,it)}}function checkTargetForNewValues(_,o,$){var j,et,tt,rt,nt=Object.keys(o).filter(function(ut){return!_.hasValue(ut)}),it=nt.length;if(it)for(var st=0;st<it;st++){var ot=nt[st],at=o[ot],ct=null;Array.isArray(at)&&(ct=at[0]),ct===null&&(ct=(et=(j=$[ot])!==null&&j!==void 0?j:_.readValue(ot))!==null&&et!==void 0?et:o[ot]),ct!=null&&(typeof ct=="string"&&(isNumericalString(ct)||isZeroValueString(ct))?ct=parseFloat(ct):!findValueType(ct)&&complex.test(at)&&(ct=getAnimatableNone(ot,at)),_.addValue(ot,motionValue(ct)),(tt=(rt=$)[ot])!==null&&tt!==void 0||(rt[ot]=ct),_.setBaseTarget(ot,ct))}}function getOriginFromTransition(_,o){if(o){var $=o[_]||o.default||o;return $.from}}function getOrigin(_,o,$){var j,et,tt={};for(var rt in _)tt[rt]=(j=getOriginFromTransition(rt,o))!==null&&j!==void 0?j:(et=$.getValue(rt))===null||et===void 0?void 0:et.get();return tt}function animateVisualElement(_,o,$){$===void 0&&($={}),_.notifyAnimationStart(o);var j;if(Array.isArray(o)){var et=o.map(function(rt){return animateVariant(_,rt,$)});j=Promise.all(et)}else if(typeof o=="string")j=animateVariant(_,o,$);else{var tt=typeof o=="function"?resolveVariant(_,o,$.custom):o;j=animateTarget(_,tt,$)}return j.then(function(){return _.notifyAnimationComplete(o)})}function animateVariant(_,o,$){var j;$===void 0&&($={});var et=resolveVariant(_,o,$.custom),tt=(et||{}).transition,rt=tt===void 0?_.getDefaultTransition()||{}:tt;$.transitionOverride&&(rt=$.transitionOverride);var nt=et?function(){return animateTarget(_,et,$)}:function(){return Promise.resolve()},it=!((j=_.variantChildren)===null||j===void 0)&&j.size?function(ut){ut===void 0&&(ut=0);var ft=rt.delayChildren,ht=ft===void 0?0:ft,mt=rt.staggerChildren,gt=rt.staggerDirection;return animateChildren(_,o,ht+ut,mt,gt,$)}:function(){return Promise.resolve()},st=rt.when;if(st){var ot=__read(st==="beforeChildren"?[nt,it]:[it,nt],2),at=ot[0],ct=ot[1];return at().then(ct)}else return Promise.all([nt(),it($.delay)])}function animateTarget(_,o,$){var j,et=$===void 0?{}:$,tt=et.delay,rt=tt===void 0?0:tt,nt=et.transitionOverride,it=et.type,st=_.makeTargetAnimatable(o),ot=st.transition,at=ot===void 0?_.getDefaultTransition():ot,ct=st.transitionEnd,ut=__rest$1(st,["transition","transitionEnd"]);nt&&(at=nt);var ft=[],ht=it&&((j=_.animationState)===null||j===void 0?void 0:j.getState()[it]);for(var mt in ut){var gt=_.getValue(mt),Et=ut[mt];if(!(!gt||Et===void 0||ht&&shouldBlockAnimation(ht,mt))){var St=__assign$1({delay:rt},at);_.shouldReduceMotion&&isTransformProp(mt)&&(St=__assign$1(__assign$1({},St),{type:!1,delay:0}));var At=startAnimation(mt,gt,Et,St);ft.push(At)}}return Promise.all(ft).then(function(){ct&&setTarget(_,ct)})}function animateChildren(_,o,$,j,et,tt){$===void 0&&($=0),j===void 0&&(j=0),et===void 0&&(et=1);var rt=[],nt=(_.variantChildren.size-1)*j,it=et===1?function(st){return st===void 0&&(st=0),st*j}:function(st){return st===void 0&&(st=0),nt-st*j};return Array.from(_.variantChildren).sort(sortByTreeOrder).forEach(function(st,ot){rt.push(animateVariant(st,o,__assign$1(__assign$1({},tt),{delay:$+it(ot)})).then(function(){return st.notifyAnimationComplete(o)}))}),Promise.all(rt)}function sortByTreeOrder(_,o){return _.sortNodePosition(o)}function shouldBlockAnimation(_,o){var $=_.protectedKeys,j=_.needsAnimating,et=$.hasOwnProperty(o)&&j[o]!==!0;return j[o]=!1,et}var variantPriorityOrder=[AnimationType.Animate,AnimationType.InView,AnimationType.Focus,AnimationType.Hover,AnimationType.Tap,AnimationType.Drag,AnimationType.Exit],reversePriorityOrder=__spreadArray$1([],__read(variantPriorityOrder),!1).reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(_){return function(o){return Promise.all(o.map(function($){var j=$.animation,et=$.options;return animateVisualElement(_,j,et)}))}}function createAnimationState(_){var o=animateList(_),$=createState$2(),j={},et=!0,tt=function(ot,at){var ct=resolveVariant(_,at);if(ct){ct.transition;var ut=ct.transitionEnd,ft=__rest$1(ct,["transition","transitionEnd"]);ot=__assign$1(__assign$1(__assign$1({},ot),ft),ut)}return ot};function rt(ot){return j[ot]!==void 0}function nt(ot){o=ot(_)}function it(ot,at){for(var ct,ut=_.getProps(),ft=_.getVariantContext(!0)||{},ht=[],mt=new Set,gt={},Et=1/0,St=function(Tt){var Dt=reversePriorityOrder[Tt],Ot=$[Dt],jt=(ct=ut[Dt])!==null&&ct!==void 0?ct:ft[Dt],Nt=isVariantLabel(jt),It=Dt===at?Ot.isActive:null;It===!1&&(Et=Tt);var yt=jt===ft[Dt]&&jt!==ut[Dt]&&Nt;if(yt&&et&&_.manuallyAnimateOnMount&&(yt=!1),Ot.protectedKeys=__assign$1({},gt),!Ot.isActive&&It===null||!jt&&!Ot.prevProp||isAnimationControls(jt)||typeof jt=="boolean")return"continue";var lt=checkVariantsDidChange(Ot.prevProp,jt),pt=lt||Dt===at&&Ot.isActive&&!yt&&Nt||Tt>Et&&Nt,bt=Array.isArray(jt)?jt:[jt],_t=bt.reduce(tt,{});It===!1&&(_t={});var $t=Ot.prevResolvedValues,Ct=$t===void 0?{}:$t,xt=__assign$1(__assign$1({},Ct),_t),vt=function(Pt){pt=!0,mt.delete(Pt),Ot.needsAnimating[Pt]=!0};for(var dt in xt){var wt=_t[dt],qt=Ct[dt];gt.hasOwnProperty(dt)||(wt!==qt?isKeyframesTarget(wt)&&isKeyframesTarget(qt)?!shallowCompare(wt,qt)||lt?vt(dt):Ot.protectedKeys[dt]=!0:wt!==void 0?vt(dt):mt.add(dt):wt!==void 0&&mt.has(dt)?vt(dt):Ot.protectedKeys[dt]=!0)}Ot.prevProp=jt,Ot.prevResolvedValues=_t,Ot.isActive&&(gt=__assign$1(__assign$1({},gt),_t)),et&&_.blockInitialAnimation&&(pt=!1),pt&&!yt&&ht.push.apply(ht,__spreadArray$1([],__read(bt.map(function(Pt){return{animation:Pt,options:__assign$1({type:Dt},ot)}})),!1))},At=0;At<numAnimationTypes;At++)St(At);if(j=__assign$1({},gt),mt.size){var kt={};mt.forEach(function(Tt){var Dt=_.getBaseTarget(Tt);Dt!==void 0&&(kt[Tt]=Dt)}),ht.push({animation:kt})}var Rt=!!ht.length;return et&&ut.initial===!1&&!_.manuallyAnimateOnMount&&(Rt=!1),et=!1,Rt?o(ht):Promise.resolve()}function st(ot,at,ct){var ut;if($[ot].isActive===at)return Promise.resolve();(ut=_.variantChildren)===null||ut===void 0||ut.forEach(function(mt){var gt;return(gt=mt.animationState)===null||gt===void 0?void 0:gt.setActive(ot,at)}),$[ot].isActive=at;var ft=it(ct,ot);for(var ht in $)$[ht].protectedKeys={};return ft}return{isAnimated:rt,animateChanges:it,setActive:st,setAnimateFunction:nt,getState:function(){return $}}}function checkVariantsDidChange(_,o){return typeof o=="string"?o!==_:isVariantLabels(o)?!shallowCompare(o,_):!1}function createTypeState(_){return _===void 0&&(_=!1),{isActive:_,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState$2(){var _;return _={},_[AnimationType.Animate]=createTypeState(!0),_[AnimationType.InView]=createTypeState(),_[AnimationType.Hover]=createTypeState(),_[AnimationType.Tap]=createTypeState(),_[AnimationType.Drag]=createTypeState(),_[AnimationType.Focus]=createTypeState(),_[AnimationType.Exit]=createTypeState(),_}var animations={animation:makeRenderlessComponent(function(_){var o=_.visualElement,$=_.animate;o.animationState||(o.animationState=createAnimationState(o)),isAnimationControls($)&&reactExports.useEffect(function(){return $.subscribe(o)},[$])}),exit:makeRenderlessComponent(function(_){var o=_.custom,$=_.visualElement,j=__read(usePresence(),2),et=j[0],tt=j[1],rt=reactExports.useContext(PresenceContext);reactExports.useEffect(function(){var nt,it;$.isPresent=et;var st=(nt=$.animationState)===null||nt===void 0?void 0:nt.setActive(AnimationType.Exit,!et,{custom:(it=rt==null?void 0:rt.custom)!==null&&it!==void 0?it:o});!et&&(st==null||st.then(tt))},[et])})},PanSession=function(){function _(o,$,j){var et=this,tt=j===void 0?{}:j,rt=tt.transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(et.lastMoveEvent&&et.lastMoveEventInfo){var ct=getPanInfo(et.lastMoveEventInfo,et.history),ut=et.startEvent!==null,ft=distance(ct.offset,{x:0,y:0})>=3;if(!(!ut&&!ft)){var ht=ct.point,mt=getFrameData().timestamp;et.history.push(__assign$1(__assign$1({},ht),{timestamp:mt}));var gt=et.handlers,Et=gt.onStart,St=gt.onMove;ut||(Et&&Et(et.lastMoveEvent,ct),et.startEvent=et.lastMoveEvent),St&&St(et.lastMoveEvent,ct)}}},this.handlePointerMove=function(ct,ut){if(et.lastMoveEvent=ct,et.lastMoveEventInfo=transformPoint(ut,et.transformPagePoint),isMouseEvent(ct)&&ct.buttons===0){et.handlePointerUp(ct,ut);return}sync.update(et.updatePoint,!0)},this.handlePointerUp=function(ct,ut){et.end();var ft=et.handlers,ht=ft.onEnd,mt=ft.onSessionEnd,gt=getPanInfo(transformPoint(ut,et.transformPagePoint),et.history);et.startEvent&&ht&&ht(ct,gt),mt&&mt(ct,gt)},!(isTouchEvent(o)&&o.touches.length>1)){this.handlers=$,this.transformPagePoint=rt;var nt=extractEventInfo(o),it=transformPoint(nt,this.transformPagePoint),st=it.point,ot=getFrameData().timestamp;this.history=[__assign$1(__assign$1({},st),{timestamp:ot})];var at=$.onSessionStart;at&&at(o,getPanInfo(it,this.history)),this.removeListeners=pipe$1(addPointerEvent(window,"pointermove",this.handlePointerMove),addPointerEvent(window,"pointerup",this.handlePointerUp),addPointerEvent(window,"pointercancel",this.handlePointerUp))}}return _.prototype.updateHandlers=function(o){this.handlers=o},_.prototype.end=function(){this.removeListeners&&this.removeListeners(),cancelSync.update(this.updatePoint)},_}();function transformPoint(_,o){return o?{point:o(_.point)}:_}function subtractPoint(_,o){return{x:_.x-o.x,y:_.y-o.y}}function getPanInfo(_,o){var $=_.point;return{point:$,delta:subtractPoint($,lastDevicePoint(o)),offset:subtractPoint($,startDevicePoint(o)),velocity:getVelocity(o,.1)}}function startDevicePoint(_){return _[0]}function lastDevicePoint(_){return _[_.length-1]}function getVelocity(_,o){if(_.length<2)return{x:0,y:0};for(var $=_.length-1,j=null,et=lastDevicePoint(_);$>=0&&(j=_[$],!(et.timestamp-j.timestamp>secondsToMilliseconds(o)));)$--;if(!j)return{x:0,y:0};var tt=(et.timestamp-j.timestamp)/1e3;if(tt===0)return{x:0,y:0};var rt={x:(et.x-j.x)/tt,y:(et.y-j.y)/tt};return rt.x===1/0&&(rt.x=0),rt.y===1/0&&(rt.y=0),rt}function calcLength(_){return _.max-_.min}function isNear(_,o,$){return o===void 0&&(o=0),$===void 0&&($=.01),distance(_,o)<$}function calcAxisDelta(_,o,$,j){j===void 0&&(j=.5),_.origin=j,_.originPoint=mix$1(o.min,o.max,_.origin),_.scale=calcLength($)/calcLength(o),(isNear(_.scale,1,1e-4)||isNaN(_.scale))&&(_.scale=1),_.translate=mix$1($.min,$.max,_.origin)-_.originPoint,(isNear(_.translate)||isNaN(_.translate))&&(_.translate=0)}function calcBoxDelta(_,o,$,j){calcAxisDelta(_.x,o.x,$.x,j==null?void 0:j.originX),calcAxisDelta(_.y,o.y,$.y,j==null?void 0:j.originY)}function calcRelativeAxis(_,o,$){_.min=$.min+o.min,_.max=_.min+calcLength(o)}function calcRelativeBox(_,o,$){calcRelativeAxis(_.x,o.x,$.x),calcRelativeAxis(_.y,o.y,$.y)}function calcRelativeAxisPosition(_,o,$){_.min=o.min-$.min,_.max=_.min+calcLength(o)}function calcRelativePosition(_,o,$){calcRelativeAxisPosition(_.x,o.x,$.x),calcRelativeAxisPosition(_.y,o.y,$.y)}function applyConstraints(_,o,$){var j=o.min,et=o.max;return j!==void 0&&_<j?_=$?mix$1(j,_,$.min):Math.max(_,j):et!==void 0&&_>et&&(_=$?mix$1(et,_,$.max):Math.min(_,et)),_}function calcRelativeAxisConstraints(_,o,$){return{min:o!==void 0?_.min+o:void 0,max:$!==void 0?_.max+$-(_.max-_.min):void 0}}function calcRelativeConstraints(_,o){var $=o.top,j=o.left,et=o.bottom,tt=o.right;return{x:calcRelativeAxisConstraints(_.x,j,tt),y:calcRelativeAxisConstraints(_.y,$,et)}}function calcViewportAxisConstraints(_,o){var $,j=o.min-_.min,et=o.max-_.max;return o.max-o.min<_.max-_.min&&($=__read([et,j],2),j=$[0],et=$[1]),{min:j,max:et}}function calcViewportConstraints(_,o){return{x:calcViewportAxisConstraints(_.x,o.x),y:calcViewportAxisConstraints(_.y,o.y)}}function calcOrigin(_,o){var $=.5,j=calcLength(_),et=calcLength(o);return et>j?$=progress(o.min,o.max-j,_.min):j>et&&($=progress(_.min,_.max-et,o.min)),clamp(0,1,$)}function rebaseAxisConstraints(_,o){var $={};return o.min!==void 0&&($.min=o.min-_.min),o.max!==void 0&&($.max=o.max-_.min),$}var defaultElastic=.35;function resolveDragElastic(_){return _===void 0&&(_=defaultElastic),_===!1?_=0:_===!0&&(_=defaultElastic),{x:resolveAxisElastic(_,"left","right"),y:resolveAxisElastic(_,"top","bottom")}}function resolveAxisElastic(_,o,$){return{min:resolvePointElastic(_,o),max:resolvePointElastic(_,$)}}function resolvePointElastic(_,o){var $;return typeof _=="number"?_:($=_[o])!==null&&$!==void 0?$:0}var createAxisDelta=function(){return{translate:0,scale:1,origin:0,originPoint:0}},createDelta=function(){return{x:createAxisDelta(),y:createAxisDelta()}},createAxis=function(){return{min:0,max:0}},createBox=function(){return{x:createAxis(),y:createAxis()}};function eachAxis(_){return[_("x"),_("y")]}function convertBoundingBoxToBox(_){var o=_.top,$=_.left,j=_.right,et=_.bottom;return{x:{min:$,max:j},y:{min:o,max:et}}}function convertBoxToBoundingBox(_){var o=_.x,$=_.y;return{top:$.min,right:o.max,bottom:$.max,left:o.min}}function transformBoxPoints(_,o){if(!o)return _;var $=o({x:_.left,y:_.top}),j=o({x:_.right,y:_.bottom});return{top:$.y,left:$.x,bottom:j.y,right:j.x}}function isIdentityScale(_){return _===void 0||_===1}function hasScale(_){var o=_.scale,$=_.scaleX,j=_.scaleY;return!isIdentityScale(o)||!isIdentityScale($)||!isIdentityScale(j)}function hasTransform(_){return hasScale(_)||hasTranslate(_.x)||hasTranslate(_.y)||_.z||_.rotate||_.rotateX||_.rotateY}function hasTranslate(_){return _&&_!=="0%"}function scalePoint(_,o,$){var j=_-$,et=o*j;return $+et}function applyPointDelta(_,o,$,j,et){return et!==void 0&&(_=scalePoint(_,et,j)),scalePoint(_,$,j)+o}function applyAxisDelta(_,o,$,j,et){o===void 0&&(o=0),$===void 0&&($=1),_.min=applyPointDelta(_.min,o,$,j,et),_.max=applyPointDelta(_.max,o,$,j,et)}function applyBoxDelta(_,o){var $=o.x,j=o.y;applyAxisDelta(_.x,$.translate,$.scale,$.originPoint),applyAxisDelta(_.y,j.translate,j.scale,j.originPoint)}function applyTreeDeltas(_,o,$,j){var et,tt;j===void 0&&(j=!1);var rt=$.length;if(rt){o.x=o.y=1;for(var nt,it,st=0;st<rt;st++)nt=$[st],it=nt.projectionDelta,((tt=(et=nt.instance)===null||et===void 0?void 0:et.style)===null||tt===void 0?void 0:tt.display)!=="contents"&&(j&&nt.options.layoutScroll&&nt.scroll&&nt!==nt.root&&transformBox(_,{x:-nt.scroll.x,y:-nt.scroll.y}),it&&(o.x*=it.x.scale,o.y*=it.y.scale,applyBoxDelta(_,it)),j&&hasTransform(nt.latestValues)&&transformBox(_,nt.latestValues))}}function translateAxis(_,o){_.min=_.min+o,_.max=_.max+o}function transformAxis(_,o,$){var j=__read($,3),et=j[0],tt=j[1],rt=j[2],nt=o[rt]!==void 0?o[rt]:.5,it=mix$1(_.min,_.max,nt);applyAxisDelta(_,o[et],o[tt],it,o.scale)}var xKeys$1=["x","scaleX","originX"],yKeys$1=["y","scaleY","originY"];function transformBox(_,o){transformAxis(_.x,o,xKeys$1),transformAxis(_.y,o,yKeys$1)}function measureViewportBox(_,o){return convertBoundingBoxToBox(transformBoxPoints(_.getBoundingClientRect(),o))}function measurePageBox(_,o,$){var j=measureViewportBox(_,$),et=o.scroll;return et&&(translateAxis(j.x,et.x),translateAxis(j.y,et.y)),j}var elementDragControls=new WeakMap,VisualElementDragControls=function(){function _(o){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=o}return _.prototype.start=function(o,$){var j=this,et=$===void 0?{}:$,tt=et.snapToCursor,rt=tt===void 0?!1:tt;if(this.visualElement.isPresent!==!1){var nt=function(at){j.stopAnimation(),rt&&j.snapToCursor(extractEventInfo(at,"page").point)},it=function(at,ct){var ut,ft=j.getProps(),ht=ft.drag,mt=ft.dragPropagation,gt=ft.onDragStart;ht&&!mt&&(j.openGlobalLock&&j.openGlobalLock(),j.openGlobalLock=getGlobalLock(ht),!j.openGlobalLock)||(j.isDragging=!0,j.currentDirection=null,j.resolveConstraints(),j.visualElement.projection&&(j.visualElement.projection.isAnimationBlocked=!0,j.visualElement.projection.target=void 0),eachAxis(function(Et){var St,At,kt=j.getAxisMotionValue(Et).get()||0;if(percent.test(kt)){var Rt=(At=(St=j.visualElement.projection)===null||St===void 0?void 0:St.layout)===null||At===void 0?void 0:At.actual[Et];if(Rt){var Tt=calcLength(Rt);kt=Tt*(parseFloat(kt)/100)}}j.originPoint[Et]=kt}),gt==null||gt(at,ct),(ut=j.visualElement.animationState)===null||ut===void 0||ut.setActive(AnimationType.Drag,!0))},st=function(at,ct){var ut=j.getProps(),ft=ut.dragPropagation,ht=ut.dragDirectionLock,mt=ut.onDirectionLock,gt=ut.onDrag;if(!(!ft&&!j.openGlobalLock)){var Et=ct.offset;if(ht&&j.currentDirection===null){j.currentDirection=getCurrentDirection(Et),j.currentDirection!==null&&(mt==null||mt(j.currentDirection));return}j.updateAxis("x",ct.point,Et),j.updateAxis("y",ct.point,Et),j.visualElement.syncRender(),gt==null||gt(at,ct)}},ot=function(at,ct){return j.stop(at,ct)};this.panSession=new PanSession(o,{onSessionStart:nt,onStart:it,onMove:st,onSessionEnd:ot},{transformPagePoint:this.visualElement.getTransformPagePoint()})}},_.prototype.stop=function(o,$){var j=this.isDragging;if(this.cancel(),!!j){var et=$.velocity;this.startAnimation(et);var tt=this.getProps().onDragEnd;tt==null||tt(o,$)}},_.prototype.cancel=function(){var o,$;this.isDragging=!1,this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!1),(o=this.panSession)===null||o===void 0||o.end(),this.panSession=void 0;var j=this.getProps().dragPropagation;!j&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),($=this.visualElement.animationState)===null||$===void 0||$.setActive(AnimationType.Drag,!1)},_.prototype.updateAxis=function(o,$,j){var et=this.getProps().drag;if(!(!j||!shouldDrag(o,et,this.currentDirection))){var tt=this.getAxisMotionValue(o),rt=this.originPoint[o]+j[o];this.constraints&&this.constraints[o]&&(rt=applyConstraints(rt,this.constraints[o],this.elastic[o])),tt.set(rt)}},_.prototype.resolveConstraints=function(){var o=this,$=this.getProps(),j=$.dragConstraints,et=$.dragElastic,tt=(this.visualElement.projection||{}).layout,rt=this.constraints;j&&isRefObject(j)?this.constraints||(this.constraints=this.resolveRefConstraints()):j&&tt?this.constraints=calcRelativeConstraints(tt.actual,j):this.constraints=!1,this.elastic=resolveDragElastic(et),rt!==this.constraints&&tt&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(function(nt){o.getAxisMotionValue(nt)&&(o.constraints[nt]=rebaseAxisConstraints(tt.actual[nt],o.constraints[nt]))})},_.prototype.resolveRefConstraints=function(){var o=this.getProps(),$=o.dragConstraints,j=o.onMeasureDragConstraints;if(!$||!isRefObject($))return!1;var et=$.current,tt=this.visualElement.projection;if(!tt||!tt.layout)return!1;var rt=measurePageBox(et,tt.root,this.visualElement.getTransformPagePoint()),nt=calcViewportConstraints(tt.layout.actual,rt);if(j){var it=j(convertBoxToBoundingBox(nt));this.hasMutatedConstraints=!!it,it&&(nt=convertBoundingBoxToBox(it))}return nt},_.prototype.startAnimation=function(o){var $=this,j=this.getProps(),et=j.drag,tt=j.dragMomentum,rt=j.dragElastic,nt=j.dragTransition,it=j.dragSnapToOrigin,st=j.onDragTransitionEnd,ot=this.constraints||{},at=eachAxis(function(ct){var ut;if(shouldDrag(ct,et,$.currentDirection)){var ft=(ut=ot==null?void 0:ot[ct])!==null&&ut!==void 0?ut:{};it&&(ft={min:0,max:0});var ht=rt?200:1e6,mt=rt?40:1e7,gt=__assign$1(__assign$1({type:"inertia",velocity:tt?o[ct]:0,bounceStiffness:ht,bounceDamping:mt,timeConstant:750,restDelta:1,restSpeed:10},nt),ft);return $.startAxisValueAnimation(ct,gt)}});return Promise.all(at).then(st)},_.prototype.startAxisValueAnimation=function(o,$){var j=this.getAxisMotionValue(o);return startAnimation(o,j,0,$)},_.prototype.stopAnimation=function(){var o=this;eachAxis(function($){return o.getAxisMotionValue($).stop()})},_.prototype.getAxisMotionValue=function(o){var $,j,et="_drag"+o.toUpperCase(),tt=this.visualElement.getProps()[et];return tt||this.visualElement.getValue(o,(j=($=this.visualElement.getProps().initial)===null||$===void 0?void 0:$[o])!==null&&j!==void 0?j:0)},_.prototype.snapToCursor=function(o){var $=this;eachAxis(function(j){var et=$.getProps().drag;if(shouldDrag(j,et,$.currentDirection)){var tt=$.visualElement.projection,rt=$.getAxisMotionValue(j);if(tt&&tt.layout){var nt=tt.layout.actual[j],it=nt.min,st=nt.max;rt.set(o[j]-mix$1(it,st,.5))}}})},_.prototype.scalePositionWithinConstraints=function(){var o=this,$,j=this.getProps(),et=j.drag,tt=j.dragConstraints,rt=this.visualElement.projection;if(!(!isRefObject(tt)||!rt||!this.constraints)){this.stopAnimation();var nt={x:0,y:0};eachAxis(function(st){var ot=o.getAxisMotionValue(st);if(ot){var at=ot.get();nt[st]=calcOrigin({min:at,max:at},o.constraints[st])}});var it=this.visualElement.getProps().transformTemplate;this.visualElement.getInstance().style.transform=it?it({},""):"none",($=rt.root)===null||$===void 0||$.updateScroll(),rt.updateLayout(),this.resolveConstraints(),eachAxis(function(st){if(shouldDrag(st,et,null)){var ot=o.getAxisMotionValue(st),at=o.constraints[st],ct=at.min,ut=at.max;ot.set(mix$1(ct,ut,nt[st]))}})}},_.prototype.addListeners=function(){var o=this,$;elementDragControls.set(this.visualElement,this);var j=this.visualElement.getInstance(),et=addPointerEvent(j,"pointerdown",function(st){var ot=o.getProps(),at=ot.drag,ct=ot.dragListener,ut=ct===void 0?!0:ct;at&&ut&&o.start(st)}),tt=function(){var st=o.getProps().dragConstraints;isRefObject(st)&&(o.constraints=o.resolveRefConstraints())},rt=this.visualElement.projection,nt=rt.addEventListener("measure",tt);rt&&!rt.layout&&(($=rt.root)===null||$===void 0||$.updateScroll(),rt.updateLayout()),tt();var it=addDomEvent(window,"resize",function(){return o.scalePositionWithinConstraints()});return rt.addEventListener("didUpdate",function(st){var ot=st.delta,at=st.hasLayoutChanged;o.isDragging&&at&&(eachAxis(function(ct){var ut=o.getAxisMotionValue(ct);ut&&(o.originPoint[ct]+=ot[ct].translate,ut.set(ut.get()+ot[ct].translate))}),o.visualElement.syncRender())}),function(){it(),et(),nt()}},_.prototype.getProps=function(){var o=this.visualElement.getProps(),$=o.drag,j=$===void 0?!1:$,et=o.dragDirectionLock,tt=et===void 0?!1:et,rt=o.dragPropagation,nt=rt===void 0?!1:rt,it=o.dragConstraints,st=it===void 0?!1:it,ot=o.dragElastic,at=ot===void 0?defaultElastic:ot,ct=o.dragMomentum,ut=ct===void 0?!0:ct;return __assign$1(__assign$1({},o),{drag:j,dragDirectionLock:tt,dragPropagation:nt,dragConstraints:st,dragElastic:at,dragMomentum:ut})},_}();function shouldDrag(_,o,$){return(o===!0||o===_)&&($===null||$===_)}function getCurrentDirection(_,o){o===void 0&&(o=10);var $=null;return Math.abs(_.y)>o?$="y":Math.abs(_.x)>o&&($="x"),$}function useDrag(_){var o=_.dragControls,$=_.visualElement,j=useConstant(function(){return new VisualElementDragControls($)});reactExports.useEffect(function(){return o&&o.subscribe(j)},[j,o]),reactExports.useEffect(function(){return j.addListeners()},[j])}function usePanGesture(_){var o=_.onPan,$=_.onPanStart,j=_.onPanEnd,et=_.onPanSessionStart,tt=_.visualElement,rt=o||$||j||et,nt=reactExports.useRef(null),it=reactExports.useContext(MotionConfigContext).transformPagePoint,st={onSessionStart:et,onStart:$,onMove:o,onEnd:function(at,ct){nt.current=null,j&&j(at,ct)}};reactExports.useEffect(function(){nt.current!==null&&nt.current.updateHandlers(st)});function ot(at){nt.current=new PanSession(at,st,{transformPagePoint:it})}usePointerEvent(tt,"pointerdown",rt&&ot),useUnmountEffect(function(){return nt.current&&nt.current.end()})}var drag={pan:makeRenderlessComponent(usePanGesture),drag:makeRenderlessComponent(useDrag)},names$4=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","LayoutAnimationStart","SetAxisTarget","Unmount"];function createLifecycles(){var _=names$4.map(function(){return new SubscriptionManager}),o={},$={clearAllListeners:function(){return _.forEach(function(j){return j.clear()})},updatePropListeners:function(j){names$4.forEach(function(et){var tt,rt="on"+et,nt=j[rt];(tt=o[et])===null||tt===void 0||tt.call(o),nt&&(o[et]=$[rt](nt))})}};return _.forEach(function(j,et){$["on"+names$4[et]]=function(tt){return j.add(tt)},$["notify"+names$4[et]]=function(){for(var tt=[],rt=0;rt<arguments.length;rt++)tt[rt]=arguments[rt];return j.notify.apply(j,__spreadArray$1([],__read(tt),!1))}}),$}function updateMotionValuesFromProps(_,o,$){var j;for(var et in o){var tt=o[et],rt=$[et];if(isMotionValue(tt))_.addValue(et,tt);else if(isMotionValue(rt))_.addValue(et,motionValue(tt));else if(rt!==tt)if(_.hasValue(et)){var nt=_.getValue(et);!nt.hasAnimated&&nt.set(tt)}else _.addValue(et,motionValue((j=_.getStaticValue(et))!==null&&j!==void 0?j:tt))}for(var et in $)o[et]===void 0&&_.removeValue(et);return o}var visualElement=function(_){var o=_.treeType,$=o===void 0?"":o,j=_.build,et=_.getBaseTarget,tt=_.makeTargetAnimatable,rt=_.measureViewportBox,nt=_.render,it=_.readValueFromInstance,st=_.removeValueFromRenderState,ot=_.sortNodePosition,at=_.scrapeMotionValuesFromProps;return function(ct,ut){var ft=ct.parent,ht=ct.props,mt=ct.presenceId,gt=ct.blockInitialAnimation,Et=ct.visualState,St=ct.shouldReduceMotion;ut===void 0&&(ut={});var At=!1,kt=Et.latestValues,Rt=Et.renderState,Tt,Dt=createLifecycles(),Ot=new Map,jt=new Map,Nt={},It=__assign$1({},kt),yt;function lt(){!Tt||!At||(pt(),nt(Tt,Rt,ht.style,wt.projection))}function pt(){j(wt,Rt,kt,ut,ht)}function bt(){Dt.notifyUpdate(kt)}function _t(qt,Pt){var Gt=Pt.onChange(function(Vt){kt[qt]=Vt,ht.onUpdate&&sync.update(bt,!1,!0)}),Wt=Pt.onRenderRequest(wt.scheduleRender);jt.set(qt,function(){Gt(),Wt()})}var $t=at(ht);for(var Ct in $t){var xt=$t[Ct];kt[Ct]!==void 0&&isMotionValue(xt)&&xt.set(kt[Ct],!1)}var vt=checkIfControllingVariants(ht),dt=checkIfVariantNode(ht),wt=__assign$1(__assign$1({treeType:$,current:null,depth:ft?ft.depth+1:0,parent:ft,children:new Set,presenceId:mt,shouldReduceMotion:St,variantChildren:dt?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:!!(ft!=null&&ft.isMounted()),blockInitialAnimation:gt,isMounted:function(){return!!Tt},mount:function(qt){At=!0,Tt=wt.current=qt,wt.projection&&wt.projection.mount(qt),dt&&ft&&!vt&&(yt=ft==null?void 0:ft.addVariantChild(wt)),Ot.forEach(function(Pt,Gt){return _t(Gt,Pt)}),ft==null||ft.children.add(wt),wt.setProps(ht)},unmount:function(){var qt;(qt=wt.projection)===null||qt===void 0||qt.unmount(),cancelSync.update(bt),cancelSync.render(lt),jt.forEach(function(Pt){return Pt()}),yt==null||yt(),ft==null||ft.children.delete(wt),Dt.clearAllListeners(),Tt=void 0,At=!1},addVariantChild:function(qt){var Pt,Gt=wt.getClosestVariantNode();if(Gt)return(Pt=Gt.variantChildren)===null||Pt===void 0||Pt.add(qt),function(){return Gt.variantChildren.delete(qt)}},sortNodePosition:function(qt){return!ot||$!==qt.treeType?0:ot(wt.getInstance(),qt.getInstance())},getClosestVariantNode:function(){return dt?wt:ft==null?void 0:ft.getClosestVariantNode()},getLayoutId:function(){return ht.layoutId},getInstance:function(){return Tt},getStaticValue:function(qt){return kt[qt]},setStaticValue:function(qt,Pt){return kt[qt]=Pt},getLatestValues:function(){return kt},setVisibility:function(qt){wt.isVisible!==qt&&(wt.isVisible=qt,wt.scheduleRender())},makeTargetAnimatable:function(qt,Pt){return Pt===void 0&&(Pt=!0),tt(wt,qt,ht,Pt)},measureViewportBox:function(){return rt(Tt,ht)},addValue:function(qt,Pt){wt.hasValue(qt)&&wt.removeValue(qt),Ot.set(qt,Pt),kt[qt]=Pt.get(),_t(qt,Pt)},removeValue:function(qt){var Pt;Ot.delete(qt),(Pt=jt.get(qt))===null||Pt===void 0||Pt(),jt.delete(qt),delete kt[qt],st(qt,Rt)},hasValue:function(qt){return Ot.has(qt)},getValue:function(qt,Pt){var Gt=Ot.get(qt);return Gt===void 0&&Pt!==void 0&&(Gt=motionValue(Pt),wt.addValue(qt,Gt)),Gt},forEachValue:function(qt){return Ot.forEach(qt)},readValue:function(qt){var Pt;return(Pt=kt[qt])!==null&&Pt!==void 0?Pt:it(Tt,qt,ut)},setBaseTarget:function(qt,Pt){It[qt]=Pt},getBaseTarget:function(qt){if(et){var Pt=et(ht,qt);if(Pt!==void 0&&!isMotionValue(Pt))return Pt}return It[qt]}},Dt),{build:function(){return pt(),Rt},scheduleRender:function(){sync.render(lt,!1,!0)},syncRender:lt,setProps:function(qt){(qt.transformTemplate||ht.transformTemplate)&&wt.scheduleRender(),ht=qt,Dt.updatePropListeners(qt),Nt=updateMotionValuesFromProps(wt,at(ht),Nt)},getProps:function(){return ht},getVariant:function(qt){var Pt;return(Pt=ht.variants)===null||Pt===void 0?void 0:Pt[qt]},getDefaultTransition:function(){return ht.transition},getTransformPagePoint:function(){return ht.transformPagePoint},getVariantContext:function(qt){if(qt===void 0&&(qt=!1),qt)return ft==null?void 0:ft.getVariantContext();if(!vt){var Pt=(ft==null?void 0:ft.getVariantContext())||{};return ht.initial!==void 0&&(Pt.initial=ht.initial),Pt}for(var Gt={},Wt=0;Wt<numVariantProps;Wt++){var Vt=variantProps[Wt],Ut=ht[Vt];(isVariantLabel(Ut)||Ut===!1)&&(Gt[Vt]=Ut)}return Gt}});return wt}},variantProps=__spreadArray$1(["initial"],__read(variantPriorityOrder),!1),numVariantProps=variantProps.length;function isCSSVariable(_){return typeof _=="string"&&_.startsWith("var(--")}var cssVariableRegex=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function parseCSSVariable(_){var o=cssVariableRegex.exec(_);if(!o)return[,];var $=__read(o,3),j=$[1],et=$[2];return[j,et]}function getVariableValue(_,o,$){var j=__read(parseCSSVariable(_),2),et=j[0],tt=j[1];if(et){var rt=window.getComputedStyle(o).getPropertyValue(et);return rt?rt.trim():isCSSVariable(tt)?getVariableValue(tt,o):tt}}function resolveCSSVariables(_,o,$){var j,et=__rest$1(o,[]),tt=_.getInstance();if(!(tt instanceof Element))return{target:et,transitionEnd:$};$&&($=__assign$1({},$)),_.forEachValue(function(st){var ot=st.get();if(isCSSVariable(ot)){var at=getVariableValue(ot,tt);at&&st.set(at)}});for(var rt in et){var nt=et[rt];if(isCSSVariable(nt)){var it=getVariableValue(nt,tt);it&&(et[rt]=it,$&&((j=$[rt])!==null&&j!==void 0||($[rt]=nt)))}}return{target:et,transitionEnd:$}}var positionalKeys=new Set(["width","height","top","left","right","bottom","x","y"]),isPositionalKey=function(_){return positionalKeys.has(_)},hasPositionalKey=function(_){return Object.keys(_).some(isPositionalKey)},setAndResetVelocity=function(_,o){_.set(o,!1),_.set(o)},isNumOrPxType=function(_){return _===number||_===px},BoundingBoxDimension;(function(_){_.width="width",_.height="height",_.left="left",_.right="right",_.top="top",_.bottom="bottom"})(BoundingBoxDimension||(BoundingBoxDimension={}));var getPosFromMatrix=function(_,o){return parseFloat(_.split(", ")[o])},getTranslateFromMatrix=function(_,o){return function($,j){var et=j.transform;if(et==="none"||!et)return 0;var tt=et.match(/^matrix3d\((.+)\)$/);if(tt)return getPosFromMatrix(tt[1],o);var rt=et.match(/^matrix\((.+)\)$/);return rt?getPosFromMatrix(rt[1],_):0}},transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformProps.filter(function(_){return!transformKeys.has(_)});function removeNonTranslationalTransform(_){var o=[];return nonTranslationalTransformKeys.forEach(function($){var j=_.getValue($);j!==void 0&&(o.push([$,j.get()]),j.set($.startsWith("scale")?1:0))}),o.length&&_.syncRender(),o}var positionalValues={width:function(_,o){var $=_.x,j=o.paddingLeft,et=j===void 0?"0":j,tt=o.paddingRight,rt=tt===void 0?"0":tt;return $.max-$.min-parseFloat(et)-parseFloat(rt)},height:function(_,o){var $=_.y,j=o.paddingTop,et=j===void 0?"0":j,tt=o.paddingBottom,rt=tt===void 0?"0":tt;return $.max-$.min-parseFloat(et)-parseFloat(rt)},top:function(_,o){var $=o.top;return parseFloat($)},left:function(_,o){var $=o.left;return parseFloat($)},bottom:function(_,o){var $=_.y,j=o.top;return parseFloat(j)+($.max-$.min)},right:function(_,o){var $=_.x,j=o.left;return parseFloat(j)+($.max-$.min)},x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)},convertChangedValueTypes=function(_,o,$){var j=o.measureViewportBox(),et=o.getInstance(),tt=getComputedStyle(et),rt=tt.display,nt={};rt==="none"&&o.setStaticValue("display",_.display||"block"),$.forEach(function(st){nt[st]=positionalValues[st](j,tt)}),o.syncRender();var it=o.measureViewportBox();return $.forEach(function(st){var ot=o.getValue(st);setAndResetVelocity(ot,nt[st]),_[st]=positionalValues[st](it,tt)}),_},checkAndConvertChangedValueTypes=function(_,o,$,j){$===void 0&&($={}),j===void 0&&(j={}),o=__assign$1({},o),j=__assign$1({},j);var et=Object.keys(o).filter(isPositionalKey),tt=[],rt=!1,nt=[];if(et.forEach(function(ot){var at=_.getValue(ot);if(_.hasValue(ot)){var ct=$[ot],ut=findDimensionValueType(ct),ft=o[ot],ht;if(isKeyframesTarget(ft)){var mt=ft.length,gt=ft[0]===null?1:0;ct=ft[gt],ut=findDimensionValueType(ct);for(var Et=gt;Et<mt;Et++)ht?invariant(findDimensionValueType(ft[Et])===ht):ht=findDimensionValueType(ft[Et])}else ht=findDimensionValueType(ft);if(ut!==ht)if(isNumOrPxType(ut)&&isNumOrPxType(ht)){var St=at.get();typeof St=="string"&&at.set(parseFloat(St)),typeof ft=="string"?o[ot]=parseFloat(ft):Array.isArray(ft)&&ht===px&&(o[ot]=ft.map(parseFloat))}else ut!=null&&ut.transform&&(ht!=null&&ht.transform)&&(ct===0||ft===0)?ct===0?at.set(ht.transform(ct)):o[ot]=ut.transform(ft):(rt||(tt=removeNonTranslationalTransform(_),rt=!0),nt.push(ot),j[ot]=j[ot]!==void 0?j[ot]:o[ot],setAndResetVelocity(at,ft))}}),nt.length){var it=nt.indexOf("height")>=0?window.pageYOffset:null,st=convertChangedValueTypes(o,_,nt);return tt.length&&tt.forEach(function(ot){var at=__read(ot,2),ct=at[0],ut=at[1];_.getValue(ct).set(ut)}),_.syncRender(),it!==null&&window.scrollTo({top:it}),{target:st,transitionEnd:j}}else return{target:o,transitionEnd:j}};function unitConversion(_,o,$,j){return hasPositionalKey(o)?checkAndConvertChangedValueTypes(_,o,$,j):{target:o,transitionEnd:j}}var parseDomVariant=function(_,o,$,j){var et=resolveCSSVariables(_,o,j);return o=et.target,j=et.transitionEnd,unitConversion(_,o,$,j)};function getComputedStyle$1(_){return window.getComputedStyle(_)}var htmlConfig={treeType:"dom",readValueFromInstance:function(_,o){if(isTransformProp(o)){var $=getDefaultValueType(o);return $&&$.default||0}else{var j=getComputedStyle$1(_);return(isCSSVariable$1(o)?j.getPropertyValue(o):j[o])||0}},sortNodePosition:function(_,o){return _.compareDocumentPosition(o)&2?1:-1},getBaseTarget:function(_,o){var $;return($=_.style)===null||$===void 0?void 0:$[o]},measureViewportBox:function(_,o){var $=o.transformPagePoint;return measureViewportBox(_,$)},resetTransform:function(_,o,$){var j=$.transformTemplate;o.style.transform=j?j({},""):"none",_.scheduleRender()},restoreTransform:function(_,o){_.style.transform=o.style.transform},removeValueFromRenderState:function(_,o){var $=o.vars,j=o.style;delete $[_],delete j[_]},makeTargetAnimatable:function(_,o,$,j){var et=$.transformValues;j===void 0&&(j=!0);var tt=o.transition,rt=o.transitionEnd,nt=__rest$1(o,["transition","transitionEnd"]),it=getOrigin(nt,tt||{},_);if(et&&(rt&&(rt=et(rt)),nt&&(nt=et(nt)),it&&(it=et(it))),j){checkTargetForNewValues(_,nt,it);var st=parseDomVariant(_,nt,it,rt);rt=st.transitionEnd,nt=st.target}return __assign$1({transition:tt,transitionEnd:rt},nt)},scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,build:function(_,o,$,j,et){_.isVisible!==void 0&&(o.style.visibility=_.isVisible?"visible":"hidden"),buildHTMLStyles(o,$,j,et.transformTemplate)},render:renderHTML},htmlVisualElement=visualElement(htmlConfig),svgVisualElement=visualElement(__assign$1(__assign$1({},htmlConfig),{getBaseTarget:function(_,o){return _[o]},readValueFromInstance:function(_,o){var $;return isTransformProp(o)?(($=getDefaultValueType(o))===null||$===void 0?void 0:$.default)||0:(o=camelCaseAttributes.has(o)?o:camelToDash(o),_.getAttribute(o))},scrapeMotionValuesFromProps,build:function(_,o,$,j,et){buildSVGAttrs(o,$,j,et.transformTemplate)},render:renderSVG})),createDomVisualElement=function(_,o){return isSVGComponent(_)?svgVisualElement(o,{enableHardwareAcceleration:!1}):htmlVisualElement(o,{enableHardwareAcceleration:!0})};function pixelsToPercent(_,o){return o.max===o.min?0:_/(o.max-o.min)*100}var correctBorderRadius={correct:function(_,o){if(!o.target)return _;if(typeof _=="string")if(px.test(_))_=parseFloat(_);else return _;var $=pixelsToPercent(_,o.target.x),j=pixelsToPercent(_,o.target.y);return"".concat($,"% ").concat(j,"%")}},varToken="_$css",correctBoxShadow={correct:function(_,o){var $=o.treeScale,j=o.projectionDelta,et=_,tt=_.includes("var("),rt=[];tt&&(_=_.replace(cssVariableRegex,function(ht){return rt.push(ht),varToken}));var nt=complex.parse(_);if(nt.length>5)return et;var it=complex.createTransformer(_),st=typeof nt[0]!="number"?1:0,ot=j.x.scale*$.x,at=j.y.scale*$.y;nt[0+st]/=ot,nt[1+st]/=at;var ct=mix$1(ot,at,.5);typeof nt[2+st]=="number"&&(nt[2+st]/=ct),typeof nt[3+st]=="number"&&(nt[3+st]/=ct);var ut=it(nt);if(tt){var ft=0;ut=ut.replace(varToken,function(){var ht=rt[ft];return ft++,ht})}return ut}},MeasureLayoutWithContext=function(_){__extends(o,_);function o(){return _!==null&&_.apply(this,arguments)||this}return o.prototype.componentDidMount=function(){var $=this,j=this.props,et=j.visualElement,tt=j.layoutGroup,rt=j.switchLayoutGroup,nt=j.layoutId,it=et.projection;addScaleCorrector(defaultScaleCorrectors),it&&(tt!=null&&tt.group&&tt.group.add(it),rt!=null&&rt.register&&nt&&rt.register(it),it.root.didUpdate(),it.addEventListener("animationComplete",function(){$.safeToRemove()}),it.setOptions(__assign$1(__assign$1({},it.options),{onExitComplete:function(){return $.safeToRemove()}}))),globalProjectionState.hasEverUpdated=!0},o.prototype.getSnapshotBeforeUpdate=function($){var j=this,et=this.props,tt=et.layoutDependency,rt=et.visualElement,nt=et.drag,it=et.isPresent,st=rt.projection;return st&&(st.isPresent=it,nt||$.layoutDependency!==tt||tt===void 0?st.willUpdate():this.safeToRemove(),$.isPresent!==it&&(it?st.promote():st.relegate()||sync.postRender(function(){var ot;!((ot=st.getStack())===null||ot===void 0)&&ot.members.length||j.safeToRemove()}))),null},o.prototype.componentDidUpdate=function(){var $=this.props.visualElement.projection;$&&($.root.didUpdate(),!$.currentAnimation&&$.isLead()&&this.safeToRemove())},o.prototype.componentWillUnmount=function(){var $=this.props,j=$.visualElement,et=$.layoutGroup,tt=$.switchLayoutGroup,rt=j.projection;rt&&(rt.scheduleCheckAfterUnmount(),et!=null&&et.group&&et.group.remove(rt),tt!=null&&tt.deregister&&tt.deregister(rt))},o.prototype.safeToRemove=function(){var $=this.props.safeToRemove;$==null||$()},o.prototype.render=function(){return null},o}(React.Component);function MeasureLayout(_){var o=__read(usePresence(),2),$=o[0],j=o[1],et=reactExports.useContext(LayoutGroupContext);return React.createElement(MeasureLayoutWithContext,__assign$1({},_,{layoutGroup:et,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:$,safeToRemove:j}))}var defaultScaleCorrectors={borderRadius:__assign$1(__assign$1({},correctBorderRadius),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow},layoutFeatures={measureLayout:MeasureLayout};function animate(_,o,$){$===void 0&&($={});var j=isMotionValue(_)?_:motionValue(_);return startAnimation("",j,o,$),{stop:function(){return j.stop()},isAnimating:function(){return j.isAnimating()}}}var borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=function(_){return typeof _=="string"?parseFloat(_):_},isPx=function(_){return typeof _=="number"||px.test(_)};function mixValues(_,o,$,j,et,tt){var rt,nt,it,st;et?(_.opacity=mix$1(0,(rt=$.opacity)!==null&&rt!==void 0?rt:1,easeCrossfadeIn(j)),_.opacityExit=mix$1((nt=o.opacity)!==null&&nt!==void 0?nt:1,0,easeCrossfadeOut(j))):tt&&(_.opacity=mix$1((it=o.opacity)!==null&&it!==void 0?it:1,(st=$.opacity)!==null&&st!==void 0?st:1,j));for(var ot=0;ot<numBorders;ot++){var at="border".concat(borders[ot],"Radius"),ct=getRadius(o,at),ut=getRadius($,at);if(!(ct===void 0&&ut===void 0)){ct||(ct=0),ut||(ut=0);var ft=ct===0||ut===0||isPx(ct)===isPx(ut);ft?(_[at]=Math.max(mix$1(asNumber(ct),asNumber(ut),j),0),(percent.test(ut)||percent.test(ct))&&(_[at]+="%")):_[at]=ut}}(o.rotate||$.rotate)&&(_.rotate=mix$1(o.rotate||0,$.rotate||0,j))}function getRadius(_,o){var $;return($=_[o])!==null&&$!==void 0?$:_.borderRadius}var easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,linear);function compress(_,o,$){return function(j){return j<_?0:j>o?1:$(progress(_,o,j))}}function copyAxisInto(_,o){_.min=o.min,_.max=o.max}function copyBoxInto(_,o){copyAxisInto(_.x,o.x),copyAxisInto(_.y,o.y)}function removePointDelta(_,o,$,j,et){return _-=o,_=scalePoint(_,1/$,j),et!==void 0&&(_=scalePoint(_,1/et,j)),_}function removeAxisDelta(_,o,$,j,et,tt,rt){if(o===void 0&&(o=0),$===void 0&&($=1),j===void 0&&(j=.5),tt===void 0&&(tt=_),rt===void 0&&(rt=_),percent.test(o)){o=parseFloat(o);var nt=mix$1(rt.min,rt.max,o/100);o=nt-rt.min}if(typeof o=="number"){var it=mix$1(tt.min,tt.max,j);_===tt&&(it-=o),_.min=removePointDelta(_.min,o,$,it,et),_.max=removePointDelta(_.max,o,$,it,et)}}function removeAxisTransforms(_,o,$,j,et){var tt=__read($,3),rt=tt[0],nt=tt[1],it=tt[2];removeAxisDelta(_,o[rt],o[nt],o[it],o.scale,j,et)}var xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(_,o,$,j){removeAxisTransforms(_.x,o,xKeys,$==null?void 0:$.x,j==null?void 0:j.x),removeAxisTransforms(_.y,o,yKeys,$==null?void 0:$.y,j==null?void 0:j.y)}function isAxisDeltaZero(_){return _.translate===0&&_.scale===1}function isDeltaZero(_){return isAxisDeltaZero(_.x)&&isAxisDeltaZero(_.y)}function boxEquals(_,o){return _.x.min===o.x.min&&_.x.max===o.x.max&&_.y.min===o.y.min&&_.y.max===o.y.max}var NodeStack=function(){function _(){this.members=[]}return _.prototype.add=function(o){addUniqueItem(this.members,o),o.scheduleRender()},_.prototype.remove=function(o){if(removeItem(this.members,o),o===this.prevLead&&(this.prevLead=void 0),o===this.lead){var $=this.members[this.members.length-1];$&&this.promote($)}},_.prototype.relegate=function(o){var $=this.members.findIndex(function(rt){return o===rt});if($===0)return!1;for(var j,et=$;et>=0;et--){var tt=this.members[et];if(tt.isPresent!==!1){j=tt;break}}return j?(this.promote(j),!0):!1},_.prototype.promote=function(o,$){var j,et=this.lead;if(o!==et&&(this.prevLead=et,this.lead=o,o.show(),et)){et.instance&&et.scheduleRender(),o.scheduleRender(),o.resumeFrom=et,$&&(o.resumeFrom.preserveOpacity=!0),et.snapshot&&(o.snapshot=et.snapshot,o.snapshot.latestValues=et.animationValues||et.latestValues,o.snapshot.isShared=!0),!((j=o.root)===null||j===void 0)&&j.isUpdating&&(o.isLayoutDirty=!0);var tt=o.options.crossfade;tt===!1&&et.hide()}},_.prototype.exitAnimationComplete=function(){this.members.forEach(function(o){var $,j,et,tt,rt;(j=($=o.options).onExitComplete)===null||j===void 0||j.call($),(rt=(et=o.resumingFrom)===null||et===void 0?void 0:(tt=et.options).onExitComplete)===null||rt===void 0||rt.call(tt)})},_.prototype.scheduleRender=function(){this.members.forEach(function(o){o.instance&&o.scheduleRender(!1)})},_.prototype.removeLeadSnapshot=function(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)},_}(),identityProjection="translate3d(0px, 0px, 0) scale(1, 1) scale(1, 1)";function buildProjectionTransform(_,o,$){var j=_.x.translate/o.x,et=_.y.translate/o.y,tt="translate3d(".concat(j,"px, ").concat(et,"px, 0) ");if(tt+="scale(".concat(1/o.x,", ").concat(1/o.y,") "),$){var rt=$.rotate,nt=$.rotateX,it=$.rotateY;rt&&(tt+="rotate(".concat(rt,"deg) ")),nt&&(tt+="rotateX(".concat(nt,"deg) ")),it&&(tt+="rotateY(".concat(it,"deg) "))}var st=_.x.scale*o.x,ot=_.y.scale*o.y;return tt+="scale(".concat(st,", ").concat(ot,")"),tt===identityProjection?"none":tt}var compareByDepth=function(_,o){return _.depth-o.depth},FlatTree=function(){function _(){this.children=[],this.isDirty=!1}return _.prototype.add=function(o){addUniqueItem(this.children,o),this.isDirty=!0},_.prototype.remove=function(o){removeItem(this.children,o),this.isDirty=!0},_.prototype.forEach=function(o){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(o)},_}(),animationTarget=1e3;function createProjectionNode(_){var o=_.attachResizeListener,$=_.defaultParent,j=_.measureScroll,et=_.checkIsScrollRoot,tt=_.resetTransform;return function(){function rt(nt,it,st){var ot=this;it===void 0&&(it={}),st===void 0&&(st=$==null?void 0:$()),this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.potentialNodes=new Map,this.checkUpdateFailed=function(){ot.isUpdating&&(ot.isUpdating=!1,ot.clearAllSnapshots())},this.updateProjection=function(){ot.nodes.forEach(resolveTargetDelta),ot.nodes.forEach(calcProjection)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.id=nt,this.latestValues=it,this.root=st?st.root||st:this,this.path=st?__spreadArray$1(__spreadArray$1([],__read(st.path),!1),[st],!1):[],this.parent=st,this.depth=st?st.depth+1:0,nt&&this.root.registerPotentialNode(nt,this);for(var at=0;at<this.path.length;at++)this.path[at].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}return rt.prototype.addEventListener=function(nt,it){return this.eventHandlers.has(nt)||this.eventHandlers.set(nt,new SubscriptionManager),this.eventHandlers.get(nt).add(it)},rt.prototype.notifyListeners=function(nt){for(var it=[],st=1;st<arguments.length;st++)it[st-1]=arguments[st];var ot=this.eventHandlers.get(nt);ot==null||ot.notify.apply(ot,__spreadArray$1([],__read(it),!1))},rt.prototype.hasListeners=function(nt){return this.eventHandlers.has(nt)},rt.prototype.registerPotentialNode=function(nt,it){this.potentialNodes.set(nt,it)},rt.prototype.mount=function(nt,it){var st=this,ot;if(it===void 0&&(it=!1),!this.instance){this.isSVG=nt instanceof SVGElement&&nt.tagName!=="svg",this.instance=nt;var at=this.options,ct=at.layoutId,ut=at.layout,ft=at.visualElement;if(ft&&!ft.getInstance()&&ft.mount(nt),this.root.nodes.add(this),(ot=this.parent)===null||ot===void 0||ot.children.add(this),this.id&&this.root.potentialNodes.delete(this.id),it&&(ut||ct)&&(this.isLayoutDirty=!0),o){var ht,mt=function(){return st.root.updateBlockedByResize=!1};o(nt,function(){st.root.updateBlockedByResize=!0,clearTimeout(ht),ht=window.setTimeout(mt,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,st.nodes.forEach(finishAnimation))})}ct&&this.root.registerSharedNode(ct,this),this.options.animate!==!1&&ft&&(ct||ut)&&this.addEventListener("didUpdate",function(gt){var Et,St,At,kt,Rt,Tt=gt.delta,Dt=gt.hasLayoutChanged,Ot=gt.hasRelativeTargetChanged,jt=gt.layout;if(st.isTreeAnimationBlocked()){st.target=void 0,st.relativeTarget=void 0;return}var Nt=(St=(Et=st.options.transition)!==null&&Et!==void 0?Et:ft.getDefaultTransition())!==null&&St!==void 0?St:defaultLayoutTransition,It=ft.getProps(),yt=It.onLayoutAnimationStart,lt=It.onLayoutAnimationComplete,pt=!st.targetLayout||!boxEquals(st.targetLayout,jt)||Ot,bt=!Dt&&Ot;if(!((At=st.resumeFrom)===null||At===void 0)&&At.instance||bt||Dt&&(pt||!st.currentAnimation)){st.resumeFrom&&(st.resumingFrom=st.resumeFrom,st.resumingFrom.resumingFrom=void 0),st.setAnimationOrigin(Tt,bt);var _t=__assign$1(__assign$1({},getValueTransition(Nt,"layout")),{onPlay:yt,onComplete:lt});ft.shouldReduceMotion&&(_t.delay=0,_t.type=!1),st.startAnimation(_t)}else!Dt&&st.animationProgress===0&&st.finishAnimation(),st.isLead()&&((Rt=(kt=st.options).onExitComplete)===null||Rt===void 0||Rt.call(kt));st.targetLayout=jt})}},rt.prototype.unmount=function(){var nt,it;this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this),(nt=this.getStack())===null||nt===void 0||nt.remove(this),(it=this.parent)===null||it===void 0||it.children.delete(this),this.instance=void 0,cancelSync.preRender(this.updateProjection)},rt.prototype.blockUpdate=function(){this.updateManuallyBlocked=!0},rt.prototype.unblockUpdate=function(){this.updateManuallyBlocked=!1},rt.prototype.isUpdateBlocked=function(){return this.updateManuallyBlocked||this.updateBlockedByResize},rt.prototype.isTreeAnimationBlocked=function(){var nt;return this.isAnimationBlocked||((nt=this.parent)===null||nt===void 0?void 0:nt.isTreeAnimationBlocked())||!1},rt.prototype.startUpdate=function(){var nt;this.isUpdateBlocked()||(this.isUpdating=!0,(nt=this.nodes)===null||nt===void 0||nt.forEach(resetRotation))},rt.prototype.willUpdate=function(nt){var it,st,ot;if(nt===void 0&&(nt=!0),this.root.isUpdateBlocked()){(st=(it=this.options).onExitComplete)===null||st===void 0||st.call(it);return}if(!this.root.isUpdating&&this.root.startUpdate(),!this.isLayoutDirty){this.isLayoutDirty=!0;for(var at=0;at<this.path.length;at++){var ct=this.path[at];ct.shouldResetTransform=!0,ct.updateScroll()}var ut=this.options,ft=ut.layoutId,ht=ut.layout;if(!(ft===void 0&&!ht)){var mt=(ot=this.options.visualElement)===null||ot===void 0?void 0:ot.getProps().transformTemplate;this.prevTransformTemplateValue=mt==null?void 0:mt(this.latestValues,""),this.updateSnapshot(),nt&&this.notifyListeners("willUpdate")}}},rt.prototype.didUpdate=function(){var nt=this.isUpdateBlocked();if(nt){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating&&(this.isUpdating=!1,this.potentialNodes.size&&(this.potentialNodes.forEach(mountNodeEarly),this.potentialNodes.clear()),this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots(),flushSync.update(),flushSync.preRender(),flushSync.render())},rt.prototype.clearAllSnapshots=function(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)},rt.prototype.scheduleUpdateProjection=function(){sync.preRender(this.updateProjection,!1,!0)},rt.prototype.scheduleCheckAfterUnmount=function(){var nt=this;sync.postRender(function(){nt.isLayoutDirty?nt.root.didUpdate():nt.root.checkUpdateFailed()})},rt.prototype.updateSnapshot=function(){if(!(this.snapshot||!this.instance)){var nt=this.measure(),it=this.removeTransform(this.removeElementScroll(nt));roundBox(it),this.snapshot={measured:nt,layout:it,latestValues:{}}}},rt.prototype.updateLayout=function(){var nt;if(this.instance&&(this.updateScroll(),!(!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))){if(this.resumeFrom&&!this.resumeFrom.instance)for(var it=0;it<this.path.length;it++){var st=this.path[it];st.updateScroll()}var ot=this.measure();roundBox(ot);var at=this.layout;this.layout={measured:ot,actual:this.removeElementScroll(ot)},this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.actual),(nt=this.options.visualElement)===null||nt===void 0||nt.notifyLayoutMeasure(this.layout.actual,at==null?void 0:at.actual)}},rt.prototype.updateScroll=function(){this.options.layoutScroll&&this.instance&&(this.isScrollRoot=et(this.instance),this.scroll=j(this.instance))},rt.prototype.resetTransform=function(){var nt;if(tt){var it=this.isLayoutDirty||this.shouldResetTransform,st=this.projectionDelta&&!isDeltaZero(this.projectionDelta),ot=(nt=this.options.visualElement)===null||nt===void 0?void 0:nt.getProps().transformTemplate,at=ot==null?void 0:ot(this.latestValues,""),ct=at!==this.prevTransformTemplateValue;it&&(st||hasTransform(this.latestValues)||ct)&&(tt(this.instance,at),this.shouldResetTransform=!1,this.scheduleRender())}},rt.prototype.measure=function(){var nt=this.options.visualElement;if(!nt)return createBox();var it=nt.measureViewportBox(),st=this.root.scroll;return st&&(translateAxis(it.x,st.x),translateAxis(it.y,st.y)),it},rt.prototype.removeElementScroll=function(nt){var it=createBox();copyBoxInto(it,nt);for(var st=0;st<this.path.length;st++){var ot=this.path[st],at=ot.scroll,ct=ot.options,ut=ot.isScrollRoot;if(ot!==this.root&&at&&ct.layoutScroll){if(ut){copyBoxInto(it,nt);var ft=this.root.scroll;ft&&(translateAxis(it.x,-ft.x),translateAxis(it.y,-ft.y))}translateAxis(it.x,at.x),translateAxis(it.y,at.y)}}return it},rt.prototype.applyTransform=function(nt,it){it===void 0&&(it=!1);var st=createBox();copyBoxInto(st,nt);for(var ot=0;ot<this.path.length;ot++){var at=this.path[ot];!it&&at.options.layoutScroll&&at.scroll&&at!==at.root&&transformBox(st,{x:-at.scroll.x,y:-at.scroll.y}),hasTransform(at.latestValues)&&transformBox(st,at.latestValues)}return hasTransform(this.latestValues)&&transformBox(st,this.latestValues),st},rt.prototype.removeTransform=function(nt){var it,st=createBox();copyBoxInto(st,nt);for(var ot=0;ot<this.path.length;ot++){var at=this.path[ot];if(at.instance&&hasTransform(at.latestValues)){hasScale(at.latestValues)&&at.updateSnapshot();var ct=createBox(),ut=at.measure();copyBoxInto(ct,ut),removeBoxTransforms(st,at.latestValues,(it=at.snapshot)===null||it===void 0?void 0:it.layout,ct)}}return hasTransform(this.latestValues)&&removeBoxTransforms(st,this.latestValues),st},rt.prototype.setTargetDelta=function(nt){this.targetDelta=nt,this.root.scheduleUpdateProjection()},rt.prototype.setOptions=function(nt){var it;this.options=__assign$1(__assign$1(__assign$1({},this.options),nt),{crossfade:(it=nt.crossfade)!==null&&it!==void 0?it:!0})},rt.prototype.clearMeasurements=function(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1},rt.prototype.resolveTargetDelta=function(){var nt,it=this.options,st=it.layout,ot=it.layoutId;!this.layout||!(st||ot)||(!this.targetDelta&&!this.relativeTarget&&(this.relativeParent=this.getClosestProjectingParent(),this.relativeParent&&this.relativeParent.layout&&(this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.actual,this.relativeParent.layout.actual),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin))),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&(!((nt=this.relativeParent)===null||nt===void 0)&&nt.target)?calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.actual):copyBoxInto(this.target,this.layout.actual),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.actual),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,this.relativeParent=this.getClosestProjectingParent(),this.relativeParent&&!!this.relativeParent.resumingFrom==!!this.resumingFrom&&!this.relativeParent.options.layoutScroll&&this.relativeParent.target&&(this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,this.relativeParent.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)))))},rt.prototype.getClosestProjectingParent=function(){if(!(!this.parent||hasTransform(this.parent.latestValues)))return(this.parent.relativeTarget||this.parent.targetDelta)&&this.parent.layout?this.parent:this.parent.getClosestProjectingParent()},rt.prototype.calcProjection=function(){var nt,it=this.options,st=it.layout,ot=it.layoutId;if(this.isTreeAnimating=!!(!((nt=this.parent)===null||nt===void 0)&&nt.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!(!this.layout||!(st||ot))){var at=this.getLead();copyBoxInto(this.layoutCorrected,this.layout.actual),applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,!!this.resumingFrom||this!==at);var ct=at.target;if(ct){this.projectionDelta||(this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta());var ut=this.treeScale.x,ft=this.treeScale.y,ht=this.projectionTransform;calcBoxDelta(this.projectionDelta,this.layoutCorrected,ct,this.latestValues),this.projectionTransform=buildProjectionTransform(this.projectionDelta,this.treeScale),(this.projectionTransform!==ht||this.treeScale.x!==ut||this.treeScale.y!==ft)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",ct))}}},rt.prototype.hide=function(){this.isVisible=!1},rt.prototype.show=function(){this.isVisible=!0},rt.prototype.scheduleRender=function(nt){var it,st,ot;nt===void 0&&(nt=!0),(st=(it=this.options).scheduleRender)===null||st===void 0||st.call(it),nt&&((ot=this.getStack())===null||ot===void 0||ot.scheduleRender()),this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)},rt.prototype.setAnimationOrigin=function(nt,it){var st=this,ot;it===void 0&&(it=!1);var at=this.snapshot,ct=(at==null?void 0:at.latestValues)||{},ut=__assign$1({},this.latestValues),ft=createDelta();this.relativeTarget=this.relativeTargetOrigin=void 0,this.attemptToResolveRelativeTarget=!it;var ht=createBox(),mt=at==null?void 0:at.isShared,gt=(((ot=this.getStack())===null||ot===void 0?void 0:ot.members.length)||0)<=1,Et=!!(mt&&!gt&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0,this.mixTargetDelta=function(St){var At,kt=St/1e3;mixAxisDelta(ft.x,nt.x,kt),mixAxisDelta(ft.y,nt.y,kt),st.setTargetDelta(ft),st.relativeTarget&&st.relativeTargetOrigin&&st.layout&&(!((At=st.relativeParent)===null||At===void 0)&&At.layout)&&(calcRelativePosition(ht,st.layout.actual,st.relativeParent.layout.actual),mixBox(st.relativeTarget,st.relativeTargetOrigin,ht,kt)),mt&&(st.animationValues=ut,mixValues(ut,ct,st.latestValues,kt,Et,gt)),st.root.scheduleUpdateProjection(),st.scheduleRender(),st.animationProgress=kt},this.mixTargetDelta(0)},rt.prototype.startAnimation=function(nt){var it=this,st,ot;this.notifyListeners("animationStart"),(st=this.currentAnimation)===null||st===void 0||st.stop(),this.resumingFrom&&((ot=this.resumingFrom.currentAnimation)===null||ot===void 0||ot.stop()),this.pendingAnimation&&(cancelSync.update(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=sync.update(function(){globalProjectionState.hasAnimatedSinceResize=!0,it.currentAnimation=animate(0,animationTarget,__assign$1(__assign$1({},nt),{onUpdate:function(at){var ct;it.mixTargetDelta(at),(ct=nt.onUpdate)===null||ct===void 0||ct.call(nt,at)},onComplete:function(){var at;(at=nt.onComplete)===null||at===void 0||at.call(nt),it.completeAnimation()}})),it.resumingFrom&&(it.resumingFrom.currentAnimation=it.currentAnimation),it.pendingAnimation=void 0})},rt.prototype.completeAnimation=function(){var nt;this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0),(nt=this.getStack())===null||nt===void 0||nt.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")},rt.prototype.finishAnimation=function(){var nt;this.currentAnimation&&((nt=this.mixTargetDelta)===null||nt===void 0||nt.call(this,animationTarget),this.currentAnimation.stop()),this.completeAnimation()},rt.prototype.applyTransformsToTarget=function(){var nt=this.getLead(),it=nt.targetWithTransforms,st=nt.target,ot=nt.layout,at=nt.latestValues;!it||!st||!ot||(copyBoxInto(it,st),transformBox(it,at),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,it,at))},rt.prototype.registerSharedNode=function(nt,it){var st,ot,at;this.sharedNodes.has(nt)||this.sharedNodes.set(nt,new NodeStack);var ct=this.sharedNodes.get(nt);ct.add(it),it.promote({transition:(st=it.options.initialPromotionConfig)===null||st===void 0?void 0:st.transition,preserveFollowOpacity:(at=(ot=it.options.initialPromotionConfig)===null||ot===void 0?void 0:ot.shouldPreserveFollowOpacity)===null||at===void 0?void 0:at.call(ot,it)})},rt.prototype.isLead=function(){var nt=this.getStack();return nt?nt.lead===this:!0},rt.prototype.getLead=function(){var nt,it=this.options.layoutId;return it?((nt=this.getStack())===null||nt===void 0?void 0:nt.lead)||this:this},rt.prototype.getPrevLead=function(){var nt,it=this.options.layoutId;return it?(nt=this.getStack())===null||nt===void 0?void 0:nt.prevLead:void 0},rt.prototype.getStack=function(){var nt=this.options.layoutId;if(nt)return this.root.sharedNodes.get(nt)},rt.prototype.promote=function(nt){var it=nt===void 0?{}:nt,st=it.needsReset,ot=it.transition,at=it.preserveFollowOpacity,ct=this.getStack();ct&&ct.promote(this,at),st&&(this.projectionDelta=void 0,this.needsReset=!0),ot&&this.setOptions({transition:ot})},rt.prototype.relegate=function(){var nt=this.getStack();return nt?nt.relegate(this):!1},rt.prototype.resetRotation=function(){var nt=this.options.visualElement;if(nt){for(var it=!1,st={},ot=0;ot<transformAxes.length;ot++){var at=transformAxes[ot],ct="rotate"+at;nt.getStaticValue(ct)&&(it=!0,st[ct]=nt.getStaticValue(ct),nt.setStaticValue(ct,0))}if(it){nt==null||nt.syncRender();for(var ct in st)nt.setStaticValue(ct,st[ct]);nt.scheduleRender()}}},rt.prototype.getProjectionStyles=function(nt){var it,st,ot,at,ct,ut;nt===void 0&&(nt={});var ft={};if(!this.instance||this.isSVG)return ft;if(this.isVisible)ft.visibility="";else return{visibility:"hidden"};var ht=(it=this.options.visualElement)===null||it===void 0?void 0:it.getProps().transformTemplate;if(this.needsReset)return this.needsReset=!1,ft.opacity="",ft.pointerEvents=resolveMotionValue(nt.pointerEvents)||"",ft.transform=ht?ht(this.latestValues,""):"none",ft;var mt=this.getLead();if(!this.projectionDelta||!this.layout||!mt.target){var gt={};return this.options.layoutId&&(gt.opacity=(st=this.latestValues.opacity)!==null&&st!==void 0?st:1,gt.pointerEvents=resolveMotionValue(nt.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(gt.transform=ht?ht({},""):"none",this.hasProjected=!1),gt}var Et=mt.animationValues||mt.latestValues;this.applyTransformsToTarget(),ft.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,Et),ht&&(ft.transform=ht(Et,ft.transform));var St=this.projectionDelta,At=St.x,kt=St.y;ft.transformOrigin="".concat(At.origin*100,"% ").concat(kt.origin*100,"% 0"),mt.animationValues?ft.opacity=mt===this?(at=(ot=Et.opacity)!==null&&ot!==void 0?ot:this.latestValues.opacity)!==null&&at!==void 0?at:1:this.preserveOpacity?this.latestValues.opacity:Et.opacityExit:ft.opacity=mt===this?(ct=Et.opacity)!==null&&ct!==void 0?ct:"":(ut=Et.opacityExit)!==null&&ut!==void 0?ut:0;for(var Rt in scaleCorrectors)if(Et[Rt]!==void 0){var Tt=scaleCorrectors[Rt],Dt=Tt.correct,Ot=Tt.applyTo,jt=Dt(Et[Rt],mt);if(Ot)for(var Nt=Ot.length,It=0;It<Nt;It++)ft[Ot[It]]=jt;else ft[Rt]=jt}return this.options.layoutId&&(ft.pointerEvents=mt===this?resolveMotionValue(nt.pointerEvents)||"":"none"),ft},rt.prototype.clearSnapshot=function(){this.resumeFrom=this.snapshot=void 0},rt.prototype.resetTree=function(){this.root.nodes.forEach(function(nt){var it;return(it=nt.currentAnimation)===null||it===void 0?void 0:it.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()},rt}()}function updateLayout(_){_.updateLayout()}function notifyLayoutUpdate(_){var o,$,j,et,tt=($=(o=_.resumeFrom)===null||o===void 0?void 0:o.snapshot)!==null&&$!==void 0?$:_.snapshot;if(_.isLead()&&_.layout&&tt&&_.hasListeners("didUpdate")){var rt=_.layout,nt=rt.actual,it=rt.measured;_.options.animationType==="size"?eachAxis(function(Et){var St=tt.isShared?tt.measured[Et]:tt.layout[Et],At=calcLength(St);St.min=nt[Et].min,St.max=St.min+At}):_.options.animationType==="position"&&eachAxis(function(Et){var St=tt.isShared?tt.measured[Et]:tt.layout[Et],At=calcLength(nt[Et]);St.max=St.min+At});var st=createDelta();calcBoxDelta(st,nt,tt.layout);var ot=createDelta();tt.isShared?calcBoxDelta(ot,_.applyTransform(it,!0),tt.measured):calcBoxDelta(ot,nt,tt.layout);var at=!isDeltaZero(st),ct=!1;if(!_.resumeFrom&&(_.relativeParent=_.getClosestProjectingParent(),_.relativeParent&&!_.relativeParent.resumeFrom)){var ut=_.relativeParent,ft=ut.snapshot,ht=ut.layout;if(ft&&ht){var mt=createBox();calcRelativePosition(mt,tt.layout,ft.layout);var gt=createBox();calcRelativePosition(gt,nt,ht.actual),boxEquals(mt,gt)||(ct=!0)}}_.notifyListeners("didUpdate",{layout:nt,snapshot:tt,delta:ot,layoutDelta:st,hasLayoutChanged:at,hasRelativeTargetChanged:ct})}else _.isLead()&&((et=(j=_.options).onExitComplete)===null||et===void 0||et.call(j));_.options.transition=void 0}function clearSnapshot(_){_.clearSnapshot()}function clearMeasurements(_){_.clearMeasurements()}function resetTransformStyle(_){var o=_.options.visualElement;o!=null&&o.getProps().onBeforeLayoutMeasure&&o.notifyBeforeLayoutMeasure(),_.resetTransform()}function finishAnimation(_){_.finishAnimation(),_.targetDelta=_.relativeTarget=_.target=void 0}function resolveTargetDelta(_){_.resolveTargetDelta()}function calcProjection(_){_.calcProjection()}function resetRotation(_){_.resetRotation()}function removeLeadSnapshots(_){_.removeLeadSnapshot()}function mixAxisDelta(_,o,$){_.translate=mix$1(o.translate,0,$),_.scale=mix$1(o.scale,1,$),_.origin=o.origin,_.originPoint=o.originPoint}function mixAxis(_,o,$,j){_.min=mix$1(o.min,$.min,j),_.max=mix$1(o.max,$.max,j)}function mixBox(_,o,$,j){mixAxis(_.x,o.x,$.x,j),mixAxis(_.y,o.y,$.y,j)}function hasOpacityCrossfade(_){return _.animationValues&&_.animationValues.opacityExit!==void 0}var defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]};function mountNodeEarly(_,o){for(var $=_.root,j=_.path.length-1;j>=0;j--)if(_.path[j].instance){$=_.path[j];break}var et=$&&$!==_.root?$.instance:document,tt=et.querySelector('[data-projection-id="'.concat(o,'"]'));tt&&_.mount(tt,!0)}function roundAxis(_){_.min=Math.round(_.min),_.max=Math.round(_.max)}function roundBox(_){roundAxis(_.x),roundAxis(_.y)}var DocumentProjectionNode=createProjectionNode({attachResizeListener:function(_,o){return addDomEvent(_,"resize",o)},measureScroll:function(){return{x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}},checkIsScrollRoot:function(){return!0}}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:function(_){return{x:_.scrollLeft,y:_.scrollTop}},defaultParent:function(){if(!rootProjectionNode.current){var _=new DocumentProjectionNode(0,{});_.mount(window),_.setOptions({layoutScroll:!0}),rootProjectionNode.current=_}return rootProjectionNode.current},resetTransform:function(_,o){_.style.transform=o??"none"},checkIsScrollRoot:function(_){return window.getComputedStyle(_).position==="fixed"}}),featureBundle=__assign$1(__assign$1(__assign$1(__assign$1({},animations),gestureAnimations),drag),layoutFeatures),motion=createMotionProxy(function(_,o){return createDomMotionConfig(_,o,featureBundle,createDomVisualElement,HTMLProjectionNode)});function useIsMounted$1(){var _=reactExports.useRef(!1);return useIsomorphicLayoutEffect(function(){return _.current=!0,function(){_.current=!1}},[]),_}function useForceUpdate(){var _=useIsMounted$1(),o=__read(reactExports.useState(0),2),$=o[0],j=o[1],et=reactExports.useCallback(function(){_.current&&j($+1)},[$]),tt=reactExports.useCallback(function(){return sync.postRender(et)},[et]);return[tt,$]}var PresenceChild=function(_){var o=_.children,$=_.initial,j=_.isPresent,et=_.onExitComplete,tt=_.custom,rt=_.presenceAffectsLayout,nt=useConstant(newChildrenMap),it=useId$1(),st=reactExports.useMemo(function(){return{id:it,initial:$,isPresent:j,custom:tt,onExitComplete:function(ot){var at,ct;nt.set(ot,!0);try{for(var ut=__values(nt.values()),ft=ut.next();!ft.done;ft=ut.next()){var ht=ft.value;if(!ht)return}}catch(mt){at={error:mt}}finally{try{ft&&!ft.done&&(ct=ut.return)&&ct.call(ut)}finally{if(at)throw at.error}}et==null||et()},register:function(ot){return nt.set(ot,!1),function(){return nt.delete(ot)}}}},rt?void 0:[j]);return reactExports.useMemo(function(){nt.forEach(function(ot,at){return nt.set(at,!1)})},[j]),reactExports.useEffect(function(){!j&&!nt.size&&(et==null||et())},[j]),reactExports.createElement(PresenceContext.Provider,{value:st},o)};function newChildrenMap(){return new Map}var getChildKey=function(_){return _.key||""};function updateChildLookup(_,o){_.forEach(function($){var j=getChildKey($);o.set(j,$)})}function onlyElements(_){var o=[];return reactExports.Children.forEach(_,function($){reactExports.isValidElement($)&&o.push($)}),o}var AnimatePresence=function(_){var o=_.children,$=_.custom,j=_.initial,et=j===void 0?!0:j,tt=_.onExitComplete,rt=_.exitBeforeEnter,nt=_.presenceAffectsLayout,it=nt===void 0?!0:nt,st=__read(useForceUpdate(),1),ot=st[0],at=reactExports.useContext(LayoutGroupContext).forceRender;at&&(ot=at);var ct=useIsMounted$1(),ut=onlyElements(o),ft=ut,ht=new Set,mt=reactExports.useRef(ft),gt=reactExports.useRef(new Map).current,Et=reactExports.useRef(!0);if(useIsomorphicLayoutEffect(function(){Et.current=!1,updateChildLookup(ut,gt),mt.current=ft}),useUnmountEffect(function(){Et.current=!0,gt.clear(),ht.clear()}),Et.current)return reactExports.createElement(reactExports.Fragment,null,ft.map(function(Dt){return reactExports.createElement(PresenceChild,{key:getChildKey(Dt),isPresent:!0,initial:et?void 0:!1,presenceAffectsLayout:it},Dt)}));ft=__spreadArray$1([],__read(ft),!1);for(var St=mt.current.map(getChildKey),At=ut.map(getChildKey),kt=St.length,Rt=0;Rt<kt;Rt++){var Tt=St[Rt];At.indexOf(Tt)===-1&&ht.add(Tt)}return rt&&ht.size&&(ft=[]),ht.forEach(function(Dt){if(At.indexOf(Dt)===-1){var Ot=gt.get(Dt);if(Ot){var jt=St.indexOf(Dt),Nt=function(){gt.delete(Dt),ht.delete(Dt);var It=mt.current.findIndex(function(yt){return yt.key===Dt});if(mt.current.splice(It,1),!ht.size){if(mt.current=ut,ct.current===!1)return;ot(),tt&&tt()}};ft.splice(jt,0,reactExports.createElement(PresenceChild,{key:getChildKey(Ot),isPresent:!1,onExitComplete:Nt,custom:$,presenceAffectsLayout:it},Ot))}}}),ft=ft.map(function(Dt){var Ot=Dt.key;return ht.has(Ot)?Dt:reactExports.createElement(PresenceChild,{key:getChildKey(Dt),isPresent:!0,presenceAffectsLayout:it},Dt)}),env$1!=="production"&&rt&&ft.length>1&&console.warn("You're attempting to animate multiple children within AnimatePresence, but its exitBeforeEnter prop is set to true. This will lead to odd visual behaviour."),reactExports.createElement(reactExports.Fragment,null,ht.size?ft:ft.map(function(Dt){return reactExports.cloneElement(Dt)}))},toastMotionVariants={initial:_=>{const{position:o}=_,$=["top","bottom"].includes(o)?"y":"x";let j=["top-right","bottom-right"].includes(o)?1:-1;return o==="bottom"&&(j=1),{opacity:0,[$]:j*24}},animate:{opacity:1,y:0,x:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.85,transition:{duration:.2,ease:[.4,0,1,1]}}},ToastComponent=reactExports.memo(_=>{const{id:o,message:$,onCloseComplete:j,onRequestRemove:et,requestClose:tt=!1,position:rt="bottom",duration:nt=5e3,containerStyle:it,motionVariants:st=toastMotionVariants,toastSpacing:ot="0.5rem"}=_,[at,ct]=reactExports.useState(nt),ut=useIsPresent();useUpdateEffect(()=>{ut||j==null||j()},[ut]),useUpdateEffect(()=>{ct(nt)},[nt]);const ft=()=>ct(null),ht=()=>ct(nt),mt=()=>{ut&&et()};reactExports.useEffect(()=>{ut&&tt&&et()},[ut,tt,et]),useTimeout(mt,at);const gt=reactExports.useMemo(()=>({pointerEvents:"auto",maxWidth:560,minWidth:300,margin:ot,...it}),[it,ot]),Et=reactExports.useMemo(()=>getToastStyle(rt),[rt]);return jsx(motion.li,{layout:!0,className:"chakra-toast",variants:st,initial:"initial",animate:"animate",exit:"exit",onHoverStart:ft,onHoverEnd:ht,custom:{position:rt},style:Et,children:jsx(chakra.div,{role:"status","aria-atomic":"true",className:"chakra-toast__inner",__css:gt,children:runIfFn$2($,{id:o,onClose:mt})})})});ToastComponent.displayName="ToastComponent";function getToastPlacement(_,o){var $;const j=_??"bottom",tt={"top-start":{ltr:"top-left",rtl:"top-right"},"top-end":{ltr:"top-right",rtl:"top-left"},"bottom-start":{ltr:"bottom-left",rtl:"bottom-right"},"bottom-end":{ltr:"bottom-right",rtl:"bottom-left"}}[j];return($=tt==null?void 0:tt[o])!=null?$:j}var fallbackIcon={path:jsxs("g",{stroke:"currentColor",strokeWidth:"1.5",children:[jsx("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),jsx("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),jsx("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})]}),viewBox:"0 0 24 24"},Icon$1=forwardRef((_,o)=>{const{as:$,viewBox:j,color:et="currentColor",focusable:tt=!1,children:rt,className:nt,__css:it,...st}=_,ot=cx("chakra-icon",nt),at=useStyleConfig("Icon",_),ct={w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:et,...it,...at},ut={ref:o,focusable:tt,className:ot,__css:ct},ft=j??fallbackIcon.viewBox;if($&&typeof $!="string")return jsx(chakra.svg,{as:$,...ut,...st});const ht=rt??fallbackIcon.path;return jsx(chakra.svg,{verticalAlign:"middle",viewBox:ft,...ut,...st,children:ht})});Icon$1.displayName="Icon";function createIcon(_){const{viewBox:o="0 0 24 24",d:$,displayName:j,defaultProps:et={}}=_,tt=reactExports.Children.toArray(_.path),rt=forwardRef((nt,it)=>jsx(Icon$1,{ref:it,viewBox:o,...et,...nt,children:tt.length?tt:jsx("path",{fill:"currentColor",d:$})}));return rt.displayName=j,rt}function CheckIcon(_){return jsx(Icon$1,{viewBox:"0 0 24 24",..._,children:jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})})}function InfoIcon(_){return jsx(Icon$1,{viewBox:"0 0 24 24",..._,children:jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})})}function WarningIcon(_){return jsx(Icon$1,{viewBox:"0 0 24 24",..._,children:jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})}var spin=keyframes$2({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),Spinner=forwardRef((_,o)=>{const $=useStyleConfig("Spinner",_),{label:j="Loading...",thickness:et="2px",speed:tt="0.45s",emptyColor:rt="transparent",className:nt,...it}=omitThemingProps(_),st=cx("chakra-spinner",nt),ot={display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:et,borderBottomColor:rt,borderLeftColor:rt,animation:`${spin} ${tt} linear infinite`,...$};return jsx(chakra.div,{ref:o,__css:ot,className:st,...it,children:j&&jsx(chakra.span,{srOnly:!0,children:j})})});Spinner.displayName="Spinner";var[AlertProvider,useAlertContext]=createContext$1({name:"AlertContext",hookName:"useAlertContext",providerName:"<Alert />"}),[AlertStylesProvider,useAlertStyles]=createContext$1({name:"AlertStylesContext",hookName:"useAlertStyles",providerName:"<Alert />"}),STATUSES={info:{icon:InfoIcon,colorScheme:"blue"},warning:{icon:WarningIcon,colorScheme:"orange"},success:{icon:CheckIcon,colorScheme:"green"},error:{icon:WarningIcon,colorScheme:"red"},loading:{icon:Spinner,colorScheme:"blue"}};function getStatusColorScheme(_){return STATUSES[_].colorScheme}function getStatusIcon(_){return STATUSES[_].icon}var AlertDescription=forwardRef(function(o,$){const et={display:"inline",...useAlertStyles().description};return jsx(chakra.div,{ref:$,...o,className:cx("chakra-alert__desc",o.className),__css:et})});AlertDescription.displayName="AlertDescription";function AlertIcon(_){const{status:o}=useAlertContext(),$=getStatusIcon(o),j=useAlertStyles(),et=o==="loading"?j.spinner:j.icon;return jsx(chakra.span,{display:"inherit",..._,className:cx("chakra-alert__icon",_.className),__css:et,children:_.children||jsx($,{h:"100%",w:"100%"})})}AlertIcon.displayName="AlertIcon";var AlertTitle=forwardRef(function(o,$){const j=useAlertStyles();return jsx(chakra.div,{ref:$,...o,className:cx("chakra-alert__title",o.className),__css:j.title})});AlertTitle.displayName="AlertTitle";var Alert=forwardRef(function(o,$){var j;const{status:et="info",addRole:tt=!0,...rt}=omitThemingProps(o),nt=(j=o.colorScheme)!=null?j:getStatusColorScheme(et),it=useMultiStyleConfig("Alert",{...o,colorScheme:nt}),st={width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",...it.container};return jsx(AlertProvider,{value:{status:et},children:jsx(AlertStylesProvider,{value:it,children:jsx(chakra.div,{role:tt?"alert":void 0,ref:$,...rt,className:cx("chakra-alert",o.className),__css:st})})})});Alert.displayName="Alert";function CloseIcon$1(_){return jsx(Icon$1,{focusable:"false","aria-hidden":!0,..._,children:jsx("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})})}var CloseButton=forwardRef(function(o,$){const j=useStyleConfig("CloseButton",o),{children:et,isDisabled:tt,__css:rt,...nt}=omitThemingProps(o),it={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return jsx(chakra.button,{type:"button","aria-label":"Close",ref:$,disabled:tt,__css:{...it,...j,...rt},...nt,children:et||jsx(CloseIcon$1,{width:"1em",height:"1em"})})});CloseButton.displayName="CloseButton";var initialState={top:[],"top-left":[],"top-right":[],"bottom-left":[],bottom:[],"bottom-right":[]},toastStore=createStore$1(initialState);function createStore$1(_){let o=_;const $=new Set,j=et=>{o=et(o),$.forEach(tt=>tt())};return{getState:()=>o,subscribe:et=>($.add(et),()=>{j(()=>_),$.delete(et)}),removeToast:(et,tt)=>{j(rt=>({...rt,[tt]:rt[tt].filter(nt=>nt.id!=et)}))},notify:(et,tt)=>{const rt=createToast(et,tt),{position:nt,id:it}=rt;return j(st=>{var ot,at;const ut=nt.includes("top")?[rt,...(ot=st[nt])!=null?ot:[]]:[...(at=st[nt])!=null?at:[],rt];return{...st,[nt]:ut}}),it},update:(et,tt)=>{et&&j(rt=>{const nt={...rt},{position:it,index:st}=findToast(nt,et);return it&&st!==-1&&(nt[it][st]={...nt[it][st],...tt,message:createRenderToast(tt)}),nt})},closeAll:({positions:et}={})=>{j(tt=>(et??["bottom","bottom-right","bottom-left","top","top-left","top-right"]).reduce((it,st)=>(it[st]=tt[st].map(ot=>({...ot,requestClose:!0})),it),{...tt}))},close:et=>{j(tt=>{const rt=getToastPosition(tt,et);return rt?{...tt,[rt]:tt[rt].map(nt=>nt.id==et?{...nt,requestClose:!0}:nt)}:tt})},isActive:et=>!!findToast(toastStore.getState(),et).position}}var counter$2=0;function createToast(_,o={}){var $,j;counter$2+=1;const et=($=o.id)!=null?$:counter$2,tt=(j=o.position)!=null?j:"bottom";return{id:et,message:_,position:tt,duration:o.duration,onCloseComplete:o.onCloseComplete,onRequestRemove:()=>toastStore.removeToast(String(et),tt),status:o.status,requestClose:!1,containerStyle:o.containerStyle}}var Toast=_=>{const{status:o,variant:$="solid",id:j,title:et,isClosable:tt,onClose:rt,description:nt,icon:it}=_,st=j?{root:`toast-${j}`,title:`toast-${j}-title`,description:`toast-${j}-description`}:void 0;return jsxs(Alert,{addRole:!1,status:o,variant:$,id:st==null?void 0:st.root,alignItems:"start",borderRadius:"md",boxShadow:"lg",paddingEnd:8,textAlign:"start",width:"auto",children:[jsx(AlertIcon,{children:it}),jsxs(chakra.div,{flex:"1",maxWidth:"100%",children:[et&&jsx(AlertTitle,{id:st==null?void 0:st.title,children:et}),nt&&jsx(AlertDescription,{id:st==null?void 0:st.description,display:"block",children:nt})]}),tt&&jsx(CloseButton,{size:"sm",onClick:rt,position:"absolute",insetEnd:1,top:1})]})};function createRenderToast(_={}){const{render:o,toastComponent:$=Toast}=_;return et=>typeof o=="function"?o({...et,..._}):jsx($,{...et,..._})}function createToastFn(_,o){const $=et=>{var tt;return{...o,...et,position:getToastPlacement((tt=et==null?void 0:et.position)!=null?tt:o==null?void 0:o.position,_)}},j=et=>{const tt=$(et),rt=createRenderToast(tt);return toastStore.notify(rt,tt)};return j.update=(et,tt)=>{toastStore.update(et,$(tt))},j.promise=(et,tt)=>{const rt=j({...tt.loading,status:"loading",duration:null});et.then(nt=>j.update(rt,{status:"success",duration:5e3,...runIfFn$2(tt.success,nt)})).catch(nt=>j.update(rt,{status:"error",duration:5e3,...runIfFn$2(tt.error,nt)}))},j.closeAll=toastStore.closeAll,j.close=toastStore.close,j.isActive=toastStore.isActive,j}var[ToastOptionProvider,useToastOptionContext]=createContext$1({name:"ToastOptionsContext",strict:!1}),ToastProvider=_=>{const o=reactExports.useSyncExternalStore(toastStore.subscribe,toastStore.getState,toastStore.getState),{motionVariants:$,component:j=ToastComponent,portalProps:et}=_,rt=Object.keys(o).map(nt=>{const it=o[nt];return jsx("ul",{role:"region","aria-live":"polite",id:`chakra-toast-manager-${nt}`,style:getToastListStyle(nt),children:jsx(AnimatePresence,{initial:!1,children:it.map(st=>jsx(j,{motionVariants:$,...st},st.id))})},nt)});return jsx(Portal,{...et,children:rt})};function useToast(_){const{theme:o}=useChakra(),$=useToastOptionContext();return reactExports.useMemo(()=>createToastFn(o.direction,{...$,..._}),[_,o.direction,$])}var createChakraProvider=_=>function({children:$,theme:j=_,toastOptions:et,...tt}){return jsxs(ChakraProvider$1,{theme:j,...tt,children:[jsx(ToastOptionProvider,{value:et==null?void 0:et.defaultOptions,children:$}),jsx(ToastProvider,{...et})]})},ChakraProvider=createChakraProvider(theme$1),__defProp$1=Object.defineProperty,__defNormalProp$1=(_,o,$)=>o in _?__defProp$1(_,o,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[o]=$,__publicField$1=(_,o,$)=>(__defNormalProp$1(_,typeof o!="symbol"?o+"":o,$),$);function sortNodes(_){return _.sort((o,$)=>{const j=o.compareDocumentPosition($);if(j&Node.DOCUMENT_POSITION_FOLLOWING||j&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(j&Node.DOCUMENT_POSITION_PRECEDING||j&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(j&Node.DOCUMENT_POSITION_DISCONNECTED||j&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var isElement$1=_=>typeof _=="object"&&"nodeType"in _&&_.nodeType===Node.ELEMENT_NODE;function getNextIndex(_,o,$){let j=_+1;return $&&j>=o&&(j=0),j}function getPrevIndex(_,o,$){let j=_-1;return $&&j<0&&(j=o),j}var useSafeLayoutEffect$1=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,cast=_=>_,DescendantsManager=class{constructor(){__publicField$1(this,"descendants",new Map),__publicField$1(this,"register",_=>{if(_!=null)return isElement$1(_)?this.registerNode(_):o=>{this.registerNode(o,_)}}),__publicField$1(this,"unregister",_=>{this.descendants.delete(_);const o=sortNodes(Array.from(this.descendants.keys()));this.assignIndex(o)}),__publicField$1(this,"destroy",()=>{this.descendants.clear()}),__publicField$1(this,"assignIndex",_=>{this.descendants.forEach(o=>{const $=_.indexOf(o.node);o.index=$,o.node.dataset.index=o.index.toString()})}),__publicField$1(this,"count",()=>this.descendants.size),__publicField$1(this,"enabledCount",()=>this.enabledValues().length),__publicField$1(this,"values",()=>Array.from(this.descendants.values()).sort((o,$)=>o.index-$.index)),__publicField$1(this,"enabledValues",()=>this.values().filter(_=>!_.disabled)),__publicField$1(this,"item",_=>{if(this.count()!==0)return this.values()[_]}),__publicField$1(this,"enabledItem",_=>{if(this.enabledCount()!==0)return this.enabledValues()[_]}),__publicField$1(this,"first",()=>this.item(0)),__publicField$1(this,"firstEnabled",()=>this.enabledItem(0)),__publicField$1(this,"last",()=>this.item(this.descendants.size-1)),__publicField$1(this,"lastEnabled",()=>{const _=this.enabledValues().length-1;return this.enabledItem(_)}),__publicField$1(this,"indexOf",_=>{var o,$;return _&&($=(o=this.descendants.get(_))==null?void 0:o.index)!=null?$:-1}),__publicField$1(this,"enabledIndexOf",_=>_==null?-1:this.enabledValues().findIndex(o=>o.node.isSameNode(_))),__publicField$1(this,"next",(_,o=!0)=>{const $=getNextIndex(_,this.count(),o);return this.item($)}),__publicField$1(this,"nextEnabled",(_,o=!0)=>{const $=this.item(_);if(!$)return;const j=this.enabledIndexOf($.node),et=getNextIndex(j,this.enabledCount(),o);return this.enabledItem(et)}),__publicField$1(this,"prev",(_,o=!0)=>{const $=getPrevIndex(_,this.count()-1,o);return this.item($)}),__publicField$1(this,"prevEnabled",(_,o=!0)=>{const $=this.item(_);if(!$)return;const j=this.enabledIndexOf($.node),et=getPrevIndex(j,this.enabledCount()-1,o);return this.enabledItem(et)}),__publicField$1(this,"registerNode",(_,o)=>{if(!_||this.descendants.has(_))return;const $=Array.from(this.descendants.keys()).concat(_),j=sortNodes($);o!=null&&o.disabled&&(o.disabled=!!o.disabled);const et={node:_,index:-1,...o};this.descendants.set(_,et),this.assignIndex(j)})}};function assignRef$1(_,o){if(_!=null){if(typeof _=="function"){_(o);return}try{_.current=o}catch{throw new Error(`Cannot assign value '${o}' to ref '${_}'`)}}}function mergeRefs(..._){return o=>{_.forEach($=>{assignRef$1($,o)})}}function useMergeRefs$1(..._){return reactExports.useMemo(()=>mergeRefs(..._),_)}function useDescendants(){const _=reactExports.useRef(new DescendantsManager);return useSafeLayoutEffect$1(()=>()=>_.current.destroy()),_.current}var[DescendantsContextProvider,useDescendantsContext]=createContext$1({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function useDescendant(_){const o=useDescendantsContext(),[$,j]=reactExports.useState(-1),et=reactExports.useRef(null);useSafeLayoutEffect$1(()=>()=>{et.current&&o.unregister(et.current)},[]),useSafeLayoutEffect$1(()=>{if(!et.current)return;const rt=Number(et.current.dataset.index);$!=rt&&!Number.isNaN(rt)&&j(rt)});const tt=cast(_?o.register(_):o.register);return{descendants:o,index:$,enabledIndex:o.enabledIndexOf(et.current),register:mergeRefs(tt,et)}}function createDescendantContext(){return[cast(DescendantsContextProvider),()=>cast(useDescendantsContext()),()=>useDescendants(),et=>useDescendant(et)]}var[AccordionStylesProvider,useAccordionStyles]=createContext$1({name:"AccordionStylesContext",hookName:"useAccordionStyles",providerName:"<Accordion />"}),[AccordionItemProvider,useAccordionItemContext]=createContext$1({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItem />"}),[AccordionDescendantsProvider,useAccordionDescendantsContext,useAccordionDescendants,useAccordionDescendant]=createDescendantContext(),AccordionButton=forwardRef(function(o,$){const{getButtonProps:j}=useAccordionItemContext(),et=j(o,$),rt={display:"flex",alignItems:"center",width:"100%",outline:0,...useAccordionStyles().button};return jsx(chakra.button,{...et,className:cx("chakra-accordion__button",o.className),__css:rt})});AccordionButton.displayName="AccordionButton";function useControllableState$1(_){const{value:o,defaultValue:$,onChange:j,shouldUpdate:et=(ct,ut)=>ct!==ut}=_,tt=useCallbackRef$2(j),rt=useCallbackRef$2(et),[nt,it]=reactExports.useState($),st=o!==void 0,ot=st?o:nt,at=useCallbackRef$2(ct=>{const ft=typeof ct=="function"?ct(ot):ct;rt(ot,ft)&&(st||it(ft),tt(ft))},[st,tt,ot,rt]);return[ot,at]}function useAccordion(_){const{onChange:o,defaultIndex:$,index:j,allowMultiple:et,allowToggle:tt,...rt}=_;allowMultipleWarning(_),allowMultipleAndAllowToggleWarning(_);const nt=useAccordionDescendants(),[it,st]=reactExports.useState(-1);reactExports.useEffect(()=>()=>{st(-1)},[]);const[ot,at]=useControllableState$1({value:j,defaultValue(){return et?$??[]:$??-1},onChange:o});return{index:ot,setIndex:at,htmlProps:rt,getAccordionItemProps:ut=>{let ft=!1;return ut!==null&&(ft=Array.isArray(ot)?ot.includes(ut):ot===ut),{isOpen:ft,onChange:mt=>{if(ut!==null)if(et&&Array.isArray(ot)){const gt=mt?ot.concat(ut):ot.filter(Et=>Et!==ut);at(gt)}else mt?at(ut):tt&&at(-1)}}},focusedIndex:it,setFocusedIndex:st,descendants:nt}}var[AccordionProvider,useAccordionContext]=createContext$1({name:"AccordionContext",hookName:"useAccordionContext",providerName:"Accordion"});function useAccordionItem(_){const{isDisabled:o,isFocusable:$,id:j,...et}=_,{getAccordionItemProps:tt,setFocusedIndex:rt}=useAccordionContext(),nt=reactExports.useRef(null),it=reactExports.useId(),st=j??it,ot=`accordion-button-${st}`,at=`accordion-panel-${st}`;focusableNotDisabledWarning(_);const{register:ct,index:ut,descendants:ft}=useAccordionDescendant({disabled:o&&!$}),{isOpen:ht,onChange:mt}=tt(ut===-1?null:ut);warnIfOpenAndDisabled({isOpen:ht,isDisabled:o});const gt=()=>{mt==null||mt(!0)},Et=()=>{mt==null||mt(!1)},St=reactExports.useCallback(()=>{mt==null||mt(!ht),rt(ut)},[ut,rt,ht,mt]),At=reactExports.useCallback(Dt=>{const jt={ArrowDown:()=>{const Nt=ft.nextEnabled(ut);Nt==null||Nt.node.focus()},ArrowUp:()=>{const Nt=ft.prevEnabled(ut);Nt==null||Nt.node.focus()},Home:()=>{const Nt=ft.firstEnabled();Nt==null||Nt.node.focus()},End:()=>{const Nt=ft.lastEnabled();Nt==null||Nt.node.focus()}}[Dt.key];jt&&(Dt.preventDefault(),jt(Dt))},[ft,ut]),kt=reactExports.useCallback(()=>{rt(ut)},[rt,ut]),Rt=reactExports.useCallback(function(Ot={},jt=null){return{...Ot,type:"button",ref:mergeRefs(ct,nt,jt),id:ot,disabled:!!o,"aria-expanded":!!ht,"aria-controls":at,onClick:callAllHandlers$1(Ot.onClick,St),onFocus:callAllHandlers$1(Ot.onFocus,kt),onKeyDown:callAllHandlers$1(Ot.onKeyDown,At)}},[ot,o,ht,St,kt,At,at,ct]),Tt=reactExports.useCallback(function(Ot={},jt=null){return{...Ot,ref:jt,role:"region",id:at,"aria-labelledby":ot,hidden:!ht}},[ot,ht,at]);return{isOpen:ht,isDisabled:o,isFocusable:$,onOpen:gt,onClose:Et,getButtonProps:Rt,getPanelProps:Tt,htmlProps:et}}function allowMultipleWarning(_){const o=_.index||_.defaultIndex,$=o!=null&&!Array.isArray(o)&&_.allowMultiple;warn({condition:!!$,message:`If 'allowMultiple' is passed, then 'index' or 'defaultIndex' must be an array. You passed: ${typeof o},`})}function allowMultipleAndAllowToggleWarning(_){warn({condition:!!(_.allowMultiple&&_.allowToggle),message:"If 'allowMultiple' is passed, 'allowToggle' will be ignored. Either remove 'allowToggle' or 'allowMultiple' depending on whether you want multiple accordions visible or not"})}function focusableNotDisabledWarning(_){warn({condition:!!(_.isFocusable&&!_.isDisabled),message:`Using only 'isFocusable', this prop is reserved for situations where you pass 'isDisabled' but you still want the element to receive focus (A11y). Either remove it or pass 'isDisabled' as well.
    `})}function warnIfOpenAndDisabled(_){warn({condition:_.isOpen&&!!_.isDisabled,message:"Cannot open a disabled accordion item"})}function AccordionIcon(_){const{isOpen:o,isDisabled:$}=useAccordionItemContext(),{reduceMotion:j}=useAccordionContext(),et=cx("chakra-accordion__icon",_.className),tt=useAccordionStyles(),rt={opacity:$?.4:1,transform:o?"rotate(-180deg)":void 0,transition:j?void 0:"transform 0.2s",transformOrigin:"center",...tt.icon};return jsx(Icon$1,{viewBox:"0 0 24 24","aria-hidden":!0,className:et,__css:rt,..._,children:jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})})}AccordionIcon.displayName="AccordionIcon";var AccordionItem=forwardRef(function(o,$){const{children:j,className:et}=o,{htmlProps:tt,...rt}=useAccordionItem(o),it={...useAccordionStyles().container,overflowAnchor:"none"},st=reactExports.useMemo(()=>rt,[rt]);return jsx(AccordionItemProvider,{value:st,children:jsx(chakra.div,{ref:$,...tt,className:cx("chakra-accordion__item",et),__css:it,children:typeof j=="function"?j({isExpanded:!!rt.isOpen,isDisabled:!!rt.isDisabled}):j})})});AccordionItem.displayName="AccordionItem";var TRANSITION_EASINGS={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},TRANSITION_DEFAULTS={enter:{duration:.2,ease:TRANSITION_EASINGS.easeOut},exit:{duration:.1,ease:TRANSITION_EASINGS.easeIn}},withDelay={enter:(_,o)=>({..._,delay:typeof o=="number"?o:o==null?void 0:o.enter}),exit:(_,o)=>({..._,delay:typeof o=="number"?o:o==null?void 0:o.exit})},isNumeric=_=>_!=null&&parseInt(_.toString(),10)>0,defaultTransitions={exit:{height:{duration:.2,ease:TRANSITION_EASINGS.ease},opacity:{duration:.3,ease:TRANSITION_EASINGS.ease}},enter:{height:{duration:.3,ease:TRANSITION_EASINGS.ease},opacity:{duration:.4,ease:TRANSITION_EASINGS.ease}}},variants$3={exit:({animateOpacity:_,startingHeight:o,transition:$,transitionEnd:j,delay:et})=>{var tt;return{..._&&{opacity:isNumeric(o)?1:0},height:o,transitionEnd:j==null?void 0:j.exit,transition:(tt=$==null?void 0:$.exit)!=null?tt:withDelay.exit(defaultTransitions.exit,et)}},enter:({animateOpacity:_,endingHeight:o,transition:$,transitionEnd:j,delay:et})=>{var tt;return{..._&&{opacity:1},height:o,transitionEnd:j==null?void 0:j.enter,transition:(tt=$==null?void 0:$.enter)!=null?tt:withDelay.enter(defaultTransitions.enter,et)}}},Collapse=reactExports.forwardRef((_,o)=>{const{in:$,unmountOnExit:j,animateOpacity:et=!0,startingHeight:tt=0,endingHeight:rt="auto",style:nt,className:it,transition:st,transitionEnd:ot,...at}=_,[ct,ut]=reactExports.useState(!1);reactExports.useEffect(()=>{const Et=setTimeout(()=>{ut(!0)});return()=>clearTimeout(Et)},[]),warn({condition:!!(tt>0&&j),message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const ft=parseFloat(tt.toString())>0,ht={startingHeight:tt,endingHeight:rt,animateOpacity:et,transition:ct?st:{enter:{duration:0}},transitionEnd:{enter:ot==null?void 0:ot.enter,exit:j?ot==null?void 0:ot.exit:{...ot==null?void 0:ot.exit,display:ft?"block":"none"}}},mt=j?$:!0,gt=$||j?"enter":"exit";return jsx(AnimatePresence,{initial:!1,custom:ht,children:mt&&jsx(motion.div,{ref:o,...at,className:cx("chakra-collapse",it),style:{overflow:"hidden",display:"block",...nt},custom:ht,variants:variants$3,initial:j?"exit":!1,animate:gt,exit:"exit"})})});Collapse.displayName="Collapse";var variants$2={enter:({transition:_,transitionEnd:o,delay:$}={})=>{var j;return{opacity:1,transition:(j=_==null?void 0:_.enter)!=null?j:withDelay.enter(TRANSITION_DEFAULTS.enter,$),transitionEnd:o==null?void 0:o.enter}},exit:({transition:_,transitionEnd:o,delay:$}={})=>{var j;return{opacity:0,transition:(j=_==null?void 0:_.exit)!=null?j:withDelay.exit(TRANSITION_DEFAULTS.exit,$),transitionEnd:o==null?void 0:o.exit}}},fadeConfig={initial:"exit",animate:"enter",exit:"exit",variants:variants$2},Fade=reactExports.forwardRef(function(o,$){const{unmountOnExit:j,in:et,className:tt,transition:rt,transitionEnd:nt,delay:it,...st}=o,ot=et||j?"enter":"exit",at=j?et&&j:!0,ct={transition:rt,transitionEnd:nt,delay:it};return jsx(AnimatePresence,{custom:ct,children:at&&jsx(motion.div,{ref:$,className:cx("chakra-fade",tt),custom:ct,...fadeConfig,animate:ot,...st})})});Fade.displayName="Fade";var variants$1={exit:({reverse:_,initialScale:o,transition:$,transitionEnd:j,delay:et})=>{var tt;return{opacity:0,..._?{scale:o,transitionEnd:j==null?void 0:j.exit}:{transitionEnd:{scale:o,...j==null?void 0:j.exit}},transition:(tt=$==null?void 0:$.exit)!=null?tt:withDelay.exit(TRANSITION_DEFAULTS.exit,et)}},enter:({transitionEnd:_,transition:o,delay:$})=>{var j;return{opacity:1,scale:1,transition:(j=o==null?void 0:o.enter)!=null?j:withDelay.enter(TRANSITION_DEFAULTS.enter,$),transitionEnd:_==null?void 0:_.enter}}},scaleFadeConfig={initial:"exit",animate:"enter",exit:"exit",variants:variants$1},ScaleFade=reactExports.forwardRef(function(o,$){const{unmountOnExit:j,in:et,reverse:tt=!0,initialScale:rt=.95,className:nt,transition:it,transitionEnd:st,delay:ot,...at}=o,ct=j?et&&j:!0,ut=et||j?"enter":"exit",ft={initialScale:rt,reverse:tt,transition:it,transitionEnd:st,delay:ot};return jsx(AnimatePresence,{custom:ft,children:ct&&jsx(motion.div,{ref:$,className:cx("chakra-offset-slide",nt),...scaleFadeConfig,animate:ut,custom:ft,...at})})});ScaleFade.displayName="ScaleFade";var variants={initial:({offsetX:_,offsetY:o,transition:$,transitionEnd:j,delay:et})=>{var tt;return{opacity:0,x:_,y:o,transition:(tt=$==null?void 0:$.exit)!=null?tt:withDelay.exit(TRANSITION_DEFAULTS.exit,et),transitionEnd:j==null?void 0:j.exit}},enter:({transition:_,transitionEnd:o,delay:$})=>{var j;return{opacity:1,x:0,y:0,transition:(j=_==null?void 0:_.enter)!=null?j:withDelay.enter(TRANSITION_DEFAULTS.enter,$),transitionEnd:o==null?void 0:o.enter}},exit:({offsetY:_,offsetX:o,transition:$,transitionEnd:j,reverse:et,delay:tt})=>{var rt;const nt={x:o,y:_};return{opacity:0,transition:(rt=$==null?void 0:$.exit)!=null?rt:withDelay.exit(TRANSITION_DEFAULTS.exit,tt),...et?{...nt,transitionEnd:j==null?void 0:j.exit}:{transitionEnd:{...nt,...j==null?void 0:j.exit}}}}},slideFadeConfig={initial:"initial",animate:"enter",exit:"exit",variants},SlideFade=reactExports.forwardRef(function(o,$){const{unmountOnExit:j,in:et,reverse:tt=!0,className:rt,offsetX:nt=0,offsetY:it=8,transition:st,transitionEnd:ot,delay:at,...ct}=o,ut=j?et&&j:!0,ft=et||j?"enter":"exit",ht={offsetX:nt,offsetY:it,reverse:tt,transition:st,transitionEnd:ot,delay:at};return jsx(AnimatePresence,{custom:ht,children:ut&&jsx(motion.div,{ref:$,className:cx("chakra-offset-slide",rt),custom:ht,...slideFadeConfig,animate:ft,...ct})})});SlideFade.displayName="SlideFade";var AccordionPanel=forwardRef(function(o,$){const{className:j,motionProps:et,...tt}=o,{reduceMotion:rt}=useAccordionContext(),{getPanelProps:nt,isOpen:it}=useAccordionItemContext(),st=nt(tt,$),ot=cx("chakra-accordion__panel",j),at=useAccordionStyles();rt||delete st.hidden;const ct=jsx(chakra.div,{...st,__css:at.panel,className:ot});return rt?ct:jsx(Collapse,{in:it,...et,children:ct})});AccordionPanel.displayName="AccordionPanel";var Accordion=forwardRef(function({children:o,reduceMotion:$,...j},et){const tt=useMultiStyleConfig("Accordion",j),rt=omitThemingProps(j),{htmlProps:nt,descendants:it,...st}=useAccordion(rt),ot=reactExports.useMemo(()=>({...st,reduceMotion:!!$}),[st,$]);return jsx(AccordionDescendantsProvider,{value:it,children:jsx(AccordionProvider,{value:ot,children:jsx(AccordionStylesProvider,{value:tt,children:jsx(chakra.div,{ref:et,...nt,className:cx("chakra-accordion",j.className),__css:tt.root,children:o})})})})});Accordion.displayName="Accordion";var[AvatarStylesProvider,useAvatarStyles]=createContext$1({name:"AvatarStylesContext",hookName:"useAvatarStyles",providerName:"<Avatar/>"});function initials(_){const[o,$]=_.split(" ");return o&&$?`${o.charAt(0)}${$.charAt(0)}`:o.charAt(0)}function AvatarName(_){const{name:o,getInitials:$,...j}=_,et=useAvatarStyles();return jsx(chakra.div,{role:"img","aria-label":o,...j,__css:et.label,children:o?$==null?void 0:$(o):null})}AvatarName.displayName="AvatarName";var GenericAvatarIcon=_=>jsxs(chakra.svg,{viewBox:"0 0 128 128",color:"#fff",width:"100%",height:"100%",className:"chakra-avatar__svg",..._,children:[jsx("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),jsx("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]});function useImage(_){const{loading:o,src:$,srcSet:j,onLoad:et,onError:tt,crossOrigin:rt,sizes:nt,ignoreFallback:it}=_,[st,ot]=reactExports.useState("pending");reactExports.useEffect(()=>{ot($?"loading":"pending")},[$]);const at=reactExports.useRef(),ct=reactExports.useCallback(()=>{if(!$)return;ut();const ft=new Image;ft.src=$,rt&&(ft.crossOrigin=rt),j&&(ft.srcset=j),nt&&(ft.sizes=nt),o&&(ft.loading=o),ft.onload=ht=>{ut(),ot("loaded"),et==null||et(ht)},ft.onerror=ht=>{ut(),ot("failed"),tt==null||tt(ht)},at.current=ft},[$,rt,j,nt,et,tt,o]),ut=()=>{at.current&&(at.current.onload=null,at.current.onerror=null,at.current=null)};return useSafeLayoutEffect$2(()=>{if(!it)return st==="loading"&&ct(),()=>{ut()}},[st,ct,it]),it?"loaded":st}function AvatarImage(_){const{src:o,srcSet:$,onError:j,onLoad:et,getInitials:tt,name:rt,borderRadius:nt,loading:it,iconLabel:st,icon:ot=jsx(GenericAvatarIcon,{}),ignoreFallback:at,referrerPolicy:ct}=_,ft=useImage({src:o,onError:j,ignoreFallback:at})==="loaded";return!o||!ft?rt?jsx(AvatarName,{className:"chakra-avatar__initials",getInitials:tt,name:rt}):reactExports.cloneElement(ot,{role:"img","aria-label":st}):jsx(chakra.img,{src:o,srcSet:$,alt:rt,onLoad:et,referrerPolicy:ct,className:"chakra-avatar__img",loading:it,__css:{width:"100%",height:"100%",objectFit:"cover",borderRadius:nt}})}AvatarImage.displayName="AvatarImage";var baseStyle={display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",textTransform:"uppercase",fontWeight:"medium",position:"relative",flexShrink:0},Avatar=forwardRef((_,o)=>{const $=useMultiStyleConfig("Avatar",_),[j,et]=reactExports.useState(!1),{src:tt,srcSet:rt,name:nt,showBorder:it,borderRadius:st="full",onError:ot,onLoad:at,getInitials:ct=initials,icon:ut=jsx(GenericAvatarIcon,{}),iconLabel:ft=" avatar",loading:ht,children:mt,borderColor:gt,ignoreFallback:Et,...St}=omitThemingProps(_),At={borderRadius:st,borderWidth:it?"2px":void 0,...baseStyle,...$.container};return gt&&(At.borderColor=gt),jsx(chakra.span,{ref:o,...St,className:cx("chakra-avatar",_.className),"data-loaded":dataAttr(j),__css:At,children:jsxs(AvatarStylesProvider,{value:$,children:[jsx(AvatarImage,{src:tt,srcSet:rt,loading:ht,onLoad:callAllHandlers$1(at,()=>{et(!0)}),onError:ot,getInitials:ct,name:nt,borderRadius:st,icon:ut,iconLabel:ft,ignoreFallback:Et}),mt]})})});Avatar.displayName="Avatar";function getValidChildren(_){return reactExports.Children.toArray(_).filter(o=>reactExports.isValidElement(o))}var[ButtonGroupProvider,useButtonGroup]=createContext$1({strict:!1,name:"ButtonGroupContext"});function useButtonType(_){const[o,$]=reactExports.useState(!_);return{ref:reactExports.useCallback(tt=>{tt&&$(tt.tagName==="BUTTON")},[]),type:o?"button":void 0}}function ButtonIcon(_){const{children:o,className:$,...j}=_,et=reactExports.isValidElement(o)?reactExports.cloneElement(o,{"aria-hidden":!0,focusable:!1}):o,tt=cx("chakra-button__icon",$);return jsx(chakra.span,{display:"inline-flex",alignSelf:"center",flexShrink:0,...j,className:tt,children:et})}ButtonIcon.displayName="ButtonIcon";function ButtonSpinner(_){const{label:o,placement:$,spacing:j="0.5rem",children:et=jsx(Spinner,{color:"currentColor",width:"1em",height:"1em"}),className:tt,__css:rt,...nt}=_,it=cx("chakra-button__spinner",tt),st=$==="start"?"marginEnd":"marginStart",ot=reactExports.useMemo(()=>({display:"flex",alignItems:"center",position:o?"relative":"absolute",[st]:o?j:0,fontSize:"1em",lineHeight:"normal",...rt}),[rt,o,st,j]);return jsx(chakra.div,{className:it,...nt,__css:ot,children:et})}ButtonSpinner.displayName="ButtonSpinner";var Button=forwardRef((_,o)=>{const $=useButtonGroup(),j=useStyleConfig("Button",{...$,..._}),{isDisabled:et=$==null?void 0:$.isDisabled,isLoading:tt,isActive:rt,children:nt,leftIcon:it,rightIcon:st,loadingText:ot,iconSpacing:at="0.5rem",type:ct,spinner:ut,spinnerPlacement:ft="start",className:ht,as:mt,...gt}=omitThemingProps(_),Et=reactExports.useMemo(()=>{const Rt={...j==null?void 0:j._focus,zIndex:1};return{display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",...j,...!!$&&{_focus:Rt}}},[j,$]),{ref:St,type:At}=useButtonType(mt),kt={rightIcon:st,leftIcon:it,iconSpacing:at,children:nt};return jsxs(chakra.button,{ref:useMergeRefs$1(o,St),as:mt,type:ct??At,"data-active":dataAttr(rt),"data-loading":dataAttr(tt),__css:Et,className:cx("chakra-button",ht),...gt,disabled:et||tt,children:[tt&&ft==="start"&&jsx(ButtonSpinner,{className:"chakra-button__spinner--start",label:ot,placement:"start",spacing:at,children:ut}),tt?ot||jsx(chakra.span,{opacity:0,children:jsx(ButtonContent,{...kt})}):jsx(ButtonContent,{...kt}),tt&&ft==="end"&&jsx(ButtonSpinner,{className:"chakra-button__spinner--end",label:ot,placement:"end",spacing:at,children:ut})]})});Button.displayName="Button";function ButtonContent(_){const{leftIcon:o,rightIcon:$,children:j,iconSpacing:et}=_;return jsxs(Fragment,{children:[o&&jsx(ButtonIcon,{marginEnd:et,children:o}),j,$&&jsx(ButtonIcon,{marginStart:et,children:$})]})}var IconButton=forwardRef((_,o)=>{const{icon:$,children:j,isRound:et,"aria-label":tt,...rt}=_,nt=$||j,it=reactExports.isValidElement(nt)?reactExports.cloneElement(nt,{"aria-hidden":!0,focusable:!1}):null;return jsx(Button,{padding:"0",borderRadius:et?"full":void 0,ref:o,"aria-label":tt,...rt,children:it})});IconButton.displayName="IconButton";var[FormControlStylesProvider,useFormControlStyles]=createContext$1({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[FormControlProvider,useFormControlContext]=createContext$1({strict:!1,name:"FormControlContext"});function useFormControlProvider(_){const{id:o,isRequired:$,isInvalid:j,isDisabled:et,isReadOnly:tt,...rt}=_,nt=reactExports.useId(),it=o||`field-${nt}`,st=`${it}-label`,ot=`${it}-feedback`,at=`${it}-helptext`,[ct,ut]=reactExports.useState(!1),[ft,ht]=reactExports.useState(!1),[mt,gt]=reactExports.useState(!1),Et=reactExports.useCallback((Tt={},Dt=null)=>({id:at,...Tt,ref:mergeRefs(Dt,Ot=>{Ot&&ht(!0)})}),[at]),St=reactExports.useCallback((Tt={},Dt=null)=>{var Ot,jt;return{...Tt,ref:Dt,"data-focus":dataAttr(mt),"data-disabled":dataAttr(et),"data-invalid":dataAttr(j),"data-readonly":dataAttr(tt),id:(Ot=Tt.id)!=null?Ot:st,htmlFor:(jt=Tt.htmlFor)!=null?jt:it}},[it,et,mt,j,tt,st]),At=reactExports.useCallback((Tt={},Dt=null)=>({id:ot,...Tt,ref:mergeRefs(Dt,Ot=>{Ot&&ut(!0)}),"aria-live":"polite"}),[ot]),kt=reactExports.useCallback((Tt={},Dt=null)=>({...Tt,...rt,ref:Dt,role:"group"}),[rt]),Rt=reactExports.useCallback((Tt={},Dt=null)=>({...Tt,ref:Dt,role:"presentation","aria-hidden":!0,children:Tt.children||"*"}),[]);return{isRequired:!!$,isInvalid:!!j,isReadOnly:!!tt,isDisabled:!!et,isFocused:!!mt,onFocus:()=>gt(!0),onBlur:()=>gt(!1),hasFeedbackText:ct,setHasFeedbackText:ut,hasHelpText:ft,setHasHelpText:ht,id:it,labelId:st,feedbackId:ot,helpTextId:at,htmlProps:rt,getHelpTextProps:Et,getErrorMessageProps:At,getRootProps:kt,getLabelProps:St,getRequiredIndicatorProps:Rt}}var FormControl=forwardRef(function(o,$){const j=useMultiStyleConfig("Form",o),et=omitThemingProps(o),{getRootProps:tt,htmlProps:rt,...nt}=useFormControlProvider(et),it=cx("chakra-form-control",o.className);return jsx(FormControlProvider,{value:nt,children:jsx(FormControlStylesProvider,{value:j,children:jsx(chakra.div,{...tt({},$),className:it,__css:j.container})})})});FormControl.displayName="FormControl";var FormHelperText=forwardRef(function(o,$){const j=useFormControlContext(),et=useFormControlStyles(),tt=cx("chakra-form__helper-text",o.className);return jsx(chakra.div,{...j==null?void 0:j.getHelpTextProps(o,$),__css:et.helperText,className:tt})});FormHelperText.displayName="FormHelperText";var FormLabel=forwardRef(function(o,$){var j;const et=useStyleConfig("FormLabel",o),tt=omitThemingProps(o),{className:rt,children:nt,requiredIndicator:it=jsx(RequiredIndicator,{}),optionalIndicator:st=null,...ot}=tt,at=useFormControlContext(),ct=(j=at==null?void 0:at.getLabelProps(ot,$))!=null?j:{ref:$,...ot};return jsxs(chakra.label,{...ct,className:cx("chakra-form__label",tt.className),__css:{display:"block",textAlign:"start",...et},children:[nt,at!=null&&at.isRequired?it:st]})});FormLabel.displayName="FormLabel";var RequiredIndicator=forwardRef(function(o,$){const j=useFormControlContext(),et=useFormControlStyles();if(!(j!=null&&j.isRequired))return null;const tt=cx("chakra-form__required-indicator",o.className);return jsx(chakra.span,{...j==null?void 0:j.getRequiredIndicatorProps(o,$),__css:et.requiredIndicator,className:tt})});RequiredIndicator.displayName="RequiredIndicator";function useFormControl(_){const{isDisabled:o,isInvalid:$,isReadOnly:j,isRequired:et,...tt}=useFormControlProps(_);return{...tt,disabled:o,readOnly:j,required:et,"aria-invalid":ariaAttr($),"aria-required":ariaAttr(et),"aria-readonly":ariaAttr(j)}}function useFormControlProps(_){var o,$,j;const et=useFormControlContext(),{id:tt,disabled:rt,readOnly:nt,required:it,isRequired:st,isInvalid:ot,isReadOnly:at,isDisabled:ct,onFocus:ut,onBlur:ft,...ht}=_,mt=_["aria-describedby"]?[_["aria-describedby"]]:[];return et!=null&&et.hasFeedbackText&&(et!=null&&et.isInvalid)&&mt.push(et.feedbackId),et!=null&&et.hasHelpText&&mt.push(et.helpTextId),{...ht,"aria-describedby":mt.join(" ")||void 0,id:tt??(et==null?void 0:et.id),isDisabled:(o=rt??ct)!=null?o:et==null?void 0:et.isDisabled,isReadOnly:($=nt??at)!=null?$:et==null?void 0:et.isReadOnly,isRequired:(j=it??st)!=null?j:et==null?void 0:et.isRequired,isInvalid:ot??(et==null?void 0:et.isInvalid),onFocus:callAllHandlers$1(et==null?void 0:et.onFocus,ut),onBlur:callAllHandlers$1(et==null?void 0:et.onBlur,ft)}}function _objectWithoutPropertiesLoose(_,o){if(_==null)return{};var $={},j=Object.keys(_),et,tt;for(tt=0;tt<j.length;tt++)et=j[tt],!(o.indexOf(et)>=0)&&($[et]=_[et]);return $}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(_){for(var o=1;o<arguments.length;o++){var $=arguments[o];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends$1.apply(this,arguments)}var FOCUS_GROUP="data-focus-lock",FOCUS_DISABLED="data-focus-lock-disabled",FOCUS_ALLOW="data-no-focus-lock",FOCUS_AUTO="data-autofocus-inside",FOCUS_NO_AUTOFOCUS="data-no-autofocus";function assignRef(_,o){return typeof _=="function"?_(o):_&&(_.current=o),_}function useCallbackRef$1(_,o){var $=reactExports.useState(function(){return{value:_,callback:o,facade:{get current(){return $.value},set current(j){var et=$.value;et!==j&&($.value=j,$.callback(j,et))}}}})[0];return $.callback=o,$.facade}function useMergeRefs(_,o){return useCallbackRef$1(o||null,function($){return _.forEach(function(j){return assignRef(j,$)})})}var hiddenGuard={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},__assign=function(){return __assign=Object.assign||function(o){for(var $,j=1,et=arguments.length;j<et;j++){$=arguments[j];for(var tt in $)Object.prototype.hasOwnProperty.call($,tt)&&(o[tt]=$[tt])}return o},__assign.apply(this,arguments)};function __rest(_,o){var $={};for(var j in _)Object.prototype.hasOwnProperty.call(_,j)&&o.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&typeof Object.getOwnPropertySymbols=="function")for(var et=0,j=Object.getOwnPropertySymbols(_);et<j.length;et++)o.indexOf(j[et])<0&&Object.prototype.propertyIsEnumerable.call(_,j[et])&&($[j[et]]=_[j[et]]);return $}function __spreadArray(_,o,$){if($||arguments.length===2)for(var j=0,et=o.length,tt;j<et;j++)(tt||!(j in o))&&(tt||(tt=Array.prototype.slice.call(o,0,j)),tt[j]=o[j]);return _.concat(tt||Array.prototype.slice.call(o))}function ItoI(_){return _}function innerCreateMedium(_,o){o===void 0&&(o=ItoI);var $=[],j=!1,et={read:function(){if(j)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return $.length?$[$.length-1]:_},useMedium:function(tt){var rt=o(tt,j);return $.push(rt),function(){$=$.filter(function(nt){return nt!==rt})}},assignSyncMedium:function(tt){for(j=!0;$.length;){var rt=$;$=[],rt.forEach(tt)}$={push:function(nt){return tt(nt)},filter:function(){return $}}},assignMedium:function(tt){j=!0;var rt=[];if($.length){var nt=$;$=[],nt.forEach(tt),rt=$}var it=function(){var ot=rt;rt=[],ot.forEach(tt)},st=function(){return Promise.resolve().then(it)};st(),$={push:function(ot){rt.push(ot),st()},filter:function(ot){return rt=rt.filter(ot),$}}}};return et}function createMedium(_,o){return o===void 0&&(o=ItoI),innerCreateMedium(_,o)}function createSidecarMedium(_){_===void 0&&(_={});var o=innerCreateMedium(null);return o.options=__assign({async:!0,ssr:!1},_),o}var SideCar$1=function(_){var o=_.sideCar,$=__rest(_,["sideCar"]);if(!o)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var j=o.read();if(!j)throw new Error("Sidecar medium not found");return reactExports.createElement(j,__assign({},$))};SideCar$1.isSideCarExport=!0;function exportSidecar(_,o){return _.useMedium(o),SideCar$1}var mediumFocus=createMedium({},function(_){var o=_.target,$=_.currentTarget;return{target:o,currentTarget:$}}),mediumBlur=createMedium(),mediumEffect=createMedium(),mediumSidecar=createSidecarMedium({async:!0}),emptyArray=[],FocusLock$2=reactExports.forwardRef(function(o,$){var j,et=reactExports.useState(),tt=et[0],rt=et[1],nt=reactExports.useRef(),it=reactExports.useRef(!1),st=reactExports.useRef(null),ot=o.children,at=o.disabled,ct=o.noFocusGuards,ut=o.persistentFocus,ft=o.crossFrame,ht=o.autoFocus;o.allowTextSelection;var mt=o.group,gt=o.className,Et=o.whiteList,St=o.hasPositiveIndices,At=o.shards,kt=At===void 0?emptyArray:At,Rt=o.as,Tt=Rt===void 0?"div":Rt,Dt=o.lockProps,Ot=Dt===void 0?{}:Dt,jt=o.sideCar,Nt=o.returnFocus,It=o.focusOptions,yt=o.onActivation,lt=o.onDeactivation,pt=reactExports.useState({}),bt=pt[0],_t=reactExports.useCallback(function(){st.current=st.current||document&&document.activeElement,nt.current&&yt&&yt(nt.current),it.current=!0},[yt]),$t=reactExports.useCallback(function(){it.current=!1,lt&&lt(nt.current)},[lt]);reactExports.useEffect(function(){at||(st.current=null)},[]);var Ct=reactExports.useCallback(function(Wt){var Vt=st.current;if(Vt&&Vt.focus){var Ut=typeof Nt=="function"?Nt(Vt):Nt;if(Ut){var Mt=typeof Ut=="object"?Ut:void 0;st.current=null,Wt?Promise.resolve().then(function(){return Vt.focus(Mt)}):Vt.focus(Mt)}}},[Nt]),xt=reactExports.useCallback(function(Wt){it.current&&mediumFocus.useMedium(Wt)},[]),vt=mediumBlur.useMedium,dt=reactExports.useCallback(function(Wt){nt.current!==Wt&&(nt.current=Wt,rt(Wt))},[]),wt=_extends$1((j={},j[FOCUS_DISABLED]=at&&"disabled",j[FOCUS_GROUP]=mt,j),Ot),qt=ct!==!0,Pt=qt&&ct!=="tail",Gt=useMergeRefs([$,dt]);return reactExports.createElement(reactExports.Fragment,null,qt&&[reactExports.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:at?-1:0,style:hiddenGuard}),St?reactExports.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:at?-1:1,style:hiddenGuard}):null],!at&&reactExports.createElement(jt,{id:bt,sideCar:mediumSidecar,observed:tt,disabled:at,persistentFocus:ut,crossFrame:ft,autoFocus:ht,whiteList:Et,shards:kt,onActivation:_t,onDeactivation:$t,returnFocus:Ct,focusOptions:It}),reactExports.createElement(Tt,_extends$1({ref:Gt},wt,{className:gt,onBlur:vt,onFocus:xt}),ot),Pt&&reactExports.createElement("div",{"data-focus-guard":!0,tabIndex:at?-1:0,style:hiddenGuard}))});FocusLock$2.propTypes={};FocusLock$2.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};const FocusLockUI=FocusLock$2;function _setPrototypeOf(_,o){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,et){return j.__proto__=et,j},_setPrototypeOf(_,o)}function _inheritsLoose(_,o){_.prototype=Object.create(o.prototype),_.prototype.constructor=_,_setPrototypeOf(_,o)}function _typeof$2(_){return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof$2(_)}function _toPrimitive(_,o){if(_typeof$2(_)!=="object"||_===null)return _;var $=_[Symbol.toPrimitive];if($!==void 0){var j=$.call(_,o||"default");if(_typeof$2(j)!=="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(_)}function _toPropertyKey(_){var o=_toPrimitive(_,"string");return _typeof$2(o)==="symbol"?o:String(o)}function _defineProperty(_,o,$){return o=_toPropertyKey(o),o in _?Object.defineProperty(_,o,{value:$,enumerable:!0,configurable:!0,writable:!0}):_[o]=$,_}function withSideEffect(_,o){function $(j){return j.displayName||j.name||"Component"}return function(et){var tt=[],rt;function nt(){rt=_(tt.map(function(st){return st.props})),o(rt)}var it=function(st){_inheritsLoose(ot,st);function ot(){return st.apply(this,arguments)||this}ot.peek=function(){return rt};var at=ot.prototype;return at.componentDidMount=function(){tt.push(this),nt()},at.componentDidUpdate=function(){nt()},at.componentWillUnmount=function(){var ut=tt.indexOf(this);tt.splice(ut,1),nt()},at.render=function(){return React.createElement(et,this.props)},ot}(reactExports.PureComponent);return _defineProperty(it,"displayName","SideEffect("+$(et)+")"),it}}var toArray$1=function(_){for(var o=Array(_.length),$=0;$<_.length;++$)o[$]=_[$];return o},asArray=function(_){return Array.isArray(_)?_:[_]},getFirst=function(_){return Array.isArray(_)?_[0]:_},isElementHidden=function(_){if(_.nodeType!==Node.ELEMENT_NODE)return!1;var o=window.getComputedStyle(_,null);return!o||!o.getPropertyValue?!1:o.getPropertyValue("display")==="none"||o.getPropertyValue("visibility")==="hidden"},getParentNode=function(_){return _.parentNode&&_.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.parentNode.host:_.parentNode},isTopNode=function(_){return _===document||_&&_.nodeType===Node.DOCUMENT_NODE},isVisibleUncached=function(_,o){return!_||isTopNode(_)||!isElementHidden(_)&&o(getParentNode(_))},isVisibleCached=function(_,o){var $=_.get(o);if($!==void 0)return $;var j=isVisibleUncached(o,isVisibleCached.bind(void 0,_));return _.set(o,j),j},isAutoFocusAllowedUncached=function(_,o){return _&&!isTopNode(_)?isAutoFocusAllowed(_)?o(getParentNode(_)):!1:!0},isAutoFocusAllowedCached=function(_,o){var $=_.get(o);if($!==void 0)return $;var j=isAutoFocusAllowedUncached(o,isAutoFocusAllowedCached.bind(void 0,_));return _.set(o,j),j},getDataset=function(_){return _.dataset},isHTMLButtonElement=function(_){return _.tagName==="BUTTON"},isHTMLInputElement=function(_){return _.tagName==="INPUT"},isRadioElement=function(_){return isHTMLInputElement(_)&&_.type==="radio"},notHiddenInput=function(_){return!((isHTMLInputElement(_)||isHTMLButtonElement(_))&&(_.type==="hidden"||_.disabled))},isAutoFocusAllowed=function(_){var o=_.getAttribute(FOCUS_NO_AUTOFOCUS);return![!0,"true",""].includes(o)},isGuard=function(_){var o;return!!(_&&(!((o=getDataset(_))===null||o===void 0)&&o.focusGuard))},isNotAGuard=function(_){return!isGuard(_)},isDefined$3=function(_){return!!_},tabSort=function(_,o){var $=_.tabIndex-o.tabIndex,j=_.index-o.index;if($){if(!_.tabIndex)return 1;if(!o.tabIndex)return-1}return $||j},orderByTabIndex=function(_,o,$){return toArray$1(_).map(function(j,et){return{node:j,index:et,tabIndex:$&&j.tabIndex===-1?(j.dataset||{}).focusGuard?0:-1:j.tabIndex}}).filter(function(j){return!o||j.tabIndex>=0}).sort(tabSort)},tabbables=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],queryTabbables=tabbables.join(","),queryGuardTabbables="".concat(queryTabbables,", [data-focus-guard]"),getFocusablesWithShadowDom=function(_,o){return toArray$1((_.shadowRoot||_).children).reduce(function($,j){return $.concat(j.matches(o?queryGuardTabbables:queryTabbables)?[j]:[],getFocusablesWithShadowDom(j))},[])},getFocusablesWithIFrame=function(_,o){var $;return _ instanceof HTMLIFrameElement&&(!(($=_.contentDocument)===null||$===void 0)&&$.body)?getFocusables([_.contentDocument.body],o):[_]},getFocusables=function(_,o){return _.reduce(function($,j){var et,tt=getFocusablesWithShadowDom(j,o),rt=(et=[]).concat.apply(et,tt.map(function(nt){return getFocusablesWithIFrame(nt,o)}));return $.concat(rt,j.parentNode?toArray$1(j.parentNode.querySelectorAll(queryTabbables)).filter(function(nt){return nt===j}):[])},[])},getParentAutofocusables=function(_){var o=_.querySelectorAll("[".concat(FOCUS_AUTO,"]"));return toArray$1(o).map(function($){return getFocusables([$])}).reduce(function($,j){return $.concat(j)},[])},filterFocusable=function(_,o){return toArray$1(_).filter(function($){return isVisibleCached(o,$)}).filter(function($){return notHiddenInput($)})},filterAutoFocusable=function(_,o){return o===void 0&&(o=new Map),toArray$1(_).filter(function($){return isAutoFocusAllowedCached(o,$)})},getTabbableNodes=function(_,o,$){return orderByTabIndex(filterFocusable(getFocusables(_,$),o),!0,$)},getAllTabbableNodes=function(_,o){return orderByTabIndex(filterFocusable(getFocusables(_),o),!1)},parentAutofocusables=function(_,o){return filterFocusable(getParentAutofocusables(_),o)},contains=function(_,o){return _.shadowRoot?contains(_.shadowRoot,o):Object.getPrototypeOf(_).contains!==void 0&&Object.getPrototypeOf(_).contains.call(_,o)?!0:toArray$1(_.children).some(function($){var j;if($ instanceof HTMLIFrameElement){var et=(j=$.contentDocument)===null||j===void 0?void 0:j.body;return et?contains(et,o):!1}return contains($,o)})},filterNested=function(_){for(var o=new Set,$=_.length,j=0;j<$;j+=1)for(var et=j+1;et<$;et+=1){var tt=_[j].compareDocumentPosition(_[et]);(tt&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&o.add(et),(tt&Node.DOCUMENT_POSITION_CONTAINS)>0&&o.add(j)}return _.filter(function(rt,nt){return!o.has(nt)})},getTopParent=function(_){return _.parentNode?getTopParent(_.parentNode):_},getAllAffectedNodes=function(_){var o=asArray(_);return o.filter(Boolean).reduce(function($,j){var et=j.getAttribute(FOCUS_GROUP);return $.push.apply($,et?filterNested(toArray$1(getTopParent(j).querySelectorAll("[".concat(FOCUS_GROUP,'="').concat(et,'"]:not([').concat(FOCUS_DISABLED,'="disabled"])')))):[j]),$},[])},safeProbe=function(_){try{return _()}catch{return}},getActiveElement=function(_){if(_===void 0&&(_=document),!(!_||!_.activeElement)){var o=_.activeElement;return o.shadowRoot?getActiveElement(o.shadowRoot):o instanceof HTMLIFrameElement&&safeProbe(function(){return o.contentWindow.document})?getActiveElement(o.contentWindow.document):o}},focusInFrame=function(_,o){return _===o},focusInsideIframe=function(_,o){return!!toArray$1(_.querySelectorAll("iframe")).some(function($){return focusInFrame($,o)})},focusInside=function(_,o){return o===void 0&&(o=getActiveElement(getFirst(_).ownerDocument)),!o||o.dataset&&o.dataset.focusGuard?!1:getAllAffectedNodes(_).some(function($){return contains($,o)||focusInsideIframe($,o)})},focusIsHidden=function(_){_===void 0&&(_=document);var o=getActiveElement(_);return o?toArray$1(_.querySelectorAll("[".concat(FOCUS_ALLOW,"]"))).some(function($){return contains($,o)}):!1},findSelectedRadio=function(_,o){return o.filter(isRadioElement).filter(function($){return $.name===_.name}).filter(function($){return $.checked})[0]||_},correctNode=function(_,o){return isRadioElement(_)&&_.name?findSelectedRadio(_,o):_},correctNodes=function(_){var o=new Set;return _.forEach(function($){return o.add(correctNode($,_))}),_.filter(function($){return o.has($)})},pickFirstFocus=function(_){return _[0]&&_.length>1?correctNode(_[0],_):_[0]},pickFocusable=function(_,o){return _.length>1?_.indexOf(correctNode(_[o],_)):o},NEW_FOCUS="NEW_FOCUS",newFocus=function(_,o,$,j){var et=_.length,tt=_[0],rt=_[et-1],nt=isGuard($);if(!($&&_.indexOf($)>=0)){var it=$!==void 0?o.indexOf($):-1,st=j?o.indexOf(j):it,ot=j?_.indexOf(j):-1,at=it-st,ct=o.indexOf(tt),ut=o.indexOf(rt),ft=correctNodes(o),ht=$!==void 0?ft.indexOf($):-1,mt=ht-(j?ft.indexOf(j):it),gt=pickFocusable(_,0),Et=pickFocusable(_,et-1);if(it===-1||ot===-1)return NEW_FOCUS;if(!at&&ot>=0)return ot;if(it<=ct&&nt&&Math.abs(at)>1)return Et;if(it>=ut&&nt&&Math.abs(at)>1)return gt;if(at&&Math.abs(mt)>1)return ot;if(it<=ct)return Et;if(it>ut)return gt;if(at)return Math.abs(at)>1?ot:(et+ot+at)%et}},findAutoFocused=function(_){return function(o){var $,j=($=getDataset(o))===null||$===void 0?void 0:$.autofocus;return o.autofocus||j!==void 0&&j!=="false"||_.indexOf(o)>=0}},pickAutofocus=function(_,o,$){var j=_.map(function(tt){var rt=tt.node;return rt}),et=filterAutoFocusable(j.filter(findAutoFocused($)));return et&&et.length?pickFirstFocus(et):pickFirstFocus(filterAutoFocusable(o))},getParents=function(_,o){return o===void 0&&(o=[]),o.push(_),_.parentNode&&getParents(_.parentNode.host||_.parentNode,o),o},getCommonParent=function(_,o){for(var $=getParents(_),j=getParents(o),et=0;et<$.length;et+=1){var tt=$[et];if(j.indexOf(tt)>=0)return tt}return!1},getTopCommonParent=function(_,o,$){var j=asArray(_),et=asArray(o),tt=j[0],rt=!1;return et.filter(Boolean).forEach(function(nt){rt=getCommonParent(rt||nt,nt)||rt,$.filter(Boolean).forEach(function(it){var st=getCommonParent(tt,it);st&&(!rt||contains(st,rt)?rt=st:rt=getCommonParent(st,rt))})}),rt},allParentAutofocusables=function(_,o){return _.reduce(function($,j){return $.concat(parentAutofocusables(j,o))},[])},reorderNodes=function(_,o){var $=new Map;return o.forEach(function(j){return $.set(j.node,j)}),_.map(function(j){return $.get(j)}).filter(isDefined$3)},getFocusMerge=function(_,o){var $=getActiveElement(asArray(_).length>0?document:getFirst(_).ownerDocument),j=getAllAffectedNodes(_).filter(isNotAGuard),et=getTopCommonParent($||_,_,j),tt=new Map,rt=getAllTabbableNodes(j,tt),nt=getTabbableNodes(j,tt).filter(function(ut){var ft=ut.node;return isNotAGuard(ft)});if(!(!nt[0]&&(nt=rt,!nt[0]))){var it=getAllTabbableNodes([et],tt).map(function(ut){var ft=ut.node;return ft}),st=reorderNodes(it,nt),ot=st.map(function(ut){var ft=ut.node;return ft}),at=newFocus(ot,it,$,o);if(at===NEW_FOCUS){var ct=pickAutofocus(rt,ot,allParentAutofocusables(j,tt));if(ct)return{node:ct};console.warn("focus-lock: cannot find any node to move focus into");return}return at===void 0?at:st[at]}},getFocusabledIn=function(_){var o=getAllAffectedNodes(_).filter(isNotAGuard),$=getTopCommonParent(_,_,o),j=new Map,et=getTabbableNodes([$],j,!0),tt=getTabbableNodes(o,j).filter(function(rt){var nt=rt.node;return isNotAGuard(nt)}).map(function(rt){var nt=rt.node;return nt});return et.map(function(rt){var nt=rt.node,it=rt.index;return{node:nt,index:it,lockItem:tt.indexOf(nt)>=0,guard:isGuard(nt)}})},focusOn=function(_,o){"focus"in _&&_.focus(o),"contentWindow"in _&&_.contentWindow&&_.contentWindow.focus()},guardCount=0,lockDisabled=!1,setFocus=function(_,o,$){$===void 0&&($={});var j=getFocusMerge(_,o);if(!lockDisabled&&j){if(guardCount>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),lockDisabled=!0,setTimeout(function(){lockDisabled=!1},1);return}guardCount++,focusOn(j.node,$.focusOptions),guardCount--}};function deferAction(_){var o=window,$=o.setImmediate;typeof $<"u"?$(_):setTimeout(_,1)}var focusOnBody=function(){return document&&document.activeElement===document.body},isFreeFocus=function(){return focusOnBody()||focusIsHidden()},lastActiveTrap=null,lastActiveFocus=null,lastPortaledElement=null,focusWasOutsideWindow=!1,defaultWhitelist=function(){return!0},focusWhitelisted=function(o){return(lastActiveTrap.whiteList||defaultWhitelist)(o)},recordPortal=function(o,$){lastPortaledElement={observerNode:o,portaledElement:$}},focusIsPortaledPair=function(o){return lastPortaledElement&&lastPortaledElement.portaledElement===o};function autoGuard(_,o,$,j){var et=null,tt=_;do{var rt=j[tt];if(rt.guard)rt.node.dataset.focusAutoGuard&&(et=rt);else if(rt.lockItem){if(tt!==_)return;et=null}else break}while((tt+=$)!==o);et&&(et.node.tabIndex=0)}var extractRef$1=function(o){return o&&"current"in o?o.current:o},focusWasOutside=function(o){return o?!!focusWasOutsideWindow:focusWasOutsideWindow==="meanwhile"},checkInHost=function _(o,$,j){return $&&($.host===o&&(!$.activeElement||j.contains($.activeElement))||$.parentNode&&_(o,$.parentNode,j))},withinHost=function(o,$){return $.some(function(j){return checkInHost(o,j,j)})},activateTrap=function(){var o=!1;if(lastActiveTrap){var $=lastActiveTrap,j=$.observed,et=$.persistentFocus,tt=$.autoFocus,rt=$.shards,nt=$.crossFrame,it=$.focusOptions,st=j||lastPortaledElement&&lastPortaledElement.portaledElement,ot=document&&document.activeElement;if(st){var at=[st].concat(rt.map(extractRef$1).filter(Boolean));if((!ot||focusWhitelisted(ot))&&(et||focusWasOutside(nt)||!isFreeFocus()||!lastActiveFocus&&tt)&&(st&&!(focusInside(at)||ot&&withinHost(ot,at)||focusIsPortaledPair(ot))&&(document&&!lastActiveFocus&&ot&&!tt?(ot.blur&&ot.blur(),document.body.focus()):(o=setFocus(at,lastActiveFocus,{focusOptions:it}),lastPortaledElement={})),focusWasOutsideWindow=!1,lastActiveFocus=document&&document.activeElement),document){var ct=document&&document.activeElement,ut=getFocusabledIn(at),ft=ut.map(function(ht){var mt=ht.node;return mt}).indexOf(ct);ft>-1&&(ut.filter(function(ht){var mt=ht.guard,gt=ht.node;return mt&&gt.dataset.focusAutoGuard}).forEach(function(ht){var mt=ht.node;return mt.removeAttribute("tabIndex")}),autoGuard(ft,ut.length,1,ut),autoGuard(ft,-1,-1,ut))}}}return o},onTrap=function(o){activateTrap()&&o&&(o.stopPropagation(),o.preventDefault())},onBlur=function(){return deferAction(activateTrap)},onFocus=function(o){var $=o.target,j=o.currentTarget;j.contains($)||recordPortal(j,$)},FocusWatcher=function(){return null},onWindowBlur=function(){focusWasOutsideWindow="just",setTimeout(function(){focusWasOutsideWindow="meanwhile"},0)},attachHandler=function(){document.addEventListener("focusin",onTrap),document.addEventListener("focusout",onBlur),window.addEventListener("blur",onWindowBlur)},detachHandler=function(){document.removeEventListener("focusin",onTrap),document.removeEventListener("focusout",onBlur),window.removeEventListener("blur",onWindowBlur)};function reducePropsToState(_){return _.filter(function(o){var $=o.disabled;return!$})}function handleStateChangeOnClient(_){var o=_.slice(-1)[0];o&&!lastActiveTrap&&attachHandler();var $=lastActiveTrap,j=$&&o&&o.id===$.id;lastActiveTrap=o,$&&!j&&($.onDeactivation(),_.filter(function(et){var tt=et.id;return tt===$.id}).length||$.returnFocus(!o)),o?(lastActiveFocus=null,(!j||$.observed!==o.observed)&&o.onActivation(),activateTrap(),deferAction(activateTrap)):(detachHandler(),lastActiveFocus=null)}mediumFocus.assignSyncMedium(onFocus);mediumBlur.assignMedium(onBlur);mediumEffect.assignMedium(function(_){return _({moveFocusInside:setFocus,focusInside})});const FocusTrap$1=withSideEffect(reducePropsToState,handleStateChangeOnClient)(FocusWatcher);var FocusLockCombination=reactExports.forwardRef(function(o,$){return reactExports.createElement(FocusLockUI,_extends$1({sideCar:FocusTrap$1,ref:$},o))}),_ref=FocusLockUI.propTypes||{};_ref.sideCar;_objectWithoutPropertiesLoose(_ref,["sideCar"]);FocusLockCombination.propTypes={};const FocusLock$1=FocusLockCombination;function isElement(_){return _!=null&&typeof _=="object"&&"nodeType"in _&&_.nodeType===Node.ELEMENT_NODE}function isHTMLElement(_){var o;if(!isElement(_))return!1;const $=(o=_.ownerDocument.defaultView)!=null?o:window;return _ instanceof $.HTMLElement}var hasTabIndex=_=>_.hasAttribute("tabindex");function isDisabled(_){return!!_.getAttribute("disabled")||!!_.getAttribute("aria-disabled")}function isHidden(_){return _.parentElement&&isHidden(_.parentElement)?!0:_.hidden}function isContentEditable(_){const o=_.getAttribute("contenteditable");return o!=="false"&&o!=null}function isFocusable(_){if(!isHTMLElement(_)||isHidden(_)||isDisabled(_))return!1;const{localName:o}=_;if(["input","select","textarea","button"].indexOf(o)>=0)return!0;const j={a:()=>_.hasAttribute("href"),audio:()=>_.hasAttribute("controls"),video:()=>_.hasAttribute("controls")};return o in j?j[o]():isContentEditable(_)?!0:hasTabIndex(_)}var focusableElList=["input:not(:disabled):not([disabled])","select:not(:disabled):not([disabled])","textarea:not(:disabled):not([disabled])","embed","iframe","object","a[href]","area[href]","button:not(:disabled):not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],focusableElSelector=focusableElList.join(),isVisible=_=>_.offsetWidth>0&&_.offsetHeight>0;function getAllFocusable(_){const o=Array.from(_.querySelectorAll(focusableElSelector));return o.unshift(_),o.filter($=>isFocusable($)&&isVisible($))}var _a$4,FocusTrap=(_a$4=FocusLock$1.default)!=null?_a$4:FocusLock$1,FocusLock=_=>{const{initialFocusRef:o,finalFocusRef:$,contentRef:j,restoreFocus:et,children:tt,isDisabled:rt,autoFocus:nt,persistentFocus:it,lockFocusAcrossFrames:st}=_,ot=reactExports.useCallback(()=>{o!=null&&o.current?o.current.focus():j!=null&&j.current&&getAllFocusable(j.current).length===0&&requestAnimationFrame(()=>{var ft;(ft=j.current)==null||ft.focus()})},[o,j]),at=reactExports.useCallback(()=>{var ut;(ut=$==null?void 0:$.current)==null||ut.focus()},[$]);return jsx(FocusTrap,{crossFrame:st,persistentFocus:it,autoFocus:nt,disabled:rt,onActivation:ot,onDeactivation:at,returnFocus:et&&!$,children:tt})};FocusLock.displayName="FocusLock";var useSafeLayoutEffect=isBrowser$4?reactExports.useLayoutEffect:reactExports.useEffect;function useCallbackRef(_,o=[]){const $=reactExports.useRef(_);return useSafeLayoutEffect(()=>{$.current=_}),reactExports.useCallback((...j)=>{var et;return(et=$.current)==null?void 0:et.call($,...j)},o)}function useId(_,o){const $=reactExports.useId();return reactExports.useMemo(()=>_||[o,$].filter(Boolean).join("-"),[_,o,$])}function useControllableProp(_,o){const $=_!==void 0;return[$,$&&typeof _<"u"?_:o]}function useControllableState(_){const{value:o,defaultValue:$,onChange:j,shouldUpdate:et=(ct,ut)=>ct!==ut}=_,tt=useCallbackRef(j),rt=useCallbackRef(et),[nt,it]=reactExports.useState($),st=o!==void 0,ot=st?o:nt,at=reactExports.useCallback(ct=>{const ut=runIfFn(ct,ot);rt(ot,ut)&&(st||it(ut),tt(ut))},[st,tt,ot,rt]);return[ot,at]}function useDisclosure(_={}){const{onClose:o,onOpen:$,isOpen:j,id:et}=_,tt=useCallbackRef($),rt=useCallbackRef(o),[nt,it]=reactExports.useState(_.defaultIsOpen||!1),[st,ot]=useControllableProp(j,nt),at=useId(et,"disclosure"),ct=reactExports.useCallback(()=>{st||it(!1),rt==null||rt()},[st,rt]),ut=reactExports.useCallback(()=>{st||it(!0),tt==null||tt()},[st,tt]),ft=reactExports.useCallback(()=>{(ot?ct:ut)()},[ot,ut,ct]);return{isOpen:!!ot,onOpen:ut,onClose:ct,onToggle:ft,isControlled:st,getButtonProps:(ht={})=>({...ht,"aria-expanded":ot,"aria-controls":at,onClick:callAllHandlers(ht.onClick,ft)}),getDisclosureProps:(ht={})=>({...ht,hidden:!ot,id:at})}}var Input=forwardRef(function(o,$){const{htmlSize:j,...et}=o,tt=useMultiStyleConfig("Input",et),rt=omitThemingProps(et),nt=useFormControl(rt),it=cx("chakra-input",o.className);return jsx(chakra.input,{size:j,...nt,__css:tt.field,ref:$,className:it})});Input.displayName="Input";Input.id="Input";function mapResponsive(_,o){return Array.isArray(_)?_.map($=>$===null?null:o($)):isObject$1(_)?Object.keys(_).reduce(($,j)=>($[j]=o(_[j]),$),{}):_!=null?o(_):null}var Spacer=chakra("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}});Spacer.displayName="Spacer";var Text=forwardRef(function(o,$){const j=useStyleConfig("Text",o),{className:et,align:tt,decoration:rt,casing:nt,...it}=omitThemingProps(o),st=compact({textAlign:o.align,textDecoration:o.decoration,textTransform:o.casing});return jsx(chakra.p,{ref:$,className:cx("chakra-text",o.className),...st,...it,__css:j})});Text.displayName="Text";var StackItem=_=>jsx(chakra.div,{className:"chakra-stack__item",..._,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,..._.__css}});StackItem.displayName="StackItem";var selector="& > *:not(style) ~ *:not(style)";function getStackStyles(_){const{spacing:o,direction:$}=_,j={column:{marginTop:o,marginEnd:0,marginBottom:0,marginStart:0},row:{marginTop:0,marginEnd:0,marginBottom:0,marginStart:o},"column-reverse":{marginTop:0,marginEnd:0,marginBottom:o,marginStart:0},"row-reverse":{marginTop:0,marginEnd:o,marginBottom:0,marginStart:0}};return{flexDirection:$,[selector]:mapResponsive($,et=>j[et])}}function getDividerStyles(_){const{spacing:o,direction:$}=_,j={column:{my:o,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:o,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:o,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:o,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":mapResponsive($,et=>j[et])}}var Stack=forwardRef((_,o)=>{const{isInline:$,direction:j,align:et,justify:tt,spacing:rt="0.5rem",wrap:nt,children:it,divider:st,className:ot,shouldWrapChildren:at,...ct}=_,ut=$?"row":j??"column",ft=reactExports.useMemo(()=>getStackStyles({direction:ut,spacing:rt}),[ut,rt]),ht=reactExports.useMemo(()=>getDividerStyles({spacing:rt,direction:ut}),[rt,ut]),mt=!!st,gt=!at&&!mt,Et=reactExports.useMemo(()=>{const At=getValidChildren(it);return gt?At:At.map((kt,Rt)=>{const Tt=typeof kt.key<"u"?kt.key:Rt,Dt=Rt+1===At.length,jt=at?jsx(StackItem,{children:kt},Tt):kt;if(!mt)return jt;const Nt=reactExports.cloneElement(st,{__css:ht}),It=Dt?null:Nt;return jsxs(reactExports.Fragment,{children:[jt,It]},Tt)})},[st,ht,mt,gt,at,it]),St=cx("chakra-stack",ot);return jsx(chakra.div,{ref:o,display:"flex",alignItems:et,justifyContent:tt,flexDirection:ft.flexDirection,flexWrap:nt,className:St,__css:mt?{}:{[selector]:ft[selector]},...ct,children:Et})});Stack.displayName="Stack";var HStack=forwardRef((_,o)=>jsx(Stack,{align:"center",..._,direction:"row",ref:o}));HStack.displayName="HStack";var Heading=forwardRef(function(o,$){const j=useStyleConfig("Heading",o),{className:et,...tt}=omitThemingProps(o);return jsx(chakra.h2,{ref:$,className:cx("chakra-heading",o.className),...tt,__css:j})});Heading.displayName="Heading";var Box=chakra("div");Box.displayName="Box";var Square=forwardRef(function(o,$){const{size:j,centerContent:et=!0,...tt}=o;return jsx(Box,{ref:$,boxSize:j,__css:{...et?{display:"flex",alignItems:"center",justifyContent:"center"}:{},flexShrink:0,flexGrow:0},...tt})});Square.displayName="Square";var Circle=forwardRef(function(o,$){const{size:j,...et}=o;return jsx(Square,{size:j,ref:$,borderRadius:"9999px",...et})});Circle.displayName="Circle";var Link=forwardRef(function(o,$){const j=useStyleConfig("Link",o),{className:et,isExternal:tt,...rt}=omitThemingProps(o);return jsx(chakra.a,{target:tt?"_blank":void 0,rel:tt?"noopener":void 0,ref:$,className:cx("chakra-link",et),...rt,__css:j})});Link.displayName="Link";var Badge=forwardRef(function(o,$){const j=useStyleConfig("Badge",o),{className:et,...tt}=omitThemingProps(o);return jsx(chakra.span,{ref:$,className:cx("chakra-badge",o.className),...tt,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...j}})});Badge.displayName="Badge";var Divider=forwardRef(function(o,$){const{borderLeftWidth:j,borderBottomWidth:et,borderTopWidth:tt,borderRightWidth:rt,borderWidth:nt,borderStyle:it,borderColor:st,...ot}=useStyleConfig("Divider",o),{className:at,orientation:ct="horizontal",__css:ut,...ft}=omitThemingProps(o),ht={vertical:{borderLeftWidth:j||rt||nt||"1px",height:"100%"},horizontal:{borderBottomWidth:et||tt||nt||"1px",width:"100%"}};return jsx(chakra.hr,{ref:$,"aria-orientation":ct,...ft,__css:{...ot,border:"0",borderColor:st,borderStyle:it,...ht[ct],...ut},className:cx("chakra-divider",at)})});Divider.displayName="Divider";var Flex=forwardRef(function(o,$){const{direction:j,align:et,justify:tt,wrap:rt,basis:nt,grow:it,shrink:st,...ot}=o,at={display:"flex",flexDirection:j,alignItems:et,justifyContent:tt,flexWrap:rt,flexBasis:nt,flexGrow:it,flexShrink:st};return jsx(chakra.div,{ref:$,__css:at,...ot})});Flex.displayName="Flex";var transitions={slideInBottom:{...slideFadeConfig,custom:{offsetY:16,reverse:!0}},slideInRight:{...slideFadeConfig,custom:{offsetX:16,reverse:!0}},scale:{...scaleFadeConfig,custom:{initialScale:.95,reverse:!0}},none:{}},MotionSection=chakra(motion.section),getMotionProps=_=>transitions[_||"none"],ModalTransition=reactExports.forwardRef((_,o)=>{const{preset:$,motionProps:j=getMotionProps($),...et}=_;return jsx(MotionSection,{ref:o,...j,...et})});ModalTransition.displayName="ModalTransition";var __defProp=Object.defineProperty,__defNormalProp=(_,o,$)=>o in _?__defProp(_,o,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[o]=$,__publicField=(_,o,$)=>(__defNormalProp(_,typeof o!="symbol"?o+"":o,$),$),ModalManager=class{constructor(){__publicField(this,"modals"),this.modals=new Map}add(_){return this.modals.set(_,this.modals.size+1),this.modals.size}remove(_){this.modals.delete(_)}isTopModal(_){return _?this.modals.get(_)===this.modals.size:!1}},manager=new ModalManager;function useModalManager(_,o){const[$,j]=reactExports.useState(0);return reactExports.useEffect(()=>{const et=_.current;if(et){if(o){const tt=manager.add(et);j(tt)}return()=>{manager.remove(et),j(0)}}},[o,_]),$}var getDefaultParent=function(_){if(typeof document>"u")return null;var o=Array.isArray(_)?_[0]:_;return o.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(_){return _&&(_.host||unwrapHost(_.parentNode))},correctTargets=function(_,o){return o.map(function($){if(_.contains($))return $;var j=unwrapHost($);return j&&_.contains(j)?j:(console.error("aria-hidden",$,"in not contained inside",_,". Doing nothing"),null)}).filter(function($){return!!$})},applyAttributeToOthers=function(_,o,$,j){var et=correctTargets(o,Array.isArray(_)?_:[_]);markerMap[$]||(markerMap[$]=new WeakMap);var tt=markerMap[$],rt=[],nt=new Set,it=new Set(et),st=function(at){!at||nt.has(at)||(nt.add(at),st(at.parentNode))};et.forEach(st);var ot=function(at){!at||it.has(at)||Array.prototype.forEach.call(at.children,function(ct){if(nt.has(ct))ot(ct);else{var ut=ct.getAttribute(j),ft=ut!==null&&ut!=="false",ht=(counterMap.get(ct)||0)+1,mt=(tt.get(ct)||0)+1;counterMap.set(ct,ht),tt.set(ct,mt),rt.push(ct),ht===1&&ft&&uncontrolledNodes.set(ct,!0),mt===1&&ct.setAttribute($,"true"),ft||ct.setAttribute(j,"true")}})};return ot(o),nt.clear(),lockCount++,function(){rt.forEach(function(at){var ct=counterMap.get(at)-1,ut=tt.get(at)-1;counterMap.set(at,ct),tt.set(at,ut),ct||(uncontrolledNodes.has(at)||at.removeAttribute(j),uncontrolledNodes.delete(at)),ut||at.removeAttribute($)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(_,o,$){$===void 0&&($="data-aria-hidden");var j=Array.from(Array.isArray(_)?_:[_]),et=o||getDefaultParent(_);return et?(j.push.apply(j,Array.from(et.querySelectorAll("[aria-live]"))),applyAttributeToOthers(j,et,$,"aria-hidden")):function(){return null}};function useModal(_){const{isOpen:o,onClose:$,id:j,closeOnOverlayClick:et=!0,closeOnEsc:tt=!0,useInert:rt=!0,onOverlayClick:nt,onEsc:it}=_,st=reactExports.useRef(null),ot=reactExports.useRef(null),[at,ct,ut]=useIds(j,"chakra-modal","chakra-modal--header","chakra-modal--body");useAriaHidden(st,o&&rt),useModalManager(st,o);const ft=reactExports.useRef(null),ht=reactExports.useCallback(Dt=>{ft.current=Dt.target},[]),mt=reactExports.useCallback(Dt=>{Dt.key==="Escape"&&(Dt.stopPropagation(),tt&&($==null||$()),it==null||it())},[tt,$,it]),[gt,Et]=reactExports.useState(!1),[St,At]=reactExports.useState(!1),kt=reactExports.useCallback((Dt={},Ot=null)=>({role:"dialog",...Dt,ref:mergeRefs(Ot,st),id:at,tabIndex:-1,"aria-modal":!0,"aria-labelledby":gt?ct:void 0,"aria-describedby":St?ut:void 0,onClick:callAllHandlers$1(Dt.onClick,jt=>jt.stopPropagation())}),[ut,St,at,ct,gt]),Rt=reactExports.useCallback(Dt=>{Dt.stopPropagation(),ft.current===Dt.target&&manager.isTopModal(st.current)&&(et&&($==null||$()),nt==null||nt())},[$,et,nt]),Tt=reactExports.useCallback((Dt={},Ot=null)=>({...Dt,ref:mergeRefs(Ot,ot),onClick:callAllHandlers$1(Dt.onClick,Rt),onKeyDown:callAllHandlers$1(Dt.onKeyDown,mt),onMouseDown:callAllHandlers$1(Dt.onMouseDown,ht)}),[mt,ht,Rt]);return{isOpen:o,onClose:$,headerId:ct,bodyId:ut,setBodyMounted:At,setHeaderMounted:Et,dialogRef:st,overlayRef:ot,getDialogProps:kt,getDialogContainerProps:Tt}}function useAriaHidden(_,o){const $=_.current;reactExports.useEffect(()=>{if(!(!_.current||!o))return hideOthers(_.current)},[o,_,$])}function useIds(_,...o){const $=reactExports.useId(),j=_||$;return reactExports.useMemo(()=>o.map(et=>`${et}-${j}`),[j,o])}var[ModalStylesProvider,useModalStyles]=createContext$1({name:"ModalStylesContext",errorMessage:`useModalStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Modal />" `}),[ModalContextProvider,useModalContext]=createContext$1({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),Modal=_=>{const o={scrollBehavior:"outside",autoFocus:!0,trapFocus:!0,returnFocusOnClose:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale",lockFocusAcrossFrames:!0,..._},{portalProps:$,children:j,autoFocus:et,trapFocus:tt,initialFocusRef:rt,finalFocusRef:nt,returnFocusOnClose:it,blockScrollOnMount:st,allowPinchZoom:ot,preserveScrollBarGap:at,motionPreset:ct,lockFocusAcrossFrames:ut,onCloseComplete:ft}=o,ht=useMultiStyleConfig("Modal",o),gt={...useModal(o),autoFocus:et,trapFocus:tt,initialFocusRef:rt,finalFocusRef:nt,returnFocusOnClose:it,blockScrollOnMount:st,allowPinchZoom:ot,preserveScrollBarGap:at,motionPreset:ct,lockFocusAcrossFrames:ut};return jsx(ModalContextProvider,{value:gt,children:jsx(ModalStylesProvider,{value:ht,children:jsx(AnimatePresence,{onExitComplete:ft,children:gt.isOpen&&jsx(Portal,{...$,children:j})})})})};Modal.displayName="Modal";var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size",effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll$1=reactExports.forwardRef(function(_,o){var $=reactExports.useRef(null),j=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),et=j[0],tt=j[1],rt=_.forwardProps,nt=_.children,it=_.className,st=_.removeScrollBar,ot=_.enabled,at=_.shards,ct=_.sideCar,ut=_.noIsolation,ft=_.inert,ht=_.allowPinchZoom,mt=_.as,gt=mt===void 0?"div":mt,Et=__rest(_,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),St=ct,At=useMergeRefs([$,o]),kt=__assign(__assign({},Et),et);return reactExports.createElement(reactExports.Fragment,null,ot&&reactExports.createElement(St,{sideCar:effectCar,removeScrollBar:st,shards:at,noIsolation:ut,inert:ft,setCallbacks:tt,allowPinchZoom:!!ht,lockRef:$}),rt?reactExports.cloneElement(reactExports.Children.only(nt),__assign(__assign({},kt),{ref:At})):reactExports.createElement(gt,__assign({},kt,{className:it,ref:At}),nt))});RemoveScroll$1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll$1.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var currentNonce,getNonce=function(){if(currentNonce)return currentNonce;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var _=document.createElement("style");_.type="text/css";var o=getNonce();return o&&_.setAttribute("nonce",o),_}function injectStyles(_,o){_.styleSheet?_.styleSheet.cssText=o:_.appendChild(document.createTextNode(o))}function insertStyleTag(_){var o=document.head||document.getElementsByTagName("head")[0];o.appendChild(_)}var stylesheetSingleton=function(){var _=0,o=null;return{add:function($){_==0&&(o=makeStyleTag())&&(injectStyles(o,$),insertStyleTag(o)),_++},remove:function(){_--,!_&&o&&(o.parentNode&&o.parentNode.removeChild(o),o=null)}}},styleHookSingleton=function(){var _=stylesheetSingleton();return function(o,$){reactExports.useEffect(function(){return _.add(o),function(){_.remove()}},[o&&$])}},styleSingleton=function(){var _=styleHookSingleton(),o=function($){var j=$.styles,et=$.dynamic;return _(j,et),null};return o},zeroGap={left:0,top:0,right:0,gap:0},parse$7=function(_){return parseInt(_||"",10)||0},getOffset=function(_){var o=window.getComputedStyle(document.body),$=o[_==="padding"?"paddingLeft":"marginLeft"],j=o[_==="padding"?"paddingTop":"marginTop"],et=o[_==="padding"?"paddingRight":"marginRight"];return[parse$7($),parse$7(j),parse$7(et)]},getGapWidth=function(_){if(_===void 0&&(_="margin"),typeof window>"u")return zeroGap;var o=getOffset(_),$=document.documentElement.clientWidth,j=window.innerWidth;return{left:o[0],top:o[1],right:o[2],gap:Math.max(0,j-$+o[2]-o[0])}},Style=styleSingleton(),getStyles=function(_,o,$,j){var et=_.left,tt=_.top,rt=_.right,nt=_.gap;return $===void 0&&($="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(j,`;
   padding-right: `).concat(nt,"px ").concat(j,`;
  }
  body {
    overflow: hidden `).concat(j,`;
    overscroll-behavior: contain;
    `).concat([o&&"position: relative ".concat(j,";"),$==="margin"&&`
    padding-left: `.concat(et,`px;
    padding-top: `).concat(tt,`px;
    padding-right: `).concat(rt,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(nt,"px ").concat(j,`;
    `),$==="padding"&&"padding-right: ".concat(nt,"px ").concat(j,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(nt,"px ").concat(j,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(nt,"px ").concat(j,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(j,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(j,`;
  }
  
  body {
    `).concat(removedBarSizeVariable,": ").concat(nt,`px;
  }
`)},RemoveScrollBar=function(_){var o=_.noRelative,$=_.noImportant,j=_.gapMode,et=j===void 0?"margin":j,tt=reactExports.useMemo(function(){return getGapWidth(et)},[et]);return reactExports.createElement(Style,{styles:getStyles(tt,!o,et,$?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(_){return _.tagName==="TEXTAREA"},elementCanBeScrolled=function(_,o){var $=window.getComputedStyle(_);return $[o]!=="hidden"&&!($.overflowY===$.overflowX&&!alwaysContainsScroll(_)&&$[o]==="visible")},elementCouldBeVScrolled=function(_){return elementCanBeScrolled(_,"overflowY")},elementCouldBeHScrolled=function(_){return elementCanBeScrolled(_,"overflowX")},locationCouldBeScrolled=function(_,o){var $=o;do{typeof ShadowRoot<"u"&&$ instanceof ShadowRoot&&($=$.host);var j=elementCouldBeScrolled(_,$);if(j){var et=getScrollVariables(_,$),tt=et[1],rt=et[2];if(tt>rt)return!0}$=$.parentNode}while($&&$!==document.body);return!1},getVScrollVariables=function(_){var o=_.scrollTop,$=_.scrollHeight,j=_.clientHeight;return[o,$,j]},getHScrollVariables=function(_){var o=_.scrollLeft,$=_.scrollWidth,j=_.clientWidth;return[o,$,j]},elementCouldBeScrolled=function(_,o){return _==="v"?elementCouldBeVScrolled(o):elementCouldBeHScrolled(o)},getScrollVariables=function(_,o){return _==="v"?getVScrollVariables(o):getHScrollVariables(o)},getDirectionFactor=function(_,o){return _==="h"&&o==="rtl"?-1:1},handleScroll=function(_,o,$,j,et){var tt=getDirectionFactor(_,window.getComputedStyle(o).direction),rt=tt*j,nt=$.target,it=o.contains(nt),st=!1,ot=rt>0,at=0,ct=0;do{var ut=getScrollVariables(_,nt),ft=ut[0],ht=ut[1],mt=ut[2],gt=ht-mt-tt*ft;(ft||gt)&&elementCouldBeScrolled(_,nt)&&(at+=gt,ct+=ft),nt=nt.parentNode}while(!it&&nt!==document.body||it&&(o.contains(nt)||o===nt));return(ot&&(et&&at===0||!et&&rt>at)||!ot&&(et&&ct===0||!et&&-rt>ct))&&(st=!0),st},getTouchXY=function(_){return"changedTouches"in _?[_.changedTouches[0].clientX,_.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(_){return[_.deltaX,_.deltaY]},extractRef=function(_){return _&&"current"in _?_.current:_},deltaCompare=function(_,o){return _[0]===o[0]&&_[1]===o[1]},generateStyle=function(_){return`
  .block-interactivity-`.concat(_,` {pointer-events: none;}
  .allow-interactivity-`).concat(_,` {pointer-events: all;}
`)},idCounter$1=0,lockStack=[];function RemoveScrollSideCar(_){var o=reactExports.useRef([]),$=reactExports.useRef([0,0]),j=reactExports.useRef(),et=reactExports.useState(idCounter$1++)[0],tt=reactExports.useState(function(){return styleSingleton()})[0],rt=reactExports.useRef(_);reactExports.useEffect(function(){rt.current=_},[_]),reactExports.useEffect(function(){if(_.inert){document.body.classList.add("block-interactivity-".concat(et));var ht=__spreadArray([_.lockRef.current],(_.shards||[]).map(extractRef),!0).filter(Boolean);return ht.forEach(function(mt){return mt.classList.add("allow-interactivity-".concat(et))}),function(){document.body.classList.remove("block-interactivity-".concat(et)),ht.forEach(function(mt){return mt.classList.remove("allow-interactivity-".concat(et))})}}},[_.inert,_.lockRef.current,_.shards]);var nt=reactExports.useCallback(function(ht,mt){if("touches"in ht&&ht.touches.length===2)return!rt.current.allowPinchZoom;var gt=getTouchXY(ht),Et=$.current,St="deltaX"in ht?ht.deltaX:Et[0]-gt[0],At="deltaY"in ht?ht.deltaY:Et[1]-gt[1],kt,Rt=ht.target,Tt=Math.abs(St)>Math.abs(At)?"h":"v";if("touches"in ht&&Tt==="h"&&Rt.type==="range")return!1;var Dt=locationCouldBeScrolled(Tt,Rt);if(!Dt)return!0;if(Dt?kt=Tt:(kt=Tt==="v"?"h":"v",Dt=locationCouldBeScrolled(Tt,Rt)),!Dt)return!1;if(!j.current&&"changedTouches"in ht&&(St||At)&&(j.current=kt),!kt)return!0;var Ot=j.current||kt;return handleScroll(Ot,mt,ht,Ot==="h"?St:At,!0)},[]),it=reactExports.useCallback(function(ht){var mt=ht;if(!(!lockStack.length||lockStack[lockStack.length-1]!==tt)){var gt="deltaY"in mt?getDeltaXY(mt):getTouchXY(mt),Et=o.current.filter(function(kt){return kt.name===mt.type&&kt.target===mt.target&&deltaCompare(kt.delta,gt)})[0];if(Et&&Et.should){mt.cancelable&&mt.preventDefault();return}if(!Et){var St=(rt.current.shards||[]).map(extractRef).filter(Boolean).filter(function(kt){return kt.contains(mt.target)}),At=St.length>0?nt(mt,St[0]):!rt.current.noIsolation;At&&mt.cancelable&&mt.preventDefault()}}},[]),st=reactExports.useCallback(function(ht,mt,gt,Et){var St={name:ht,delta:mt,target:gt,should:Et};o.current.push(St),setTimeout(function(){o.current=o.current.filter(function(At){return At!==St})},1)},[]),ot=reactExports.useCallback(function(ht){$.current=getTouchXY(ht),j.current=void 0},[]),at=reactExports.useCallback(function(ht){st(ht.type,getDeltaXY(ht),ht.target,nt(ht,_.lockRef.current))},[]),ct=reactExports.useCallback(function(ht){st(ht.type,getTouchXY(ht),ht.target,nt(ht,_.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(tt),_.setCallbacks({onScrollCapture:at,onWheelCapture:at,onTouchMoveCapture:ct}),document.addEventListener("wheel",it,nonPassive),document.addEventListener("touchmove",it,nonPassive),document.addEventListener("touchstart",ot,nonPassive),function(){lockStack=lockStack.filter(function(ht){return ht!==tt}),document.removeEventListener("wheel",it,nonPassive),document.removeEventListener("touchmove",it,nonPassive),document.removeEventListener("touchstart",ot,nonPassive)}},[]);var ut=_.removeScrollBar,ft=_.inert;return reactExports.createElement(reactExports.Fragment,null,ft?reactExports.createElement(tt,{styles:generateStyle(et)}):null,ut?reactExports.createElement(RemoveScrollBar,{gapMode:"margin"}):null)}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(_,o){return reactExports.createElement(RemoveScroll$1,__assign({},_,{ref:o,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll$1.classNames;const RemoveScroll=ReactRemoveScroll;function ModalFocusScope(_){const{autoFocus:o,trapFocus:$,dialogRef:j,initialFocusRef:et,blockScrollOnMount:tt,allowPinchZoom:rt,finalFocusRef:nt,returnFocusOnClose:it,preserveScrollBarGap:st,lockFocusAcrossFrames:ot,isOpen:at}=useModalContext(),[ct,ut]=usePresence();reactExports.useEffect(()=>{!ct&&ut&&setTimeout(ut)},[ct,ut]);const ft=useModalManager(j,at);return jsx(FocusLock,{autoFocus:o,isDisabled:!$,initialFocusRef:et,finalFocusRef:nt,restoreFocus:it,contentRef:j,lockFocusAcrossFrames:ot,children:jsx(RemoveScroll,{removeScrollBar:!st,allowPinchZoom:rt,enabled:ft===1&&tt,forwardProps:!0,children:_.children})})}var ModalContent=forwardRef((_,o)=>{const{className:$,children:j,containerProps:et,motionProps:tt,...rt}=_,{getDialogProps:nt,getDialogContainerProps:it}=useModalContext(),st=nt(rt,o),ot=it(et),at=cx("chakra-modal__content",$),ct=useModalStyles(),ut={display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,...ct.dialog},ft={display:"flex",width:"100vw",height:"$100vh",position:"fixed",left:0,top:0,...ct.dialogContainer},{motionPreset:ht}=useModalContext();return jsx(ModalFocusScope,{children:jsx(chakra.div,{...ot,className:"chakra-modal__content-container",tabIndex:-1,__css:ft,children:jsx(ModalTransition,{preset:ht,motionProps:tt,className:at,...st,__css:ut,children:j})})})});ModalContent.displayName="ModalContent";function AlertDialog(_){const{leastDestructiveRef:o,...$}=_;return jsx(Modal,{...$,initialFocusRef:o})}var AlertDialogContent=forwardRef((_,o)=>jsx(ModalContent,{ref:o,role:"alertdialog",..._})),ModalFooter=forwardRef((_,o)=>{const{className:$,...j}=_,et=cx("chakra-modal__footer",$),rt={display:"flex",alignItems:"center",justifyContent:"flex-end",...useModalStyles().footer};return jsx(chakra.footer,{ref:o,...j,__css:rt,className:et})});ModalFooter.displayName="ModalFooter";var ModalHeader=forwardRef((_,o)=>{const{className:$,...j}=_,{headerId:et,setHeaderMounted:tt}=useModalContext();reactExports.useEffect(()=>(tt(!0),()=>tt(!1)),[tt]);const rt=cx("chakra-modal__header",$),it={flex:0,...useModalStyles().header};return jsx(chakra.header,{ref:o,className:rt,id:et,...j,__css:it})});ModalHeader.displayName="ModalHeader";var MotionDiv=chakra(motion.div),ModalOverlay=forwardRef((_,o)=>{const{className:$,transition:j,motionProps:et,...tt}=_,rt=cx("chakra-modal__overlay",$),it={pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh",...useModalStyles().overlay},{motionPreset:st}=useModalContext();return jsx(MotionDiv,{...et||(st==="none"?{}:fadeConfig),__css:it,ref:o,className:rt,...tt})});ModalOverlay.displayName="ModalOverlay";var ModalBody=forwardRef((_,o)=>{const{className:$,...j}=_,{bodyId:et,setBodyMounted:tt}=useModalContext();reactExports.useEffect(()=>(tt(!0),()=>tt(!1)),[tt]);const rt=cx("chakra-modal__body",$),nt=useModalStyles();return jsx(chakra.div,{ref:o,className:rt,id:et,...j,__css:nt.body})});ModalBody.displayName="ModalBody";var ModalCloseButton=forwardRef((_,o)=>{const{onClick:$,className:j,...et}=_,{onClose:tt}=useModalContext(),rt=cx("chakra-modal__close-btn",j),nt=useModalStyles();return jsx(CloseButton,{ref:o,__css:nt.closeButton,className:rt,onClick:callAllHandlers$1($,it=>{it.stopPropagation(),tt()}),...et})});ModalCloseButton.displayName="ModalCloseButton";var SelectField=forwardRef(function(o,$){const{children:j,placeholder:et,className:tt,...rt}=o;return jsxs(chakra.select,{...rt,ref:$,className:cx("chakra-select",tt),children:[et&&jsx("option",{value:"",children:et}),j]})});SelectField.displayName="SelectField";function split(_,o){const $={},j={};for(const[et,tt]of Object.entries(_))o.includes(et)?$[et]=tt:j[et]=tt;return[$,j]}var Select=forwardRef((_,o)=>{var $;const j=useMultiStyleConfig("Select",_),{rootProps:et,placeholder:tt,icon:rt,color:nt,height:it,h:st,minH:ot,minHeight:at,iconColor:ct,iconSize:ut,...ft}=omitThemingProps(_),[ht,mt]=split(ft,layoutPropNames),gt=useFormControl(mt),Et={width:"100%",height:"fit-content",position:"relative",color:nt},St={paddingEnd:"2rem",...j.field,_focus:{zIndex:"unset",...($=j.field)==null?void 0:$._focus}};return jsxs(chakra.div,{className:"chakra-select__wrapper",__css:Et,...ht,...et,children:[jsx(SelectField,{ref:o,height:st??it,minH:ot??at,placeholder:tt,...gt,__css:St,children:_.children}),jsx(SelectIcon,{"data-disabled":dataAttr(gt.disabled),...(ct||nt)&&{color:ct||nt},__css:j.icon,...ut&&{fontSize:ut},children:rt})]})});Select.displayName="Select";var DefaultIcon=_=>jsx("svg",{viewBox:"0 0 24 24",..._,children:jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),IconWrapper=chakra("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),SelectIcon=_=>{const{children:o=jsx(DefaultIcon,{}),...$}=_,j=reactExports.cloneElement(o,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return jsx(IconWrapper,{...$,className:"chakra-select__icon-wrapper",children:reactExports.isValidElement(o)?j:null})};SelectIcon.displayName="SelectIcon";var[TableStylesProvider,useTableStyles]=createContext$1({name:"TableStylesContext",errorMessage:`useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Table />" `}),Table=forwardRef((_,o)=>{const $=useMultiStyleConfig("Table",_),{className:j,layout:et,...tt}=omitThemingProps(_);return jsx(TableStylesProvider,{value:$,children:jsx(chakra.table,{ref:o,__css:{tableLayout:et,...$.table},className:cx("chakra-table",j),...tt})})});Table.displayName="Table";var Thead=forwardRef((_,o)=>{const $=useTableStyles();return jsx(chakra.thead,{..._,ref:o,__css:$.thead})}),Tr=forwardRef((_,o)=>{const $=useTableStyles();return jsx(chakra.tr,{..._,ref:o,__css:$.tr})}),TableCaption=forwardRef((_,o)=>{const{placement:$="bottom",...j}=_,et=useTableStyles();return jsx(chakra.caption,{...j,ref:o,__css:{...et.caption,captionSide:$}})});TableCaption.displayName="TableCaption";var TableContainer=forwardRef((_,o)=>{var $;const{overflow:j,overflowX:et,className:tt,...rt}=_;return jsx(chakra.div,{ref:o,className:cx("chakra-table__container",tt),...rt,__css:{display:"block",whiteSpace:"nowrap",WebkitOverflowScrolling:"touch",overflowX:($=j??et)!=null?$:"auto",overflowY:"hidden",maxWidth:"100%"}})}),Tbody=forwardRef((_,o)=>{const $=useTableStyles();return jsx(chakra.tbody,{..._,ref:o,__css:$.tbody})}),Td=forwardRef(({isNumeric:_,...o},$)=>{const j=useTableStyles();return jsx(chakra.td,{...o,ref:$,__css:j.td,"data-is-numeric":_})}),Th=forwardRef(({isNumeric:_,...o},$)=>{const j=useTableStyles();return jsx(chakra.th,{...o,ref:$,__css:j.th,"data-is-numeric":_})});const index$1="",App$1="";var SunIcon=createIcon({displayName:"SunIcon",path:jsxs("g",{strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"2",fill:"none",stroke:"currentColor",children:[jsx("circle",{cx:"12",cy:"12",r:"5"}),jsx("path",{d:"M12 1v2"}),jsx("path",{d:"M12 21v2"}),jsx("path",{d:"M4.22 4.22l1.42 1.42"}),jsx("path",{d:"M18.36 18.36l1.42 1.42"}),jsx("path",{d:"M1 12h2"}),jsx("path",{d:"M21 12h2"}),jsx("path",{d:"M4.22 19.78l1.42-1.42"}),jsx("path",{d:"M18.36 5.64l1.42-1.42"})]})}),ViewIcon=createIcon({displayName:"ViewIcon",path:jsxs("g",{fill:"currentColor",children:[jsx("path",{d:"M23.432,10.524C20.787,7.614,16.4,4.538,12,4.6,7.6,4.537,3.213,7.615.568,10.524a2.211,2.211,0,0,0,0,2.948C3.182,16.351,7.507,19.4,11.839,19.4h.308c4.347,0,8.671-3.049,11.288-5.929A2.21,2.21,0,0,0,23.432,10.524ZM7.4,12A4.6,4.6,0,1,1,12,16.6,4.6,4.6,0,0,1,7.4,12Z"}),jsx("circle",{cx:"12",cy:"12",r:"2"})]})}),SettingsIcon=createIcon({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),MoonIcon=createIcon({d:"M21.4,13.7C20.6,13.9,19.8,14,19,14c-5,0-9-4-9-9c0-0.8,0.1-1.6,0.3-2.4c0.1-0.3,0-0.7-0.3-1 c-0.3-0.3-0.6-0.4-1-0.3C4.3,2.7,1,7.1,1,12c0,6.1,4.9,11,11,11c4.9,0,9.3-3.3,10.6-8.1c0.1-0.3,0-0.7-0.3-1 C22.1,13.7,21.7,13.6,21.4,13.7z",displayName:"MoonIcon"}),CloseIcon=createIcon({displayName:"CloseIcon",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"}),DeleteIcon=createIcon({displayName:"DeleteIcon",path:jsx("g",{fill:"currentColor",children:jsx("path",{d:"M19.452 7.5H4.547a.5.5 0 00-.5.545l1.287 14.136A2 2 0 007.326 24h9.347a2 2 0 001.992-1.819L19.95 8.045a.5.5 0 00-.129-.382.5.5 0 00-.369-.163zm-9.2 13a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zm5 0a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zM22 4h-4.75a.25.25 0 01-.25-.25V2.5A2.5 2.5 0 0014.5 0h-5A2.5 2.5 0 007 2.5v1.25a.25.25 0 01-.25.25H2a1 1 0 000 2h20a1 1 0 000-2zM9 3.75V2.5a.5.5 0 01.5-.5h5a.5.5 0 01.5.5v1.25a.25.25 0 01-.25.25h-5.5A.25.25 0 019 3.75z"})})});function ColorModeToggle(_){const{colorMode:o,toggleColorMode:$}=useColorMode();return jsx(Button,{"aria-label":"Toggle Color Mode",onClick:$,_focus:{boxShadow:"none"},w:"fit-content",..._,children:o==="light"?jsx(MoonIcon,{}):jsx(SunIcon,{})})}function TreeDotsHorizontalSvgIcon(){return jsxs("svg",{width:"32",height:"32",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsx("path",{d:"M4 8C4 7.44772 4.44772 7 5 7C5.55228 7 6 7.44772 6 8C6 8.55228 5.55228 9 5 9C4.44772 9 4 8.55228 4 8Z",fill:"rgb(236, 106, 94)"}),jsx("path",{d:"M8 8C8 7.44772 8.44772 7 9 7C9.55228 7 10 7.44772 10 8C10 8.55228 9.55228 9 9 9C8.44772 9 8 8.55228 8 8Z",fill:"rgb(244, 191, 79)"}),jsx("path",{d:"M12 8C12 7.44772 12.4477 7 13 7C13.5523 7 14 7.44772 14 8C14 8.55228 13.5523 9 13 9C12.4477 9 12 8.55228 12 8Z",fill:"rgb(88, 183, 72)"})]})}let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let _=0;_<256;++_)byteToHex.push((_+256).toString(16).slice(1));function unsafeStringify(_,o=0){return(byteToHex[_[o+0]]+byteToHex[_[o+1]]+byteToHex[_[o+2]]+byteToHex[_[o+3]]+"-"+byteToHex[_[o+4]]+byteToHex[_[o+5]]+"-"+byteToHex[_[o+6]]+byteToHex[_[o+7]]+"-"+byteToHex[_[o+8]]+byteToHex[_[o+9]]+"-"+byteToHex[_[o+10]]+byteToHex[_[o+11]]+byteToHex[_[o+12]]+byteToHex[_[o+13]]+byteToHex[_[o+14]]+byteToHex[_[o+15]]).toLowerCase()}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4$1(_,o,$){if(native.randomUUID&&!o&&!_)return native.randomUUID();_=_||{};const j=_.random||(_.rng||rng)();if(j[6]=j[6]&15|64,j[8]=j[8]&63|128,o){$=$||0;for(let et=0;et<16;++et)o[$+et]=j[et];return o}return unsafeStringify(j)}function v4Id(){return v4$1()}function sentenseCase(_){return _.charAt(0).toUpperCase()+_.slice(1)}function isValidJson(_){try{if(/^[\],:{}\s]*$/.test(_.replace(/\\["\\/bfnrtu]/g,"@").replace(/["'][^"'\\\n\r]*["']|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return!0;JSON.parse(_)}catch{return!1}return!0}function prettyJson(_){try{return isValidJson(_)?JSON.stringify(JSON.parse(_),null,2):_}catch{return _}}const InitialState$1=[],AppLogContext=reactExports.createContext({logs:InitialState$1}),AppLogDispatchContext=reactExports.createContext(()=>{});function logReducer(_,o){switch(o.type){case"clear":return[];case"add":return[..._,{...o.log,date:o.log.date||new Date,id:o.log.id||v4Id()}]}}function AppLogProvider({children:_}){const[o,$]=reactExports.useReducer(logReducer,InitialState$1);return jsx(AppLogContext.Provider,{value:{logs:o},children:jsx(AppLogDispatchContext.Provider,{value:$,children:_})})}function useAppLog(){return reactExports.useContext(AppLogContext)}function useAppLogDispatch(){return reactExports.useContext(AppLogDispatchContext)}const exludeTypes=["error","none","preview","synced","pinned","connected","disconnected","connecting"],colorSchema$1={created:"green",updated:"blue",deleted:"red",synced:"purple",pinned:"orange",preview:"gray",error:"red",connected:"green",disconnected:"red",connecting:"yellow",none:"yellow"};function AppLogs(){const{logs:_}=useAppLog(),o=useColorModeValue("gray.300","blackAlpha.900"),$=useColorModeValue("gray.800","gray.900"),j=useColorModeValue("gray.400","gray.100"),et=useColorModeValue("gray.900","gray.100"),tt=reactExports.useRef(null);return reactExports.useEffect(()=>{tt.current&&(tt.current.scrollTop=tt.current.scrollHeight)},[_.length]),jsx(Accordion,{id:"app-logs",allowToggle:!0,bg:o,position:"fixed",bottom:0,left:0,right:0,overflowY:"auto",children:jsxs(AccordionItem,{color:et,children:[jsx("h2",{children:jsxs(AccordionButton,{children:[jsx(Box,{flex:"1",textAlign:"left",children:jsxs(HStack,{children:[jsx(TreeDotsHorizontalSvgIcon,{}),jsx(Text,{as:"b",children:"Output"})]})}),jsx(AccordionIcon,{})]})}),jsx(AccordionPanel,{ref:tt,pb:4,bg:$,color:j,id:"app-logs-accordion-panel",maxH:"300px",minH:"300px",overflowY:"auto",children:_.map(rt=>jsxs(Flex,{children:[jsx(Text,{as:"b",color:colorSchema$1[rt.type],children:`${sentenseCase(rt.type)}`}),jsx(Text,{children:` : ${rt.text} `}),exludeTypes.includes(rt.type)?null:jsx(Text,{as:"b",color:colorSchema$1[rt.type],pl:1,children:`- hash : ${rt.id}`})]},rt.id))})]})})}const InitialState=[],AppDbContext=reactExports.createContext({dbs:InitialState,findDb:()=>{}}),AppDbDispatchContext=reactExports.createContext(()=>{});function logsReducer(_,o){var $;switch(o.type){case"init":return((($=o.dbs)==null?void 0:$.length)||0)<=0?[]:[...o.dbs];case"added":return o.db?[..._,o.db]:_;case"changed":return o.db?_.map(j=>j.id===o.db.id?o.db:j):_;case"deleted":return o.db?_.filter(j=>j.id!==o.db.id):_;default:throw Error("Unknown action: "+o.type)}}function AppDbProvider({children:_}){const[o,$]=reactExports.useReducer(logsReducer,InitialState),j=et=>{if(et)return o.find(tt=>tt.hash===et)};return jsx(AppDbContext.Provider,{value:{dbs:o,findDb:j},children:jsx(AppDbDispatchContext.Provider,{value:$,children:_})})}function useAppDb(){return reactExports.useContext(AppDbContext)}function useAppDbDispatch(){return reactExports.useContext(AppDbDispatchContext)}function useIsMounted(){const _=reactExports.useRef(!1);return reactExports.useEffect(()=>(_.current=!0,()=>{_.current=!1}),[]),reactExports.useCallback(()=>_.current,[])}var DBType=(_=>(_.feed="feed",_.eventlog="eventlog",_.keyvalue="keyvalue",_.docstore="docs",_.counter="counter",_))(DBType||{});const DbTypeExtendedDescription=[{type:"feed",description:"A feed is a log of entries, append-only, ordered by time"},{type:"eventlog",description:"Inmutable Log"},{type:"keyvalue",description:"A key-value store"},{type:"docs",description:"A document store, support for JSON documents"},{type:"counter",description:"Counter (CRDT)"}],DBPermissionExtendedDescription=[{type:"public",description:"Anyone can read and write"},{type:"private",description:"Creator-only : only you can write, anyone can read"}];var SystemState=(_=>(_.connecting="connecting",_.connected="connected",_.disconnected="disconnected",_.error="error",_))(SystemState||{});function assertPath(_){if(typeof _!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(_))}function normalizeStringPosix(_,o){for(var $="",j=0,et=-1,tt=0,rt,nt=0;nt<=_.length;++nt){if(nt<_.length)rt=_.charCodeAt(nt);else{if(rt===47)break;rt=47}if(rt===47){if(!(et===nt-1||tt===1))if(et!==nt-1&&tt===2){if($.length<2||j!==2||$.charCodeAt($.length-1)!==46||$.charCodeAt($.length-2)!==46){if($.length>2){var it=$.lastIndexOf("/");if(it!==$.length-1){it===-1?($="",j=0):($=$.slice(0,it),j=$.length-1-$.lastIndexOf("/")),et=nt,tt=0;continue}}else if($.length===2||$.length===1){$="",j=0,et=nt,tt=0;continue}}o&&($.length>0?$+="/..":$="..",j=2)}else $.length>0?$+="/"+_.slice(et+1,nt):$=_.slice(et+1,nt),j=nt-et-1;et=nt,tt=0}else rt===46&&tt!==-1?++tt:tt=-1}return $}function _format(_,o){var $=o.dir||o.root,j=o.base||(o.name||"")+(o.ext||"");return $?$===o.root?$+j:$+_+j:j}var posix={resolve:function(){for(var o="",$=!1,j,et=arguments.length-1;et>=-1&&!$;et--){var tt;et>=0?tt=arguments[et]:(j===void 0&&(j=browserExports$3.cwd()),tt=j),assertPath(tt),tt.length!==0&&(o=tt+"/"+o,$=tt.charCodeAt(0)===47)}return o=normalizeStringPosix(o,!$),$?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(o){if(assertPath(o),o.length===0)return".";var $=o.charCodeAt(0)===47,j=o.charCodeAt(o.length-1)===47;return o=normalizeStringPosix(o,!$),o.length===0&&!$&&(o="."),o.length>0&&j&&(o+="/"),$?"/"+o:o},isAbsolute:function(o){return assertPath(o),o.length>0&&o.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var o,$=0;$<arguments.length;++$){var j=arguments[$];assertPath(j),j.length>0&&(o===void 0?o=j:o+="/"+j)}return o===void 0?".":posix.normalize(o)},relative:function(o,$){if(assertPath(o),assertPath($),o===$||(o=posix.resolve(o),$=posix.resolve($),o===$))return"";for(var j=1;j<o.length&&o.charCodeAt(j)===47;++j);for(var et=o.length,tt=et-j,rt=1;rt<$.length&&$.charCodeAt(rt)===47;++rt);for(var nt=$.length,it=nt-rt,st=tt<it?tt:it,ot=-1,at=0;at<=st;++at){if(at===st){if(it>st){if($.charCodeAt(rt+at)===47)return $.slice(rt+at+1);if(at===0)return $.slice(rt+at)}else tt>st&&(o.charCodeAt(j+at)===47?ot=at:at===0&&(ot=0));break}var ct=o.charCodeAt(j+at),ut=$.charCodeAt(rt+at);if(ct!==ut)break;ct===47&&(ot=at)}var ft="";for(at=j+ot+1;at<=et;++at)(at===et||o.charCodeAt(at)===47)&&(ft.length===0?ft+="..":ft+="/..");return ft.length>0?ft+$.slice(rt+ot):(rt+=ot,$.charCodeAt(rt)===47&&++rt,$.slice(rt))},_makeLong:function(o){return o},dirname:function(o){if(assertPath(o),o.length===0)return".";for(var $=o.charCodeAt(0),j=$===47,et=-1,tt=!0,rt=o.length-1;rt>=1;--rt)if($=o.charCodeAt(rt),$===47){if(!tt){et=rt;break}}else tt=!1;return et===-1?j?"/":".":j&&et===1?"//":o.slice(0,et)},basename:function(o,$){if($!==void 0&&typeof $!="string")throw new TypeError('"ext" argument must be a string');assertPath(o);var j=0,et=-1,tt=!0,rt;if($!==void 0&&$.length>0&&$.length<=o.length){if($.length===o.length&&$===o)return"";var nt=$.length-1,it=-1;for(rt=o.length-1;rt>=0;--rt){var st=o.charCodeAt(rt);if(st===47){if(!tt){j=rt+1;break}}else it===-1&&(tt=!1,it=rt+1),nt>=0&&(st===$.charCodeAt(nt)?--nt===-1&&(et=rt):(nt=-1,et=it))}return j===et?et=it:et===-1&&(et=o.length),o.slice(j,et)}else{for(rt=o.length-1;rt>=0;--rt)if(o.charCodeAt(rt)===47){if(!tt){j=rt+1;break}}else et===-1&&(tt=!1,et=rt+1);return et===-1?"":o.slice(j,et)}},extname:function(o){assertPath(o);for(var $=-1,j=0,et=-1,tt=!0,rt=0,nt=o.length-1;nt>=0;--nt){var it=o.charCodeAt(nt);if(it===47){if(!tt){j=nt+1;break}continue}et===-1&&(tt=!1,et=nt+1),it===46?$===-1?$=nt:rt!==1&&(rt=1):$!==-1&&(rt=-1)}return $===-1||et===-1||rt===0||rt===1&&$===et-1&&$===j+1?"":o.slice($,et)},format:function(o){if(o===null||typeof o!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof o);return _format("/",o)},parse:function(o){assertPath(o);var $={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return $;var j=o.charCodeAt(0),et=j===47,tt;et?($.root="/",tt=1):tt=0;for(var rt=-1,nt=0,it=-1,st=!0,ot=o.length-1,at=0;ot>=tt;--ot){if(j=o.charCodeAt(ot),j===47){if(!st){nt=ot+1;break}continue}it===-1&&(st=!1,it=ot+1),j===46?rt===-1?rt=ot:at!==1&&(at=1):rt!==-1&&(at=-1)}return rt===-1||it===-1||at===0||at===1&&rt===it-1&&rt===nt+1?it!==-1&&(nt===0&&et?$.base=$.name=o.slice(1,it):$.base=$.name=o.slice(nt,it)):(nt===0&&et?($.name=o.slice(1,rt),$.base=o.slice(1,it)):($.name=o.slice(nt,rt),$.base=o.slice(nt,it)),$.ext=o.slice(rt,it)),nt>0?$.dir=o.slice(0,nt-1):et&&($.dir="/"),$},sep:"/",delimiter:":",win32:null,posix:null};posix.posix=posix;var pathBrowserify=posix,eventsExports={},events$2={get exports(){return eventsExports},set exports(_){eventsExports=_}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function(o,$,j){return Function.prototype.apply.call(o,$,j)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:ReflectOwnKeys=function(o){return Object.getOwnPropertyNames(o)};function ProcessEmitWarning(_){console&&console.warn&&console.warn(_)}var NumberIsNaN=Number.isNaN||function(o){return o!==o};function EventEmitter$5(){EventEmitter$5.init.call(this)}events$2.exports=EventEmitter$5;eventsExports.once=once;EventEmitter$5.EventEmitter=EventEmitter$5;EventEmitter$5.prototype._events=void 0;EventEmitter$5.prototype._eventsCount=0;EventEmitter$5.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(EventEmitter$5,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(_){if(typeof _!="number"||_<0||NumberIsNaN(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");defaultMaxListeners=_}});EventEmitter$5.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$5.prototype.setMaxListeners=function(o){if(typeof o!="number"||o<0||NumberIsNaN(o))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+o+".");return this._maxListeners=o,this};function _getMaxListeners(_){return _._maxListeners===void 0?EventEmitter$5.defaultMaxListeners:_._maxListeners}EventEmitter$5.prototype.getMaxListeners=function(){return _getMaxListeners(this)};EventEmitter$5.prototype.emit=function(o){for(var $=[],j=1;j<arguments.length;j++)$.push(arguments[j]);var et=o==="error",tt=this._events;if(tt!==void 0)et=et&&tt.error===void 0;else if(!et)return!1;if(et){var rt;if($.length>0&&(rt=$[0]),rt instanceof Error)throw rt;var nt=new Error("Unhandled error."+(rt?" ("+rt.message+")":""));throw nt.context=rt,nt}var it=tt[o];if(it===void 0)return!1;if(typeof it=="function")ReflectApply(it,this,$);else for(var st=it.length,ot=arrayClone(it,st),j=0;j<st;++j)ReflectApply(ot[j],this,$);return!0};function _addListener(_,o,$,j){var et,tt,rt;if(checkListener($),tt=_._events,tt===void 0?(tt=_._events=Object.create(null),_._eventsCount=0):(tt.newListener!==void 0&&(_.emit("newListener",o,$.listener?$.listener:$),tt=_._events),rt=tt[o]),rt===void 0)rt=tt[o]=$,++_._eventsCount;else if(typeof rt=="function"?rt=tt[o]=j?[$,rt]:[rt,$]:j?rt.unshift($):rt.push($),et=_getMaxListeners(_),et>0&&rt.length>et&&!rt.warned){rt.warned=!0;var nt=new Error("Possible EventEmitter memory leak detected. "+rt.length+" "+String(o)+" listeners added. Use emitter.setMaxListeners() to increase limit");nt.name="MaxListenersExceededWarning",nt.emitter=_,nt.type=o,nt.count=rt.length,ProcessEmitWarning(nt)}return _}EventEmitter$5.prototype.addListener=function(o,$){return _addListener(this,o,$,!1)};EventEmitter$5.prototype.on=EventEmitter$5.prototype.addListener;EventEmitter$5.prototype.prependListener=function(o,$){return _addListener(this,o,$,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(_,o,$){var j={fired:!1,wrapFn:void 0,target:_,type:o,listener:$},et=onceWrapper.bind(j);return et.listener=$,j.wrapFn=et,et}EventEmitter$5.prototype.once=function(o,$){return checkListener($),this.on(o,_onceWrap(this,o,$)),this};EventEmitter$5.prototype.prependOnceListener=function(o,$){return checkListener($),this.prependListener(o,_onceWrap(this,o,$)),this};EventEmitter$5.prototype.removeListener=function(o,$){var j,et,tt,rt,nt;if(checkListener($),et=this._events,et===void 0)return this;if(j=et[o],j===void 0)return this;if(j===$||j.listener===$)--this._eventsCount===0?this._events=Object.create(null):(delete et[o],et.removeListener&&this.emit("removeListener",o,j.listener||$));else if(typeof j!="function"){for(tt=-1,rt=j.length-1;rt>=0;rt--)if(j[rt]===$||j[rt].listener===$){nt=j[rt].listener,tt=rt;break}if(tt<0)return this;tt===0?j.shift():spliceOne(j,tt),j.length===1&&(et[o]=j[0]),et.removeListener!==void 0&&this.emit("removeListener",o,nt||$)}return this};EventEmitter$5.prototype.off=EventEmitter$5.prototype.removeListener;EventEmitter$5.prototype.removeAllListeners=function(o){var $,j,et;if(j=this._events,j===void 0)return this;if(j.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):j[o]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete j[o]),this;if(arguments.length===0){var tt=Object.keys(j),rt;for(et=0;et<tt.length;++et)rt=tt[et],rt!=="removeListener"&&this.removeAllListeners(rt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if($=j[o],typeof $=="function")this.removeListener(o,$);else if($!==void 0)for(et=$.length-1;et>=0;et--)this.removeListener(o,$[et]);return this};function _listeners(_,o,$){var j=_._events;if(j===void 0)return[];var et=j[o];return et===void 0?[]:typeof et=="function"?$?[et.listener||et]:[et]:$?unwrapListeners(et):arrayClone(et,et.length)}EventEmitter$5.prototype.listeners=function(o){return _listeners(this,o,!0)};EventEmitter$5.prototype.rawListeners=function(o){return _listeners(this,o,!1)};EventEmitter$5.listenerCount=function(_,o){return typeof _.listenerCount=="function"?_.listenerCount(o):listenerCount.call(_,o)};EventEmitter$5.prototype.listenerCount=listenerCount;function listenerCount(_){var o=this._events;if(o!==void 0){var $=o[_];if(typeof $=="function")return 1;if($!==void 0)return $.length}return 0}EventEmitter$5.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(_,o){for(var $=new Array(o),j=0;j<o;++j)$[j]=_[j];return $}function spliceOne(_,o){for(;o+1<_.length;o++)_[o]=_[o+1];_.pop()}function unwrapListeners(_){for(var o=new Array(_.length),$=0;$<o.length;++$)o[$]=_[$].listener||_[$];return o}function once(_,o){return new Promise(function($,j){function et(rt){_.removeListener(o,tt),j(rt)}function tt(){typeof _.removeListener=="function"&&_.removeListener("error",et),$([].slice.call(arguments))}eventTargetAgnosticAddListener(_,o,tt,{once:!0}),o!=="error"&&addErrorHandlerIfEventEmitter(_,et,{once:!0})})}function addErrorHandlerIfEventEmitter(_,o,$){typeof _.on=="function"&&eventTargetAgnosticAddListener(_,"error",o,$)}function eventTargetAgnosticAddListener(_,o,$,j){if(typeof _.on=="function")j.once?_.once(o,$):_.on(o,$);else if(typeof _.addEventListener=="function")_.addEventListener(o,function et(tt){j.once&&_.removeEventListener(o,et),$(tt)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}const pEachSeries=async(_,o)=>{let $=0;for(const j of _)if(await o(await j,$++)===pEachSeries.stop)break;return _};pEachSeries.stop=Symbol("pEachSeries.stop");var eventemitter3Exports={},eventemitter3={get exports(){return eventemitter3Exports},set exports(_){eventemitter3Exports=_}};(function(_){var o=Object.prototype.hasOwnProperty,$="~";function j(){}Object.create&&(j.prototype=Object.create(null),new j().__proto__||($=!1));function et(it,st,ot){this.fn=it,this.context=st,this.once=ot||!1}function tt(it,st,ot,at,ct){if(typeof ot!="function")throw new TypeError("The listener must be a function");var ut=new et(ot,at||it,ct),ft=$?$+st:st;return it._events[ft]?it._events[ft].fn?it._events[ft]=[it._events[ft],ut]:it._events[ft].push(ut):(it._events[ft]=ut,it._eventsCount++),it}function rt(it,st){--it._eventsCount===0?it._events=new j:delete it._events[st]}function nt(){this._events=new j,this._eventsCount=0}nt.prototype.eventNames=function(){var st=[],ot,at;if(this._eventsCount===0)return st;for(at in ot=this._events)o.call(ot,at)&&st.push($?at.slice(1):at);return Object.getOwnPropertySymbols?st.concat(Object.getOwnPropertySymbols(ot)):st},nt.prototype.listeners=function(st){var ot=$?$+st:st,at=this._events[ot];if(!at)return[];if(at.fn)return[at.fn];for(var ct=0,ut=at.length,ft=new Array(ut);ct<ut;ct++)ft[ct]=at[ct].fn;return ft},nt.prototype.listenerCount=function(st){var ot=$?$+st:st,at=this._events[ot];return at?at.fn?1:at.length:0},nt.prototype.emit=function(st,ot,at,ct,ut,ft){var ht=$?$+st:st;if(!this._events[ht])return!1;var mt=this._events[ht],gt=arguments.length,Et,St;if(mt.fn){switch(mt.once&&this.removeListener(st,mt.fn,void 0,!0),gt){case 1:return mt.fn.call(mt.context),!0;case 2:return mt.fn.call(mt.context,ot),!0;case 3:return mt.fn.call(mt.context,ot,at),!0;case 4:return mt.fn.call(mt.context,ot,at,ct),!0;case 5:return mt.fn.call(mt.context,ot,at,ct,ut),!0;case 6:return mt.fn.call(mt.context,ot,at,ct,ut,ft),!0}for(St=1,Et=new Array(gt-1);St<gt;St++)Et[St-1]=arguments[St];mt.fn.apply(mt.context,Et)}else{var At=mt.length,kt;for(St=0;St<At;St++)switch(mt[St].once&&this.removeListener(st,mt[St].fn,void 0,!0),gt){case 1:mt[St].fn.call(mt[St].context);break;case 2:mt[St].fn.call(mt[St].context,ot);break;case 3:mt[St].fn.call(mt[St].context,ot,at);break;case 4:mt[St].fn.call(mt[St].context,ot,at,ct);break;default:if(!Et)for(kt=1,Et=new Array(gt-1);kt<gt;kt++)Et[kt-1]=arguments[kt];mt[St].fn.apply(mt[St].context,Et)}}return!0},nt.prototype.on=function(st,ot,at){return tt(this,st,ot,at,!1)},nt.prototype.once=function(st,ot,at){return tt(this,st,ot,at,!0)},nt.prototype.removeListener=function(st,ot,at,ct){var ut=$?$+st:st;if(!this._events[ut])return this;if(!ot)return rt(this,ut),this;var ft=this._events[ut];if(ft.fn)ft.fn===ot&&(!ct||ft.once)&&(!at||ft.context===at)&&rt(this,ut);else{for(var ht=0,mt=[],gt=ft.length;ht<gt;ht++)(ft[ht].fn!==ot||ct&&!ft[ht].once||at&&ft[ht].context!==at)&&mt.push(ft[ht]);mt.length?this._events[ut]=mt.length===1?mt[0]:mt:rt(this,ut)}return this},nt.prototype.removeAllListeners=function(st){var ot;return st?(ot=$?$+st:st,this._events[ot]&&rt(this,ot)):(this._events=new j,this._eventsCount=0),this},nt.prototype.off=nt.prototype.removeListener,nt.prototype.addListener=nt.prototype.on,nt.prefixed=$,nt.EventEmitter=nt,_.exports=nt})(eventemitter3);let TimeoutError$6=class extends Error{constructor(o){super(o),this.name="TimeoutError"}},AbortError$8=class extends Error{constructor(o){super(),this.name="AbortError",this.message=o}};const getDOMException$3=_=>globalThis.DOMException===void 0?new AbortError$8(_):new DOMException(_),getAbortedReason$3=_=>{const o=_.reason===void 0?getDOMException$3("This operation was aborted."):_.reason;return o instanceof Error?o:getDOMException$3(o)};function pTimeout$2(_,o,$,j){let et;const tt=new Promise((rt,nt)=>{if(typeof o!="number"||Math.sign(o)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${o}\``);if(o===Number.POSITIVE_INFINITY){rt(_);return}if(j={customTimers:{setTimeout,clearTimeout},...j},j.signal){const{signal:it}=j;it.aborted&&nt(getAbortedReason$3(it)),it.addEventListener("abort",()=>{nt(getAbortedReason$3(it))})}et=j.customTimers.setTimeout.call(void 0,()=>{if(typeof $=="function"){try{rt($())}catch(ot){nt(ot)}return}const it=typeof $=="string"?$:`Promise timed out after ${o} milliseconds`,st=$ instanceof Error?$:new TimeoutError$6(it);typeof _.cancel=="function"&&_.cancel(),nt(st)},o),(async()=>{try{rt(await _)}catch(it){nt(it)}finally{j.customTimers.clearTimeout.call(void 0,et)}})()});return tt.clear=()=>{clearTimeout(et),et=void 0},tt}function lowerBound(_,o,$){let j=0,et=_.length;for(;et>0;){const tt=Math.trunc(et/2);let rt=j+tt;$(_[rt],o)<=0?(j=++rt,et-=tt+1):et=tt}return j}var __classPrivateFieldGet$6=globalThis&&globalThis.__classPrivateFieldGet||function(_,o,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?_!==o||!j:!o.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:o.get(_)},_PriorityQueue_queue;class PriorityQueue{constructor(){_PriorityQueue_queue.set(this,[])}enqueue(o,$){$={priority:0,...$};const j={priority:$.priority,run:o};if(this.size&&__classPrivateFieldGet$6(this,_PriorityQueue_queue,"f")[this.size-1].priority>=$.priority){__classPrivateFieldGet$6(this,_PriorityQueue_queue,"f").push(j);return}const et=lowerBound(__classPrivateFieldGet$6(this,_PriorityQueue_queue,"f"),j,(tt,rt)=>rt.priority-tt.priority);__classPrivateFieldGet$6(this,_PriorityQueue_queue,"f").splice(et,0,j)}dequeue(){const o=__classPrivateFieldGet$6(this,_PriorityQueue_queue,"f").shift();return o==null?void 0:o.run}filter(o){return __classPrivateFieldGet$6(this,_PriorityQueue_queue,"f").filter($=>$.priority===o.priority).map($=>$.run)}get size(){return __classPrivateFieldGet$6(this,_PriorityQueue_queue,"f").length}}_PriorityQueue_queue=new WeakMap;var __classPrivateFieldSet$4=globalThis&&globalThis.__classPrivateFieldSet||function(_,o,$,j,et){if(j==="m")throw new TypeError("Private method is not writable");if(j==="a"&&!et)throw new TypeError("Private accessor was defined without a setter");if(typeof o=="function"?_!==o||!et:!o.has(_))throw new TypeError("Cannot write private member to an object whose class did not declare it");return j==="a"?et.call(_,$):et?et.value=$:o.set(_,$),$},__classPrivateFieldGet$5=globalThis&&globalThis.__classPrivateFieldGet||function(_,o,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?_!==o||!j:!o.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:o.get(_)},_PQueue_instances,_PQueue_carryoverConcurrencyCount,_PQueue_isIntervalIgnored,_PQueue_intervalCount,_PQueue_intervalCap,_PQueue_interval,_PQueue_intervalEnd,_PQueue_intervalId,_PQueue_timeoutId,_PQueue_queue,_PQueue_queueClass,_PQueue_pending,_PQueue_concurrency,_PQueue_isPaused,_PQueue_throwOnTimeout,_PQueue_doesIntervalAllowAnother_get,_PQueue_doesConcurrentAllowAnother_get,_PQueue_next,_PQueue_onResumeInterval,_PQueue_isIntervalPaused_get,_PQueue_tryToStartAnother,_PQueue_initializeIntervalIfNeeded,_PQueue_onInterval,_PQueue_processQueue,_PQueue_throwOnAbort,_PQueue_onEvent;let AbortError$7=class extends Error{};class PQueue extends eventemitter3Exports{constructor(o){var $,j,et,tt;if(super(),_PQueue_instances.add(this),_PQueue_carryoverConcurrencyCount.set(this,void 0),_PQueue_isIntervalIgnored.set(this,void 0),_PQueue_intervalCount.set(this,0),_PQueue_intervalCap.set(this,void 0),_PQueue_interval.set(this,void 0),_PQueue_intervalEnd.set(this,0),_PQueue_intervalId.set(this,void 0),_PQueue_timeoutId.set(this,void 0),_PQueue_queue.set(this,void 0),_PQueue_queueClass.set(this,void 0),_PQueue_pending.set(this,0),_PQueue_concurrency.set(this,void 0),_PQueue_isPaused.set(this,void 0),_PQueue_throwOnTimeout.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),o={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...o},!(typeof o.intervalCap=="number"&&o.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(j=($=o.intervalCap)===null||$===void 0?void 0:$.toString())!==null&&j!==void 0?j:""}\` (${typeof o.intervalCap})`);if(o.interval===void 0||!(Number.isFinite(o.interval)&&o.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(tt=(et=o.interval)===null||et===void 0?void 0:et.toString())!==null&&tt!==void 0?tt:""}\` (${typeof o.interval})`);__classPrivateFieldSet$4(this,_PQueue_carryoverConcurrencyCount,o.carryoverConcurrencyCount,"f"),__classPrivateFieldSet$4(this,_PQueue_isIntervalIgnored,o.intervalCap===Number.POSITIVE_INFINITY||o.interval===0,"f"),__classPrivateFieldSet$4(this,_PQueue_intervalCap,o.intervalCap,"f"),__classPrivateFieldSet$4(this,_PQueue_interval,o.interval,"f"),__classPrivateFieldSet$4(this,_PQueue_queue,new o.queueClass,"f"),__classPrivateFieldSet$4(this,_PQueue_queueClass,o.queueClass,"f"),this.concurrency=o.concurrency,this.timeout=o.timeout,__classPrivateFieldSet$4(this,_PQueue_throwOnTimeout,o.throwOnTimeout===!0,"f"),__classPrivateFieldSet$4(this,_PQueue_isPaused,o.autoStart===!1,"f")}get concurrency(){return __classPrivateFieldGet$5(this,_PQueue_concurrency,"f")}set concurrency(o){if(!(typeof o=="number"&&o>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${o}\` (${typeof o})`);__classPrivateFieldSet$4(this,_PQueue_concurrency,o,"f"),__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)}async add(o,$={}){return $={timeout:this.timeout,throwOnTimeout:__classPrivateFieldGet$5(this,_PQueue_throwOnTimeout,"f"),...$},new Promise((j,et)=>{__classPrivateFieldGet$5(this,_PQueue_queue,"f").enqueue(async()=>{var tt,rt,nt;__classPrivateFieldSet$4(this,_PQueue_pending,(rt=__classPrivateFieldGet$5(this,_PQueue_pending,"f"),rt++,rt),"f"),__classPrivateFieldSet$4(this,_PQueue_intervalCount,(nt=__classPrivateFieldGet$5(this,_PQueue_intervalCount,"f"),nt++,nt),"f");try{if(!((tt=$.signal)===null||tt===void 0)&&tt.aborted)throw new AbortError$7("The task was aborted.");let it=o({signal:$.signal});$.timeout&&(it=pTimeout$2(Promise.resolve(it),$.timeout)),$.signal&&(it=Promise.race([it,__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_throwOnAbort).call(this,$.signal)]));const st=await it;j(st),this.emit("completed",st)}catch(it){if(it instanceof TimeoutError$6&&!$.throwOnTimeout){j();return}et(it),this.emit("error",it)}finally{__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_next).call(this)}},$),this.emit("add"),__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this)})}async addAll(o,$){return Promise.all(o.map(async j=>this.add(j,$)))}start(){return __classPrivateFieldGet$5(this,_PQueue_isPaused,"f")?(__classPrivateFieldSet$4(this,_PQueue_isPaused,!1,"f"),__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_processQueue).call(this),this):this}pause(){__classPrivateFieldSet$4(this,_PQueue_isPaused,!0,"f")}clear(){__classPrivateFieldSet$4(this,_PQueue_queue,new(__classPrivateFieldGet$5(this,_PQueue_queueClass,"f")),"f")}async onEmpty(){__classPrivateFieldGet$5(this,_PQueue_queue,"f").size!==0&&await __classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"empty")}async onSizeLessThan(o){__classPrivateFieldGet$5(this,_PQueue_queue,"f").size<o||await __classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"next",()=>__classPrivateFieldGet$5(this,_PQueue_queue,"f").size<o)}async onIdle(){__classPrivateFieldGet$5(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet$5(this,_PQueue_queue,"f").size===0||await __classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"idle")}get size(){return __classPrivateFieldGet$5(this,_PQueue_queue,"f").size}sizeBy(o){return __classPrivateFieldGet$5(this,_PQueue_queue,"f").filter(o).length}get pending(){return __classPrivateFieldGet$5(this,_PQueue_pending,"f")}get isPaused(){return __classPrivateFieldGet$5(this,_PQueue_isPaused,"f")}}_PQueue_carryoverConcurrencyCount=new WeakMap,_PQueue_isIntervalIgnored=new WeakMap,_PQueue_intervalCount=new WeakMap,_PQueue_intervalCap=new WeakMap,_PQueue_interval=new WeakMap,_PQueue_intervalEnd=new WeakMap,_PQueue_intervalId=new WeakMap,_PQueue_timeoutId=new WeakMap,_PQueue_queue=new WeakMap,_PQueue_queueClass=new WeakMap,_PQueue_pending=new WeakMap,_PQueue_concurrency=new WeakMap,_PQueue_isPaused=new WeakMap,_PQueue_throwOnTimeout=new WeakMap,_PQueue_instances=new WeakSet,_PQueue_doesIntervalAllowAnother_get=function(){return __classPrivateFieldGet$5(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet$5(this,_PQueue_intervalCount,"f")<__classPrivateFieldGet$5(this,_PQueue_intervalCap,"f")},_PQueue_doesConcurrentAllowAnother_get=function(){return __classPrivateFieldGet$5(this,_PQueue_pending,"f")<__classPrivateFieldGet$5(this,_PQueue_concurrency,"f")},_PQueue_next=function(){var o;__classPrivateFieldSet$4(this,_PQueue_pending,(o=__classPrivateFieldGet$5(this,_PQueue_pending,"f"),o--,o),"f"),__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this),this.emit("next")},_PQueue_onResumeInterval=function(){__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_onInterval).call(this),__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),__classPrivateFieldSet$4(this,_PQueue_timeoutId,void 0,"f")},_PQueue_isIntervalPaused_get=function(){const o=Date.now();if(__classPrivateFieldGet$5(this,_PQueue_intervalId,"f")===void 0){const $=__classPrivateFieldGet$5(this,_PQueue_intervalEnd,"f")-o;if($<0)__classPrivateFieldSet$4(this,_PQueue_intervalCount,__classPrivateFieldGet$5(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet$5(this,_PQueue_pending,"f"):0,"f");else return __classPrivateFieldGet$5(this,_PQueue_timeoutId,"f")===void 0&&__classPrivateFieldSet$4(this,_PQueue_timeoutId,setTimeout(()=>{__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_onResumeInterval).call(this)},$),"f"),!0}return!1},_PQueue_tryToStartAnother=function(){if(__classPrivateFieldGet$5(this,_PQueue_queue,"f").size===0)return __classPrivateFieldGet$5(this,_PQueue_intervalId,"f")&&clearInterval(__classPrivateFieldGet$5(this,_PQueue_intervalId,"f")),__classPrivateFieldSet$4(this,_PQueue_intervalId,void 0,"f"),this.emit("empty"),__classPrivateFieldGet$5(this,_PQueue_pending,"f")===0&&this.emit("idle"),!1;if(!__classPrivateFieldGet$5(this,_PQueue_isPaused,"f")){const o=!__classPrivateFieldGet$5(this,_PQueue_instances,"a",_PQueue_isIntervalPaused_get);if(__classPrivateFieldGet$5(this,_PQueue_instances,"a",_PQueue_doesIntervalAllowAnother_get)&&__classPrivateFieldGet$5(this,_PQueue_instances,"a",_PQueue_doesConcurrentAllowAnother_get)){const $=__classPrivateFieldGet$5(this,_PQueue_queue,"f").dequeue();return $?(this.emit("active"),$(),o&&__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),!0):!1}}return!1},_PQueue_initializeIntervalIfNeeded=function(){__classPrivateFieldGet$5(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet$5(this,_PQueue_intervalId,"f")!==void 0||(__classPrivateFieldSet$4(this,_PQueue_intervalId,setInterval(()=>{__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_onInterval).call(this)},__classPrivateFieldGet$5(this,_PQueue_interval,"f")),"f"),__classPrivateFieldSet$4(this,_PQueue_intervalEnd,Date.now()+__classPrivateFieldGet$5(this,_PQueue_interval,"f"),"f"))},_PQueue_onInterval=function(){__classPrivateFieldGet$5(this,_PQueue_intervalCount,"f")===0&&__classPrivateFieldGet$5(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet$5(this,_PQueue_intervalId,"f")&&(clearInterval(__classPrivateFieldGet$5(this,_PQueue_intervalId,"f")),__classPrivateFieldSet$4(this,_PQueue_intervalId,void 0,"f")),__classPrivateFieldSet$4(this,_PQueue_intervalCount,__classPrivateFieldGet$5(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet$5(this,_PQueue_pending,"f"):0,"f"),__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)},_PQueue_processQueue=function(){for(;__classPrivateFieldGet$5(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this););},_PQueue_throwOnAbort=async function(o){return new Promise(($,j)=>{o.addEventListener("abort",()=>{j(new AbortError$7("The task was aborted."))},{once:!0})})},_PQueue_onEvent=async function(o,$){return new Promise(j=>{const et=()=>{$&&!$()||(this.off(o,et),j())};this.on(o,et)})};class Index{constructor(o){this.id=o,this._index=[]}get(){return this._index}async updateIndex(o,$){this._index=o.values}}function indentString(_,o=1,$={}){const{indent:j=" ",includeEmptyLines:et=!1}=$;if(typeof _!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof _}\``);if(typeof o!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof o}\``);if(o<0)throw new RangeError(`Expected \`count\` to be at least 0, got \`${o}\``);if(typeof j!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof j}\``);if(o===0)return _;const tt=et?/^/gm:/^(?!\s*$)/gm;return _.replace(tt,j.repeat(o))}var browser$h={};browser$h.endianness=function(){return"LE"};browser$h.hostname=function(){return typeof location<"u"?location.hostname:""};browser$h.loadavg=function(){return[]};browser$h.uptime=function(){return 0};browser$h.freemem=function(){return Number.MAX_VALUE};browser$h.totalmem=function(){return Number.MAX_VALUE};browser$h.cpus=function(){return[]};browser$h.type=function(){return"Browser"};browser$h.release=function(){return typeof navigator<"u"?navigator.appVersion:""};browser$h.networkInterfaces=browser$h.getNetworkInterfaces=function(){return{}};browser$h.arch=function(){return"javascript"};browser$h.platform=function(){return"browser"};browser$h.tmpdir=browser$h.tmpDir=function(){return"/tmp"};browser$h.EOL=`
`;browser$h.homedir=function(){return"/"};function escapeStringRegexp(_){if(typeof _!="string")throw new TypeError("Expected a string");return _.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}const extractPathRegex=/\s+at.*[(\s](.*)\)?/,pathRegex=/^(?:(?:(?:node|node:[\w/]+|(?:(?:node:)?internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)(?:\.js)?:\d+:\d+)|native)/,homeDir=typeof browser$h.homedir>"u"?"":browser$h.homedir().replace(/\\/g,"/");function cleanStack(_,{pretty:o=!1,basePath:$}={}){const j=$&&new RegExp(`(at | \\()${escapeStringRegexp($.replace(/\\/g,"/"))}`,"g");if(typeof _=="string")return _.replace(/\\/g,"/").split(`
`).filter(et=>{const tt=et.match(extractPathRegex);if(tt===null||!tt[1])return!0;const rt=tt[1];return rt.includes(".app/Contents/Resources/electron.asar")||rt.includes(".app/Contents/Resources/default_app.asar")||rt.includes("node_modules/electron/dist/resources/electron.asar")||rt.includes("node_modules/electron/dist/resources/default_app.asar")?!1:!pathRegex.test(rt)}).filter(et=>et.trim()!=="").map(et=>(j&&(et=et.replace(j,"$1")),o&&(et=et.replace(extractPathRegex,(tt,rt)=>tt.replace(rt,rt.replace(homeDir,"~")))),et)).join(`
`)}const cleanInternalStack=_=>_.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,"");var $s,Ao;let AggregateError$1=(Ao=class extends Error{constructor($){if(!Array.isArray($))throw new TypeError(`Expected input to be an Array, got ${typeof $}`);$=$.map(et=>et instanceof Error?et:et!==null&&typeof et=="object"?Object.assign(new Error(et.message),et):new Error(et));let j=$.map(et=>typeof et.stack=="string"&&et.stack.length>0?cleanInternalStack(cleanStack(et.stack)):String(et)).join(`
`);j=`
`+indentString(j,4);super(j);xs(this,$s,void 0);os(this,"name","AggregateError");zn(this,$s,$)}get errors(){return jn(this,$s).slice()}},$s=new WeakMap,Ao),AbortError$6=class extends Error{constructor(o){super(),this.name="AbortError",this.message=o}};const getDOMException$2=_=>globalThis.DOMException===void 0?new AbortError$6(_):new DOMException(_),getAbortedReason$2=_=>{const o=_.reason===void 0?getDOMException$2("This operation was aborted."):_.reason;return o instanceof Error?o:getDOMException$2(o)};async function pMap$1(_,o,{concurrency:$=Number.POSITIVE_INFINITY,stopOnError:j=!0,signal:et}={}){return new Promise((tt,rt)=>{if(_[Symbol.iterator]===void 0&&_[Symbol.asyncIterator]===void 0)throw new TypeError(`Expected \`input\` to be either an \`Iterable\` or \`AsyncIterable\`, got (${typeof _})`);if(typeof o!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger($)||$===Number.POSITIVE_INFINITY)&&$>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${$}\` (${typeof $})`);const nt=[],it=[],st=new Map;let ot=!1,at=!1,ct=!1,ut=0,ft=0;const ht=_[Symbol.iterator]===void 0?_[Symbol.asyncIterator]():_[Symbol.iterator](),mt=Et=>{ot=!0,at=!0,rt(Et)};et&&(et.aborted&&mt(getAbortedReason$2(et)),et.addEventListener("abort",()=>{mt(getAbortedReason$2(et))}));const gt=async()=>{if(at)return;const Et=await ht.next(),St=ft;if(ft++,Et.done){if(ct=!0,ut===0&&!at){if(!j&&it.length>0){mt(new AggregateError$1(it));return}if(at=!0,st.size===0){tt(nt);return}const At=[];for(const[kt,Rt]of nt.entries())st.get(kt)!==pMapSkip&&At.push(Rt);tt(At)}return}ut++,(async()=>{try{const At=await Et.value;if(at)return;const kt=await o(At,St);kt===pMapSkip&&st.set(St,kt),nt[St]=kt,ut--,await gt()}catch(At){if(j)mt(At);else{it.push(At),ut--;try{await gt()}catch(kt){mt(kt)}}}})()};(async()=>{for(let Et=0;Et<$;Et++){try{await gt()}catch(St){mt(St);break}if(ct||ot)break}})()})}const pMapSkip=Symbol("skip");class GSet{constructor(o){}append(o){}merge(o){}get(o){}has(o){}get values(){}get length(){}}class LamportClock{constructor(o,$){this.id=o,this.time=$||0}tick(){return new LamportClock(this.id,++this.time)}merge(o){return this.time=Math.max(this.time,o.time),new LamportClock(this.id,this.time)}clone(){return new LamportClock(this.id,this.time)}static compare(o,$){const j=o.time-$.time;return j===0&&o.id!==$.id?o.id<$.id?-1:1:j}}var encode_1$5=encode$E,MSB$8=128,REST$8=127,MSBALL$5=~REST$8,INT$5=Math.pow(2,31);function encode$E(_,o,$){o=o||[],$=$||0;for(var j=$;_>=INT$5;)o[$++]=_&255|MSB$8,_/=128;for(;_&MSBALL$5;)o[$++]=_&255|MSB$8,_>>>=7;return o[$]=_|0,encode$E.bytes=$-j+1,o}var decode$D=read$8,MSB$1$4=128,REST$1$4=127;function read$8(_,j){var $=0,j=j||0,et=0,tt=j,rt,nt=_.length;do{if(tt>=nt)throw read$8.bytes=0,new RangeError("Could not decode varint");rt=_[tt++],$+=et<28?(rt&REST$1$4)<<et:(rt&REST$1$4)*Math.pow(2,et),et+=7}while(rt>=MSB$1$4);return read$8.bytes=tt-j,$}var N1$6=Math.pow(2,7),N2$6=Math.pow(2,14),N3$6=Math.pow(2,21),N4$6=Math.pow(2,28),N5$6=Math.pow(2,35),N6$6=Math.pow(2,42),N7$6=Math.pow(2,49),N8$6=Math.pow(2,56),N9$6=Math.pow(2,63),length$7=function(_){return _<N1$6?1:_<N2$6?2:_<N3$6?3:_<N4$6?4:_<N5$6?5:_<N6$6?6:_<N7$6?7:_<N8$6?8:_<N9$6?9:10},varint$6={encode:encode_1$5,decode:decode$D,encodingLength:length$7},_brrp_varint$3=varint$6;const decode$C=(_,o=0)=>[_brrp_varint$3.decode(_,o),_brrp_varint$3.decode.bytes],encodeTo$3=(_,o,$=0)=>(_brrp_varint$3.encode(_,o,$),o),encodingLength$3=_=>_brrp_varint$3.encodingLength(_),empty$2=new Uint8Array(0),fromHex=_=>{const o=_.match(/../g);return o?new Uint8Array(o.map($=>parseInt($,16))):empty$2},equals$8=(_,o)=>{if(_===o)return!0;if(_.byteLength!==o.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==o[$])return!1;return!0},coerce$4=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},fromString$a=_=>new TextEncoder().encode(_),toString$c=_=>new TextDecoder().decode(_),create$c=(_,o)=>{const $=o.byteLength,j=encodingLength$3(_),et=j+encodingLength$3($),tt=new Uint8Array(et+$);return encodeTo$3(_,tt,0),encodeTo$3($,tt,j),tt.set(o,et),new Digest$3(_,$,o,tt)},decode$B=_=>{const o=coerce$4(_),[$,j]=decode$C(o),[et,tt]=decode$C(o.subarray(j)),rt=o.subarray(j+tt);if(rt.byteLength!==et)throw new Error("Incorrect length");return new Digest$3($,et,rt,o)},equals$7=(_,o)=>{if(_===o)return!0;{const $=o;return _.code===$.code&&_.size===$.size&&$.bytes instanceof Uint8Array&&equals$8(_.bytes,$.bytes)}};let Digest$3=class{constructor(o,$,j,et){this.code=o,this.size=$,this.digest=j,this.bytes=et}};function base$8(_,o){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var et=0;et<_.length;et++){var tt=_.charAt(et),rt=tt.charCodeAt(0);if($[rt]!==255)throw new TypeError(tt+" is ambiguous");$[rt]=et}var nt=_.length,it=_.charAt(0),st=Math.log(nt)/Math.log(256),ot=Math.log(256)/Math.log(nt);function at(ft){if(ft instanceof Uint8Array||(ArrayBuffer.isView(ft)?ft=new Uint8Array(ft.buffer,ft.byteOffset,ft.byteLength):Array.isArray(ft)&&(ft=Uint8Array.from(ft))),!(ft instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ft.length===0)return"";for(var ht=0,mt=0,gt=0,Et=ft.length;gt!==Et&&ft[gt]===0;)gt++,ht++;for(var St=(Et-gt)*ot+1>>>0,At=new Uint8Array(St);gt!==Et;){for(var kt=ft[gt],Rt=0,Tt=St-1;(kt!==0||Rt<mt)&&Tt!==-1;Tt--,Rt++)kt+=256*At[Tt]>>>0,At[Tt]=kt%nt>>>0,kt=kt/nt>>>0;if(kt!==0)throw new Error("Non-zero carry");mt=Rt,gt++}for(var Dt=St-mt;Dt!==St&&At[Dt]===0;)Dt++;for(var Ot=it.repeat(ht);Dt<St;++Dt)Ot+=_.charAt(At[Dt]);return Ot}function ct(ft){if(typeof ft!="string")throw new TypeError("Expected String");if(ft.length===0)return new Uint8Array;var ht=0;if(ft[ht]!==" "){for(var mt=0,gt=0;ft[ht]===it;)mt++,ht++;for(var Et=(ft.length-ht)*st+1>>>0,St=new Uint8Array(Et);ft[ht];){var At=$[ft.charCodeAt(ht)];if(At===255)return;for(var kt=0,Rt=Et-1;(At!==0||kt<gt)&&Rt!==-1;Rt--,kt++)At+=nt*St[Rt]>>>0,St[Rt]=At%256>>>0,At=At/256>>>0;if(At!==0)throw new Error("Non-zero carry");gt=kt,ht++}if(ft[ht]!==" "){for(var Tt=Et-gt;Tt!==Et&&St[Tt]===0;)Tt++;for(var Dt=new Uint8Array(mt+(Et-Tt)),Ot=mt;Tt!==Et;)Dt[Ot++]=St[Tt++];return Dt}}}function ut(ft){var ht=ct(ft);if(ht)return ht;throw new Error(`Non-${o} character`)}return{encode:at,decodeUnsafe:ct,decode:ut}}var src$a=base$8,_brrp__multiformats_scope_baseX$4=src$a;let Encoder$6=class{constructor(o,$,j){this.name=o,this.prefix=$,this.baseEncode=j}encode(o){if(o instanceof Uint8Array)return`${this.prefix}${this.baseEncode(o)}`;throw Error("Unknown type, must be binary type")}},Decoder$6=class{constructor(o,$,j){if(this.name=o,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(o){if(typeof o=="string"){if(o.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(o)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(o.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(o){return or$5(this,o)}},ComposedDecoder$4=class{constructor(o){this.decoders=o}or(o){return or$5(this,o)}decode(o){const $=o[0],j=this.decoders[$];if(j)return j.decode(o);throw RangeError(`Unable to decode multibase string ${JSON.stringify(o)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$5=(_,o)=>new ComposedDecoder$4({..._.decoders||{[_.prefix]:_},...o.decoders||{[o.prefix]:o}});let Codec$4=class{constructor(o,$,j,et){this.name=o,this.prefix=$,this.baseEncode=j,this.baseDecode=et,this.encoder=new Encoder$6(o,$,j),this.decoder=new Decoder$6(o,$,et)}encode(o){return this.encoder.encode(o)}decode(o){return this.decoder.decode(o)}};const from$8=({name:_,prefix:o,encode:$,decode:j})=>new Codec$4(_,o,$,j),baseX$4=({prefix:_,name:o,alphabet:$})=>{const{encode:j,decode:et}=_brrp__multiformats_scope_baseX$4($,o);return from$8({prefix:_,name:o,encode:j,decode:tt=>coerce$4(et(tt))})},decode$A=(_,o,$,j)=>{const et={};for(let ot=0;ot<o.length;++ot)et[o[ot]]=ot;let tt=_.length;for(;_[tt-1]==="=";)--tt;const rt=new Uint8Array(tt*$/8|0);let nt=0,it=0,st=0;for(let ot=0;ot<tt;++ot){const at=et[_[ot]];if(at===void 0)throw new SyntaxError(`Non-${j} character`);it=it<<$|at,nt+=$,nt>=8&&(nt-=8,rt[st++]=255&it>>nt)}if(nt>=$||255&it<<8-nt)throw new SyntaxError("Unexpected end of data");return rt},encode$D=(_,o,$)=>{const j=o[o.length-1]==="=",et=(1<<$)-1;let tt="",rt=0,nt=0;for(let it=0;it<_.length;++it)for(nt=nt<<8|_[it],rt+=8;rt>$;)rt-=$,tt+=o[et&nt>>rt];if(rt&&(tt+=o[et&nt<<$-rt]),j)for(;tt.length*$&7;)tt+="=";return tt},rfc4648$4=({name:_,prefix:o,bitsPerChar:$,alphabet:j})=>from$8({prefix:o,name:_,encode(et){return encode$D(et,j,$)},decode(et){return decode$A(et,j,$,_)}}),base58btc$4=baseX$4({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$2=baseX$4({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$4,base58flickr:base58flickr$2},Symbol.toStringTag,{value:"Module"})),base32$6=rfc4648$4({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$2=rfc4648$4({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$2=rfc4648$4({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$2=rfc4648$4({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$2=rfc4648$4({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$2=rfc4648$4({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$2=rfc4648$4({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$2=rfc4648$4({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$4({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$7=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$6,base32hex:base32hex$2,base32hexpad:base32hexpad$2,base32hexpadupper:base32hexpadupper$2,base32hexupper:base32hexupper$2,base32pad:base32pad$2,base32padupper:base32padupper$2,base32upper:base32upper$2,base32z:base32z$2},Symbol.toStringTag,{value:"Module"})),format$7=(_,o)=>{const{bytes:$,version:j}=_;switch(j){case 0:return toStringV0$3($,baseCache(_),o||base58btc$4.encoder);default:return toStringV1$3($,baseCache(_),o||base32$6.encoder)}},cache$3=new WeakMap,baseCache=_=>{const o=cache$3.get(_);if(o==null){const $=new Map;return cache$3.set(_,$),$}return o};let CID$3=class Dn{constructor(o,$,j,et){this.code=$,this.version=o,this.multihash=j,this.bytes=et,this["/"]=et}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:o,multihash:$}=this;if(o!==DAG_PB_CODE$3)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if($.code!==SHA_256_CODE$3)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Dn.createV0($)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:o,digest:$}=this.multihash,j=create$c(o,$);return Dn.createV1(this.code,j)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(o){return Dn.equals(this,o)}static equals(o,$){const j=$;return j&&o.code===j.code&&o.version===j.version&&equals$7(o.multihash,j.multihash)}toString(o){return format$7(this,o)}toJSON(){return{"/":format$7(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(o){if(o==null)return null;const $=o;if($ instanceof Dn)return $;if($["/"]!=null&&$["/"]===$.bytes||$.asCID===$){const{version:j,code:et,multihash:tt,bytes:rt}=$;return new Dn(j,et,tt,rt||encodeCID$4(j,et,tt.bytes))}else if($[cidSymbol$3]===!0){const{version:j,multihash:et,code:tt}=$,rt=decode$B(et);return Dn.create(j,tt,rt)}else return null}static create(o,$,j){if(typeof $!="number")throw new Error("String codecs are no longer supported");if(!(j.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(o){case 0:{if($!==DAG_PB_CODE$3)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$3}) block encoding`);return new Dn(o,$,j,j.bytes)}case 1:{const et=encodeCID$4(o,$,j.bytes);return new Dn(o,$,j,et)}default:throw new Error("Invalid version")}}static createV0(o){return Dn.create(0,DAG_PB_CODE$3,o)}static createV1(o,$){return Dn.create(1,o,$)}static decode(o){const[$,j]=Dn.decodeFirst(o);if(j.length)throw new Error("Incorrect length");return $}static decodeFirst(o){const $=Dn.inspectBytes(o),j=$.size-$.multihashSize,et=coerce$4(o.subarray(j,j+$.multihashSize));if(et.byteLength!==$.multihashSize)throw new Error("Incorrect length");const tt=et.subarray($.multihashSize-$.digestSize),rt=new Digest$3($.multihashCode,$.digestSize,tt,et);return[$.version===0?Dn.createV0(rt):Dn.createV1($.codec,rt),o.subarray($.size)]}static inspectBytes(o){let $=0;const j=()=>{const[at,ct]=decode$C(o.subarray($));return $+=ct,at};let et=j(),tt=DAG_PB_CODE$3;if(et===18?(et=0,$=0):tt=j(),et!==0&&et!==1)throw new RangeError(`Invalid CID version ${et}`);const rt=$,nt=j(),it=j(),st=$+it,ot=st-rt;return{version:et,codec:tt,multihashCode:nt,digestSize:it,multihashSize:ot,size:st}}static parse(o,$){const[j,et]=parseCIDtoBytes$3(o,$),tt=Dn.decode(et);if(tt.version===0&&o[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache(tt).set(j,o),tt}};const parseCIDtoBytes$3=(_,o)=>{switch(_[0]){case"Q":{const $=o||base58btc$4;return[base58btc$4.prefix,$.decode(`${base58btc$4.prefix}${_}`)]}case base58btc$4.prefix:{const $=o||base58btc$4;return[base58btc$4.prefix,$.decode(_)]}case base32$6.prefix:{const $=o||base32$6;return[base32$6.prefix,$.decode(_)]}default:{if(o==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[_[0],o.decode(_)]}}},toStringV0$3=(_,o,$)=>{const{prefix:j}=$;if(j!==base58btc$4.prefix)throw Error(`Cannot string encode V0 in ${$.name} encoding`);const et=o.get(j);if(et==null){const tt=$.encode(_).slice(1);return o.set(j,tt),tt}else return et},toStringV1$3=(_,o,$)=>{const{prefix:j}=$,et=o.get(j);if(et==null){const tt=$.encode(_);return o.set(j,tt),tt}else return et},DAG_PB_CODE$3=112,SHA_256_CODE$3=18,encodeCID$4=(_,o,$)=>{const j=encodingLength$3(_),et=j+encodingLength$3(o),tt=new Uint8Array(et+$.byteLength);return encodeTo$3(_,tt,0),encodeTo$3(o,tt,j),tt.set($,et),tt},cidSymbol$3=Symbol.for("@ipld/js-cid/CID"),from$7=({name:_,code:o,encode:$})=>new Hasher$2(_,o,$);let Hasher$2=class{constructor(o,$,j){this.name=o,this.code=$,this.encode=j}digest(o){if(o instanceof Uint8Array){const $=this.encode(o);return $ instanceof Uint8Array?create$c(this.code,$):$.then(j=>create$c(this.code,j))}else throw Error("Unknown type, must be binary type")}};function readonly$5({enumerable:_=!0,configurable:o=!1}={}){return{enumerable:_,configurable:o,writable:!1}}function*linksWithin(_,o){if(o!=null&&typeof o=="object")if(Array.isArray(o))for(const[$,j]of o.entries()){const et=[..._,$],tt=CID$3.asCID(j);tt?yield[et.join("/"),tt]:typeof j=="object"&&(yield*links$3(j,et))}else{const $=CID$3.asCID(o);$?yield[_.join("/"),$]:yield*links$3(o,_)}}function*links$3(_,o){if(_==null||_ instanceof Uint8Array)return;const $=CID$3.asCID(_);$&&(yield[o.join("/"),$]);for(const[j,et]of Object.entries(_)){const tt=[...o,j];yield*linksWithin(tt,et)}}function*treeWithin(_,o){if(Array.isArray(o))for(const[$,j]of o.entries()){const et=[..._,$];yield et.join("/"),typeof j=="object"&&!CID$3.asCID(j)&&(yield*tree$2(j,et))}else yield*tree$2(o,_)}function*tree$2(_,o){if(!(_==null||typeof _!="object"))for(const[$,j]of Object.entries(_)){const et=[...o,$];yield et.join("/"),j!=null&&!(j instanceof Uint8Array)&&typeof j=="object"&&!CID$3.asCID(j)&&(yield*treeWithin(et,j))}}function get$4(_,o){let $=_;for(const[j,et]of o.entries()){if($=$[et],$==null)throw new Error(`Object has no property at ${o.slice(0,j+1).map(rt=>`[${JSON.stringify(rt)}]`).join("")}`);const tt=CID$3.asCID($);if(tt)return{value:tt,remaining:o.slice(j+1).join("/")}}return{value:$}}let Block$2=class{constructor({cid:o,bytes:$,value:j}){if(!o||!$||typeof j>"u")throw new Error("Missing required argument");this.cid=o,this.bytes=$,this.value=j,this.asBlock=this,Object.defineProperties(this,{cid:readonly$5(),bytes:readonly$5(),value:readonly$5(),asBlock:readonly$5()})}links(){return links$3(this.value,[])}tree(){return tree$2(this.value,[])}get(o="/"){return get$4(this.value,o.split("/").filter(Boolean))}};async function encode$C({value:_,codec:o,hasher:$}){if(typeof _>"u")throw new Error('Missing required argument "value"');if(!o||!$)throw new Error("Missing required argument: codec or hasher");const j=o.encode(_),et=await $.digest(j),tt=CID$3.create(1,o.code,et);return new Block$2({value:_,bytes:j,cid:tt})}async function decode$z({bytes:_,codec:o,hasher:$}){if(!_)throw new Error('Missing required argument "bytes"');if(!o||!$)throw new Error("Missing required argument: codec or hasher");const j=o.decode(_),et=await $.digest(_),tt=CID$3.create(1,o.code,et);return new Block$2({value:j,bytes:_,cid:tt})}function createUnsafe({bytes:_,cid:o,value:$,codec:j}){const et=$!==void 0?$:j&&j.decode(_);if(et===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Block$2({cid:o,bytes:_,value:et})}const textDecoder$3=new TextDecoder;function decodeVarint$1(_,o){let $=0;for(let j=0;;j+=7){if(j>=64)throw new Error("protobuf: varint overflow");if(o>=_.length)throw new Error("protobuf: unexpected end of data");const et=_[o++];if($+=j<28?(et&127)<<j:(et&127)*2**j,et<128)break}return[$,o]}function decodeBytes(_,o){let $;[$,o]=decodeVarint$1(_,o);const j=o+$;if($<0||j<0)throw new Error("protobuf: invalid length");if(j>_.length)throw new Error("protobuf: unexpected end of data");return[_.subarray(o,j),j]}function decodeKey(_,o){let $;return[$,o]=decodeVarint$1(_,o),[$&7,$>>3,o]}function decodeLink(_){const o={},$=_.length;let j=0;for(;j<$;){let et,tt;if([et,tt,j]=decodeKey(_,j),tt===1){if(o.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(et!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${et}) for Hash`);if(o.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(o.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[o.Hash,j]=decodeBytes(_,j)}else if(tt===2){if(o.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(et!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${et}) for Name`);if(o.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let rt;[rt,j]=decodeBytes(_,j),o.Name=textDecoder$3.decode(rt)}else if(tt===3){if(o.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(et!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${et}) for Tsize`);[o.Tsize,j]=decodeVarint$1(_,j)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${tt}`)}if(j>$)throw new Error("protobuf: (PBLink) unexpected end of data");return o}function decodeNode(_){const o=_.length;let $=0,j,et=!1,tt;for(;$<o;){let nt,it;if([nt,it,$]=decodeKey(_,$),nt!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${nt}`);if(it===1){if(tt)throw new Error("protobuf: (PBNode) duplicate Data section");[tt,$]=decodeBytes(_,$),j&&(et=!0)}else if(it===2){if(et)throw new Error("protobuf: (PBNode) duplicate Links section");j||(j=[]);let st;[st,$]=decodeBytes(_,$),j.push(decodeLink(st))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${it}`)}if($>o)throw new Error("protobuf: (PBNode) unexpected end of data");const rt={};return tt&&(rt.Data=tt),rt.Links=j||[],rt}const textEncoder$5=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(_,o){let $=o.length;if(typeof _.Tsize=="number"){if(_.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(_.Tsize))throw new Error("Tsize too large for encoding");$=encodeVarint(o,$,_.Tsize)-1,o[$]=24}if(typeof _.Name=="string"){const j=textEncoder$5.encode(_.Name);$-=j.length,o.set(j,$),$=encodeVarint(o,$,j.length)-1,o[$]=18}return _.Hash&&($-=_.Hash.length,o.set(_.Hash,$),$=encodeVarint(o,$,_.Hash.length)-1,o[$]=10),o.length-$}function encodeNode(_){const o=sizeNode(_),$=new Uint8Array(o);let j=o;if(_.Data&&(j-=_.Data.length,$.set(_.Data,j),j=encodeVarint($,j,_.Data.length)-1,$[j]=10),_.Links)for(let et=_.Links.length-1;et>=0;et--){const tt=encodeLink(_.Links[et],$.subarray(0,j));j-=tt,j=encodeVarint($,j,tt)-1,$[j]=18}return $}function sizeLink(_){let o=0;if(_.Hash){const $=_.Hash.length;o+=1+$+sov($)}if(typeof _.Name=="string"){const $=textEncoder$5.encode(_.Name).length;o+=1+$+sov($)}return typeof _.Tsize=="number"&&(o+=1+sov(_.Tsize)),o}function sizeNode(_){let o=0;if(_.Data){const $=_.Data.length;o+=1+$+sov($)}if(_.Links)for(const $ of _.Links){const j=sizeLink($);o+=1+j+sov(j)}return o}function encodeVarint(_,o,$){o-=sov($);const j=o;for(;$>=maxUInt32;)_[o++]=$&127|128,$/=128;for(;$>=128;)_[o++]=$&127|128,$>>>=7;return _[o]=$,j}function sov(_){return _%2===0&&_++,Math.floor((len64(_)+6)/7)}function len64(_){let o=0;return _>=maxInt32&&(_=Math.floor(_/maxInt32),o=32),_>=1<<16&&(_>>>=16,o+=16),_>=1<<8&&(_>>>=8,o+=8),o+len8tab[_]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$4=new TextEncoder;function linkComparator(_,o){if(_===o)return 0;const $=_.Name?textEncoder$4.encode(_.Name):[],j=o.Name?textEncoder$4.encode(o.Name):[];let et=$.length,tt=j.length;for(let rt=0,nt=Math.min(et,tt);rt<nt;++rt)if($[rt]!==j[rt]){et=$[rt],tt=j[rt];break}return et<tt?-1:tt<et?1:0}function hasOnlyProperties(_,o){return!Object.keys(_).some($=>!o.includes($))}function asLink(_){if(typeof _.asCID=="object"){const $=CID$3.asCID(_);if(!$)throw new TypeError("Invalid DAG-PB form");return{Hash:$}}if(typeof _!="object"||Array.isArray(_))throw new TypeError("Invalid DAG-PB form");const o={};if(_.Hash){let $=CID$3.asCID(_.Hash);try{$||(typeof _.Hash=="string"?$=CID$3.parse(_.Hash):_.Hash instanceof Uint8Array&&($=CID$3.decode(_.Hash)))}catch(j){throw new TypeError(`Invalid DAG-PB form: ${j.message}`)}$&&(o.Hash=$)}if(!o.Hash)throw new TypeError("Invalid DAG-PB form");return typeof _.Name=="string"&&(o.Name=_.Name),typeof _.Tsize=="number"&&(o.Tsize=_.Tsize),o}function prepare$1(_){if((_ instanceof Uint8Array||typeof _=="string")&&(_={Data:_}),typeof _!="object"||Array.isArray(_))throw new TypeError("Invalid DAG-PB form");const o={};if(_.Data!==void 0)if(typeof _.Data=="string")o.Data=textEncoder$4.encode(_.Data);else if(_.Data instanceof Uint8Array)o.Data=_.Data;else throw new TypeError("Invalid DAG-PB form");if(_.Links!==void 0)if(Array.isArray(_.Links))o.Links=_.Links.map(asLink),o.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else o.Links=[];return o}function validate$1(_){if(!_||typeof _!="object"||Array.isArray(_)||_ instanceof Uint8Array||_["/"]&&_["/"]===_.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(_,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(_.Data!==void 0&&!(_.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(_.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let o=0;o<_.Links.length;o++){const $=_.Links[o];if(!$||typeof $!="object"||Array.isArray($)||$ instanceof Uint8Array||$["/"]&&$["/"]===$.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties($,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if($.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if($.Hash==null||!$.Hash["/"]||$.Hash["/"]!==$.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if($.Name!==void 0&&typeof $.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if($.Tsize!==void 0){if(typeof $.Tsize!="number"||$.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if($.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(o>0&&linkComparator($,_.Links[o-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode$2(_,o=[]){return prepare$1({Data:_,Links:o})}function createLink(_,o,$){return asLink({Hash:$,Name:_,Tsize:o})}const name$b="dag-pb",code$9=112;function encode$B(_){validate$1(_);const o={};return _.Links&&(o.Links=_.Links.map($=>{const j={};return $.Hash&&(j.Hash=$.Hash.bytes),$.Name!==void 0&&(j.Name=$.Name),$.Tsize!==void 0&&(j.Tsize=$.Tsize),j})),_.Data&&(o.Data=_.Data),encodeNode(o)}function decode$y(_){const o=decodeNode(_),$={};return o.Data&&($.Data=o.Data),o.Links&&($.Links=o.Links.map(j=>{const et={};try{et.Hash=CID$3.decode(j.Hash)}catch{}if(!et.Hash)throw new Error("Invalid Hash field found in link, expected CID");return j.Name!==void 0&&(et.Name=j.Name),j.Tsize!==void 0&&(et.Tsize=j.Tsize),et})),$}const dagPB=Object.freeze(Object.defineProperty({__proto__:null,code:code$9,createLink,createNode:createNode$2,decode:decode$y,encode:encode$B,name:name$b,prepare:prepare$1,validate:validate$1},Symbol.toStringTag,{value:"Module"})),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is$1(_){if(_===null)return"null";if(_===void 0)return"undefined";if(_===!0||_===!1)return"boolean";const o=typeof _;if(typeofs.includes(o))return o;if(o==="function")return"Function";if(Array.isArray(_))return"Array";if(isBuffer$1(_))return"Buffer";const $=getObjectType(_);return $||"Object"}function isBuffer$1(_){return _&&_.constructor&&_.constructor.isBuffer&&_.constructor.isBuffer.call(null,_)}function getObjectType(_){const o=Object.prototype.toString.call(_).slice(8,-1);if(objectTypeNames.includes(o))return o}class Type{constructor(o,$,j){this.major=o,this.majorEncoded=o<<5,this.name=$,this.terminal=j}toString(){return`Type[${this.major}].${this.name}`}compare(o){return this.major<o.major?-1:this.major>o.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(o,$,j){this.type=o,this.value=$,this.encodedLength=j,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$2=new TextDecoder,textEncoder$3=new TextEncoder;function isBuffer(_){return useBuffer&&globalThis.Buffer.isBuffer(_)}function asU8A(_){return _ instanceof Uint8Array?isBuffer(_)?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_:Uint8Array.from(_)}const toString$b=useBuffer?(_,o,$)=>$-o>64?globalThis.Buffer.from(_.subarray(o,$)).toString("utf8"):utf8Slice(_,o,$):(_,o,$)=>$-o>64?textDecoder$2.decode(_.subarray(o,$)):utf8Slice(_,o,$),fromString$9=useBuffer?_=>_.length>64?globalThis.Buffer.from(_):utf8ToBytes(_):_=>_.length>64?textEncoder$3.encode(_):utf8ToBytes(_),fromArray=_=>Uint8Array.from(_),slice$1=useBuffer?(_,o,$)=>isBuffer(_)?new Uint8Array(_.subarray(o,$)):_.slice(o,$):(_,o,$)=>_.slice(o,$),concat$3=useBuffer?(_,o)=>(_=_.map($=>$ instanceof Uint8Array?$:globalThis.Buffer.from($)),asU8A(globalThis.Buffer.concat(_,o))):(_,o)=>{const $=new Uint8Array(o);let j=0;for(let et of _)j+et.length>$.length&&(et=et.subarray(0,$.length-j)),$.set(et,j),j+=et.length;return $},alloc$1=useBuffer?_=>globalThis.Buffer.allocUnsafe(_):_=>new Uint8Array(_);function compare$3(_,o){if(isBuffer(_)&&isBuffer(o))return _.compare(o);for(let $=0;$<_.length;$++)if(_[$]!==o[$])return _[$]<o[$]?-1:1;return 0}function utf8ToBytes(_,o=1/0){let $;const j=_.length;let et=null;const tt=[];for(let rt=0;rt<j;++rt){if($=_.charCodeAt(rt),$>55295&&$<57344){if(!et){if($>56319){(o-=3)>-1&&tt.push(239,191,189);continue}else if(rt+1===j){(o-=3)>-1&&tt.push(239,191,189);continue}et=$;continue}if($<56320){(o-=3)>-1&&tt.push(239,191,189),et=$;continue}$=(et-55296<<10|$-56320)+65536}else et&&(o-=3)>-1&&tt.push(239,191,189);if(et=null,$<128){if((o-=1)<0)break;tt.push($)}else if($<2048){if((o-=2)<0)break;tt.push($>>6|192,$&63|128)}else if($<65536){if((o-=3)<0)break;tt.push($>>12|224,$>>6&63|128,$&63|128)}else if($<1114112){if((o-=4)<0)break;tt.push($>>18|240,$>>12&63|128,$>>6&63|128,$&63|128)}else throw new Error("Invalid code point")}return tt}function utf8Slice(_,o,$){const j=[];for(;o<$;){const et=_[o];let tt=null,rt=et>239?4:et>223?3:et>191?2:1;if(o+rt<=$){let nt,it,st,ot;switch(rt){case 1:et<128&&(tt=et);break;case 2:nt=_[o+1],(nt&192)===128&&(ot=(et&31)<<6|nt&63,ot>127&&(tt=ot));break;case 3:nt=_[o+1],it=_[o+2],(nt&192)===128&&(it&192)===128&&(ot=(et&15)<<12|(nt&63)<<6|it&63,ot>2047&&(ot<55296||ot>57343)&&(tt=ot));break;case 4:nt=_[o+1],it=_[o+2],st=_[o+3],(nt&192)===128&&(it&192)===128&&(st&192)===128&&(ot=(et&15)<<18|(nt&63)<<12|(it&63)<<6|st&63,ot>65535&&ot<1114112&&(tt=ot))}}tt===null?(tt=65533,rt=1):tt>65535&&(tt-=65536,j.push(tt>>>10&1023|55296),tt=56320|tt&1023),j.push(tt),o+=rt}return decodeCodePointsArray(j)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(_){const o=_.length;if(o<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,_);let $="",j=0;for(;j<o;)$+=String.fromCharCode.apply(String,_.slice(j,j+=MAX_ARGUMENTS_LENGTH));return $}const defaultChunkSize=256;class Bl{constructor(o=defaultChunkSize){this.chunkSize=o,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(o){let $=this.chunks[this.chunks.length-1];if(this.cursor+o.length<=this.maxCursor+1){const et=$.length-(this.maxCursor-this.cursor)-1;$.set(o,et)}else{if($){const et=$.length-(this.maxCursor-this.cursor)-1;et<$.length&&(this.chunks[this.chunks.length-1]=$.subarray(0,et),this.maxCursor=this.cursor-1)}o.length<64&&o.length<this.chunkSize?($=alloc$1(this.chunkSize),this.chunks.push($),this.maxCursor+=$.length,this._initReuseChunk===null&&(this._initReuseChunk=$),$.set(o,0)):(this.chunks.push(o),this.maxCursor+=o.length)}this.cursor+=o.length}toBytes(o=!1){let $;if(this.chunks.length===1){const j=this.chunks[0];o&&this.cursor>j.length/2?($=this.cursor===j.length?j:j.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):$=slice$1(j,0,this.cursor)}else $=concat$3(this.chunks,this.cursor);return o&&this.reset(),$}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(_,o,$){if(_.length-o<$)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(_,o,$){assertEnoughData(_,o,1);const j=_[o];if($.strict===!0&&j<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return j}function readUint16(_,o,$){assertEnoughData(_,o,2);const j=_[o]<<8|_[o+1];if($.strict===!0&&j<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return j}function readUint32(_,o,$){assertEnoughData(_,o,4);const j=_[o]*16777216+(_[o+1]<<16)+(_[o+2]<<8)+_[o+3];if($.strict===!0&&j<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return j}function readUint64(_,o,$){assertEnoughData(_,o,8);const j=_[o]*16777216+(_[o+1]<<16)+(_[o+2]<<8)+_[o+3],et=_[o+4]*16777216+(_[o+5]<<16)+(_[o+6]<<8)+_[o+7],tt=(BigInt(j)<<BigInt(32))+BigInt(et);if($.strict===!0&&tt<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(tt<=Number.MAX_SAFE_INTEGER)return Number(tt);if($.allowBigInt===!0)return tt;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(_,o,$,j){return new Token(Type.uint,readUint8(_,o+1,j),2)}function decodeUint16(_,o,$,j){return new Token(Type.uint,readUint16(_,o+1,j),3)}function decodeUint32(_,o,$,j){return new Token(Type.uint,readUint32(_,o+1,j),5)}function decodeUint64(_,o,$,j){return new Token(Type.uint,readUint64(_,o+1,j),9)}function encodeUint(_,o){return encodeUintValue(_,0,o.value)}function encodeUintValue(_,o,$){if($<uintBoundaries[0]){const j=Number($);_.push([o|j])}else if($<uintBoundaries[1]){const j=Number($);_.push([o|24,j])}else if($<uintBoundaries[2]){const j=Number($);_.push([o|25,j>>>8,j&255])}else if($<uintBoundaries[3]){const j=Number($);_.push([o|26,j>>>24&255,j>>>16&255,j>>>8&255,j&255])}else{const j=BigInt($);if(j<uintBoundaries[4]){const et=[o|27,0,0,0,0,0,0,0];let tt=Number(j&BigInt(4294967295)),rt=Number(j>>BigInt(32)&BigInt(4294967295));et[8]=tt&255,tt=tt>>8,et[7]=tt&255,tt=tt>>8,et[6]=tt&255,tt=tt>>8,et[5]=tt&255,et[4]=rt&255,rt=rt>>8,et[3]=rt&255,rt=rt>>8,et[2]=rt&255,rt=rt>>8,et[1]=rt&255,_.push(et)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function(o){return encodeUintValue.encodedSize(o.value)};encodeUintValue.encodedSize=function(o){return o<uintBoundaries[0]?1:o<uintBoundaries[1]?2:o<uintBoundaries[2]?3:o<uintBoundaries[3]?5:9};encodeUint.compareTokens=function(o,$){return o.value<$.value?-1:o.value>$.value?1:0};function decodeNegint8(_,o,$,j){return new Token(Type.negint,-1-readUint8(_,o+1,j),2)}function decodeNegint16(_,o,$,j){return new Token(Type.negint,-1-readUint16(_,o+1,j),3)}function decodeNegint32(_,o,$,j){return new Token(Type.negint,-1-readUint32(_,o+1,j),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(_,o,$,j){const et=readUint64(_,o+1,j);if(typeof et!="bigint"){const tt=-1-et;if(tt>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,tt,9)}if(j.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(et),9)}function encodeNegint(_,o){const $=o.value,j=typeof $=="bigint"?$*neg1b-pos1b:$*-1-1;encodeUintValue(_,o.type.majorEncoded,j)}encodeNegint.encodedSize=function(o){const $=o.value,j=typeof $=="bigint"?$*neg1b-pos1b:$*-1-1;return j<uintBoundaries[0]?1:j<uintBoundaries[1]?2:j<uintBoundaries[2]?3:j<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function(o,$){return o.value<$.value?1:o.value>$.value?-1:0};function toToken$3(_,o,$,j){assertEnoughData(_,o,$+j);const et=slice$1(_,o+$,o+$+j);return new Token(Type.bytes,et,$+j)}function decodeBytesCompact(_,o,$,j){return toToken$3(_,o,1,$)}function decodeBytes8(_,o,$,j){return toToken$3(_,o,2,readUint8(_,o+1,j))}function decodeBytes16(_,o,$,j){return toToken$3(_,o,3,readUint16(_,o+1,j))}function decodeBytes32(_,o,$,j){return toToken$3(_,o,5,readUint32(_,o+1,j))}function decodeBytes64(_,o,$,j){const et=readUint64(_,o+1,j);if(typeof et=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(_,o,9,et)}function tokenBytes(_){return _.encodedBytes===void 0&&(_.encodedBytes=_.type===Type.string?fromString$9(_.value):_.value),_.encodedBytes}function encodeBytes(_,o){const $=tokenBytes(o);encodeUintValue(_,o.type.majorEncoded,$.length),_.push($)}encodeBytes.encodedSize=function(o){const $=tokenBytes(o);return encodeUintValue.encodedSize($.length)+$.length};encodeBytes.compareTokens=function(o,$){return compareBytes(tokenBytes(o),tokenBytes($))};function compareBytes(_,o){return _.length<o.length?-1:_.length>o.length?1:compare$3(_,o)}function toToken$2(_,o,$,j,et){const tt=$+j;assertEnoughData(_,o,tt);const rt=new Token(Type.string,toString$b(_,o+$,o+tt),tt);return et.retainStringBytes===!0&&(rt.byteValue=slice$1(_,o+$,o+tt)),rt}function decodeStringCompact(_,o,$,j){return toToken$2(_,o,1,$,j)}function decodeString8(_,o,$,j){return toToken$2(_,o,2,readUint8(_,o+1,j),j)}function decodeString16(_,o,$,j){return toToken$2(_,o,3,readUint16(_,o+1,j),j)}function decodeString32(_,o,$,j){return toToken$2(_,o,5,readUint32(_,o+1,j),j)}function decodeString64(_,o,$,j){const et=readUint64(_,o+1,j);if(typeof et=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(_,o,9,et,j)}const encodeString=encodeBytes;function toToken$1(_,o,$,j){return new Token(Type.array,j,$)}function decodeArrayCompact(_,o,$,j){return toToken$1(_,o,1,$)}function decodeArray8(_,o,$,j){return toToken$1(_,o,2,readUint8(_,o+1,j))}function decodeArray16(_,o,$,j){return toToken$1(_,o,3,readUint16(_,o+1,j))}function decodeArray32(_,o,$,j){return toToken$1(_,o,5,readUint32(_,o+1,j))}function decodeArray64(_,o,$,j){const et=readUint64(_,o+1,j);if(typeof et=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(_,o,9,et)}function decodeArrayIndefinite(_,o,$,j){if(j.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(_,o,1,1/0)}function encodeArray(_,o){encodeUintValue(_,Type.array.majorEncoded,o.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function(o){return encodeUintValue.encodedSize(o.value)};function toToken(_,o,$,j){return new Token(Type.map,j,$)}function decodeMapCompact(_,o,$,j){return toToken(_,o,1,$)}function decodeMap8(_,o,$,j){return toToken(_,o,2,readUint8(_,o+1,j))}function decodeMap16(_,o,$,j){return toToken(_,o,3,readUint16(_,o+1,j))}function decodeMap32(_,o,$,j){return toToken(_,o,5,readUint32(_,o+1,j))}function decodeMap64(_,o,$,j){const et=readUint64(_,o+1,j);if(typeof et=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(_,o,9,et)}function decodeMapIndefinite(_,o,$,j){if(j.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(_,o,1,1/0)}function encodeMap(_,o){encodeUintValue(_,Type.map.majorEncoded,o.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function(o){return encodeUintValue.encodedSize(o.value)};function decodeTagCompact(_,o,$,j){return new Token(Type.tag,$,1)}function decodeTag8(_,o,$,j){return new Token(Type.tag,readUint8(_,o+1,j),2)}function decodeTag16(_,o,$,j){return new Token(Type.tag,readUint16(_,o+1,j),3)}function decodeTag32(_,o,$,j){return new Token(Type.tag,readUint32(_,o+1,j),5)}function decodeTag64(_,o,$,j){return new Token(Type.tag,readUint64(_,o+1,j),9)}function encodeTag(_,o){encodeUintValue(_,Type.tag.majorEncoded,o.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function(o){return encodeUintValue.encodedSize(o.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(_,o,$,j){if(j.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return j.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(_,o,$,j){if(j.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(_,o,$){if($){if($.allowNaN===!1&&Number.isNaN(_))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if($.allowInfinity===!1&&(_===1/0||_===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,_,o)}function decodeFloat16(_,o,$,j){return createToken(readFloat16(_,o+1),3,j)}function decodeFloat32(_,o,$,j){return createToken(readFloat32(_,o+1),5,j)}function decodeFloat64(_,o,$,j){return createToken(readFloat64(_,o+1),9,j)}function encodeFloat(_,o,$){const j=o.value;if(j===!1)_.push([Type.float.majorEncoded|MINOR_FALSE]);else if(j===!0)_.push([Type.float.majorEncoded|MINOR_TRUE]);else if(j===null)_.push([Type.float.majorEncoded|MINOR_NULL]);else if(j===void 0)_.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let et,tt=!1;(!$||$.float64!==!0)&&(encodeFloat16(j),et=readFloat16(ui8a,1),j===et||Number.isNaN(j)?(ui8a[0]=249,_.push(ui8a.slice(0,3)),tt=!0):(encodeFloat32(j),et=readFloat32(ui8a,1),j===et&&(ui8a[0]=250,_.push(ui8a.slice(0,5)),tt=!0))),tt||(encodeFloat64(j),et=readFloat64(ui8a,1),ui8a[0]=251,_.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(o,$){const j=o.value;if(j===!1||j===!0||j===null||j===void 0)return 1;if(!$||$.float64!==!0){encodeFloat16(j);let et=readFloat16(ui8a,1);if(j===et||Number.isNaN(j))return 3;if(encodeFloat32(j),et=readFloat32(ui8a,1),j===et)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(_){if(_===1/0)dataView.setUint16(0,31744,!1);else if(_===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(_))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,_);const o=dataView.getUint32(0),$=(o&2139095040)>>23,j=o&8388607;if($===255)dataView.setUint16(0,31744,!1);else if($===0)dataView.setUint16(0,(_&2147483648)>>16|j>>13,!1);else{const et=$-127;et<-24?dataView.setUint16(0,0):et<-14?dataView.setUint16(0,(o&2147483648)>>16|1<<24+et,!1):dataView.setUint16(0,(o&2147483648)>>16|et+15<<10|j>>13,!1)}}}function readFloat16(_,o){if(_.length-o<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const $=(_[o]<<8)+_[o+1];if($===31744)return 1/0;if($===64512)return-1/0;if($===32256)return NaN;const j=$>>10&31,et=$&1023;let tt;return j===0?tt=et*2**-24:j!==31?tt=(et+1024)*2**(j-25):tt=et===0?1/0:NaN,$&32768?-tt:tt}function encodeFloat32(_){dataView.setFloat32(0,_,!1)}function readFloat32(_,o){if(_.length-o<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const $=(_.byteOffset||0)+o;return new DataView(_.buffer,$,4).getFloat32(0,!1)}function encodeFloat64(_){dataView.setFloat64(0,_,!1)}function readFloat64(_,o){if(_.length-o<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const $=(_.byteOffset||0)+o;return new DataView(_.buffer,$,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(_,o,$){throw new Error(`${decodeErrPrefix} encountered invalid minor (${$}) for major ${_[o]>>>5}`)}function errorer(_){return()=>{throw new Error(`${decodeErrPrefix} ${_}`)}}const jump=[];for(let _=0;_<=23;_++)jump[_]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let _=32;_<=55;_++)jump[_]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let _=64;_<=87;_++)jump[_]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let _=96;_<=119;_++)jump[_]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let _=128;_<=151;_++)jump[_]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let _=160;_<=183;_++)jump[_]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let _=192;_<=215;_++)jump[_]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let _=224;_<=243;_++)jump[_]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let _=0;_<24;_++)quick[_]=new Token(Type.uint,_,1);for(let _=-1;_>=-24;_--)quick[31-_]=new Token(Type.negint,_,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(_){switch(_.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return _.value.length?void 0:fromArray([64]);case Type.string:return _.value===""?fromArray([96]):void 0;case Type.array:return _.value===0?fromArray([128]):void 0;case Type.map:return _.value===0?fromArray([160]):void 0;case Type.uint:return _.value<24?fromArray([Number(_.value)]):void 0;case Type.negint:if(_.value>=-24)return fromArray([31-Number(_.value)])}}const defaultEncodeOptions$1={float64:!1,mapSorter:mapSorter$1,quickEncodeToken};function makeCborEncoders(){const _=[];return _[Type.uint.major]=encodeUint,_[Type.negint.major]=encodeNegint,_[Type.bytes.major]=encodeBytes,_[Type.string.major]=encodeString,_[Type.array.major]=encodeArray,_[Type.map.major]=encodeMap,_[Type.tag.major]=encodeTag,_[Type.float.major]=encodeFloat,_}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(o,$){this.obj=o,this.parent=$}includes(o){let $=this;do if($.obj===o)return!0;while($=$.parent);return!1}static createCheck(o,$){if(o&&o.includes($))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref($,o)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(_,o,$,j){return!Number.isInteger(_)||!Number.isSafeInteger(_)?new Token(Type.float,_):_>=0?new Token(Type.uint,_):new Token(Type.negint,_)},bigint(_,o,$,j){return _>=BigInt(0)?new Token(Type.uint,_):new Token(Type.negint,_)},Uint8Array(_,o,$,j){return new Token(Type.bytes,_)},string(_,o,$,j){return new Token(Type.string,_)},boolean(_,o,$,j){return _?simpleTokens.true:simpleTokens.false},null(_,o,$,j){return simpleTokens.null},undefined(_,o,$,j){return simpleTokens.undefined},ArrayBuffer(_,o,$,j){return new Token(Type.bytes,new Uint8Array(_))},DataView(_,o,$,j){return new Token(Type.bytes,new Uint8Array(_.buffer,_.byteOffset,_.byteLength))},Array(_,o,$,j){if(!_.length)return $.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;j=Ref.createCheck(j,_);const et=[];let tt=0;for(const rt of _)et[tt++]=objectToTokens(rt,$,j);return $.addBreakTokens?[new Token(Type.array,_.length),et,new Token(Type.break)]:[new Token(Type.array,_.length),et]},Object(_,o,$,j){const et=o!=="Object",tt=et?_.keys():Object.keys(_),rt=et?_.size:tt.length;if(!rt)return $.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;j=Ref.createCheck(j,_);const nt=[];let it=0;for(const st of tt)nt[it++]=[objectToTokens(st,$,j),objectToTokens(et?_.get(st):_[st],$,j)];return sortMapEntries(nt,$),$.addBreakTokens?[new Token(Type.map,rt),nt,new Token(Type.break)]:[new Token(Type.map,rt),nt]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const _ of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${_}Array`]=typeEncoders.DataView;function objectToTokens(_,o={},$){const j=is$1(_),et=o&&o.typeEncoders&&o.typeEncoders[j]||typeEncoders[j];if(typeof et=="function"){const rt=et(_,j,o,$);if(rt!=null)return rt}const tt=typeEncoders[j];if(!tt)throw new Error(`${encodeErrPrefix} unsupported type: ${j}`);return tt(_,j,o,$)}function sortMapEntries(_,o){o.mapSorter&&_.sort(o.mapSorter)}function mapSorter$1(_,o){const $=Array.isArray(_[0])?_[0][0]:_[0],j=Array.isArray(o[0])?o[0][0]:o[0];if($.type!==j.type)return $.type.compare(j.type);const et=$.type.major,tt=cborEncoders[et].compareTokens($,j);return tt===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),tt}function tokensToEncoded(_,o,$,j){if(Array.isArray(o))for(const et of o)tokensToEncoded(_,et,$,j);else $[o.type.major](_,o,j)}function encodeCustom(_,o,$){const j=objectToTokens(_,$);if(!Array.isArray(j)&&$.quickEncodeToken){const et=$.quickEncodeToken(j);if(et)return et;const tt=o[j.type.major];if(tt.encodedSize){const rt=tt.encodedSize(j,$),nt=new Bl(rt);if(tt(nt,j,$),nt.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${j} was wrong`);return asU8A(nt.chunks[0])}}return buf.reset(),tokensToEncoded(buf,j,o,$),buf.toBytes(!0)}function encode$A(_,o){return o=Object.assign({},defaultEncodeOptions$1,o),encodeCustom(_,cborEncoders,o)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(o,$={}){this.pos=0,this.data=o,this.options=$}done(){return this.pos>=this.data.length}next(){const o=this.data[this.pos];let $=quick[o];if($===void 0){const j=jump[o];if(!j)throw new Error(`${decodeErrPrefix} no decoder for major type ${o>>>5} (byte 0x${o.toString(16).padStart(2,"0")})`);const et=o&31;$=j(this.data,this.pos,et,this.options)}return this.pos+=$.encodedLength,$}}const DONE$1=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(_,o,$){const j=[];for(let et=0;et<_.value;et++){const tt=tokensToObject(o,$);if(tt===BREAK){if(_.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(tt===DONE$1)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${et}, expected ${_.value})`);j[et]=tt}return j}function tokenToMap(_,o,$){const j=$.useMaps===!0,et=j?void 0:{},tt=j?new Map:void 0;for(let rt=0;rt<_.value;rt++){const nt=tokensToObject(o,$);if(nt===BREAK){if(_.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(nt===DONE$1)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${rt} [no key], expected ${_.value})`);if(j!==!0&&typeof nt!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof nt})`);if($.rejectDuplicateMapKeys===!0&&(j&&tt.has(nt)||!j&&nt in et))throw new Error(`${decodeErrPrefix} found repeat map key "${nt}"`);const it=tokensToObject(o,$);if(it===DONE$1)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${rt} [no value], expected ${_.value})`);j?tt.set(nt,it):et[nt]=it}return j?tt:et}function tokensToObject(_,o){if(_.done())return DONE$1;const $=_.next();if($.type===Type.break)return BREAK;if($.type.terminal)return $.value;if($.type===Type.array)return tokenToArray($,_,o);if($.type===Type.map)return tokenToMap($,_,o);if($.type===Type.tag){if(o.tags&&typeof o.tags[$.value]=="function"){const j=tokensToObject(_,o);return o.tags[$.value](j)}throw new Error(`${decodeErrPrefix} tag not supported (${$.value})`)}throw new Error("unsupported")}function decode$x(_,o){if(!(_ instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);o=Object.assign({},defaultDecodeOptions,o);const $=o.tokenizer||new Tokeniser(_,o),j=tokensToObject($,o);if(j===DONE$1)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(j===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);if(!$.done())throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return j}const CID_CBOR_TAG$2=42;function cidEncoder$3(_){if(_.asCID!==_&&_["/"]!==_.bytes)return null;const o=CID$3.asCID(_);if(!o)return null;const $=new Uint8Array(o.bytes.byteLength+1);return $.set(o.bytes,1),[new Token(Type.tag,CID_CBOR_TAG$2),new Token(Type.bytes,$)]}function undefinedEncoder$3(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$3(_){if(Number.isNaN(_))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(_===1/0||_===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions$3={float64:!0,typeEncoders:{Object:cidEncoder$3,undefined:undefinedEncoder$3,number:numberEncoder$3}};function cidDecoder$2(_){if(_[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$3.decode(_.subarray(1))}const decodeOptions$3={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions$3.tags[CID_CBOR_TAG$2]=cidDecoder$2;const name$a="dag-cbor",code$8=113,encode$z=_=>encode$A(_,encodeOptions$3),decode$w=_=>decode$x(_,decodeOptions$3),dagCBOR$1=Object.freeze(Object.defineProperty({__proto__:null,code:code$8,decode:decode$w,encode:encode$z,name:name$a},Symbol.toStringTag,{value:"Module"})),sha$4=_=>async o=>new Uint8Array(await crypto.subtle.digest(_,o)),sha256$8=from$7({name:"sha2-256",code:18,encode:sha$4("SHA-256")}),sha512$4=from$7({name:"sha2-512",code:19,encode:sha$4("SHA-512")}),sha2=Object.freeze(Object.defineProperty({__proto__:null,sha256:sha256$8,sha512:sha512$4},Symbol.toStringTag,{value:"Module"})),mhtype="sha2-256",defaultBase$2=base58btc$4,unsupportedCodecError=()=>new Error("unsupported codec"),cidifyString=_=>_&&(Array.isArray(_)?_.map(cidifyString):CID$3.parse(_)),stringifyCid=(_,o={})=>{if(!_||typeof _=="string")return _;if(Array.isArray(_))return _.map(stringifyCid);const $=o.base||defaultBase$2;return _.toString($)},codecCodes={[code$9]:dagPB,[code$8]:dagCBOR$1},codecMap={raw:dagCBOR$1,"dag-pb":dagPB,"dag-cbor":dagCBOR$1};async function read$7(_,o,$={}){o=cidifyString(stringifyCid(o));const j=codecCodes[o.code];if(!j)throw unsupportedCodecError();const et=await _.block.get(o,{timeout:$.timeout}),tt=await decode$z({bytes:et,codec:j,hasher:sha256$8});if(tt.cid.code===code$9)return JSON.parse(new TextDecoder().decode(tt.value.Data));if(tt.cid.code===code$8){const rt=tt.value;return($.links||[]).forEach(it=>{rt[it]&&(rt[it]=stringifyCid(rt[it],$))}),rt}}async function write$3(_,o,$,j={}){j.format==="dag-pb"&&(o=j.format);const et=codecMap[o];if(!et)throw unsupportedCodecError();et.code===code$9&&($=typeof $=="string"?$:JSON.stringify($),$={Data:new TextEncoder().encode($),Links:[]}),et.code===code$8&&(j.links||[]).forEach(it=>{$[it]&&($[it]=cidifyString($[it]))});const tt=await encode$C({value:$,codec:et,hasher:sha256$8});return await _.block.put(tt.bytes,{cid:tt.cid.bytes,version:tt.cid.version,format:o,mhtype,pin:j.pin,timeout:j.timeout}),(et.code===code$9?tt.cid.toV0():tt.cid).toString(j.base||defaultBase$2)}function difference$1(_,o,$){const j={},et={},tt=nt=>et[$?nt[$]:nt]=!0;_.forEach(tt);const rt=(nt,it)=>{const st=et[$?it[$]:it]!==void 0,ot=j[$?it[$]:it]!==void 0;return!st&&!ot&&(nt.push(it),j[$?it[$]:it]=!0),nt};return o.reduce(rt,[])}function findUniques(_,o){const $={},j=tt=>$[tt],et=tt=>$[o?tt[o]:tt]=tt;return _.forEach(et),Object.keys($).map(j)}const isDefined$2=_=>_!=null;var defaults$1={space:"",cycles:!1,replacer:(_,o)=>o,stringify:JSON.stringify},util$a={isArray:Array.isArray,assign:Object.assign,isObject:_=>typeof _=="object",isFunction:_=>typeof _=="function",isBoolean:_=>typeof _=="boolean",isRegex:_=>_ instanceof RegExp,keys:Object.keys};const DEFAULTS=defaults$1,isFunction=util$a.isFunction,isBoolean=util$a.isBoolean,isObject=util$a.isObject,isArray=util$a.isArray,isRegex=util$a.isRegex,assign$2=util$a.assign,keys=util$a.keys;function serialize$1(_){return _==null?_:isRegex(_)?_.toString():_.toJSON?_.toJSON():_}function stringifyDeterministic(_,o){o=o||assign$2({},DEFAULTS),isFunction(o)&&(o={compare:o});const $=o.space||DEFAULTS.space,j=isBoolean(o.cycles)?o.cycles:DEFAULTS.cycles,et=o.replacer||DEFAULTS.replacer,tt=o.stringify||DEFAULTS.stringify,rt=o.compare&&function(it){return function(st){return function(ot,at){const ct={key:ot,value:st[ot]},ut={key:at,value:st[at]};return it(ct,ut)}}}(o.compare);j||tt(_);const nt=[];return function it(st,ot,at,ct){const ut=$?`
`+new Array(ct+1).join($):"",ft=$?": ":":";if(at=serialize$1(at),at=et.call(st,ot,at),at!==void 0){if(!isObject(at)||at===null)return tt(at);if(isArray(at)){const ht=[];for(let mt=0;mt<at.length;mt++){const gt=it(at,mt,at[mt],ct+1)||tt(null);ht.push(ut+$+gt)}return"["+ht.join(",")+ut+"]"}else{if(j){if(nt.indexOf(at)!==-1)return tt("[Circular]");nt.push(at)}const ht=keys(at).sort(rt&&rt(at)),mt=[];for(let gt=0;gt<ht.length;gt++){const Et=ht[gt],St=it(at,Et,at[Et],ct+1);if(!St)continue;const At=tt(Et)+ft+St;mt.push(ut+$+At)}return nt.splice(nt.indexOf(at),1),"{"+mt.join(",")+ut+"}"}}}({"":_},"",_,0)}var lib$1=stringifyDeterministic;const IpfsNotDefinedError=()=>new Error("Ipfs instance not defined"),IPLD_LINKS$1=["next","refs"],getWriteFormatForVersion=_=>_===0?"dag-pb":"dag-cbor",getWriteFormat=_=>Entry.isEntry(_)?getWriteFormatForVersion(_.v):getWriteFormatForVersion(_);class Entry{static async create(o,$,j,et,tt=[],rt,nt=[],it){if(!isDefined$2(o))throw IpfsNotDefinedError();if(!isDefined$2($))throw new Error("Identity is required, cannot create entry");if(!isDefined$2(j))throw new Error("Entry requires an id");if(!isDefined$2(et))throw new Error("Entry requires data");if(!isDefined$2(tt)||!Array.isArray(tt))throw new Error("'next' argument is not an array");const st=ut=>ut.hash?ut.hash:ut,ot=tt.filter(isDefined$2).map(st),at={hash:null,id:j,payload:et,next:ot,refs:nt,v:2,clock:rt||new LamportClock($.publicKey)},ct=await $.provider.sign($,Entry.toBuffer(at));return at.key=$.publicKey,at.identity=$.toJSON(),at.sig=ct,at.hash=await Entry.toMultihash(o,at,it),at}static async verify(o,$){if(!o)throw new Error("Identity-provider is required, cannot verify entry");if(!Entry.isEntry($))throw new Error("Invalid Log entry");if(!$.key)throw new Error("Entry doesn't have a key");if(!$.sig)throw new Error("Entry doesn't have a signature");const j=Entry.toEntry($,{presigned:!0}),et=$.v<1?"v0":"v1";return o.verify($.sig,$.key,Entry.toBuffer(j),et)}static toBuffer(o){const $=o.v===0?JSON.stringify(o):lib$1(o);return buffer$2.Buffer.from($)}static async toMultihash(o,$,j=!1){if(!o)throw IpfsNotDefinedError();if(!Entry.isEntry($))throw new Error("Invalid object format, cannot generate entry hash");const et=Entry.toEntry($);return write$3(o,getWriteFormat(et.v),et,{links:IPLD_LINKS$1,pin:j})}static toEntry(o,{presigned:$=!1,includeHash:j=!1}={}){const et={hash:j?o.hash:null,id:o.id,payload:o.payload,next:o.next},tt=o.v;return tt>1&&(et.refs=o.refs),et.v=o.v,et.clock=new LamportClock(o.clock.id,o.clock.time),$||(et.key=o.key,tt>0&&(et.identity=o.identity),et.sig=o.sig),et}static async fromMultihash(o,$){if(!o)throw IpfsNotDefinedError();if(!$)throw new Error(`Invalid hash: ${$}`);const j=await read$7(o,$,{links:IPLD_LINKS$1}),et=Entry.toEntry(j);return et.hash=$,et}static isEntry(o){return o&&o.id!==void 0&&o.next!==void 0&&o.payload!==void 0&&o.v!==void 0&&o.hash!==void 0&&o.clock!==void 0&&(o.refs!==void 0||o.v<2)}static compare(o,$){const j=LamportClock.compare(o.clock,$.clock);return j===0?o.clock.id<$.clock.id?-1:1:j}static isEqual(o,$){return o.hash===$.hash}static isParent(o,$){return $.next.indexOf(o.hash)>-1}static findChildren(o,$){let j=[],et=$.find(rt=>Entry.isParent(o,rt)),tt=o;for(;et;)j.push(et),tt=et,et=$.find(rt=>Entry.isParent(tt,rt));return j=j.sort((rt,nt)=>rt.clock.time>nt.clock.time),j}}async function pDoWhilst(_,o){const $=await _();if(o($))return pDoWhilst(_,o)}const{isEntry:isEntry$1,fromMultihash}=Entry,hasItems=_=>_&&_.length>0;class EntryIO{static async fetchParallel(o,$,{length:j,exclude:et=[],shouldExclude:tt,timeout:rt,concurrency:nt,onProgressCallback:it}){const st=async ut=>EntryIO.fetchAll(o,ut,{length:j,exclude:et,shouldExclude:tt,timeout:rt,onProgressCallback:it,concurrency:nt}),ot=(ut,ft)=>ut.concat(ft),at=ut=>ut.reduce(ot,[]),ct=await pMap$1($,st,{concurrency:Math.max(nt||$.length,1)});return at(ct)}static async fetchAll(o,$,{length:j=-1,exclude:et=[],shouldExclude:tt,timeout:rt,onProgressCallback:nt,onStartProgressCallback:it,concurrency:st=32,delay:ot=0}={}){const at=[],ct={},ut={},ft=Array.isArray($)?{0:$.slice()}:{0:[$]};let ht=0,mt=0,gt=0;tt=tt||(()=>!1);const Et=()=>Object.values(ft).find(hasItems)!==void 0,St=(Dt,Ot)=>{!ut[Dt]&&!tt(Dt)&&(ft[Ot]||(ft[Ot]=[]),ft[Ot].includes(Dt)||ft[Ot].push(Dt),ut[Dt]=!0)},At=(Dt=1)=>{const Ot=(jt,Nt,It)=>{const yt=ft[Nt];for(;yt.length>0&&jt.length<Dt;){const lt=yt.shift();jt.push(lt)}return yt.length===0&&delete ft[Nt],jt};return Object.keys(ft).reduce(Ot,[])},kt=Dt=>{ct[Dt.hash||Dt]=!0},Rt=async Dt=>{if(!(!Dt||ct[Dt]||tt(Dt)))return new Promise(async(Ot,jt)=>{const Nt=rt&&rt>0?setTimeout(()=>{console.warn(`Warning: Couldn't fetch entry '${Dt}', request timed out (${rt}ms)`),Ot()},rt):null,It=yt=>{if(isEntry$1(yt)&&!ct[yt.hash]&&!tt(yt.hash)){const lt=yt.clock.time;mt=Math.max(mt,lt),gt=at.length>0?Math.min(at[at.length-1].clock.time,gt):mt;const pt=at.length>=j&&lt>=gt,bt=_t=>mt-lt+(_t+1)*_t;(j<0||at.length<j||pt)&&!tt(yt.hash)&&!ct[yt.hash]&&(at.push(yt),ct[yt.hash]=!0,nt&&nt(yt)),j<0?(yt.next.forEach(St),yt.refs&&yt.refs.forEach(St)):((at.length<j||lt>gt||lt===gt&&!ct[yt.hash]&&!tt(yt.hash))&&yt.next.forEach(_t=>St(_t,bt(0))),yt.refs&&at.length+yt.refs.length<=j&&yt.refs.forEach((_t,$t)=>St(_t,bt($t))))}};it&&it(Dt,null,0,at.length);try{const yt=await fromMultihash(o,Dt);ot>0&&await((pt=0)=>new Promise(bt=>setTimeout(bt,pt)))(ot),It(yt),Ot()}catch(yt){jt(yt)}finally{clearTimeout(Nt)}})},Tt=async()=>{if(ht<st){const Dt=At(st);ht+=Dt.length,await pMap$1(Dt,Rt,{concurrency:st}),ht-=Dt.length}};return et.forEach(kt),await pDoWhilst(Tt,Et),at}}function LastWriteWins$2(_,o){const $=(tt,rt)=>tt,j=(tt,rt)=>SortByClockId(tt,rt,$);return((tt,rt)=>SortByClocks(tt,rt,j))(_,o)}function SortByEntryHash(_,o){const $=(tt,rt)=>tt.hash<rt.hash?-1:1,j=(tt,rt)=>SortByClockId(tt,rt,$);return((tt,rt)=>SortByClocks(tt,rt,j))(_,o)}function SortByClocks(_,o,$){const j=LamportClock.compare(_.clock,o.clock);return j===0?$(_,o):j}function SortByClockId(_,o,$){return _.clock.id===o.clock.id?$(_,o):_.clock.id<o.clock.id?-1:1}function NoZeroes$2(_){const o=`Your log's tiebreaker function, ${_.name}, has returned zero and therefore cannot be`;return(j,et)=>{const tt=_(j,et);if(tt===0)throw Error(o);return tt}}const Sorting={SortByClocks,SortByClockId,LastWriteWins:LastWriteWins$2,SortByEntryHash,NoZeroes:NoZeroes$2},IPFSNotDefinedError=()=>new Error("IPFS instance not defined"),LogNotDefinedError=()=>new Error("Log instance not defined"),NotALogError=()=>new Error("Given argument is not an instance of Log"),LtOrLteMustBeStringOrArray=()=>new Error("lt or lte must be a string or array of Entries"),{LastWriteWins:LastWriteWins$1,NoZeroes:NoZeroes$1}=Sorting,{fetchAll,fetchParallel}=EntryIO,{compare:compare$2,isEntry}=Entry,IPLD_LINKS=["heads"],last$1=(_,o)=>_.slice(_.length-Math.min(_.length,o),_.length);class LogIO{static async toMultihash(o,$,{format:j}={}){if(!isDefined$2(o))throw IPFSNotDefinedError();if(!isDefined$2($))throw LogNotDefinedError();if(isDefined$2(j)||(j="dag-cbor"),$.values.length<1)throw new Error("Can't serialize an empty log");return write$3(o,j,$.toJSON(),{links:IPLD_LINKS})}static async fromMultihash(o,$,{length:j=-1,exclude:et=[],shouldExclude:tt,timeout:rt,concurrency:nt,sortFn:it,onProgressCallback:st}){if(!isDefined$2(o))throw IPFSNotDefinedError();if(!isDefined$2($))throw new Error(`Invalid hash: ${$}`);const ot=await read$7(o,$,{links:IPLD_LINKS});if(!ot.heads||!ot.id)throw NotALogError();it=it||NoZeroes$1(LastWriteWins$1);const at=mt=>ot.heads.includes(mt.hash),ct=await fetchAll(o,ot.heads,{length:j,exclude:et,shouldExclude:tt,timeout:rt,concurrency:nt,onProgressCallback:st}),ut=ot.id,ft=j>-1?last$1(ct.sort(it),j):ct,ht=ft.filter(at);return{logId:ut,entries:ft,heads:ht}}static async fromEntryHash(o,$,{length:j=-1,exclude:et=[],shouldExclude:tt,timeout:rt,concurrency:nt,sortFn:it,onProgressCallback:st}){if(!isDefined$2(o))throw IPFSNotDefinedError();if(!isDefined$2($))throw new Error("'hash' must be defined");const ot=Array.isArray($)?$:[$];j=j>-1?Math.max(j,1):j;const at=await fetchParallel(o,ot,{length:j,exclude:et,shouldExclude:tt,timeout:rt,concurrency:nt,onProgressCallback:st});return it=it||NoZeroes$1(LastWriteWins$1),{entries:j>-1?last$1(at.sort(it),j):at}}static async fromJSON(o,$,{length:j=-1,timeout:et,concurrency:tt,onProgressCallback:rt}){if(!isDefined$2(o))throw IPFSNotDefinedError();const{id:nt,heads:it}=$,st=it.map(ct=>ct.hash),at=(await fetchParallel(o,st,{length:j,timeout:et,concurrency:tt,onProgressCallback:rt})).sort(compare$2);return{logId:nt,entries:at,heads:it}}static async fromEntry(o,$,{length:j=-1,exclude:et=[],shouldExclude:tt,timeout:rt,concurrency:nt,onProgressCallback:it}){if(!isDefined$2(o))throw IPFSNotDefinedError();if(!isDefined$2($))throw new Error("'sourceEntries' must be defined");if(!Array.isArray($)&&!isEntry($))throw new Error("'sourceEntries' argument must be an array of Entry instances or a single Entry");Array.isArray($)||($=[$]),j=j>-1?Math.max(j,$.length):j;const st=$.map(Et=>Et.hash),ot=await fetchParallel(o,st,{length:j,exclude:et,shouldExclude:tt,timeout:rt,concurrency:nt,onProgressCallback:it}),at=$.concat(ot).concat(et),ct=findUniques(at,"hash").sort(compare$2),ut=ct.slice(j>-1?-j:-ct.length),ft=difference$1(ut,$,"hash"),mt=((Et,St)=>{const At=Et.slice(St.length,Et.length);return St.concat(At)})(ut,ft);return{logId:mt[mt.length-1].id,entries:mt}}}let AccessController$1=class{async canAppend(o,$){return!0}};class EntryIndex{constructor(o={}){this._cache=o}set(o,$){this._cache[o]=$}get(o){return this._cache[o]}delete(o){return delete this._cache[o]}add(o){this._cache=Object.assign(this._cache,o)}get length(){return Object.values(this._cache).length}}const{LastWriteWins,NoZeroes}=Sorting,randomId$1=()=>new Date().getTime().toString(),getHash=_=>_.hash,flatMap$1=(_,o)=>_.concat(o),getNextPointers=_=>_.next,maxClockTimeReducer=(_,o)=>Math.max(_,o.clock.time),uniqueEntriesReducer=(_,o)=>(_[o.hash]=o,_);class Log extends GSet{constructor(o,$,{logId:j,access:et,entries:tt,heads:rt,clock:nt,sortFn:it,concurrency:st}={}){if(!isDefined$2(o))throw IPFSNotDefinedError();if(!isDefined$2($))throw new Error("Identity is required");if(isDefined$2(et)||(et=new AccessController$1),isDefined$2(tt)&&!Array.isArray(tt))throw new Error("'entries' argument must be an array of Entry instances");if(isDefined$2(rt)&&!Array.isArray(rt))throw new Error("'heads' argument must be an array");isDefined$2(it)||(it=LastWriteWins),super(),this._sortFn=NoZeroes(it),this._storage=o,this._id=j||randomId$1(),this._access=et,this._identity=$;const ot=(tt||[]).reduce(uniqueEntriesReducer,{});this._entryIndex=new EntryIndex(ot),tt=Object.values(ot)||[],rt=rt||Log.findHeads(tt),this._headsIndex=rt.reduce(uniqueEntriesReducer,{}),this._nextsIndex={};const at=ut=>ut.next.forEach(ft=>this._nextsIndex[ft]=ut.hash);tt.forEach(at),this._length=tt.length;const ct=Math.max(nt?nt.time:0,this.heads.reduce(maxClockTimeReducer,0));this._clock=new LamportClock(this._identity.publicKey,ct),this.joinConcurrency=st||16}get id(){return this._id}get clock(){return this._clock}get length(){return this._length}get values(){return Object.values(this.traverse(this.heads)).reverse()}get heads(){return Object.values(this._headsIndex).sort(this._sortFn).reverse()}get tails(){return Log.findTails(this.values)}get tailHashes(){return Log.findTailHashes(this.values)}setIdentity(o){this._identity=o;const $=Math.max(this.clock.time,this.heads.reduce(maxClockTimeReducer,0));this._clock=new LamportClock(this._identity.publicKey,$)}get(o){return this._entryIndex.get(o)}has(o){return this._entryIndex.get(o.hash||o)!==void 0}traverse(o,$=-1,j){let et=o.sort(this._sortFn).reverse(),tt={};const rt={};let nt=0;const it=at=>this.get(at),st=at=>{!at||tt[at.hash]||(et=[at,...et].sort(this._sortFn).reverse(),tt[at.hash]=!0)},ot=at=>{rt[at.hash]=at,tt[at.hash]=!0,nt++};for(;et.length>0&&(nt<$||$<0);){const at=et.shift();if(ot(at),j&&j===at.hash)break;at.next.map(it).filter(isDefined$2).forEach(st)}return et=[],tt={},rt}async append(o,$=1,j=!1){const et=Math.max(this.clock.time,this.heads.reduce(maxClockTimeReducer,0))+1;this._clock=new LamportClock(this.clock.id,et);const tt=Object.values(this.traverse(this.heads,Math.max($,this.heads.length))),nt=(ut=>{const ft=new Set;for(let ht=1;ht<=ut;ht*=2){const mt=Math.min(ht-1,tt.length-1);ft.add(tt[mt])}return ft})(Math.min($,tt.length));tt.length<$&&tt[tt.length-1]&&nt.add(tt[tt.length-1]);const it=Object.keys(this.heads.reverse().reduce(uniqueEntriesReducer,{})),st=ut=>!it.includes(ut),ot=Array.from(nt).map(getHash).filter(st),at=await Entry.create(this._storage,this._identity,this.id,o,it,this.clock,ot,j);if(!await this._access.canAppend(at,this._identity.provider))throw new Error(`Could not append entry, key "${this._identity.id}" is not allowed to write to the log`);return this._entryIndex.set(at.hash,at),it.forEach(ut=>this._nextsIndex[ut]=at.hash),this._headsIndex={},this._headsIndex[at.hash]=at,this._length++,at}iterator({gt:o=void 0,gte:$=void 0,lt:j=void 0,lte:et=void 0,amount:tt=-1}={}){if(tt===0)return function*(){}();if(typeof et=="string"&&(et=[this.get(et)]),typeof j=="string"&&(j=[this.get(this.get(j).next[0])]),et&&!Array.isArray(et)||j&&!Array.isArray(j))throw LtOrLteMustBeStringOrArray();const rt=(et||j||this.heads).filter(isDefined$2),nt=$?this.get($).hash:o?this.get(o).hash:null,it=nt?-1:tt||-1,st=this.traverse(rt,it,nt);let ot=Object.values(st);return o&&ot.pop(),(o||$)&&tt>-1&&(ot=ot.slice(ot.length-tt,ot.length)),function*(){for(const at in ot)yield ot[at]}()}async join(o,$=-1){if(!isDefined$2(o))throw LogNotDefinedError();if(!Log.isLog(o))throw NotALogError();if(this.id!==o.id)return;const j=Log.difference(o,this),et=this._identity.provider,tt=async ft=>{if(!await this._access.canAppend(ft,et))throw new Error(`Could not append entry, key "${ft.identity.id}" is not allowed to write to the log`)},rt=async ft=>{const ht=await Entry.verify(et,ft),mt=ft.identity?ft.identity.publicKey:ft.key;if(!ht)throw new Error(`Could not validate signature "${ft.sig}" for entry "${ft.hash}" and key "${mt}"`)},nt=Object.values(j);await pMap$1(nt,async ft=>{await tt(ft),await rt(ft)},{concurrency:this.joinConcurrency});const it=ft=>{this.get(ft.hash)||this._length++,ft.next.forEach(mt=>this._nextsIndex[mt]=ft.hash)};Object.values(j).forEach(it),this._entryIndex.add(j);const st=ft=>!at.find(ht=>ht===ft.hash),ot=ft=>!this._nextsIndex[ft.hash],at=Object.values(j).map(getNextPointers).reduce(flatMap$1,[]),ct=Log.findHeads(Object.values(Object.assign({},this._headsIndex,o._headsIndex))).filter(st).filter(ot).reduce(uniqueEntriesReducer,{});if(this._headsIndex=ct,$>-1){let ft=this.values;ft=ft.slice(-$),this._entryIndex=null,this._entryIndex=new EntryIndex(ft.reduce(uniqueEntriesReducer,{})),this._headsIndex=Log.findHeads(ft).reduce(uniqueEntriesReducer,{}),this._length=this._entryIndex.length}const ut=Object.values(this._headsIndex).reduce(maxClockTimeReducer,0);return this._clock=new LamportClock(this.clock.id,Math.max(this.clock.time,ut)),this}toJSON(){return{id:this.id,heads:this.heads.sort(this._sortFn).reverse().map(getHash)}}toSnapshot(){return{id:this.id,heads:this.heads,values:this.values}}toBuffer(){return buffer$2.Buffer.from(JSON.stringify(this.toJSON()))}toString(o){return this.values.slice().reverse().map(($,j)=>{const tt=Entry.findChildren($,this.values).length;let rt=new Array(Math.max(tt-1,0));return rt=tt>1?rt.fill("  "):rt,rt=tt>0?rt.concat([""]):rt,rt.join("")+(o?o($.payload):$.payload)}).join(`
`)}static isLog(o){return o.id!==void 0&&o.heads!==void 0&&o._entryIndex!==void 0}toMultihash({format:o}={}){return LogIO.toMultihash(this._storage,this,{format:o})}static async fromMultihash(o,$,j,{access:et,length:tt=-1,exclude:rt=[],shouldExclude:nt,timeout:it,concurrency:st,sortFn:ot,onProgressCallback:at}={}){const{logId:ct,entries:ut,heads:ft}=await LogIO.fromMultihash(o,j,{length:tt,exclude:rt,shouldExclude:nt,timeout:it,onProgressCallback:at,concurrency:st,sortFn:ot});return new Log(o,$,{logId:ct,access:et,entries:ut,heads:ft,sortFn:ot})}static async fromEntryHash(o,$,j,{logId:et,access:tt,length:rt=-1,exclude:nt=[],shouldExclude:it,timeout:st,concurrency:ot,sortFn:at,onProgressCallback:ct}={}){const{entries:ut}=await LogIO.fromEntryHash(o,j,{length:rt,exclude:nt,shouldExclude:it,timeout:st,concurrency:ot,onProgressCallback:ct});return new Log(o,$,{logId:et,access:tt,entries:ut,sortFn:at})}static async fromJSON(o,$,j,{access:et,length:tt=-1,timeout:rt,sortFn:nt,onProgressCallback:it}={}){const{logId:st,entries:ot}=await LogIO.fromJSON(o,j,{length:tt,timeout:rt,onProgressCallback:it});return new Log(o,$,{logId:st,access:et,entries:ot,sortFn:nt})}static async fromEntry(o,$,j,{access:et,length:tt=-1,exclude:rt=[],timeout:nt,concurrency:it,sortFn:st,onProgressCallback:ot}={}){const{logId:at,entries:ct}=await LogIO.fromEntry(o,j,{length:tt,exclude:rt,timeout:nt,concurrency:it,onProgressCallback:ot});return new Log(o,$,{logId:at,access:et,entries:ct,sortFn:st})}static findHeads(o){const $=(rt,nt,it,st)=>{const ot=at=>rt[at]=nt.hash;return nt.next.forEach(ot),rt},j=o.reduce($,{}),et=rt=>j[rt.hash]===void 0,tt=(rt,nt)=>rt.clock.id>nt.clock.id;return o.filter(et).sort(tt)}static findTails(o){const $={},j=[],et={};let tt=[];const rt=at=>{at.next.length===0&&j.push(at);const ct=ut=>{$[ut]||($[ut]=[]),$[ut].push(at)};at.next.forEach(ct),tt=tt.concat(at.next),et[at.hash]=!0};o.forEach(rt);const nt=(at,ct,ut,ft)=>at.concat(findUniques(ct,"hash")),it=at=>et[at]===void 0,st=at=>$[at],ot=tt.filter(it).map(st).reduce(nt,[]).concat(j);return findUniques(ot,"hash").sort(Entry.compare)}static findTailHashes(o){const $={},j=tt=>$[tt.hash]=!0,et=(tt,rt,nt,it)=>{const st=ot=>{$[ot]===void 0&&tt.splice(0,0,ot)};return rt.next.reverse().forEach(st),tt};return o.forEach(j),o.reduce(et,[])}static difference(o,$){const j=Object.keys(o._headsIndex),et={},tt={},rt=nt=>{!et[nt]&&!$.get(nt)&&(j.push(nt),et[nt]=!0)};for(;j.length>0;){const nt=j.shift(),it=o.get(nt);it&&!$.get(nt)&&it.id===$.id&&(tt[it.hash]=it,et[it.hash]=!0,it.next.concat(it.refs).forEach(rt))}return tt}}const getNextAndRefsUnion=_=>[...new Set([..._.next,..._.refs])],flatMap=(_,o)=>_.concat(o),defaultConcurrency=32;class Replicator{constructor(o,$){this._store=o,this._concurrency=$||defaultConcurrency,this._q=new PQueue({concurrency:this._concurrency}),this._logs=[],this._fetching={},this._fetched={},this._q.on("idle",async()=>{const j=this._logs.slice();if(this._logs=[],this.onReplicationComplete&&j.length>0&&this._store._oplog)try{await this.onReplicationComplete(j),j.forEach(et=>et.values.forEach(tt=>delete this._fetched[tt.hash]))}catch(et){console.error(et)}})}get tasksRunning(){return this._q.pending}get tasksQueued(){return this._q.size}get unfinished(){return Object.keys(this._fetching)}async load(o){try{this._addToQueue(o)}catch($){console.error($)}}async _addToQueue(o){const $=et=>et&&this._store._oplog&&(this._store._oplog.has(et)||this._fetching[et]!==void 0||this._fetched[et]),j=et=>(this._fetching[et.hash||et]=!0,async()=>{et.hash&&this.onReplicationQueued&&this.onReplicationQueued(et);try{const tt=await this._replicateLog(et);this._logs.push(tt)}catch(tt){throw console.error(tt),tt}delete this._fetching[et.hash||et]});if(o.length>0){const et=o.filter(tt=>!$(tt.hash||tt)).map(tt=>j(tt));et.length>0&&this._q.addAll(et)}}async stop(){this._q.pause(),this._q.clear(),await this._q.onIdle(),this._logs=[],this._fetching={},this._fetched={}}async _replicateLog(o){const $=o.hash||o,j=nt=>{this._fetched[nt.hash]=!0,this.onReplicationProgress&&this.onReplicationProgress(nt)},et=nt=>nt&&nt!==$&&this._store._oplog&&(this._store._oplog.has(nt)||this._fetching[nt]!==void 0||this._fetched[nt]!==void 0),tt=await Log.fromEntryHash(this._store._ipfs,this._store.identity,$,{logId:this._store.id,access:this._store.access,length:-1,exclude:[],shouldExclude:et,concurrency:this._concurrency,onProgressCallback:j}),rt=tt.values.map(getNextAndRefsUnion).reduce(flatMap,[]);try{this._addToQueue(rt)}catch(nt){throw console.error(nt),nt}return tt}}class ReplicationInfo{constructor(){this.progress=0,this.max=0}reset(){this.progress=0,this.max=0}}var empty$1=null;const fs_=Object.freeze(Object.defineProperty({__proto__:null,default:empty$1},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(fs_);var util$9={},types$1={},shams$1=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var o={},$=Symbol("test"),j=Object($);if(typeof $=="string"||Object.prototype.toString.call($)!=="[object Symbol]"||Object.prototype.toString.call(j)!=="[object Symbol]")return!1;var et=42;o[$]=et;for($ in o)return!1;if(typeof Object.keys=="function"&&Object.keys(o).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(o).length!==0)return!1;var tt=Object.getOwnPropertySymbols(o);if(tt.length!==1||tt[0]!==$||!Object.prototype.propertyIsEnumerable.call(o,$))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var rt=Object.getOwnPropertyDescriptor(o,$);if(rt.value!==et||rt.enumerable!==!0)return!1}return!0},hasSymbols$2=shams$1,shams=function(){return hasSymbols$2()&&!!Symbol.toStringTag},origSymbol=typeof Symbol<"u"&&Symbol,hasSymbolSham=shams$1,hasSymbols$1=function(){return typeof origSymbol!="function"||typeof Symbol!="function"||typeof origSymbol("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:hasSymbolSham()},ERROR_MESSAGE$1="Function.prototype.bind called on incompatible ",slice=Array.prototype.slice,toStr$3=Object.prototype.toString,funcType="[object Function]",implementation$2=function(o){var $=this;if(typeof $!="function"||toStr$3.call($)!==funcType)throw new TypeError(ERROR_MESSAGE$1+$);for(var j=slice.call(arguments,1),et,tt=function(){if(this instanceof et){var ot=$.apply(this,j.concat(slice.call(arguments)));return Object(ot)===ot?ot:this}else return $.apply(o,j.concat(slice.call(arguments)))},rt=Math.max(0,$.length-j.length),nt=[],it=0;it<rt;it++)nt.push("$"+it);if(et=Function("binder","return function ("+nt.join(",")+"){ return binder.apply(this,arguments); }")(tt),$.prototype){var st=function(){};st.prototype=$.prototype,et.prototype=new st,st.prototype=null}return et},implementation$1=implementation$2,functionBind=Function.prototype.bind||implementation$1,bind$1=functionBind,src$9=bind$1.call(Function.call,Object.prototype.hasOwnProperty),undefined$1,$SyntaxError=SyntaxError,$Function=Function,$TypeError=TypeError,getEvalledConstructor=function(_){try{return $Function('"use strict"; return ('+_+").constructor;")()}catch{}},$gOPD$1=Object.getOwnPropertyDescriptor;if($gOPD$1)try{$gOPD$1({},"")}catch{$gOPD$1=null}var throwTypeError=function(){throw new $TypeError},ThrowTypeError=$gOPD$1?function(){try{return arguments.callee,throwTypeError}catch{try{return $gOPD$1(arguments,"callee").get}catch{return throwTypeError}}}():throwTypeError,hasSymbols=hasSymbols$1(),getProto$1=Object.getPrototypeOf||function(_){return _.__proto__},needsEval={},TypedArray=typeof Uint8Array>"u"?undefined$1:getProto$1(Uint8Array),INTRINSICS={"%AggregateError%":typeof AggregateError>"u"?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols?getProto$1([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics>"u"?undefined$1:Atomics,"%BigInt%":typeof BigInt>"u"?undefined$1:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?undefined$1:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?undefined$1:Float32Array,"%Float64Array%":typeof Float64Array>"u"?undefined$1:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array>"u"?undefined$1:Int8Array,"%Int16Array%":typeof Int16Array>"u"?undefined$1:Int16Array,"%Int32Array%":typeof Int32Array>"u"?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols?getProto$1(getProto$1([][Symbol.iterator]())):undefined$1,"%JSON%":typeof JSON=="object"?JSON:undefined$1,"%Map%":typeof Map>"u"?undefined$1:Map,"%MapIteratorPrototype%":typeof Map>"u"||!hasSymbols?undefined$1:getProto$1(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?undefined$1:Promise,"%Proxy%":typeof Proxy>"u"?undefined$1:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?undefined$1:Set,"%SetIteratorPrototype%":typeof Set>"u"||!hasSymbols?undefined$1:getProto$1(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols?getProto$1(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols?Symbol:undefined$1,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":typeof Uint8Array>"u"?undefined$1:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?undefined$1:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?undefined$1:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?undefined$1:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?undefined$1:WeakMap,"%WeakRef%":typeof WeakRef>"u"?undefined$1:WeakRef,"%WeakSet%":typeof WeakSet>"u"?undefined$1:WeakSet};try{null.error}catch(_){var errorProto=getProto$1(getProto$1(_));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function _(o){var $;if(o==="%AsyncFunction%")$=getEvalledConstructor("async function () {}");else if(o==="%GeneratorFunction%")$=getEvalledConstructor("function* () {}");else if(o==="%AsyncGeneratorFunction%")$=getEvalledConstructor("async function* () {}");else if(o==="%AsyncGenerator%"){var j=_("%AsyncGeneratorFunction%");j&&($=j.prototype)}else if(o==="%AsyncIteratorPrototype%"){var et=_("%AsyncGenerator%");et&&($=getProto$1(et.prototype))}return INTRINSICS[o]=$,$},LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=functionBind,hasOwn=src$9,$concat=bind.call(Function.call,Array.prototype.concat),$spliceApply=bind.call(Function.apply,Array.prototype.splice),$replace=bind.call(Function.call,String.prototype.replace),$strSlice=bind.call(Function.call,String.prototype.slice),$exec=bind.call(Function.call,RegExp.prototype.exec),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function(o){var $=$strSlice(o,0,1),j=$strSlice(o,-1);if($==="%"&&j!=="%")throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`");if(j==="%"&&$!=="%")throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`");var et=[];return $replace(o,rePropName,function(tt,rt,nt,it){et[et.length]=nt?$replace(it,reEscapeChar,"$1"):rt||tt}),et},getBaseIntrinsic=function(o,$){var j=o,et;if(hasOwn(LEGACY_ALIASES,j)&&(et=LEGACY_ALIASES[j],j="%"+et[0]+"%"),hasOwn(INTRINSICS,j)){var tt=INTRINSICS[j];if(tt===needsEval&&(tt=doEval(j)),typeof tt>"u"&&!$)throw new $TypeError("intrinsic "+o+" exists, but is not available. Please file an issue!");return{alias:et,name:j,value:tt}}throw new $SyntaxError("intrinsic "+o+" does not exist!")},getIntrinsic=function(o,$){if(typeof o!="string"||o.length===0)throw new $TypeError("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof $!="boolean")throw new $TypeError('"allowMissing" argument must be a boolean');if($exec(/^%?[^%]*%?$/,o)===null)throw new $SyntaxError("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var j=stringToPath(o),et=j.length>0?j[0]:"",tt=getBaseIntrinsic("%"+et+"%",$),rt=tt.name,nt=tt.value,it=!1,st=tt.alias;st&&(et=st[0],$spliceApply(j,$concat([0,1],st)));for(var ot=1,at=!0;ot<j.length;ot+=1){var ct=j[ot],ut=$strSlice(ct,0,1),ft=$strSlice(ct,-1);if((ut==='"'||ut==="'"||ut==="`"||ft==='"'||ft==="'"||ft==="`")&&ut!==ft)throw new $SyntaxError("property names with quotes must have matching quotes");if((ct==="constructor"||!at)&&(it=!0),et+="."+ct,rt="%"+et+"%",hasOwn(INTRINSICS,rt))nt=INTRINSICS[rt];else if(nt!=null){if(!(ct in nt)){if(!$)throw new $TypeError("base intrinsic for "+o+" exists, but the property is not available.");return}if($gOPD$1&&ot+1>=j.length){var ht=$gOPD$1(nt,ct);at=!!ht,at&&"get"in ht&&!("originalValue"in ht.get)?nt=ht.get:nt=nt[ct]}else at=hasOwn(nt,ct),nt=nt[ct];at&&!it&&(INTRINSICS[rt]=nt)}}return nt},callBindExports={},callBind$1={get exports(){return callBindExports},set exports(_){callBindExports=_}};(function(_){var o=functionBind,$=getIntrinsic,j=$("%Function.prototype.apply%"),et=$("%Function.prototype.call%"),tt=$("%Reflect.apply%",!0)||o.call(et,j),rt=$("%Object.getOwnPropertyDescriptor%",!0),nt=$("%Object.defineProperty%",!0),it=$("%Math.max%");if(nt)try{nt({},"a",{value:1})}catch{nt=null}_.exports=function(at){var ct=tt(o,et,arguments);if(rt&&nt){var ut=rt(ct,"length");ut.configurable&&nt(ct,"length",{value:1+it(0,at.length-(arguments.length-1))})}return ct};var st=function(){return tt(o,j,arguments)};nt?nt(_.exports,"apply",{value:st}):_.exports.apply=st})(callBind$1);var GetIntrinsic$1=getIntrinsic,callBind=callBindExports,$indexOf$1=callBind(GetIntrinsic$1("String.prototype.indexOf")),callBound$3=function(o,$){var j=GetIntrinsic$1(o,!!$);return typeof j=="function"&&$indexOf$1(o,".prototype.")>-1?callBind(j):j},hasToStringTag$4=shams(),callBound$2=callBound$3,$toString$2=callBound$2("Object.prototype.toString"),isStandardArguments=function(o){return hasToStringTag$4&&o&&typeof o=="object"&&Symbol.toStringTag in o?!1:$toString$2(o)==="[object Arguments]"},isLegacyArguments=function(o){return isStandardArguments(o)?!0:o!==null&&typeof o=="object"&&typeof o.length=="number"&&o.length>=0&&$toString$2(o)!=="[object Array]"&&$toString$2(o.callee)==="[object Function]"},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;var isArguments=supportsStandardArguments?isStandardArguments:isLegacyArguments,toStr$2=Object.prototype.toString,fnToStr$1=Function.prototype.toString,isFnRegex=/^\s*(?:function)?\*/,hasToStringTag$3=shams(),getProto=Object.getPrototypeOf,getGeneratorFunc=function(){if(!hasToStringTag$3)return!1;try{return Function("return function*() {}")()}catch{}},GeneratorFunction,isGeneratorFunction=function(o){if(typeof o!="function")return!1;if(isFnRegex.test(fnToStr$1.call(o)))return!0;if(!hasToStringTag$3){var $=toStr$2.call(o);return $==="[object GeneratorFunction]"}if(!getProto)return!1;if(typeof GeneratorFunction>"u"){var j=getGeneratorFunc();GeneratorFunction=j?getProto(j):!1}return getProto(o)===GeneratorFunction},fnToStr=Function.prototype.toString,reflectApply=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,badArrayLike,isCallableMarker;if(typeof reflectApply=="function"&&typeof Object.defineProperty=="function")try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}}),isCallableMarker={},reflectApply(function(){throw 42},null,badArrayLike)}catch(_){_!==isCallableMarker&&(reflectApply=null)}else reflectApply=null;var constructorRegex=/^\s*class\b/,isES6ClassFn=function(o){try{var $=fnToStr.call(o);return constructorRegex.test($)}catch{return!1}},tryFunctionObject=function(o){try{return isES6ClassFn(o)?!1:(fnToStr.call(o),!0)}catch{return!1}},toStr$1=Object.prototype.toString,objectClass="[object Object]",fnClass="[object Function]",genClass="[object GeneratorFunction]",ddaClass="[object HTMLAllCollection]",ddaClass2="[object HTML document.all class]",ddaClass3="[object HTMLCollection]",hasToStringTag$2=typeof Symbol=="function"&&!!Symbol.toStringTag,isIE68=!(0 in[,]),isDDA=function(){return!1};if(typeof document=="object"){var all$4=document.all;toStr$1.call(all$4)===toStr$1.call(document.all)&&(isDDA=function(o){if((isIE68||!o)&&(typeof o>"u"||typeof o=="object"))try{var $=toStr$1.call(o);return($===ddaClass||$===ddaClass2||$===ddaClass3||$===objectClass)&&o("")==null}catch{}return!1})}var isCallable$1=reflectApply?function(o){if(isDDA(o))return!0;if(!o||typeof o!="function"&&typeof o!="object")return!1;try{reflectApply(o,null,badArrayLike)}catch($){if($!==isCallableMarker)return!1}return!isES6ClassFn(o)&&tryFunctionObject(o)}:function(o){if(isDDA(o))return!0;if(!o||typeof o!="function"&&typeof o!="object")return!1;if(hasToStringTag$2)return tryFunctionObject(o);if(isES6ClassFn(o))return!1;var $=toStr$1.call(o);return $!==fnClass&&$!==genClass&&!/^\[object HTML/.test($)?!1:tryFunctionObject(o)},isCallable=isCallable$1,toStr=Object.prototype.toString,hasOwnProperty$2=Object.prototype.hasOwnProperty,forEachArray=function(o,$,j){for(var et=0,tt=o.length;et<tt;et++)hasOwnProperty$2.call(o,et)&&(j==null?$(o[et],et,o):$.call(j,o[et],et,o))},forEachString=function(o,$,j){for(var et=0,tt=o.length;et<tt;et++)j==null?$(o.charAt(et),et,o):$.call(j,o.charAt(et),et,o)},forEachObject=function(o,$,j){for(var et in o)hasOwnProperty$2.call(o,et)&&(j==null?$(o[et],et,o):$.call(j,o[et],et,o))},forEach$2=function(o,$,j){if(!isCallable($))throw new TypeError("iterator must be a function");var et;arguments.length>=3&&(et=j),toStr.call(o)==="[object Array]"?forEachArray(o,$,et):typeof o=="string"?forEachString(o,$,et):forEachObject(o,$,et)},forEach_1=forEach$2,possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],g$2=typeof globalThis>"u"?commonjsGlobal:globalThis,availableTypedArrays$2=function(){for(var o=[],$=0;$<possibleNames.length;$++)typeof g$2[possibleNames[$]]=="function"&&(o[o.length]=possibleNames[$]);return o},GetIntrinsic=getIntrinsic,$gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",!0);if($gOPD)try{$gOPD([],"length")}catch{$gOPD=null}var gopd=$gOPD,forEach$1=forEach_1,availableTypedArrays$1=availableTypedArrays$2,callBound$1=callBound$3,$toString$1=callBound$1("Object.prototype.toString"),hasToStringTag$1=shams(),gOPD$1=gopd,g$1=typeof globalThis>"u"?commonjsGlobal:globalThis,typedArrays$1=availableTypedArrays$1(),$indexOf=callBound$1("Array.prototype.indexOf",!0)||function(o,$){for(var j=0;j<o.length;j+=1)if(o[j]===$)return j;return-1},$slice$1=callBound$1("String.prototype.slice"),toStrTags$1={},getPrototypeOf$1=Object.getPrototypeOf;hasToStringTag$1&&gOPD$1&&getPrototypeOf$1&&forEach$1(typedArrays$1,function(_){var o=new g$1[_];if(Symbol.toStringTag in o){var $=getPrototypeOf$1(o),j=gOPD$1($,Symbol.toStringTag);if(!j){var et=getPrototypeOf$1($);j=gOPD$1(et,Symbol.toStringTag)}toStrTags$1[_]=j.get}});var tryTypedArrays$1=function(o){var $=!1;return forEach$1(toStrTags$1,function(j,et){if(!$)try{$=j.call(o)===et}catch{}}),$},isTypedArray$1=function(o){if(!o||typeof o!="object")return!1;if(!hasToStringTag$1||!(Symbol.toStringTag in o)){var $=$slice$1($toString$1(o),8,-1);return $indexOf(typedArrays$1,$)>-1}return gOPD$1?tryTypedArrays$1(o):!1},forEach=forEach_1,availableTypedArrays=availableTypedArrays$2,callBound=callBound$3,gOPD=gopd,$toString=callBound("Object.prototype.toString"),hasToStringTag=shams(),g=typeof globalThis>"u"?commonjsGlobal:globalThis,typedArrays=availableTypedArrays(),$slice=callBound("String.prototype.slice"),toStrTags={},getPrototypeOf=Object.getPrototypeOf;hasToStringTag&&gOPD&&getPrototypeOf&&forEach(typedArrays,function(_){if(typeof g[_]=="function"){var o=new g[_];if(Symbol.toStringTag in o){var $=getPrototypeOf(o),j=gOPD($,Symbol.toStringTag);if(!j){var et=getPrototypeOf($);j=gOPD(et,Symbol.toStringTag)}toStrTags[_]=j.get}}});var tryTypedArrays=function(o){var $=!1;return forEach(toStrTags,function(j,et){if(!$)try{var tt=j.call(o);tt===et&&($=tt)}catch{}}),$},isTypedArray=isTypedArray$1,whichTypedArray=function(o){return isTypedArray(o)?!hasToStringTag||!(Symbol.toStringTag in o)?$slice($toString(o),8,-1):tryTypedArrays(o):!1};(function(_){var o=isArguments,$=isGeneratorFunction,j=whichTypedArray,et=isTypedArray$1;function tt(zt){return zt.call.bind(zt)}var rt=typeof BigInt<"u",nt=typeof Symbol<"u",it=tt(Object.prototype.toString),st=tt(Number.prototype.valueOf),ot=tt(String.prototype.valueOf),at=tt(Boolean.prototype.valueOf);if(rt)var ct=tt(BigInt.prototype.valueOf);if(nt)var ut=tt(Symbol.prototype.valueOf);function ft(zt,Qt){if(typeof zt!="object")return!1;try{return Qt(zt),!0}catch{return!1}}_.isArgumentsObject=o,_.isGeneratorFunction=$,_.isTypedArray=et;function ht(zt){return typeof Promise<"u"&&zt instanceof Promise||zt!==null&&typeof zt=="object"&&typeof zt.then=="function"&&typeof zt.catch=="function"}_.isPromise=ht;function mt(zt){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(zt):et(zt)||wt(zt)}_.isArrayBufferView=mt;function gt(zt){return j(zt)==="Uint8Array"}_.isUint8Array=gt;function Et(zt){return j(zt)==="Uint8ClampedArray"}_.isUint8ClampedArray=Et;function St(zt){return j(zt)==="Uint16Array"}_.isUint16Array=St;function At(zt){return j(zt)==="Uint32Array"}_.isUint32Array=At;function kt(zt){return j(zt)==="Int8Array"}_.isInt8Array=kt;function Rt(zt){return j(zt)==="Int16Array"}_.isInt16Array=Rt;function Tt(zt){return j(zt)==="Int32Array"}_.isInt32Array=Tt;function Dt(zt){return j(zt)==="Float32Array"}_.isFloat32Array=Dt;function Ot(zt){return j(zt)==="Float64Array"}_.isFloat64Array=Ot;function jt(zt){return j(zt)==="BigInt64Array"}_.isBigInt64Array=jt;function Nt(zt){return j(zt)==="BigUint64Array"}_.isBigUint64Array=Nt;function It(zt){return it(zt)==="[object Map]"}It.working=typeof Map<"u"&&It(new Map);function yt(zt){return typeof Map>"u"?!1:It.working?It(zt):zt instanceof Map}_.isMap=yt;function lt(zt){return it(zt)==="[object Set]"}lt.working=typeof Set<"u"&&lt(new Set);function pt(zt){return typeof Set>"u"?!1:lt.working?lt(zt):zt instanceof Set}_.isSet=pt;function bt(zt){return it(zt)==="[object WeakMap]"}bt.working=typeof WeakMap<"u"&&bt(new WeakMap);function _t(zt){return typeof WeakMap>"u"?!1:bt.working?bt(zt):zt instanceof WeakMap}_.isWeakMap=_t;function $t(zt){return it(zt)==="[object WeakSet]"}$t.working=typeof WeakSet<"u"&&$t(new WeakSet);function Ct(zt){return $t(zt)}_.isWeakSet=Ct;function xt(zt){return it(zt)==="[object ArrayBuffer]"}xt.working=typeof ArrayBuffer<"u"&&xt(new ArrayBuffer);function vt(zt){return typeof ArrayBuffer>"u"?!1:xt.working?xt(zt):zt instanceof ArrayBuffer}_.isArrayBuffer=vt;function dt(zt){return it(zt)==="[object DataView]"}dt.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&dt(new DataView(new ArrayBuffer(1),0,1));function wt(zt){return typeof DataView>"u"?!1:dt.working?dt(zt):zt instanceof DataView}_.isDataView=wt;var qt=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Pt(zt){return it(zt)==="[object SharedArrayBuffer]"}function Gt(zt){return typeof qt>"u"?!1:(typeof Pt.working>"u"&&(Pt.working=Pt(new qt)),Pt.working?Pt(zt):zt instanceof qt)}_.isSharedArrayBuffer=Gt;function Wt(zt){return it(zt)==="[object AsyncFunction]"}_.isAsyncFunction=Wt;function Vt(zt){return it(zt)==="[object Map Iterator]"}_.isMapIterator=Vt;function Ut(zt){return it(zt)==="[object Set Iterator]"}_.isSetIterator=Ut;function Mt(zt){return it(zt)==="[object Generator]"}_.isGeneratorObject=Mt;function Lt(zt){return it(zt)==="[object WebAssembly.Module]"}_.isWebAssemblyCompiledModule=Lt;function Yt(zt){return ft(zt,st)}_.isNumberObject=Yt;function lr(zt){return ft(zt,ot)}_.isStringObject=lr;function cr(zt){return ft(zt,at)}_.isBooleanObject=cr;function ir(zt){return rt&&ft(zt,ct)}_.isBigIntObject=ir;function Zt(zt){return nt&&ft(zt,ut)}_.isSymbolObject=Zt;function Bt(zt){return Yt(zt)||lr(zt)||cr(zt)||ir(zt)||Zt(zt)}_.isBoxedPrimitive=Bt;function Ft(zt){return typeof Uint8Array<"u"&&(vt(zt)||Gt(zt))}_.isAnyArrayBuffer=Ft,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(zt){Object.defineProperty(_,zt,{enumerable:!1,value:function(){throw new Error(zt+" is not supported in userland")}})})})(types$1);var isBufferBrowser=function(o){return o&&typeof o=="object"&&typeof o.copy=="function"&&typeof o.fill=="function"&&typeof o.readUInt8=="function"},inherits_browserExports={},inherits_browser$1={get exports(){return inherits_browserExports},set exports(_){inherits_browserExports=_}};typeof Object.create=="function"?inherits_browser$1.exports=function(o,$){$&&(o.super_=$,o.prototype=Object.create($.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser$1.exports=function(o,$){if($){o.super_=$;var j=function(){};j.prototype=$.prototype,o.prototype=new j,o.prototype.constructor=o}};(function(_){var o=Object.getOwnPropertyDescriptors||function(wt){for(var qt=Object.keys(wt),Pt={},Gt=0;Gt<qt.length;Gt++)Pt[qt[Gt]]=Object.getOwnPropertyDescriptor(wt,qt[Gt]);return Pt},$=/%[sdj%]/g;_.format=function(dt){if(!kt(dt)){for(var wt=[],qt=0;qt<arguments.length;qt++)wt.push(rt(arguments[qt]));return wt.join(" ")}for(var qt=1,Pt=arguments,Gt=Pt.length,Wt=String(dt).replace($,function(Ut){if(Ut==="%%")return"%";if(qt>=Gt)return Ut;switch(Ut){case"%s":return String(Pt[qt++]);case"%d":return Number(Pt[qt++]);case"%j":try{return JSON.stringify(Pt[qt++])}catch{return"[Circular]"}default:return Ut}}),Vt=Pt[qt];qt<Gt;Vt=Pt[++qt])Et(Vt)||!Ot(Vt)?Wt+=" "+Vt:Wt+=" "+rt(Vt);return Wt},_.deprecate=function(dt,wt){if(typeof browserExports$3<"u"&&browserExports$3.noDeprecation===!0)return dt;if(typeof browserExports$3>"u")return function(){return _.deprecate(dt,wt).apply(this,arguments)};var qt=!1;function Pt(){if(!qt){if(browserExports$3.throwDeprecation)throw new Error(wt);browserExports$3.traceDeprecation?console.trace(wt):console.error(wt),qt=!0}return dt.apply(this,arguments)}return Pt};var j={},et=/^$/;if({}.NODE_DEBUG){var tt={}.NODE_DEBUG;tt=tt.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),et=new RegExp("^"+tt+"$","i")}_.debuglog=function(dt){if(dt=dt.toUpperCase(),!j[dt])if(et.test(dt)){var wt=browserExports$3.pid;j[dt]=function(){var qt=_.format.apply(_,arguments);console.error("%s %d: %s",dt,wt,qt)}}else j[dt]=function(){};return j[dt]};function rt(dt,wt){var qt={seen:[],stylize:it};return arguments.length>=3&&(qt.depth=arguments[2]),arguments.length>=4&&(qt.colors=arguments[3]),gt(wt)?qt.showHidden=wt:wt&&_._extend(qt,wt),Tt(qt.showHidden)&&(qt.showHidden=!1),Tt(qt.depth)&&(qt.depth=2),Tt(qt.colors)&&(qt.colors=!1),Tt(qt.customInspect)&&(qt.customInspect=!0),qt.colors&&(qt.stylize=nt),ot(qt,dt,qt.depth)}_.inspect=rt,rt.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},rt.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function nt(dt,wt){var qt=rt.styles[wt];return qt?"\x1B["+rt.colors[qt][0]+"m"+dt+"\x1B["+rt.colors[qt][1]+"m":dt}function it(dt,wt){return dt}function st(dt){var wt={};return dt.forEach(function(qt,Pt){wt[qt]=!0}),wt}function ot(dt,wt,qt){if(dt.customInspect&&wt&&It(wt.inspect)&&wt.inspect!==_.inspect&&!(wt.constructor&&wt.constructor.prototype===wt)){var Pt=wt.inspect(qt,dt);return kt(Pt)||(Pt=ot(dt,Pt,qt)),Pt}var Gt=at(dt,wt);if(Gt)return Gt;var Wt=Object.keys(wt),Vt=st(Wt);if(dt.showHidden&&(Wt=Object.getOwnPropertyNames(wt)),Nt(wt)&&(Wt.indexOf("message")>=0||Wt.indexOf("description")>=0))return ct(wt);if(Wt.length===0){if(It(wt)){var Ut=wt.name?": "+wt.name:"";return dt.stylize("[Function"+Ut+"]","special")}if(Dt(wt))return dt.stylize(RegExp.prototype.toString.call(wt),"regexp");if(jt(wt))return dt.stylize(Date.prototype.toString.call(wt),"date");if(Nt(wt))return ct(wt)}var Mt="",Lt=!1,Yt=["{","}"];if(mt(wt)&&(Lt=!0,Yt=["[","]"]),It(wt)){var lr=wt.name?": "+wt.name:"";Mt=" [Function"+lr+"]"}if(Dt(wt)&&(Mt=" "+RegExp.prototype.toString.call(wt)),jt(wt)&&(Mt=" "+Date.prototype.toUTCString.call(wt)),Nt(wt)&&(Mt=" "+ct(wt)),Wt.length===0&&(!Lt||wt.length==0))return Yt[0]+Mt+Yt[1];if(qt<0)return Dt(wt)?dt.stylize(RegExp.prototype.toString.call(wt),"regexp"):dt.stylize("[Object]","special");dt.seen.push(wt);var cr;return Lt?cr=ut(dt,wt,qt,Vt,Wt):cr=Wt.map(function(ir){return ft(dt,wt,qt,Vt,ir,Lt)}),dt.seen.pop(),ht(cr,Mt,Yt)}function at(dt,wt){if(Tt(wt))return dt.stylize("undefined","undefined");if(kt(wt)){var qt="'"+JSON.stringify(wt).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return dt.stylize(qt,"string")}if(At(wt))return dt.stylize(""+wt,"number");if(gt(wt))return dt.stylize(""+wt,"boolean");if(Et(wt))return dt.stylize("null","null")}function ct(dt){return"["+Error.prototype.toString.call(dt)+"]"}function ut(dt,wt,qt,Pt,Gt){for(var Wt=[],Vt=0,Ut=wt.length;Vt<Ut;++Vt)$t(wt,String(Vt))?Wt.push(ft(dt,wt,qt,Pt,String(Vt),!0)):Wt.push("");return Gt.forEach(function(Mt){Mt.match(/^\d+$/)||Wt.push(ft(dt,wt,qt,Pt,Mt,!0))}),Wt}function ft(dt,wt,qt,Pt,Gt,Wt){var Vt,Ut,Mt;if(Mt=Object.getOwnPropertyDescriptor(wt,Gt)||{value:wt[Gt]},Mt.get?Mt.set?Ut=dt.stylize("[Getter/Setter]","special"):Ut=dt.stylize("[Getter]","special"):Mt.set&&(Ut=dt.stylize("[Setter]","special")),$t(Pt,Gt)||(Vt="["+Gt+"]"),Ut||(dt.seen.indexOf(Mt.value)<0?(Et(qt)?Ut=ot(dt,Mt.value,null):Ut=ot(dt,Mt.value,qt-1),Ut.indexOf(`
`)>-1&&(Wt?Ut=Ut.split(`
`).map(function(Lt){return"  "+Lt}).join(`
`).slice(2):Ut=`
`+Ut.split(`
`).map(function(Lt){return"   "+Lt}).join(`
`))):Ut=dt.stylize("[Circular]","special")),Tt(Vt)){if(Wt&&Gt.match(/^\d+$/))return Ut;Vt=JSON.stringify(""+Gt),Vt.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Vt=Vt.slice(1,-1),Vt=dt.stylize(Vt,"name")):(Vt=Vt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Vt=dt.stylize(Vt,"string"))}return Vt+": "+Ut}function ht(dt,wt,qt){var Pt=dt.reduce(function(Gt,Wt){return Wt.indexOf(`
`)>=0,Gt+Wt.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Pt>60?qt[0]+(wt===""?"":wt+`
 `)+" "+dt.join(`,
  `)+" "+qt[1]:qt[0]+wt+" "+dt.join(", ")+" "+qt[1]}_.types=types$1;function mt(dt){return Array.isArray(dt)}_.isArray=mt;function gt(dt){return typeof dt=="boolean"}_.isBoolean=gt;function Et(dt){return dt===null}_.isNull=Et;function St(dt){return dt==null}_.isNullOrUndefined=St;function At(dt){return typeof dt=="number"}_.isNumber=At;function kt(dt){return typeof dt=="string"}_.isString=kt;function Rt(dt){return typeof dt=="symbol"}_.isSymbol=Rt;function Tt(dt){return dt===void 0}_.isUndefined=Tt;function Dt(dt){return Ot(dt)&&lt(dt)==="[object RegExp]"}_.isRegExp=Dt,_.types.isRegExp=Dt;function Ot(dt){return typeof dt=="object"&&dt!==null}_.isObject=Ot;function jt(dt){return Ot(dt)&&lt(dt)==="[object Date]"}_.isDate=jt,_.types.isDate=jt;function Nt(dt){return Ot(dt)&&(lt(dt)==="[object Error]"||dt instanceof Error)}_.isError=Nt,_.types.isNativeError=Nt;function It(dt){return typeof dt=="function"}_.isFunction=It;function yt(dt){return dt===null||typeof dt=="boolean"||typeof dt=="number"||typeof dt=="string"||typeof dt=="symbol"||typeof dt>"u"}_.isPrimitive=yt,_.isBuffer=isBufferBrowser;function lt(dt){return Object.prototype.toString.call(dt)}function pt(dt){return dt<10?"0"+dt.toString(10):dt.toString(10)}var bt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _t(){var dt=new Date,wt=[pt(dt.getHours()),pt(dt.getMinutes()),pt(dt.getSeconds())].join(":");return[dt.getDate(),bt[dt.getMonth()],wt].join(" ")}_.log=function(){console.log("%s - %s",_t(),_.format.apply(_,arguments))},_.inherits=inherits_browserExports,_._extend=function(dt,wt){if(!wt||!Ot(wt))return dt;for(var qt=Object.keys(wt),Pt=qt.length;Pt--;)dt[qt[Pt]]=wt[qt[Pt]];return dt};function $t(dt,wt){return Object.prototype.hasOwnProperty.call(dt,wt)}var Ct=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;_.promisify=function(wt){if(typeof wt!="function")throw new TypeError('The "original" argument must be of type Function');if(Ct&&wt[Ct]){var qt=wt[Ct];if(typeof qt!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(qt,Ct,{value:qt,enumerable:!1,writable:!1,configurable:!0}),qt}function qt(){for(var Pt,Gt,Wt=new Promise(function(Mt,Lt){Pt=Mt,Gt=Lt}),Vt=[],Ut=0;Ut<arguments.length;Ut++)Vt.push(arguments[Ut]);Vt.push(function(Mt,Lt){Mt?Gt(Mt):Pt(Lt)});try{wt.apply(this,Vt)}catch(Mt){Gt(Mt)}return Wt}return Object.setPrototypeOf(qt,Object.getPrototypeOf(wt)),Ct&&Object.defineProperty(qt,Ct,{value:qt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(qt,o(wt))},_.promisify.custom=Ct;function xt(dt,wt){if(!dt){var qt=new Error("Promise was rejected with a falsy value");qt.reason=dt,dt=qt}return wt(dt)}function vt(dt){if(typeof dt!="function")throw new TypeError('The "original" argument must be of type Function');function wt(){for(var qt=[],Pt=0;Pt<arguments.length;Pt++)qt.push(arguments[Pt]);var Gt=qt.pop();if(typeof Gt!="function")throw new TypeError("The last argument must be of type Function");var Wt=this,Vt=function(){return Gt.apply(Wt,arguments)};dt.apply(this,qt).then(function(Ut){browserExports$3.nextTick(Vt.bind(null,null,Ut))},function(Ut){browserExports$3.nextTick(xt.bind(null,Ut,Vt))})}return Object.setPrototypeOf(wt,Object.getPrototypeOf(dt)),Object.defineProperties(wt,o(dt)),wt}_.callbackify=vt})(util$9);const fs$1=require$$0$1,format$6=util$9.format,EventEmitter$4=eventsExports.EventEmitter;let isElectronRenderer$1=browserExports$3.type&&browserExports$3.type==="renderer",isNodejs=!!(!isElectronRenderer$1&&browserExports$3.version);const LogLevels$1={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"};let GlobalLogLevel=LogLevels$1.DEBUG,GlobalLogfile=null,GlobalEvents=new EventEmitter$4,Colors={Black:0,Red:1,Green:2,Yellow:3,Blue:4,Magenta:5,Cyan:6,Grey:7,White:9,Default:9};isNodejs||(Colors={Black:"Black",Red:"IndianRed",Green:"LimeGreen",Yellow:"Orange",Blue:"RoyalBlue",Magenta:"Orchid",Cyan:"SkyBlue",Grey:"DimGrey",White:"White",Default:"Black"});const loglevelColors=[Colors.Cyan,Colors.Green,Colors.Yellow,Colors.Red,Colors.Default],defaultOptions$n={useColors:!0,color:Colors.Default,showTimestamp:!0,useLocalTime:!1,showLevel:!0,filename:GlobalLogfile,appendFile:!0};let Logger$1=class{constructor(o,$){this.category=o;let j={};Object.assign(j,defaultOptions$n),Object.assign(j,$),this.options=j,this.debug=this.debug.bind(this),this.log=this.log.bind(this),this.info=this.info.bind(this),this.warn=this.warn.bind(this),this.error=this.error.bind(this)}debug(){this._shouldLog(LogLevels$1.DEBUG)&&this._write(LogLevels$1.DEBUG,format$6.apply(null,arguments))}log(){this._shouldLog(LogLevels$1.DEBUG)&&this.debug.apply(this,arguments)}info(){this._shouldLog(LogLevels$1.INFO)&&this._write(LogLevels$1.INFO,format$6.apply(null,arguments))}warn(){this._shouldLog(LogLevels$1.WARN)&&this._write(LogLevels$1.WARN,format$6.apply(null,arguments))}error(){this._shouldLog(LogLevels$1.ERROR)&&this._write(LogLevels$1.ERROR,format$6.apply(null,arguments))}_write(o,$){(this.options.filename||GlobalLogfile)&&!this.fileWriter&&isNodejs&&(this.fileWriter=fs$1.openSync(this.options.filename||GlobalLogfile,this.options.appendFile?"a+":"w+"));let j=this._format(o,$),et=this._createLogMessage(o,$),tt=this._createLogMessage(o,$,j.timestamp,j.level,j.category,j.text);this.fileWriter&&isNodejs&&fs$1.writeSync(this.fileWriter,et+`
`,null,"utf-8"),isNodejs||!this.options.useColors?(console.log(tt),GlobalEvents.emit("data",this.category,o,$)):o===LogLevels$1.ERROR?this.options.showTimestamp&&this.options.showLevel?console.error(tt,j.timestamp,j.level,j.category,j.text):this.options.showTimestamp&&!this.options.showLevel?console.error(tt,j.timestamp,j.category,j.text):!this.options.showTimestamp&&this.options.showLevel?console.error(tt,j.level,j.category,j.text):console.error(tt,j.category,j.text):this.options.showTimestamp&&this.options.showLevel?console.log(tt,j.timestamp,j.level,j.category,j.text):this.options.showTimestamp&&!this.options.showLevel?console.log(tt,j.timestamp,j.category,j.text):!this.options.showTimestamp&&this.options.showLevel?console.log(tt,j.level,j.category,j.text):console.log(tt,j.category,j.text)}_format(o,$){let j="",et="",tt="",rt=": ";if(this.options.useColors){const nt=Object.keys(LogLevels$1).map(st=>LogLevels$1[st]).indexOf(o),it=this.options.color;isNodejs?(this.options.showTimestamp&&(j="\x1B[3"+Colors.Grey+"m"),this.options.showLevel&&(et="\x1B[3"+loglevelColors[nt]+";22m"),tt="\x1B[3"+it+";1m",rt="\x1B[0m: "):(this.options.showTimestamp&&(j="color:"+Colors.Grey),this.options.showLevel&&(et="color:"+loglevelColors[nt]),tt="color:"+it+"; font-weight: bold")}return{timestamp:j,level:et,category:tt,text:rt}}_createLogMessage(o,$,j,et,tt,rt){j=j||"",et=et||"",tt=tt||"",rt=rt||": ",!isNodejs&&this.options.useColors&&(this.options.showTimestamp&&(j="%c"),this.options.showLevel&&(et="%c"),tt="%c",rt=": %c");let nt="";return this.options.showTimestamp&&!this.options.useLocalTime&&(nt+=""+new Date().toISOString()+" "),this.options.showTimestamp&&this.options.useLocalTime&&(nt+=""+new Date().toLocaleString()+" "),nt=j+nt,this.options.showLevel&&(nt+=et+"["+o+"]"+(o===LogLevels$1.INFO||o===LogLevels$1.WARN?" ":"")+" "),nt+=tt+this.category,nt+=rt+$,nt}_shouldLog(o){let $=typeof browserExports$3<"u"&&browserExports$3.env!==void 0&&{}.LOG!==void 0?{}.LOG.toUpperCase():null;$=typeof window<"u"&&window.LOG?window.LOG.toUpperCase():$;const j=$||GlobalLogLevel,et=Object.keys(LogLevels$1).map(nt=>LogLevels$1[nt]),tt=et.indexOf(o),rt=et.indexOf(j);return tt>=rt}};var src$8={Colors,LogLevels:LogLevels$1,setLogLevel:_=>{GlobalLogLevel=_},setLogfile:_=>{GlobalLogfile=_},create:(_,o)=>new Logger$1(_,o),forceBrowserMode:_=>isNodejs=!_,events:GlobalEvents};const logger$p=src$8.create("orbit-db.store",{color:src$8.Colors.Blue});src$8.setLogLevel("ERROR");const DefaultOptions={Index,maxHistory:-1,fetchEntryTimeout:null,referenceCount:32,replicationConcurrency:32,syncLocal:!1,sortFn:void 0};class Store{constructor(o,$,j,et){if(!$)throw new Error("Identity required");const tt=Object.assign({},DefaultOptions);Object.assign(tt,et),this.options=tt,this._type="store",this.id=j.toString(),this.identity=$,this.address=j,this.dbname=j.path||"",this.events=new eventsExports.EventEmitter,this.remoteHeadsPath=pathBrowserify.join(this.id,"_remoteHeads"),this.localHeadsPath=pathBrowserify.join(this.id,"_localHeads"),this.snapshotPath=pathBrowserify.join(this.id,"snapshot"),this.queuePath=pathBrowserify.join(this.id,"queue"),this.manifestPath=pathBrowserify.join(this.id,"_manifest"),this._ipfs=o,this._cache=et.cache;const rt={canAppend:nt=>nt.identity.publicKey===$.publicKey};this.access=et.accessController||rt,this._oplog=new Log(this._ipfs,this.identity,{logId:this.id,access:this.access,sortFn:this.options.sortFn}),this._queue=new PQueue({concurrency:1}),this._index=new this.options.Index(this.address.root),this._replicationStatus=new ReplicationInfo,this._stats={snapshot:{bytesLoaded:-1},syncRequestsReceieved:0};try{const nt=async ot=>{this._recalculateReplicationMax(ot.clock?ot.clock.time:0),this.events.emit("replicate",this.address.toString(),ot)},it=async ot=>{const at=this.replicationStatus.progress,ct=this.replicationStatus.max;this._recalculateReplicationStatus(ot.clock.time),(this._oplog.length+1>this.replicationStatus.progress||this.replicationStatus.progress>at||this.replicationStatus.max>ct)&&this.events.emit("replicate.progress",this.address.toString(),ot.hash,ot,this.replicationStatus.progress,this.replicationStatus.max)},st=async ot=>{const at=async()=>{try{if(this._oplog&&ot.length>0){for(const ut of ot)await this._oplog.join(ut);const ct=this._oplog.heads;await this._cache.set(this.remoteHeadsPath,ct),logger$p.debug(`Saved heads ${ct.length} [${ct.map(ut=>ut.hash).join(", ")}]`),await this._updateIndex(),this._oplog.length>this.replicationStatus.progress&&this._recalculateReplicationStatus(this._oplog.length),this.events.emit("replicated",this.address.toString(),ot.length,this)}}catch(ct){console.error(ct)}};await this._queue.add(at.bind(this))};this._replicator=new Replicator(this,this.options.replicationConcurrency),this._loader=this._replicator,this._replicator.onReplicationQueued=nt,this._replicator.onReplicationProgress=it,this._replicator.onReplicationComplete=st}catch(nt){console.error("Store Error:",nt)}this.events.on("replicated.progress",(nt,it,st,ot,at)=>{this._procEntry(st)}),this.events.on("write",(nt,it,st)=>{this._procEntry(it)})}get all(){return Array.isArray(this._index._index)?this._index._index:Object.keys(this._index._index).map(o=>this._index._index[o])}get index(){return this._index._index}get type(){return this._type}get key(){return this._key}get replicationStatus(){return this._replicationStatus}setIdentity(o){this.identity=o,this._oplog.setIdentity(o)}async close(){await this._replicator.stop(),await this._queue.onIdle(),this._replicationStatus.reset(),this._stats={snapshot:{bytesLoaded:-1},syncRequestsReceieved:0},this.options.onClose&&await this.options.onClose(this),this.access.close&&await this.access.close();for(const o in this.events._events)this.events.removeAllListeners(o);return this._oplog=null,this.events.emit("closed",this.address.toString()),Promise.resolve()}async drop(){this.options.onDrop&&await this.options.onDrop(this),await this._cache.del(this.localHeadsPath),await this._cache.del(this.remoteHeadsPath),await this._cache.del(this.snapshotPath),await this._cache.del(this.queuePath),await this._cache.del(this.manifestPath),await this.close(),this._index=new this.options.Index(this.address.root),this._oplog=new Log(this._ipfs,this.identity,{logId:this.id,access:this.access,sortFn:this.options.sortFn}),this._cache=this.options.cache}async load(o,$={}){typeof o=="object"&&($=o,o=void 0),o=o||this.options.maxHistory;const j=$.fetchEntryTimeout||this.options.fetchEntryTimeout;this.options.onLoad&&await this.options.onLoad(this);const et=await this._cache.get(this.localHeadsPath)||[],tt=await this._cache.get(this.remoteHeadsPath)||[],rt=et.concat(tt);rt.length>0&&this.events.emit("load",this.address.toString(),rt),rt.forEach(it=>this._recalculateReplicationMax(it.clock.time));const nt=await Log.fromEntryHash(this._ipfs,this.identity,rt.map(it=>it.hash),{logId:this.id,access:this.access,sortFn:this.options.sortFn,length:o,onProgressCallback:this._onLoadProgress.bind(this),timeout:j,concurrency:this.options.replicationConcurrency});this._oplog=nt,rt.length>0&&await this._updateIndex(),this.events.emit("ready",this.address.toString(),this._oplog.heads)}async sync(o){return this._stats.syncRequestsReceieved+=1,logger$p.debug(`Sync request #${this._stats.syncRequestsReceieved} ${o.length}`),o.length===0?void 0:pEachSeries(o,async j=>{if(!j)return console.warn("Warning: Given input entry was 'null'."),Promise.resolve(null);const et=this.identity.provider;if(!et)throw new Error("Identity-provider is required, cannot verify entry");if(!await this.access.canAppend(j,et))return console.warn("Warning: Given input entry is not allowed in this log and was discarded (no write access)."),Promise.resolve(null);const rt=Entry.toEntry(j);return await write$3(this._ipfs,getWriteFormat(rt),rt,{links:IPLD_LINKS$1,onlyHash:!0})!==j.hash&&console.warn(`"WARNING! Head hash didn't match the contents`),j}).then(async j=>this._replicator.load(j.filter(et=>et!==null)))}loadMoreFrom(o,$){this._replicator.load($)}async saveSnapshot(){const o=this._replicator.unfinished,$=this._oplog.toSnapshot(),j=buffer$2.Buffer.from(JSON.stringify({id:$.id,heads:$.heads,size:$.values.length,values:$.values,type:this.type})),et=await this._ipfs.add(j);return et.hash=et.cid.toString(),await this._cache.set(this.snapshotPath,et),await this._cache.set(this.queuePath,o),logger$p.debug(`Saved snapshot: ${et.hash}, queue length: ${o.length}`),[et]}async loadFromSnapshot(o){this.options.onLoad&&await this.options.onLoad(this),this.events.emit("load",this.address.toString());const $=(tt,rt)=>Math.max(tt,rt.clock.time),j=await this._cache.get(this.queuePath);this.sync(j||[]);const et=await this._cache.get(this.snapshotPath);if(et){const tt=[];for await(const it of this._ipfs.cat(et.hash))tt.push(it);const rt=buffer$2.Buffer.concat(tt),nt=JSON.parse(rt.toString());this._recalculateReplicationMax(nt.values.reduce($,0)),nt&&(this._oplog=await Log.fromJSON(this._ipfs,this.identity,nt,{access:this.access,sortFn:this.options.sortFn,length:-1,timeout:1e3,onProgressCallback:this._onLoadProgress.bind(this)}),await this._updateIndex(),this.events.emit("replicated",this.address.toString())),this.events.emit("ready",this.address.toString(),this._oplog.heads)}else throw new Error(`Snapshot for ${this.address} not found!`);return this}async _updateIndex(){await this._index.updateIndex(this._oplog)}async syncLocal(){const o=await this._cache.get(this.localHeadsPath)||[],$=await this._cache.get(this.remoteHeadsPath)||[],j=o.concat($);for(let et=0;et<j.length;et++){const tt=j[et];if(!this._oplog.heads.includes(tt)){await this.load();break}}}async _addOperation(o,{onProgressCallback:$,pin:j=!1}={}){async function et(){if(this._oplog){this.options.syncLocal&&await this.syncLocal();const tt=await this._oplog.append(o,this.options.referenceCount,j);return this._recalculateReplicationStatus(tt.clock.time),await this._cache.set(this.localHeadsPath,[tt]),await this._updateIndex(),this.events.emit("write",this.address.toString(),tt,this._oplog.heads),$&&$(tt),tt.hash}}return this._queue.add(et.bind(this))}_addOperationBatch(o,$,j,et){throw new Error("Not implemented!")}_procEntry(o){const{payload:$,hash:j}=o,{op:et}=$;et?this.events.emit(`log.op.${et}`,this.address.toString(),j,$):this.events.emit("log.op.none",this.address.toString(),j,$),this.events.emit("log.op",et,this.address.toString(),j,$)}_recalculateReplicationProgress(){this._replicationStatus.progress=Math.max(Math.min(this._replicationStatus.progress+1,this._replicationStatus.max),this._oplog?this._oplog.length:0)}_recalculateReplicationMax(o){this._replicationStatus.max=Math.max.apply(null,[this.replicationStatus.max,this._oplog?this._oplog.length:0,o||0])}_recalculateReplicationStatus(o){this._recalculateReplicationMax(o),this._recalculateReplicationProgress()}_onLoadProgress(o){this._recalculateReplicationStatus(o.clock.time),this.events.emit("load.progress",this.address.toString(),o.hash,o,this.replicationStatus.progress,this.replicationStatus.max)}}class EventIndex{constructor(){this._index=null}get(){return this._index?this._index.values:[]}updateIndex(o){this._index=o}}class EventStore extends Store{constructor(o,$,j,et={}){et.Index===void 0&&Object.assign(et,{Index:EventIndex}),super(o,$,j,et),this._type="eventlog",this.events.on("log.op.ADD",(tt,rt,nt)=>{this.events.emit("db.append",nt.value)})}add(o,$={}){return this._addOperation({op:"ADD",key:null,value:o},$)}get(o){return this.iterator({gte:o,limit:1}).collect()[0]}iterator(o){const $=this._query(o);let j=0;return{[Symbol.iterator](){return this},next(){let tt={value:null,done:!0};return j<$.length&&(tt={value:$[j],done:!1},j++),tt},collect:()=>$}}_query(o){o||(o={});const $=o.limit?o.limit>-1?o.limit:this._index.get().length:1,j=this._index.get().slice();let et=[];return o.gt||o.gte?et=this._read(j,o.gt?o.gt:o.gte,$,!!o.gte):et=this._read(j.reverse(),o.lt?o.lt:o.lte,$,o.lte||!o.lt).reverse(),o.reverse&&et.reverse(),et}_read(o,$,j,et){const tt=o.map(it=>it.hash).indexOf($);let rt=Math.max(tt,0);return rt+=et?0:1,o.slice(rt).slice(0,j)}}class FeedIndex{constructor(){this._index={}}get(){return Object.keys(this._index).map(o=>this._index[o])}updateIndex(o){this._index={},o.values.reduce(($,j)=>($.includes(j.hash)||($.push(j.hash),j.payload.op==="ADD"?this._index[j.hash]=j:j.payload.op==="DEL"&&delete this._index[j.payload.value]),$),[])}}class FeedStore extends EventStore{constructor(o,$,j,et){et||(et={}),et.Index||Object.assign(et,{Index:FeedIndex}),super(o,$,j,et),this._type="feed"}remove(o,$={}){return this.del(o,$)}del(o,$={}){const j={op:"DEL",key:null,value:o};return this._addOperation(j,$)}}class KeyValueIndex{constructor(){this._index={}}get(o){return this._index[o]}updateIndex(o){const $=o.values,j={};for(let et=$.length-1;et>=0;et--){const tt=$[et];if(!j[tt.payload.key]){if(j[tt.payload.key]=!0,tt.payload.op==="PUT"){this._index[tt.payload.key]=tt.payload.value;continue}if(tt.payload.op==="DEL"){delete this._index[tt.payload.key];continue}}}}}class KeyValueStore extends Store{constructor(o,$,j,et){const tt=Object.assign({},{Index:KeyValueIndex});Object.assign(tt,et),super(o,$,j,tt),this._type="keyvalue"}get all(){return this._index._index}get(o){return this._index.get(o)}set(o,$,j={}){return this.put(o,$,j)}put(o,$,j={}){return this._addOperation({op:"PUT",key:o,value:$},j)}del(o,$={}){return this._addOperation({op:"DEL",key:o,value:null},$)}}const deepEqual=(_,o)=>{const $=Object.getOwnPropertyNames(_),j=Object.getOwnPropertyNames(o);if($.length!==j.length)return!1;for(let et=0;et<$.length;et++){const tt=$[et];if(_[tt]!==o[tt])return!1}return!0},sum=(_,o)=>_+o;class GCounter{constructor(o,$){this.id=o,this._counters=$||{},this._counters[this.id]=this._counters[this.id]?this._counters[this.id]:0}get value(){return Object.values(this._counters).reduce(sum,0)}increment(o){o&&o<1||(o==null&&(o=1),this._counters[this.id]=this._counters[this.id]+o)}merge(o){Object.entries(o._counters).forEach(([$,j])=>{this._counters[$]=Math.max(this._counters[$]||0,j)})}toJSON(){return{id:this.id,counters:this._counters}}isEqual(o){return GCounter.isEqual(this,o)}static from(o){return new GCounter(o.id,o.counters)}static isEqual(o,$){return o.id!==$.id?!1:deepEqual(o._counters,$._counters)}}class CounterIndex{constructor(o){this._index=new GCounter(o)}get(){return this._index}updateIndex(o){if(this._index){const $=et=>et.payload.value.counters,j=et=>this._index.merge({_counters:et});o.values.filter(et=>et&&et.payload.op==="COUNTER").map($).forEach(j)}}}class CounterStore extends Store{constructor(o,$,j,et={}){et.Index||Object.assign(et,{Index:CounterIndex}),super(o,$,j,et),this._index=new this.options.Index(this.identity.publicKey),this._type="counter"}get value(){return this._index.get().value}inc(o,$={}){const j=new GCounter(this.identity.publicKey,Object.assign({},this._index.get()._counters));return j.increment(o),this._addOperation({op:"COUNTER",key:null,value:j.toJSON()},$)}}class DocumentIndex{constructor(){this._index={}}get(o,$=!1){return $?this._index[o]:this._index[o]?this._index[o].payload.value:null}updateIndex(o,$){const j=(et,tt,rt)=>{if(tt.payload.op==="PUTALL"&&tt.payload.docs[Symbol.iterator])for(const nt of tt.payload.docs)nt&&et[nt.key]!==!0&&(et[nt.key]=!0,this._index[nt.key]={payload:{op:"PUT",key:nt.key,value:nt.value}});else et[tt.payload.key]!==!0&&(et[tt.payload.key]=!0,tt.payload.op==="PUT"?this._index[tt.payload.key]=tt:tt.payload.op==="DEL"&&delete this._index[tt.payload.key]);return $&&$(tt,rt),et};o.values.slice().reverse().reduce(j,{})}}var pMap=(_,o,$)=>new Promise((j,et)=>{$=Object.assign({concurrency:1/0},$);const tt=$.concurrency;if(tt<1)throw new TypeError("Expected `concurrency` to be a number from 1 and up");const rt=[],nt=_[Symbol.iterator]();let it=!1,st=!1,ot=0,at=0;const ct=()=>{if(it)return;const ut=nt.next(),ft=at;if(at++,ut.done){st=!0,ot===0&&j(rt);return}ot++,Promise.resolve(ut.value).then(ht=>o(ht,ft)).then(ht=>{rt[ft]=ht,ot--,ct()},ht=>{it=!0,et(ht)})};for(let ut=0;ut<tt&&(ct(),!st);ut++);});const replaceAll=(_,o,$)=>_.toString().split(o).join($);class DocumentStore extends Store{constructor(o,$,j,et){et||(et={}),et.indexBy||Object.assign(et,{indexBy:"_id"}),et.Index||Object.assign(et,{Index:DocumentIndex}),super(o,$,j,et),this._type="docstore"}get(o,$=!1){o=o.toString();const j=o.split(" ");o=j.length>1?replaceAll(o,"."," ").toLowerCase():o.toLowerCase();const et=nt=>j.length>1?replaceAll(nt,"."," ").toLowerCase().indexOf(o)!==-1:nt.toLowerCase().indexOf(o)!==-1,tt=nt=>this._index.get(nt),rt=nt=>$?nt.indexOf(o)!==-1:et(nt);return Object.keys(this._index._index).filter(rt).map(tt)}query(o,$={}){const j=$.fullOp||!1;return Object.keys(this._index._index).map(et=>this._index.get(et,j)).filter(o)}batchPut(o,$){return pMap(o,(et,tt)=>this._addOperationBatch({op:"PUT",key:et[this.options.indexBy],value:et},!0,tt===o.length-1,$),{concurrency:1}).then(()=>this.saveSnapshot())}put(o,$={}){if(!o[this.options.indexBy])throw new Error(`The provided document doesn't contain field '${this.options.indexBy}'`);return this._addOperation({op:"PUT",key:o[this.options.indexBy],value:o},$)}putAll(o,$={}){if(Array.isArray(o)||(o=[o]),!o.every(j=>j[this.options.indexBy]))throw new Error(`The provided document doesn't contain field '${this.options.indexBy}'`);return this._addOperation({op:"PUTALL",docs:o.map(j=>({key:j[this.options.indexBy],value:j}))},$)}del(o,$={}){if(!this._index.get(o))throw new Error(`No entry with key '${o}' in the database`);return this._addOperation({op:"DEL",key:o,value:null},$)}}var pReduce$1=(_,o,$)=>new Promise((j,et)=>{const tt=_[Symbol.iterator]();let rt=0;const nt=it=>{const st=tt.next();if(st.done){j(it);return}Promise.all([it,st.value]).then(ot=>{nt(o(ot[0],ot[1],rt++))}).catch(et)};nt($)}),distExports={},dist$1={get exports(){return distExports},set exports(_){distExports=_}};(function(_,o){Object.defineProperty(o,"__esModule",{value:!0});const $=util$9,j=Object.prototype.toString,et=it=>st=>typeof st===it,tt=it=>{const st=j.call(it).slice(8,-1);return st||null},rt=it=>st=>tt(st)===it;function nt(it){if(it===null)return"null";if(it===!0||it===!1)return"boolean";const st=typeof it;if(st==="undefined")return"undefined";if(st==="string")return"string";if(st==="number")return"number";if(st==="symbol")return"symbol";if(nt.function_(it))return"Function";if(Array.isArray(it))return"Array";if(buffer$2.Buffer.isBuffer(it))return"Buffer";const ot=tt(it);if(ot)return ot;if(it instanceof String||it instanceof Boolean||it instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}(function(it){const st=Ot=>typeof Ot=="object";it.undefined=et("undefined"),it.string=et("string"),it.number=et("number"),it.function_=et("function"),it.null_=Ot=>Ot===null,it.class_=Ot=>it.function_(Ot)&&Ot.toString().startsWith("class "),it.boolean=Ot=>Ot===!0||Ot===!1,it.symbol=et("symbol"),it.array=Array.isArray,it.buffer=buffer$2.Buffer.isBuffer,it.nullOrUndefined=Ot=>it.null_(Ot)||it.undefined(Ot),it.object=Ot=>!it.nullOrUndefined(Ot)&&(it.function_(Ot)||st(Ot)),it.iterable=Ot=>!it.nullOrUndefined(Ot)&&it.function_(Ot[Symbol.iterator]),it.generator=Ot=>it.iterable(Ot)&&it.function_(Ot.next)&&it.function_(Ot.throw),it.nativePromise=rt("Promise");const ot=Ot=>!it.null_(Ot)&&st(Ot)&&it.function_(Ot.then)&&it.function_(Ot.catch);it.promise=Ot=>it.nativePromise(Ot)||ot(Ot);const at=Ot=>jt=>it.function_(jt)&&it.function_(jt.constructor)&&jt.constructor.name===Ot;it.generatorFunction=at("GeneratorFunction"),it.asyncFunction=at("AsyncFunction"),it.boundFunction=Ot=>it.function_(Ot)&&!Ot.hasOwnProperty("prototype"),it.regExp=rt("RegExp"),it.date=rt("Date"),it.error=rt("Error"),it.map=rt("Map"),it.set=rt("Set"),it.weakMap=rt("WeakMap"),it.weakSet=rt("WeakSet"),it.int8Array=rt("Int8Array"),it.uint8Array=rt("Uint8Array"),it.uint8ClampedArray=rt("Uint8ClampedArray"),it.int16Array=rt("Int16Array"),it.uint16Array=rt("Uint16Array"),it.int32Array=rt("Int32Array"),it.uint32Array=rt("Uint32Array"),it.float32Array=rt("Float32Array"),it.float64Array=rt("Float64Array"),it.arrayBuffer=rt("ArrayBuffer"),it.sharedArrayBuffer=rt("SharedArrayBuffer"),it.dataView=rt("DataView"),it.directInstanceOf=(Ot,jt)=>it.object(Ot)&&it.object(jt)&&Object.getPrototypeOf(Ot)===jt.prototype,it.truthy=Ot=>!!Ot,it.falsy=Ot=>!Ot,it.nan=Ot=>Number.isNaN(Ot);const ct=new Set(["undefined","string","number","boolean","symbol"]);it.primitive=Ot=>it.null_(Ot)||ct.has(typeof Ot),it.integer=Ot=>Number.isInteger(Ot),it.safeInteger=Ot=>Number.isSafeInteger(Ot),it.plainObject=Ot=>{let jt;return tt(Ot)==="Object"&&(jt=Object.getPrototypeOf(Ot),jt===null||jt===Object.getPrototypeOf({}))};const ut=new Set(["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"]);it.typedArray=Ot=>{const jt=tt(Ot);return jt===null?!1:ut.has(jt)};const ft=Ot=>it.safeInteger(Ot)&&Ot>-1;it.arrayLike=Ot=>!it.nullOrUndefined(Ot)&&!it.function_(Ot)&&ft(Ot.length),it.inRange=(Ot,jt)=>{if(it.number(jt))return Ot>=Math.min(0,jt)&&Ot<=Math.max(jt,0);if(it.array(jt)&&jt.length===2)return Ot>=Math.min.apply(null,jt)&&Ot<=Math.max.apply(null,jt);throw new TypeError(`Invalid range: ${$.inspect(jt)}`)};const ht=1,mt=["innerHTML","ownerDocument","style","attributes","nodeValue"];it.domElement=Ot=>it.object(Ot)&&Ot.nodeType===ht&&it.string(Ot.nodeName)&&!it.plainObject(Ot)&&mt.every(jt=>jt in Ot),it.nodeStream=Ot=>!it.nullOrUndefined(Ot)&&st(Ot)&&it.function_(Ot.pipe),it.infinite=Ot=>Ot===1/0||Ot===-1/0;const gt=Ot=>jt=>it.integer(jt)&&Math.abs(jt%2)===Ot;it.even=gt(0),it.odd=gt(1);const Et=Ot=>it.string(Ot)&&/\S/.test(Ot)===!1,St=Ot=>(it.string(Ot)||it.array(Ot))&&Ot.length===0,At=Ot=>!it.map(Ot)&&!it.set(Ot)&&it.object(Ot)&&Object.keys(Ot).length===0,kt=Ot=>(it.map(Ot)||it.set(Ot))&&Ot.size===0;it.empty=Ot=>it.falsy(Ot)||St(Ot)||At(Ot)||kt(Ot),it.emptyOrWhitespace=Ot=>it.empty(Ot)||Et(Ot);const Rt=(Ot,jt,Nt)=>{const It=Array.prototype.slice.call(Nt,1);if(it.function_(jt)===!1)throw new TypeError(`Invalid predicate: ${$.inspect(jt)}`);if(It.length===0)throw new TypeError("Invalid number of values");return Ot.call(It,jt)};function Tt(Ot){return Rt(Array.prototype.some,Ot,arguments)}it.any=Tt;function Dt(Ot){return Rt(Array.prototype.every,Ot,arguments)}it.all=Dt})(nt||(nt={})),Object.defineProperties(nt,{class:{value:nt.class_},function:{value:nt.function_},null:{value:nt.null_}}),o.default=nt,_.exports=nt,_.exports.default=nt})(dist$1,distExports);const pReduce=pReduce$1,is=distExports;var pSeries=_=>{const o=[];for(const $ of _){const j=is($);if(j!=="Function")return Promise.reject(new TypeError(`Expected task to be a \`Function\`, received \`${j}\``))}return pReduce(_,($,j)=>Promise.resolve().then(j).then(et=>{o.push(et)})).then(()=>o)};const difference=(_,o)=>new Set([..._].filter($=>!o.has($))),DEFAULT_OPTIONS={start:!0,pollInterval:1e3};class IpfsPubsubPeerMonitor extends eventsExports{constructor(o,$,j){super(),this._pubsub=o,this._topic=$,this._options=Object.assign({},DEFAULT_OPTIONS,j),this._peers=[],this._interval=null,this._options.start&&this.start()}get started(){return this._interval!==null}set started(o){throw new Error("'started' is read-only")}start(){this._interval&&this.stop(),this._interval=setInterval(this._pollPeers.bind(this),this._options.pollInterval),this._pollPeers()}stop(){clearInterval(this._interval),this._interval=null,this.removeAllListeners("error"),this.removeAllListeners("join"),this.removeAllListeners("leave")}async getPeers(){return this._peers=await this._pubsub.peers(this._topic),this._peers.slice()}hasPeer(o){return this._peers.includes(o)}async _pollPeers(){try{const o=await this._pubsub.peers(this._topic);IpfsPubsubPeerMonitor._emitJoinsAndLeaves(new Set(this._peers),new Set(o),this),this._peers=o}catch(o){clearInterval(this._interval),this.emit("error",o)}}static _emitJoinsAndLeaves(o,$,j){const et=rt=>j.emit("join",rt),tt=rt=>j.emit("leave",rt);difference($,o).forEach(et),difference(o,$).forEach(tt)}}const logger$o=src$8.create("pubsub",{color:src$8.Colors.Yellow});src$8.setLogLevel("ERROR");const maxTopicsOpen=256;let topicsOpenCount=0;class IPFSPubsub{constructor(o,$){this._ipfs=o,this._id=$,this._subscriptions={},this._ipfs.pubsub===null&&logger$o.error("The provided version of ipfs doesn't have pubsub support. Messages will not be exchanged."),this._handleMessage=this._handleMessage.bind(this),this._ipfs.setMaxListeners&&this._ipfs.setMaxListeners(maxTopicsOpen)}async subscribe(o,$,j,et={}){if(!this._subscriptions[o]&&this._ipfs.pubsub){await this._ipfs.pubsub.subscribe(o,this._handleMessage,et);const tt=new IpfsPubsubPeerMonitor(this._ipfs.pubsub,o);tt.on("join",rt=>{logger$o.debug(`Peer joined ${o}:`),logger$o.debug(rt),this._subscriptions[o]?j(o,rt):(logger$o.warn("Peer joined a room we don't have a subscription for"),logger$o.warn(o,rt))}),tt.on("leave",rt=>logger$o.debug(`Peer ${rt} left ${o}`)),tt.on("error",rt=>logger$o.error(rt)),this._subscriptions[o]={topicMonitor:tt,onMessage:$,onNewPeer:j},topicsOpenCount++,logger$o.debug("Topics open:",topicsOpenCount)}}async unsubscribe(o){this._subscriptions[o]&&(await this._ipfs.pubsub.unsubscribe(o,this._handleMessage),this._subscriptions[o].topicMonitor.stop(),delete this._subscriptions[o],logger$o.debug(`Unsubscribed from '${o}'`),topicsOpenCount--,logger$o.debug("Topics open:",topicsOpenCount))}publish(o,$,j={}){if(this._subscriptions[o]&&this._ipfs.pubsub){let et;buffer$2.Buffer.isBuffer($)||typeof $=="string"?et=$:et=JSON.stringify($),this._ipfs.pubsub.publish(o,buffer$2.Buffer.from(et),j)}}async disconnect(){const o=Object.keys(this._subscriptions);await pSeries(o.map($=>this.unsubscribe.bind(this,$))),this._subscriptions={}}async _handleMessage(o){if(String(o.from)===this._id)return;let $;const j=o.topic?o.topic:o.topicIDs[0];try{$=JSON.parse(buffer$2.Buffer.from(o.data).toString())}catch{$=o.data}const et=this._subscriptions[j];et&&et.onMessage&&$&&await et.onMessage(j,$,o.from)}}const logger$n=src$8.create("cache",{color:src$8.Colors.Magenta});src$8.setLogLevel("ERROR");class Cache{constructor(o){this._store=o}get status(){return this._store.status}async close(){if(!this._store)throw new Error("No cache store found to close");this.status==="open"&&await this._store.close()}async open(){if(!this._store)throw new Error("No cache store found to open");this.status!=="open"&&await this._store.open()}async get(o){try{return JSON.parse(await this._store.get(o))}catch($){if($.code==="LEVEL_NOT_FOUND"||$.cause!==void 0&&$.cause.code==="LEVEL_NOT_FOUND")return null;throw $}}async set(o,$){await this._store.put(o,JSON.stringify($)),logger$n.debug(`cache: Set ${o} to ${JSON.stringify($)}`)}load(){}destroy(){}async del(o){await this._store.del(o)}}var browserLevel={},abstractLevel$1={},abstractLevel={},levelSupports={};levelSupports.supports=function(...o){const $=o.reduce((j,et)=>Object.assign(j,et),{});return Object.assign($,{snapshots:$.snapshots||!1,permanence:$.permanence||!1,seek:$.seek||!1,clear:$.clear||!1,getMany:$.getMany||!1,keyIterator:$.keyIterator||!1,valueIterator:$.valueIterator||!1,iteratorNextv:$.iteratorNextv||!1,iteratorAll:$.iteratorAll||!1,status:$.status||!1,createIfMissing:$.createIfMissing||!1,errorIfExists:$.errorIfExists||!1,deferredOpen:$.deferredOpen||!1,promises:$.promises||!1,streams:$.streams||!1,encodings:Object.assign({},$.encodings),events:Object.assign({},$.events),additionalMethods:Object.assign({},$.additionalMethods)})};var levelTranscoder={},moduleError=class extends Error{constructor(o,$){super(o||""),typeof $=="object"&&$!==null&&($.code&&(this.code=String($.code)),$.expected&&(this.expected=!0),$.transient&&(this.transient=!0),$.cause&&(this.cause=$.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},encodings$1={};let lazy=null;var textEndec$1=function(){return lazy===null&&(lazy={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),lazy},formats$2={},encoding={};const ModuleError$8=moduleError,formats$1=new Set(["buffer","view","utf8"]);let Encoding$2=class{constructor(o){if(this.encode=o.encode||this.encode,this.decode=o.decode||this.decode,this.name=o.name||this.name,this.format=o.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!formats$1.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");o.createViewTranscoder&&(this.createViewTranscoder=o.createViewTranscoder),o.createBufferTranscoder&&(this.createBufferTranscoder=o.createBufferTranscoder),o.createUTF8Transcoder&&(this.createUTF8Transcoder=o.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};encoding.Encoding=Encoding$2;const{Buffer:Buffer$1}=buffer$2||{},{Encoding:Encoding$1}=encoding,textEndec=textEndec$1;let BufferFormat$2=class extends Encoding$1{constructor(o){super({...o,format:"buffer"})}createViewTranscoder(){return new ViewFormat$2({encode:this.encode,decode:o=>this.decode(Buffer$1.from(o.buffer,o.byteOffset,o.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},ViewFormat$2=class extends Encoding$1{constructor(o){super({...o,format:"view"})}createBufferTranscoder(){return new BufferFormat$2({encode:o=>{const $=this.encode(o);return Buffer$1.from($.buffer,$.byteOffset,$.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},UTF8Format$2=class extends Encoding$1{constructor(o){super({...o,format:"utf8"})}createBufferTranscoder(){return new BufferFormat$2({encode:o=>Buffer$1.from(this.encode(o),"utf8"),decode:o=>this.decode(o.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:o,textDecoder:$}=textEndec();return new ViewFormat$2({encode:j=>o.encode(this.encode(j)),decode:j=>this.decode($.decode(j)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};formats$2.BufferFormat=BufferFormat$2;formats$2.ViewFormat=ViewFormat$2;formats$2.UTF8Format=UTF8Format$2;const{Buffer}=buffer$2||{Buffer:{isBuffer:()=>!1}},{textEncoder:textEncoder$2,textDecoder:textDecoder$1}=textEndec$1(),{BufferFormat:BufferFormat$1,ViewFormat:ViewFormat$1,UTF8Format:UTF8Format$1}=formats$2,identity$6=_=>_;encodings$1.utf8=new UTF8Format$1({encode:function(_){return Buffer.isBuffer(_)?_.toString("utf8"):ArrayBuffer.isView(_)?textDecoder$1.decode(_):String(_)},decode:identity$6,name:"utf8",createViewTranscoder(){return new ViewFormat$1({encode:function(_){return ArrayBuffer.isView(_)?_:textEncoder$2.encode(_)},decode:function(_){return textDecoder$1.decode(_)},name:`${this.name}+view`})},createBufferTranscoder(){return new BufferFormat$1({encode:function(_){return Buffer.isBuffer(_)?_:ArrayBuffer.isView(_)?Buffer.from(_.buffer,_.byteOffset,_.byteLength):Buffer.from(String(_),"utf8")},decode:function(_){return _.toString("utf8")},name:`${this.name}+buffer`})}});encodings$1.json=new UTF8Format$1({encode:JSON.stringify,decode:JSON.parse,name:"json"});encodings$1.buffer=new BufferFormat$1({encode:function(_){return Buffer.isBuffer(_)?_:ArrayBuffer.isView(_)?Buffer.from(_.buffer,_.byteOffset,_.byteLength):Buffer.from(String(_),"utf8")},decode:identity$6,name:"buffer",createViewTranscoder(){return new ViewFormat$1({encode:function(_){return ArrayBuffer.isView(_)?_:Buffer.from(String(_),"utf8")},decode:function(_){return Buffer.from(_.buffer,_.byteOffset,_.byteLength)},name:`${this.name}+view`})}});encodings$1.view=new ViewFormat$1({encode:function(_){return ArrayBuffer.isView(_)?_:textEncoder$2.encode(_)},decode:identity$6,name:"view",createBufferTranscoder(){return new BufferFormat$1({encode:function(_){return Buffer.isBuffer(_)?_:ArrayBuffer.isView(_)?Buffer.from(_.buffer,_.byteOffset,_.byteLength):Buffer.from(String(_),"utf8")},decode:identity$6,name:`${this.name}+buffer`})}});encodings$1.hex=new BufferFormat$1({encode:function(_){return Buffer.isBuffer(_)?_:Buffer.from(String(_),"hex")},decode:function(_){return _.toString("hex")},name:"hex"});encodings$1.base64=new BufferFormat$1({encode:function(_){return Buffer.isBuffer(_)?_:Buffer.from(String(_),"base64")},decode:function(_){return _.toString("base64")},name:"base64"});const ModuleError$7=moduleError,encodings=encodings$1,{Encoding}=encoding,{BufferFormat,ViewFormat,UTF8Format}=formats$2,kFormats=Symbol("formats"),kEncodings=Symbol("encodings"),validFormats=new Set(["buffer","view","utf8"]);let Transcoder$1=class{constructor(o){if(Array.isArray(o)){if(!o.every($=>validFormats.has($)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[kEncodings]=new Map,this[kFormats]=new Set(o);for(const $ in encodings)try{this.encoding($)}catch(j){if(j.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw j}}encodings(){return Array.from(new Set(this[kEncodings].values()))}encoding(o){let $=this[kEncodings].get(o);if($===void 0){if(typeof o=="string"&&o!==""){if($=lookup$2[o],!$)throw new ModuleError$7(`Encoding '${o}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof o!="object"||o===null)throw new TypeError("First argument 'encoding' must be a string or object");$=from$6(o)}const{name:j,format:et}=$;if(!this[kFormats].has(et))if(this[kFormats].has("view"))$=$.createViewTranscoder();else if(this[kFormats].has("buffer"))$=$.createBufferTranscoder();else if(this[kFormats].has("utf8"))$=$.createUTF8Transcoder();else throw new ModuleError$7(`Encoding '${j}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const tt of[o,j,$.name,$.commonName])this[kEncodings].set(tt,$)}return $}};levelTranscoder.Transcoder=Transcoder$1;function from$6(_){if(_ instanceof Encoding)return _;const o="type"in _&&typeof _.type=="string"?_.type:void 0,$=_.name||o||`anonymous-${anonymousCount++}`;switch(detectFormat(_)){case"view":return new ViewFormat({..._,name:$});case"utf8":return new UTF8Format({..._,name:$});case"buffer":return new BufferFormat({..._,name:$});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function detectFormat(_){return"format"in _&&_.format!==void 0?_.format:"buffer"in _&&typeof _.buffer=="boolean"?_.buffer?"buffer":"utf8":"code"in _&&Number.isInteger(_.code)?"view":"buffer"}const aliases={binary:encodings.buffer,"utf-8":encodings.utf8},lookup$2={...encodings,...aliases};let anonymousCount=0;var catering={},nextTickBrowser$1=typeof queueMicrotask=="function"?queueMicrotask:_=>Promise.resolve().then(_),nextTick$1=nextTickBrowser$1;catering.fromCallback=function(_,o){if(_===void 0){var $=new Promise(function(j,et){_=function(tt,rt){tt?et(tt):j(rt)}});_[o!==void 0?o:"promise"]=$}else if(typeof _!="function")throw new TypeError("Callback must be a function");return _};catering.fromPromise=function(_,o){if(o===void 0)return _;_.then(function($){nextTick$1(()=>o(null,$))}).catch(function($){nextTick$1(()=>o($))})};var abstractIterator={},common$8={};common$8.getCallback=function(_,o){return typeof _=="function"?_:o};common$8.getOptions=function(_,o){return typeof _=="object"&&_!==null?_:o!==void 0?o:{}};const{fromCallback:fromCallback$3}=catering,ModuleError$6=moduleError,{getOptions:getOptions$2,getCallback:getCallback$2}=common$8,kPromise$3=Symbol("promise"),kCallback$1=Symbol("callback"),kWorking=Symbol("working"),kHandleOne$1=Symbol("handleOne"),kHandleMany$1=Symbol("handleMany"),kAutoClose=Symbol("autoClose"),kFinishWork=Symbol("finishWork"),kReturnMany=Symbol("returnMany"),kClosing=Symbol("closing"),kHandleClose=Symbol("handleClose"),kClosed=Symbol("closed"),kCloseCallbacks$1=Symbol("closeCallbacks"),kKeyEncoding$1=Symbol("keyEncoding"),kValueEncoding$1=Symbol("valueEncoding"),kAbortOnClose=Symbol("abortOnClose"),kLegacy=Symbol("legacy"),kKeys=Symbol("keys"),kValues=Symbol("values"),kLimit=Symbol("limit"),kCount=Symbol("count"),emptyOptions$1=Object.freeze({}),noop$7=()=>{};let warnedEnd=!1;class CommonIterator{constructor(o,$,j){if(typeof o!="object"||o===null){const et=o===null?"null":typeof o;throw new TypeError(`The first argument must be an abstract-level database, received ${et}`)}if(typeof $!="object"||$===null)throw new TypeError("The second argument must be an options object");this[kClosed]=!1,this[kCloseCallbacks$1]=[],this[kWorking]=!1,this[kClosing]=!1,this[kAutoClose]=!1,this[kCallback$1]=null,this[kHandleOne$1]=this[kHandleOne$1].bind(this),this[kHandleMany$1]=this[kHandleMany$1].bind(this),this[kHandleClose]=this[kHandleClose].bind(this),this[kKeyEncoding$1]=$[kKeyEncoding$1],this[kValueEncoding$1]=$[kValueEncoding$1],this[kLegacy]=j,this[kLimit]=Number.isInteger($.limit)&&$.limit>=0?$.limit:1/0,this[kCount]=0,this[kAbortOnClose]=!!$.abortOnClose,this.db=o,this.db.attachResource(this),this.nextTick=o.nextTick}get count(){return this[kCount]}get limit(){return this[kLimit]}next(o){let $;if(o===void 0)$=new Promise((j,et)=>{o=(tt,rt,nt)=>{tt?et(tt):this[kLegacy]?rt===void 0&&nt===void 0?j():j([rt,nt]):j(rt)}});else if(typeof o!="function")throw new TypeError("Callback must be a function");return this[kClosing]?this.nextTick(o,new ModuleError$6("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(o,new ModuleError$6("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=o,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleOne$1],null):this._next(this[kHandleOne$1])),$}_next(o){this.nextTick(o)}nextv(o,$,j){return j=getCallback$2($,j),j=fromCallback$3(j,kPromise$3),$=getOptions$2($,emptyOptions$1),Number.isInteger(o)?(this[kClosing]?this.nextTick(j,new ModuleError$6("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(j,new ModuleError$6("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(o<1&&(o=1),this[kLimit]<1/0&&(o=Math.min(o,this[kLimit]-this[kCount])),this[kWorking]=!0,this[kCallback$1]=j,o<=0?this.nextTick(this[kHandleMany$1],null,[]):this._nextv(o,$,this[kHandleMany$1])),j[kPromise$3]):(this.nextTick(j,new TypeError("The first argument 'size' must be an integer")),j[kPromise$3])}_nextv(o,$,j){const et=[],tt=(rt,nt,it)=>{if(rt)return j(rt);if(this[kLegacy]?nt===void 0&&it===void 0:nt===void 0)return j(null,et);et.push(this[kLegacy]?[nt,it]:nt),et.length===o?j(null,et):this._next(tt)};this._next(tt)}all(o,$){return $=getCallback$2(o,$),$=fromCallback$3($,kPromise$3),o=getOptions$2(o,emptyOptions$1),this[kClosing]?this.nextTick($,new ModuleError$6("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick($,new ModuleError$6("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=$,this[kAutoClose]=!0,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleMany$1],null,[]):this._all(o,this[kHandleMany$1])),$[kPromise$3]}_all(o,$){let j=this[kCount];const et=[],tt=()=>{const nt=this[kLimit]<1/0?Math.min(1e3,this[kLimit]-j):1e3;nt<=0?this.nextTick($,null,et):this._nextv(nt,emptyOptions$1,rt)},rt=(nt,it)=>{nt?$(nt):it.length===0?$(null,et):(et.push.apply(et,it),j+=it.length,tt())};tt()}[kFinishWork](){const o=this[kCallback$1];return this[kAbortOnClose]&&o===null?noop$7:(this[kWorking]=!1,this[kCallback$1]=null,this[kClosing]&&this._close(this[kHandleClose]),o)}[kReturnMany](o,$,j){this[kAutoClose]?this.close(o.bind(null,$,j)):o($,j)}seek(o,$){if($=getOptions$2($,emptyOptions$1),!this[kClosing]){if(this[kWorking])throw new ModuleError$6("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const j=this.db.keyEncoding($.keyEncoding||this[kKeyEncoding$1]),et=j.format;$.keyEncoding!==et&&($={...$,keyEncoding:et});const tt=this.db.prefixKey(j.encode(o),et);this._seek(tt,$)}}}_seek(o,$){throw new ModuleError$6("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(o){return o=fromCallback$3(o,kPromise$3),this[kClosed]?this.nextTick(o):this[kClosing]?this[kCloseCallbacks$1].push(o):(this[kClosing]=!0,this[kCloseCallbacks$1].push(o),this[kWorking]?this[kAbortOnClose]&&this[kFinishWork]()(new ModuleError$6("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[kHandleClose])),o[kPromise$3]}_close(o){this.nextTick(o)}[kHandleClose](){this[kClosed]=!0,this.db.detachResource(this);const o=this[kCloseCallbacks$1];this[kCloseCallbacks$1]=[];for(const $ of o)$()}async*[Symbol.asyncIterator](){try{let o;for(;(o=await this.next())!==void 0;)yield o}finally{this[kClosed]||await this.close()}}}let AbstractIterator$3=class extends CommonIterator{constructor(o,$){super(o,$,!0),this[kKeys]=$.keys!==!1,this[kValues]=$.values!==!1}[kHandleOne$1](o,$,j){const et=this[kFinishWork]();if(o)return et(o);try{$=this[kKeys]&&$!==void 0?this[kKeyEncoding$1].decode($):void 0,j=this[kValues]&&j!==void 0?this[kValueEncoding$1].decode(j):void 0}catch(tt){return et(new IteratorDecodeError("entry",tt))}$===void 0&&j===void 0||this[kCount]++,et(null,$,j)}[kHandleMany$1](o,$){const j=this[kFinishWork]();if(o)return this[kReturnMany](j,o);try{for(const et of $){const tt=et[0],rt=et[1];et[0]=this[kKeys]&&tt!==void 0?this[kKeyEncoding$1].decode(tt):void 0,et[1]=this[kValues]&&rt!==void 0?this[kValueEncoding$1].decode(rt):void 0}}catch(et){return this[kReturnMany](j,new IteratorDecodeError("entries",et))}this[kCount]+=$.length,this[kReturnMany](j,null,$)}end(o){return!warnedEnd&&typeof console<"u"&&(warnedEnd=!0,console.warn(new ModuleError$6("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(o)}},AbstractKeyIterator$2=class extends CommonIterator{constructor(o,$){super(o,$,!1)}[kHandleOne$1](o,$){const j=this[kFinishWork]();if(o)return j(o);try{$=$!==void 0?this[kKeyEncoding$1].decode($):void 0}catch(et){return j(new IteratorDecodeError("key",et))}$!==void 0&&this[kCount]++,j(null,$)}[kHandleMany$1](o,$){const j=this[kFinishWork]();if(o)return this[kReturnMany](j,o);try{for(let et=0;et<$.length;et++){const tt=$[et];$[et]=tt!==void 0?this[kKeyEncoding$1].decode(tt):void 0}}catch(et){return this[kReturnMany](j,new IteratorDecodeError("keys",et))}this[kCount]+=$.length,this[kReturnMany](j,null,$)}},AbstractValueIterator$2=class extends CommonIterator{constructor(o,$){super(o,$,!1)}[kHandleOne$1](o,$){const j=this[kFinishWork]();if(o)return j(o);try{$=$!==void 0?this[kValueEncoding$1].decode($):void 0}catch(et){return j(new IteratorDecodeError("value",et))}$!==void 0&&this[kCount]++,j(null,$)}[kHandleMany$1](o,$){const j=this[kFinishWork]();if(o)return this[kReturnMany](j,o);try{for(let et=0;et<$.length;et++){const tt=$[et];$[et]=tt!==void 0?this[kValueEncoding$1].decode(tt):void 0}}catch(et){return this[kReturnMany](j,new IteratorDecodeError("values",et))}this[kCount]+=$.length,this[kReturnMany](j,null,$)}};class IteratorDecodeError extends ModuleError$6{constructor(o,$){super(`Iterator could not decode ${o}`,{code:"LEVEL_DECODE_ERROR",cause:$})}}for(const _ of["_ended property","_nexting property","_end method"])Object.defineProperty(AbstractIterator$3.prototype,_.split(" ")[0],{get(){throw new ModuleError$6(`The ${_} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new ModuleError$6(`The ${_} has been removed`,{code:"LEVEL_LEGACY"})}});AbstractIterator$3.keyEncoding=kKeyEncoding$1;AbstractIterator$3.valueEncoding=kValueEncoding$1;abstractIterator.AbstractIterator=AbstractIterator$3;abstractIterator.AbstractKeyIterator=AbstractKeyIterator$2;abstractIterator.AbstractValueIterator=AbstractValueIterator$2;var defaultKvIterator={};const{AbstractKeyIterator:AbstractKeyIterator$1,AbstractValueIterator:AbstractValueIterator$1}=abstractIterator,kIterator=Symbol("iterator"),kCallback=Symbol("callback"),kHandleOne=Symbol("handleOne"),kHandleMany=Symbol("handleMany");let DefaultKeyIterator$1=class extends AbstractKeyIterator$1{constructor(o,$){super(o,$),this[kIterator]=o.iterator({...$,keys:!0,values:!1}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}},DefaultValueIterator$1=class extends AbstractValueIterator$1{constructor(o,$){super(o,$),this[kIterator]=o.iterator({...$,keys:!1,values:!0}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}};for(const _ of[DefaultKeyIterator$1,DefaultValueIterator$1]){const o=_===DefaultKeyIterator$1,$=o?j=>j[0]:j=>j[1];_.prototype._next=function(j){this[kCallback]=j,this[kIterator].next(this[kHandleOne])},_.prototype[kHandleOne]=function(j,et,tt){const rt=this[kCallback];j?rt(j):rt(null,o?et:tt)},_.prototype._nextv=function(j,et,tt){this[kCallback]=tt,this[kIterator].nextv(j,et,this[kHandleMany])},_.prototype._all=function(j,et){this[kCallback]=et,this[kIterator].all(j,this[kHandleMany])},_.prototype[kHandleMany]=function(j,et){const tt=this[kCallback];j?tt(j):tt(null,et.map($))},_.prototype._seek=function(j,et){this[kIterator].seek(j,et)},_.prototype._close=function(j){this[kIterator].close(j)}}defaultKvIterator.DefaultKeyIterator=DefaultKeyIterator$1;defaultKvIterator.DefaultValueIterator=DefaultValueIterator$1;var deferredIterator={};const{AbstractIterator:AbstractIterator$2,AbstractKeyIterator,AbstractValueIterator}=abstractIterator,ModuleError$5=moduleError,kNut=Symbol("nut"),kUndefer$1=Symbol("undefer"),kFactory=Symbol("factory");let DeferredIterator$1=class extends AbstractIterator$2{constructor(o,$){super(o,$),this[kNut]=null,this[kFactory]=()=>o.iterator($),this.db.defer(()=>this[kUndefer$1]())}},DeferredKeyIterator$1=class extends AbstractKeyIterator{constructor(o,$){super(o,$),this[kNut]=null,this[kFactory]=()=>o.keys($),this.db.defer(()=>this[kUndefer$1]())}},DeferredValueIterator$1=class extends AbstractValueIterator{constructor(o,$){super(o,$),this[kNut]=null,this[kFactory]=()=>o.values($),this.db.defer(()=>this[kUndefer$1]())}};for(const _ of[DeferredIterator$1,DeferredKeyIterator$1,DeferredValueIterator$1])_.prototype[kUndefer$1]=function(){this.db.status==="open"&&(this[kNut]=this[kFactory]())},_.prototype._next=function(o){this[kNut]!==null?this[kNut].next(o):this.db.status==="opening"?this.db.defer(()=>this._next(o)):this.nextTick(o,new ModuleError$5("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},_.prototype._nextv=function(o,$,j){this[kNut]!==null?this[kNut].nextv(o,$,j):this.db.status==="opening"?this.db.defer(()=>this._nextv(o,$,j)):this.nextTick(j,new ModuleError$5("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},_.prototype._all=function(o,$){this[kNut]!==null?this[kNut].all($):this.db.status==="opening"?this.db.defer(()=>this._all(o,$)):this.nextTick($,new ModuleError$5("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},_.prototype._seek=function(o,$){this[kNut]!==null?this[kNut]._seek(o,$):this.db.status==="opening"&&this.db.defer(()=>this._seek(o,$))},_.prototype._close=function(o){this[kNut]!==null?this[kNut].close(o):this.db.status==="opening"?this.db.defer(()=>this._close(o)):this.nextTick(o)};deferredIterator.DeferredIterator=DeferredIterator$1;deferredIterator.DeferredKeyIterator=DeferredKeyIterator$1;deferredIterator.DeferredValueIterator=DeferredValueIterator$1;var defaultChainedBatch={},abstractChainedBatch={};const{fromCallback:fromCallback$2}=catering,ModuleError$4=moduleError,{getCallback:getCallback$1,getOptions:getOptions$1}=common$8,kPromise$2=Symbol("promise"),kStatus$1=Symbol("status"),kOperations$1=Symbol("operations"),kFinishClose=Symbol("finishClose"),kCloseCallbacks=Symbol("closeCallbacks");let AbstractChainedBatch$1=class{constructor(o){if(typeof o!="object"||o===null){const $=o===null?"null":typeof o;throw new TypeError(`The first argument must be an abstract-level database, received ${$}`)}this[kOperations$1]=[],this[kCloseCallbacks]=[],this[kStatus$1]="open",this[kFinishClose]=this[kFinishClose].bind(this),this.db=o,this.db.attachResource(this),this.nextTick=o.nextTick}get length(){return this[kOperations$1].length}put(o,$,j){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const et=this.db._checkKey(o)||this.db._checkValue($);if(et)throw et;const tt=j&&j.sublevel!=null?j.sublevel:this.db,rt=j,nt=tt.keyEncoding(j&&j.keyEncoding),it=tt.valueEncoding(j&&j.valueEncoding),st=nt.format;j={...j,keyEncoding:st,valueEncoding:it.format},tt!==this.db&&(j.sublevel=null);const ot=tt.prefixKey(nt.encode(o),st),at=it.encode($);return this._put(ot,at,j),this[kOperations$1].push({...rt,type:"put",key:o,value:$}),this}_put(o,$,j){}del(o,$){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const j=this.db._checkKey(o);if(j)throw j;const et=$&&$.sublevel!=null?$.sublevel:this.db,tt=$,rt=et.keyEncoding($&&$.keyEncoding),nt=rt.format;return $={...$,keyEncoding:nt},et!==this.db&&($.sublevel=null),this._del(et.prefixKey(rt.encode(o),nt),$),this[kOperations$1].push({...tt,type:"del",key:o}),this}_del(o,$){}clear(){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[kOperations$1]=[],this}_clear(){}write(o,$){return $=getCallback$1(o,$),$=fromCallback$2($,kPromise$2),o=getOptions$1(o),this[kStatus$1]!=="open"?this.nextTick($,new ModuleError$4("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close($):(this[kStatus$1]="writing",this._write(o,j=>{this[kStatus$1]="closing",this[kCloseCallbacks].push(()=>$(j)),j||this.db.emit("batch",this[kOperations$1]),this._close(this[kFinishClose])})),$[kPromise$2]}_write(o,$){}close(o){return o=fromCallback$2(o,kPromise$2),this[kStatus$1]==="closing"?this[kCloseCallbacks].push(o):this[kStatus$1]==="closed"?this.nextTick(o):(this[kCloseCallbacks].push(o),this[kStatus$1]!=="writing"&&(this[kStatus$1]="closing",this._close(this[kFinishClose]))),o[kPromise$2]}_close(o){this.nextTick(o)}[kFinishClose](){this[kStatus$1]="closed",this.db.detachResource(this);const o=this[kCloseCallbacks];this[kCloseCallbacks]=[];for(const $ of o)$()}};abstractChainedBatch.AbstractChainedBatch=AbstractChainedBatch$1;const{AbstractChainedBatch}=abstractChainedBatch,ModuleError$3=moduleError,kEncoded=Symbol("encoded");let DefaultChainedBatch$1=class extends AbstractChainedBatch{constructor(o){super(o),this[kEncoded]=[]}_put(o,$,j){this[kEncoded].push({...j,type:"put",key:o,value:$})}_del(o,$){this[kEncoded].push({...$,type:"del",key:o})}_clear(){this[kEncoded]=[]}_write(o,$){this.db.status==="opening"?this.db.defer(()=>this._write(o,$)):this.db.status==="open"?this[kEncoded].length===0?this.nextTick($):this.db._batch(this[kEncoded],o,$):this.nextTick($,new ModuleError$3("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};defaultChainedBatch.DefaultChainedBatch=DefaultChainedBatch$1;const ModuleError$2=moduleError,hasOwnProperty$1=Object.prototype.hasOwnProperty,rangeOptions$1=new Set(["lt","lte","gt","gte"]);var rangeOptions_1=function(_,o){const $={};for(const j in _)if(hasOwnProperty$1.call(_,j)&&!(j==="keyEncoding"||j==="valueEncoding")){if(j==="start"||j==="end")throw new ModuleError$2(`The legacy range option '${j}' has been removed`,{code:"LEVEL_LEGACY"});if(j==="encoding")throw new ModuleError$2("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});rangeOptions$1.has(j)?$[j]=o.encode(_[j]):$[j]=_[j]}return $.reverse=!!$.reverse,$.limit=Number.isInteger($.limit)&&$.limit>=0?$.limit:-1,$};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let promise;var queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal):_=>(promise||(promise=Promise.resolve())).then(_).catch(o=>setTimeout(()=>{throw o},0)),nextTickBrowser,hasRequiredNextTickBrowser;function requireNextTickBrowser(){if(hasRequiredNextTickBrowser)return nextTickBrowser;hasRequiredNextTickBrowser=1;const _=queueMicrotask_1;return nextTickBrowser=function(o,...$){$.length===0?_(o):_(()=>o(...$))},nextTickBrowser}var abstractSublevelIterator={},hasRequiredAbstractSublevelIterator;function requireAbstractSublevelIterator(){if(hasRequiredAbstractSublevelIterator)return abstractSublevelIterator;hasRequiredAbstractSublevelIterator=1;const{AbstractIterator:_,AbstractKeyIterator:o,AbstractValueIterator:$}=abstractIterator,j=Symbol("unfix"),et=Symbol("iterator"),tt=Symbol("handleOne"),rt=Symbol("handleMany"),nt=Symbol("callback");class it extends _{constructor(ct,ut,ft,ht){super(ct,ut),this[et]=ft,this[j]=ht,this[tt]=this[tt].bind(this),this[rt]=this[rt].bind(this),this[nt]=null}[tt](ct,ut,ft){const ht=this[nt];if(ct)return ht(ct);ut!==void 0&&(ut=this[j](ut)),ht(ct,ut,ft)}[rt](ct,ut){const ft=this[nt];if(ct)return ft(ct);for(const ht of ut){const mt=ht[0];mt!==void 0&&(ht[0]=this[j](mt))}ft(ct,ut)}}class st extends o{constructor(ct,ut,ft,ht){super(ct,ut),this[et]=ft,this[j]=ht,this[tt]=this[tt].bind(this),this[rt]=this[rt].bind(this),this[nt]=null}[tt](ct,ut){const ft=this[nt];if(ct)return ft(ct);ut!==void 0&&(ut=this[j](ut)),ft(ct,ut)}[rt](ct,ut){const ft=this[nt];if(ct)return ft(ct);for(let ht=0;ht<ut.length;ht++){const mt=ut[ht];mt!==void 0&&(ut[ht]=this[j](mt))}ft(ct,ut)}}class ot extends ${constructor(ct,ut,ft){super(ct,ut),this[et]=ft}}for(const at of[it,st])at.prototype._next=function(ct){this[nt]=ct,this[et].next(this[tt])},at.prototype._nextv=function(ct,ut,ft){this[nt]=ft,this[et].nextv(ct,ut,this[rt])},at.prototype._all=function(ct,ut){this[nt]=ut,this[et].all(ct,this[rt])};for(const at of[ot])at.prototype._next=function(ct){this[et].next(ct)},at.prototype._nextv=function(ct,ut,ft){this[et].nextv(ct,ut,ft)},at.prototype._all=function(ct,ut){this[et].all(ct,ut)};for(const at of[it,st,ot])at.prototype._seek=function(ct,ut){this[et].seek(ct,ut)},at.prototype._close=function(ct){this[et].close(ct)};return abstractSublevelIterator.AbstractSublevelIterator=it,abstractSublevelIterator.AbstractSublevelKeyIterator=st,abstractSublevelIterator.AbstractSublevelValueIterator=ot,abstractSublevelIterator}var abstractSublevel,hasRequiredAbstractSublevel;function requireAbstractSublevel(){if(hasRequiredAbstractSublevel)return abstractSublevel;hasRequiredAbstractSublevel=1;const _=moduleError,{Buffer:o}=buffer$2||{},{AbstractSublevelIterator:$,AbstractSublevelKeyIterator:j,AbstractSublevelValueIterator:et}=requireAbstractSublevelIterator(),tt=Symbol("prefix"),rt=Symbol("upperBound"),nt=Symbol("prefixRange"),it=Symbol("parent"),st=Symbol("unfix"),ot=new TextEncoder,at={separator:"!"};abstractSublevel=function({AbstractLevel:gt}){class Et extends gt{static defaults(At){if(typeof At=="string")throw new _("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(At&&At.open)throw new _("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return At==null?at:At.separator?At:{...At,separator:"!"}}constructor(At,kt,Rt){const{separator:Tt,manifest:Dt,...Ot}=Et.defaults(Rt);kt=mt(kt,Tt);const jt=Tt.charCodeAt(0)+1,Nt=At[it]||At;if(!ot.encode(kt).every(lt=>lt>jt&&lt<127))throw new _(`Prefix must use bytes > ${jt} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(ct(Nt,Dt),Ot);const It=(At.prefix||"")+Tt+kt+Tt,yt=It.slice(0,-1)+String.fromCharCode(jt);this[it]=Nt,this[tt]=new ft(It),this[rt]=new ft(yt),this[st]=new ht,this.nextTick=Nt.nextTick}prefixKey(At,kt){if(kt==="utf8")return this[tt].utf8+At;if(At.byteLength===0)return this[tt][kt];if(kt==="view"){const Rt=this[tt].view,Tt=new Uint8Array(Rt.byteLength+At.byteLength);return Tt.set(Rt,0),Tt.set(At,Rt.byteLength),Tt}else{const Rt=this[tt].buffer;return o.concat([Rt,At],Rt.byteLength+At.byteLength)}}[nt](At,kt){At.gte!==void 0?At.gte=this.prefixKey(At.gte,kt):At.gt!==void 0?At.gt=this.prefixKey(At.gt,kt):At.gte=this[tt][kt],At.lte!==void 0?At.lte=this.prefixKey(At.lte,kt):At.lt!==void 0?At.lt=this.prefixKey(At.lt,kt):At.lte=this[rt][kt]}get prefix(){return this[tt].utf8}get db(){return this[it]}_open(At,kt){this[it].open({passive:!0},kt)}_put(At,kt,Rt,Tt){this[it].put(At,kt,Rt,Tt)}_get(At,kt,Rt){this[it].get(At,kt,Rt)}_getMany(At,kt,Rt){this[it].getMany(At,kt,Rt)}_del(At,kt,Rt){this[it].del(At,kt,Rt)}_batch(At,kt,Rt){this[it].batch(At,kt,Rt)}_clear(At,kt){this[nt](At,At.keyEncoding),this[it].clear(At,kt)}_iterator(At){this[nt](At,At.keyEncoding);const kt=this[it].iterator(At),Rt=this[st].get(this[tt].utf8.length,At.keyEncoding);return new $(this,At,kt,Rt)}_keys(At){this[nt](At,At.keyEncoding);const kt=this[it].keys(At),Rt=this[st].get(this[tt].utf8.length,At.keyEncoding);return new j(this,At,kt,Rt)}_values(At){this[nt](At,At.keyEncoding);const kt=this[it].values(At);return new et(this,At,kt)}}return{AbstractSublevel:Et}};const ct=function(gt,Et){return{...gt.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...Et,encodings:{utf8:ut(gt,"utf8"),buffer:ut(gt,"buffer"),view:ut(gt,"view")}}},ut=function(gt,Et){return gt.supports.encodings[Et]?gt.keyEncoding(Et).name===Et:!1};class ft{constructor(Et){this.utf8=Et,this.view=ot.encode(Et),this.buffer=o?o.from(this.view.buffer,0,this.view.byteLength):{}}}class ht{constructor(){this.cache=new Map}get(Et,St){let At=this.cache.get(St);return At===void 0&&(St==="view"?At=function(kt,Rt){return Rt.subarray(kt)}.bind(null,Et):At=function(kt,Rt){return Rt.slice(kt)}.bind(null,Et),this.cache.set(St,At)),At}}const mt=function(gt,Et){let St=0,At=gt.length;for(;St<At&&gt[St]===Et;)St++;for(;At>St&&gt[At-1]===Et;)At--;return gt.slice(St,At)};return abstractSublevel}const{supports}=levelSupports,{Transcoder}=levelTranscoder,{EventEmitter:EventEmitter$3}=eventsExports,{fromCallback:fromCallback$1}=catering,ModuleError$1=moduleError,{AbstractIterator:AbstractIterator$1}=abstractIterator,{DefaultKeyIterator,DefaultValueIterator}=defaultKvIterator,{DeferredIterator,DeferredKeyIterator,DeferredValueIterator}=deferredIterator,{DefaultChainedBatch}=defaultChainedBatch,{getCallback,getOptions}=common$8,rangeOptions=rangeOptions_1,kPromise$1=Symbol("promise"),kLanded=Symbol("landed"),kResources=Symbol("resources"),kCloseResources=Symbol("closeResources"),kOperations=Symbol("operations"),kUndefer=Symbol("undefer"),kDeferOpen=Symbol("deferOpen"),kOptions$1=Symbol("options"),kStatus=Symbol("status"),kDefaultOptions=Symbol("defaultOptions"),kTranscoder=Symbol("transcoder"),kKeyEncoding=Symbol("keyEncoding"),kValueEncoding=Symbol("valueEncoding"),noop$6=()=>{};let AbstractLevel$1=class extends EventEmitter$3{constructor(o,$){if(super(),typeof o!="object"||o===null)throw new TypeError("The first argument 'manifest' must be an object");$=getOptions($);const{keyEncoding:j,valueEncoding:et,passive:tt,...rt}=$;this[kResources]=new Set,this[kOperations]=[],this[kDeferOpen]=!0,this[kOptions$1]=rt,this[kStatus]="opening",this.supports=supports(o,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:o.snapshots!==!1,permanence:o.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:o.encodings||{},events:Object.assign({},o.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[kTranscoder]=new Transcoder(formats(this)),this[kKeyEncoding]=this[kTranscoder].encoding(j||"utf8"),this[kValueEncoding]=this[kTranscoder].encoding(et||"utf8");for(const nt of this[kTranscoder].encodings())this.supports.encodings[nt.commonName]||(this.supports.encodings[nt.commonName]=!0);this[kDefaultOptions]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[kKeyEncoding].commonName,valueEncoding:this[kValueEncoding].commonName}),key:Object.freeze({keyEncoding:this[kKeyEncoding].commonName})},this.nextTick(()=>{this[kDeferOpen]&&this.open({passive:!1},noop$6)})}get status(){return this[kStatus]}keyEncoding(o){return this[kTranscoder].encoding(o??this[kKeyEncoding])}valueEncoding(o){return this[kTranscoder].encoding(o??this[kValueEncoding])}open(o,$){$=getCallback(o,$),$=fromCallback$1($,kPromise$1),o={...this[kOptions$1],...getOptions(o)},o.createIfMissing=o.createIfMissing!==!1,o.errorIfExists=!!o.errorIfExists;const j=et=>{this[kStatus]==="closing"||this[kStatus]==="opening"?this.once(kLanded,et?()=>j(et):j):this[kStatus]!=="open"?$(new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:et})):$()};return o.passive?this[kStatus]==="opening"?this.once(kLanded,j):this.nextTick(j):this[kStatus]==="closed"||this[kDeferOpen]?(this[kDeferOpen]=!1,this[kStatus]="opening",this.emit("opening"),this._open(o,et=>{if(et){this[kStatus]="closed",this[kCloseResources](()=>{this.emit(kLanded),j(et)}),this[kUndefer]();return}this[kStatus]="open",this[kUndefer](),this.emit(kLanded),this[kStatus]==="open"&&this.emit("open"),this[kStatus]==="open"&&this.emit("ready"),j()})):this[kStatus]==="open"?this.nextTick(j):this.once(kLanded,()=>this.open(o,$)),$[kPromise$1]}_open(o,$){this.nextTick($)}close(o){o=fromCallback$1(o,kPromise$1);const $=j=>{this[kStatus]==="opening"||this[kStatus]==="closing"?this.once(kLanded,j?$(j):$):this[kStatus]!=="closed"?o(new ModuleError$1("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:j})):o()};if(this[kStatus]==="open"){this[kStatus]="closing",this.emit("closing");const j=et=>{this[kStatus]="open",this[kUndefer](),this.emit(kLanded),$(et)};this[kCloseResources](()=>{this._close(et=>{if(et)return j(et);this[kStatus]="closed",this[kUndefer](),this.emit(kLanded),this[kStatus]==="closed"&&this.emit("closed"),$()})})}else this[kStatus]==="closed"?this.nextTick($):this.once(kLanded,()=>this.close(o));return o[kPromise$1]}[kCloseResources](o){if(this[kResources].size===0)return this.nextTick(o);let $=this[kResources].size,j=!0;const et=()=>{--$===0&&(j?this.nextTick(o):o())};for(const tt of this[kResources])tt.close(et);j=!1,this[kResources].clear()}_close(o){this.nextTick(o)}get(o,$,j){if(j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.get(o,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];const et=this._checkKey(o);if(et)return this.nextTick(j,et),j[kPromise$1];const tt=this.keyEncoding($.keyEncoding),rt=this.valueEncoding($.valueEncoding),nt=tt.format,it=rt.format;return($.keyEncoding!==nt||$.valueEncoding!==it)&&($=Object.assign({},$,{keyEncoding:nt,valueEncoding:it})),this._get(this.prefixKey(tt.encode(o),nt),$,(st,ot)=>{if(st)return(st.code==="LEVEL_NOT_FOUND"||st.notFound||/NotFound/i.test(st))&&(st.code||(st.code="LEVEL_NOT_FOUND"),st.notFound||(st.notFound=!0),st.status||(st.status=404)),j(st);try{ot=rt.decode(ot)}catch(at){return j(new ModuleError$1("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:at}))}j(null,ot)}),j[kPromise$1]}_get(o,$,j){this.nextTick(j,new Error("NotFound"))}getMany(o,$,j){if(j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.getMany(o,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];if(!Array.isArray(o))return this.nextTick(j,new TypeError("The first argument 'keys' must be an array")),j[kPromise$1];if(o.length===0)return this.nextTick(j,null,[]),j[kPromise$1];const et=this.keyEncoding($.keyEncoding),tt=this.valueEncoding($.valueEncoding),rt=et.format,nt=tt.format;($.keyEncoding!==rt||$.valueEncoding!==nt)&&($=Object.assign({},$,{keyEncoding:rt,valueEncoding:nt}));const it=new Array(o.length);for(let st=0;st<o.length;st++){const ot=o[st],at=this._checkKey(ot);if(at)return this.nextTick(j,at),j[kPromise$1];it[st]=this.prefixKey(et.encode(ot),rt)}return this._getMany(it,$,(st,ot)=>{if(st)return j(st);try{for(let at=0;at<ot.length;at++)ot[at]!==void 0&&(ot[at]=tt.decode(ot[at]))}catch(at){return j(new ModuleError$1(`Could not decode one or more of ${ot.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:at}))}j(null,ot)}),j[kPromise$1]}_getMany(o,$,j){this.nextTick(j,null,new Array(o.length).fill(void 0))}put(o,$,j,et){if(et=getCallback(j,et),et=fromCallback$1(et,kPromise$1),j=getOptions(j,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.put(o,$,j,et)),et[kPromise$1];if(maybeError(this,et))return et[kPromise$1];const tt=this._checkKey(o)||this._checkValue($);if(tt)return this.nextTick(et,tt),et[kPromise$1];const rt=this.keyEncoding(j.keyEncoding),nt=this.valueEncoding(j.valueEncoding),it=rt.format,st=nt.format;(j.keyEncoding!==it||j.valueEncoding!==st)&&(j=Object.assign({},j,{keyEncoding:it,valueEncoding:st}));const ot=this.prefixKey(rt.encode(o),it),at=nt.encode($);return this._put(ot,at,j,ct=>{if(ct)return et(ct);this.emit("put",o,$),et()}),et[kPromise$1]}_put(o,$,j,et){this.nextTick(et)}del(o,$,j){if(j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].key),this[kStatus]==="opening")return this.defer(()=>this.del(o,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];const et=this._checkKey(o);if(et)return this.nextTick(j,et),j[kPromise$1];const tt=this.keyEncoding($.keyEncoding),rt=tt.format;return $.keyEncoding!==rt&&($=Object.assign({},$,{keyEncoding:rt})),this._del(this.prefixKey(tt.encode(o),rt),$,nt=>{if(nt)return j(nt);this.emit("del",o),j()}),j[kPromise$1]}_del(o,$,j){this.nextTick(j)}batch(o,$,j){if(!arguments.length){if(this[kStatus]==="opening")return new DefaultChainedBatch(this);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof o=="function"?j=o:j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.batch(o,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];if(!Array.isArray(o))return this.nextTick(j,new TypeError("The first argument 'operations' must be an array")),j[kPromise$1];if(o.length===0)return this.nextTick(j),j[kPromise$1];const et=new Array(o.length),{keyEncoding:tt,valueEncoding:rt,...nt}=$;for(let it=0;it<o.length;it++){if(typeof o[it]!="object"||o[it]===null)return this.nextTick(j,new TypeError("A batch operation must be an object")),j[kPromise$1];const st=Object.assign({},o[it]);if(st.type!=="put"&&st.type!=="del")return this.nextTick(j,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),j[kPromise$1];const ot=this._checkKey(st.key);if(ot)return this.nextTick(j,ot),j[kPromise$1];const at=st.sublevel!=null?st.sublevel:this,ct=at.keyEncoding(st.keyEncoding||tt),ut=ct.format;if(st.key=at.prefixKey(ct.encode(st.key),ut),st.keyEncoding=ut,st.type==="put"){const ft=this._checkValue(st.value);if(ft)return this.nextTick(j,ft),j[kPromise$1];const ht=at.valueEncoding(st.valueEncoding||rt);st.value=ht.encode(st.value),st.valueEncoding=ht.format}at!==this&&(st.sublevel=null),et[it]=st}return this._batch(et,nt,it=>{if(it)return j(it);this.emit("batch",o),j()}),j[kPromise$1]}_batch(o,$,j){this.nextTick(j)}sublevel(o,$){return this._sublevel(o,AbstractSublevel.defaults($))}_sublevel(o,$){return new AbstractSublevel(this,o,$)}prefixKey(o,$){return o}clear(o,$){if($=getCallback(o,$),$=fromCallback$1($,kPromise$1),o=getOptions(o,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.clear(o,$)),$[kPromise$1];if(maybeError(this,$))return $[kPromise$1];const j=o,et=this.keyEncoding(o.keyEncoding);return o=rangeOptions(o,et),o.keyEncoding=et.format,o.limit===0?this.nextTick($):this._clear(o,tt=>{if(tt)return $(tt);this.emit("clear",j),$()}),$[kPromise$1]}_clear(o,$){this.nextTick($)}iterator(o){const $=this.keyEncoding(o&&o.keyEncoding),j=this.valueEncoding(o&&o.valueEncoding);if(o=rangeOptions(o,$),o.keys=o.keys!==!1,o.values=o.values!==!1,o[AbstractIterator$1.keyEncoding]=$,o[AbstractIterator$1.valueEncoding]=j,o.keyEncoding=$.format,o.valueEncoding=j.format,this[kStatus]==="opening")return new DeferredIterator(this,o);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(o)}_iterator(o){return new AbstractIterator$1(this,o)}keys(o){const $=this.keyEncoding(o&&o.keyEncoding),j=this.valueEncoding(o&&o.valueEncoding);if(o=rangeOptions(o,$),o[AbstractIterator$1.keyEncoding]=$,o[AbstractIterator$1.valueEncoding]=j,o.keyEncoding=$.format,o.valueEncoding=j.format,this[kStatus]==="opening")return new DeferredKeyIterator(this,o);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(o)}_keys(o){return new DefaultKeyIterator(this,o)}values(o){const $=this.keyEncoding(o&&o.keyEncoding),j=this.valueEncoding(o&&o.valueEncoding);if(o=rangeOptions(o,$),o[AbstractIterator$1.keyEncoding]=$,o[AbstractIterator$1.valueEncoding]=j,o.keyEncoding=$.format,o.valueEncoding=j.format,this[kStatus]==="opening")return new DeferredValueIterator(this,o);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(o)}_values(o){return new DefaultValueIterator(this,o)}defer(o){if(typeof o!="function")throw new TypeError("The first argument must be a function");this[kOperations].push(o)}[kUndefer](){if(this[kOperations].length===0)return;const o=this[kOperations];this[kOperations]=[];for(const $ of o)$()}attachResource(o){if(typeof o!="object"||o===null||typeof o.close!="function")throw new TypeError("The first argument must be a resource object");this[kResources].add(o)}detachResource(o){this[kResources].delete(o)}_chainedBatch(){return new DefaultChainedBatch(this)}_checkKey(o){if(o==null)return new ModuleError$1("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(o){if(o==null)return new ModuleError$1("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};AbstractLevel$1.prototype.nextTick=requireNextTickBrowser();const{AbstractSublevel}=requireAbstractSublevel()({AbstractLevel:AbstractLevel$1});abstractLevel.AbstractLevel=AbstractLevel$1;abstractLevel.AbstractSublevel=AbstractSublevel;const maybeError=function(_,o){return _[kStatus]!=="open"?(_.nextTick(o,new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},formats=function(_){return Object.keys(_.supports.encodings).filter(o=>!!_.supports.encodings[o])};abstractLevel$1.AbstractLevel=abstractLevel.AbstractLevel;abstractLevel$1.AbstractSublevel=abstractLevel.AbstractSublevel;abstractLevel$1.AbstractIterator=abstractIterator.AbstractIterator;abstractLevel$1.AbstractKeyIterator=abstractIterator.AbstractKeyIterator;abstractLevel$1.AbstractValueIterator=abstractIterator.AbstractValueIterator;abstractLevel$1.AbstractChainedBatch=abstractChainedBatch.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var runParallelLimit_1=runParallelLimit;const queueMicrotask$1=queueMicrotask_1;function runParallelLimit(_,o,$){if(typeof o!="number")throw new Error("second argument must be a Number");let j,et,tt,rt,nt,it=!0,st;Array.isArray(_)?(j=[],tt=et=_.length):(rt=Object.keys(_),j={},tt=et=rt.length);function ot(ct){function ut(){$&&$(ct,j),$=null}it?queueMicrotask$1(ut):ut()}function at(ct,ut,ft){if(j[ct]=ft,ut&&(nt=!0),--tt===0||ut)ot(ut);else if(!nt&&st<et){let ht;rt?(ht=rt[st],st+=1,_[ht](function(mt,gt){at(ht,mt,gt)})):(ht=st,st+=1,_[ht](function(mt,gt){at(ht,mt,gt)}))}}st=o,tt?rt?rt.some(function(ct,ut){return _[ct](function(ft,ht){at(ct,ft,ht)}),ut===o-1}):_.some(function(ct,ut){return ct(function(ft,ht){at(ut,ft,ht)}),ut===o-1}):ot(null),it=!1}var iterator$1={},keyRange=function(o){const $=o.gte!==void 0?o.gte:o.gt!==void 0?o.gt:void 0,j=o.lte!==void 0?o.lte:o.lt!==void 0?o.lt:void 0,et=o.gte===void 0,tt=o.lte===void 0;return $!==void 0&&j!==void 0?IDBKeyRange.bound($,j,et,tt):$!==void 0?IDBKeyRange.lowerBound($,et):j!==void 0?IDBKeyRange.upperBound(j,tt):null};const textEncoder$1=new TextEncoder;var deserialize$2=function(_){return _ instanceof Uint8Array?_:_ instanceof ArrayBuffer?new Uint8Array(_):textEncoder$1.encode(_)};const{AbstractIterator}=abstractLevel$1,createKeyRange$1=keyRange,deserialize$1=deserialize$2,kCache=Symbol("cache"),kFinished=Symbol("finished"),kOptions=Symbol("options"),kCurrentOptions=Symbol("currentOptions"),kPosition=Symbol("position"),kLocation$1=Symbol("location"),kFirst=Symbol("first"),emptyOptions={};let Iterator$1=class extends AbstractIterator{constructor(o,$,j){super(o,j),this[kCache]=[],this[kFinished]=this.limit===0,this[kOptions]=j,this[kCurrentOptions]={...j},this[kPosition]=void 0,this[kLocation$1]=$,this[kFirst]=!0}_nextv(o,$,j){if(this[kFirst]=!1,this[kFinished])return this.nextTick(j,null,[]);if(this[kCache].length>0)return o=Math.min(o,this[kCache].length),this.nextTick(j,null,this[kCache].splice(0,o));this[kPosition]!==void 0&&(this[kOptions].reverse?(this[kCurrentOptions].lt=this[kPosition],this[kCurrentOptions].lte=void 0):(this[kCurrentOptions].gt=this[kPosition],this[kCurrentOptions].gte=void 0));let et;try{et=createKeyRange$1(this[kCurrentOptions])}catch{return this[kFinished]=!0,this.nextTick(j,null,[])}const tt=this.db.db.transaction([this[kLocation$1]],"readonly"),rt=tt.objectStore(this[kLocation$1]),nt=[];if(this[kOptions].reverse){const it=!this[kOptions].values&&rt.openKeyCursor?"openKeyCursor":"openCursor";rt[it](et,"prev").onsuccess=st=>{const ot=st.target.result;if(ot){const{key:at,value:ct}=ot;this[kPosition]=at,nt.push([this[kOptions].keys&&at!==void 0?deserialize$1(at):void 0,this[kOptions].values&&ct!==void 0?deserialize$1(ct):void 0]),nt.length<o?ot.continue():maybeCommit(tt)}else this[kFinished]=!0}}else{let it,st;const ot=()=>{if(it===void 0||st===void 0)return;const at=Math.max(it.length,st.length);at===0||o===1/0?this[kFinished]=!0:this[kPosition]=it[at-1],nt.length=at;for(let ct=0;ct<at;ct++){const ut=it[ct],ft=st[ct];nt[ct]=[this[kOptions].keys&&ut!==void 0?deserialize$1(ut):void 0,this[kOptions].values&&ft!==void 0?deserialize$1(ft):void 0]}maybeCommit(tt)};this[kOptions].keys||o<1/0?rt.getAllKeys(et,o<1/0?o:void 0).onsuccess=at=>{it=at.target.result,ot()}:(it=[],this.nextTick(ot)),this[kOptions].values?rt.getAll(et,o<1/0?o:void 0).onsuccess=at=>{st=at.target.result,ot()}:(st=[],this.nextTick(ot))}tt.onabort=()=>{j(tt.error||new Error("aborted by user")),j=null},tt.oncomplete=()=>{j(null,nt),j=null}}_next(o){if(this[kCache].length>0){const[$,j]=this[kCache].shift();this.nextTick(o,null,$,j)}else if(this[kFinished])this.nextTick(o);else{let $=Math.min(100,this.limit-this.count);this[kFirst]&&(this[kFirst]=!1,$=1),this._nextv($,emptyOptions,(j,et)=>{if(j)return o(j);this[kCache]=et,this._next(o)})}}_all(o,$){this[kFirst]=!1;const j=this[kCache].splice(0,this[kCache].length),et=this.limit-this.count-j.length;if(et<=0)return this.nextTick($,null,j);this._nextv(et,emptyOptions,(tt,rt)=>{if(tt)return $(tt);j.length>0&&(rt=j.concat(rt)),$(null,rt)})}_seek(o,$){this[kFirst]=!0,this[kCache]=[],this[kFinished]=!1,this[kPosition]=void 0,this[kCurrentOptions]={...this[kOptions]};let j;try{j=createKeyRange$1(this[kOptions])}catch{this[kFinished]=!0;return}j!==null&&!j.includes(o)?this[kFinished]=!0:this[kOptions].reverse?this[kCurrentOptions].lte=o:this[kCurrentOptions].gte=o}};iterator$1.Iterator=Iterator$1;function maybeCommit(_){typeof _.commit=="function"&&_.commit()}var clear$1=function(o,$,j,et,tt){if(et.limit===0)return o.nextTick(tt);const rt=o.db.transaction([$],"readwrite"),nt=rt.objectStore($);let it=0;rt.oncomplete=function(){tt()},rt.onabort=function(){tt(rt.error||new Error("aborted by user"))};const st=nt.openKeyCursor?"openKeyCursor":"openCursor",ot=et.reverse?"prev":"next";nt[st](j,ot).onsuccess=function(at){const ct=at.target.result;ct&&(nt.delete(ct.key).onsuccess=function(){(et.limit<=0||++it<et.limit)&&ct.continue()})}};const{AbstractLevel}=abstractLevel$1,ModuleError=moduleError,parallel$1=runParallelLimit_1,{fromCallback}=catering,{Iterator}=iterator$1,deserialize=deserialize$2,clear=clear$1,createKeyRange=keyRange,DEFAULT_PREFIX="level-js-",kIDB=Symbol("idb"),kNamePrefix=Symbol("namePrefix"),kLocation=Symbol("location"),kVersion=Symbol("version"),kStore=Symbol("store"),kOnComplete=Symbol("onComplete"),kPromise=Symbol("promise");class BrowserLevel extends AbstractLevel{constructor(o,$,j){if(typeof $=="function"||typeof j=="function")throw new ModuleError("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:et,version:tt,...rt}=$||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},rt),typeof o!="string")throw new Error("constructor requires a location string argument");this[kLocation]=o,this[kNamePrefix]=et??DEFAULT_PREFIX,this[kVersion]=parseInt(tt||1,10),this[kIDB]=null}get location(){return this[kLocation]}get namePrefix(){return this[kNamePrefix]}get version(){return this[kVersion]}get db(){return this[kIDB]}get type(){return"browser-level"}_open(o,$){const j=indexedDB.open(this[kNamePrefix]+this[kLocation],this[kVersion]);j.onerror=function(){$(j.error||new Error("unknown error"))},j.onsuccess=()=>{this[kIDB]=j.result,$()},j.onupgradeneeded=et=>{const tt=et.target.result;tt.objectStoreNames.contains(this[kLocation])||tt.createObjectStore(this[kLocation])}}[kStore](o){return this[kIDB].transaction([this[kLocation]],o).objectStore(this[kLocation])}[kOnComplete](o,$){const j=o.transaction;j.onabort=function(){$(j.error||new Error("aborted by user"))},j.oncomplete=function(){$(null,o.result)}}_get(o,$,j){const et=this[kStore]("readonly");let tt;try{tt=et.get(o)}catch(rt){return this.nextTick(j,rt)}this[kOnComplete](tt,function(rt,nt){if(rt)return j(rt);if(nt===void 0)return j(new ModuleError("Entry not found",{code:"LEVEL_NOT_FOUND"}));j(null,deserialize(nt))})}_getMany(o,$,j){const et=this[kStore]("readonly"),tt=o.map(rt=>nt=>{let it;try{it=et.get(rt)}catch(st){return nt(st)}it.onsuccess=()=>{const st=it.result;nt(null,st===void 0?st:deserialize(st))},it.onerror=st=>{st.stopPropagation(),nt(it.error)}});parallel$1(tt,16,j)}_del(o,$,j){const et=this[kStore]("readwrite");let tt;try{tt=et.delete(o)}catch(rt){return this.nextTick(j,rt)}this[kOnComplete](tt,j)}_put(o,$,j,et){const tt=this[kStore]("readwrite");let rt;try{rt=tt.put($,o)}catch(nt){return this.nextTick(et,nt)}this[kOnComplete](rt,et)}_iterator(o){return new Iterator(this,this[kLocation],o)}_batch(o,$,j){const et=this[kStore]("readwrite"),tt=et.transaction;let rt=0,nt;tt.onabort=function(){j(nt||tt.error||new Error("aborted by user"))},tt.oncomplete=function(){j()};function it(){const st=o[rt++],ot=st.key;let at;try{at=st.type==="del"?et.delete(ot):et.put(st.value,ot)}catch(ct){nt=ct,tt.abort();return}rt<o.length?at.onsuccess=it:typeof tt.commit=="function"&&tt.commit()}it()}_clear(o,$){let j,et;try{j=createKeyRange(o)}catch{return this.nextTick($)}if(o.limit>=0)return clear(this,this[kLocation],j,o,$);try{const tt=this[kStore]("readwrite");et=j?tt.delete(j):tt.clear()}catch(tt){return this.nextTick($,tt)}this[kOnComplete](et,$)}_close(o){this[kIDB].close(),this.nextTick(o)}}BrowserLevel.destroy=function(_,o,$){typeof o=="function"&&($=o,o=DEFAULT_PREFIX),$=fromCallback($,kPromise);const j=indexedDB.deleteDatabase(o+_);return j.onsuccess=function(){$()},j.onerror=function(et){$(et)},$[kPromise]};browserLevel.BrowserLevel=BrowserLevel;var Level=browserLevel.BrowserLevel;const webcrypto={get(_=globalThis){const o=_.crypto;if(o==null||o.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return o}};var forge$s={options:{usePureJavaScript:!1}},utilExports={},util$8={get exports(){return utilExports},set exports(_){utilExports=_}},api$2={},baseN$1=api$2,_reverseAlphabets={};api$2.encode=function(_,o,$){if(typeof o!="string")throw new TypeError('"alphabet" must be a string.');if($!==void 0&&typeof $!="number")throw new TypeError('"maxline" must be a number.');var j="";if(!(_ instanceof Uint8Array))j=_encodeWithByteBuffer(_,o);else{var et=0,tt=o.length,rt=o.charAt(0),nt=[0];for(et=0;et<_.length;++et){for(var it=0,st=_[et];it<nt.length;++it)st+=nt[it]<<8,nt[it]=st%tt,st=st/tt|0;for(;st>0;)nt.push(st%tt),st=st/tt|0}for(et=0;_[et]===0&&et<_.length-1;++et)j+=rt;for(et=nt.length-1;et>=0;--et)j+=o[nt[et]]}if($){var ot=new RegExp(".{1,"+$+"}","g");j=j.match(ot).join(`\r
`)}return j};api$2.decode=function(_,o){if(typeof _!="string")throw new TypeError('"input" must be a string.');if(typeof o!="string")throw new TypeError('"alphabet" must be a string.');var $=_reverseAlphabets[o];if(!$){$=_reverseAlphabets[o]=[];for(var j=0;j<o.length;++j)$[o.charCodeAt(j)]=j}_=_.replace(/\s/g,"");for(var et=o.length,tt=o.charAt(0),rt=[0],j=0;j<_.length;j++){var nt=$[_.charCodeAt(j)];if(nt===void 0)return;for(var it=0,st=nt;it<rt.length;++it)st+=rt[it]*et,rt[it]=st&255,st>>=8;for(;st>0;)rt.push(st&255),st>>=8}for(var ot=0;_[ot]===tt&&ot<_.length-1;++ot)rt.push(0);return typeof buffer$2.Buffer<"u"?buffer$2.Buffer.from(rt.reverse()):new Uint8Array(rt.reverse())};function _encodeWithByteBuffer(_,o){var $=0,j=o.length,et=o.charAt(0),tt=[0];for($=0;$<_.length();++$){for(var rt=0,nt=_.at($);rt<tt.length;++rt)nt+=tt[rt]<<8,tt[rt]=nt%j,nt=nt/j|0;for(;nt>0;)tt.push(nt%j),nt=nt/j|0}var it="";for($=0;_.at($)===0&&$<_.length()-1;++$)it+=et;for($=tt.length-1;$>=0;--$)it+=o[tt[$]];return it}var forge$r=forge$s,baseN=baseN$1,util$7=util$8.exports=forge$r.util=forge$r.util||{};(function(){if(typeof browserExports$3<"u"&&browserExports$3.nextTick&&!browserExports$3.browser){util$7.nextTick=browserExports$3.nextTick,typeof setImmediate=="function"?util$7.setImmediate=setImmediate:util$7.setImmediate=util$7.nextTick;return}if(typeof setImmediate=="function"){util$7.setImmediate=function(){return setImmediate.apply(void 0,arguments)},util$7.nextTick=function(rt){return setImmediate(rt)};return}if(util$7.setImmediate=function(rt){setTimeout(rt,0)},typeof window<"u"&&typeof window.postMessage=="function"){let rt=function(nt){if(nt.source===window&&nt.data===_){nt.stopPropagation();var it=o.slice();o.length=0,it.forEach(function(st){st()})}};var _="forge.setImmediate",o=[];util$7.setImmediate=function(nt){o.push(nt),o.length===1&&window.postMessage(_,"*")},window.addEventListener("message",rt,!0)}if(typeof MutationObserver<"u"){var $=Date.now(),j=!0,et=document.createElement("div"),o=[];new MutationObserver(function(){var nt=o.slice();o.length=0,nt.forEach(function(it){it()})}).observe(et,{attributes:!0});var tt=util$7.setImmediate;util$7.setImmediate=function(nt){Date.now()-$>15?($=Date.now(),tt(nt)):(o.push(nt),o.length===1&&et.setAttribute("a",j=!j))}}util$7.nextTick=util$7.setImmediate})();util$7.isNodejs=typeof browserExports$3<"u"&&browserExports$3.versions&&browserExports$3.versions.node;util$7.globalScope=function(){return util$7.isNodejs?commonjsGlobal:typeof self>"u"?window:self}();util$7.isArray=Array.isArray||function(_){return Object.prototype.toString.call(_)==="[object Array]"};util$7.isArrayBuffer=function(_){return typeof ArrayBuffer<"u"&&_ instanceof ArrayBuffer};util$7.isArrayBufferView=function(_){return _&&util$7.isArrayBuffer(_.buffer)&&_.byteLength!==void 0};function _checkBitsParam(_){if(!(_===8||_===16||_===24||_===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+_)}util$7.ByteBuffer=ByteStringBuffer;function ByteStringBuffer(_){if(this.data="",this.read=0,typeof _=="string")this.data=_;else if(util$7.isArrayBuffer(_)||util$7.isArrayBufferView(_))if(typeof buffer$2.Buffer<"u"&&_ instanceof buffer$2.Buffer)this.data=_.toString("binary");else{var o=new Uint8Array(_);try{this.data=String.fromCharCode.apply(null,o)}catch{for(var $=0;$<o.length;++$)this.putByte(o[$])}}else(_ instanceof ByteStringBuffer||typeof _=="object"&&typeof _.data=="string"&&typeof _.read=="number")&&(this.data=_.data,this.read=_.read);this._constructedStringLength=0}util$7.ByteStringBuffer=ByteStringBuffer;var _MAX_CONSTRUCTED_STRING_LENGTH=4096;util$7.ByteStringBuffer.prototype._optimizeConstructedString=function(_){this._constructedStringLength+=_,this._constructedStringLength>_MAX_CONSTRUCTED_STRING_LENGTH&&(this.data.substr(0,1),this._constructedStringLength=0)};util$7.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};util$7.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};util$7.ByteStringBuffer.prototype.putByte=function(_){return this.putBytes(String.fromCharCode(_))};util$7.ByteStringBuffer.prototype.fillWithByte=function(_,o){_=String.fromCharCode(_);for(var $=this.data;o>0;)o&1&&($+=_),o>>>=1,o>0&&(_+=_);return this.data=$,this._optimizeConstructedString(o),this};util$7.ByteStringBuffer.prototype.putBytes=function(_){return this.data+=_,this._optimizeConstructedString(_.length),this};util$7.ByteStringBuffer.prototype.putString=function(_){return this.putBytes(util$7.encodeUtf8(_))};util$7.ByteStringBuffer.prototype.putInt16=function(_){return this.putBytes(String.fromCharCode(_>>8&255)+String.fromCharCode(_&255))};util$7.ByteStringBuffer.prototype.putInt24=function(_){return this.putBytes(String.fromCharCode(_>>16&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_&255))};util$7.ByteStringBuffer.prototype.putInt32=function(_){return this.putBytes(String.fromCharCode(_>>24&255)+String.fromCharCode(_>>16&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_&255))};util$7.ByteStringBuffer.prototype.putInt16Le=function(_){return this.putBytes(String.fromCharCode(_&255)+String.fromCharCode(_>>8&255))};util$7.ByteStringBuffer.prototype.putInt24Le=function(_){return this.putBytes(String.fromCharCode(_&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_>>16&255))};util$7.ByteStringBuffer.prototype.putInt32Le=function(_){return this.putBytes(String.fromCharCode(_&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_>>16&255)+String.fromCharCode(_>>24&255))};util$7.ByteStringBuffer.prototype.putInt=function(_,o){_checkBitsParam(o);var $="";do o-=8,$+=String.fromCharCode(_>>o&255);while(o>0);return this.putBytes($)};util$7.ByteStringBuffer.prototype.putSignedInt=function(_,o){return _<0&&(_+=2<<o-1),this.putInt(_,o)};util$7.ByteStringBuffer.prototype.putBuffer=function(_){return this.putBytes(_.getBytes())};util$7.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};util$7.ByteStringBuffer.prototype.getInt16=function(){var _=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,_};util$7.ByteStringBuffer.prototype.getInt24=function(){var _=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,_};util$7.ByteStringBuffer.prototype.getInt32=function(){var _=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,_};util$7.ByteStringBuffer.prototype.getInt16Le=function(){var _=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,_};util$7.ByteStringBuffer.prototype.getInt24Le=function(){var _=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,_};util$7.ByteStringBuffer.prototype.getInt32Le=function(){var _=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,_};util$7.ByteStringBuffer.prototype.getInt=function(_){_checkBitsParam(_);var o=0;do o=(o<<8)+this.data.charCodeAt(this.read++),_-=8;while(_>0);return o};util$7.ByteStringBuffer.prototype.getSignedInt=function(_){var o=this.getInt(_),$=2<<_-2;return o>=$&&(o-=$<<1),o};util$7.ByteStringBuffer.prototype.getBytes=function(_){var o;return _?(_=Math.min(this.length(),_),o=this.data.slice(this.read,this.read+_),this.read+=_):_===0?o="":(o=this.read===0?this.data:this.data.slice(this.read),this.clear()),o};util$7.ByteStringBuffer.prototype.bytes=function(_){return typeof _>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+_)};util$7.ByteStringBuffer.prototype.at=function(_){return this.data.charCodeAt(this.read+_)};util$7.ByteStringBuffer.prototype.setAt=function(_,o){return this.data=this.data.substr(0,this.read+_)+String.fromCharCode(o)+this.data.substr(this.read+_+1),this};util$7.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};util$7.ByteStringBuffer.prototype.copy=function(){var _=util$7.createBuffer(this.data);return _.read=this.read,_};util$7.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};util$7.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};util$7.ByteStringBuffer.prototype.truncate=function(_){var o=Math.max(0,this.length()-_);return this.data=this.data.substr(this.read,o),this.read=0,this};util$7.ByteStringBuffer.prototype.toHex=function(){for(var _="",o=this.read;o<this.data.length;++o){var $=this.data.charCodeAt(o);$<16&&(_+="0"),_+=$.toString(16)}return _};util$7.ByteStringBuffer.prototype.toString=function(){return util$7.decodeUtf8(this.bytes())};function DataBuffer(_,o){o=o||{},this.read=o.readOffset||0,this.growSize=o.growSize||1024;var $=util$7.isArrayBuffer(_),j=util$7.isArrayBufferView(_);if($||j){$?this.data=new DataView(_):this.data=new DataView(_.buffer,_.byteOffset,_.byteLength),this.write="writeOffset"in o?o.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,_!=null&&this.putBytes(_),"writeOffset"in o&&(this.write=o.writeOffset)}util$7.DataBuffer=DataBuffer;util$7.DataBuffer.prototype.length=function(){return this.write-this.read};util$7.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};util$7.DataBuffer.prototype.accommodate=function(_,o){if(this.length()>=_)return this;o=Math.max(o||this.growSize,_);var $=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),j=new Uint8Array(this.length()+o);return j.set($),this.data=new DataView(j.buffer),this};util$7.DataBuffer.prototype.putByte=function(_){return this.accommodate(1),this.data.setUint8(this.write++,_),this};util$7.DataBuffer.prototype.fillWithByte=function(_,o){this.accommodate(o);for(var $=0;$<o;++$)this.data.setUint8(_);return this};util$7.DataBuffer.prototype.putBytes=function(_,o){if(util$7.isArrayBufferView(_)){var $=new Uint8Array(_.buffer,_.byteOffset,_.byteLength),j=$.byteLength-$.byteOffset;this.accommodate(j);var et=new Uint8Array(this.data.buffer,this.write);return et.set($),this.write+=j,this}if(util$7.isArrayBuffer(_)){var $=new Uint8Array(_);this.accommodate($.byteLength);var et=new Uint8Array(this.data.buffer);return et.set($,this.write),this.write+=$.byteLength,this}if(_ instanceof util$7.DataBuffer||typeof _=="object"&&typeof _.read=="number"&&typeof _.write=="number"&&util$7.isArrayBufferView(_.data)){var $=new Uint8Array(_.data.byteLength,_.read,_.length());this.accommodate($.byteLength);var et=new Uint8Array(_.data.byteLength,this.write);return et.set($),this.write+=$.byteLength,this}if(_ instanceof util$7.ByteStringBuffer&&(_=_.data,o="binary"),o=o||"binary",typeof _=="string"){var tt;if(o==="hex")return this.accommodate(Math.ceil(_.length/2)),tt=new Uint8Array(this.data.buffer,this.write),this.write+=util$7.binary.hex.decode(_,tt,this.write),this;if(o==="base64")return this.accommodate(Math.ceil(_.length/4)*3),tt=new Uint8Array(this.data.buffer,this.write),this.write+=util$7.binary.base64.decode(_,tt,this.write),this;if(o==="utf8"&&(_=util$7.encodeUtf8(_),o="binary"),o==="binary"||o==="raw")return this.accommodate(_.length),tt=new Uint8Array(this.data.buffer,this.write),this.write+=util$7.binary.raw.decode(tt),this;if(o==="utf16")return this.accommodate(_.length*2),tt=new Uint16Array(this.data.buffer,this.write),this.write+=util$7.text.utf16.encode(tt),this;throw new Error("Invalid encoding: "+o)}throw Error("Invalid parameter: "+_)};util$7.DataBuffer.prototype.putBuffer=function(_){return this.putBytes(_),_.clear(),this};util$7.DataBuffer.prototype.putString=function(_){return this.putBytes(_,"utf16")};util$7.DataBuffer.prototype.putInt16=function(_){return this.accommodate(2),this.data.setInt16(this.write,_),this.write+=2,this};util$7.DataBuffer.prototype.putInt24=function(_){return this.accommodate(3),this.data.setInt16(this.write,_>>8&65535),this.data.setInt8(this.write,_>>16&255),this.write+=3,this};util$7.DataBuffer.prototype.putInt32=function(_){return this.accommodate(4),this.data.setInt32(this.write,_),this.write+=4,this};util$7.DataBuffer.prototype.putInt16Le=function(_){return this.accommodate(2),this.data.setInt16(this.write,_,!0),this.write+=2,this};util$7.DataBuffer.prototype.putInt24Le=function(_){return this.accommodate(3),this.data.setInt8(this.write,_>>16&255),this.data.setInt16(this.write,_>>8&65535,!0),this.write+=3,this};util$7.DataBuffer.prototype.putInt32Le=function(_){return this.accommodate(4),this.data.setInt32(this.write,_,!0),this.write+=4,this};util$7.DataBuffer.prototype.putInt=function(_,o){_checkBitsParam(o),this.accommodate(o/8);do o-=8,this.data.setInt8(this.write++,_>>o&255);while(o>0);return this};util$7.DataBuffer.prototype.putSignedInt=function(_,o){return _checkBitsParam(o),this.accommodate(o/8),_<0&&(_+=2<<o-1),this.putInt(_,o)};util$7.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};util$7.DataBuffer.prototype.getInt16=function(){var _=this.data.getInt16(this.read);return this.read+=2,_};util$7.DataBuffer.prototype.getInt24=function(){var _=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,_};util$7.DataBuffer.prototype.getInt32=function(){var _=this.data.getInt32(this.read);return this.read+=4,_};util$7.DataBuffer.prototype.getInt16Le=function(){var _=this.data.getInt16(this.read,!0);return this.read+=2,_};util$7.DataBuffer.prototype.getInt24Le=function(){var _=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,_};util$7.DataBuffer.prototype.getInt32Le=function(){var _=this.data.getInt32(this.read,!0);return this.read+=4,_};util$7.DataBuffer.prototype.getInt=function(_){_checkBitsParam(_);var o=0;do o=(o<<8)+this.data.getInt8(this.read++),_-=8;while(_>0);return o};util$7.DataBuffer.prototype.getSignedInt=function(_){var o=this.getInt(_),$=2<<_-2;return o>=$&&(o-=$<<1),o};util$7.DataBuffer.prototype.getBytes=function(_){var o;return _?(_=Math.min(this.length(),_),o=this.data.slice(this.read,this.read+_),this.read+=_):_===0?o="":(o=this.read===0?this.data:this.data.slice(this.read),this.clear()),o};util$7.DataBuffer.prototype.bytes=function(_){return typeof _>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+_)};util$7.DataBuffer.prototype.at=function(_){return this.data.getUint8(this.read+_)};util$7.DataBuffer.prototype.setAt=function(_,o){return this.data.setUint8(_,o),this};util$7.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};util$7.DataBuffer.prototype.copy=function(){return new util$7.DataBuffer(this)};util$7.DataBuffer.prototype.compact=function(){if(this.read>0){var _=new Uint8Array(this.data.buffer,this.read),o=new Uint8Array(_.byteLength);o.set(_),this.data=new DataView(o),this.write-=this.read,this.read=0}return this};util$7.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};util$7.DataBuffer.prototype.truncate=function(_){return this.write=Math.max(0,this.length()-_),this.read=Math.min(this.read,this.write),this};util$7.DataBuffer.prototype.toHex=function(){for(var _="",o=this.read;o<this.data.byteLength;++o){var $=this.data.getUint8(o);$<16&&(_+="0"),_+=$.toString(16)}return _};util$7.DataBuffer.prototype.toString=function(_){var o=new Uint8Array(this.data,this.read,this.length());if(_=_||"utf8",_==="binary"||_==="raw")return util$7.binary.raw.encode(o);if(_==="hex")return util$7.binary.hex.encode(o);if(_==="base64")return util$7.binary.base64.encode(o);if(_==="utf8")return util$7.text.utf8.decode(o);if(_==="utf16")return util$7.text.utf16.decode(o);throw new Error("Invalid encoding: "+_)};util$7.createBuffer=function(_,o){return o=o||"raw",_!==void 0&&o==="utf8"&&(_=util$7.encodeUtf8(_)),new util$7.ByteBuffer(_)};util$7.fillString=function(_,o){for(var $="";o>0;)o&1&&($+=_),o>>>=1,o>0&&(_+=_);return $};util$7.xorBytes=function(_,o,$){for(var j="",et="",tt="",rt=0,nt=0;$>0;--$,++rt)et=_.charCodeAt(rt)^o.charCodeAt(rt),nt>=10&&(j+=tt,tt="",nt=0),tt+=String.fromCharCode(et),++nt;return j+=tt,j};util$7.hexToBytes=function(_){var o="",$=0;for(_.length&!0&&($=1,o+=String.fromCharCode(parseInt(_[0],16)));$<_.length;$+=2)o+=String.fromCharCode(parseInt(_.substr($,2),16));return o};util$7.bytesToHex=function(_){return util$7.createBuffer(_).toHex()};util$7.int32ToBytes=function(_){return String.fromCharCode(_>>24&255)+String.fromCharCode(_>>16&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_&255)};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_base64Idx=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_base58="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";util$7.encode64=function(_,o){for(var $="",j="",et,tt,rt,nt=0;nt<_.length;)et=_.charCodeAt(nt++),tt=_.charCodeAt(nt++),rt=_.charCodeAt(nt++),$+=_base64.charAt(et>>2),$+=_base64.charAt((et&3)<<4|tt>>4),isNaN(tt)?$+="==":($+=_base64.charAt((tt&15)<<2|rt>>6),$+=isNaN(rt)?"=":_base64.charAt(rt&63)),o&&$.length>o&&(j+=$.substr(0,o)+`\r
`,$=$.substr(o));return j+=$,j};util$7.decode64=function(_){_=_.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var o="",$,j,et,tt,rt=0;rt<_.length;)$=_base64Idx[_.charCodeAt(rt++)-43],j=_base64Idx[_.charCodeAt(rt++)-43],et=_base64Idx[_.charCodeAt(rt++)-43],tt=_base64Idx[_.charCodeAt(rt++)-43],o+=String.fromCharCode($<<2|j>>4),et!==64&&(o+=String.fromCharCode((j&15)<<4|et>>2),tt!==64&&(o+=String.fromCharCode((et&3)<<6|tt)));return o};util$7.encodeUtf8=function(_){return unescape(encodeURIComponent(_))};util$7.decodeUtf8=function(_){return decodeURIComponent(escape(_))};util$7.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:baseN.encode,decode:baseN.decode}};util$7.binary.raw.encode=function(_){return String.fromCharCode.apply(null,_)};util$7.binary.raw.decode=function(_,o,$){var j=o;j||(j=new Uint8Array(_.length)),$=$||0;for(var et=$,tt=0;tt<_.length;++tt)j[et++]=_.charCodeAt(tt);return o?et-$:j};util$7.binary.hex.encode=util$7.bytesToHex;util$7.binary.hex.decode=function(_,o,$){var j=o;j||(j=new Uint8Array(Math.ceil(_.length/2))),$=$||0;var et=0,tt=$;for(_.length&1&&(et=1,j[tt++]=parseInt(_[0],16));et<_.length;et+=2)j[tt++]=parseInt(_.substr(et,2),16);return o?tt-$:j};util$7.binary.base64.encode=function(_,o){for(var $="",j="",et,tt,rt,nt=0;nt<_.byteLength;)et=_[nt++],tt=_[nt++],rt=_[nt++],$+=_base64.charAt(et>>2),$+=_base64.charAt((et&3)<<4|tt>>4),isNaN(tt)?$+="==":($+=_base64.charAt((tt&15)<<2|rt>>6),$+=isNaN(rt)?"=":_base64.charAt(rt&63)),o&&$.length>o&&(j+=$.substr(0,o)+`\r
`,$=$.substr(o));return j+=$,j};util$7.binary.base64.decode=function(_,o,$){var j=o;j||(j=new Uint8Array(Math.ceil(_.length/4)*3)),_=_.replace(/[^A-Za-z0-9\+\/\=]/g,""),$=$||0;for(var et,tt,rt,nt,it=0,st=$;it<_.length;)et=_base64Idx[_.charCodeAt(it++)-43],tt=_base64Idx[_.charCodeAt(it++)-43],rt=_base64Idx[_.charCodeAt(it++)-43],nt=_base64Idx[_.charCodeAt(it++)-43],j[st++]=et<<2|tt>>4,rt!==64&&(j[st++]=(tt&15)<<4|rt>>2,nt!==64&&(j[st++]=(rt&3)<<6|nt));return o?st-$:j.subarray(0,st)};util$7.binary.base58.encode=function(_,o){return util$7.binary.baseN.encode(_,_base58,o)};util$7.binary.base58.decode=function(_,o){return util$7.binary.baseN.decode(_,_base58,o)};util$7.text={utf8:{},utf16:{}};util$7.text.utf8.encode=function(_,o,$){_=util$7.encodeUtf8(_);var j=o;j||(j=new Uint8Array(_.length)),$=$||0;for(var et=$,tt=0;tt<_.length;++tt)j[et++]=_.charCodeAt(tt);return o?et-$:j};util$7.text.utf8.decode=function(_){return util$7.decodeUtf8(String.fromCharCode.apply(null,_))};util$7.text.utf16.encode=function(_,o,$){var j=o;j||(j=new Uint8Array(_.length*2));var et=new Uint16Array(j.buffer);$=$||0;for(var tt=$,rt=$,nt=0;nt<_.length;++nt)et[rt++]=_.charCodeAt(nt),tt+=2;return o?tt-$:j};util$7.text.utf16.decode=function(_){return String.fromCharCode.apply(null,new Uint16Array(_.buffer))};util$7.deflate=function(_,o,$){if(o=util$7.decode64(_.deflate(util$7.encode64(o)).rval),$){var j=2,et=o.charCodeAt(1);et&32&&(j=6),o=o.substring(j,o.length-4)}return o};util$7.inflate=function(_,o,$){var j=_.inflate(util$7.encode64(o)).rval;return j===null?null:util$7.decode64(j)};var _setStorageObject=function(_,o,$){if(!_)throw new Error("WebStorage not available.");var j;if($===null?j=_.removeItem(o):($=util$7.encode64(JSON.stringify($)),j=_.setItem(o,$)),typeof j<"u"&&j.rval!==!0){var et=new Error(j.error.message);throw et.id=j.error.id,et.name=j.error.name,et}},_getStorageObject=function(_,o){if(!_)throw new Error("WebStorage not available.");var $=_.getItem(o);if(_.init)if($.rval===null){if($.error){var j=new Error($.error.message);throw j.id=$.error.id,j.name=$.error.name,j}$=null}else $=$.rval;return $!==null&&($=JSON.parse(util$7.decode64($))),$},_setItem=function(_,o,$,j){var et=_getStorageObject(_,o);et===null&&(et={}),et[$]=j,_setStorageObject(_,o,et)},_getItem=function(_,o,$){var j=_getStorageObject(_,o);return j!==null&&(j=$ in j?j[$]:null),j},_removeItem=function(_,o,$){var j=_getStorageObject(_,o);if(j!==null&&$ in j){delete j[$];var et=!0;for(var tt in j){et=!1;break}et&&(j=null),_setStorageObject(_,o,j)}},_clearItems=function(_,o){_setStorageObject(_,o,null)},_callStorageFunction=function(_,o,$){var j=null;typeof $>"u"&&($=["web","flash"]);var et,tt=!1,rt=null;for(var nt in $){et=$[nt];try{if(et==="flash"||et==="both"){if(o[0]===null)throw new Error("Flash local storage not available.");j=_.apply(this,o),tt=et==="flash"}(et==="web"||et==="both")&&(o[0]=localStorage,j=_.apply(this,o),tt=!0)}catch(it){rt=it}if(tt)break}if(!tt)throw rt;return j};util$7.setItem=function(_,o,$,j,et){_callStorageFunction(_setItem,arguments,et)};util$7.getItem=function(_,o,$,j){return _callStorageFunction(_getItem,arguments,j)};util$7.removeItem=function(_,o,$,j){_callStorageFunction(_removeItem,arguments,j)};util$7.clearItems=function(_,o,$){_callStorageFunction(_clearItems,arguments,$)};util$7.isEmpty=function(_){for(var o in _)if(_.hasOwnProperty(o))return!1;return!0};util$7.format=function(_){for(var o=/%./g,$,j,et=0,tt=[],rt=0;$=o.exec(_);){j=_.substring(rt,o.lastIndex-2),j.length>0&&tt.push(j),rt=o.lastIndex;var nt=$[0][1];switch(nt){case"s":case"o":et<arguments.length?tt.push(arguments[et+++1]):tt.push("<?>");break;case"%":tt.push("%");break;default:tt.push("<%"+nt+"?>")}}return tt.push(_.substring(rt)),tt.join("")};util$7.formatNumber=function(_,o,$,j){var et=_,tt=isNaN(o=Math.abs(o))?2:o,rt=$===void 0?",":$,nt=j===void 0?".":j,it=et<0?"-":"",st=parseInt(et=Math.abs(+et||0).toFixed(tt),10)+"",ot=st.length>3?st.length%3:0;return it+(ot?st.substr(0,ot)+nt:"")+st.substr(ot).replace(/(\d{3})(?=\d)/g,"$1"+nt)+(tt?rt+Math.abs(et-st).toFixed(tt).slice(2):"")};util$7.formatSize=function(_){return _>=1073741824?_=util$7.formatNumber(_/1073741824,2,".","")+" GiB":_>=1048576?_=util$7.formatNumber(_/1048576,2,".","")+" MiB":_>=1024?_=util$7.formatNumber(_/1024,0)+" KiB":_=util$7.formatNumber(_,0)+" bytes",_};util$7.bytesFromIP=function(_){return _.indexOf(".")!==-1?util$7.bytesFromIPv4(_):_.indexOf(":")!==-1?util$7.bytesFromIPv6(_):null};util$7.bytesFromIPv4=function(_){if(_=_.split("."),_.length!==4)return null;for(var o=util$7.createBuffer(),$=0;$<_.length;++$){var j=parseInt(_[$],10);if(isNaN(j))return null;o.putByte(j)}return o.getBytes()};util$7.bytesFromIPv6=function(_){var o=0;_=_.split(":").filter(function(rt){return rt.length===0&&++o,!0});for(var $=(8-_.length+o)*2,j=util$7.createBuffer(),et=0;et<8;++et){if(!_[et]||_[et].length===0){j.fillWithByte(0,$),$=0;continue}var tt=util$7.hexToBytes(_[et]);tt.length<2&&j.putByte(0),j.putBytes(tt)}return j.getBytes()};util$7.bytesToIP=function(_){return _.length===4?util$7.bytesToIPv4(_):_.length===16?util$7.bytesToIPv6(_):null};util$7.bytesToIPv4=function(_){if(_.length!==4)return null;for(var o=[],$=0;$<_.length;++$)o.push(_.charCodeAt($));return o.join(".")};util$7.bytesToIPv6=function(_){if(_.length!==16)return null;for(var o=[],$=[],j=0,et=0;et<_.length;et+=2){for(var tt=util$7.bytesToHex(_[et]+_[et+1]);tt[0]==="0"&&tt!=="0";)tt=tt.substr(1);if(tt==="0"){var rt=$[$.length-1],nt=o.length;!rt||nt!==rt.end+1?$.push({start:nt,end:nt}):(rt.end=nt,rt.end-rt.start>$[j].end-$[j].start&&(j=$.length-1))}o.push(tt)}if($.length>0){var it=$[j];it.end-it.start>0&&(o.splice(it.start,it.end-it.start+1,""),it.start===0&&o.unshift(""),it.end===7&&o.push(""))}return o.join(":")};util$7.estimateCores=function(_,o){if(typeof _=="function"&&(o=_,_={}),_=_||{},"cores"in util$7&&!_.update)return o(null,util$7.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return util$7.cores=navigator.hardwareConcurrency,o(null,util$7.cores);if(typeof Worker>"u")return util$7.cores=1,o(null,util$7.cores);if(typeof Blob>"u")return util$7.cores=2,o(null,util$7.cores);var $=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(rt){var nt=Date.now(),it=nt+4;self.postMessage({st:nt,et:it})})}.toString(),")()"],{type:"application/javascript"}));j([],5,16);function j(rt,nt,it){if(nt===0){var st=Math.floor(rt.reduce(function(ot,at){return ot+at},0)/rt.length);return util$7.cores=Math.max(1,st),URL.revokeObjectURL($),o(null,util$7.cores)}et(it,function(ot,at){rt.push(tt(it,at)),j(rt,nt-1,it)})}function et(rt,nt){for(var it=[],st=[],ot=0;ot<rt;++ot){var at=new Worker($);at.addEventListener("message",function(ct){if(st.push(ct.data),st.length===rt){for(var ut=0;ut<rt;++ut)it[ut].terminate();nt(null,st)}}),it.push(at)}for(var ot=0;ot<rt;++ot)it[ot].postMessage(ot)}function tt(rt,nt){for(var it=[],st=0;st<rt;++st)for(var ot=nt[st],at=it[st]=[],ct=0;ct<rt;++ct)if(st!==ct){var ut=nt[ct];(ot.st>ut.st&&ot.st<ut.et||ut.st>ot.st&&ut.st<ot.et)&&at.push(ct)}return it.reduce(function(ft,ht){return Math.max(ft,ht.length)},0)}};var forge$q=forge$s;forge$q.cipher=forge$q.cipher||{};forge$q.cipher.algorithms=forge$q.cipher.algorithms||{};forge$q.cipher.createCipher=function(_,o){var $=_;if(typeof $=="string"&&($=forge$q.cipher.getAlgorithm($),$&&($=$())),!$)throw new Error("Unsupported algorithm: "+_);return new forge$q.cipher.BlockCipher({algorithm:$,key:o,decrypt:!1})};forge$q.cipher.createDecipher=function(_,o){var $=_;if(typeof $=="string"&&($=forge$q.cipher.getAlgorithm($),$&&($=$())),!$)throw new Error("Unsupported algorithm: "+_);return new forge$q.cipher.BlockCipher({algorithm:$,key:o,decrypt:!0})};forge$q.cipher.registerAlgorithm=function(_,o){_=_.toUpperCase(),forge$q.cipher.algorithms[_]=o};forge$q.cipher.getAlgorithm=function(_){return _=_.toUpperCase(),_ in forge$q.cipher.algorithms?forge$q.cipher.algorithms[_]:null};var BlockCipher=forge$q.cipher.BlockCipher=function(_){this.algorithm=_.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=_.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=_.decrypt,this.algorithm.initialize(_)};BlockCipher.prototype.start=function(_){_=_||{};var o={};for(var $ in _)o[$]=_[$];o.decrypt=this._decrypt,this._finish=!1,this._input=forge$q.util.createBuffer(),this.output=_.output||forge$q.util.createBuffer(),this.mode.start(o)};BlockCipher.prototype.update=function(_){for(_&&this._input.putBuffer(_);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};BlockCipher.prototype.finish=function(_){_&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function($){return _(this.blockSize,$,!1)},this.mode.unpad=function($){return _(this.blockSize,$,!0)});var o={};return o.decrypt=this._decrypt,o.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,o)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,o))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,o))};var forge$p=forge$s;forge$p.cipher=forge$p.cipher||{};var modes$1=forge$p.cipher.modes=forge$p.cipher.modes||{};modes$1.ecb=function(_){_=_||{},this.name="ECB",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};modes$1.ecb.prototype.start=function(_){};modes$1.ecb.prototype.encrypt=function(_,o,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=_.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)o.putInt32(this._outBlock[j])};modes$1.ecb.prototype.decrypt=function(_,o,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=_.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)o.putInt32(this._outBlock[j])};modes$1.ecb.prototype.pad=function(_,o){var $=_.length()===this.blockSize?this.blockSize:this.blockSize-_.length();return _.fillWithByte($,$),!0};modes$1.ecb.prototype.unpad=function(_,o){if(o.overflow>0)return!1;var $=_.length(),j=_.at($-1);return j>this.blockSize<<2?!1:(_.truncate(j),!0)};modes$1.cbc=function(_){_=_||{},this.name="CBC",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};modes$1.cbc.prototype.start=function(_){if(_.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in _)this._iv=transformIV(_.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};modes$1.cbc.prototype.encrypt=function(_,o,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=this._prev[j]^_.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)o.putInt32(this._outBlock[j]);this._prev=this._outBlock};modes$1.cbc.prototype.decrypt=function(_,o,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=_.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)o.putInt32(this._prev[j]^this._outBlock[j]);this._prev=this._inBlock.slice(0)};modes$1.cbc.prototype.pad=function(_,o){var $=_.length()===this.blockSize?this.blockSize:this.blockSize-_.length();return _.fillWithByte($,$),!0};modes$1.cbc.prototype.unpad=function(_,o){if(o.overflow>0)return!1;var $=_.length(),j=_.at($-1);return j>this.blockSize<<2?!1:(_.truncate(j),!0)};modes$1.cfb=function(_){_=_||{},this.name="CFB",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=forge$p.util.createBuffer(),this._partialBytes=0};modes$1.cfb.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");this._iv=transformIV(_.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes$1.cfb.prototype.encrypt=function(_,o,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var et=0;et<this._ints;++et)this._inBlock[et]=_.getInt32()^this._outBlock[et],o.putInt32(this._inBlock[et]);return}var tt=(this.blockSize-j)%this.blockSize;tt>0&&(tt=this.blockSize-tt),this._partialOutput.clear();for(var et=0;et<this._ints;++et)this._partialBlock[et]=_.getInt32()^this._outBlock[et],this._partialOutput.putInt32(this._partialBlock[et]);if(tt>0)_.read-=this.blockSize;else for(var et=0;et<this._ints;++et)this._inBlock[et]=this._partialBlock[et];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),tt>0&&!$)return o.putBytes(this._partialOutput.getBytes(tt-this._partialBytes)),this._partialBytes=tt,!0;o.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0};modes$1.cfb.prototype.decrypt=function(_,o,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var et=0;et<this._ints;++et)this._inBlock[et]=_.getInt32(),o.putInt32(this._inBlock[et]^this._outBlock[et]);return}var tt=(this.blockSize-j)%this.blockSize;tt>0&&(tt=this.blockSize-tt),this._partialOutput.clear();for(var et=0;et<this._ints;++et)this._partialBlock[et]=_.getInt32(),this._partialOutput.putInt32(this._partialBlock[et]^this._outBlock[et]);if(tt>0)_.read-=this.blockSize;else for(var et=0;et<this._ints;++et)this._inBlock[et]=this._partialBlock[et];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),tt>0&&!$)return o.putBytes(this._partialOutput.getBytes(tt-this._partialBytes)),this._partialBytes=tt,!0;o.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0};modes$1.ofb=function(_){_=_||{},this.name="OFB",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$p.util.createBuffer(),this._partialBytes=0};modes$1.ofb.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");this._iv=transformIV(_.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes$1.ofb.prototype.encrypt=function(_,o,$){var j=_.length();if(_.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var et=0;et<this._ints;++et)o.putInt32(_.getInt32()^this._outBlock[et]),this._inBlock[et]=this._outBlock[et];return}var tt=(this.blockSize-j)%this.blockSize;tt>0&&(tt=this.blockSize-tt),this._partialOutput.clear();for(var et=0;et<this._ints;++et)this._partialOutput.putInt32(_.getInt32()^this._outBlock[et]);if(tt>0)_.read-=this.blockSize;else for(var et=0;et<this._ints;++et)this._inBlock[et]=this._outBlock[et];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),tt>0&&!$)return o.putBytes(this._partialOutput.getBytes(tt-this._partialBytes)),this._partialBytes=tt,!0;o.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0};modes$1.ofb.prototype.decrypt=modes$1.ofb.prototype.encrypt;modes$1.ctr=function(_){_=_||{},this.name="CTR",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$p.util.createBuffer(),this._partialBytes=0};modes$1.ctr.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");this._iv=transformIV(_.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes$1.ctr.prototype.encrypt=function(_,o,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize)for(var et=0;et<this._ints;++et)o.putInt32(_.getInt32()^this._outBlock[et]);else{var tt=(this.blockSize-j)%this.blockSize;tt>0&&(tt=this.blockSize-tt),this._partialOutput.clear();for(var et=0;et<this._ints;++et)this._partialOutput.putInt32(_.getInt32()^this._outBlock[et]);if(tt>0&&(_.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),tt>0&&!$)return o.putBytes(this._partialOutput.getBytes(tt-this._partialBytes)),this._partialBytes=tt,!0;o.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0}inc32(this._inBlock)};modes$1.ctr.prototype.decrypt=modes$1.ctr.prototype.encrypt;modes$1.gcm=function(_){_=_||{},this.name="GCM",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=forge$p.util.createBuffer(),this._partialBytes=0,this._R=3774873600};modes$1.gcm.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");var o=forge$p.util.createBuffer(_.iv);this._cipherLength=0;var $;if("additionalData"in _?$=forge$p.util.createBuffer(_.additionalData):$=forge$p.util.createBuffer(),"tagLength"in _?this._tagLength=_.tagLength:this._tagLength=128,this._tag=null,_.decrypt&&(this._tag=forge$p.util.createBuffer(_.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var j=o.length();if(j===12)this._j0=[o.getInt32(),o.getInt32(),o.getInt32(),1];else{for(this._j0=[0,0,0,0];o.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[o.getInt32(),o.getInt32(),o.getInt32(),o.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(j*8)))}this._inBlock=this._j0.slice(0),inc32(this._inBlock),this._partialBytes=0,$=forge$p.util.createBuffer($),this._aDataLength=from64To32($.length()*8);var et=$.length()%this.blockSize;for(et&&$.fillWithByte(0,this.blockSize-et),this._s=[0,0,0,0];$.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[$.getInt32(),$.getInt32(),$.getInt32(),$.getInt32()])};modes$1.gcm.prototype.encrypt=function(_,o,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var et=0;et<this._ints;++et)o.putInt32(this._outBlock[et]^=_.getInt32());this._cipherLength+=this.blockSize}else{var tt=(this.blockSize-j)%this.blockSize;tt>0&&(tt=this.blockSize-tt),this._partialOutput.clear();for(var et=0;et<this._ints;++et)this._partialOutput.putInt32(_.getInt32()^this._outBlock[et]);if(tt<=0||$){if($){var rt=j%this.blockSize;this._cipherLength+=rt,this._partialOutput.truncate(this.blockSize-rt)}else this._cipherLength+=this.blockSize;for(var et=0;et<this._ints;++et)this._outBlock[et]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),tt>0&&!$)return _.read-=this.blockSize,o.putBytes(this._partialOutput.getBytes(tt-this._partialBytes)),this._partialBytes=tt,!0;o.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),inc32(this._inBlock)};modes$1.gcm.prototype.decrypt=function(_,o,$){var j=_.length();if(j<this.blockSize&&!($&&j>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),inc32(this._inBlock),this._hashBlock[0]=_.getInt32(),this._hashBlock[1]=_.getInt32(),this._hashBlock[2]=_.getInt32(),this._hashBlock[3]=_.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var et=0;et<this._ints;++et)o.putInt32(this._outBlock[et]^this._hashBlock[et]);j<this.blockSize?this._cipherLength+=j%this.blockSize:this._cipherLength+=this.blockSize};modes$1.gcm.prototype.afterFinish=function(_,o){var $=!0;o.decrypt&&o.overflow&&_.truncate(this.blockSize-o.overflow),this.tag=forge$p.util.createBuffer();var j=this._aDataLength.concat(from64To32(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,j);var et=[];this.cipher.encrypt(this._j0,et);for(var tt=0;tt<this._ints;++tt)this.tag.putInt32(this._s[tt]^et[tt]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),o.decrypt&&this.tag.bytes()!==this._tag&&($=!1),$};modes$1.gcm.prototype.multiply=function(_,o){for(var $=[0,0,0,0],j=o.slice(0),et=0;et<128;++et){var tt=_[et/32|0]&1<<31-et%32;tt&&($[0]^=j[0],$[1]^=j[1],$[2]^=j[2],$[3]^=j[3]),this.pow(j,j)}return $};modes$1.gcm.prototype.pow=function(_,o){for(var $=_[3]&1,j=3;j>0;--j)o[j]=_[j]>>>1|(_[j-1]&1)<<31;o[0]=_[0]>>>1,$&&(o[0]^=this._R)};modes$1.gcm.prototype.tableMultiply=function(_){for(var o=[0,0,0,0],$=0;$<32;++$){var j=$/8|0,et=_[j]>>>(7-$%8)*4&15,tt=this._m[$][et];o[0]^=tt[0],o[1]^=tt[1],o[2]^=tt[2],o[3]^=tt[3]}return o};modes$1.gcm.prototype.ghash=function(_,o,$){return o[0]^=$[0],o[1]^=$[1],o[2]^=$[2],o[3]^=$[3],this.tableMultiply(o)};modes$1.gcm.prototype.generateHashTable=function(_,o){for(var $=8/o,j=4*$,et=16*$,tt=new Array(et),rt=0;rt<et;++rt){var nt=[0,0,0,0],it=rt/j|0,st=(j-1-rt%j)*o;nt[it]=1<<o-1<<st,tt[rt]=this.generateSubHashTable(this.multiply(nt,_),o)}return tt};modes$1.gcm.prototype.generateSubHashTable=function(_,o){var $=1<<o,j=$>>>1,et=new Array($);et[j]=_.slice(0);for(var tt=j>>>1;tt>0;)this.pow(et[2*tt],et[tt]=[]),tt>>=1;for(tt=2;tt<j;){for(var rt=1;rt<tt;++rt){var nt=et[tt],it=et[rt];et[tt+rt]=[nt[0]^it[0],nt[1]^it[1],nt[2]^it[2],nt[3]^it[3]]}tt*=2}for(et[0]=[0,0,0,0],tt=j+1;tt<$;++tt){var st=et[tt^j];et[tt]=[_[0]^st[0],_[1]^st[1],_[2]^st[2],_[3]^st[3]]}return et};function transformIV(_,o){if(typeof _=="string"&&(_=forge$p.util.createBuffer(_)),forge$p.util.isArray(_)&&_.length>4){var $=_;_=forge$p.util.createBuffer();for(var j=0;j<$.length;++j)_.putByte($[j])}if(_.length()<o)throw new Error("Invalid IV length; got "+_.length()+" bytes and expected "+o+" bytes.");if(!forge$p.util.isArray(_)){for(var et=[],tt=o/4,j=0;j<tt;++j)et.push(_.getInt32());_=et}return _}function inc32(_){_[_.length-1]=_[_.length-1]+1&4294967295}function from64To32(_){return[_/4294967296|0,_&4294967295]}var forge$o=forge$s;forge$o.aes=forge$o.aes||{};forge$o.aes.startEncrypting=function(_,o,$,j){var et=_createCipher$1({key:_,output:$,decrypt:!1,mode:j});return et.start(o),et};forge$o.aes.createEncryptionCipher=function(_,o){return _createCipher$1({key:_,output:null,decrypt:!1,mode:o})};forge$o.aes.startDecrypting=function(_,o,$,j){var et=_createCipher$1({key:_,output:$,decrypt:!0,mode:j});return et.start(o),et};forge$o.aes.createDecryptionCipher=function(_,o){return _createCipher$1({key:_,output:null,decrypt:!0,mode:o})};forge$o.aes.Algorithm=function(_,o){init||initialize();var $=this;$.name=_,$.mode=new o({blockSize:16,cipher:{encrypt:function(j,et){return _updateBlock$1($._w,j,et,!1)},decrypt:function(j,et){return _updateBlock$1($._w,j,et,!0)}}}),$._init=!1};forge$o.aes.Algorithm.prototype.initialize=function(_){if(!this._init){var o=_.key,$;if(typeof o=="string"&&(o.length===16||o.length===24||o.length===32))o=forge$o.util.createBuffer(o);else if(forge$o.util.isArray(o)&&(o.length===16||o.length===24||o.length===32)){$=o,o=forge$o.util.createBuffer();for(var j=0;j<$.length;++j)o.putByte($[j])}if(!forge$o.util.isArray(o)){$=o,o=[];var et=$.length();if(et===16||et===24||et===32){et=et>>>2;for(var j=0;j<et;++j)o.push($.getInt32())}}if(!forge$o.util.isArray(o)||!(o.length===4||o.length===6||o.length===8))throw new Error("Invalid key parameter.");var tt=this.mode.name,rt=["CFB","OFB","CTR","GCM"].indexOf(tt)!==-1;this._w=_expandKey(o,_.decrypt&&!rt),this._init=!0}};forge$o.aes._expandKey=function(_,o){return init||initialize(),_expandKey(_,o)};forge$o.aes._updateBlock=_updateBlock$1;registerAlgorithm$1("AES-ECB",forge$o.cipher.modes.ecb);registerAlgorithm$1("AES-CBC",forge$o.cipher.modes.cbc);registerAlgorithm$1("AES-CFB",forge$o.cipher.modes.cfb);registerAlgorithm$1("AES-OFB",forge$o.cipher.modes.ofb);registerAlgorithm$1("AES-CTR",forge$o.cipher.modes.ctr);registerAlgorithm$1("AES-GCM",forge$o.cipher.modes.gcm);function registerAlgorithm$1(_,o){var $=function(){return new forge$o.aes.Algorithm(_,o)};forge$o.cipher.registerAlgorithm(_,$)}var init=!1,Nb=4,sbox,isbox,rcon,mix,imix;function initialize(){init=!0,rcon=[0,1,2,4,8,16,32,64,128,27,54];for(var _=new Array(256),o=0;o<128;++o)_[o]=o<<1,_[o+128]=o+128<<1^283;sbox=new Array(256),isbox=new Array(256),mix=new Array(4),imix=new Array(4);for(var o=0;o<4;++o)mix[o]=new Array(256),imix[o]=new Array(256);for(var $=0,j=0,et,tt,rt,nt,it,st,ot,o=0;o<256;++o){nt=j^j<<1^j<<2^j<<3^j<<4,nt=nt>>8^nt&255^99,sbox[$]=nt,isbox[nt]=$,it=_[nt],et=_[$],tt=_[et],rt=_[tt],st=it<<24^nt<<16^nt<<8^(nt^it),ot=(et^tt^rt)<<24^($^rt)<<16^($^tt^rt)<<8^($^et^rt);for(var at=0;at<4;++at)mix[at][$]=st,imix[at][nt]=ot,st=st<<24|st>>>8,ot=ot<<24|ot>>>8;$===0?$=j=1:($=et^_[_[_[et^rt]]],j^=_[_[j]])}}function _expandKey(_,o){for(var $=_.slice(0),j,et=1,tt=$.length,rt=tt+6+1,nt=Nb*rt,it=tt;it<nt;++it)j=$[it-1],it%tt===0?(j=sbox[j>>>16&255]<<24^sbox[j>>>8&255]<<16^sbox[j&255]<<8^sbox[j>>>24]^rcon[et]<<24,et++):tt>6&&it%tt===4&&(j=sbox[j>>>24]<<24^sbox[j>>>16&255]<<16^sbox[j>>>8&255]<<8^sbox[j&255]),$[it]=$[it-tt]^j;if(o){var st,ot=imix[0],at=imix[1],ct=imix[2],ut=imix[3],ft=$.slice(0);nt=$.length;for(var it=0,ht=nt-Nb;it<nt;it+=Nb,ht-=Nb)if(it===0||it===nt-Nb)ft[it]=$[ht],ft[it+1]=$[ht+3],ft[it+2]=$[ht+2],ft[it+3]=$[ht+1];else for(var mt=0;mt<Nb;++mt)st=$[ht+mt],ft[it+(3&-mt)]=ot[sbox[st>>>24]]^at[sbox[st>>>16&255]]^ct[sbox[st>>>8&255]]^ut[sbox[st&255]];$=ft}return $}function _updateBlock$1(_,o,$,j){var et=_.length/4-1,tt,rt,nt,it,st;j?(tt=imix[0],rt=imix[1],nt=imix[2],it=imix[3],st=isbox):(tt=mix[0],rt=mix[1],nt=mix[2],it=mix[3],st=sbox);var ot,at,ct,ut,ft,ht,mt;ot=o[0]^_[0],at=o[j?3:1]^_[1],ct=o[2]^_[2],ut=o[j?1:3]^_[3];for(var gt=3,Et=1;Et<et;++Et)ft=tt[ot>>>24]^rt[at>>>16&255]^nt[ct>>>8&255]^it[ut&255]^_[++gt],ht=tt[at>>>24]^rt[ct>>>16&255]^nt[ut>>>8&255]^it[ot&255]^_[++gt],mt=tt[ct>>>24]^rt[ut>>>16&255]^nt[ot>>>8&255]^it[at&255]^_[++gt],ut=tt[ut>>>24]^rt[ot>>>16&255]^nt[at>>>8&255]^it[ct&255]^_[++gt],ot=ft,at=ht,ct=mt;$[0]=st[ot>>>24]<<24^st[at>>>16&255]<<16^st[ct>>>8&255]<<8^st[ut&255]^_[++gt],$[j?3:1]=st[at>>>24]<<24^st[ct>>>16&255]<<16^st[ut>>>8&255]<<8^st[ot&255]^_[++gt],$[2]=st[ct>>>24]<<24^st[ut>>>16&255]<<16^st[ot>>>8&255]<<8^st[at&255]^_[++gt],$[j?1:3]=st[ut>>>24]<<24^st[ot>>>16&255]<<16^st[at>>>8&255]<<8^st[ct&255]^_[++gt]}function _createCipher$1(_){_=_||{};var o=(_.mode||"CBC").toUpperCase(),$="AES-"+o,j;_.decrypt?j=forge$o.cipher.createDecipher($,_.key):j=forge$o.cipher.createCipher($,_.key);var et=j.start;return j.start=function(tt,rt){var nt=null;rt instanceof forge$o.util.ByteBuffer&&(nt=rt,rt={}),rt=rt||{},rt.output=nt,rt.iv=tt,et.call(j,rt)},j}const identity$5=from$8({prefix:"\0",name:"identity",encode:_=>toString$c(_),decode:_=>fromString$a(_)}),identityBase$2=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$5},Symbol.toStringTag,{value:"Module"})),base2$4=rfc4648$4({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$5=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$4},Symbol.toStringTag,{value:"Module"})),base8$4=rfc4648$4({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$5=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$4},Symbol.toStringTag,{value:"Module"})),base10$4=baseX$4({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$5=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$4},Symbol.toStringTag,{value:"Module"})),base16$4=rfc4648$4({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$2=rfc4648$4({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$5=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$4,base16upper:base16upper$2},Symbol.toStringTag,{value:"Module"})),base36$4=baseX$4({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$2=baseX$4({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$5=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$4,base36upper:base36upper$2},Symbol.toStringTag,{value:"Module"})),base64$6=rfc4648$4({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$2=rfc4648$4({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$4({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$2=rfc4648$4({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$7=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$6,base64pad:base64pad$2,base64url:base64url$2,base64urlpad:base64urlpad$2},Symbol.toStringTag,{value:"Module"})),alphabet$3=Array.from(""),alphabetBytesToChars$2=alphabet$3.reduce((_,o,$)=>(_[$]=o,_),[]),alphabetCharsToBytes$2=alphabet$3.reduce((_,o,$)=>(_[o.codePointAt(0)]=$,_),[]);function encode$y(_){return _.reduce((o,$)=>(o+=alphabetBytesToChars$2[$],o),"")}function decode$v(_){const o=[];for(const $ of _){const j=alphabetCharsToBytes$2[$.codePointAt(0)];if(j===void 0)throw new Error(`Non-base256emoji character: ${$}`);o.push(j)}return new Uint8Array(o)}const base256emoji$4=from$8({prefix:"",name:"base256emoji",encode:encode$y,decode:decode$v}),base256emoji$5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$4},Symbol.toStringTag,{value:"Module"})),code$7=0,name$9="identity",encode$x=coerce$4,digest$1=_=>create$c(code$7,encode$x(_)),identity$3={code:code$7,name:name$9,encode:encode$x,digest:digest$1},identity$4=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$3},Symbol.toStringTag,{value:"Module"})),name$8="raw",code$6=85,encode$w=_=>coerce$4(_),decode$u=_=>coerce$4(_),raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,decode:decode$u,encode:encode$w,name:name$8},Symbol.toStringTag,{value:"Module"})),textEncoder=new TextEncoder,textDecoder=new TextDecoder,name$7="json",code$5=512,encode$v=_=>textEncoder.encode(JSON.stringify(_)),decode$t=_=>JSON.parse(textDecoder.decode(_)),json=Object.freeze(Object.defineProperty({__proto__:null,code:code$5,decode:decode$t,encode:encode$v,name:name$7},Symbol.toStringTag,{value:"Module"})),bases$2={...identityBase$2,...base2$5,...base8$5,...base10$5,...base16$5,...base32$7,...base36$5,...base58$2,...base64$7,...base256emoji$5},hashes={...sha2,...identity$4},codecs={raw,json};function asUint8Array$2(_){return globalThis.Buffer!=null?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_}function alloc(_=0){var o;return((o=globalThis.Buffer)==null?void 0:o.alloc)!=null?asUint8Array$2(globalThis.Buffer.alloc(_)):new Uint8Array(_)}function allocUnsafe$5(_=0){var o;return((o=globalThis.Buffer)==null?void 0:o.allocUnsafe)!=null?asUint8Array$2(globalThis.Buffer.allocUnsafe(_)):new Uint8Array(_)}function createCodec$6(_,o,$,j){return{name:_,prefix:o,encoder:{name:_,prefix:o,encode:$},decoder:{decode:j}}}const string$2=createCodec$6("utf8","u",_=>"u"+new TextDecoder("utf8").decode(_),_=>new TextEncoder().encode(_.substring(1))),ascii$3=createCodec$6("ascii","a",_=>{let o="a";for(let $=0;$<_.length;$++)o+=String.fromCharCode(_[$]);return o},_=>{_=_.substring(1);const o=allocUnsafe$5(_.length);for(let $=0;$<_.length;$++)o[$]=_.charCodeAt($);return o}),BASES$2={utf8:string$2,"utf-8":string$2,hex:bases$2.base16,latin1:ascii$3,ascii:ascii$3,binary:ascii$3,...bases$2};function toString$a(_,o="utf8"){const $=BASES$2[o];if($==null)throw new Error(`Unsupported encoding "${o}"`);return(o==="utf8"||o==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(_.buffer,_.byteOffset,_.byteLength).toString("utf8"):$.encoder.encode(_).substring(1)}function fromString$8(_,o="utf8"){const $=BASES$2[o];if($==null)throw new Error(`Unsupported encoding "${o}"`);return(o==="utf8"||o==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$2(globalThis.Buffer.from(_,"utf-8")):$.decoder.decode(`${$.prefix}${_}`)}let AbortError$5=class co extends Error{constructor(o="The operation was aborted"){super(o),this.code=co.code,this.type=co.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}};class CodeError extends Error{constructor(o,$,j){super(o),this.code=$,this.name=(j==null?void 0:j.name)??"CodeError",this.props=j??{}}}var minimal$3={},aspromise=asPromise;function asPromise(_,o){for(var $=new Array(arguments.length-1),j=0,et=2,tt=!0;et<arguments.length;)$[j++]=arguments[et++];return new Promise(function(nt,it){$[j]=function(ot){if(tt)if(tt=!1,ot)it(ot);else{for(var at=new Array(arguments.length-1),ct=0;ct<at.length;)at[ct++]=arguments[ct];nt.apply(null,at)}};try{_.apply(o||null,$)}catch(st){tt&&(tt=!1,it(st))}})}var base64$5={};(function(_){var o=_;o.length=function(nt){var it=nt.length;if(!it)return 0;for(var st=0;--it%4>1&&nt.charAt(it)==="=";)++st;return Math.ceil(nt.length*3)/4-st};for(var $=new Array(64),j=new Array(123),et=0;et<64;)j[$[et]=et<26?et+65:et<52?et+71:et<62?et-4:et-59|43]=et++;o.encode=function(nt,it,st){for(var ot=null,at=[],ct=0,ut=0,ft;it<st;){var ht=nt[it++];switch(ut){case 0:at[ct++]=$[ht>>2],ft=(ht&3)<<4,ut=1;break;case 1:at[ct++]=$[ft|ht>>4],ft=(ht&15)<<2,ut=2;break;case 2:at[ct++]=$[ft|ht>>6],at[ct++]=$[ht&63],ut=0;break}ct>8191&&((ot||(ot=[])).push(String.fromCharCode.apply(String,at)),ct=0)}return ut&&(at[ct++]=$[ft],at[ct++]=61,ut===1&&(at[ct++]=61)),ot?(ct&&ot.push(String.fromCharCode.apply(String,at.slice(0,ct))),ot.join("")):String.fromCharCode.apply(String,at.slice(0,ct))};var tt="invalid encoding";o.decode=function(nt,it,st){for(var ot=st,at=0,ct,ut=0;ut<nt.length;){var ft=nt.charCodeAt(ut++);if(ft===61&&at>1)break;if((ft=j[ft])===void 0)throw Error(tt);switch(at){case 0:ct=ft,at=1;break;case 1:it[st++]=ct<<2|(ft&48)>>4,ct=ft,at=2;break;case 2:it[st++]=(ct&15)<<4|(ft&60)>>2,ct=ft,at=3;break;case 3:it[st++]=(ct&3)<<6|ft,at=0;break}}if(at===1)throw Error(tt);return st-ot},o.test=function(nt){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(nt)}})(base64$5);var eventemitter=EventEmitter$2;function EventEmitter$2(){this._listeners={}}EventEmitter$2.prototype.on=function(o,$,j){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:$,ctx:j||this}),this};EventEmitter$2.prototype.off=function(o,$){if(o===void 0)this._listeners={};else if($===void 0)this._listeners[o]=[];else for(var j=this._listeners[o],et=0;et<j.length;)j[et].fn===$?j.splice(et,1):++et;return this};EventEmitter$2.prototype.emit=function(o){var $=this._listeners[o];if($){for(var j=[],et=1;et<arguments.length;)j.push(arguments[et++]);for(et=0;et<$.length;)$[et].fn.apply($[et++].ctx,j)}return this};var float=factory(factory);function factory(_){return typeof Float32Array<"u"?function(){var o=new Float32Array([-0]),$=new Uint8Array(o.buffer),j=$[3]===128;function et(it,st,ot){o[0]=it,st[ot]=$[0],st[ot+1]=$[1],st[ot+2]=$[2],st[ot+3]=$[3]}function tt(it,st,ot){o[0]=it,st[ot]=$[3],st[ot+1]=$[2],st[ot+2]=$[1],st[ot+3]=$[0]}_.writeFloatLE=j?et:tt,_.writeFloatBE=j?tt:et;function rt(it,st){return $[0]=it[st],$[1]=it[st+1],$[2]=it[st+2],$[3]=it[st+3],o[0]}function nt(it,st){return $[3]=it[st],$[2]=it[st+1],$[1]=it[st+2],$[0]=it[st+3],o[0]}_.readFloatLE=j?rt:nt,_.readFloatBE=j?nt:rt}():function(){function o(j,et,tt,rt){var nt=et<0?1:0;if(nt&&(et=-et),et===0)j(1/et>0?0:2147483648,tt,rt);else if(isNaN(et))j(2143289344,tt,rt);else if(et>34028234663852886e22)j((nt<<31|2139095040)>>>0,tt,rt);else if(et<11754943508222875e-54)j((nt<<31|Math.round(et/1401298464324817e-60))>>>0,tt,rt);else{var it=Math.floor(Math.log(et)/Math.LN2),st=Math.round(et*Math.pow(2,-it)*8388608)&8388607;j((nt<<31|it+127<<23|st)>>>0,tt,rt)}}_.writeFloatLE=o.bind(null,writeUintLE$1),_.writeFloatBE=o.bind(null,writeUintBE$1);function $(j,et,tt){var rt=j(et,tt),nt=(rt>>31)*2+1,it=rt>>>23&255,st=rt&8388607;return it===255?st?NaN:nt*(1/0):it===0?nt*1401298464324817e-60*st:nt*Math.pow(2,it-150)*(st+8388608)}_.readFloatLE=$.bind(null,readUintLE$1),_.readFloatBE=$.bind(null,readUintBE$1)}(),typeof Float64Array<"u"?function(){var o=new Float64Array([-0]),$=new Uint8Array(o.buffer),j=$[7]===128;function et(it,st,ot){o[0]=it,st[ot]=$[0],st[ot+1]=$[1],st[ot+2]=$[2],st[ot+3]=$[3],st[ot+4]=$[4],st[ot+5]=$[5],st[ot+6]=$[6],st[ot+7]=$[7]}function tt(it,st,ot){o[0]=it,st[ot]=$[7],st[ot+1]=$[6],st[ot+2]=$[5],st[ot+3]=$[4],st[ot+4]=$[3],st[ot+5]=$[2],st[ot+6]=$[1],st[ot+7]=$[0]}_.writeDoubleLE=j?et:tt,_.writeDoubleBE=j?tt:et;function rt(it,st){return $[0]=it[st],$[1]=it[st+1],$[2]=it[st+2],$[3]=it[st+3],$[4]=it[st+4],$[5]=it[st+5],$[6]=it[st+6],$[7]=it[st+7],o[0]}function nt(it,st){return $[7]=it[st],$[6]=it[st+1],$[5]=it[st+2],$[4]=it[st+3],$[3]=it[st+4],$[2]=it[st+5],$[1]=it[st+6],$[0]=it[st+7],o[0]}_.readDoubleLE=j?rt:nt,_.readDoubleBE=j?nt:rt}():function(){function o(j,et,tt,rt,nt,it){var st=rt<0?1:0;if(st&&(rt=-rt),rt===0)j(0,nt,it+et),j(1/rt>0?0:2147483648,nt,it+tt);else if(isNaN(rt))j(0,nt,it+et),j(2146959360,nt,it+tt);else if(rt>17976931348623157e292)j(0,nt,it+et),j((st<<31|2146435072)>>>0,nt,it+tt);else{var ot;if(rt<22250738585072014e-324)ot=rt/5e-324,j(ot>>>0,nt,it+et),j((st<<31|ot/4294967296)>>>0,nt,it+tt);else{var at=Math.floor(Math.log(rt)/Math.LN2);at===1024&&(at=1023),ot=rt*Math.pow(2,-at),j(ot*4503599627370496>>>0,nt,it+et),j((st<<31|at+1023<<20|ot*1048576&1048575)>>>0,nt,it+tt)}}}_.writeDoubleLE=o.bind(null,writeUintLE$1,0,4),_.writeDoubleBE=o.bind(null,writeUintBE$1,4,0);function $(j,et,tt,rt,nt){var it=j(rt,nt+et),st=j(rt,nt+tt),ot=(st>>31)*2+1,at=st>>>20&2047,ct=4294967296*(st&1048575)+it;return at===2047?ct?NaN:ot*(1/0):at===0?ot*5e-324*ct:ot*Math.pow(2,at-1075)*(ct+4503599627370496)}_.readDoubleLE=$.bind(null,readUintLE$1,0,4),_.readDoubleBE=$.bind(null,readUintBE$1,4,0)}(),_}function writeUintLE$1(_,o,$){o[$]=_&255,o[$+1]=_>>>8&255,o[$+2]=_>>>16&255,o[$+3]=_>>>24}function writeUintBE$1(_,o,$){o[$]=_>>>24,o[$+1]=_>>>16&255,o[$+2]=_>>>8&255,o[$+3]=_&255}function readUintLE$1(_,o){return(_[o]|_[o+1]<<8|_[o+2]<<16|_[o+3]<<24)>>>0}function readUintBE$1(_,o){return(_[o]<<24|_[o+1]<<16|_[o+2]<<8|_[o+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(_){}return null}var utf8$2={};(function(_){var o=_;o.length=function(j){for(var et=0,tt=0,rt=0;rt<j.length;++rt)tt=j.charCodeAt(rt),tt<128?et+=1:tt<2048?et+=2:(tt&64512)===55296&&(j.charCodeAt(rt+1)&64512)===56320?(++rt,et+=4):et+=3;return et},o.read=function(j,et,tt){var rt=tt-et;if(rt<1)return"";for(var nt=null,it=[],st=0,ot;et<tt;)ot=j[et++],ot<128?it[st++]=ot:ot>191&&ot<224?it[st++]=(ot&31)<<6|j[et++]&63:ot>239&&ot<365?(ot=((ot&7)<<18|(j[et++]&63)<<12|(j[et++]&63)<<6|j[et++]&63)-65536,it[st++]=55296+(ot>>10),it[st++]=56320+(ot&1023)):it[st++]=(ot&15)<<12|(j[et++]&63)<<6|j[et++]&63,st>8191&&((nt||(nt=[])).push(String.fromCharCode.apply(String,it)),st=0);return nt?(st&&nt.push(String.fromCharCode.apply(String,it.slice(0,st))),nt.join("")):String.fromCharCode.apply(String,it.slice(0,st))},o.write=function(j,et,tt){for(var rt=tt,nt,it,st=0;st<j.length;++st)nt=j.charCodeAt(st),nt<128?et[tt++]=nt:nt<2048?(et[tt++]=nt>>6|192,et[tt++]=nt&63|128):(nt&64512)===55296&&((it=j.charCodeAt(st+1))&64512)===56320?(nt=65536+((nt&1023)<<10)+(it&1023),++st,et[tt++]=nt>>18|240,et[tt++]=nt>>12&63|128,et[tt++]=nt>>6&63|128,et[tt++]=nt&63|128):(et[tt++]=nt>>12|224,et[tt++]=nt>>6&63|128,et[tt++]=nt&63|128);return tt-rt}})(utf8$2);var pool_1=pool;function pool(_,o,$){var j=$||8192,et=j>>>1,tt=null,rt=j;return function(it){if(it<1||it>et)return _(it);rt+it>j&&(tt=_(j),rt=0);var st=o.call(tt,rt,rt+=it);return rt&7&&(rt=(rt|7)+1),st}}var longbits$1,hasRequiredLongbits$1;function requireLongbits$1(){if(hasRequiredLongbits$1)return longbits$1;hasRequiredLongbits$1=1,longbits$1=o;var _=requireMinimal$2();function o(tt,rt){this.lo=tt>>>0,this.hi=rt>>>0}var $=o.zero=new o(0,0);$.toNumber=function(){return 0},$.zzEncode=$.zzDecode=function(){return this},$.length=function(){return 1};var j=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(rt){if(rt===0)return $;var nt=rt<0;nt&&(rt=-rt);var it=rt>>>0,st=(rt-it)/4294967296>>>0;return nt&&(st=~st>>>0,it=~it>>>0,++it>4294967295&&(it=0,++st>4294967295&&(st=0))),new o(it,st)},o.from=function(rt){if(typeof rt=="number")return o.fromNumber(rt);if(_.isString(rt))if(_.Long)rt=_.Long.fromString(rt);else return o.fromNumber(parseInt(rt,10));return rt.low||rt.high?new o(rt.low>>>0,rt.high>>>0):$},o.prototype.toNumber=function(rt){if(!rt&&this.hi>>>31){var nt=~this.lo+1>>>0,it=~this.hi>>>0;return nt||(it=it+1>>>0),-(nt+it*4294967296)}return this.lo+this.hi*4294967296},o.prototype.toLong=function(rt){return _.Long?new _.Long(this.lo|0,this.hi|0,!!rt):{low:this.lo|0,high:this.hi|0,unsigned:!!rt}};var et=String.prototype.charCodeAt;return o.fromHash=function(rt){return rt===j?$:new o((et.call(rt,0)|et.call(rt,1)<<8|et.call(rt,2)<<16|et.call(rt,3)<<24)>>>0,(et.call(rt,4)|et.call(rt,5)<<8|et.call(rt,6)<<16|et.call(rt,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var rt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^rt)>>>0,this.lo=(this.lo<<1^rt)>>>0,this},o.prototype.zzDecode=function(){var rt=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^rt)>>>0,this.hi=(this.hi>>>1^rt)>>>0,this},o.prototype.length=function(){var rt=this.lo,nt=(this.lo>>>28|this.hi<<4)>>>0,it=this.hi>>>24;return it===0?nt===0?rt<16384?rt<128?1:2:rt<2097152?3:4:nt<16384?nt<128?5:6:nt<2097152?7:8:it<128?9:10},longbits$1}var hasRequiredMinimal$2;function requireMinimal$2(){return hasRequiredMinimal$2||(hasRequiredMinimal$2=1,function(_){var o=_;o.asPromise=aspromise,o.base64=base64$5,o.EventEmitter=eventemitter,o.float=float,o.inquire=inquire_1,o.utf8=utf8$2,o.pool=pool_1,o.LongBits=requireLongbits$1(),o.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),o.global=o.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isInteger=Number.isInteger||function(tt){return typeof tt=="number"&&isFinite(tt)&&Math.floor(tt)===tt},o.isString=function(tt){return typeof tt=="string"||tt instanceof String},o.isObject=function(tt){return tt&&typeof tt=="object"},o.isset=o.isSet=function(tt,rt){var nt=tt[rt];return nt!=null&&tt.hasOwnProperty(rt)?typeof nt!="object"||(Array.isArray(nt)?nt.length:Object.keys(nt).length)>0:!1},o.Buffer=function(){try{var et=o.inquire("buffer").Buffer;return et.prototype.utf8Write?et:null}catch{return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(tt){return typeof tt=="number"?o.Buffer?o._Buffer_allocUnsafe(tt):new o.Array(tt):o.Buffer?o._Buffer_from(tt):typeof Uint8Array>"u"?tt:new Uint8Array(tt)},o.Array=typeof Uint8Array<"u"?Uint8Array:Array,o.Long=o.global.dcodeIO&&o.global.dcodeIO.Long||o.global.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(tt){return tt?o.LongBits.from(tt).toHash():o.LongBits.zeroHash},o.longFromHash=function(tt,rt){var nt=o.LongBits.fromHash(tt);return o.Long?o.Long.fromBits(nt.lo,nt.hi,rt):nt.toNumber(!!rt)};function $(et,tt,rt){for(var nt=Object.keys(tt),it=0;it<nt.length;++it)(et[nt[it]]===void 0||!rt)&&(et[nt[it]]=tt[nt[it]]);return et}o.merge=$,o.lcFirst=function(tt){return tt.charAt(0).toLowerCase()+tt.substring(1)};function j(et){function tt(rt,nt){if(!(this instanceof tt))return new tt(rt,nt);Object.defineProperty(this,"message",{get:function(){return rt}}),Error.captureStackTrace?Error.captureStackTrace(this,tt):Object.defineProperty(this,"stack",{value:new Error().stack||""}),nt&&$(this,nt)}return tt.prototype=Object.create(Error.prototype,{constructor:{value:tt,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return et},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),tt}o.newError=j,o.ProtocolError=j("ProtocolError"),o.oneOfGetter=function(tt){for(var rt={},nt=0;nt<tt.length;++nt)rt[tt[nt]]=1;return function(){for(var it=Object.keys(this),st=it.length-1;st>-1;--st)if(rt[it[st]]===1&&this[it[st]]!==void 0&&this[it[st]]!==null)return it[st]}},o.oneOfSetter=function(tt){return function(rt){for(var nt=0;nt<tt.length;++nt)tt[nt]!==rt&&delete this[tt[nt]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var et=o.Buffer;if(!et){o._Buffer_from=o._Buffer_allocUnsafe=null;return}o._Buffer_from=et.from!==Uint8Array.from&&et.from||function(rt,nt){return new et(rt,nt)},o._Buffer_allocUnsafe=et.allocUnsafe||function(rt){return new et(rt)}}}(minimal$3)),minimal$3}var reader$6=Reader$1,util$6=requireMinimal$2(),BufferReader$1,LongBits$2=util$6.LongBits,utf8$1=util$6.utf8;function indexOutOfRange(_,o){return RangeError("index out of range: "+_.pos+" + "+(o||1)+" > "+_.len)}function Reader$1(_){this.buf=_,this.pos=0,this.len=_.length}var create_array=typeof Uint8Array<"u"?function _(o){if(o instanceof Uint8Array||Array.isArray(o))return new Reader$1(o);throw Error("illegal buffer")}:function _(o){if(Array.isArray(o))return new Reader$1(o);throw Error("illegal buffer")},create$b=function _(){return util$6.Buffer?function($){return(Reader$1.create=function(et){return util$6.Buffer.isBuffer(et)?new BufferReader$1(et):create_array(et)})($)}:create_array};Reader$1.create=create$b();Reader$1.prototype._slice=util$6.Array.prototype.subarray||util$6.Array.prototype.slice;Reader$1.prototype.uint32=function _(){var o=4294967295;return function(){if(o=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(o=(o|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(o=(o|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(o=(o|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(o=(o|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return o;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return o}}();Reader$1.prototype.int32=function _(){return this.uint32()|0};Reader$1.prototype.sint32=function _(){var o=this.uint32();return o>>>1^-(o&1)|0};function readLongVarint(){var _=new LongBits$2(0,0),o=0;if(this.len-this.pos>4){for(;o<4;++o)if(_.lo=(_.lo|(this.buf[this.pos]&127)<<o*7)>>>0,this.buf[this.pos++]<128)return _;if(_.lo=(_.lo|(this.buf[this.pos]&127)<<28)>>>0,_.hi=(_.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return _;o=0}else{for(;o<3;++o){if(this.pos>=this.len)throw indexOutOfRange(this);if(_.lo=(_.lo|(this.buf[this.pos]&127)<<o*7)>>>0,this.buf[this.pos++]<128)return _}return _.lo=(_.lo|(this.buf[this.pos++]&127)<<o*7)>>>0,_}if(this.len-this.pos>4){for(;o<5;++o)if(_.hi=(_.hi|(this.buf[this.pos]&127)<<o*7+3)>>>0,this.buf[this.pos++]<128)return _}else for(;o<5;++o){if(this.pos>=this.len)throw indexOutOfRange(this);if(_.hi=(_.hi|(this.buf[this.pos]&127)<<o*7+3)>>>0,this.buf[this.pos++]<128)return _}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function _(){return this.uint32()!==0};function readFixed32_end(_,o){return(_[o-4]|_[o-3]<<8|_[o-2]<<16|_[o-1]<<24)>>>0}Reader$1.prototype.fixed32=function _(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function _(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function _(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var o=util$6.float.readFloatLE(this.buf,this.pos);return this.pos+=4,o};Reader$1.prototype.double=function _(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var o=util$6.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,o};Reader$1.prototype.bytes=function _(){var o=this.uint32(),$=this.pos,j=this.pos+o;if(j>this.len)throw indexOutOfRange(this,o);return this.pos+=o,Array.isArray(this.buf)?this.buf.slice($,j):$===j?new this.buf.constructor(0):this._slice.call(this.buf,$,j)};Reader$1.prototype.string=function _(){var o=this.bytes();return utf8$1.read(o,0,o.length)};Reader$1.prototype.skip=function _(o){if(typeof o=="number"){if(this.pos+o>this.len)throw indexOutOfRange(this,o);this.pos+=o}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(_){switch(_){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(_=this.uint32()&7)!==4;)this.skipType(_);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+_+" at offset "+this.pos)}return this};Reader$1._configure=function(_){BufferReader$1=_,Reader$1.create=create$b(),BufferReader$1._configure();var o=util$6.Long?"toLong":"toNumber";util$6.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[o](!1)},uint64:function(){return readLongVarint.call(this)[o](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[o](!1)},fixed64:function(){return readFixed64.call(this)[o](!0)},sfixed64:function(){return readFixed64.call(this)[o](!1)}})};var reader_buffer$1=BufferReader,Reader=reader$6;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$5=requireMinimal$2();function BufferReader(_){Reader.call(this,_)}BufferReader._configure=function(){util$5.Buffer&&(BufferReader.prototype._slice=util$5.Buffer.prototype.slice)};BufferReader.prototype.string=function _(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))};BufferReader._configure();var minimalExports$3=requireMinimal$2();const util$4=getDefaultExportFromCjs(minimalExports$3);var writer$5=Writer$1,util$3=requireMinimal$2(),BufferWriter$1,LongBits$1=util$3.LongBits,base64$4=util$3.base64,utf8=util$3.utf8;function Op(_,o,$){this.fn=_,this.len=o,this.next=void 0,this.val=$}function noop$5(){}function State(_){this.head=_.head,this.tail=_.tail,this.len=_.len,this.next=_.states}function Writer$1(){this.len=0,this.head=new Op(noop$5,0,0),this.tail=this.head,this.states=null}var create$a=function _(){return util$3.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$a();Writer$1.alloc=function _(o){return new util$3.Array(o)};util$3.Array!==Array&&(Writer$1.alloc=util$3.pool(Writer$1.alloc,util$3.Array.prototype.subarray));Writer$1.prototype._push=function _(o,$,j){return this.tail=this.tail.next=new Op(o,$,j),this.len+=$,this};function writeByte(_,o,$){o[$]=_&255}function writeVarint32(_,o,$){for(;_>127;)o[$++]=_&127|128,_>>>=7;o[$]=_}function VarintOp(_,o){this.len=_,this.next=void 0,this.val=o}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function _(o){return this.len+=(this.tail=this.tail.next=new VarintOp((o=o>>>0)<128?1:o<16384?2:o<2097152?3:o<268435456?4:5,o)).len,this};Writer$1.prototype.int32=function _(o){return o<0?this._push(writeVarint64,10,LongBits$1.fromNumber(o)):this.uint32(o)};Writer$1.prototype.sint32=function _(o){return this.uint32((o<<1^o>>31)>>>0)};function writeVarint64(_,o,$){for(;_.hi;)o[$++]=_.lo&127|128,_.lo=(_.lo>>>7|_.hi<<25)>>>0,_.hi>>>=7;for(;_.lo>127;)o[$++]=_.lo&127|128,_.lo=_.lo>>>7;o[$++]=_.lo}Writer$1.prototype.uint64=function _(o){var $=LongBits$1.from(o);return this._push(writeVarint64,$.length(),$)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function _(o){var $=LongBits$1.from(o).zzEncode();return this._push(writeVarint64,$.length(),$)};Writer$1.prototype.bool=function _(o){return this._push(writeByte,1,o?1:0)};function writeFixed32(_,o,$){o[$]=_&255,o[$+1]=_>>>8&255,o[$+2]=_>>>16&255,o[$+3]=_>>>24}Writer$1.prototype.fixed32=function _(o){return this._push(writeFixed32,4,o>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function _(o){var $=LongBits$1.from(o);return this._push(writeFixed32,4,$.lo)._push(writeFixed32,4,$.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function _(o){return this._push(util$3.float.writeFloatLE,4,o)};Writer$1.prototype.double=function _(o){return this._push(util$3.float.writeDoubleLE,8,o)};var writeBytes=util$3.Array.prototype.set?function _(o,$,j){$.set(o,j)}:function _(o,$,j){for(var et=0;et<o.length;++et)$[j+et]=o[et]};Writer$1.prototype.bytes=function _(o){var $=o.length>>>0;if(!$)return this._push(writeByte,1,0);if(util$3.isString(o)){var j=Writer$1.alloc($=base64$4.length(o));base64$4.decode(o,j,0),o=j}return this.uint32($)._push(writeBytes,$,o)};Writer$1.prototype.string=function _(o){var $=utf8.length(o);return $?this.uint32($)._push(utf8.write,$,o):this._push(writeByte,1,0)};Writer$1.prototype.fork=function _(){return this.states=new State(this),this.head=this.tail=new Op(noop$5,0,0),this.len=0,this};Writer$1.prototype.reset=function _(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$5,0,0),this.len=0),this};Writer$1.prototype.ldelim=function _(){var o=this.head,$=this.tail,j=this.len;return this.reset().uint32(j),j&&(this.tail.next=o.next,this.tail=$,this.len+=j),this};Writer$1.prototype.finish=function _(){for(var o=this.head.next,$=this.constructor.alloc(this.len),j=0;o;)o.fn(o.val,$,j),j+=o.len,o=o.next;return $};Writer$1._configure=function(_){BufferWriter$1=_,Writer$1.create=create$a(),BufferWriter$1._configure()};var writer_buffer$1=BufferWriter,Writer=writer$5;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$2=requireMinimal$2();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$2._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$2.Buffer&&util$2.Buffer.prototype instanceof Uint8Array&&util$2.Buffer.prototype.set.name==="set"?function(o,$,j){$.set(o,j)}:function(o,$,j){if(o.copy)o.copy($,j,0,o.length);else for(var et=0;et<o.length;)$[j++]=o[et++]}};BufferWriter.prototype.bytes=function _(o){util$2.isString(o)&&(o=util$2._Buffer_from(o,"base64"));var $=o.length>>>0;return this.uint32($),$&&this._push(BufferWriter.writeBytesBuffer,$,o),this};function writeStringBuffer(_,o,$){_.length<40?util$2.utf8.write(_,o,$):o.utf8Write?o.utf8Write(_,$):o.write(_,$)}BufferWriter.prototype.string=function _(o){var $=util$2.Buffer.byteLength(o);return this.uint32($),$&&this._push(writeStringBuffer,$,o),this};BufferWriter._configure();function configure$4(){util$4._configure(),reader$6._configure(reader_buffer$1),writer$5._configure(writer_buffer$1)}configure$4();const methods$3=["uint64","int64","sint64","fixed64","sfixed64"];function patchReader$3(_){for(const o of methods$3){if(_[o]==null)continue;const $=_[o];_[o]=function(){return BigInt($.call(this).toString())}}return _}function reader$5(_){return patchReader$3(new reader$6(_))}function patchWriter$3(_){for(const o of methods$3){if(_[o]==null)continue;const $=_[o];_[o]=function(j){return $.call(this,j.toString())}}return _}function writer$4(){return patchWriter$3(writer$5.create())}function decodeMessage$4(_,o){const $=reader$5(_ instanceof Uint8Array?_:_.subarray());return o.decode($)}function encodeMessage$3(_,o){const $=writer$4();return o.encode(_,$,{lengthDelimited:!1}),$.finish()}var CODEC_TYPES$3;(function(_){_[_.VARINT=0]="VARINT",_[_.BIT64=1]="BIT64",_[_.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",_[_.START_GROUP=3]="START_GROUP",_[_.END_GROUP=4]="END_GROUP",_[_.BIT32=5]="BIT32"})(CODEC_TYPES$3||(CODEC_TYPES$3={}));function createCodec$5(_,o,$,j){return{name:_,type:o,encode:$,decode:j}}function enumeration$2(_){function o(et){if(_[et.toString()]==null)throw new Error("Invalid enum value");return _[et]}const $=function(tt,rt){const nt=o(tt);rt.int32(nt)},j=function(tt){const rt=tt.int32();return o(rt)};return createCodec$5("enum",CODEC_TYPES$3.VARINT,$,j)}function message$3(_,o){return createCodec$5("message",CODEC_TYPES$3.LENGTH_DELIMITED,_,o)}var KeyType;(function(_){_.RSA="RSA",_.Ed25519="Ed25519",_.Secp256k1="Secp256k1"})(KeyType||(KeyType={}));var __KeyTypeValues;(function(_){_[_.RSA=0]="RSA",_[_.Ed25519=1]="Ed25519",_[_.Secp256k1=2]="Secp256k1"})(__KeyTypeValues||(__KeyTypeValues={}));(function(_){_.codec=()=>enumeration$2(__KeyTypeValues)})(KeyType||(KeyType={}));var PublicKey;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.Type!=null&&(j.uint32(8),KeyType.codec().encode($.Type,j)),$.Data!=null&&(j.uint32(18),j.bytes($.Data)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.Type=KeyType.codec().decode($);break;case 2:et.Data=$.bytes();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(PublicKey||(PublicKey={}));var PrivateKey;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.Type!=null&&(j.uint32(8),KeyType.codec().encode($.Type,j)),$.Data!=null&&(j.uint32(18),j.bytes($.Data)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.Type=KeyType.codec().decode($);break;case 2:et.Data=$.bytes();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(PrivateKey||(PrivateKey={}));var forge$n=forge$s;forge$n.pki=forge$n.pki||{};var oids$2=forge$n.pki.oids=forge$n.oids=forge$n.oids||{};function _IN(_,o){oids$2[_]=o,oids$2[o]=_}function _I_(_,o){oids$2[_]=o}_IN("1.2.840.113549.1.1.1","rsaEncryption");_IN("1.2.840.113549.1.1.4","md5WithRSAEncryption");_IN("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_IN("1.2.840.113549.1.1.7","RSAES-OAEP");_IN("1.2.840.113549.1.1.8","mgf1");_IN("1.2.840.113549.1.1.9","pSpecified");_IN("1.2.840.113549.1.1.10","RSASSA-PSS");_IN("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_IN("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_IN("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_IN("1.3.101.112","EdDSA25519");_IN("1.2.840.10040.4.3","dsa-with-sha1");_IN("1.3.14.3.2.7","desCBC");_IN("1.3.14.3.2.26","sha1");_IN("1.3.14.3.2.29","sha1WithRSASignature");_IN("2.16.840.1.101.3.4.2.1","sha256");_IN("2.16.840.1.101.3.4.2.2","sha384");_IN("2.16.840.1.101.3.4.2.3","sha512");_IN("2.16.840.1.101.3.4.2.4","sha224");_IN("2.16.840.1.101.3.4.2.5","sha512-224");_IN("2.16.840.1.101.3.4.2.6","sha512-256");_IN("1.2.840.113549.2.2","md2");_IN("1.2.840.113549.2.5","md5");_IN("1.2.840.113549.1.7.1","data");_IN("1.2.840.113549.1.7.2","signedData");_IN("1.2.840.113549.1.7.3","envelopedData");_IN("1.2.840.113549.1.7.4","signedAndEnvelopedData");_IN("1.2.840.113549.1.7.5","digestedData");_IN("1.2.840.113549.1.7.6","encryptedData");_IN("1.2.840.113549.1.9.1","emailAddress");_IN("1.2.840.113549.1.9.2","unstructuredName");_IN("1.2.840.113549.1.9.3","contentType");_IN("1.2.840.113549.1.9.4","messageDigest");_IN("1.2.840.113549.1.9.5","signingTime");_IN("1.2.840.113549.1.9.6","counterSignature");_IN("1.2.840.113549.1.9.7","challengePassword");_IN("1.2.840.113549.1.9.8","unstructuredAddress");_IN("1.2.840.113549.1.9.14","extensionRequest");_IN("1.2.840.113549.1.9.20","friendlyName");_IN("1.2.840.113549.1.9.21","localKeyId");_IN("1.2.840.113549.1.9.22.1","x509Certificate");_IN("1.2.840.113549.1.12.10.1.1","keyBag");_IN("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_IN("1.2.840.113549.1.12.10.1.3","certBag");_IN("1.2.840.113549.1.12.10.1.4","crlBag");_IN("1.2.840.113549.1.12.10.1.5","secretBag");_IN("1.2.840.113549.1.12.10.1.6","safeContentsBag");_IN("1.2.840.113549.1.5.13","pkcs5PBES2");_IN("1.2.840.113549.1.5.12","pkcs5PBKDF2");_IN("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_IN("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_IN("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_IN("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_IN("1.2.840.113549.2.7","hmacWithSHA1");_IN("1.2.840.113549.2.8","hmacWithSHA224");_IN("1.2.840.113549.2.9","hmacWithSHA256");_IN("1.2.840.113549.2.10","hmacWithSHA384");_IN("1.2.840.113549.2.11","hmacWithSHA512");_IN("1.2.840.113549.3.7","des-EDE3-CBC");_IN("2.16.840.1.101.3.4.1.2","aes128-CBC");_IN("2.16.840.1.101.3.4.1.22","aes192-CBC");_IN("2.16.840.1.101.3.4.1.42","aes256-CBC");_IN("2.5.4.3","commonName");_IN("2.5.4.4","surname");_IN("2.5.4.5","serialNumber");_IN("2.5.4.6","countryName");_IN("2.5.4.7","localityName");_IN("2.5.4.8","stateOrProvinceName");_IN("2.5.4.9","streetAddress");_IN("2.5.4.10","organizationName");_IN("2.5.4.11","organizationalUnitName");_IN("2.5.4.12","title");_IN("2.5.4.13","description");_IN("2.5.4.15","businessCategory");_IN("2.5.4.17","postalCode");_IN("2.5.4.42","givenName");_IN("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_IN("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_IN("2.16.840.1.113730.1.1","nsCertType");_IN("2.16.840.1.113730.1.13","nsComment");_I_("2.5.29.1","authorityKeyIdentifier");_I_("2.5.29.2","keyAttributes");_I_("2.5.29.3","certificatePolicies");_I_("2.5.29.4","keyUsageRestriction");_I_("2.5.29.5","policyMapping");_I_("2.5.29.6","subtreesConstraint");_I_("2.5.29.7","subjectAltName");_I_("2.5.29.8","issuerAltName");_I_("2.5.29.9","subjectDirectoryAttributes");_I_("2.5.29.10","basicConstraints");_I_("2.5.29.11","nameConstraints");_I_("2.5.29.12","policyConstraints");_I_("2.5.29.13","basicConstraints");_IN("2.5.29.14","subjectKeyIdentifier");_IN("2.5.29.15","keyUsage");_I_("2.5.29.16","privateKeyUsagePeriod");_IN("2.5.29.17","subjectAltName");_IN("2.5.29.18","issuerAltName");_IN("2.5.29.19","basicConstraints");_I_("2.5.29.20","cRLNumber");_I_("2.5.29.21","cRLReason");_I_("2.5.29.22","expirationDate");_I_("2.5.29.23","instructionCode");_I_("2.5.29.24","invalidityDate");_I_("2.5.29.25","cRLDistributionPoints");_I_("2.5.29.26","issuingDistributionPoint");_I_("2.5.29.27","deltaCRLIndicator");_I_("2.5.29.28","issuingDistributionPoint");_I_("2.5.29.29","certificateIssuer");_I_("2.5.29.30","nameConstraints");_IN("2.5.29.31","cRLDistributionPoints");_IN("2.5.29.32","certificatePolicies");_I_("2.5.29.33","policyMappings");_I_("2.5.29.34","policyConstraints");_IN("2.5.29.35","authorityKeyIdentifier");_I_("2.5.29.36","policyConstraints");_IN("2.5.29.37","extKeyUsage");_I_("2.5.29.46","freshestCRL");_I_("2.5.29.54","inhibitAnyPolicy");_IN("1.3.6.1.4.1.11129.2.4.2","timestampList");_IN("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_IN("1.3.6.1.5.5.7.3.1","serverAuth");_IN("1.3.6.1.5.5.7.3.2","clientAuth");_IN("1.3.6.1.5.5.7.3.3","codeSigning");_IN("1.3.6.1.5.5.7.3.4","emailProtection");_IN("1.3.6.1.5.5.7.3.8","timeStamping");var forge$m=forge$s,asn1$7=forge$m.asn1=forge$m.asn1||{};asn1$7.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};asn1$7.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};asn1$7.create=function(_,o,$,j,et){if(forge$m.util.isArray(j)){for(var tt=[],rt=0;rt<j.length;++rt)j[rt]!==void 0&&tt.push(j[rt]);j=tt}var nt={tagClass:_,type:o,constructed:$,composed:$||forge$m.util.isArray(j),value:j};return et&&"bitStringContents"in et&&(nt.bitStringContents=et.bitStringContents,nt.original=asn1$7.copy(nt)),nt};asn1$7.copy=function(_,o){var $;if(forge$m.util.isArray(_)){$=[];for(var j=0;j<_.length;++j)$.push(asn1$7.copy(_[j],o));return $}return typeof _=="string"?_:($={tagClass:_.tagClass,type:_.type,constructed:_.constructed,composed:_.composed,value:asn1$7.copy(_.value,o)},o&&!o.excludeBitStringContents&&($.bitStringContents=_.bitStringContents),$)};asn1$7.equals=function(_,o,$){if(forge$m.util.isArray(_)){if(!forge$m.util.isArray(o)||_.length!==o.length)return!1;for(var j=0;j<_.length;++j)if(!asn1$7.equals(_[j],o[j]))return!1;return!0}if(typeof _!=typeof o)return!1;if(typeof _=="string")return _===o;var et=_.tagClass===o.tagClass&&_.type===o.type&&_.constructed===o.constructed&&_.composed===o.composed&&asn1$7.equals(_.value,o.value);return $&&$.includeBitStringContents&&(et=et&&_.bitStringContents===o.bitStringContents),et};asn1$7.getBerValueLength=function(_){var o=_.getByte();if(o!==128){var $,j=o&128;return j?$=_.getInt((o&127)<<3):$=o,$}};function _checkBufferLength(_,o,$){if($>o){var j=new Error("Too few bytes to parse DER.");throw j.available=_.length(),j.remaining=o,j.requested=$,j}}var _getValueLength=function(_,o){var $=_.getByte();if(o--,$!==128){var j,et=$&128;if(!et)j=$;else{var tt=$&127;_checkBufferLength(_,o,tt),j=_.getInt(tt<<3)}if(j<0)throw new Error("Negative length: "+j);return j}};asn1$7.fromDer=function(_,o){o===void 0&&(o={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof o=="boolean"&&(o={strict:o,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in o||(o.strict=!0),"parseAllBytes"in o||(o.parseAllBytes=!0),"decodeBitStrings"in o||(o.decodeBitStrings=!0),typeof _=="string"&&(_=forge$m.util.createBuffer(_));var $=_.length(),j=_fromDer(_,_.length(),0,o);if(o.parseAllBytes&&_.length()!==0){var et=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw et.byteCount=$,et.remaining=_.length(),et}return j};function _fromDer(_,o,$,j){var et;_checkBufferLength(_,o,2);var tt=_.getByte();o--;var rt=tt&192,nt=tt&31;et=_.length();var it=_getValueLength(_,o);if(o-=et-_.length(),it!==void 0&&it>o){if(j.strict){var st=new Error("Too few bytes to read ASN.1 value.");throw st.available=_.length(),st.remaining=o,st.requested=it,st}it=o}var ot,at,ct=(tt&32)===32;if(ct)if(ot=[],it===void 0)for(;;){if(_checkBufferLength(_,o,2),_.bytes(2)===String.fromCharCode(0,0)){_.getBytes(2),o-=2;break}et=_.length(),ot.push(_fromDer(_,o,$+1,j)),o-=et-_.length()}else for(;it>0;)et=_.length(),ot.push(_fromDer(_,it,$+1,j)),o-=et-_.length(),it-=et-_.length();if(ot===void 0&&rt===asn1$7.Class.UNIVERSAL&&nt===asn1$7.Type.BITSTRING&&(at=_.bytes(it)),ot===void 0&&j.decodeBitStrings&&rt===asn1$7.Class.UNIVERSAL&&nt===asn1$7.Type.BITSTRING&&it>1){var ut=_.read,ft=o,ht=0;if(nt===asn1$7.Type.BITSTRING&&(_checkBufferLength(_,o,1),ht=_.getByte(),o--),ht===0)try{et=_.length();var mt={strict:!0,decodeBitStrings:!0},gt=_fromDer(_,o,$+1,mt),Et=et-_.length();o-=Et,nt==asn1$7.Type.BITSTRING&&Et++;var St=gt.tagClass;Et===it&&(St===asn1$7.Class.UNIVERSAL||St===asn1$7.Class.CONTEXT_SPECIFIC)&&(ot=[gt])}catch{}ot===void 0&&(_.read=ut,o=ft)}if(ot===void 0){if(it===void 0){if(j.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");it=o}if(nt===asn1$7.Type.BMPSTRING)for(ot="";it>0;it-=2)_checkBufferLength(_,o,2),ot+=String.fromCharCode(_.getInt16()),o-=2;else ot=_.getBytes(it),o-=it}var At=at===void 0?null:{bitStringContents:at};return asn1$7.create(rt,nt,ct,ot,At)}asn1$7.toDer=function(_){var o=forge$m.util.createBuffer(),$=_.tagClass|_.type,j=forge$m.util.createBuffer(),et=!1;if("bitStringContents"in _&&(et=!0,_.original&&(et=asn1$7.equals(_,_.original))),et)j.putBytes(_.bitStringContents);else if(_.composed){_.constructed?$|=32:j.putByte(0);for(var tt=0;tt<_.value.length;++tt)_.value[tt]!==void 0&&j.putBuffer(asn1$7.toDer(_.value[tt]))}else if(_.type===asn1$7.Type.BMPSTRING)for(var tt=0;tt<_.value.length;++tt)j.putInt16(_.value.charCodeAt(tt));else _.type===asn1$7.Type.INTEGER&&_.value.length>1&&(_.value.charCodeAt(0)===0&&!(_.value.charCodeAt(1)&128)||_.value.charCodeAt(0)===255&&(_.value.charCodeAt(1)&128)===128)?j.putBytes(_.value.substr(1)):j.putBytes(_.value);if(o.putByte($),j.length()<=127)o.putByte(j.length()&127);else{var rt=j.length(),nt="";do nt+=String.fromCharCode(rt&255),rt=rt>>>8;while(rt>0);o.putByte(nt.length|128);for(var tt=nt.length-1;tt>=0;--tt)o.putByte(nt.charCodeAt(tt))}return o.putBuffer(j),o};asn1$7.oidToDer=function(_){var o=_.split("."),$=forge$m.util.createBuffer();$.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var j,et,tt,rt,nt=2;nt<o.length;++nt){j=!0,et=[],tt=parseInt(o[nt],10);do rt=tt&127,tt=tt>>>7,j||(rt|=128),et.push(rt),j=!1;while(tt>0);for(var it=et.length-1;it>=0;--it)$.putByte(et[it])}return $};asn1$7.derToOid=function(_){var o;typeof _=="string"&&(_=forge$m.util.createBuffer(_));var $=_.getByte();o=Math.floor($/40)+"."+$%40;for(var j=0;_.length()>0;)$=_.getByte(),j=j<<7,$&128?j+=$&127:(o+="."+(j+$),j=0);return o};asn1$7.utcTimeToDate=function(_){var o=new Date,$=parseInt(_.substr(0,2),10);$=$>=50?1900+$:2e3+$;var j=parseInt(_.substr(2,2),10)-1,et=parseInt(_.substr(4,2),10),tt=parseInt(_.substr(6,2),10),rt=parseInt(_.substr(8,2),10),nt=0;if(_.length>11){var it=_.charAt(10),st=10;it!=="+"&&it!=="-"&&(nt=parseInt(_.substr(10,2),10),st+=2)}if(o.setUTCFullYear($,j,et),o.setUTCHours(tt,rt,nt,0),st&&(it=_.charAt(st),it==="+"||it==="-")){var ot=parseInt(_.substr(st+1,2),10),at=parseInt(_.substr(st+4,2),10),ct=ot*60+at;ct*=6e4,it==="+"?o.setTime(+o-ct):o.setTime(+o+ct)}return o};asn1$7.generalizedTimeToDate=function(_){var o=new Date,$=parseInt(_.substr(0,4),10),j=parseInt(_.substr(4,2),10)-1,et=parseInt(_.substr(6,2),10),tt=parseInt(_.substr(8,2),10),rt=parseInt(_.substr(10,2),10),nt=parseInt(_.substr(12,2),10),it=0,st=0,ot=!1;_.charAt(_.length-1)==="Z"&&(ot=!0);var at=_.length-5,ct=_.charAt(at);if(ct==="+"||ct==="-"){var ut=parseInt(_.substr(at+1,2),10),ft=parseInt(_.substr(at+4,2),10);st=ut*60+ft,st*=6e4,ct==="+"&&(st*=-1),ot=!0}return _.charAt(14)==="."&&(it=parseFloat(_.substr(14),10)*1e3),ot?(o.setUTCFullYear($,j,et),o.setUTCHours(tt,rt,nt,it),o.setTime(+o+st)):(o.setFullYear($,j,et),o.setHours(tt,rt,nt,it)),o};asn1$7.dateToUtcTime=function(_){if(typeof _=="string")return _;var o="",$=[];$.push((""+_.getUTCFullYear()).substr(2)),$.push(""+(_.getUTCMonth()+1)),$.push(""+_.getUTCDate()),$.push(""+_.getUTCHours()),$.push(""+_.getUTCMinutes()),$.push(""+_.getUTCSeconds());for(var j=0;j<$.length;++j)$[j].length<2&&(o+="0"),o+=$[j];return o+="Z",o};asn1$7.dateToGeneralizedTime=function(_){if(typeof _=="string")return _;var o="",$=[];$.push(""+_.getUTCFullYear()),$.push(""+(_.getUTCMonth()+1)),$.push(""+_.getUTCDate()),$.push(""+_.getUTCHours()),$.push(""+_.getUTCMinutes()),$.push(""+_.getUTCSeconds());for(var j=0;j<$.length;++j)$[j].length<2&&(o+="0"),o+=$[j];return o+="Z",o};asn1$7.integerToDer=function(_){var o=forge$m.util.createBuffer();if(_>=-128&&_<128)return o.putSignedInt(_,8);if(_>=-32768&&_<32768)return o.putSignedInt(_,16);if(_>=-8388608&&_<8388608)return o.putSignedInt(_,24);if(_>=-2147483648&&_<2147483648)return o.putSignedInt(_,32);var $=new Error("Integer too large; max is 32-bits.");throw $.integer=_,$};asn1$7.derToInteger=function(_){typeof _=="string"&&(_=forge$m.util.createBuffer(_));var o=_.length()*8;if(o>32)throw new Error("Integer too large; max is 32-bits.");return _.getSignedInt(o)};asn1$7.validate=function(_,o,$,j){var et=!1;if((_.tagClass===o.tagClass||typeof o.tagClass>"u")&&(_.type===o.type||typeof o.type>"u"))if(_.constructed===o.constructed||typeof o.constructed>"u"){if(et=!0,o.value&&forge$m.util.isArray(o.value))for(var tt=0,rt=0;et&&rt<o.value.length;++rt)et=o.value[rt].optional||!1,_.value[tt]&&(et=asn1$7.validate(_.value[tt],o.value[rt],$,j),et?++tt:o.value[rt].optional&&(et=!0)),!et&&j&&j.push("["+o.name+'] Tag class "'+o.tagClass+'", type "'+o.type+'" expected value length "'+o.value.length+'", got "'+_.value.length+'"');if(et&&$&&(o.capture&&($[o.capture]=_.value),o.captureAsn1&&($[o.captureAsn1]=_),o.captureBitStringContents&&"bitStringContents"in _&&($[o.captureBitStringContents]=_.bitStringContents),o.captureBitStringValue&&"bitStringContents"in _))if(_.bitStringContents.length<2)$[o.captureBitStringValue]="";else{var nt=_.bitStringContents.charCodeAt(0);if(nt!==0)throw new Error("captureBitStringValue only supported for zero unused bits");$[o.captureBitStringValue]=_.bitStringContents.slice(1)}}else j&&j.push("["+o.name+'] Expected constructed "'+o.constructed+'", got "'+_.constructed+'"');else j&&(_.tagClass!==o.tagClass&&j.push("["+o.name+'] Expected tag class "'+o.tagClass+'", got "'+_.tagClass+'"'),_.type!==o.type&&j.push("["+o.name+'] Expected type "'+o.type+'", got "'+_.type+'"'));return et};var _nonLatinRegex=/[^\\u0000-\\u00ff]/;asn1$7.prettyPrint=function(_,o,$){var j="";o=o||0,$=$||2,o>0&&(j+=`
`);for(var et="",tt=0;tt<o*$;++tt)et+=" ";switch(j+=et+"Tag: ",_.tagClass){case asn1$7.Class.UNIVERSAL:j+="Universal:";break;case asn1$7.Class.APPLICATION:j+="Application:";break;case asn1$7.Class.CONTEXT_SPECIFIC:j+="Context-Specific:";break;case asn1$7.Class.PRIVATE:j+="Private:";break}if(_.tagClass===asn1$7.Class.UNIVERSAL)switch(j+=_.type,_.type){case asn1$7.Type.NONE:j+=" (None)";break;case asn1$7.Type.BOOLEAN:j+=" (Boolean)";break;case asn1$7.Type.INTEGER:j+=" (Integer)";break;case asn1$7.Type.BITSTRING:j+=" (Bit string)";break;case asn1$7.Type.OCTETSTRING:j+=" (Octet string)";break;case asn1$7.Type.NULL:j+=" (Null)";break;case asn1$7.Type.OID:j+=" (Object Identifier)";break;case asn1$7.Type.ODESC:j+=" (Object Descriptor)";break;case asn1$7.Type.EXTERNAL:j+=" (External or Instance of)";break;case asn1$7.Type.REAL:j+=" (Real)";break;case asn1$7.Type.ENUMERATED:j+=" (Enumerated)";break;case asn1$7.Type.EMBEDDED:j+=" (Embedded PDV)";break;case asn1$7.Type.UTF8:j+=" (UTF8)";break;case asn1$7.Type.ROID:j+=" (Relative Object Identifier)";break;case asn1$7.Type.SEQUENCE:j+=" (Sequence)";break;case asn1$7.Type.SET:j+=" (Set)";break;case asn1$7.Type.PRINTABLESTRING:j+=" (Printable String)";break;case asn1$7.Type.IA5String:j+=" (IA5String (ASCII))";break;case asn1$7.Type.UTCTIME:j+=" (UTC time)";break;case asn1$7.Type.GENERALIZEDTIME:j+=" (Generalized time)";break;case asn1$7.Type.BMPSTRING:j+=" (BMP String)";break}else j+=_.type;if(j+=`
`,j+=et+"Constructed: "+_.constructed+`
`,_.composed){for(var rt=0,nt="",tt=0;tt<_.value.length;++tt)_.value[tt]!==void 0&&(rt+=1,nt+=asn1$7.prettyPrint(_.value[tt],o+1,$),tt+1<_.value.length&&(nt+=","));j+=et+"Sub values: "+rt+nt}else{if(j+=et+"Value: ",_.type===asn1$7.Type.OID){var it=asn1$7.derToOid(_.value);j+=it,forge$m.pki&&forge$m.pki.oids&&it in forge$m.pki.oids&&(j+=" ("+forge$m.pki.oids[it]+") ")}if(_.type===asn1$7.Type.INTEGER)try{j+=asn1$7.derToInteger(_.value)}catch{j+="0x"+forge$m.util.bytesToHex(_.value)}else if(_.type===asn1$7.Type.BITSTRING){if(_.value.length>1?j+="0x"+forge$m.util.bytesToHex(_.value.slice(1)):j+="(none)",_.value.length>0){var st=_.value.charCodeAt(0);st==1?j+=" (1 unused bit shown)":st>1&&(j+=" ("+st+" unused bits shown)")}}else if(_.type===asn1$7.Type.OCTETSTRING)_nonLatinRegex.test(_.value)||(j+="("+_.value+") "),j+="0x"+forge$m.util.bytesToHex(_.value);else if(_.type===asn1$7.Type.UTF8)try{j+=forge$m.util.decodeUtf8(_.value)}catch(ot){if(ot.message==="URI malformed")j+="0x"+forge$m.util.bytesToHex(_.value)+" (malformed UTF8)";else throw ot}else _.type===asn1$7.Type.PRINTABLESTRING||_.type===asn1$7.Type.IA5String?j+=_.value:_nonLatinRegex.test(_.value)?j+="0x"+forge$m.util.bytesToHex(_.value):_.value.length===0?j+="[null]":j+=_.value}return j};var forge$l=forge$s;forge$l.des=forge$l.des||{};forge$l.des.startEncrypting=function(_,o,$,j){var et=_createCipher({key:_,output:$,decrypt:!1,mode:j||(o===null?"ECB":"CBC")});return et.start(o),et};forge$l.des.createEncryptionCipher=function(_,o){return _createCipher({key:_,output:null,decrypt:!1,mode:o})};forge$l.des.startDecrypting=function(_,o,$,j){var et=_createCipher({key:_,output:$,decrypt:!0,mode:j||(o===null?"ECB":"CBC")});return et.start(o),et};forge$l.des.createDecryptionCipher=function(_,o){return _createCipher({key:_,output:null,decrypt:!0,mode:o})};forge$l.des.Algorithm=function(_,o){var $=this;$.name=_,$.mode=new o({blockSize:8,cipher:{encrypt:function(j,et){return _updateBlock($._keys,j,et,!1)},decrypt:function(j,et){return _updateBlock($._keys,j,et,!0)}}}),$._init=!1};forge$l.des.Algorithm.prototype.initialize=function(_){if(!this._init){var o=forge$l.util.createBuffer(_.key);if(this.name.indexOf("3DES")===0&&o.length()!==24)throw new Error("Invalid Triple-DES key size: "+o.length()*8);this._keys=_createKeys(o),this._init=!0}};registerAlgorithm("DES-ECB",forge$l.cipher.modes.ecb);registerAlgorithm("DES-CBC",forge$l.cipher.modes.cbc);registerAlgorithm("DES-CFB",forge$l.cipher.modes.cfb);registerAlgorithm("DES-OFB",forge$l.cipher.modes.ofb);registerAlgorithm("DES-CTR",forge$l.cipher.modes.ctr);registerAlgorithm("3DES-ECB",forge$l.cipher.modes.ecb);registerAlgorithm("3DES-CBC",forge$l.cipher.modes.cbc);registerAlgorithm("3DES-CFB",forge$l.cipher.modes.cfb);registerAlgorithm("3DES-OFB",forge$l.cipher.modes.ofb);registerAlgorithm("3DES-CTR",forge$l.cipher.modes.ctr);function registerAlgorithm(_,o){var $=function(){return new forge$l.des.Algorithm(_,o)};forge$l.cipher.registerAlgorithm(_,$)}var spfunction1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],spfunction2=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],spfunction3=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],spfunction4=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],spfunction5=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],spfunction6=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],spfunction7=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],spfunction8=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _createKeys(_){for(var o=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],$=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],j=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],et=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],tt=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],rt=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],nt=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],it=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],st=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],ot=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],at=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],ct=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],ut=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],ft=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],ht=_.length()>8?3:1,mt=[],gt=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],Et=0,St,At=0;At<ht;At++){var kt=_.getInt32(),Rt=_.getInt32();St=(kt>>>4^Rt)&252645135,Rt^=St,kt^=St<<4,St=(Rt>>>-16^kt)&65535,kt^=St,Rt^=St<<-16,St=(kt>>>2^Rt)&858993459,Rt^=St,kt^=St<<2,St=(Rt>>>-16^kt)&65535,kt^=St,Rt^=St<<-16,St=(kt>>>1^Rt)&1431655765,Rt^=St,kt^=St<<1,St=(Rt>>>8^kt)&16711935,kt^=St,Rt^=St<<8,St=(kt>>>1^Rt)&1431655765,Rt^=St,kt^=St<<1,St=kt<<8|Rt>>>20&240,kt=Rt<<24|Rt<<8&16711680|Rt>>>8&65280|Rt>>>24&240,Rt=St;for(var Tt=0;Tt<gt.length;++Tt){gt[Tt]?(kt=kt<<2|kt>>>26,Rt=Rt<<2|Rt>>>26):(kt=kt<<1|kt>>>27,Rt=Rt<<1|Rt>>>27),kt&=-15,Rt&=-15;var Dt=o[kt>>>28]|$[kt>>>24&15]|j[kt>>>20&15]|et[kt>>>16&15]|tt[kt>>>12&15]|rt[kt>>>8&15]|nt[kt>>>4&15],Ot=it[Rt>>>28]|st[Rt>>>24&15]|ot[Rt>>>20&15]|at[Rt>>>16&15]|ct[Rt>>>12&15]|ut[Rt>>>8&15]|ft[Rt>>>4&15];St=(Ot>>>16^Dt)&65535,mt[Et++]=Dt^St,mt[Et++]=Ot^St<<16}}return mt}function _updateBlock(_,o,$,j){var et=_.length===32?3:9,tt;et===3?tt=j?[30,-2,-2]:[0,32,2]:tt=j?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var rt,nt=o[0],it=o[1];rt=(nt>>>4^it)&252645135,it^=rt,nt^=rt<<4,rt=(nt>>>16^it)&65535,it^=rt,nt^=rt<<16,rt=(it>>>2^nt)&858993459,nt^=rt,it^=rt<<2,rt=(it>>>8^nt)&16711935,nt^=rt,it^=rt<<8,rt=(nt>>>1^it)&1431655765,it^=rt,nt^=rt<<1,nt=nt<<1|nt>>>31,it=it<<1|it>>>31;for(var st=0;st<et;st+=3){for(var ot=tt[st+1],at=tt[st+2],ct=tt[st];ct!=ot;ct+=at){var ut=it^_[ct],ft=(it>>>4|it<<28)^_[ct+1];rt=nt,nt=it,it=rt^(spfunction2[ut>>>24&63]|spfunction4[ut>>>16&63]|spfunction6[ut>>>8&63]|spfunction8[ut&63]|spfunction1[ft>>>24&63]|spfunction3[ft>>>16&63]|spfunction5[ft>>>8&63]|spfunction7[ft&63])}rt=nt,nt=it,it=rt}nt=nt>>>1|nt<<31,it=it>>>1|it<<31,rt=(nt>>>1^it)&1431655765,it^=rt,nt^=rt<<1,rt=(it>>>8^nt)&16711935,nt^=rt,it^=rt<<8,rt=(it>>>2^nt)&858993459,nt^=rt,it^=rt<<2,rt=(nt>>>16^it)&65535,it^=rt,nt^=rt<<16,rt=(nt>>>4^it)&252645135,it^=rt,nt^=rt<<4,$[0]=nt,$[1]=it}function _createCipher(_){_=_||{};var o=(_.mode||"CBC").toUpperCase(),$="DES-"+o,j;_.decrypt?j=forge$l.cipher.createDecipher($,_.key):j=forge$l.cipher.createCipher($,_.key);var et=j.start;return j.start=function(tt,rt){var nt=null;rt instanceof forge$l.util.ByteBuffer&&(nt=rt,rt={}),rt=rt||{},rt.output=nt,rt.iv=tt,et.call(j,rt)},j}var forge$k=forge$s;forge$k.md=forge$k.md||{};forge$k.md.algorithms=forge$k.md.algorithms||{};var forge$j=forge$s,hmac$3=forge$j.hmac=forge$j.hmac||{};hmac$3.create=function(){var _=null,o=null,$=null,j=null,et={};return et.start=function(tt,rt){if(tt!==null)if(typeof tt=="string")if(tt=tt.toLowerCase(),tt in forge$j.md.algorithms)o=forge$j.md.algorithms[tt].create();else throw new Error('Unknown hash algorithm "'+tt+'"');else o=tt;if(rt===null)rt=_;else{if(typeof rt=="string")rt=forge$j.util.createBuffer(rt);else if(forge$j.util.isArray(rt)){var nt=rt;rt=forge$j.util.createBuffer();for(var it=0;it<nt.length;++it)rt.putByte(nt[it])}var st=rt.length();st>o.blockLength&&(o.start(),o.update(rt.bytes()),rt=o.digest()),$=forge$j.util.createBuffer(),j=forge$j.util.createBuffer(),st=rt.length();for(var it=0;it<st;++it){var nt=rt.at(it);$.putByte(54^nt),j.putByte(92^nt)}if(st<o.blockLength)for(var nt=o.blockLength-st,it=0;it<nt;++it)$.putByte(54),j.putByte(92);_=rt,$=$.bytes(),j=j.bytes()}o.start(),o.update($)},et.update=function(tt){o.update(tt)},et.getMac=function(){var tt=o.digest().bytes();return o.start(),o.update(j),o.update(tt),o.digest()},et.digest=et.getMac,et};var cryptoBrowserify={},browserExports$2={},browser$g={get exports(){return browserExports$2},set exports(_){browserExports$2=_}},safeBufferExports={},safeBuffer={get exports(){return safeBufferExports},set exports(_){safeBufferExports=_}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(_,o){var $=buffer$2,j=$.Buffer;function et(rt,nt){for(var it in rt)nt[it]=rt[it]}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?_.exports=$:(et($,o),o.Buffer=tt);function tt(rt,nt,it){return j(rt,nt,it)}tt.prototype=Object.create(j.prototype),et(j,tt),tt.from=function(rt,nt,it){if(typeof rt=="number")throw new TypeError("Argument must not be a number");return j(rt,nt,it)},tt.alloc=function(rt,nt,it){if(typeof rt!="number")throw new TypeError("Argument must be a number");var st=j(rt);return nt!==void 0?typeof it=="string"?st.fill(nt,it):st.fill(nt):st.fill(0),st},tt.allocUnsafe=function(rt){if(typeof rt!="number")throw new TypeError("Argument must be a number");return j(rt)},tt.allocUnsafeSlow=function(rt){if(typeof rt!="number")throw new TypeError("Argument must be a number");return $.SlowBuffer(rt)}})(safeBuffer,safeBufferExports);var hasRequiredBrowser$c;function requireBrowser$c(){if(hasRequiredBrowser$c)return browserExports$2;hasRequiredBrowser$c=1;var _=65536,o=4294967295;function $(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var j=safeBufferExports.Buffer,et=commonjsGlobal.crypto||commonjsGlobal.msCrypto;et&&et.getRandomValues?browser$g.exports=tt:browser$g.exports=$;function tt(rt,nt){if(rt>o)throw new RangeError("requested too many random bytes");var it=j.allocUnsafe(rt);if(rt>0)if(rt>_)for(var st=0;st<rt;st+=_)et.getRandomValues(it.slice(st,st+_));else et.getRandomValues(it);return typeof nt=="function"?browserExports$3.nextTick(function(){nt(null,it)}):it}return browserExports$2}var readableBrowserExports={},readableBrowser={get exports(){return readableBrowserExports},set exports(_){readableBrowserExports=_}},streamBrowser,hasRequiredStreamBrowser;function requireStreamBrowser(){return hasRequiredStreamBrowser||(hasRequiredStreamBrowser=1,streamBrowser=eventsExports.EventEmitter),streamBrowser}var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;function _(ft,ht){var mt=Object.keys(ft);if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(ft);ht&&(gt=gt.filter(function(Et){return Object.getOwnPropertyDescriptor(ft,Et).enumerable})),mt.push.apply(mt,gt)}return mt}function o(ft){for(var ht=1;ht<arguments.length;ht++){var mt=arguments[ht]!=null?arguments[ht]:{};ht%2?_(Object(mt),!0).forEach(function(gt){$(ft,gt,mt[gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ft,Object.getOwnPropertyDescriptors(mt)):_(Object(mt)).forEach(function(gt){Object.defineProperty(ft,gt,Object.getOwnPropertyDescriptor(mt,gt))})}return ft}function $(ft,ht,mt){return ht=rt(ht),ht in ft?Object.defineProperty(ft,ht,{value:mt,enumerable:!0,configurable:!0,writable:!0}):ft[ht]=mt,ft}function j(ft,ht){if(!(ft instanceof ht))throw new TypeError("Cannot call a class as a function")}function et(ft,ht){for(var mt=0;mt<ht.length;mt++){var gt=ht[mt];gt.enumerable=gt.enumerable||!1,gt.configurable=!0,"value"in gt&&(gt.writable=!0),Object.defineProperty(ft,rt(gt.key),gt)}}function tt(ft,ht,mt){return ht&&et(ft.prototype,ht),mt&&et(ft,mt),Object.defineProperty(ft,"prototype",{writable:!1}),ft}function rt(ft){var ht=nt(ft,"string");return typeof ht=="symbol"?ht:String(ht)}function nt(ft,ht){if(typeof ft!="object"||ft===null)return ft;var mt=ft[Symbol.toPrimitive];if(mt!==void 0){var gt=mt.call(ft,ht||"default");if(typeof gt!="object")return gt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ht==="string"?String:Number)(ft)}var it=buffer$2,st=it.Buffer,ot=util$9,at=ot.inspect,ct=at&&at.custom||"inspect";function ut(ft,ht,mt){st.prototype.copy.call(ft,ht,mt)}return buffer_list=function(){function ft(){j(this,ft),this.head=null,this.tail=null,this.length=0}return tt(ft,[{key:"push",value:function(mt){var gt={data:mt,next:null};this.length>0?this.tail.next=gt:this.head=gt,this.tail=gt,++this.length}},{key:"unshift",value:function(mt){var gt={data:mt,next:this.head};this.length===0&&(this.tail=gt),this.head=gt,++this.length}},{key:"shift",value:function(){if(this.length!==0){var mt=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,mt}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(mt){if(this.length===0)return"";for(var gt=this.head,Et=""+gt.data;gt=gt.next;)Et+=mt+gt.data;return Et}},{key:"concat",value:function(mt){if(this.length===0)return st.alloc(0);for(var gt=st.allocUnsafe(mt>>>0),Et=this.head,St=0;Et;)ut(Et.data,gt,St),St+=Et.data.length,Et=Et.next;return gt}},{key:"consume",value:function(mt,gt){var Et;return mt<this.head.data.length?(Et=this.head.data.slice(0,mt),this.head.data=this.head.data.slice(mt)):mt===this.head.data.length?Et=this.shift():Et=gt?this._getString(mt):this._getBuffer(mt),Et}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(mt){var gt=this.head,Et=1,St=gt.data;for(mt-=St.length;gt=gt.next;){var At=gt.data,kt=mt>At.length?At.length:mt;if(kt===At.length?St+=At:St+=At.slice(0,mt),mt-=kt,mt===0){kt===At.length?(++Et,gt.next?this.head=gt.next:this.head=this.tail=null):(this.head=gt,gt.data=At.slice(kt));break}++Et}return this.length-=Et,St}},{key:"_getBuffer",value:function(mt){var gt=st.allocUnsafe(mt),Et=this.head,St=1;for(Et.data.copy(gt),mt-=Et.data.length;Et=Et.next;){var At=Et.data,kt=mt>At.length?At.length:mt;if(At.copy(gt,gt.length-mt,0,kt),mt-=kt,mt===0){kt===At.length?(++St,Et.next?this.head=Et.next:this.head=this.tail=null):(this.head=Et,Et.data=At.slice(kt));break}++St}return this.length-=St,gt}},{key:ct,value:function(mt,gt){return at(this,o(o({},gt),{},{depth:0,customInspect:!1}))}}]),ft}(),buffer_list}var destroy_1,hasRequiredDestroy;function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;function _(rt,nt){var it=this,st=this._readableState&&this._readableState.destroyed,ot=this._writableState&&this._writableState.destroyed;return st||ot?(nt?nt(rt):rt&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,browserExports$3.nextTick(et,this,rt)):browserExports$3.nextTick(et,this,rt)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(rt||null,function(at){!nt&&at?it._writableState?it._writableState.errorEmitted?browserExports$3.nextTick($,it):(it._writableState.errorEmitted=!0,browserExports$3.nextTick(o,it,at)):browserExports$3.nextTick(o,it,at):nt?(browserExports$3.nextTick($,it),nt(at)):browserExports$3.nextTick($,it)}),this)}function o(rt,nt){et(rt,nt),$(rt)}function $(rt){rt._writableState&&!rt._writableState.emitClose||rt._readableState&&!rt._readableState.emitClose||rt.emit("close")}function j(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function et(rt,nt){rt.emit("error",nt)}function tt(rt,nt){var it=rt._readableState,st=rt._writableState;it&&it.autoDestroy||st&&st.autoDestroy?rt.destroy(nt):rt.emit("error",nt)}return destroy_1={destroy:_,undestroy:j,errorOrDestroy:tt},destroy_1}var errorsBrowser={},hasRequiredErrorsBrowser;function requireErrorsBrowser(){if(hasRequiredErrorsBrowser)return errorsBrowser;hasRequiredErrorsBrowser=1;function _(nt,it){nt.prototype=Object.create(it.prototype),nt.prototype.constructor=nt,nt.__proto__=it}var o={};function $(nt,it,st){st||(st=Error);function ot(ct,ut,ft){return typeof it=="string"?it:it(ct,ut,ft)}var at=function(ct){_(ut,ct);function ut(ft,ht,mt){return ct.call(this,ot(ft,ht,mt))||this}return ut}(st);at.prototype.name=st.name,at.prototype.code=nt,o[nt]=at}function j(nt,it){if(Array.isArray(nt)){var st=nt.length;return nt=nt.map(function(ot){return String(ot)}),st>2?"one of ".concat(it," ").concat(nt.slice(0,st-1).join(", "),", or ")+nt[st-1]:st===2?"one of ".concat(it," ").concat(nt[0]," or ").concat(nt[1]):"of ".concat(it," ").concat(nt[0])}else return"of ".concat(it," ").concat(String(nt))}function et(nt,it,st){return nt.substr(!st||st<0?0:+st,it.length)===it}function tt(nt,it,st){return(st===void 0||st>nt.length)&&(st=nt.length),nt.substring(st-it.length,st)===it}function rt(nt,it,st){return typeof st!="number"&&(st=0),st+it.length>nt.length?!1:nt.indexOf(it,st)!==-1}return $("ERR_INVALID_OPT_VALUE",function(nt,it){return'The value "'+it+'" is invalid for option "'+nt+'"'},TypeError),$("ERR_INVALID_ARG_TYPE",function(nt,it,st){var ot;typeof it=="string"&&et(it,"not ")?(ot="must not be",it=it.replace(/^not /,"")):ot="must be";var at;if(tt(nt," argument"))at="The ".concat(nt," ").concat(ot," ").concat(j(it,"type"));else{var ct=rt(nt,".")?"property":"argument";at='The "'.concat(nt,'" ').concat(ct," ").concat(ot," ").concat(j(it,"type"))}return at+=". Received type ".concat(typeof st),at},TypeError),$("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),$("ERR_METHOD_NOT_IMPLEMENTED",function(nt){return"The "+nt+" method is not implemented"}),$("ERR_STREAM_PREMATURE_CLOSE","Premature close"),$("ERR_STREAM_DESTROYED",function(nt){return"Cannot call "+nt+" after a stream was destroyed"}),$("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),$("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),$("ERR_STREAM_WRITE_AFTER_END","write after end"),$("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),$("ERR_UNKNOWN_ENCODING",function(nt){return"Unknown encoding: "+nt},TypeError),$("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),errorsBrowser.codes=o,errorsBrowser}var state,hasRequiredState;function requireState(){if(hasRequiredState)return state;hasRequiredState=1;var _=requireErrorsBrowser().codes.ERR_INVALID_OPT_VALUE;function o(j,et,tt){return j.highWaterMark!=null?j.highWaterMark:et?j[tt]:null}function $(j,et,tt,rt){var nt=o(et,rt,tt);if(nt!=null){if(!(isFinite(nt)&&Math.floor(nt)===nt)||nt<0){var it=rt?tt:"highWaterMark";throw new _(it,nt)}return Math.floor(nt)}return j.objectMode?16:16*1024}return state={getHighWaterMark:$},state}var browser$f,hasRequiredBrowser$b;function requireBrowser$b(){if(hasRequiredBrowser$b)return browser$f;hasRequiredBrowser$b=1,browser$f=_;function _($,j){if(o("noDeprecation"))return $;var et=!1;function tt(){if(!et){if(o("throwDeprecation"))throw new Error(j);o("traceDeprecation")?console.trace(j):console.warn(j),et=!0}return $.apply(this,arguments)}return tt}function o($){try{if(!commonjsGlobal.localStorage)return!1}catch{return!1}var j=commonjsGlobal.localStorage[$];return j==null?!1:String(j).toLowerCase()==="true"}return browser$f}var _stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1,_stream_writable=Dt;function _(Gt){var Wt=this;this.next=null,this.entry=null,this.finish=function(){Pt(Wt,Gt)}}var o;Dt.WritableState=Rt;var $={deprecate:requireBrowser$b()},j=requireStreamBrowser(),et=buffer$2.Buffer,tt=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function rt(Gt){return et.from(Gt)}function nt(Gt){return et.isBuffer(Gt)||Gt instanceof tt}var it=requireDestroy(),st=requireState(),ot=st.getHighWaterMark,at=requireErrorsBrowser().codes,ct=at.ERR_INVALID_ARG_TYPE,ut=at.ERR_METHOD_NOT_IMPLEMENTED,ft=at.ERR_MULTIPLE_CALLBACK,ht=at.ERR_STREAM_CANNOT_PIPE,mt=at.ERR_STREAM_DESTROYED,gt=at.ERR_STREAM_NULL_VALUES,Et=at.ERR_STREAM_WRITE_AFTER_END,St=at.ERR_UNKNOWN_ENCODING,At=it.errorOrDestroy;inherits_browserExports(Dt,j);function kt(){}function Rt(Gt,Wt,Vt){o=o||require_stream_duplex(),Gt=Gt||{},typeof Vt!="boolean"&&(Vt=Wt instanceof o),this.objectMode=!!Gt.objectMode,Vt&&(this.objectMode=this.objectMode||!!Gt.writableObjectMode),this.highWaterMark=ot(this,Gt,"writableHighWaterMark",Vt),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Ut=Gt.decodeStrings===!1;this.decodeStrings=!Ut,this.defaultEncoding=Gt.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Mt){bt(Wt,Mt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Gt.emitClose!==!1,this.autoDestroy=!!Gt.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new _(this)}Rt.prototype.getBuffer=function(){for(var Wt=this.bufferedRequest,Vt=[];Wt;)Vt.push(Wt),Wt=Wt.next;return Vt},function(){try{Object.defineProperty(Rt.prototype,"buffer",{get:$.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Tt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Tt=Function.prototype[Symbol.hasInstance],Object.defineProperty(Dt,Symbol.hasInstance,{value:function(Wt){return Tt.call(this,Wt)?!0:this!==Dt?!1:Wt&&Wt._writableState instanceof Rt}})):Tt=function(Wt){return Wt instanceof this};function Dt(Gt){o=o||require_stream_duplex();var Wt=this instanceof o;if(!Wt&&!Tt.call(Dt,this))return new Dt(Gt);this._writableState=new Rt(Gt,this,Wt),this.writable=!0,Gt&&(typeof Gt.write=="function"&&(this._write=Gt.write),typeof Gt.writev=="function"&&(this._writev=Gt.writev),typeof Gt.destroy=="function"&&(this._destroy=Gt.destroy),typeof Gt.final=="function"&&(this._final=Gt.final)),j.call(this)}Dt.prototype.pipe=function(){At(this,new ht)};function Ot(Gt,Wt){var Vt=new Et;At(Gt,Vt),browserExports$3.nextTick(Wt,Vt)}function jt(Gt,Wt,Vt,Ut){var Mt;return Vt===null?Mt=new gt:typeof Vt!="string"&&!Wt.objectMode&&(Mt=new ct("chunk",["string","Buffer"],Vt)),Mt?(At(Gt,Mt),browserExports$3.nextTick(Ut,Mt),!1):!0}Dt.prototype.write=function(Gt,Wt,Vt){var Ut=this._writableState,Mt=!1,Lt=!Ut.objectMode&&nt(Gt);return Lt&&!et.isBuffer(Gt)&&(Gt=rt(Gt)),typeof Wt=="function"&&(Vt=Wt,Wt=null),Lt?Wt="buffer":Wt||(Wt=Ut.defaultEncoding),typeof Vt!="function"&&(Vt=kt),Ut.ending?Ot(this,Vt):(Lt||jt(this,Ut,Gt,Vt))&&(Ut.pendingcb++,Mt=It(this,Ut,Lt,Gt,Wt,Vt)),Mt},Dt.prototype.cork=function(){this._writableState.corked++},Dt.prototype.uncork=function(){var Gt=this._writableState;Gt.corked&&(Gt.corked--,!Gt.writing&&!Gt.corked&&!Gt.bufferProcessing&&Gt.bufferedRequest&&Ct(this,Gt))},Dt.prototype.setDefaultEncoding=function(Wt){if(typeof Wt=="string"&&(Wt=Wt.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Wt+"").toLowerCase())>-1))throw new St(Wt);return this._writableState.defaultEncoding=Wt,this},Object.defineProperty(Dt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Nt(Gt,Wt,Vt){return!Gt.objectMode&&Gt.decodeStrings!==!1&&typeof Wt=="string"&&(Wt=et.from(Wt,Vt)),Wt}Object.defineProperty(Dt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function It(Gt,Wt,Vt,Ut,Mt,Lt){if(!Vt){var Yt=Nt(Wt,Ut,Mt);Ut!==Yt&&(Vt=!0,Mt="buffer",Ut=Yt)}var lr=Wt.objectMode?1:Ut.length;Wt.length+=lr;var cr=Wt.length<Wt.highWaterMark;if(cr||(Wt.needDrain=!0),Wt.writing||Wt.corked){var ir=Wt.lastBufferedRequest;Wt.lastBufferedRequest={chunk:Ut,encoding:Mt,isBuf:Vt,callback:Lt,next:null},ir?ir.next=Wt.lastBufferedRequest:Wt.bufferedRequest=Wt.lastBufferedRequest,Wt.bufferedRequestCount+=1}else yt(Gt,Wt,!1,lr,Ut,Mt,Lt);return cr}function yt(Gt,Wt,Vt,Ut,Mt,Lt,Yt){Wt.writelen=Ut,Wt.writecb=Yt,Wt.writing=!0,Wt.sync=!0,Wt.destroyed?Wt.onwrite(new mt("write")):Vt?Gt._writev(Mt,Wt.onwrite):Gt._write(Mt,Lt,Wt.onwrite),Wt.sync=!1}function lt(Gt,Wt,Vt,Ut,Mt){--Wt.pendingcb,Vt?(browserExports$3.nextTick(Mt,Ut),browserExports$3.nextTick(wt,Gt,Wt),Gt._writableState.errorEmitted=!0,At(Gt,Ut)):(Mt(Ut),Gt._writableState.errorEmitted=!0,At(Gt,Ut),wt(Gt,Wt))}function pt(Gt){Gt.writing=!1,Gt.writecb=null,Gt.length-=Gt.writelen,Gt.writelen=0}function bt(Gt,Wt){var Vt=Gt._writableState,Ut=Vt.sync,Mt=Vt.writecb;if(typeof Mt!="function")throw new ft;if(pt(Vt),Wt)lt(Gt,Vt,Ut,Wt,Mt);else{var Lt=xt(Vt)||Gt.destroyed;!Lt&&!Vt.corked&&!Vt.bufferProcessing&&Vt.bufferedRequest&&Ct(Gt,Vt),Ut?browserExports$3.nextTick(_t,Gt,Vt,Lt,Mt):_t(Gt,Vt,Lt,Mt)}}function _t(Gt,Wt,Vt,Ut){Vt||$t(Gt,Wt),Wt.pendingcb--,Ut(),wt(Gt,Wt)}function $t(Gt,Wt){Wt.length===0&&Wt.needDrain&&(Wt.needDrain=!1,Gt.emit("drain"))}function Ct(Gt,Wt){Wt.bufferProcessing=!0;var Vt=Wt.bufferedRequest;if(Gt._writev&&Vt&&Vt.next){var Ut=Wt.bufferedRequestCount,Mt=new Array(Ut),Lt=Wt.corkedRequestsFree;Lt.entry=Vt;for(var Yt=0,lr=!0;Vt;)Mt[Yt]=Vt,Vt.isBuf||(lr=!1),Vt=Vt.next,Yt+=1;Mt.allBuffers=lr,yt(Gt,Wt,!0,Wt.length,Mt,"",Lt.finish),Wt.pendingcb++,Wt.lastBufferedRequest=null,Lt.next?(Wt.corkedRequestsFree=Lt.next,Lt.next=null):Wt.corkedRequestsFree=new _(Wt),Wt.bufferedRequestCount=0}else{for(;Vt;){var cr=Vt.chunk,ir=Vt.encoding,Zt=Vt.callback,Bt=Wt.objectMode?1:cr.length;if(yt(Gt,Wt,!1,Bt,cr,ir,Zt),Vt=Vt.next,Wt.bufferedRequestCount--,Wt.writing)break}Vt===null&&(Wt.lastBufferedRequest=null)}Wt.bufferedRequest=Vt,Wt.bufferProcessing=!1}Dt.prototype._write=function(Gt,Wt,Vt){Vt(new ut("_write()"))},Dt.prototype._writev=null,Dt.prototype.end=function(Gt,Wt,Vt){var Ut=this._writableState;return typeof Gt=="function"?(Vt=Gt,Gt=null,Wt=null):typeof Wt=="function"&&(Vt=Wt,Wt=null),Gt!=null&&this.write(Gt,Wt),Ut.corked&&(Ut.corked=1,this.uncork()),Ut.ending||qt(this,Ut,Vt),this},Object.defineProperty(Dt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function xt(Gt){return Gt.ending&&Gt.length===0&&Gt.bufferedRequest===null&&!Gt.finished&&!Gt.writing}function vt(Gt,Wt){Gt._final(function(Vt){Wt.pendingcb--,Vt&&At(Gt,Vt),Wt.prefinished=!0,Gt.emit("prefinish"),wt(Gt,Wt)})}function dt(Gt,Wt){!Wt.prefinished&&!Wt.finalCalled&&(typeof Gt._final=="function"&&!Wt.destroyed?(Wt.pendingcb++,Wt.finalCalled=!0,browserExports$3.nextTick(vt,Gt,Wt)):(Wt.prefinished=!0,Gt.emit("prefinish")))}function wt(Gt,Wt){var Vt=xt(Wt);if(Vt&&(dt(Gt,Wt),Wt.pendingcb===0&&(Wt.finished=!0,Gt.emit("finish"),Wt.autoDestroy))){var Ut=Gt._readableState;(!Ut||Ut.autoDestroy&&Ut.endEmitted)&&Gt.destroy()}return Vt}function qt(Gt,Wt,Vt){Wt.ending=!0,wt(Gt,Wt),Vt&&(Wt.finished?browserExports$3.nextTick(Vt):Gt.once("finish",Vt)),Wt.ended=!0,Gt.writable=!1}function Pt(Gt,Wt,Vt){var Ut=Gt.entry;for(Gt.entry=null;Ut;){var Mt=Ut.callback;Wt.pendingcb--,Mt(Vt),Ut=Ut.next}Wt.corkedRequestsFree.next=Gt}return Object.defineProperty(Dt.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Wt){this._writableState&&(this._writableState.destroyed=Wt)}}),Dt.prototype.destroy=it.destroy,Dt.prototype._undestroy=it.undestroy,Dt.prototype._destroy=function(Gt,Wt){Wt(Gt)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var _=Object.keys||function(st){var ot=[];for(var at in st)ot.push(at);return ot};_stream_duplex=rt;var o=require_stream_readable(),$=require_stream_writable();inherits_browserExports(rt,o);for(var j=_($.prototype),et=0;et<j.length;et++){var tt=j[et];rt.prototype[tt]||(rt.prototype[tt]=$.prototype[tt])}function rt(st){if(!(this instanceof rt))return new rt(st);o.call(this,st),$.call(this,st),this.allowHalfOpen=!0,st&&(st.readable===!1&&(this.readable=!1),st.writable===!1&&(this.writable=!1),st.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",nt)))}Object.defineProperty(rt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(rt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(rt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function nt(){this._writableState.ended||browserExports$3.nextTick(it,this)}function it(st){st.end()}return Object.defineProperty(rt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(ot){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=ot,this._writableState.destroyed=ot)}}),_stream_duplex}var string_decoder={},hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var _=safeBufferExports.Buffer,o=_.isEncoding||function(gt){switch(gt=""+gt,gt&&gt.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function $(gt){if(!gt)return"utf8";for(var Et;;)switch(gt){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return gt;default:if(Et)return;gt=(""+gt).toLowerCase(),Et=!0}}function j(gt){var Et=$(gt);if(typeof Et!="string"&&(_.isEncoding===o||!o(gt)))throw new Error("Unknown encoding: "+gt);return Et||gt}string_decoder.StringDecoder=et;function et(gt){this.encoding=j(gt);var Et;switch(this.encoding){case"utf16le":this.text=at,this.end=ct,Et=4;break;case"utf8":this.fillLast=it,Et=4;break;case"base64":this.text=ut,this.end=ft,Et=3;break;default:this.write=ht,this.end=mt;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=_.allocUnsafe(Et)}et.prototype.write=function(gt){if(gt.length===0)return"";var Et,St;if(this.lastNeed){if(Et=this.fillLast(gt),Et===void 0)return"";St=this.lastNeed,this.lastNeed=0}else St=0;return St<gt.length?Et?Et+this.text(gt,St):this.text(gt,St):Et||""},et.prototype.end=ot,et.prototype.text=st,et.prototype.fillLast=function(gt){if(this.lastNeed<=gt.length)return gt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);gt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,gt.length),this.lastNeed-=gt.length};function tt(gt){return gt<=127?0:gt>>5===6?2:gt>>4===14?3:gt>>3===30?4:gt>>6===2?-1:-2}function rt(gt,Et,St){var At=Et.length-1;if(At<St)return 0;var kt=tt(Et[At]);return kt>=0?(kt>0&&(gt.lastNeed=kt-1),kt):--At<St||kt===-2?0:(kt=tt(Et[At]),kt>=0?(kt>0&&(gt.lastNeed=kt-2),kt):--At<St||kt===-2?0:(kt=tt(Et[At]),kt>=0?(kt>0&&(kt===2?kt=0:gt.lastNeed=kt-3),kt):0))}function nt(gt,Et,St){if((Et[0]&192)!==128)return gt.lastNeed=0,"";if(gt.lastNeed>1&&Et.length>1){if((Et[1]&192)!==128)return gt.lastNeed=1,"";if(gt.lastNeed>2&&Et.length>2&&(Et[2]&192)!==128)return gt.lastNeed=2,""}}function it(gt){var Et=this.lastTotal-this.lastNeed,St=nt(this,gt);if(St!==void 0)return St;if(this.lastNeed<=gt.length)return gt.copy(this.lastChar,Et,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);gt.copy(this.lastChar,Et,0,gt.length),this.lastNeed-=gt.length}function st(gt,Et){var St=rt(this,gt,Et);if(!this.lastNeed)return gt.toString("utf8",Et);this.lastTotal=St;var At=gt.length-(St-this.lastNeed);return gt.copy(this.lastChar,0,At),gt.toString("utf8",Et,At)}function ot(gt){var Et=gt&&gt.length?this.write(gt):"";return this.lastNeed?Et+"":Et}function at(gt,Et){if((gt.length-Et)%2===0){var St=gt.toString("utf16le",Et);if(St){var At=St.charCodeAt(St.length-1);if(At>=55296&&At<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=gt[gt.length-2],this.lastChar[1]=gt[gt.length-1],St.slice(0,-1)}return St}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=gt[gt.length-1],gt.toString("utf16le",Et,gt.length-1)}function ct(gt){var Et=gt&&gt.length?this.write(gt):"";if(this.lastNeed){var St=this.lastTotal-this.lastNeed;return Et+this.lastChar.toString("utf16le",0,St)}return Et}function ut(gt,Et){var St=(gt.length-Et)%3;return St===0?gt.toString("base64",Et):(this.lastNeed=3-St,this.lastTotal=3,St===1?this.lastChar[0]=gt[gt.length-1]:(this.lastChar[0]=gt[gt.length-2],this.lastChar[1]=gt[gt.length-1]),gt.toString("base64",Et,gt.length-St))}function ft(gt){var Et=gt&&gt.length?this.write(gt):"";return this.lastNeed?Et+this.lastChar.toString("base64",0,3-this.lastNeed):Et}function ht(gt){return gt.toString(this.encoding)}function mt(gt){return gt&&gt.length?this.write(gt):""}return string_decoder}var endOfStream,hasRequiredEndOfStream;function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream;hasRequiredEndOfStream=1;var _=requireErrorsBrowser().codes.ERR_STREAM_PREMATURE_CLOSE;function o(tt){var rt=!1;return function(){if(!rt){rt=!0;for(var nt=arguments.length,it=new Array(nt),st=0;st<nt;st++)it[st]=arguments[st];tt.apply(this,it)}}}function $(){}function j(tt){return tt.setHeader&&typeof tt.abort=="function"}function et(tt,rt,nt){if(typeof rt=="function")return et(tt,null,rt);rt||(rt={}),nt=o(nt||$);var it=rt.readable||rt.readable!==!1&&tt.readable,st=rt.writable||rt.writable!==!1&&tt.writable,ot=function(){tt.writable||ct()},at=tt._writableState&&tt._writableState.finished,ct=function(){st=!1,at=!0,it||nt.call(tt)},ut=tt._readableState&&tt._readableState.endEmitted,ft=function(){it=!1,ut=!0,st||nt.call(tt)},ht=function(St){nt.call(tt,St)},mt=function(){var St;if(it&&!ut)return(!tt._readableState||!tt._readableState.ended)&&(St=new _),nt.call(tt,St);if(st&&!at)return(!tt._writableState||!tt._writableState.ended)&&(St=new _),nt.call(tt,St)},gt=function(){tt.req.on("finish",ct)};return j(tt)?(tt.on("complete",ct),tt.on("abort",mt),tt.req?gt():tt.on("request",gt)):st&&!tt._writableState&&(tt.on("end",ot),tt.on("close",ot)),tt.on("end",ft),tt.on("finish",ct),rt.error!==!1&&tt.on("error",ht),tt.on("close",mt),function(){tt.removeListener("complete",ct),tt.removeListener("abort",mt),tt.removeListener("request",gt),tt.req&&tt.req.removeListener("finish",ct),tt.removeListener("end",ot),tt.removeListener("close",ot),tt.removeListener("finish",ct),tt.removeListener("end",ft),tt.removeListener("error",ht),tt.removeListener("close",mt)}}return endOfStream=et,endOfStream}var async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var _;function o(St,At,kt){return At=$(At),At in St?Object.defineProperty(St,At,{value:kt,enumerable:!0,configurable:!0,writable:!0}):St[At]=kt,St}function $(St){var At=j(St,"string");return typeof At=="symbol"?At:String(At)}function j(St,At){if(typeof St!="object"||St===null)return St;var kt=St[Symbol.toPrimitive];if(kt!==void 0){var Rt=kt.call(St,At||"default");if(typeof Rt!="object")return Rt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(At==="string"?String:Number)(St)}var et=requireEndOfStream(),tt=Symbol("lastResolve"),rt=Symbol("lastReject"),nt=Symbol("error"),it=Symbol("ended"),st=Symbol("lastPromise"),ot=Symbol("handlePromise"),at=Symbol("stream");function ct(St,At){return{value:St,done:At}}function ut(St){var At=St[tt];if(At!==null){var kt=St[at].read();kt!==null&&(St[st]=null,St[tt]=null,St[rt]=null,At(ct(kt,!1)))}}function ft(St){browserExports$3.nextTick(ut,St)}function ht(St,At){return function(kt,Rt){St.then(function(){if(At[it]){kt(ct(void 0,!0));return}At[ot](kt,Rt)},Rt)}}var mt=Object.getPrototypeOf(function(){}),gt=Object.setPrototypeOf((_={get stream(){return this[at]},next:function(){var At=this,kt=this[nt];if(kt!==null)return Promise.reject(kt);if(this[it])return Promise.resolve(ct(void 0,!0));if(this[at].destroyed)return new Promise(function(Ot,jt){browserExports$3.nextTick(function(){At[nt]?jt(At[nt]):Ot(ct(void 0,!0))})});var Rt=this[st],Tt;if(Rt)Tt=new Promise(ht(Rt,this));else{var Dt=this[at].read();if(Dt!==null)return Promise.resolve(ct(Dt,!1));Tt=new Promise(this[ot])}return this[st]=Tt,Tt}},o(_,Symbol.asyncIterator,function(){return this}),o(_,"return",function(){var At=this;return new Promise(function(kt,Rt){At[at].destroy(null,function(Tt){if(Tt){Rt(Tt);return}kt(ct(void 0,!0))})})}),_),mt),Et=function(At){var kt,Rt=Object.create(gt,(kt={},o(kt,at,{value:At,writable:!0}),o(kt,tt,{value:null,writable:!0}),o(kt,rt,{value:null,writable:!0}),o(kt,nt,{value:null,writable:!0}),o(kt,it,{value:At._readableState.endEmitted,writable:!0}),o(kt,ot,{value:function(Dt,Ot){var jt=Rt[at].read();jt?(Rt[st]=null,Rt[tt]=null,Rt[rt]=null,Dt(ct(jt,!1))):(Rt[tt]=Dt,Rt[rt]=Ot)},writable:!0}),kt));return Rt[st]=null,et(At,function(Tt){if(Tt&&Tt.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Dt=Rt[rt];Dt!==null&&(Rt[st]=null,Rt[tt]=null,Rt[rt]=null,Dt(Tt)),Rt[nt]=Tt;return}var Ot=Rt[tt];Ot!==null&&(Rt[st]=null,Rt[tt]=null,Rt[rt]=null,Ot(ct(void 0,!0))),Rt[it]=!0}),At.on("readable",ft.bind(null,Rt)),Rt};return async_iterator=Et,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1,_stream_readable=Ot;var _;Ot.ReadableState=Dt,eventsExports.EventEmitter;var o=function(Yt,lr){return Yt.listeners(lr).length},$=requireStreamBrowser(),j=buffer$2.Buffer,et=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function tt(Lt){return j.from(Lt)}function rt(Lt){return j.isBuffer(Lt)||Lt instanceof et}var nt=util$9,it;nt&&nt.debuglog?it=nt.debuglog("stream"):it=function(){};var st=requireBuffer_list(),ot=requireDestroy(),at=requireState(),ct=at.getHighWaterMark,ut=requireErrorsBrowser().codes,ft=ut.ERR_INVALID_ARG_TYPE,ht=ut.ERR_STREAM_PUSH_AFTER_EOF,mt=ut.ERR_METHOD_NOT_IMPLEMENTED,gt=ut.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Et,St,At;inherits_browserExports(Ot,$);var kt=ot.errorOrDestroy,Rt=["error","close","destroy","pause","resume"];function Tt(Lt,Yt,lr){if(typeof Lt.prependListener=="function")return Lt.prependListener(Yt,lr);!Lt._events||!Lt._events[Yt]?Lt.on(Yt,lr):Array.isArray(Lt._events[Yt])?Lt._events[Yt].unshift(lr):Lt._events[Yt]=[lr,Lt._events[Yt]]}function Dt(Lt,Yt,lr){_=_||require_stream_duplex(),Lt=Lt||{},typeof lr!="boolean"&&(lr=Yt instanceof _),this.objectMode=!!Lt.objectMode,lr&&(this.objectMode=this.objectMode||!!Lt.readableObjectMode),this.highWaterMark=ct(this,Lt,"readableHighWaterMark",lr),this.buffer=new st,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Lt.emitClose!==!1,this.autoDestroy=!!Lt.autoDestroy,this.destroyed=!1,this.defaultEncoding=Lt.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Lt.encoding&&(Et||(Et=requireString_decoder().StringDecoder),this.decoder=new Et(Lt.encoding),this.encoding=Lt.encoding)}function Ot(Lt){if(_=_||require_stream_duplex(),!(this instanceof Ot))return new Ot(Lt);var Yt=this instanceof _;this._readableState=new Dt(Lt,this,Yt),this.readable=!0,Lt&&(typeof Lt.read=="function"&&(this._read=Lt.read),typeof Lt.destroy=="function"&&(this._destroy=Lt.destroy)),$.call(this)}Object.defineProperty(Ot.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Yt){this._readableState&&(this._readableState.destroyed=Yt)}}),Ot.prototype.destroy=ot.destroy,Ot.prototype._undestroy=ot.undestroy,Ot.prototype._destroy=function(Lt,Yt){Yt(Lt)},Ot.prototype.push=function(Lt,Yt){var lr=this._readableState,cr;return lr.objectMode?cr=!0:typeof Lt=="string"&&(Yt=Yt||lr.defaultEncoding,Yt!==lr.encoding&&(Lt=j.from(Lt,Yt),Yt=""),cr=!0),jt(this,Lt,Yt,!1,cr)},Ot.prototype.unshift=function(Lt){return jt(this,Lt,null,!0,!1)};function jt(Lt,Yt,lr,cr,ir){it("readableAddChunk",Yt);var Zt=Lt._readableState;if(Yt===null)Zt.reading=!1,bt(Lt,Zt);else{var Bt;if(ir||(Bt=It(Zt,Yt)),Bt)kt(Lt,Bt);else if(Zt.objectMode||Yt&&Yt.length>0)if(typeof Yt!="string"&&!Zt.objectMode&&Object.getPrototypeOf(Yt)!==j.prototype&&(Yt=tt(Yt)),cr)Zt.endEmitted?kt(Lt,new gt):Nt(Lt,Zt,Yt,!0);else if(Zt.ended)kt(Lt,new ht);else{if(Zt.destroyed)return!1;Zt.reading=!1,Zt.decoder&&!lr?(Yt=Zt.decoder.write(Yt),Zt.objectMode||Yt.length!==0?Nt(Lt,Zt,Yt,!1):Ct(Lt,Zt)):Nt(Lt,Zt,Yt,!1)}else cr||(Zt.reading=!1,Ct(Lt,Zt))}return!Zt.ended&&(Zt.length<Zt.highWaterMark||Zt.length===0)}function Nt(Lt,Yt,lr,cr){Yt.flowing&&Yt.length===0&&!Yt.sync?(Yt.awaitDrain=0,Lt.emit("data",lr)):(Yt.length+=Yt.objectMode?1:lr.length,cr?Yt.buffer.unshift(lr):Yt.buffer.push(lr),Yt.needReadable&&_t(Lt)),Ct(Lt,Yt)}function It(Lt,Yt){var lr;return!rt(Yt)&&typeof Yt!="string"&&Yt!==void 0&&!Lt.objectMode&&(lr=new ft("chunk",["string","Buffer","Uint8Array"],Yt)),lr}Ot.prototype.isPaused=function(){return this._readableState.flowing===!1},Ot.prototype.setEncoding=function(Lt){Et||(Et=requireString_decoder().StringDecoder);var Yt=new Et(Lt);this._readableState.decoder=Yt,this._readableState.encoding=this._readableState.decoder.encoding;for(var lr=this._readableState.buffer.head,cr="";lr!==null;)cr+=Yt.write(lr.data),lr=lr.next;return this._readableState.buffer.clear(),cr!==""&&this._readableState.buffer.push(cr),this._readableState.length=cr.length,this};var yt=1073741824;function lt(Lt){return Lt>=yt?Lt=yt:(Lt--,Lt|=Lt>>>1,Lt|=Lt>>>2,Lt|=Lt>>>4,Lt|=Lt>>>8,Lt|=Lt>>>16,Lt++),Lt}function pt(Lt,Yt){return Lt<=0||Yt.length===0&&Yt.ended?0:Yt.objectMode?1:Lt!==Lt?Yt.flowing&&Yt.length?Yt.buffer.head.data.length:Yt.length:(Lt>Yt.highWaterMark&&(Yt.highWaterMark=lt(Lt)),Lt<=Yt.length?Lt:Yt.ended?Yt.length:(Yt.needReadable=!0,0))}Ot.prototype.read=function(Lt){it("read",Lt),Lt=parseInt(Lt,10);var Yt=this._readableState,lr=Lt;if(Lt!==0&&(Yt.emittedReadable=!1),Lt===0&&Yt.needReadable&&((Yt.highWaterMark!==0?Yt.length>=Yt.highWaterMark:Yt.length>0)||Yt.ended))return it("read: emitReadable",Yt.length,Yt.ended),Yt.length===0&&Yt.ended?Vt(this):_t(this),null;if(Lt=pt(Lt,Yt),Lt===0&&Yt.ended)return Yt.length===0&&Vt(this),null;var cr=Yt.needReadable;it("need readable",cr),(Yt.length===0||Yt.length-Lt<Yt.highWaterMark)&&(cr=!0,it("length less than watermark",cr)),Yt.ended||Yt.reading?(cr=!1,it("reading or ended",cr)):cr&&(it("do read"),Yt.reading=!0,Yt.sync=!0,Yt.length===0&&(Yt.needReadable=!0),this._read(Yt.highWaterMark),Yt.sync=!1,Yt.reading||(Lt=pt(lr,Yt)));var ir;return Lt>0?ir=Wt(Lt,Yt):ir=null,ir===null?(Yt.needReadable=Yt.length<=Yt.highWaterMark,Lt=0):(Yt.length-=Lt,Yt.awaitDrain=0),Yt.length===0&&(Yt.ended||(Yt.needReadable=!0),lr!==Lt&&Yt.ended&&Vt(this)),ir!==null&&this.emit("data",ir),ir};function bt(Lt,Yt){if(it("onEofChunk"),!Yt.ended){if(Yt.decoder){var lr=Yt.decoder.end();lr&&lr.length&&(Yt.buffer.push(lr),Yt.length+=Yt.objectMode?1:lr.length)}Yt.ended=!0,Yt.sync?_t(Lt):(Yt.needReadable=!1,Yt.emittedReadable||(Yt.emittedReadable=!0,$t(Lt)))}}function _t(Lt){var Yt=Lt._readableState;it("emitReadable",Yt.needReadable,Yt.emittedReadable),Yt.needReadable=!1,Yt.emittedReadable||(it("emitReadable",Yt.flowing),Yt.emittedReadable=!0,browserExports$3.nextTick($t,Lt))}function $t(Lt){var Yt=Lt._readableState;it("emitReadable_",Yt.destroyed,Yt.length,Yt.ended),!Yt.destroyed&&(Yt.length||Yt.ended)&&(Lt.emit("readable"),Yt.emittedReadable=!1),Yt.needReadable=!Yt.flowing&&!Yt.ended&&Yt.length<=Yt.highWaterMark,Gt(Lt)}function Ct(Lt,Yt){Yt.readingMore||(Yt.readingMore=!0,browserExports$3.nextTick(xt,Lt,Yt))}function xt(Lt,Yt){for(;!Yt.reading&&!Yt.ended&&(Yt.length<Yt.highWaterMark||Yt.flowing&&Yt.length===0);){var lr=Yt.length;if(it("maybeReadMore read 0"),Lt.read(0),lr===Yt.length)break}Yt.readingMore=!1}Ot.prototype._read=function(Lt){kt(this,new mt("_read()"))},Ot.prototype.pipe=function(Lt,Yt){var lr=this,cr=this._readableState;switch(cr.pipesCount){case 0:cr.pipes=Lt;break;case 1:cr.pipes=[cr.pipes,Lt];break;default:cr.pipes.push(Lt);break}cr.pipesCount+=1,it("pipe count=%d opts=%j",cr.pipesCount,Yt);var ir=(!Yt||Yt.end!==!1)&&Lt!==browserExports$3.stdout&&Lt!==browserExports$3.stderr,Zt=ir?Ft:ar;cr.endEmitted?browserExports$3.nextTick(Zt):lr.once("end",Zt),Lt.on("unpipe",Bt);function Bt(er,Xt){it("onunpipe"),er===lr&&Xt&&Xt.hasUnpiped===!1&&(Xt.hasUnpiped=!0,nr())}function Ft(){it("onend"),Lt.end()}var zt=vt(lr);Lt.on("drain",zt);var Qt=!1;function nr(){it("cleanup"),Lt.removeListener("close",vr),Lt.removeListener("finish",Nr),Lt.removeListener("drain",zt),Lt.removeListener("error",br),Lt.removeListener("unpipe",Bt),lr.removeListener("end",Ft),lr.removeListener("end",ar),lr.removeListener("data",gr),Qt=!0,cr.awaitDrain&&(!Lt._writableState||Lt._writableState.needDrain)&&zt()}lr.on("data",gr);function gr(er){it("ondata");var Xt=Lt.write(er);it("dest.write",Xt),Xt===!1&&((cr.pipesCount===1&&cr.pipes===Lt||cr.pipesCount>1&&Mt(cr.pipes,Lt)!==-1)&&!Qt&&(it("false write response, pause",cr.awaitDrain),cr.awaitDrain++),lr.pause())}function br(er){it("onerror",er),ar(),Lt.removeListener("error",br),o(Lt,"error")===0&&kt(Lt,er)}Tt(Lt,"error",br);function vr(){Lt.removeListener("finish",Nr),ar()}Lt.once("close",vr);function Nr(){it("onfinish"),Lt.removeListener("close",vr),ar()}Lt.once("finish",Nr);function ar(){it("unpipe"),lr.unpipe(Lt)}return Lt.emit("pipe",lr),cr.flowing||(it("pipe resume"),lr.resume()),Lt};function vt(Lt){return function(){var lr=Lt._readableState;it("pipeOnDrain",lr.awaitDrain),lr.awaitDrain&&lr.awaitDrain--,lr.awaitDrain===0&&o(Lt,"data")&&(lr.flowing=!0,Gt(Lt))}}Ot.prototype.unpipe=function(Lt){var Yt=this._readableState,lr={hasUnpiped:!1};if(Yt.pipesCount===0)return this;if(Yt.pipesCount===1)return Lt&&Lt!==Yt.pipes?this:(Lt||(Lt=Yt.pipes),Yt.pipes=null,Yt.pipesCount=0,Yt.flowing=!1,Lt&&Lt.emit("unpipe",this,lr),this);if(!Lt){var cr=Yt.pipes,ir=Yt.pipesCount;Yt.pipes=null,Yt.pipesCount=0,Yt.flowing=!1;for(var Zt=0;Zt<ir;Zt++)cr[Zt].emit("unpipe",this,{hasUnpiped:!1});return this}var Bt=Mt(Yt.pipes,Lt);return Bt===-1?this:(Yt.pipes.splice(Bt,1),Yt.pipesCount-=1,Yt.pipesCount===1&&(Yt.pipes=Yt.pipes[0]),Lt.emit("unpipe",this,lr),this)},Ot.prototype.on=function(Lt,Yt){var lr=$.prototype.on.call(this,Lt,Yt),cr=this._readableState;return Lt==="data"?(cr.readableListening=this.listenerCount("readable")>0,cr.flowing!==!1&&this.resume()):Lt==="readable"&&!cr.endEmitted&&!cr.readableListening&&(cr.readableListening=cr.needReadable=!0,cr.flowing=!1,cr.emittedReadable=!1,it("on readable",cr.length,cr.reading),cr.length?_t(this):cr.reading||browserExports$3.nextTick(wt,this)),lr},Ot.prototype.addListener=Ot.prototype.on,Ot.prototype.removeListener=function(Lt,Yt){var lr=$.prototype.removeListener.call(this,Lt,Yt);return Lt==="readable"&&browserExports$3.nextTick(dt,this),lr},Ot.prototype.removeAllListeners=function(Lt){var Yt=$.prototype.removeAllListeners.apply(this,arguments);return(Lt==="readable"||Lt===void 0)&&browserExports$3.nextTick(dt,this),Yt};function dt(Lt){var Yt=Lt._readableState;Yt.readableListening=Lt.listenerCount("readable")>0,Yt.resumeScheduled&&!Yt.paused?Yt.flowing=!0:Lt.listenerCount("data")>0&&Lt.resume()}function wt(Lt){it("readable nexttick read 0"),Lt.read(0)}Ot.prototype.resume=function(){var Lt=this._readableState;return Lt.flowing||(it("resume"),Lt.flowing=!Lt.readableListening,qt(this,Lt)),Lt.paused=!1,this};function qt(Lt,Yt){Yt.resumeScheduled||(Yt.resumeScheduled=!0,browserExports$3.nextTick(Pt,Lt,Yt))}function Pt(Lt,Yt){it("resume",Yt.reading),Yt.reading||Lt.read(0),Yt.resumeScheduled=!1,Lt.emit("resume"),Gt(Lt),Yt.flowing&&!Yt.reading&&Lt.read(0)}Ot.prototype.pause=function(){return it("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(it("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Gt(Lt){var Yt=Lt._readableState;for(it("flow",Yt.flowing);Yt.flowing&&Lt.read()!==null;);}Ot.prototype.wrap=function(Lt){var Yt=this,lr=this._readableState,cr=!1;Lt.on("end",function(){if(it("wrapped end"),lr.decoder&&!lr.ended){var Bt=lr.decoder.end();Bt&&Bt.length&&Yt.push(Bt)}Yt.push(null)}),Lt.on("data",function(Bt){if(it("wrapped data"),lr.decoder&&(Bt=lr.decoder.write(Bt)),!(lr.objectMode&&Bt==null)&&!(!lr.objectMode&&(!Bt||!Bt.length))){var Ft=Yt.push(Bt);Ft||(cr=!0,Lt.pause())}});for(var ir in Lt)this[ir]===void 0&&typeof Lt[ir]=="function"&&(this[ir]=function(Ft){return function(){return Lt[Ft].apply(Lt,arguments)}}(ir));for(var Zt=0;Zt<Rt.length;Zt++)Lt.on(Rt[Zt],this.emit.bind(this,Rt[Zt]));return this._read=function(Bt){it("wrapped _read",Bt),cr&&(cr=!1,Lt.resume())},this},typeof Symbol=="function"&&(Ot.prototype[Symbol.asyncIterator]=function(){return St===void 0&&(St=requireAsync_iterator()),St(this)}),Object.defineProperty(Ot.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Ot.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Ot.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Yt){this._readableState&&(this._readableState.flowing=Yt)}}),Ot._fromList=Wt,Object.defineProperty(Ot.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Wt(Lt,Yt){if(Yt.length===0)return null;var lr;return Yt.objectMode?lr=Yt.buffer.shift():!Lt||Lt>=Yt.length?(Yt.decoder?lr=Yt.buffer.join(""):Yt.buffer.length===1?lr=Yt.buffer.first():lr=Yt.buffer.concat(Yt.length),Yt.buffer.clear()):lr=Yt.buffer.consume(Lt,Yt.decoder),lr}function Vt(Lt){var Yt=Lt._readableState;it("endReadable",Yt.endEmitted),Yt.endEmitted||(Yt.ended=!0,browserExports$3.nextTick(Ut,Yt,Lt))}function Ut(Lt,Yt){if(it("endReadableNT",Lt.endEmitted,Lt.length),!Lt.endEmitted&&Lt.length===0&&(Lt.endEmitted=!0,Yt.readable=!1,Yt.emit("end"),Lt.autoDestroy)){var lr=Yt._writableState;(!lr||lr.autoDestroy&&lr.finished)&&Yt.destroy()}}typeof Symbol=="function"&&(Ot.from=function(Lt,Yt){return At===void 0&&(At=requireFromBrowser()),At(Ot,Lt,Yt)});function Mt(Lt,Yt){for(var lr=0,cr=Lt.length;lr<cr;lr++)if(Lt[lr]===Yt)return lr;return-1}return _stream_readable}var _stream_transform,hasRequired_stream_transform;function require_stream_transform(){if(hasRequired_stream_transform)return _stream_transform;hasRequired_stream_transform=1,_stream_transform=nt;var _=requireErrorsBrowser().codes,o=_.ERR_METHOD_NOT_IMPLEMENTED,$=_.ERR_MULTIPLE_CALLBACK,j=_.ERR_TRANSFORM_ALREADY_TRANSFORMING,et=_.ERR_TRANSFORM_WITH_LENGTH_0,tt=require_stream_duplex();inherits_browserExports(nt,tt);function rt(ot,at){var ct=this._transformState;ct.transforming=!1;var ut=ct.writecb;if(ut===null)return this.emit("error",new $);ct.writechunk=null,ct.writecb=null,at!=null&&this.push(at),ut(ot);var ft=this._readableState;ft.reading=!1,(ft.needReadable||ft.length<ft.highWaterMark)&&this._read(ft.highWaterMark)}function nt(ot){if(!(this instanceof nt))return new nt(ot);tt.call(this,ot),this._transformState={afterTransform:rt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,ot&&(typeof ot.transform=="function"&&(this._transform=ot.transform),typeof ot.flush=="function"&&(this._flush=ot.flush)),this.on("prefinish",it)}function it(){var ot=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(at,ct){st(ot,at,ct)}):st(this,null,null)}nt.prototype.push=function(ot,at){return this._transformState.needTransform=!1,tt.prototype.push.call(this,ot,at)},nt.prototype._transform=function(ot,at,ct){ct(new o("_transform()"))},nt.prototype._write=function(ot,at,ct){var ut=this._transformState;if(ut.writecb=ct,ut.writechunk=ot,ut.writeencoding=at,!ut.transforming){var ft=this._readableState;(ut.needTransform||ft.needReadable||ft.length<ft.highWaterMark)&&this._read(ft.highWaterMark)}},nt.prototype._read=function(ot){var at=this._transformState;at.writechunk!==null&&!at.transforming?(at.transforming=!0,this._transform(at.writechunk,at.writeencoding,at.afterTransform)):at.needTransform=!0},nt.prototype._destroy=function(ot,at){tt.prototype._destroy.call(this,ot,function(ct){at(ct)})};function st(ot,at,ct){if(at)return ot.emit("error",at);if(ct!=null&&ot.push(ct),ot._writableState.length)throw new et;if(ot._transformState.transforming)throw new j;return ot.push(null)}return _stream_transform}var _stream_passthrough,hasRequired_stream_passthrough;function require_stream_passthrough(){if(hasRequired_stream_passthrough)return _stream_passthrough;hasRequired_stream_passthrough=1,_stream_passthrough=o;var _=require_stream_transform();inherits_browserExports(o,_);function o($){if(!(this instanceof o))return new o($);_.call(this,$)}return o.prototype._transform=function($,j,et){et(null,$)},_stream_passthrough}var pipeline_1,hasRequiredPipeline;function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;var _;function o(ct){var ut=!1;return function(){ut||(ut=!0,ct.apply(void 0,arguments))}}var $=requireErrorsBrowser().codes,j=$.ERR_MISSING_ARGS,et=$.ERR_STREAM_DESTROYED;function tt(ct){if(ct)throw ct}function rt(ct){return ct.setHeader&&typeof ct.abort=="function"}function nt(ct,ut,ft,ht){ht=o(ht);var mt=!1;ct.on("close",function(){mt=!0}),_===void 0&&(_=requireEndOfStream()),_(ct,{readable:ut,writable:ft},function(Et){if(Et)return ht(Et);mt=!0,ht()});var gt=!1;return function(Et){if(!mt&&!gt){if(gt=!0,rt(ct))return ct.abort();if(typeof ct.destroy=="function")return ct.destroy();ht(Et||new et("pipe"))}}}function it(ct){ct()}function st(ct,ut){return ct.pipe(ut)}function ot(ct){return!ct.length||typeof ct[ct.length-1]!="function"?tt:ct.pop()}function at(){for(var ct=arguments.length,ut=new Array(ct),ft=0;ft<ct;ft++)ut[ft]=arguments[ft];var ht=ot(ut);if(Array.isArray(ut[0])&&(ut=ut[0]),ut.length<2)throw new j("streams");var mt,gt=ut.map(function(Et,St){var At=St<ut.length-1,kt=St>0;return nt(Et,At,kt,function(Rt){mt||(mt=Rt),Rt&&gt.forEach(it),!At&&(gt.forEach(it),ht(mt))})});return ut.reduce(st)}return pipeline_1=at,pipeline_1}var hasRequiredReadableBrowser;function requireReadableBrowser(){return hasRequiredReadableBrowser||(hasRequiredReadableBrowser=1,function(_,o){o=_.exports=require_stream_readable(),o.Stream=o,o.Readable=o,o.Writable=require_stream_writable(),o.Duplex=require_stream_duplex(),o.Transform=require_stream_transform(),o.PassThrough=require_stream_passthrough(),o.finished=requireEndOfStream(),o.pipeline=requirePipeline()}(readableBrowser,readableBrowserExports)),readableBrowserExports}var hashBase,hasRequiredHashBase;function requireHashBase(){if(hasRequiredHashBase)return hashBase;hasRequiredHashBase=1;var _=safeBufferExports.Buffer,o=requireReadableBrowser().Transform,$=inherits_browserExports;function j(tt,rt){if(!_.isBuffer(tt)&&typeof tt!="string")throw new TypeError(rt+" must be a string or a buffer")}function et(tt){o.call(this),this._block=_.allocUnsafe(tt),this._blockSize=tt,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}return $(et,o),et.prototype._transform=function(tt,rt,nt){var it=null;try{this.update(tt,rt)}catch(st){it=st}nt(it)},et.prototype._flush=function(tt){var rt=null;try{this.push(this.digest())}catch(nt){rt=nt}tt(rt)},et.prototype.update=function(tt,rt){if(j(tt,"Data"),this._finalized)throw new Error("Digest already called");_.isBuffer(tt)||(tt=_.from(tt,rt));for(var nt=this._block,it=0;this._blockOffset+tt.length-it>=this._blockSize;){for(var st=this._blockOffset;st<this._blockSize;)nt[st++]=tt[it++];this._update(),this._blockOffset=0}for(;it<tt.length;)nt[this._blockOffset++]=tt[it++];for(var ot=0,at=tt.length*8;at>0;++ot)this._length[ot]+=at,at=this._length[ot]/4294967296|0,at>0&&(this._length[ot]-=4294967296*at);return this},et.prototype._update=function(){throw new Error("_update is not implemented")},et.prototype.digest=function(tt){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var rt=this._digest();tt!==void 0&&(rt=rt.toString(tt)),this._block.fill(0),this._blockOffset=0;for(var nt=0;nt<4;++nt)this._length[nt]=0;return rt},et.prototype._digest=function(){throw new Error("_digest is not implemented")},hashBase=et,hashBase}var md5_js,hasRequiredMd5_js;function requireMd5_js(){if(hasRequiredMd5_js)return md5_js;hasRequiredMd5_js=1;var _=inherits_browserExports,o=requireHashBase(),$=safeBufferExports.Buffer,j=new Array(16);function et(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}_(et,o),et.prototype._update=function(){for(var ot=j,at=0;at<16;++at)ot[at]=this._block.readInt32LE(at*4);var ct=this._a,ut=this._b,ft=this._c,ht=this._d;ct=rt(ct,ut,ft,ht,ot[0],3614090360,7),ht=rt(ht,ct,ut,ft,ot[1],3905402710,12),ft=rt(ft,ht,ct,ut,ot[2],606105819,17),ut=rt(ut,ft,ht,ct,ot[3],3250441966,22),ct=rt(ct,ut,ft,ht,ot[4],4118548399,7),ht=rt(ht,ct,ut,ft,ot[5],1200080426,12),ft=rt(ft,ht,ct,ut,ot[6],2821735955,17),ut=rt(ut,ft,ht,ct,ot[7],4249261313,22),ct=rt(ct,ut,ft,ht,ot[8],1770035416,7),ht=rt(ht,ct,ut,ft,ot[9],2336552879,12),ft=rt(ft,ht,ct,ut,ot[10],4294925233,17),ut=rt(ut,ft,ht,ct,ot[11],2304563134,22),ct=rt(ct,ut,ft,ht,ot[12],1804603682,7),ht=rt(ht,ct,ut,ft,ot[13],4254626195,12),ft=rt(ft,ht,ct,ut,ot[14],2792965006,17),ut=rt(ut,ft,ht,ct,ot[15],1236535329,22),ct=nt(ct,ut,ft,ht,ot[1],4129170786,5),ht=nt(ht,ct,ut,ft,ot[6],3225465664,9),ft=nt(ft,ht,ct,ut,ot[11],643717713,14),ut=nt(ut,ft,ht,ct,ot[0],3921069994,20),ct=nt(ct,ut,ft,ht,ot[5],3593408605,5),ht=nt(ht,ct,ut,ft,ot[10],38016083,9),ft=nt(ft,ht,ct,ut,ot[15],3634488961,14),ut=nt(ut,ft,ht,ct,ot[4],3889429448,20),ct=nt(ct,ut,ft,ht,ot[9],568446438,5),ht=nt(ht,ct,ut,ft,ot[14],3275163606,9),ft=nt(ft,ht,ct,ut,ot[3],4107603335,14),ut=nt(ut,ft,ht,ct,ot[8],1163531501,20),ct=nt(ct,ut,ft,ht,ot[13],2850285829,5),ht=nt(ht,ct,ut,ft,ot[2],4243563512,9),ft=nt(ft,ht,ct,ut,ot[7],1735328473,14),ut=nt(ut,ft,ht,ct,ot[12],2368359562,20),ct=it(ct,ut,ft,ht,ot[5],4294588738,4),ht=it(ht,ct,ut,ft,ot[8],2272392833,11),ft=it(ft,ht,ct,ut,ot[11],1839030562,16),ut=it(ut,ft,ht,ct,ot[14],4259657740,23),ct=it(ct,ut,ft,ht,ot[1],2763975236,4),ht=it(ht,ct,ut,ft,ot[4],1272893353,11),ft=it(ft,ht,ct,ut,ot[7],4139469664,16),ut=it(ut,ft,ht,ct,ot[10],3200236656,23),ct=it(ct,ut,ft,ht,ot[13],681279174,4),ht=it(ht,ct,ut,ft,ot[0],3936430074,11),ft=it(ft,ht,ct,ut,ot[3],3572445317,16),ut=it(ut,ft,ht,ct,ot[6],76029189,23),ct=it(ct,ut,ft,ht,ot[9],3654602809,4),ht=it(ht,ct,ut,ft,ot[12],3873151461,11),ft=it(ft,ht,ct,ut,ot[15],530742520,16),ut=it(ut,ft,ht,ct,ot[2],3299628645,23),ct=st(ct,ut,ft,ht,ot[0],4096336452,6),ht=st(ht,ct,ut,ft,ot[7],1126891415,10),ft=st(ft,ht,ct,ut,ot[14],2878612391,15),ut=st(ut,ft,ht,ct,ot[5],4237533241,21),ct=st(ct,ut,ft,ht,ot[12],1700485571,6),ht=st(ht,ct,ut,ft,ot[3],2399980690,10),ft=st(ft,ht,ct,ut,ot[10],4293915773,15),ut=st(ut,ft,ht,ct,ot[1],2240044497,21),ct=st(ct,ut,ft,ht,ot[8],1873313359,6),ht=st(ht,ct,ut,ft,ot[15],4264355552,10),ft=st(ft,ht,ct,ut,ot[6],2734768916,15),ut=st(ut,ft,ht,ct,ot[13],1309151649,21),ct=st(ct,ut,ft,ht,ot[4],4149444226,6),ht=st(ht,ct,ut,ft,ot[11],3174756917,10),ft=st(ft,ht,ct,ut,ot[2],718787259,15),ut=st(ut,ft,ht,ct,ot[9],3951481745,21),this._a=this._a+ct|0,this._b=this._b+ut|0,this._c=this._c+ft|0,this._d=this._d+ht|0},et.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var ot=$.allocUnsafe(16);return ot.writeInt32LE(this._a,0),ot.writeInt32LE(this._b,4),ot.writeInt32LE(this._c,8),ot.writeInt32LE(this._d,12),ot};function tt(ot,at){return ot<<at|ot>>>32-at}function rt(ot,at,ct,ut,ft,ht,mt){return tt(ot+(at&ct|~at&ut)+ft+ht|0,mt)+at|0}function nt(ot,at,ct,ut,ft,ht,mt){return tt(ot+(at&ut|ct&~ut)+ft+ht|0,mt)+at|0}function it(ot,at,ct,ut,ft,ht,mt){return tt(ot+(at^ct^ut)+ft+ht|0,mt)+at|0}function st(ot,at,ct,ut,ft,ht,mt){return tt(ot+(ct^(at|~ut))+ft+ht|0,mt)+at|0}return md5_js=et,md5_js}var ripemd160$2,hasRequiredRipemd160;function requireRipemd160(){if(hasRequiredRipemd160)return ripemd160$2;hasRequiredRipemd160=1;var _=buffer$2.Buffer,o=inherits_browserExports,$=requireHashBase(),j=new Array(16),et=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],tt=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],rt=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],nt=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],it=[0,1518500249,1859775393,2400959708,2840853838],st=[1352829926,1548603684,1836072691,2053994217,0];function ot(){$.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}o(ot,$),ot.prototype._update=function(){for(var gt=j,Et=0;Et<16;++Et)gt[Et]=this._block.readInt32LE(Et*4);for(var St=this._a|0,At=this._b|0,kt=this._c|0,Rt=this._d|0,Tt=this._e|0,Dt=this._a|0,Ot=this._b|0,jt=this._c|0,Nt=this._d|0,It=this._e|0,yt=0;yt<80;yt+=1){var lt,pt;yt<16?(lt=ct(St,At,kt,Rt,Tt,gt[et[yt]],it[0],rt[yt]),pt=mt(Dt,Ot,jt,Nt,It,gt[tt[yt]],st[0],nt[yt])):yt<32?(lt=ut(St,At,kt,Rt,Tt,gt[et[yt]],it[1],rt[yt]),pt=ht(Dt,Ot,jt,Nt,It,gt[tt[yt]],st[1],nt[yt])):yt<48?(lt=ft(St,At,kt,Rt,Tt,gt[et[yt]],it[2],rt[yt]),pt=ft(Dt,Ot,jt,Nt,It,gt[tt[yt]],st[2],nt[yt])):yt<64?(lt=ht(St,At,kt,Rt,Tt,gt[et[yt]],it[3],rt[yt]),pt=ut(Dt,Ot,jt,Nt,It,gt[tt[yt]],st[3],nt[yt])):(lt=mt(St,At,kt,Rt,Tt,gt[et[yt]],it[4],rt[yt]),pt=ct(Dt,Ot,jt,Nt,It,gt[tt[yt]],st[4],nt[yt])),St=Tt,Tt=Rt,Rt=at(kt,10),kt=At,At=lt,Dt=It,It=Nt,Nt=at(jt,10),jt=Ot,Ot=pt}var bt=this._b+kt+Nt|0;this._b=this._c+Rt+It|0,this._c=this._d+Tt+Dt|0,this._d=this._e+St+Ot|0,this._e=this._a+At+jt|0,this._a=bt},ot.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var gt=_.alloc?_.alloc(20):new _(20);return gt.writeInt32LE(this._a,0),gt.writeInt32LE(this._b,4),gt.writeInt32LE(this._c,8),gt.writeInt32LE(this._d,12),gt.writeInt32LE(this._e,16),gt};function at(gt,Et){return gt<<Et|gt>>>32-Et}function ct(gt,Et,St,At,kt,Rt,Tt,Dt){return at(gt+(Et^St^At)+Rt+Tt|0,Dt)+kt|0}function ut(gt,Et,St,At,kt,Rt,Tt,Dt){return at(gt+(Et&St|~Et&At)+Rt+Tt|0,Dt)+kt|0}function ft(gt,Et,St,At,kt,Rt,Tt,Dt){return at(gt+((Et|~St)^At)+Rt+Tt|0,Dt)+kt|0}function ht(gt,Et,St,At,kt,Rt,Tt,Dt){return at(gt+(Et&At|St&~At)+Rt+Tt|0,Dt)+kt|0}function mt(gt,Et,St,At,kt,Rt,Tt,Dt){return at(gt+(Et^(St|~At))+Rt+Tt|0,Dt)+kt|0}return ripemd160$2=ot,ripemd160$2}var sha_jsExports={},sha_js={get exports(){return sha_jsExports},set exports(_){sha_jsExports=_}},hash$6,hasRequiredHash;function requireHash(){if(hasRequiredHash)return hash$6;hasRequiredHash=1;var _=safeBufferExports.Buffer;function o($,j){this._block=_.alloc($),this._finalSize=j,this._blockSize=$,this._len=0}return o.prototype.update=function($,j){typeof $=="string"&&(j=j||"utf8",$=_.from($,j));for(var et=this._block,tt=this._blockSize,rt=$.length,nt=this._len,it=0;it<rt;){for(var st=nt%tt,ot=Math.min(rt-it,tt-st),at=0;at<ot;at++)et[st+at]=$[it+at];nt+=ot,it+=ot,nt%tt===0&&this._update(et)}return this._len+=rt,this},o.prototype.digest=function($){var j=this._len%this._blockSize;this._block[j]=128,this._block.fill(0,j+1),j>=this._finalSize&&(this._update(this._block),this._block.fill(0));var et=this._len*8;if(et<=4294967295)this._block.writeUInt32BE(et,this._blockSize-4);else{var tt=(et&4294967295)>>>0,rt=(et-tt)/4294967296;this._block.writeUInt32BE(rt,this._blockSize-8),this._block.writeUInt32BE(tt,this._blockSize-4)}this._update(this._block);var nt=this._hash();return $?nt.toString($):nt},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},hash$6=o,hash$6}var sha$3,hasRequiredSha;function requireSha(){if(hasRequiredSha)return sha$3;hasRequiredSha=1;var _=inherits_browserExports,o=requireHash(),$=safeBufferExports.Buffer,j=[1518500249,1859775393,-1894007588,-899497514],et=new Array(80);function tt(){this.init(),this._w=et,o.call(this,64,56)}_(tt,o),tt.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function rt(st){return st<<5|st>>>27}function nt(st){return st<<30|st>>>2}function it(st,ot,at,ct){return st===0?ot&at|~ot&ct:st===2?ot&at|ot&ct|at&ct:ot^at^ct}return tt.prototype._update=function(st){for(var ot=this._w,at=this._a|0,ct=this._b|0,ut=this._c|0,ft=this._d|0,ht=this._e|0,mt=0;mt<16;++mt)ot[mt]=st.readInt32BE(mt*4);for(;mt<80;++mt)ot[mt]=ot[mt-3]^ot[mt-8]^ot[mt-14]^ot[mt-16];for(var gt=0;gt<80;++gt){var Et=~~(gt/20),St=rt(at)+it(Et,ct,ut,ft)+ht+ot[gt]+j[Et]|0;ht=ft,ft=ut,ut=nt(ct),ct=at,at=St}this._a=at+this._a|0,this._b=ct+this._b|0,this._c=ut+this._c|0,this._d=ft+this._d|0,this._e=ht+this._e|0},tt.prototype._hash=function(){var st=$.allocUnsafe(20);return st.writeInt32BE(this._a|0,0),st.writeInt32BE(this._b|0,4),st.writeInt32BE(this._c|0,8),st.writeInt32BE(this._d|0,12),st.writeInt32BE(this._e|0,16),st},sha$3=tt,sha$3}var sha1$1,hasRequiredSha1;function requireSha1(){if(hasRequiredSha1)return sha1$1;hasRequiredSha1=1;var _=inherits_browserExports,o=requireHash(),$=safeBufferExports.Buffer,j=[1518500249,1859775393,-1894007588,-899497514],et=new Array(80);function tt(){this.init(),this._w=et,o.call(this,64,56)}_(tt,o),tt.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function rt(ot){return ot<<1|ot>>>31}function nt(ot){return ot<<5|ot>>>27}function it(ot){return ot<<30|ot>>>2}function st(ot,at,ct,ut){return ot===0?at&ct|~at&ut:ot===2?at&ct|at&ut|ct&ut:at^ct^ut}return tt.prototype._update=function(ot){for(var at=this._w,ct=this._a|0,ut=this._b|0,ft=this._c|0,ht=this._d|0,mt=this._e|0,gt=0;gt<16;++gt)at[gt]=ot.readInt32BE(gt*4);for(;gt<80;++gt)at[gt]=rt(at[gt-3]^at[gt-8]^at[gt-14]^at[gt-16]);for(var Et=0;Et<80;++Et){var St=~~(Et/20),At=nt(ct)+st(St,ut,ft,ht)+mt+at[Et]+j[St]|0;mt=ht,ht=ft,ft=it(ut),ut=ct,ct=At}this._a=ct+this._a|0,this._b=ut+this._b|0,this._c=ft+this._c|0,this._d=ht+this._d|0,this._e=mt+this._e|0},tt.prototype._hash=function(){var ot=$.allocUnsafe(20);return ot.writeInt32BE(this._a|0,0),ot.writeInt32BE(this._b|0,4),ot.writeInt32BE(this._c|0,8),ot.writeInt32BE(this._d|0,12),ot.writeInt32BE(this._e|0,16),ot},sha1$1=tt,sha1$1}var sha256$7,hasRequiredSha256;function requireSha256(){if(hasRequiredSha256)return sha256$7;hasRequiredSha256=1;var _=inherits_browserExports,o=requireHash(),$=safeBufferExports.Buffer,j=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],et=new Array(64);function tt(){this.init(),this._w=et,o.call(this,64,56)}_(tt,o),tt.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function rt(ct,ut,ft){return ft^ct&(ut^ft)}function nt(ct,ut,ft){return ct&ut|ft&(ct|ut)}function it(ct){return(ct>>>2|ct<<30)^(ct>>>13|ct<<19)^(ct>>>22|ct<<10)}function st(ct){return(ct>>>6|ct<<26)^(ct>>>11|ct<<21)^(ct>>>25|ct<<7)}function ot(ct){return(ct>>>7|ct<<25)^(ct>>>18|ct<<14)^ct>>>3}function at(ct){return(ct>>>17|ct<<15)^(ct>>>19|ct<<13)^ct>>>10}return tt.prototype._update=function(ct){for(var ut=this._w,ft=this._a|0,ht=this._b|0,mt=this._c|0,gt=this._d|0,Et=this._e|0,St=this._f|0,At=this._g|0,kt=this._h|0,Rt=0;Rt<16;++Rt)ut[Rt]=ct.readInt32BE(Rt*4);for(;Rt<64;++Rt)ut[Rt]=at(ut[Rt-2])+ut[Rt-7]+ot(ut[Rt-15])+ut[Rt-16]|0;for(var Tt=0;Tt<64;++Tt){var Dt=kt+st(Et)+rt(Et,St,At)+j[Tt]+ut[Tt]|0,Ot=it(ft)+nt(ft,ht,mt)|0;kt=At,At=St,St=Et,Et=gt+Dt|0,gt=mt,mt=ht,ht=ft,ft=Dt+Ot|0}this._a=ft+this._a|0,this._b=ht+this._b|0,this._c=mt+this._c|0,this._d=gt+this._d|0,this._e=Et+this._e|0,this._f=St+this._f|0,this._g=At+this._g|0,this._h=kt+this._h|0},tt.prototype._hash=function(){var ct=$.allocUnsafe(32);return ct.writeInt32BE(this._a,0),ct.writeInt32BE(this._b,4),ct.writeInt32BE(this._c,8),ct.writeInt32BE(this._d,12),ct.writeInt32BE(this._e,16),ct.writeInt32BE(this._f,20),ct.writeInt32BE(this._g,24),ct.writeInt32BE(this._h,28),ct},sha256$7=tt,sha256$7}var sha224$1,hasRequiredSha224;function requireSha224(){if(hasRequiredSha224)return sha224$1;hasRequiredSha224=1;var _=inherits_browserExports,o=requireSha256(),$=requireHash(),j=safeBufferExports.Buffer,et=new Array(64);function tt(){this.init(),this._w=et,$.call(this,64,56)}return _(tt,o),tt.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},tt.prototype._hash=function(){var rt=j.allocUnsafe(28);return rt.writeInt32BE(this._a,0),rt.writeInt32BE(this._b,4),rt.writeInt32BE(this._c,8),rt.writeInt32BE(this._d,12),rt.writeInt32BE(this._e,16),rt.writeInt32BE(this._f,20),rt.writeInt32BE(this._g,24),rt},sha224$1=tt,sha224$1}var sha512$3,hasRequiredSha512;function requireSha512(){if(hasRequiredSha512)return sha512$3;hasRequiredSha512=1;var _=inherits_browserExports,o=requireHash(),$=safeBufferExports.Buffer,j=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],et=new Array(160);function tt(){this.init(),this._w=et,o.call(this,128,112)}_(tt,o),tt.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function rt(ht,mt,gt){return gt^ht&(mt^gt)}function nt(ht,mt,gt){return ht&mt|gt&(ht|mt)}function it(ht,mt){return(ht>>>28|mt<<4)^(mt>>>2|ht<<30)^(mt>>>7|ht<<25)}function st(ht,mt){return(ht>>>14|mt<<18)^(ht>>>18|mt<<14)^(mt>>>9|ht<<23)}function ot(ht,mt){return(ht>>>1|mt<<31)^(ht>>>8|mt<<24)^ht>>>7}function at(ht,mt){return(ht>>>1|mt<<31)^(ht>>>8|mt<<24)^(ht>>>7|mt<<25)}function ct(ht,mt){return(ht>>>19|mt<<13)^(mt>>>29|ht<<3)^ht>>>6}function ut(ht,mt){return(ht>>>19|mt<<13)^(mt>>>29|ht<<3)^(ht>>>6|mt<<26)}function ft(ht,mt){return ht>>>0<mt>>>0?1:0}return tt.prototype._update=function(ht){for(var mt=this._w,gt=this._ah|0,Et=this._bh|0,St=this._ch|0,At=this._dh|0,kt=this._eh|0,Rt=this._fh|0,Tt=this._gh|0,Dt=this._hh|0,Ot=this._al|0,jt=this._bl|0,Nt=this._cl|0,It=this._dl|0,yt=this._el|0,lt=this._fl|0,pt=this._gl|0,bt=this._hl|0,_t=0;_t<32;_t+=2)mt[_t]=ht.readInt32BE(_t*4),mt[_t+1]=ht.readInt32BE(_t*4+4);for(;_t<160;_t+=2){var $t=mt[_t-30],Ct=mt[_t-15*2+1],xt=ot($t,Ct),vt=at(Ct,$t);$t=mt[_t-2*2],Ct=mt[_t-2*2+1];var dt=ct($t,Ct),wt=ut(Ct,$t),qt=mt[_t-7*2],Pt=mt[_t-7*2+1],Gt=mt[_t-16*2],Wt=mt[_t-16*2+1],Vt=vt+Pt|0,Ut=xt+qt+ft(Vt,vt)|0;Vt=Vt+wt|0,Ut=Ut+dt+ft(Vt,wt)|0,Vt=Vt+Wt|0,Ut=Ut+Gt+ft(Vt,Wt)|0,mt[_t]=Ut,mt[_t+1]=Vt}for(var Mt=0;Mt<160;Mt+=2){Ut=mt[Mt],Vt=mt[Mt+1];var Lt=nt(gt,Et,St),Yt=nt(Ot,jt,Nt),lr=it(gt,Ot),cr=it(Ot,gt),ir=st(kt,yt),Zt=st(yt,kt),Bt=j[Mt],Ft=j[Mt+1],zt=rt(kt,Rt,Tt),Qt=rt(yt,lt,pt),nr=bt+Zt|0,gr=Dt+ir+ft(nr,bt)|0;nr=nr+Qt|0,gr=gr+zt+ft(nr,Qt)|0,nr=nr+Ft|0,gr=gr+Bt+ft(nr,Ft)|0,nr=nr+Vt|0,gr=gr+Ut+ft(nr,Vt)|0;var br=cr+Yt|0,vr=lr+Lt+ft(br,cr)|0;Dt=Tt,bt=pt,Tt=Rt,pt=lt,Rt=kt,lt=yt,yt=It+nr|0,kt=At+gr+ft(yt,It)|0,At=St,It=Nt,St=Et,Nt=jt,Et=gt,jt=Ot,Ot=nr+br|0,gt=gr+vr+ft(Ot,nr)|0}this._al=this._al+Ot|0,this._bl=this._bl+jt|0,this._cl=this._cl+Nt|0,this._dl=this._dl+It|0,this._el=this._el+yt|0,this._fl=this._fl+lt|0,this._gl=this._gl+pt|0,this._hl=this._hl+bt|0,this._ah=this._ah+gt+ft(this._al,Ot)|0,this._bh=this._bh+Et+ft(this._bl,jt)|0,this._ch=this._ch+St+ft(this._cl,Nt)|0,this._dh=this._dh+At+ft(this._dl,It)|0,this._eh=this._eh+kt+ft(this._el,yt)|0,this._fh=this._fh+Rt+ft(this._fl,lt)|0,this._gh=this._gh+Tt+ft(this._gl,pt)|0,this._hh=this._hh+Dt+ft(this._hl,bt)|0},tt.prototype._hash=function(){var ht=$.allocUnsafe(64);function mt(gt,Et,St){ht.writeInt32BE(gt,St),ht.writeInt32BE(Et,St+4)}return mt(this._ah,this._al,0),mt(this._bh,this._bl,8),mt(this._ch,this._cl,16),mt(this._dh,this._dl,24),mt(this._eh,this._el,32),mt(this._fh,this._fl,40),mt(this._gh,this._gl,48),mt(this._hh,this._hl,56),ht},sha512$3=tt,sha512$3}var sha384$2,hasRequiredSha384;function requireSha384(){if(hasRequiredSha384)return sha384$2;hasRequiredSha384=1;var _=inherits_browserExports,o=requireSha512(),$=requireHash(),j=safeBufferExports.Buffer,et=new Array(160);function tt(){this.init(),this._w=et,$.call(this,128,112)}return _(tt,o),tt.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},tt.prototype._hash=function(){var rt=j.allocUnsafe(48);function nt(it,st,ot){rt.writeInt32BE(it,ot),rt.writeInt32BE(st,ot+4)}return nt(this._ah,this._al,0),nt(this._bh,this._bl,8),nt(this._ch,this._cl,16),nt(this._dh,this._dl,24),nt(this._eh,this._el,32),nt(this._fh,this._fl,40),rt},sha384$2=tt,sha384$2}var hasRequiredSha_js;function requireSha_js(){if(hasRequiredSha_js)return sha_jsExports;hasRequiredSha_js=1;var _=sha_js.exports=function($){$=$.toLowerCase();var j=_[$];if(!j)throw new Error($+" is not supported (we accept pull requests)");return new j};return _.sha=requireSha(),_.sha1=requireSha1(),_.sha224=requireSha224(),_.sha256=requireSha256(),_.sha384=requireSha384(),_.sha512=requireSha512(),sha_jsExports}var streamBrowserify,hasRequiredStreamBrowserify;function requireStreamBrowserify(){if(hasRequiredStreamBrowserify)return streamBrowserify;hasRequiredStreamBrowserify=1,streamBrowserify=$;var _=eventsExports.EventEmitter,o=inherits_browserExports;o($,_),$.Readable=require_stream_readable(),$.Writable=require_stream_writable(),$.Duplex=require_stream_duplex(),$.Transform=require_stream_transform(),$.PassThrough=require_stream_passthrough(),$.finished=requireEndOfStream(),$.pipeline=requirePipeline(),$.Stream=$;function $(){_.call(this)}return $.prototype.pipe=function(j,et){var tt=this;function rt(ut){j.writable&&j.write(ut)===!1&&tt.pause&&tt.pause()}tt.on("data",rt);function nt(){tt.readable&&tt.resume&&tt.resume()}j.on("drain",nt),!j._isStdio&&(!et||et.end!==!1)&&(tt.on("end",st),tt.on("close",ot));var it=!1;function st(){it||(it=!0,j.end())}function ot(){it||(it=!0,typeof j.destroy=="function"&&j.destroy())}function at(ut){if(ct(),_.listenerCount(this,"error")===0)throw ut}tt.on("error",at),j.on("error",at);function ct(){tt.removeListener("data",rt),j.removeListener("drain",nt),tt.removeListener("end",st),tt.removeListener("close",ot),tt.removeListener("error",at),j.removeListener("error",at),tt.removeListener("end",ct),tt.removeListener("close",ct),j.removeListener("close",ct)}return tt.on("end",ct),tt.on("close",ct),j.on("close",ct),j.emit("pipe",tt),j},streamBrowserify}var cipherBase,hasRequiredCipherBase;function requireCipherBase(){if(hasRequiredCipherBase)return cipherBase;hasRequiredCipherBase=1;var _=safeBufferExports.Buffer,o=requireStreamBrowserify().Transform,$=requireString_decoder().StringDecoder,j=inherits_browserExports;function et(tt){o.call(this),this.hashMode=typeof tt=="string",this.hashMode?this[tt]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}return j(et,o),et.prototype.update=function(tt,rt,nt){typeof tt=="string"&&(tt=_.from(tt,rt));var it=this._update(tt);return this.hashMode?this:(nt&&(it=this._toString(it,nt)),it)},et.prototype.setAutoPadding=function(){},et.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},et.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},et.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},et.prototype._transform=function(tt,rt,nt){var it;try{this.hashMode?this._update(tt):this.push(this._update(tt))}catch(st){it=st}finally{nt(it)}},et.prototype._flush=function(tt){var rt;try{this.push(this.__final())}catch(nt){rt=nt}tt(rt)},et.prototype._finalOrDigest=function(tt){var rt=this.__final()||_.alloc(0);return tt&&(rt=this._toString(rt,tt,!0)),rt},et.prototype._toString=function(tt,rt,nt){if(this._decoder||(this._decoder=new $(rt),this._encoding=rt),this._encoding!==rt)throw new Error("can't switch encodings");var it=this._decoder.write(tt);return nt&&(it+=this._decoder.end()),it},cipherBase=et,cipherBase}var browser$e,hasRequiredBrowser$a;function requireBrowser$a(){if(hasRequiredBrowser$a)return browser$e;hasRequiredBrowser$a=1;var _=inherits_browserExports,o=requireMd5_js(),$=requireRipemd160(),j=requireSha_js(),et=requireCipherBase();function tt(rt){et.call(this,"digest"),this._hash=rt}return _(tt,et),tt.prototype._update=function(rt){this._hash.update(rt)},tt.prototype._final=function(){return this._hash.digest()},browser$e=function(nt){return nt=nt.toLowerCase(),nt==="md5"?new o:nt==="rmd160"||nt==="ripemd160"?new $:new tt(j(nt))},browser$e}var legacy,hasRequiredLegacy;function requireLegacy(){if(hasRequiredLegacy)return legacy;hasRequiredLegacy=1;var _=inherits_browserExports,o=safeBufferExports.Buffer,$=requireCipherBase(),j=o.alloc(128),et=64;function tt(rt,nt){$.call(this,"digest"),typeof nt=="string"&&(nt=o.from(nt)),this._alg=rt,this._key=nt,nt.length>et?nt=rt(nt):nt.length<et&&(nt=o.concat([nt,j],et));for(var it=this._ipad=o.allocUnsafe(et),st=this._opad=o.allocUnsafe(et),ot=0;ot<et;ot++)it[ot]=nt[ot]^54,st[ot]=nt[ot]^92;this._hash=[it]}return _(tt,$),tt.prototype._update=function(rt){this._hash.push(rt)},tt.prototype._final=function(){var rt=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,rt]))},legacy=tt,legacy}var md5,hasRequiredMd5;function requireMd5(){if(hasRequiredMd5)return md5;hasRequiredMd5=1;var _=requireMd5_js();return md5=function(o){return new _().update(o).digest()},md5}var browser$d,hasRequiredBrowser$9;function requireBrowser$9(){if(hasRequiredBrowser$9)return browser$d;hasRequiredBrowser$9=1;var _=inherits_browserExports,o=requireLegacy(),$=requireCipherBase(),j=safeBufferExports.Buffer,et=requireMd5(),tt=requireRipemd160(),rt=requireSha_js(),nt=j.alloc(128);function it(st,ot){$.call(this,"digest"),typeof ot=="string"&&(ot=j.from(ot));var at=st==="sha512"||st==="sha384"?128:64;if(this._alg=st,this._key=ot,ot.length>at){var ct=st==="rmd160"?new tt:rt(st);ot=ct.update(ot).digest()}else ot.length<at&&(ot=j.concat([ot,nt],at));for(var ut=this._ipad=j.allocUnsafe(at),ft=this._opad=j.allocUnsafe(at),ht=0;ht<at;ht++)ut[ht]=ot[ht]^54,ft[ht]=ot[ht]^92;this._hash=st==="rmd160"?new tt:rt(st),this._hash.update(ut)}return _(it,$),it.prototype._update=function(st){this._hash.update(st)},it.prototype._final=function(){var st=this._hash.digest(),ot=this._alg==="rmd160"?new tt:rt(this._alg);return ot.update(this._opad).update(st).digest()},browser$d=function(ot,at){return ot=ot.toLowerCase(),ot==="rmd160"||ot==="ripemd160"?new it("rmd160",at):ot==="md5"?new o(et,at):new it(ot,at)},browser$d}var algosExports={},algos={get exports(){return algosExports},set exports(_){algosExports=_}};const sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},sha256$6={sign:"ecdsa",hash:"sha256",id:""},sha224={sign:"ecdsa",hash:"sha224",id:""},sha384$1={sign:"ecdsa",hash:"sha384",id:""},sha512$2={sign:"ecdsa",hash:"sha512",id:""},DSA={sign:"dsa",hash:"sha1",id:""},ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},require$$6={sha224WithRSAEncryption,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:sha256$6,sha224,sha384:sha384$1,sha512:sha512$2,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var hasRequiredAlgos;function requireAlgos(){return hasRequiredAlgos||(hasRequiredAlgos=1,function(_){_.exports=require$$6}(algos)),algosExports}var browser$c={},precondition,hasRequiredPrecondition;function requirePrecondition(){if(hasRequiredPrecondition)return precondition;hasRequiredPrecondition=1;var _=Math.pow(2,30)-1;return precondition=function(o,$){if(typeof o!="number")throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if(typeof $!="number")throw new TypeError("Key length not a number");if($<0||$>_||$!==$)throw new TypeError("Bad key length")},precondition}var defaultEncoding_1,hasRequiredDefaultEncoding;function requireDefaultEncoding(){if(hasRequiredDefaultEncoding)return defaultEncoding_1;hasRequiredDefaultEncoding=1;var _;if(commonjsGlobal.process&&commonjsGlobal.process.browser)_="utf-8";else if(commonjsGlobal.process&&commonjsGlobal.process.version){var o=parseInt(browserExports$3.version.split(".")[0].slice(1),10);_=o>=6?"utf-8":"binary"}else _="utf-8";return defaultEncoding_1=_,defaultEncoding_1}var toBuffer$1,hasRequiredToBuffer;function requireToBuffer(){if(hasRequiredToBuffer)return toBuffer$1;hasRequiredToBuffer=1;var _=safeBufferExports.Buffer;return toBuffer$1=function(o,$,j){if(_.isBuffer(o))return o;if(typeof o=="string")return _.from(o,$);if(ArrayBuffer.isView(o))return _.from(o.buffer);throw new TypeError(j+" must be a string, a Buffer, a typed array or a DataView")},toBuffer$1}var syncBrowser,hasRequiredSyncBrowser;function requireSyncBrowser(){if(hasRequiredSyncBrowser)return syncBrowser;hasRequiredSyncBrowser=1;var _=requireMd5(),o=requireRipemd160(),$=requireSha_js(),j=safeBufferExports.Buffer,et=requirePrecondition(),tt=requireDefaultEncoding(),rt=requireToBuffer(),nt=j.alloc(128),it={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function st(ct,ut,ft){var ht=ot(ct),mt=ct==="sha512"||ct==="sha384"?128:64;ut.length>mt?ut=ht(ut):ut.length<mt&&(ut=j.concat([ut,nt],mt));for(var gt=j.allocUnsafe(mt+it[ct]),Et=j.allocUnsafe(mt+it[ct]),St=0;St<mt;St++)gt[St]=ut[St]^54,Et[St]=ut[St]^92;var At=j.allocUnsafe(mt+ft+4);gt.copy(At,0,0,mt),this.ipad1=At,this.ipad2=gt,this.opad=Et,this.alg=ct,this.blocksize=mt,this.hash=ht,this.size=it[ct]}st.prototype.run=function(ct,ut){ct.copy(ut,this.blocksize);var ft=this.hash(ut);return ft.copy(this.opad,this.blocksize),this.hash(this.opad)};function ot(ct){function ut(ht){return $(ct).update(ht).digest()}function ft(ht){return new o().update(ht).digest()}return ct==="rmd160"||ct==="ripemd160"?ft:ct==="md5"?_:ut}function at(ct,ut,ft,ht,mt){et(ft,ht),ct=rt(ct,tt,"Password"),ut=rt(ut,tt,"Salt"),mt=mt||"sha1";var gt=new st(mt,ct,ut.length),Et=j.allocUnsafe(ht),St=j.allocUnsafe(ut.length+4);ut.copy(St,0,0,ut.length);for(var At=0,kt=it[mt],Rt=Math.ceil(ht/kt),Tt=1;Tt<=Rt;Tt++){St.writeUInt32BE(Tt,ut.length);for(var Dt=gt.run(St,gt.ipad1),Ot=Dt,jt=1;jt<ft;jt++){Ot=gt.run(Ot,gt.ipad2);for(var Nt=0;Nt<kt;Nt++)Dt[Nt]^=Ot[Nt]}Dt.copy(Et,At),At+=kt}return Et}return syncBrowser=at,syncBrowser}var async,hasRequiredAsync;function requireAsync(){if(hasRequiredAsync)return async;hasRequiredAsync=1;var _=safeBufferExports.Buffer,o=requirePrecondition(),$=requireDefaultEncoding(),j=requireSyncBrowser(),et=requireToBuffer(),tt,rt=commonjsGlobal.crypto&&commonjsGlobal.crypto.subtle,nt={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},it=[];function st(ft){if(commonjsGlobal.process&&!commonjsGlobal.process.browser||!rt||!rt.importKey||!rt.deriveBits)return Promise.resolve(!1);if(it[ft]!==void 0)return it[ft];tt=tt||_.alloc(8);var ht=ct(tt,tt,10,128,ft).then(function(){return!0}).catch(function(){return!1});return it[ft]=ht,ht}var ot;function at(){return ot||(commonjsGlobal.process&&commonjsGlobal.process.nextTick?ot=commonjsGlobal.process.nextTick:commonjsGlobal.queueMicrotask?ot=commonjsGlobal.queueMicrotask:commonjsGlobal.setImmediate?ot=commonjsGlobal.setImmediate:ot=commonjsGlobal.setTimeout,ot)}function ct(ft,ht,mt,gt,Et){return rt.importKey("raw",ft,{name:"PBKDF2"},!1,["deriveBits"]).then(function(St){return rt.deriveBits({name:"PBKDF2",salt:ht,iterations:mt,hash:{name:Et}},St,gt<<3)}).then(function(St){return _.from(St)})}function ut(ft,ht){ft.then(function(mt){at()(function(){ht(null,mt)})},function(mt){at()(function(){ht(mt)})})}return async=function(ft,ht,mt,gt,Et,St){typeof Et=="function"&&(St=Et,Et=void 0),Et=Et||"sha1";var At=nt[Et.toLowerCase()];if(!At||typeof commonjsGlobal.Promise!="function"){at()(function(){var kt;try{kt=j(ft,ht,mt,gt,Et)}catch(Rt){return St(Rt)}St(null,kt)});return}if(o(mt,gt),ft=et(ft,$,"Password"),ht=et(ht,$,"Salt"),typeof St!="function")throw new Error("No callback provided to pbkdf2");ut(st(At).then(function(kt){return kt?ct(ft,ht,mt,gt,At):j(ft,ht,mt,gt,Et)}),St)},async}var hasRequiredBrowser$8;function requireBrowser$8(){return hasRequiredBrowser$8||(hasRequiredBrowser$8=1,browser$c.pbkdf2=requireAsync(),browser$c.pbkdf2Sync=requireSyncBrowser()),browser$c}var browser$b={},des$1={},utils$o={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils$o;hasRequiredUtils=1,utils$o.readUInt32BE=function(et,tt){var rt=et[0+tt]<<24|et[1+tt]<<16|et[2+tt]<<8|et[3+tt];return rt>>>0},utils$o.writeUInt32BE=function(et,tt,rt){et[0+rt]=tt>>>24,et[1+rt]=tt>>>16&255,et[2+rt]=tt>>>8&255,et[3+rt]=tt&255},utils$o.ip=function(et,tt,rt,nt){for(var it=0,st=0,ot=6;ot>=0;ot-=2){for(var at=0;at<=24;at+=8)it<<=1,it|=tt>>>at+ot&1;for(var at=0;at<=24;at+=8)it<<=1,it|=et>>>at+ot&1}for(var ot=6;ot>=0;ot-=2){for(var at=1;at<=25;at+=8)st<<=1,st|=tt>>>at+ot&1;for(var at=1;at<=25;at+=8)st<<=1,st|=et>>>at+ot&1}rt[nt+0]=it>>>0,rt[nt+1]=st>>>0},utils$o.rip=function(et,tt,rt,nt){for(var it=0,st=0,ot=0;ot<4;ot++)for(var at=24;at>=0;at-=8)it<<=1,it|=tt>>>at+ot&1,it<<=1,it|=et>>>at+ot&1;for(var ot=4;ot<8;ot++)for(var at=24;at>=0;at-=8)st<<=1,st|=tt>>>at+ot&1,st<<=1,st|=et>>>at+ot&1;rt[nt+0]=it>>>0,rt[nt+1]=st>>>0},utils$o.pc1=function(et,tt,rt,nt){for(var it=0,st=0,ot=7;ot>=5;ot--){for(var at=0;at<=24;at+=8)it<<=1,it|=tt>>at+ot&1;for(var at=0;at<=24;at+=8)it<<=1,it|=et>>at+ot&1}for(var at=0;at<=24;at+=8)it<<=1,it|=tt>>at+ot&1;for(var ot=1;ot<=3;ot++){for(var at=0;at<=24;at+=8)st<<=1,st|=tt>>at+ot&1;for(var at=0;at<=24;at+=8)st<<=1,st|=et>>at+ot&1}for(var at=0;at<=24;at+=8)st<<=1,st|=et>>at+ot&1;rt[nt+0]=it>>>0,rt[nt+1]=st>>>0},utils$o.r28shl=function(et,tt){return et<<tt&268435455|et>>>28-tt};var _=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];utils$o.pc2=function(et,tt,rt,nt){for(var it=0,st=0,ot=_.length>>>1,at=0;at<ot;at++)it<<=1,it|=et>>>_[at]&1;for(var at=ot;at<_.length;at++)st<<=1,st|=tt>>>_[at]&1;rt[nt+0]=it>>>0,rt[nt+1]=st>>>0},utils$o.expand=function(et,tt,rt){var nt=0,it=0;nt=(et&1)<<5|et>>>27;for(var st=23;st>=15;st-=4)nt<<=6,nt|=et>>>st&63;for(var st=11;st>=3;st-=4)it|=et>>>st&63,it<<=6;it|=(et&31)<<1|et>>>31,tt[rt+0]=nt>>>0,tt[rt+1]=it>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];utils$o.substitute=function(et,tt){for(var rt=0,nt=0;nt<4;nt++){var it=et>>>18-nt*6&63,st=o[nt*64+it];rt<<=4,rt|=st}for(var nt=0;nt<4;nt++){var it=tt>>>18-nt*6&63,st=o[4*64+nt*64+it];rt<<=4,rt|=st}return rt>>>0};var $=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];return utils$o.permute=function(et){for(var tt=0,rt=0;rt<$.length;rt++)tt<<=1,tt|=et>>>$[rt]&1;return tt>>>0},utils$o.padSplit=function(et,tt,rt){for(var nt=et.toString(2);nt.length<tt;)nt="0"+nt;for(var it=[],st=0;st<tt;st+=rt)it.push(nt.slice(st,st+rt));return it.join(" ")},utils$o}var minimalisticAssert$1=assert$l;function assert$l(_,o){if(!_)throw new Error(o||"Assertion failed")}assert$l.equal=function _(o,$,j){if(o!=$)throw new Error(j||"Assertion failed: "+o+" != "+$)};var cipher,hasRequiredCipher;function requireCipher(){if(hasRequiredCipher)return cipher;hasRequiredCipher=1;var _=minimalisticAssert$1;function o($){this.options=$,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}return cipher=o,o.prototype._init=function(){},o.prototype.update=function(j){return j.length===0?[]:this.type==="decrypt"?this._updateDecrypt(j):this._updateEncrypt(j)},o.prototype._buffer=function(j,et){for(var tt=Math.min(this.buffer.length-this.bufferOff,j.length-et),rt=0;rt<tt;rt++)this.buffer[this.bufferOff+rt]=j[et+rt];return this.bufferOff+=tt,tt},o.prototype._flushBuffer=function(j,et){return this._update(this.buffer,0,j,et),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(j){var et=0,tt=0,rt=(this.bufferOff+j.length)/this.blockSize|0,nt=new Array(rt*this.blockSize);this.bufferOff!==0&&(et+=this._buffer(j,et),this.bufferOff===this.buffer.length&&(tt+=this._flushBuffer(nt,tt)));for(var it=j.length-(j.length-et)%this.blockSize;et<it;et+=this.blockSize)this._update(j,et,nt,tt),tt+=this.blockSize;for(;et<j.length;et++,this.bufferOff++)this.buffer[this.bufferOff]=j[et];return nt},o.prototype._updateDecrypt=function(j){for(var et=0,tt=0,rt=Math.ceil((this.bufferOff+j.length)/this.blockSize)-1,nt=new Array(rt*this.blockSize);rt>0;rt--)et+=this._buffer(j,et),tt+=this._flushBuffer(nt,tt);return et+=this._buffer(j,et),nt},o.prototype.final=function(j){var et;j&&(et=this.update(j));var tt;return this.type==="encrypt"?tt=this._finalEncrypt():tt=this._finalDecrypt(),et?et.concat(tt):tt},o.prototype._pad=function(j,et){if(et===0)return!1;for(;et<j.length;)j[et++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var j=new Array(this.blockSize);return this._update(this.buffer,0,j,0),j},o.prototype._unpad=function(j){return j},o.prototype._finalDecrypt=function(){_.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var j=new Array(this.blockSize);return this._flushBuffer(j,0),this._unpad(j)},cipher}var des,hasRequiredDes$1;function requireDes$1(){if(hasRequiredDes$1)return des;hasRequiredDes$1=1;var _=minimalisticAssert$1,o=inherits_browserExports,$=requireUtils(),j=requireCipher();function et(){this.tmp=new Array(2),this.keys=null}function tt(nt){j.call(this,nt);var it=new et;this._desState=it,this.deriveKeys(it,nt.key)}o(tt,j),des=tt,tt.create=function(it){return new tt(it)};var rt=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];return tt.prototype.deriveKeys=function(it,st){it.keys=new Array(16*2),_.equal(st.length,this.blockSize,"Invalid key length");var ot=$.readUInt32BE(st,0),at=$.readUInt32BE(st,4);$.pc1(ot,at,it.tmp,0),ot=it.tmp[0],at=it.tmp[1];for(var ct=0;ct<it.keys.length;ct+=2){var ut=rt[ct>>>1];ot=$.r28shl(ot,ut),at=$.r28shl(at,ut),$.pc2(ot,at,it.keys,ct)}},tt.prototype._update=function(it,st,ot,at){var ct=this._desState,ut=$.readUInt32BE(it,st),ft=$.readUInt32BE(it,st+4);$.ip(ut,ft,ct.tmp,0),ut=ct.tmp[0],ft=ct.tmp[1],this.type==="encrypt"?this._encrypt(ct,ut,ft,ct.tmp,0):this._decrypt(ct,ut,ft,ct.tmp,0),ut=ct.tmp[0],ft=ct.tmp[1],$.writeUInt32BE(ot,ut,at),$.writeUInt32BE(ot,ft,at+4)},tt.prototype._pad=function(it,st){for(var ot=it.length-st,at=st;at<it.length;at++)it[at]=ot;return!0},tt.prototype._unpad=function(it){for(var st=it[it.length-1],ot=it.length-st;ot<it.length;ot++)_.equal(it[ot],st);return it.slice(0,it.length-st)},tt.prototype._encrypt=function(it,st,ot,at,ct){for(var ut=st,ft=ot,ht=0;ht<it.keys.length;ht+=2){var mt=it.keys[ht],gt=it.keys[ht+1];$.expand(ft,it.tmp,0),mt^=it.tmp[0],gt^=it.tmp[1];var Et=$.substitute(mt,gt),St=$.permute(Et),At=ft;ft=(ut^St)>>>0,ut=At}$.rip(ft,ut,at,ct)},tt.prototype._decrypt=function(it,st,ot,at,ct){for(var ut=ot,ft=st,ht=it.keys.length-2;ht>=0;ht-=2){var mt=it.keys[ht],gt=it.keys[ht+1];$.expand(ut,it.tmp,0),mt^=it.tmp[0],gt^=it.tmp[1];var Et=$.substitute(mt,gt),St=$.permute(Et),At=ut;ut=(ft^St)>>>0,ft=At}$.rip(ut,ft,at,ct)},des}var cbc$1={},hasRequiredCbc$1;function requireCbc$1(){if(hasRequiredCbc$1)return cbc$1;hasRequiredCbc$1=1;var _=minimalisticAssert$1,o=inherits_browserExports,$={};function j(tt){_.equal(tt.length,8,"Invalid IV length"),this.iv=new Array(8);for(var rt=0;rt<this.iv.length;rt++)this.iv[rt]=tt[rt]}function et(tt){function rt(ot){tt.call(this,ot),this._cbcInit()}o(rt,tt);for(var nt=Object.keys($),it=0;it<nt.length;it++){var st=nt[it];rt.prototype[st]=$[st]}return rt.create=function(at){return new rt(at)},rt}return cbc$1.instantiate=et,$._cbcInit=function(){var rt=new j(this.options.iv);this._cbcState=rt},$._update=function(rt,nt,it,st){var ot=this._cbcState,at=this.constructor.super_.prototype,ct=ot.iv;if(this.type==="encrypt"){for(var ut=0;ut<this.blockSize;ut++)ct[ut]^=rt[nt+ut];at._update.call(this,ct,0,it,st);for(var ut=0;ut<this.blockSize;ut++)ct[ut]=it[st+ut]}else{at._update.call(this,rt,nt,it,st);for(var ut=0;ut<this.blockSize;ut++)it[st+ut]^=ct[ut];for(var ut=0;ut<this.blockSize;ut++)ct[ut]=rt[nt+ut]}},cbc$1}var ede,hasRequiredEde;function requireEde(){if(hasRequiredEde)return ede;hasRequiredEde=1;var _=minimalisticAssert$1,o=inherits_browserExports,$=requireCipher(),j=requireDes$1();function et(rt,nt){_.equal(nt.length,24,"Invalid key length");var it=nt.slice(0,8),st=nt.slice(8,16),ot=nt.slice(16,24);rt==="encrypt"?this.ciphers=[j.create({type:"encrypt",key:it}),j.create({type:"decrypt",key:st}),j.create({type:"encrypt",key:ot})]:this.ciphers=[j.create({type:"decrypt",key:ot}),j.create({type:"encrypt",key:st}),j.create({type:"decrypt",key:it})]}function tt(rt){$.call(this,rt);var nt=new et(this.type,this.options.key);this._edeState=nt}return o(tt,$),ede=tt,tt.create=function(nt){return new tt(nt)},tt.prototype._update=function(nt,it,st,ot){var at=this._edeState;at.ciphers[0]._update(nt,it,st,ot),at.ciphers[1]._update(st,ot,st,ot),at.ciphers[2]._update(st,ot,st,ot)},tt.prototype._pad=j.prototype._pad,tt.prototype._unpad=j.prototype._unpad,ede}var hasRequiredDes;function requireDes(){return hasRequiredDes||(hasRequiredDes=1,des$1.utils=requireUtils(),des$1.Cipher=requireCipher(),des$1.DES=requireDes$1(),des$1.CBC=requireCbc$1(),des$1.EDE=requireEde()),des$1}var browserifyDes,hasRequiredBrowserifyDes;function requireBrowserifyDes(){if(hasRequiredBrowserifyDes)return browserifyDes;hasRequiredBrowserifyDes=1;var _=requireCipherBase(),o=requireDes(),$=inherits_browserExports,j=safeBufferExports.Buffer,et={"des-ede3-cbc":o.CBC.instantiate(o.EDE),"des-ede3":o.EDE,"des-ede-cbc":o.CBC.instantiate(o.EDE),"des-ede":o.EDE,"des-cbc":o.CBC.instantiate(o.DES),"des-ecb":o.DES};et.des=et["des-cbc"],et.des3=et["des-ede3-cbc"],browserifyDes=tt,$(tt,_);function tt(rt){_.call(this);var nt=rt.mode.toLowerCase(),it=et[nt],st;rt.decrypt?st="decrypt":st="encrypt";var ot=rt.key;j.isBuffer(ot)||(ot=j.from(ot)),(nt==="des-ede"||nt==="des-ede-cbc")&&(ot=j.concat([ot,ot.slice(0,8)]));var at=rt.iv;j.isBuffer(at)||(at=j.from(at)),this._des=it.create({key:ot,iv:at,type:st})}return tt.prototype._update=function(rt){return j.from(this._des.update(rt))},tt.prototype._final=function(){return j.from(this._des.final())},browserifyDes}var browser$a={},encrypter={},ecb={},hasRequiredEcb;function requireEcb(){return hasRequiredEcb||(hasRequiredEcb=1,ecb.encrypt=function(_,o){return _._cipher.encryptBlock(o)},ecb.decrypt=function(_,o){return _._cipher.decryptBlock(o)}),ecb}var cbc={},bufferXor,hasRequiredBufferXor;function requireBufferXor(){return hasRequiredBufferXor||(hasRequiredBufferXor=1,bufferXor=function(o,$){for(var j=Math.min(o.length,$.length),et=new buffer$2.Buffer(j),tt=0;tt<j;++tt)et[tt]=o[tt]^$[tt];return et}),bufferXor}var hasRequiredCbc;function requireCbc(){if(hasRequiredCbc)return cbc;hasRequiredCbc=1;var _=requireBufferXor();return cbc.encrypt=function(o,$){var j=_($,o._prev);return o._prev=o._cipher.encryptBlock(j),o._prev},cbc.decrypt=function(o,$){var j=o._prev;o._prev=$;var et=o._cipher.decryptBlock($);return _(et,j)},cbc}var cfb={},hasRequiredCfb;function requireCfb(){if(hasRequiredCfb)return cfb;hasRequiredCfb=1;var _=safeBufferExports.Buffer,o=requireBufferXor();function $(j,et,tt){var rt=et.length,nt=o(et,j._cache);return j._cache=j._cache.slice(rt),j._prev=_.concat([j._prev,tt?et:nt]),nt}return cfb.encrypt=function(j,et,tt){for(var rt=_.allocUnsafe(0),nt;et.length;)if(j._cache.length===0&&(j._cache=j._cipher.encryptBlock(j._prev),j._prev=_.allocUnsafe(0)),j._cache.length<=et.length)nt=j._cache.length,rt=_.concat([rt,$(j,et.slice(0,nt),tt)]),et=et.slice(nt);else{rt=_.concat([rt,$(j,et,tt)]);break}return rt},cfb}var cfb8={},hasRequiredCfb8;function requireCfb8(){if(hasRequiredCfb8)return cfb8;hasRequiredCfb8=1;var _=safeBufferExports.Buffer;function o($,j,et){var tt=$._cipher.encryptBlock($._prev),rt=tt[0]^j;return $._prev=_.concat([$._prev.slice(1),_.from([et?j:rt])]),rt}return cfb8.encrypt=function($,j,et){for(var tt=j.length,rt=_.allocUnsafe(tt),nt=-1;++nt<tt;)rt[nt]=o($,j[nt],et);return rt},cfb8}var cfb1={},hasRequiredCfb1;function requireCfb1(){if(hasRequiredCfb1)return cfb1;hasRequiredCfb1=1;var _=safeBufferExports.Buffer;function o(j,et,tt){for(var rt,nt=-1,it=8,st=0,ot,at;++nt<it;)rt=j._cipher.encryptBlock(j._prev),ot=et&1<<7-nt?128:0,at=rt[0]^ot,st+=(at&128)>>nt%8,j._prev=$(j._prev,tt?ot:at);return st}function $(j,et){var tt=j.length,rt=-1,nt=_.allocUnsafe(j.length);for(j=_.concat([j,_.from([et])]);++rt<tt;)nt[rt]=j[rt]<<1|j[rt+1]>>7;return nt}return cfb1.encrypt=function(j,et,tt){for(var rt=et.length,nt=_.allocUnsafe(rt),it=-1;++it<rt;)nt[it]=o(j,et[it],tt);return nt},cfb1}var ofb={},hasRequiredOfb;function requireOfb(){if(hasRequiredOfb)return ofb;hasRequiredOfb=1;var _=requireBufferXor();function o($){return $._prev=$._cipher.encryptBlock($._prev),$._prev}return ofb.encrypt=function($,j){for(;$._cache.length<j.length;)$._cache=buffer$2.Buffer.concat([$._cache,o($)]);var et=$._cache.slice(0,j.length);return $._cache=$._cache.slice(j.length),_(j,et)},ofb}var ctr={},incr32_1,hasRequiredIncr32;function requireIncr32(){if(hasRequiredIncr32)return incr32_1;hasRequiredIncr32=1;function _(o){for(var $=o.length,j;$--;)if(j=o.readUInt8($),j===255)o.writeUInt8(0,$);else{j++,o.writeUInt8(j,$);break}}return incr32_1=_,incr32_1}var hasRequiredCtr;function requireCtr(){if(hasRequiredCtr)return ctr;hasRequiredCtr=1;var _=requireBufferXor(),o=safeBufferExports.Buffer,$=requireIncr32();function j(tt){var rt=tt._cipher.encryptBlockRaw(tt._prev);return $(tt._prev),rt}var et=16;return ctr.encrypt=function(tt,rt){var nt=Math.ceil(rt.length/et),it=tt._cache.length;tt._cache=o.concat([tt._cache,o.allocUnsafe(nt*et)]);for(var st=0;st<nt;st++){var ot=j(tt),at=it+st*et;tt._cache.writeUInt32BE(ot[0],at+0),tt._cache.writeUInt32BE(ot[1],at+4),tt._cache.writeUInt32BE(ot[2],at+8),tt._cache.writeUInt32BE(ot[3],at+12)}var ct=tt._cache.slice(0,rt.length);return tt._cache=tt._cache.slice(rt.length),_(rt,ct)},ctr}const aes128={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},require$$2$1={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128,aes192,aes256,"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}};var modes_1,hasRequiredModes$1;function requireModes$1(){if(hasRequiredModes$1)return modes_1;hasRequiredModes$1=1;var _={ECB:requireEcb(),CBC:requireCbc(),CFB:requireCfb(),CFB8:requireCfb8(),CFB1:requireCfb1(),OFB:requireOfb(),CTR:requireCtr(),GCM:requireCtr()},o=require$$2$1;for(var $ in o)o[$].module=_[o[$].mode];return modes_1=o,modes_1}var aes$1={},hasRequiredAes;function requireAes(){if(hasRequiredAes)return aes$1;hasRequiredAes=1;var _=safeBufferExports.Buffer;function o(nt){_.isBuffer(nt)||(nt=_.from(nt));for(var it=nt.length/4|0,st=new Array(it),ot=0;ot<it;ot++)st[ot]=nt.readUInt32BE(ot*4);return st}function $(nt){for(var it=0;it<nt.length;nt++)nt[it]=0}function j(nt,it,st,ot,at){for(var ct=st[0],ut=st[1],ft=st[2],ht=st[3],mt=nt[0]^it[0],gt=nt[1]^it[1],Et=nt[2]^it[2],St=nt[3]^it[3],At,kt,Rt,Tt,Dt=4,Ot=1;Ot<at;Ot++)At=ct[mt>>>24]^ut[gt>>>16&255]^ft[Et>>>8&255]^ht[St&255]^it[Dt++],kt=ct[gt>>>24]^ut[Et>>>16&255]^ft[St>>>8&255]^ht[mt&255]^it[Dt++],Rt=ct[Et>>>24]^ut[St>>>16&255]^ft[mt>>>8&255]^ht[gt&255]^it[Dt++],Tt=ct[St>>>24]^ut[mt>>>16&255]^ft[gt>>>8&255]^ht[Et&255]^it[Dt++],mt=At,gt=kt,Et=Rt,St=Tt;return At=(ot[mt>>>24]<<24|ot[gt>>>16&255]<<16|ot[Et>>>8&255]<<8|ot[St&255])^it[Dt++],kt=(ot[gt>>>24]<<24|ot[Et>>>16&255]<<16|ot[St>>>8&255]<<8|ot[mt&255])^it[Dt++],Rt=(ot[Et>>>24]<<24|ot[St>>>16&255]<<16|ot[mt>>>8&255]<<8|ot[gt&255])^it[Dt++],Tt=(ot[St>>>24]<<24|ot[mt>>>16&255]<<16|ot[gt>>>8&255]<<8|ot[Et&255])^it[Dt++],At=At>>>0,kt=kt>>>0,Rt=Rt>>>0,Tt=Tt>>>0,[At,kt,Rt,Tt]}var et=[0,1,2,4,8,16,32,64,128,27,54],tt=function(){for(var nt=new Array(256),it=0;it<256;it++)it<128?nt[it]=it<<1:nt[it]=it<<1^283;for(var st=[],ot=[],at=[[],[],[],[]],ct=[[],[],[],[]],ut=0,ft=0,ht=0;ht<256;++ht){var mt=ft^ft<<1^ft<<2^ft<<3^ft<<4;mt=mt>>>8^mt&255^99,st[ut]=mt,ot[mt]=ut;var gt=nt[ut],Et=nt[gt],St=nt[Et],At=nt[mt]*257^mt*16843008;at[0][ut]=At<<24|At>>>8,at[1][ut]=At<<16|At>>>16,at[2][ut]=At<<8|At>>>24,at[3][ut]=At,At=St*16843009^Et*65537^gt*257^ut*16843008,ct[0][mt]=At<<24|At>>>8,ct[1][mt]=At<<16|At>>>16,ct[2][mt]=At<<8|At>>>24,ct[3][mt]=At,ut===0?ut=ft=1:(ut=gt^nt[nt[nt[St^gt]]],ft^=nt[nt[ft]])}return{SBOX:st,INV_SBOX:ot,SUB_MIX:at,INV_SUB_MIX:ct}}();function rt(nt){this._key=o(nt),this._reset()}return rt.blockSize=4*4,rt.keySize=256/8,rt.prototype.blockSize=rt.blockSize,rt.prototype.keySize=rt.keySize,rt.prototype._reset=function(){for(var nt=this._key,it=nt.length,st=it+6,ot=(st+1)*4,at=[],ct=0;ct<it;ct++)at[ct]=nt[ct];for(ct=it;ct<ot;ct++){var ut=at[ct-1];ct%it===0?(ut=ut<<8|ut>>>24,ut=tt.SBOX[ut>>>24]<<24|tt.SBOX[ut>>>16&255]<<16|tt.SBOX[ut>>>8&255]<<8|tt.SBOX[ut&255],ut^=et[ct/it|0]<<24):it>6&&ct%it===4&&(ut=tt.SBOX[ut>>>24]<<24|tt.SBOX[ut>>>16&255]<<16|tt.SBOX[ut>>>8&255]<<8|tt.SBOX[ut&255]),at[ct]=at[ct-it]^ut}for(var ft=[],ht=0;ht<ot;ht++){var mt=ot-ht,gt=at[mt-(ht%4?0:4)];ht<4||mt<=4?ft[ht]=gt:ft[ht]=tt.INV_SUB_MIX[0][tt.SBOX[gt>>>24]]^tt.INV_SUB_MIX[1][tt.SBOX[gt>>>16&255]]^tt.INV_SUB_MIX[2][tt.SBOX[gt>>>8&255]]^tt.INV_SUB_MIX[3][tt.SBOX[gt&255]]}this._nRounds=st,this._keySchedule=at,this._invKeySchedule=ft},rt.prototype.encryptBlockRaw=function(nt){return nt=o(nt),j(nt,this._keySchedule,tt.SUB_MIX,tt.SBOX,this._nRounds)},rt.prototype.encryptBlock=function(nt){var it=this.encryptBlockRaw(nt),st=_.allocUnsafe(16);return st.writeUInt32BE(it[0],0),st.writeUInt32BE(it[1],4),st.writeUInt32BE(it[2],8),st.writeUInt32BE(it[3],12),st},rt.prototype.decryptBlock=function(nt){nt=o(nt);var it=nt[1];nt[1]=nt[3],nt[3]=it;var st=j(nt,this._invKeySchedule,tt.INV_SUB_MIX,tt.INV_SBOX,this._nRounds),ot=_.allocUnsafe(16);return ot.writeUInt32BE(st[0],0),ot.writeUInt32BE(st[3],4),ot.writeUInt32BE(st[2],8),ot.writeUInt32BE(st[1],12),ot},rt.prototype.scrub=function(){$(this._keySchedule),$(this._invKeySchedule),$(this._key)},aes$1.AES=rt,aes$1}var ghash,hasRequiredGhash;function requireGhash(){if(hasRequiredGhash)return ghash;hasRequiredGhash=1;var _=safeBufferExports.Buffer,o=_.alloc(16,0);function $(tt){return[tt.readUInt32BE(0),tt.readUInt32BE(4),tt.readUInt32BE(8),tt.readUInt32BE(12)]}function j(tt){var rt=_.allocUnsafe(16);return rt.writeUInt32BE(tt[0]>>>0,0),rt.writeUInt32BE(tt[1]>>>0,4),rt.writeUInt32BE(tt[2]>>>0,8),rt.writeUInt32BE(tt[3]>>>0,12),rt}function et(tt){this.h=tt,this.state=_.alloc(16,0),this.cache=_.allocUnsafe(0)}return et.prototype.ghash=function(tt){for(var rt=-1;++rt<tt.length;)this.state[rt]^=tt[rt];this._multiply()},et.prototype._multiply=function(){for(var tt=$(this.h),rt=[0,0,0,0],nt,it,st,ot=-1;++ot<128;){for(it=(this.state[~~(ot/8)]&1<<7-ot%8)!==0,it&&(rt[0]^=tt[0],rt[1]^=tt[1],rt[2]^=tt[2],rt[3]^=tt[3]),st=(tt[3]&1)!==0,nt=3;nt>0;nt--)tt[nt]=tt[nt]>>>1|(tt[nt-1]&1)<<31;tt[0]=tt[0]>>>1,st&&(tt[0]=tt[0]^225<<24)}this.state=j(rt)},et.prototype.update=function(tt){this.cache=_.concat([this.cache,tt]);for(var rt;this.cache.length>=16;)rt=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(rt)},et.prototype.final=function(tt,rt){return this.cache.length&&this.ghash(_.concat([this.cache,o],16)),this.ghash(j([0,tt,0,rt])),this.state},ghash=et,ghash}var authCipher,hasRequiredAuthCipher;function requireAuthCipher(){if(hasRequiredAuthCipher)return authCipher;hasRequiredAuthCipher=1;var _=requireAes(),o=safeBufferExports.Buffer,$=requireCipherBase(),j=inherits_browserExports,et=requireGhash(),tt=requireBufferXor(),rt=requireIncr32();function nt(ot,at){var ct=0;ot.length!==at.length&&ct++;for(var ut=Math.min(ot.length,at.length),ft=0;ft<ut;++ft)ct+=ot[ft]^at[ft];return ct}function it(ot,at,ct){if(at.length===12)return ot._finID=o.concat([at,o.from([0,0,0,1])]),o.concat([at,o.from([0,0,0,2])]);var ut=new et(ct),ft=at.length,ht=ft%16;ut.update(at),ht&&(ht=16-ht,ut.update(o.alloc(ht,0))),ut.update(o.alloc(8,0));var mt=ft*8,gt=o.alloc(8);gt.writeUIntBE(mt,0,8),ut.update(gt),ot._finID=ut.state;var Et=o.from(ot._finID);return rt(Et),Et}function st(ot,at,ct,ut){$.call(this);var ft=o.alloc(4,0);this._cipher=new _.AES(at);var ht=this._cipher.encryptBlock(ft);this._ghash=new et(ht),ct=it(this,ct,ht),this._prev=o.from(ct),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=ut,this._alen=0,this._len=0,this._mode=ot,this._authTag=null,this._called=!1}return j(st,$),st.prototype._update=function(ot){if(!this._called&&this._alen){var at=16-this._alen%16;at<16&&(at=o.alloc(at,0),this._ghash.update(at))}this._called=!0;var ct=this._mode.encrypt(this,ot);return this._decrypt?this._ghash.update(ot):this._ghash.update(ct),this._len+=ot.length,ct},st.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var ot=tt(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&nt(ot,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=ot,this._cipher.scrub()},st.prototype.getAuthTag=function(){if(this._decrypt||!o.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},st.prototype.setAuthTag=function(at){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=at},st.prototype.setAAD=function(at){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(at),this._alen+=at.length},authCipher=st,authCipher}var streamCipher,hasRequiredStreamCipher;function requireStreamCipher(){if(hasRequiredStreamCipher)return streamCipher;hasRequiredStreamCipher=1;var _=requireAes(),o=safeBufferExports.Buffer,$=requireCipherBase(),j=inherits_browserExports;function et(tt,rt,nt,it){$.call(this),this._cipher=new _.AES(rt),this._prev=o.from(nt),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=it,this._mode=tt}return j(et,$),et.prototype._update=function(tt){return this._mode.encrypt(this,tt,this._decrypt)},et.prototype._final=function(){this._cipher.scrub()},streamCipher=et,streamCipher}var evp_bytestokey,hasRequiredEvp_bytestokey;function requireEvp_bytestokey(){if(hasRequiredEvp_bytestokey)return evp_bytestokey;hasRequiredEvp_bytestokey=1;var _=safeBufferExports.Buffer,o=requireMd5_js();function $(j,et,tt,rt){if(_.isBuffer(j)||(j=_.from(j,"binary")),et&&(_.isBuffer(et)||(et=_.from(et,"binary")),et.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var nt=tt/8,it=_.alloc(nt),st=_.alloc(rt||0),ot=_.alloc(0);nt>0||rt>0;){var at=new o;at.update(ot),at.update(j),et&&at.update(et),ot=at.digest();var ct=0;if(nt>0){var ut=it.length-nt;ct=Math.min(nt,ot.length),ot.copy(it,ut,0,ct),nt-=ct}if(ct<ot.length&&rt>0){var ft=st.length-rt,ht=Math.min(rt,ot.length-ct);ot.copy(st,ft,ct,ct+ht),rt-=ht}}return ot.fill(0),{key:it,iv:st}}return evp_bytestokey=$,evp_bytestokey}var hasRequiredEncrypter;function requireEncrypter(){if(hasRequiredEncrypter)return encrypter;hasRequiredEncrypter=1;var _=requireModes$1(),o=requireAuthCipher(),$=safeBufferExports.Buffer,j=requireStreamCipher(),et=requireCipherBase(),tt=requireAes(),rt=requireEvp_bytestokey(),nt=inherits_browserExports;function it(ut,ft,ht){et.call(this),this._cache=new ot,this._cipher=new tt.AES(ft),this._prev=$.from(ht),this._mode=ut,this._autopadding=!0}nt(it,et),it.prototype._update=function(ut){this._cache.add(ut);for(var ft,ht,mt=[];ft=this._cache.get();)ht=this._mode.encrypt(this,ft),mt.push(ht);return $.concat(mt)};var st=$.alloc(16,16);it.prototype._final=function(){var ut=this._cache.flush();if(this._autopadding)return ut=this._mode.encrypt(this,ut),this._cipher.scrub(),ut;if(!ut.equals(st))throw this._cipher.scrub(),new Error("data not multiple of block length")},it.prototype.setAutoPadding=function(ut){return this._autopadding=!!ut,this};function ot(){this.cache=$.allocUnsafe(0)}ot.prototype.add=function(ut){this.cache=$.concat([this.cache,ut])},ot.prototype.get=function(){if(this.cache.length>15){var ut=this.cache.slice(0,16);return this.cache=this.cache.slice(16),ut}return null},ot.prototype.flush=function(){for(var ut=16-this.cache.length,ft=$.allocUnsafe(ut),ht=-1;++ht<ut;)ft.writeUInt8(ut,ht);return $.concat([this.cache,ft])};function at(ut,ft,ht){var mt=_[ut.toLowerCase()];if(!mt)throw new TypeError("invalid suite type");if(typeof ft=="string"&&(ft=$.from(ft)),ft.length!==mt.key/8)throw new TypeError("invalid key length "+ft.length);if(typeof ht=="string"&&(ht=$.from(ht)),mt.mode!=="GCM"&&ht.length!==mt.iv)throw new TypeError("invalid iv length "+ht.length);return mt.type==="stream"?new j(mt.module,ft,ht):mt.type==="auth"?new o(mt.module,ft,ht):new it(mt.module,ft,ht)}function ct(ut,ft){var ht=_[ut.toLowerCase()];if(!ht)throw new TypeError("invalid suite type");var mt=rt(ft,!1,ht.key,ht.iv);return at(ut,mt.key,mt.iv)}return encrypter.createCipheriv=at,encrypter.createCipher=ct,encrypter}var decrypter={},hasRequiredDecrypter;function requireDecrypter(){if(hasRequiredDecrypter)return decrypter;hasRequiredDecrypter=1;var _=requireAuthCipher(),o=safeBufferExports.Buffer,$=requireModes$1(),j=requireStreamCipher(),et=requireCipherBase(),tt=requireAes(),rt=requireEvp_bytestokey(),nt=inherits_browserExports;function it(ut,ft,ht){et.call(this),this._cache=new st,this._last=void 0,this._cipher=new tt.AES(ft),this._prev=o.from(ht),this._mode=ut,this._autopadding=!0}nt(it,et),it.prototype._update=function(ut){this._cache.add(ut);for(var ft,ht,mt=[];ft=this._cache.get(this._autopadding);)ht=this._mode.decrypt(this,ft),mt.push(ht);return o.concat(mt)},it.prototype._final=function(){var ut=this._cache.flush();if(this._autopadding)return ot(this._mode.decrypt(this,ut));if(ut)throw new Error("data not multiple of block length")},it.prototype.setAutoPadding=function(ut){return this._autopadding=!!ut,this};function st(){this.cache=o.allocUnsafe(0)}st.prototype.add=function(ut){this.cache=o.concat([this.cache,ut])},st.prototype.get=function(ut){var ft;if(ut){if(this.cache.length>16)return ft=this.cache.slice(0,16),this.cache=this.cache.slice(16),ft}else if(this.cache.length>=16)return ft=this.cache.slice(0,16),this.cache=this.cache.slice(16),ft;return null},st.prototype.flush=function(){if(this.cache.length)return this.cache};function ot(ut){var ft=ut[15];if(ft<1||ft>16)throw new Error("unable to decrypt data");for(var ht=-1;++ht<ft;)if(ut[ht+(16-ft)]!==ft)throw new Error("unable to decrypt data");if(ft!==16)return ut.slice(0,16-ft)}function at(ut,ft,ht){var mt=$[ut.toLowerCase()];if(!mt)throw new TypeError("invalid suite type");if(typeof ht=="string"&&(ht=o.from(ht)),mt.mode!=="GCM"&&ht.length!==mt.iv)throw new TypeError("invalid iv length "+ht.length);if(typeof ft=="string"&&(ft=o.from(ft)),ft.length!==mt.key/8)throw new TypeError("invalid key length "+ft.length);return mt.type==="stream"?new j(mt.module,ft,ht,!0):mt.type==="auth"?new _(mt.module,ft,ht,!0):new it(mt.module,ft,ht)}function ct(ut,ft){var ht=$[ut.toLowerCase()];if(!ht)throw new TypeError("invalid suite type");var mt=rt(ft,!1,ht.key,ht.iv);return at(ut,mt.key,mt.iv)}return decrypter.createDecipher=ct,decrypter.createDecipheriv=at,decrypter}var hasRequiredBrowser$7;function requireBrowser$7(){if(hasRequiredBrowser$7)return browser$a;hasRequiredBrowser$7=1;var _=requireEncrypter(),o=requireDecrypter(),$=require$$2$1;function j(){return Object.keys($)}return browser$a.createCipher=browser$a.Cipher=_.createCipher,browser$a.createCipheriv=browser$a.Cipheriv=_.createCipheriv,browser$a.createDecipher=browser$a.Decipher=o.createDecipher,browser$a.createDecipheriv=browser$a.Decipheriv=o.createDecipheriv,browser$a.listCiphers=browser$a.getCiphers=j,browser$a}var modes={},hasRequiredModes;function requireModes(){return hasRequiredModes||(hasRequiredModes=1,function(_){_["des-ecb"]={key:8,iv:0},_["des-cbc"]=_.des={key:8,iv:8},_["des-ede3-cbc"]=_.des3={key:24,iv:8},_["des-ede3"]={key:24,iv:0},_["des-ede-cbc"]={key:16,iv:8},_["des-ede"]={key:16,iv:0}}(modes)),modes}var hasRequiredBrowser$6;function requireBrowser$6(){if(hasRequiredBrowser$6)return browser$b;hasRequiredBrowser$6=1;var _=requireBrowserifyDes(),o=requireBrowser$7(),$=requireModes$1(),j=requireModes(),et=requireEvp_bytestokey();function tt(ot,at){ot=ot.toLowerCase();var ct,ut;if($[ot])ct=$[ot].key,ut=$[ot].iv;else if(j[ot])ct=j[ot].key*8,ut=j[ot].iv;else throw new TypeError("invalid suite type");var ft=et(at,!1,ct,ut);return nt(ot,ft.key,ft.iv)}function rt(ot,at){ot=ot.toLowerCase();var ct,ut;if($[ot])ct=$[ot].key,ut=$[ot].iv;else if(j[ot])ct=j[ot].key*8,ut=j[ot].iv;else throw new TypeError("invalid suite type");var ft=et(at,!1,ct,ut);return it(ot,ft.key,ft.iv)}function nt(ot,at,ct){if(ot=ot.toLowerCase(),$[ot])return o.createCipheriv(ot,at,ct);if(j[ot])return new _({key:at,iv:ct,mode:ot});throw new TypeError("invalid suite type")}function it(ot,at,ct){if(ot=ot.toLowerCase(),$[ot])return o.createDecipheriv(ot,at,ct);if(j[ot])return new _({key:at,iv:ct,mode:ot,decrypt:!0});throw new TypeError("invalid suite type")}function st(){return Object.keys(j).concat(o.getCiphers())}return browser$b.createCipher=browser$b.Cipher=tt,browser$b.createCipheriv=browser$b.Cipheriv=nt,browser$b.createDecipher=browser$b.Decipher=rt,browser$b.createDecipheriv=browser$b.Decipheriv=it,browser$b.listCiphers=browser$b.getCiphers=st,browser$b}var browser$9={},bnExports$4={},bn$4={get exports(){return bnExports$4},set exports(_){bnExports$4=_}};(function(_){(function(o,$){function j(Nt,It){if(!Nt)throw new Error(It||"Assertion failed")}function et(Nt,It){Nt.super_=It;var yt=function(){};yt.prototype=It.prototype,Nt.prototype=new yt,Nt.prototype.constructor=Nt}function tt(Nt,It,yt){if(tt.isBN(Nt))return Nt;this.negative=0,this.words=null,this.length=0,this.red=null,Nt!==null&&((It==="le"||It==="be")&&(yt=It,It=10),this._init(Nt||0,It||10,yt||"be"))}typeof o=="object"?o.exports=tt:$.BN=tt,tt.BN=tt,tt.wordSize=26;var rt;try{typeof window<"u"&&typeof window.Buffer<"u"?rt=window.Buffer:rt=buffer$2.Buffer}catch{}tt.isBN=function(It){return It instanceof tt?!0:It!==null&&typeof It=="object"&&It.constructor.wordSize===tt.wordSize&&Array.isArray(It.words)},tt.max=function(It,yt){return It.cmp(yt)>0?It:yt},tt.min=function(It,yt){return It.cmp(yt)<0?It:yt},tt.prototype._init=function(It,yt,lt){if(typeof It=="number")return this._initNumber(It,yt,lt);if(typeof It=="object")return this._initArray(It,yt,lt);yt==="hex"&&(yt=16),j(yt===(yt|0)&&yt>=2&&yt<=36),It=It.toString().replace(/\s+/g,"");var pt=0;It[0]==="-"&&(pt++,this.negative=1),pt<It.length&&(yt===16?this._parseHex(It,pt,lt):(this._parseBase(It,yt,pt),lt==="le"&&this._initArray(this.toArray(),yt,lt)))},tt.prototype._initNumber=function(It,yt,lt){It<0&&(this.negative=1,It=-It),It<67108864?(this.words=[It&67108863],this.length=1):It<4503599627370496?(this.words=[It&67108863,It/67108864&67108863],this.length=2):(j(It<9007199254740992),this.words=[It&67108863,It/67108864&67108863,1],this.length=3),lt==="le"&&this._initArray(this.toArray(),yt,lt)},tt.prototype._initArray=function(It,yt,lt){if(j(typeof It.length=="number"),It.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(It.length/3),this.words=new Array(this.length);for(var pt=0;pt<this.length;pt++)this.words[pt]=0;var bt,_t,$t=0;if(lt==="be")for(pt=It.length-1,bt=0;pt>=0;pt-=3)_t=It[pt]|It[pt-1]<<8|It[pt-2]<<16,this.words[bt]|=_t<<$t&67108863,this.words[bt+1]=_t>>>26-$t&67108863,$t+=24,$t>=26&&($t-=26,bt++);else if(lt==="le")for(pt=0,bt=0;pt<It.length;pt+=3)_t=It[pt]|It[pt+1]<<8|It[pt+2]<<16,this.words[bt]|=_t<<$t&67108863,this.words[bt+1]=_t>>>26-$t&67108863,$t+=24,$t>=26&&($t-=26,bt++);return this.strip()};function nt(Nt,It){var yt=Nt.charCodeAt(It);return yt>=65&&yt<=70?yt-55:yt>=97&&yt<=102?yt-87:yt-48&15}function it(Nt,It,yt){var lt=nt(Nt,yt);return yt-1>=It&&(lt|=nt(Nt,yt-1)<<4),lt}tt.prototype._parseHex=function(It,yt,lt){this.length=Math.ceil((It.length-yt)/6),this.words=new Array(this.length);for(var pt=0;pt<this.length;pt++)this.words[pt]=0;var bt=0,_t=0,$t;if(lt==="be")for(pt=It.length-1;pt>=yt;pt-=2)$t=it(It,yt,pt)<<bt,this.words[_t]|=$t&67108863,bt>=18?(bt-=18,_t+=1,this.words[_t]|=$t>>>26):bt+=8;else{var Ct=It.length-yt;for(pt=Ct%2===0?yt+1:yt;pt<It.length;pt+=2)$t=it(It,yt,pt)<<bt,this.words[_t]|=$t&67108863,bt>=18?(bt-=18,_t+=1,this.words[_t]|=$t>>>26):bt+=8}this.strip()};function st(Nt,It,yt,lt){for(var pt=0,bt=Math.min(Nt.length,yt),_t=It;_t<bt;_t++){var $t=Nt.charCodeAt(_t)-48;pt*=lt,$t>=49?pt+=$t-49+10:$t>=17?pt+=$t-17+10:pt+=$t}return pt}tt.prototype._parseBase=function(It,yt,lt){this.words=[0],this.length=1;for(var pt=0,bt=1;bt<=67108863;bt*=yt)pt++;pt--,bt=bt/yt|0;for(var _t=It.length-lt,$t=_t%pt,Ct=Math.min(_t,_t-$t)+lt,xt=0,vt=lt;vt<Ct;vt+=pt)xt=st(It,vt,vt+pt,yt),this.imuln(bt),this.words[0]+xt<67108864?this.words[0]+=xt:this._iaddn(xt);if($t!==0){var dt=1;for(xt=st(It,vt,It.length,yt),vt=0;vt<$t;vt++)dt*=yt;this.imuln(dt),this.words[0]+xt<67108864?this.words[0]+=xt:this._iaddn(xt)}this.strip()},tt.prototype.copy=function(It){It.words=new Array(this.length);for(var yt=0;yt<this.length;yt++)It.words[yt]=this.words[yt];It.length=this.length,It.negative=this.negative,It.red=this.red},tt.prototype.clone=function(){var It=new tt(null);return this.copy(It),It},tt.prototype._expand=function(It){for(;this.length<It;)this.words[this.length++]=0;return this},tt.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},tt.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},tt.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var ot=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],at=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ct=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];tt.prototype.toString=function(It,yt){It=It||10,yt=yt|0||1;var lt;if(It===16||It==="hex"){lt="";for(var pt=0,bt=0,_t=0;_t<this.length;_t++){var $t=this.words[_t],Ct=(($t<<pt|bt)&16777215).toString(16);bt=$t>>>24-pt&16777215,bt!==0||_t!==this.length-1?lt=ot[6-Ct.length]+Ct+lt:lt=Ct+lt,pt+=2,pt>=26&&(pt-=26,_t--)}for(bt!==0&&(lt=bt.toString(16)+lt);lt.length%yt!==0;)lt="0"+lt;return this.negative!==0&&(lt="-"+lt),lt}if(It===(It|0)&&It>=2&&It<=36){var xt=at[It],vt=ct[It];lt="";var dt=this.clone();for(dt.negative=0;!dt.isZero();){var wt=dt.modn(vt).toString(It);dt=dt.idivn(vt),dt.isZero()?lt=wt+lt:lt=ot[xt-wt.length]+wt+lt}for(this.isZero()&&(lt="0"+lt);lt.length%yt!==0;)lt="0"+lt;return this.negative!==0&&(lt="-"+lt),lt}j(!1,"Base should be between 2 and 36")},tt.prototype.toNumber=function(){var It=this.words[0];return this.length===2?It+=this.words[1]*67108864:this.length===3&&this.words[2]===1?It+=4503599627370496+this.words[1]*67108864:this.length>2&&j(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-It:It},tt.prototype.toJSON=function(){return this.toString(16)},tt.prototype.toBuffer=function(It,yt){return j(typeof rt<"u"),this.toArrayLike(rt,It,yt)},tt.prototype.toArray=function(It,yt){return this.toArrayLike(Array,It,yt)},tt.prototype.toArrayLike=function(It,yt,lt){var pt=this.byteLength(),bt=lt||Math.max(1,pt);j(pt<=bt,"byte array longer than desired length"),j(bt>0,"Requested array length <= 0"),this.strip();var _t=yt==="le",$t=new It(bt),Ct,xt,vt=this.clone();if(_t){for(xt=0;!vt.isZero();xt++)Ct=vt.andln(255),vt.iushrn(8),$t[xt]=Ct;for(;xt<bt;xt++)$t[xt]=0}else{for(xt=0;xt<bt-pt;xt++)$t[xt]=0;for(xt=0;!vt.isZero();xt++)Ct=vt.andln(255),vt.iushrn(8),$t[bt-xt-1]=Ct}return $t},Math.clz32?tt.prototype._countBits=function(It){return 32-Math.clz32(It)}:tt.prototype._countBits=function(It){var yt=It,lt=0;return yt>=4096&&(lt+=13,yt>>>=13),yt>=64&&(lt+=7,yt>>>=7),yt>=8&&(lt+=4,yt>>>=4),yt>=2&&(lt+=2,yt>>>=2),lt+yt},tt.prototype._zeroBits=function(It){if(It===0)return 26;var yt=It,lt=0;return yt&8191||(lt+=13,yt>>>=13),yt&127||(lt+=7,yt>>>=7),yt&15||(lt+=4,yt>>>=4),yt&3||(lt+=2,yt>>>=2),yt&1||lt++,lt},tt.prototype.bitLength=function(){var It=this.words[this.length-1],yt=this._countBits(It);return(this.length-1)*26+yt};function ut(Nt){for(var It=new Array(Nt.bitLength()),yt=0;yt<It.length;yt++){var lt=yt/26|0,pt=yt%26;It[yt]=(Nt.words[lt]&1<<pt)>>>pt}return It}tt.prototype.zeroBits=function(){if(this.isZero())return 0;for(var It=0,yt=0;yt<this.length;yt++){var lt=this._zeroBits(this.words[yt]);if(It+=lt,lt!==26)break}return It},tt.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},tt.prototype.toTwos=function(It){return this.negative!==0?this.abs().inotn(It).iaddn(1):this.clone()},tt.prototype.fromTwos=function(It){return this.testn(It-1)?this.notn(It).iaddn(1).ineg():this.clone()},tt.prototype.isNeg=function(){return this.negative!==0},tt.prototype.neg=function(){return this.clone().ineg()},tt.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},tt.prototype.iuor=function(It){for(;this.length<It.length;)this.words[this.length++]=0;for(var yt=0;yt<It.length;yt++)this.words[yt]=this.words[yt]|It.words[yt];return this.strip()},tt.prototype.ior=function(It){return j((this.negative|It.negative)===0),this.iuor(It)},tt.prototype.or=function(It){return this.length>It.length?this.clone().ior(It):It.clone().ior(this)},tt.prototype.uor=function(It){return this.length>It.length?this.clone().iuor(It):It.clone().iuor(this)},tt.prototype.iuand=function(It){var yt;this.length>It.length?yt=It:yt=this;for(var lt=0;lt<yt.length;lt++)this.words[lt]=this.words[lt]&It.words[lt];return this.length=yt.length,this.strip()},tt.prototype.iand=function(It){return j((this.negative|It.negative)===0),this.iuand(It)},tt.prototype.and=function(It){return this.length>It.length?this.clone().iand(It):It.clone().iand(this)},tt.prototype.uand=function(It){return this.length>It.length?this.clone().iuand(It):It.clone().iuand(this)},tt.prototype.iuxor=function(It){var yt,lt;this.length>It.length?(yt=this,lt=It):(yt=It,lt=this);for(var pt=0;pt<lt.length;pt++)this.words[pt]=yt.words[pt]^lt.words[pt];if(this!==yt)for(;pt<yt.length;pt++)this.words[pt]=yt.words[pt];return this.length=yt.length,this.strip()},tt.prototype.ixor=function(It){return j((this.negative|It.negative)===0),this.iuxor(It)},tt.prototype.xor=function(It){return this.length>It.length?this.clone().ixor(It):It.clone().ixor(this)},tt.prototype.uxor=function(It){return this.length>It.length?this.clone().iuxor(It):It.clone().iuxor(this)},tt.prototype.inotn=function(It){j(typeof It=="number"&&It>=0);var yt=Math.ceil(It/26)|0,lt=It%26;this._expand(yt),lt>0&&yt--;for(var pt=0;pt<yt;pt++)this.words[pt]=~this.words[pt]&67108863;return lt>0&&(this.words[pt]=~this.words[pt]&67108863>>26-lt),this.strip()},tt.prototype.notn=function(It){return this.clone().inotn(It)},tt.prototype.setn=function(It,yt){j(typeof It=="number"&&It>=0);var lt=It/26|0,pt=It%26;return this._expand(lt+1),yt?this.words[lt]=this.words[lt]|1<<pt:this.words[lt]=this.words[lt]&~(1<<pt),this.strip()},tt.prototype.iadd=function(It){var yt;if(this.negative!==0&&It.negative===0)return this.negative=0,yt=this.isub(It),this.negative^=1,this._normSign();if(this.negative===0&&It.negative!==0)return It.negative=0,yt=this.isub(It),It.negative=1,yt._normSign();var lt,pt;this.length>It.length?(lt=this,pt=It):(lt=It,pt=this);for(var bt=0,_t=0;_t<pt.length;_t++)yt=(lt.words[_t]|0)+(pt.words[_t]|0)+bt,this.words[_t]=yt&67108863,bt=yt>>>26;for(;bt!==0&&_t<lt.length;_t++)yt=(lt.words[_t]|0)+bt,this.words[_t]=yt&67108863,bt=yt>>>26;if(this.length=lt.length,bt!==0)this.words[this.length]=bt,this.length++;else if(lt!==this)for(;_t<lt.length;_t++)this.words[_t]=lt.words[_t];return this},tt.prototype.add=function(It){var yt;return It.negative!==0&&this.negative===0?(It.negative=0,yt=this.sub(It),It.negative^=1,yt):It.negative===0&&this.negative!==0?(this.negative=0,yt=It.sub(this),this.negative=1,yt):this.length>It.length?this.clone().iadd(It):It.clone().iadd(this)},tt.prototype.isub=function(It){if(It.negative!==0){It.negative=0;var yt=this.iadd(It);return It.negative=1,yt._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(It),this.negative=1,this._normSign();var lt=this.cmp(It);if(lt===0)return this.negative=0,this.length=1,this.words[0]=0,this;var pt,bt;lt>0?(pt=this,bt=It):(pt=It,bt=this);for(var _t=0,$t=0;$t<bt.length;$t++)yt=(pt.words[$t]|0)-(bt.words[$t]|0)+_t,_t=yt>>26,this.words[$t]=yt&67108863;for(;_t!==0&&$t<pt.length;$t++)yt=(pt.words[$t]|0)+_t,_t=yt>>26,this.words[$t]=yt&67108863;if(_t===0&&$t<pt.length&&pt!==this)for(;$t<pt.length;$t++)this.words[$t]=pt.words[$t];return this.length=Math.max(this.length,$t),pt!==this&&(this.negative=1),this.strip()},tt.prototype.sub=function(It){return this.clone().isub(It)};function ft(Nt,It,yt){yt.negative=It.negative^Nt.negative;var lt=Nt.length+It.length|0;yt.length=lt,lt=lt-1|0;var pt=Nt.words[0]|0,bt=It.words[0]|0,_t=pt*bt,$t=_t&67108863,Ct=_t/67108864|0;yt.words[0]=$t;for(var xt=1;xt<lt;xt++){for(var vt=Ct>>>26,dt=Ct&67108863,wt=Math.min(xt,It.length-1),qt=Math.max(0,xt-Nt.length+1);qt<=wt;qt++){var Pt=xt-qt|0;pt=Nt.words[Pt]|0,bt=It.words[qt]|0,_t=pt*bt+dt,vt+=_t/67108864|0,dt=_t&67108863}yt.words[xt]=dt|0,Ct=vt|0}return Ct!==0?yt.words[xt]=Ct|0:yt.length--,yt.strip()}var ht=function(It,yt,lt){var pt=It.words,bt=yt.words,_t=lt.words,$t=0,Ct,xt,vt,dt=pt[0]|0,wt=dt&8191,qt=dt>>>13,Pt=pt[1]|0,Gt=Pt&8191,Wt=Pt>>>13,Vt=pt[2]|0,Ut=Vt&8191,Mt=Vt>>>13,Lt=pt[3]|0,Yt=Lt&8191,lr=Lt>>>13,cr=pt[4]|0,ir=cr&8191,Zt=cr>>>13,Bt=pt[5]|0,Ft=Bt&8191,zt=Bt>>>13,Qt=pt[6]|0,nr=Qt&8191,gr=Qt>>>13,br=pt[7]|0,vr=br&8191,Nr=br>>>13,ar=pt[8]|0,er=ar&8191,Xt=ar>>>13,tr=pt[9]|0,ur=tr&8191,pr=tr>>>13,yr=bt[0]|0,wr=yr&8191,Gr=yr>>>13,$r=bt[1]|0,Er=$r&8191,Wr=$r>>>13,Vr=bt[2]|0,Pr=Vr&8191,nn=Vr>>>13,Kr=bt[3]|0,Dr=Kr&8191,Qr=Kr>>>13,Or=bt[4]|0,Cr=Or&8191,Zr=Or>>>13,Fr=bt[5]|0,Ar=Fr&8191,Xr=Fr>>>13,Mr=bt[6]|0,Sr=Mr&8191,Jr=Mr>>>13,Ur=bt[7]|0,Rr=Ur&8191,en=Ur>>>13,Br=bt[8]|0,Ir=Br&8191,tn=Br>>>13,qr=bt[9]|0,Lr=qr&8191,sn=qr>>>13;lt.negative=It.negative^yt.negative,lt.length=19,Ct=Math.imul(wt,wr),xt=Math.imul(wt,Gr),xt=xt+Math.imul(qt,wr)|0,vt=Math.imul(qt,Gr);var Hr=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(Hr>>>26)|0,Hr&=67108863,Ct=Math.imul(Gt,wr),xt=Math.imul(Gt,Gr),xt=xt+Math.imul(Wt,wr)|0,vt=Math.imul(Wt,Gr),Ct=Ct+Math.imul(wt,Er)|0,xt=xt+Math.imul(wt,Wr)|0,xt=xt+Math.imul(qt,Er)|0,vt=vt+Math.imul(qt,Wr)|0;var jr=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(jr>>>26)|0,jr&=67108863,Ct=Math.imul(Ut,wr),xt=Math.imul(Ut,Gr),xt=xt+Math.imul(Mt,wr)|0,vt=Math.imul(Mt,Gr),Ct=Ct+Math.imul(Gt,Er)|0,xt=xt+Math.imul(Gt,Wr)|0,xt=xt+Math.imul(Wt,Er)|0,vt=vt+Math.imul(Wt,Wr)|0,Ct=Ct+Math.imul(wt,Pr)|0,xt=xt+Math.imul(wt,nn)|0,xt=xt+Math.imul(qt,Pr)|0,vt=vt+Math.imul(qt,nn)|0;var un=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(un>>>26)|0,un&=67108863,Ct=Math.imul(Yt,wr),xt=Math.imul(Yt,Gr),xt=xt+Math.imul(lr,wr)|0,vt=Math.imul(lr,Gr),Ct=Ct+Math.imul(Ut,Er)|0,xt=xt+Math.imul(Ut,Wr)|0,xt=xt+Math.imul(Mt,Er)|0,vt=vt+Math.imul(Mt,Wr)|0,Ct=Ct+Math.imul(Gt,Pr)|0,xt=xt+Math.imul(Gt,nn)|0,xt=xt+Math.imul(Wt,Pr)|0,vt=vt+Math.imul(Wt,nn)|0,Ct=Ct+Math.imul(wt,Dr)|0,xt=xt+Math.imul(wt,Qr)|0,xt=xt+Math.imul(qt,Dr)|0,vt=vt+Math.imul(qt,Qr)|0;var dn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(dn>>>26)|0,dn&=67108863,Ct=Math.imul(ir,wr),xt=Math.imul(ir,Gr),xt=xt+Math.imul(Zt,wr)|0,vt=Math.imul(Zt,Gr),Ct=Ct+Math.imul(Yt,Er)|0,xt=xt+Math.imul(Yt,Wr)|0,xt=xt+Math.imul(lr,Er)|0,vt=vt+Math.imul(lr,Wr)|0,Ct=Ct+Math.imul(Ut,Pr)|0,xt=xt+Math.imul(Ut,nn)|0,xt=xt+Math.imul(Mt,Pr)|0,vt=vt+Math.imul(Mt,nn)|0,Ct=Ct+Math.imul(Gt,Dr)|0,xt=xt+Math.imul(Gt,Qr)|0,xt=xt+Math.imul(Wt,Dr)|0,vt=vt+Math.imul(Wt,Qr)|0,Ct=Ct+Math.imul(wt,Cr)|0,xt=xt+Math.imul(wt,Zr)|0,xt=xt+Math.imul(qt,Cr)|0,vt=vt+Math.imul(qt,Zr)|0;var fn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(fn>>>26)|0,fn&=67108863,Ct=Math.imul(Ft,wr),xt=Math.imul(Ft,Gr),xt=xt+Math.imul(zt,wr)|0,vt=Math.imul(zt,Gr),Ct=Ct+Math.imul(ir,Er)|0,xt=xt+Math.imul(ir,Wr)|0,xt=xt+Math.imul(Zt,Er)|0,vt=vt+Math.imul(Zt,Wr)|0,Ct=Ct+Math.imul(Yt,Pr)|0,xt=xt+Math.imul(Yt,nn)|0,xt=xt+Math.imul(lr,Pr)|0,vt=vt+Math.imul(lr,nn)|0,Ct=Ct+Math.imul(Ut,Dr)|0,xt=xt+Math.imul(Ut,Qr)|0,xt=xt+Math.imul(Mt,Dr)|0,vt=vt+Math.imul(Mt,Qr)|0,Ct=Ct+Math.imul(Gt,Cr)|0,xt=xt+Math.imul(Gt,Zr)|0,xt=xt+Math.imul(Wt,Cr)|0,vt=vt+Math.imul(Wt,Zr)|0,Ct=Ct+Math.imul(wt,Ar)|0,xt=xt+Math.imul(wt,Xr)|0,xt=xt+Math.imul(qt,Ar)|0,vt=vt+Math.imul(qt,Xr)|0;var an=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(an>>>26)|0,an&=67108863,Ct=Math.imul(nr,wr),xt=Math.imul(nr,Gr),xt=xt+Math.imul(gr,wr)|0,vt=Math.imul(gr,Gr),Ct=Ct+Math.imul(Ft,Er)|0,xt=xt+Math.imul(Ft,Wr)|0,xt=xt+Math.imul(zt,Er)|0,vt=vt+Math.imul(zt,Wr)|0,Ct=Ct+Math.imul(ir,Pr)|0,xt=xt+Math.imul(ir,nn)|0,xt=xt+Math.imul(Zt,Pr)|0,vt=vt+Math.imul(Zt,nn)|0,Ct=Ct+Math.imul(Yt,Dr)|0,xt=xt+Math.imul(Yt,Qr)|0,xt=xt+Math.imul(lr,Dr)|0,vt=vt+Math.imul(lr,Qr)|0,Ct=Ct+Math.imul(Ut,Cr)|0,xt=xt+Math.imul(Ut,Zr)|0,xt=xt+Math.imul(Mt,Cr)|0,vt=vt+Math.imul(Mt,Zr)|0,Ct=Ct+Math.imul(Gt,Ar)|0,xt=xt+Math.imul(Gt,Xr)|0,xt=xt+Math.imul(Wt,Ar)|0,vt=vt+Math.imul(Wt,Xr)|0,Ct=Ct+Math.imul(wt,Sr)|0,xt=xt+Math.imul(wt,Jr)|0,xt=xt+Math.imul(qt,Sr)|0,vt=vt+Math.imul(qt,Jr)|0;var pn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(pn>>>26)|0,pn&=67108863,Ct=Math.imul(vr,wr),xt=Math.imul(vr,Gr),xt=xt+Math.imul(Nr,wr)|0,vt=Math.imul(Nr,Gr),Ct=Ct+Math.imul(nr,Er)|0,xt=xt+Math.imul(nr,Wr)|0,xt=xt+Math.imul(gr,Er)|0,vt=vt+Math.imul(gr,Wr)|0,Ct=Ct+Math.imul(Ft,Pr)|0,xt=xt+Math.imul(Ft,nn)|0,xt=xt+Math.imul(zt,Pr)|0,vt=vt+Math.imul(zt,nn)|0,Ct=Ct+Math.imul(ir,Dr)|0,xt=xt+Math.imul(ir,Qr)|0,xt=xt+Math.imul(Zt,Dr)|0,vt=vt+Math.imul(Zt,Qr)|0,Ct=Ct+Math.imul(Yt,Cr)|0,xt=xt+Math.imul(Yt,Zr)|0,xt=xt+Math.imul(lr,Cr)|0,vt=vt+Math.imul(lr,Zr)|0,Ct=Ct+Math.imul(Ut,Ar)|0,xt=xt+Math.imul(Ut,Xr)|0,xt=xt+Math.imul(Mt,Ar)|0,vt=vt+Math.imul(Mt,Xr)|0,Ct=Ct+Math.imul(Gt,Sr)|0,xt=xt+Math.imul(Gt,Jr)|0,xt=xt+Math.imul(Wt,Sr)|0,vt=vt+Math.imul(Wt,Jr)|0,Ct=Ct+Math.imul(wt,Rr)|0,xt=xt+Math.imul(wt,en)|0,xt=xt+Math.imul(qt,Rr)|0,vt=vt+Math.imul(qt,en)|0;var _n=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(_n>>>26)|0,_n&=67108863,Ct=Math.imul(er,wr),xt=Math.imul(er,Gr),xt=xt+Math.imul(Xt,wr)|0,vt=Math.imul(Xt,Gr),Ct=Ct+Math.imul(vr,Er)|0,xt=xt+Math.imul(vr,Wr)|0,xt=xt+Math.imul(Nr,Er)|0,vt=vt+Math.imul(Nr,Wr)|0,Ct=Ct+Math.imul(nr,Pr)|0,xt=xt+Math.imul(nr,nn)|0,xt=xt+Math.imul(gr,Pr)|0,vt=vt+Math.imul(gr,nn)|0,Ct=Ct+Math.imul(Ft,Dr)|0,xt=xt+Math.imul(Ft,Qr)|0,xt=xt+Math.imul(zt,Dr)|0,vt=vt+Math.imul(zt,Qr)|0,Ct=Ct+Math.imul(ir,Cr)|0,xt=xt+Math.imul(ir,Zr)|0,xt=xt+Math.imul(Zt,Cr)|0,vt=vt+Math.imul(Zt,Zr)|0,Ct=Ct+Math.imul(Yt,Ar)|0,xt=xt+Math.imul(Yt,Xr)|0,xt=xt+Math.imul(lr,Ar)|0,vt=vt+Math.imul(lr,Xr)|0,Ct=Ct+Math.imul(Ut,Sr)|0,xt=xt+Math.imul(Ut,Jr)|0,xt=xt+Math.imul(Mt,Sr)|0,vt=vt+Math.imul(Mt,Jr)|0,Ct=Ct+Math.imul(Gt,Rr)|0,xt=xt+Math.imul(Gt,en)|0,xt=xt+Math.imul(Wt,Rr)|0,vt=vt+Math.imul(Wt,en)|0,Ct=Ct+Math.imul(wt,Ir)|0,xt=xt+Math.imul(wt,tn)|0,xt=xt+Math.imul(qt,Ir)|0,vt=vt+Math.imul(qt,tn)|0;var Tn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,Ct=Math.imul(ur,wr),xt=Math.imul(ur,Gr),xt=xt+Math.imul(pr,wr)|0,vt=Math.imul(pr,Gr),Ct=Ct+Math.imul(er,Er)|0,xt=xt+Math.imul(er,Wr)|0,xt=xt+Math.imul(Xt,Er)|0,vt=vt+Math.imul(Xt,Wr)|0,Ct=Ct+Math.imul(vr,Pr)|0,xt=xt+Math.imul(vr,nn)|0,xt=xt+Math.imul(Nr,Pr)|0,vt=vt+Math.imul(Nr,nn)|0,Ct=Ct+Math.imul(nr,Dr)|0,xt=xt+Math.imul(nr,Qr)|0,xt=xt+Math.imul(gr,Dr)|0,vt=vt+Math.imul(gr,Qr)|0,Ct=Ct+Math.imul(Ft,Cr)|0,xt=xt+Math.imul(Ft,Zr)|0,xt=xt+Math.imul(zt,Cr)|0,vt=vt+Math.imul(zt,Zr)|0,Ct=Ct+Math.imul(ir,Ar)|0,xt=xt+Math.imul(ir,Xr)|0,xt=xt+Math.imul(Zt,Ar)|0,vt=vt+Math.imul(Zt,Xr)|0,Ct=Ct+Math.imul(Yt,Sr)|0,xt=xt+Math.imul(Yt,Jr)|0,xt=xt+Math.imul(lr,Sr)|0,vt=vt+Math.imul(lr,Jr)|0,Ct=Ct+Math.imul(Ut,Rr)|0,xt=xt+Math.imul(Ut,en)|0,xt=xt+Math.imul(Mt,Rr)|0,vt=vt+Math.imul(Mt,en)|0,Ct=Ct+Math.imul(Gt,Ir)|0,xt=xt+Math.imul(Gt,tn)|0,xt=xt+Math.imul(Wt,Ir)|0,vt=vt+Math.imul(Wt,tn)|0,Ct=Ct+Math.imul(wt,Lr)|0,xt=xt+Math.imul(wt,sn)|0,xt=xt+Math.imul(qt,Lr)|0,vt=vt+Math.imul(qt,sn)|0;var gn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(gn>>>26)|0,gn&=67108863,Ct=Math.imul(ur,Er),xt=Math.imul(ur,Wr),xt=xt+Math.imul(pr,Er)|0,vt=Math.imul(pr,Wr),Ct=Ct+Math.imul(er,Pr)|0,xt=xt+Math.imul(er,nn)|0,xt=xt+Math.imul(Xt,Pr)|0,vt=vt+Math.imul(Xt,nn)|0,Ct=Ct+Math.imul(vr,Dr)|0,xt=xt+Math.imul(vr,Qr)|0,xt=xt+Math.imul(Nr,Dr)|0,vt=vt+Math.imul(Nr,Qr)|0,Ct=Ct+Math.imul(nr,Cr)|0,xt=xt+Math.imul(nr,Zr)|0,xt=xt+Math.imul(gr,Cr)|0,vt=vt+Math.imul(gr,Zr)|0,Ct=Ct+Math.imul(Ft,Ar)|0,xt=xt+Math.imul(Ft,Xr)|0,xt=xt+Math.imul(zt,Ar)|0,vt=vt+Math.imul(zt,Xr)|0,Ct=Ct+Math.imul(ir,Sr)|0,xt=xt+Math.imul(ir,Jr)|0,xt=xt+Math.imul(Zt,Sr)|0,vt=vt+Math.imul(Zt,Jr)|0,Ct=Ct+Math.imul(Yt,Rr)|0,xt=xt+Math.imul(Yt,en)|0,xt=xt+Math.imul(lr,Rr)|0,vt=vt+Math.imul(lr,en)|0,Ct=Ct+Math.imul(Ut,Ir)|0,xt=xt+Math.imul(Ut,tn)|0,xt=xt+Math.imul(Mt,Ir)|0,vt=vt+Math.imul(Mt,tn)|0,Ct=Ct+Math.imul(Gt,Lr)|0,xt=xt+Math.imul(Gt,sn)|0,xt=xt+Math.imul(Wt,Lr)|0,vt=vt+Math.imul(Wt,sn)|0;var En=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(En>>>26)|0,En&=67108863,Ct=Math.imul(ur,Pr),xt=Math.imul(ur,nn),xt=xt+Math.imul(pr,Pr)|0,vt=Math.imul(pr,nn),Ct=Ct+Math.imul(er,Dr)|0,xt=xt+Math.imul(er,Qr)|0,xt=xt+Math.imul(Xt,Dr)|0,vt=vt+Math.imul(Xt,Qr)|0,Ct=Ct+Math.imul(vr,Cr)|0,xt=xt+Math.imul(vr,Zr)|0,xt=xt+Math.imul(Nr,Cr)|0,vt=vt+Math.imul(Nr,Zr)|0,Ct=Ct+Math.imul(nr,Ar)|0,xt=xt+Math.imul(nr,Xr)|0,xt=xt+Math.imul(gr,Ar)|0,vt=vt+Math.imul(gr,Xr)|0,Ct=Ct+Math.imul(Ft,Sr)|0,xt=xt+Math.imul(Ft,Jr)|0,xt=xt+Math.imul(zt,Sr)|0,vt=vt+Math.imul(zt,Jr)|0,Ct=Ct+Math.imul(ir,Rr)|0,xt=xt+Math.imul(ir,en)|0,xt=xt+Math.imul(Zt,Rr)|0,vt=vt+Math.imul(Zt,en)|0,Ct=Ct+Math.imul(Yt,Ir)|0,xt=xt+Math.imul(Yt,tn)|0,xt=xt+Math.imul(lr,Ir)|0,vt=vt+Math.imul(lr,tn)|0,Ct=Ct+Math.imul(Ut,Lr)|0,xt=xt+Math.imul(Ut,sn)|0,xt=xt+Math.imul(Mt,Lr)|0,vt=vt+Math.imul(Mt,sn)|0;var Cn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,Ct=Math.imul(ur,Dr),xt=Math.imul(ur,Qr),xt=xt+Math.imul(pr,Dr)|0,vt=Math.imul(pr,Qr),Ct=Ct+Math.imul(er,Cr)|0,xt=xt+Math.imul(er,Zr)|0,xt=xt+Math.imul(Xt,Cr)|0,vt=vt+Math.imul(Xt,Zr)|0,Ct=Ct+Math.imul(vr,Ar)|0,xt=xt+Math.imul(vr,Xr)|0,xt=xt+Math.imul(Nr,Ar)|0,vt=vt+Math.imul(Nr,Xr)|0,Ct=Ct+Math.imul(nr,Sr)|0,xt=xt+Math.imul(nr,Jr)|0,xt=xt+Math.imul(gr,Sr)|0,vt=vt+Math.imul(gr,Jr)|0,Ct=Ct+Math.imul(Ft,Rr)|0,xt=xt+Math.imul(Ft,en)|0,xt=xt+Math.imul(zt,Rr)|0,vt=vt+Math.imul(zt,en)|0,Ct=Ct+Math.imul(ir,Ir)|0,xt=xt+Math.imul(ir,tn)|0,xt=xt+Math.imul(Zt,Ir)|0,vt=vt+Math.imul(Zt,tn)|0,Ct=Ct+Math.imul(Yt,Lr)|0,xt=xt+Math.imul(Yt,sn)|0,xt=xt+Math.imul(lr,Lr)|0,vt=vt+Math.imul(lr,sn)|0;var mn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(mn>>>26)|0,mn&=67108863,Ct=Math.imul(ur,Cr),xt=Math.imul(ur,Zr),xt=xt+Math.imul(pr,Cr)|0,vt=Math.imul(pr,Zr),Ct=Ct+Math.imul(er,Ar)|0,xt=xt+Math.imul(er,Xr)|0,xt=xt+Math.imul(Xt,Ar)|0,vt=vt+Math.imul(Xt,Xr)|0,Ct=Ct+Math.imul(vr,Sr)|0,xt=xt+Math.imul(vr,Jr)|0,xt=xt+Math.imul(Nr,Sr)|0,vt=vt+Math.imul(Nr,Jr)|0,Ct=Ct+Math.imul(nr,Rr)|0,xt=xt+Math.imul(nr,en)|0,xt=xt+Math.imul(gr,Rr)|0,vt=vt+Math.imul(gr,en)|0,Ct=Ct+Math.imul(Ft,Ir)|0,xt=xt+Math.imul(Ft,tn)|0,xt=xt+Math.imul(zt,Ir)|0,vt=vt+Math.imul(zt,tn)|0,Ct=Ct+Math.imul(ir,Lr)|0,xt=xt+Math.imul(ir,sn)|0,xt=xt+Math.imul(Zt,Lr)|0,vt=vt+Math.imul(Zt,sn)|0;var xn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(xn>>>26)|0,xn&=67108863,Ct=Math.imul(ur,Ar),xt=Math.imul(ur,Xr),xt=xt+Math.imul(pr,Ar)|0,vt=Math.imul(pr,Xr),Ct=Ct+Math.imul(er,Sr)|0,xt=xt+Math.imul(er,Jr)|0,xt=xt+Math.imul(Xt,Sr)|0,vt=vt+Math.imul(Xt,Jr)|0,Ct=Ct+Math.imul(vr,Rr)|0,xt=xt+Math.imul(vr,en)|0,xt=xt+Math.imul(Nr,Rr)|0,vt=vt+Math.imul(Nr,en)|0,Ct=Ct+Math.imul(nr,Ir)|0,xt=xt+Math.imul(nr,tn)|0,xt=xt+Math.imul(gr,Ir)|0,vt=vt+Math.imul(gr,tn)|0,Ct=Ct+Math.imul(Ft,Lr)|0,xt=xt+Math.imul(Ft,sn)|0,xt=xt+Math.imul(zt,Lr)|0,vt=vt+Math.imul(zt,sn)|0;var An=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(An>>>26)|0,An&=67108863,Ct=Math.imul(ur,Sr),xt=Math.imul(ur,Jr),xt=xt+Math.imul(pr,Sr)|0,vt=Math.imul(pr,Jr),Ct=Ct+Math.imul(er,Rr)|0,xt=xt+Math.imul(er,en)|0,xt=xt+Math.imul(Xt,Rr)|0,vt=vt+Math.imul(Xt,en)|0,Ct=Ct+Math.imul(vr,Ir)|0,xt=xt+Math.imul(vr,tn)|0,xt=xt+Math.imul(Nr,Ir)|0,vt=vt+Math.imul(Nr,tn)|0,Ct=Ct+Math.imul(nr,Lr)|0,xt=xt+Math.imul(nr,sn)|0,xt=xt+Math.imul(gr,Lr)|0,vt=vt+Math.imul(gr,sn)|0;var $n=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+($n>>>26)|0,$n&=67108863,Ct=Math.imul(ur,Rr),xt=Math.imul(ur,en),xt=xt+Math.imul(pr,Rr)|0,vt=Math.imul(pr,en),Ct=Ct+Math.imul(er,Ir)|0,xt=xt+Math.imul(er,tn)|0,xt=xt+Math.imul(Xt,Ir)|0,vt=vt+Math.imul(Xt,tn)|0,Ct=Ct+Math.imul(vr,Lr)|0,xt=xt+Math.imul(vr,sn)|0,xt=xt+Math.imul(Nr,Lr)|0,vt=vt+Math.imul(Nr,sn)|0;var Rn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,Ct=Math.imul(ur,Ir),xt=Math.imul(ur,tn),xt=xt+Math.imul(pr,Ir)|0,vt=Math.imul(pr,tn),Ct=Ct+Math.imul(er,Lr)|0,xt=xt+Math.imul(er,sn)|0,xt=xt+Math.imul(Xt,Lr)|0,vt=vt+Math.imul(Xt,sn)|0;var Sn=($t+Ct|0)+((xt&8191)<<13)|0;$t=(vt+(xt>>>13)|0)+(Sn>>>26)|0,Sn&=67108863,Ct=Math.imul(ur,Lr),xt=Math.imul(ur,sn),xt=xt+Math.imul(pr,Lr)|0,vt=Math.imul(pr,sn);var In=($t+Ct|0)+((xt&8191)<<13)|0;return $t=(vt+(xt>>>13)|0)+(In>>>26)|0,In&=67108863,_t[0]=Hr,_t[1]=jr,_t[2]=un,_t[3]=dn,_t[4]=fn,_t[5]=an,_t[6]=pn,_t[7]=_n,_t[8]=Tn,_t[9]=gn,_t[10]=En,_t[11]=Cn,_t[12]=mn,_t[13]=xn,_t[14]=An,_t[15]=$n,_t[16]=Rn,_t[17]=Sn,_t[18]=In,$t!==0&&(_t[19]=$t,lt.length++),lt};Math.imul||(ht=ft);function mt(Nt,It,yt){yt.negative=It.negative^Nt.negative,yt.length=Nt.length+It.length;for(var lt=0,pt=0,bt=0;bt<yt.length-1;bt++){var _t=pt;pt=0;for(var $t=lt&67108863,Ct=Math.min(bt,It.length-1),xt=Math.max(0,bt-Nt.length+1);xt<=Ct;xt++){var vt=bt-xt,dt=Nt.words[vt]|0,wt=It.words[xt]|0,qt=dt*wt,Pt=qt&67108863;_t=_t+(qt/67108864|0)|0,Pt=Pt+$t|0,$t=Pt&67108863,_t=_t+(Pt>>>26)|0,pt+=_t>>>26,_t&=67108863}yt.words[bt]=$t,lt=_t,_t=pt}return lt!==0?yt.words[bt]=lt:yt.length--,yt.strip()}function gt(Nt,It,yt){var lt=new Et;return lt.mulp(Nt,It,yt)}tt.prototype.mulTo=function(It,yt){var lt,pt=this.length+It.length;return this.length===10&&It.length===10?lt=ht(this,It,yt):pt<63?lt=ft(this,It,yt):pt<1024?lt=mt(this,It,yt):lt=gt(this,It,yt),lt};function Et(Nt,It){this.x=Nt,this.y=It}Et.prototype.makeRBT=function(It){for(var yt=new Array(It),lt=tt.prototype._countBits(It)-1,pt=0;pt<It;pt++)yt[pt]=this.revBin(pt,lt,It);return yt},Et.prototype.revBin=function(It,yt,lt){if(It===0||It===lt-1)return It;for(var pt=0,bt=0;bt<yt;bt++)pt|=(It&1)<<yt-bt-1,It>>=1;return pt},Et.prototype.permute=function(It,yt,lt,pt,bt,_t){for(var $t=0;$t<_t;$t++)pt[$t]=yt[It[$t]],bt[$t]=lt[It[$t]]},Et.prototype.transform=function(It,yt,lt,pt,bt,_t){this.permute(_t,It,yt,lt,pt,bt);for(var $t=1;$t<bt;$t<<=1)for(var Ct=$t<<1,xt=Math.cos(2*Math.PI/Ct),vt=Math.sin(2*Math.PI/Ct),dt=0;dt<bt;dt+=Ct)for(var wt=xt,qt=vt,Pt=0;Pt<$t;Pt++){var Gt=lt[dt+Pt],Wt=pt[dt+Pt],Vt=lt[dt+Pt+$t],Ut=pt[dt+Pt+$t],Mt=wt*Vt-qt*Ut;Ut=wt*Ut+qt*Vt,Vt=Mt,lt[dt+Pt]=Gt+Vt,pt[dt+Pt]=Wt+Ut,lt[dt+Pt+$t]=Gt-Vt,pt[dt+Pt+$t]=Wt-Ut,Pt!==Ct&&(Mt=xt*wt-vt*qt,qt=xt*qt+vt*wt,wt=Mt)}},Et.prototype.guessLen13b=function(It,yt){var lt=Math.max(yt,It)|1,pt=lt&1,bt=0;for(lt=lt/2|0;lt;lt=lt>>>1)bt++;return 1<<bt+1+pt},Et.prototype.conjugate=function(It,yt,lt){if(!(lt<=1))for(var pt=0;pt<lt/2;pt++){var bt=It[pt];It[pt]=It[lt-pt-1],It[lt-pt-1]=bt,bt=yt[pt],yt[pt]=-yt[lt-pt-1],yt[lt-pt-1]=-bt}},Et.prototype.normalize13b=function(It,yt){for(var lt=0,pt=0;pt<yt/2;pt++){var bt=Math.round(It[2*pt+1]/yt)*8192+Math.round(It[2*pt]/yt)+lt;It[pt]=bt&67108863,bt<67108864?lt=0:lt=bt/67108864|0}return It},Et.prototype.convert13b=function(It,yt,lt,pt){for(var bt=0,_t=0;_t<yt;_t++)bt=bt+(It[_t]|0),lt[2*_t]=bt&8191,bt=bt>>>13,lt[2*_t+1]=bt&8191,bt=bt>>>13;for(_t=2*yt;_t<pt;++_t)lt[_t]=0;j(bt===0),j((bt&-8192)===0)},Et.prototype.stub=function(It){for(var yt=new Array(It),lt=0;lt<It;lt++)yt[lt]=0;return yt},Et.prototype.mulp=function(It,yt,lt){var pt=2*this.guessLen13b(It.length,yt.length),bt=this.makeRBT(pt),_t=this.stub(pt),$t=new Array(pt),Ct=new Array(pt),xt=new Array(pt),vt=new Array(pt),dt=new Array(pt),wt=new Array(pt),qt=lt.words;qt.length=pt,this.convert13b(It.words,It.length,$t,pt),this.convert13b(yt.words,yt.length,vt,pt),this.transform($t,_t,Ct,xt,pt,bt),this.transform(vt,_t,dt,wt,pt,bt);for(var Pt=0;Pt<pt;Pt++){var Gt=Ct[Pt]*dt[Pt]-xt[Pt]*wt[Pt];xt[Pt]=Ct[Pt]*wt[Pt]+xt[Pt]*dt[Pt],Ct[Pt]=Gt}return this.conjugate(Ct,xt,pt),this.transform(Ct,xt,qt,_t,pt,bt),this.conjugate(qt,_t,pt),this.normalize13b(qt,pt),lt.negative=It.negative^yt.negative,lt.length=It.length+yt.length,lt.strip()},tt.prototype.mul=function(It){var yt=new tt(null);return yt.words=new Array(this.length+It.length),this.mulTo(It,yt)},tt.prototype.mulf=function(It){var yt=new tt(null);return yt.words=new Array(this.length+It.length),gt(this,It,yt)},tt.prototype.imul=function(It){return this.clone().mulTo(It,this)},tt.prototype.imuln=function(It){j(typeof It=="number"),j(It<67108864);for(var yt=0,lt=0;lt<this.length;lt++){var pt=(this.words[lt]|0)*It,bt=(pt&67108863)+(yt&67108863);yt>>=26,yt+=pt/67108864|0,yt+=bt>>>26,this.words[lt]=bt&67108863}return yt!==0&&(this.words[lt]=yt,this.length++),this},tt.prototype.muln=function(It){return this.clone().imuln(It)},tt.prototype.sqr=function(){return this.mul(this)},tt.prototype.isqr=function(){return this.imul(this.clone())},tt.prototype.pow=function(It){var yt=ut(It);if(yt.length===0)return new tt(1);for(var lt=this,pt=0;pt<yt.length&&yt[pt]===0;pt++,lt=lt.sqr());if(++pt<yt.length)for(var bt=lt.sqr();pt<yt.length;pt++,bt=bt.sqr())yt[pt]!==0&&(lt=lt.mul(bt));return lt},tt.prototype.iushln=function(It){j(typeof It=="number"&&It>=0);var yt=It%26,lt=(It-yt)/26,pt=67108863>>>26-yt<<26-yt,bt;if(yt!==0){var _t=0;for(bt=0;bt<this.length;bt++){var $t=this.words[bt]&pt,Ct=(this.words[bt]|0)-$t<<yt;this.words[bt]=Ct|_t,_t=$t>>>26-yt}_t&&(this.words[bt]=_t,this.length++)}if(lt!==0){for(bt=this.length-1;bt>=0;bt--)this.words[bt+lt]=this.words[bt];for(bt=0;bt<lt;bt++)this.words[bt]=0;this.length+=lt}return this.strip()},tt.prototype.ishln=function(It){return j(this.negative===0),this.iushln(It)},tt.prototype.iushrn=function(It,yt,lt){j(typeof It=="number"&&It>=0);var pt;yt?pt=(yt-yt%26)/26:pt=0;var bt=It%26,_t=Math.min((It-bt)/26,this.length),$t=67108863^67108863>>>bt<<bt,Ct=lt;if(pt-=_t,pt=Math.max(0,pt),Ct){for(var xt=0;xt<_t;xt++)Ct.words[xt]=this.words[xt];Ct.length=_t}if(_t!==0)if(this.length>_t)for(this.length-=_t,xt=0;xt<this.length;xt++)this.words[xt]=this.words[xt+_t];else this.words[0]=0,this.length=1;var vt=0;for(xt=this.length-1;xt>=0&&(vt!==0||xt>=pt);xt--){var dt=this.words[xt]|0;this.words[xt]=vt<<26-bt|dt>>>bt,vt=dt&$t}return Ct&&vt!==0&&(Ct.words[Ct.length++]=vt),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},tt.prototype.ishrn=function(It,yt,lt){return j(this.negative===0),this.iushrn(It,yt,lt)},tt.prototype.shln=function(It){return this.clone().ishln(It)},tt.prototype.ushln=function(It){return this.clone().iushln(It)},tt.prototype.shrn=function(It){return this.clone().ishrn(It)},tt.prototype.ushrn=function(It){return this.clone().iushrn(It)},tt.prototype.testn=function(It){j(typeof It=="number"&&It>=0);var yt=It%26,lt=(It-yt)/26,pt=1<<yt;if(this.length<=lt)return!1;var bt=this.words[lt];return!!(bt&pt)},tt.prototype.imaskn=function(It){j(typeof It=="number"&&It>=0);var yt=It%26,lt=(It-yt)/26;if(j(this.negative===0,"imaskn works only with positive numbers"),this.length<=lt)return this;if(yt!==0&&lt++,this.length=Math.min(lt,this.length),yt!==0){var pt=67108863^67108863>>>yt<<yt;this.words[this.length-1]&=pt}return this.strip()},tt.prototype.maskn=function(It){return this.clone().imaskn(It)},tt.prototype.iaddn=function(It){return j(typeof It=="number"),j(It<67108864),It<0?this.isubn(-It):this.negative!==0?this.length===1&&(this.words[0]|0)<It?(this.words[0]=It-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(It),this.negative=1,this):this._iaddn(It)},tt.prototype._iaddn=function(It){this.words[0]+=It;for(var yt=0;yt<this.length&&this.words[yt]>=67108864;yt++)this.words[yt]-=67108864,yt===this.length-1?this.words[yt+1]=1:this.words[yt+1]++;return this.length=Math.max(this.length,yt+1),this},tt.prototype.isubn=function(It){if(j(typeof It=="number"),j(It<67108864),It<0)return this.iaddn(-It);if(this.negative!==0)return this.negative=0,this.iaddn(It),this.negative=1,this;if(this.words[0]-=It,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var yt=0;yt<this.length&&this.words[yt]<0;yt++)this.words[yt]+=67108864,this.words[yt+1]-=1;return this.strip()},tt.prototype.addn=function(It){return this.clone().iaddn(It)},tt.prototype.subn=function(It){return this.clone().isubn(It)},tt.prototype.iabs=function(){return this.negative=0,this},tt.prototype.abs=function(){return this.clone().iabs()},tt.prototype._ishlnsubmul=function(It,yt,lt){var pt=It.length+lt,bt;this._expand(pt);var _t,$t=0;for(bt=0;bt<It.length;bt++){_t=(this.words[bt+lt]|0)+$t;var Ct=(It.words[bt]|0)*yt;_t-=Ct&67108863,$t=(_t>>26)-(Ct/67108864|0),this.words[bt+lt]=_t&67108863}for(;bt<this.length-lt;bt++)_t=(this.words[bt+lt]|0)+$t,$t=_t>>26,this.words[bt+lt]=_t&67108863;if($t===0)return this.strip();for(j($t===-1),$t=0,bt=0;bt<this.length;bt++)_t=-(this.words[bt]|0)+$t,$t=_t>>26,this.words[bt]=_t&67108863;return this.negative=1,this.strip()},tt.prototype._wordDiv=function(It,yt){var lt=this.length-It.length,pt=this.clone(),bt=It,_t=bt.words[bt.length-1]|0,$t=this._countBits(_t);lt=26-$t,lt!==0&&(bt=bt.ushln(lt),pt.iushln(lt),_t=bt.words[bt.length-1]|0);var Ct=pt.length-bt.length,xt;if(yt!=="mod"){xt=new tt(null),xt.length=Ct+1,xt.words=new Array(xt.length);for(var vt=0;vt<xt.length;vt++)xt.words[vt]=0}var dt=pt.clone()._ishlnsubmul(bt,1,Ct);dt.negative===0&&(pt=dt,xt&&(xt.words[Ct]=1));for(var wt=Ct-1;wt>=0;wt--){var qt=(pt.words[bt.length+wt]|0)*67108864+(pt.words[bt.length+wt-1]|0);for(qt=Math.min(qt/_t|0,67108863),pt._ishlnsubmul(bt,qt,wt);pt.negative!==0;)qt--,pt.negative=0,pt._ishlnsubmul(bt,1,wt),pt.isZero()||(pt.negative^=1);xt&&(xt.words[wt]=qt)}return xt&&xt.strip(),pt.strip(),yt!=="div"&&lt!==0&&pt.iushrn(lt),{div:xt||null,mod:pt}},tt.prototype.divmod=function(It,yt,lt){if(j(!It.isZero()),this.isZero())return{div:new tt(0),mod:new tt(0)};var pt,bt,_t;return this.negative!==0&&It.negative===0?(_t=this.neg().divmod(It,yt),yt!=="mod"&&(pt=_t.div.neg()),yt!=="div"&&(bt=_t.mod.neg(),lt&&bt.negative!==0&&bt.iadd(It)),{div:pt,mod:bt}):this.negative===0&&It.negative!==0?(_t=this.divmod(It.neg(),yt),yt!=="mod"&&(pt=_t.div.neg()),{div:pt,mod:_t.mod}):this.negative&It.negative?(_t=this.neg().divmod(It.neg(),yt),yt!=="div"&&(bt=_t.mod.neg(),lt&&bt.negative!==0&&bt.isub(It)),{div:_t.div,mod:bt}):It.length>this.length||this.cmp(It)<0?{div:new tt(0),mod:this}:It.length===1?yt==="div"?{div:this.divn(It.words[0]),mod:null}:yt==="mod"?{div:null,mod:new tt(this.modn(It.words[0]))}:{div:this.divn(It.words[0]),mod:new tt(this.modn(It.words[0]))}:this._wordDiv(It,yt)},tt.prototype.div=function(It){return this.divmod(It,"div",!1).div},tt.prototype.mod=function(It){return this.divmod(It,"mod",!1).mod},tt.prototype.umod=function(It){return this.divmod(It,"mod",!0).mod},tt.prototype.divRound=function(It){var yt=this.divmod(It);if(yt.mod.isZero())return yt.div;var lt=yt.div.negative!==0?yt.mod.isub(It):yt.mod,pt=It.ushrn(1),bt=It.andln(1),_t=lt.cmp(pt);return _t<0||bt===1&&_t===0?yt.div:yt.div.negative!==0?yt.div.isubn(1):yt.div.iaddn(1)},tt.prototype.modn=function(It){j(It<=67108863);for(var yt=(1<<26)%It,lt=0,pt=this.length-1;pt>=0;pt--)lt=(yt*lt+(this.words[pt]|0))%It;return lt},tt.prototype.idivn=function(It){j(It<=67108863);for(var yt=0,lt=this.length-1;lt>=0;lt--){var pt=(this.words[lt]|0)+yt*67108864;this.words[lt]=pt/It|0,yt=pt%It}return this.strip()},tt.prototype.divn=function(It){return this.clone().idivn(It)},tt.prototype.egcd=function(It){j(It.negative===0),j(!It.isZero());var yt=this,lt=It.clone();yt.negative!==0?yt=yt.umod(It):yt=yt.clone();for(var pt=new tt(1),bt=new tt(0),_t=new tt(0),$t=new tt(1),Ct=0;yt.isEven()&&lt.isEven();)yt.iushrn(1),lt.iushrn(1),++Ct;for(var xt=lt.clone(),vt=yt.clone();!yt.isZero();){for(var dt=0,wt=1;!(yt.words[0]&wt)&&dt<26;++dt,wt<<=1);if(dt>0)for(yt.iushrn(dt);dt-- >0;)(pt.isOdd()||bt.isOdd())&&(pt.iadd(xt),bt.isub(vt)),pt.iushrn(1),bt.iushrn(1);for(var qt=0,Pt=1;!(lt.words[0]&Pt)&&qt<26;++qt,Pt<<=1);if(qt>0)for(lt.iushrn(qt);qt-- >0;)(_t.isOdd()||$t.isOdd())&&(_t.iadd(xt),$t.isub(vt)),_t.iushrn(1),$t.iushrn(1);yt.cmp(lt)>=0?(yt.isub(lt),pt.isub(_t),bt.isub($t)):(lt.isub(yt),_t.isub(pt),$t.isub(bt))}return{a:_t,b:$t,gcd:lt.iushln(Ct)}},tt.prototype._invmp=function(It){j(It.negative===0),j(!It.isZero());var yt=this,lt=It.clone();yt.negative!==0?yt=yt.umod(It):yt=yt.clone();for(var pt=new tt(1),bt=new tt(0),_t=lt.clone();yt.cmpn(1)>0&&lt.cmpn(1)>0;){for(var $t=0,Ct=1;!(yt.words[0]&Ct)&&$t<26;++$t,Ct<<=1);if($t>0)for(yt.iushrn($t);$t-- >0;)pt.isOdd()&&pt.iadd(_t),pt.iushrn(1);for(var xt=0,vt=1;!(lt.words[0]&vt)&&xt<26;++xt,vt<<=1);if(xt>0)for(lt.iushrn(xt);xt-- >0;)bt.isOdd()&&bt.iadd(_t),bt.iushrn(1);yt.cmp(lt)>=0?(yt.isub(lt),pt.isub(bt)):(lt.isub(yt),bt.isub(pt))}var dt;return yt.cmpn(1)===0?dt=pt:dt=bt,dt.cmpn(0)<0&&dt.iadd(It),dt},tt.prototype.gcd=function(It){if(this.isZero())return It.abs();if(It.isZero())return this.abs();var yt=this.clone(),lt=It.clone();yt.negative=0,lt.negative=0;for(var pt=0;yt.isEven()&&lt.isEven();pt++)yt.iushrn(1),lt.iushrn(1);do{for(;yt.isEven();)yt.iushrn(1);for(;lt.isEven();)lt.iushrn(1);var bt=yt.cmp(lt);if(bt<0){var _t=yt;yt=lt,lt=_t}else if(bt===0||lt.cmpn(1)===0)break;yt.isub(lt)}while(!0);return lt.iushln(pt)},tt.prototype.invm=function(It){return this.egcd(It).a.umod(It)},tt.prototype.isEven=function(){return(this.words[0]&1)===0},tt.prototype.isOdd=function(){return(this.words[0]&1)===1},tt.prototype.andln=function(It){return this.words[0]&It},tt.prototype.bincn=function(It){j(typeof It=="number");var yt=It%26,lt=(It-yt)/26,pt=1<<yt;if(this.length<=lt)return this._expand(lt+1),this.words[lt]|=pt,this;for(var bt=pt,_t=lt;bt!==0&&_t<this.length;_t++){var $t=this.words[_t]|0;$t+=bt,bt=$t>>>26,$t&=67108863,this.words[_t]=$t}return bt!==0&&(this.words[_t]=bt,this.length++),this},tt.prototype.isZero=function(){return this.length===1&&this.words[0]===0},tt.prototype.cmpn=function(It){var yt=It<0;if(this.negative!==0&&!yt)return-1;if(this.negative===0&&yt)return 1;this.strip();var lt;if(this.length>1)lt=1;else{yt&&(It=-It),j(It<=67108863,"Number is too big");var pt=this.words[0]|0;lt=pt===It?0:pt<It?-1:1}return this.negative!==0?-lt|0:lt},tt.prototype.cmp=function(It){if(this.negative!==0&&It.negative===0)return-1;if(this.negative===0&&It.negative!==0)return 1;var yt=this.ucmp(It);return this.negative!==0?-yt|0:yt},tt.prototype.ucmp=function(It){if(this.length>It.length)return 1;if(this.length<It.length)return-1;for(var yt=0,lt=this.length-1;lt>=0;lt--){var pt=this.words[lt]|0,bt=It.words[lt]|0;if(pt!==bt){pt<bt?yt=-1:pt>bt&&(yt=1);break}}return yt},tt.prototype.gtn=function(It){return this.cmpn(It)===1},tt.prototype.gt=function(It){return this.cmp(It)===1},tt.prototype.gten=function(It){return this.cmpn(It)>=0},tt.prototype.gte=function(It){return this.cmp(It)>=0},tt.prototype.ltn=function(It){return this.cmpn(It)===-1},tt.prototype.lt=function(It){return this.cmp(It)===-1},tt.prototype.lten=function(It){return this.cmpn(It)<=0},tt.prototype.lte=function(It){return this.cmp(It)<=0},tt.prototype.eqn=function(It){return this.cmpn(It)===0},tt.prototype.eq=function(It){return this.cmp(It)===0},tt.red=function(It){return new Ot(It)},tt.prototype.toRed=function(It){return j(!this.red,"Already a number in reduction context"),j(this.negative===0,"red works only with positives"),It.convertTo(this)._forceRed(It)},tt.prototype.fromRed=function(){return j(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},tt.prototype._forceRed=function(It){return this.red=It,this},tt.prototype.forceRed=function(It){return j(!this.red,"Already a number in reduction context"),this._forceRed(It)},tt.prototype.redAdd=function(It){return j(this.red,"redAdd works only with red numbers"),this.red.add(this,It)},tt.prototype.redIAdd=function(It){return j(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,It)},tt.prototype.redSub=function(It){return j(this.red,"redSub works only with red numbers"),this.red.sub(this,It)},tt.prototype.redISub=function(It){return j(this.red,"redISub works only with red numbers"),this.red.isub(this,It)},tt.prototype.redShl=function(It){return j(this.red,"redShl works only with red numbers"),this.red.shl(this,It)},tt.prototype.redMul=function(It){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,It),this.red.mul(this,It)},tt.prototype.redIMul=function(It){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,It),this.red.imul(this,It)},tt.prototype.redSqr=function(){return j(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},tt.prototype.redISqr=function(){return j(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},tt.prototype.redSqrt=function(){return j(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},tt.prototype.redInvm=function(){return j(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},tt.prototype.redNeg=function(){return j(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},tt.prototype.redPow=function(It){return j(this.red&&!It.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,It)};var St={k256:null,p224:null,p192:null,p25519:null};function At(Nt,It){this.name=Nt,this.p=new tt(It,16),this.n=this.p.bitLength(),this.k=new tt(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}At.prototype._tmp=function(){var It=new tt(null);return It.words=new Array(Math.ceil(this.n/13)),It},At.prototype.ireduce=function(It){var yt=It,lt;do this.split(yt,this.tmp),yt=this.imulK(yt),yt=yt.iadd(this.tmp),lt=yt.bitLength();while(lt>this.n);var pt=lt<this.n?-1:yt.ucmp(this.p);return pt===0?(yt.words[0]=0,yt.length=1):pt>0?yt.isub(this.p):yt.strip!==void 0?yt.strip():yt._strip(),yt},At.prototype.split=function(It,yt){It.iushrn(this.n,0,yt)},At.prototype.imulK=function(It){return It.imul(this.k)};function kt(){At.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}et(kt,At),kt.prototype.split=function(It,yt){for(var lt=4194303,pt=Math.min(It.length,9),bt=0;bt<pt;bt++)yt.words[bt]=It.words[bt];if(yt.length=pt,It.length<=9){It.words[0]=0,It.length=1;return}var _t=It.words[9];for(yt.words[yt.length++]=_t&lt,bt=10;bt<It.length;bt++){var $t=It.words[bt]|0;It.words[bt-10]=($t&lt)<<4|_t>>>22,_t=$t}_t>>>=22,It.words[bt-10]=_t,_t===0&&It.length>10?It.length-=10:It.length-=9},kt.prototype.imulK=function(It){It.words[It.length]=0,It.words[It.length+1]=0,It.length+=2;for(var yt=0,lt=0;lt<It.length;lt++){var pt=It.words[lt]|0;yt+=pt*977,It.words[lt]=yt&67108863,yt=pt*64+(yt/67108864|0)}return It.words[It.length-1]===0&&(It.length--,It.words[It.length-1]===0&&It.length--),It};function Rt(){At.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}et(Rt,At);function Tt(){At.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}et(Tt,At);function Dt(){At.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}et(Dt,At),Dt.prototype.imulK=function(It){for(var yt=0,lt=0;lt<It.length;lt++){var pt=(It.words[lt]|0)*19+yt,bt=pt&67108863;pt>>>=26,It.words[lt]=bt,yt=pt}return yt!==0&&(It.words[It.length++]=yt),It},tt._prime=function(It){if(St[It])return St[It];var yt;if(It==="k256")yt=new kt;else if(It==="p224")yt=new Rt;else if(It==="p192")yt=new Tt;else if(It==="p25519")yt=new Dt;else throw new Error("Unknown prime "+It);return St[It]=yt,yt};function Ot(Nt){if(typeof Nt=="string"){var It=tt._prime(Nt);this.m=It.p,this.prime=It}else j(Nt.gtn(1),"modulus must be greater than 1"),this.m=Nt,this.prime=null}Ot.prototype._verify1=function(It){j(It.negative===0,"red works only with positives"),j(It.red,"red works only with red numbers")},Ot.prototype._verify2=function(It,yt){j((It.negative|yt.negative)===0,"red works only with positives"),j(It.red&&It.red===yt.red,"red works only with red numbers")},Ot.prototype.imod=function(It){return this.prime?this.prime.ireduce(It)._forceRed(this):It.umod(this.m)._forceRed(this)},Ot.prototype.neg=function(It){return It.isZero()?It.clone():this.m.sub(It)._forceRed(this)},Ot.prototype.add=function(It,yt){this._verify2(It,yt);var lt=It.add(yt);return lt.cmp(this.m)>=0&&lt.isub(this.m),lt._forceRed(this)},Ot.prototype.iadd=function(It,yt){this._verify2(It,yt);var lt=It.iadd(yt);return lt.cmp(this.m)>=0&&lt.isub(this.m),lt},Ot.prototype.sub=function(It,yt){this._verify2(It,yt);var lt=It.sub(yt);return lt.cmpn(0)<0&&lt.iadd(this.m),lt._forceRed(this)},Ot.prototype.isub=function(It,yt){this._verify2(It,yt);var lt=It.isub(yt);return lt.cmpn(0)<0&&lt.iadd(this.m),lt},Ot.prototype.shl=function(It,yt){return this._verify1(It),this.imod(It.ushln(yt))},Ot.prototype.imul=function(It,yt){return this._verify2(It,yt),this.imod(It.imul(yt))},Ot.prototype.mul=function(It,yt){return this._verify2(It,yt),this.imod(It.mul(yt))},Ot.prototype.isqr=function(It){return this.imul(It,It.clone())},Ot.prototype.sqr=function(It){return this.mul(It,It)},Ot.prototype.sqrt=function(It){if(It.isZero())return It.clone();var yt=this.m.andln(3);if(j(yt%2===1),yt===3){var lt=this.m.add(new tt(1)).iushrn(2);return this.pow(It,lt)}for(var pt=this.m.subn(1),bt=0;!pt.isZero()&&pt.andln(1)===0;)bt++,pt.iushrn(1);j(!pt.isZero());var _t=new tt(1).toRed(this),$t=_t.redNeg(),Ct=this.m.subn(1).iushrn(1),xt=this.m.bitLength();for(xt=new tt(2*xt*xt).toRed(this);this.pow(xt,Ct).cmp($t)!==0;)xt.redIAdd($t);for(var vt=this.pow(xt,pt),dt=this.pow(It,pt.addn(1).iushrn(1)),wt=this.pow(It,pt),qt=bt;wt.cmp(_t)!==0;){for(var Pt=wt,Gt=0;Pt.cmp(_t)!==0;Gt++)Pt=Pt.redSqr();j(Gt<qt);var Wt=this.pow(vt,new tt(1).iushln(qt-Gt-1));dt=dt.redMul(Wt),vt=Wt.redSqr(),wt=wt.redMul(vt),qt=Gt}return dt},Ot.prototype.invm=function(It){var yt=It._invmp(this.m);return yt.negative!==0?(yt.negative=0,this.imod(yt).redNeg()):this.imod(yt)},Ot.prototype.pow=function(It,yt){if(yt.isZero())return new tt(1).toRed(this);if(yt.cmpn(1)===0)return It.clone();var lt=4,pt=new Array(1<<lt);pt[0]=new tt(1).toRed(this),pt[1]=It;for(var bt=2;bt<pt.length;bt++)pt[bt]=this.mul(pt[bt-1],It);var _t=pt[0],$t=0,Ct=0,xt=yt.bitLength()%26;for(xt===0&&(xt=26),bt=yt.length-1;bt>=0;bt--){for(var vt=yt.words[bt],dt=xt-1;dt>=0;dt--){var wt=vt>>dt&1;if(_t!==pt[0]&&(_t=this.sqr(_t)),wt===0&&$t===0){Ct=0;continue}$t<<=1,$t|=wt,Ct++,!(Ct!==lt&&(bt!==0||dt!==0))&&(_t=this.mul(_t,pt[$t]),Ct=0,$t=0)}xt=26}return _t},Ot.prototype.convertTo=function(It){var yt=It.umod(this.m);return yt===It?yt.clone():yt},Ot.prototype.convertFrom=function(It){var yt=It.clone();return yt.red=null,yt},tt.mont=function(It){return new jt(It)};function jt(Nt){Ot.call(this,Nt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new tt(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}et(jt,Ot),jt.prototype.convertTo=function(It){return this.imod(It.ushln(this.shift))},jt.prototype.convertFrom=function(It){var yt=this.imod(It.mul(this.rinv));return yt.red=null,yt},jt.prototype.imul=function(It,yt){if(It.isZero()||yt.isZero())return It.words[0]=0,It.length=1,It;var lt=It.imul(yt),pt=lt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),bt=lt.isub(pt).iushrn(this.shift),_t=bt;return bt.cmp(this.m)>=0?_t=bt.isub(this.m):bt.cmpn(0)<0&&(_t=bt.iadd(this.m)),_t._forceRed(this)},jt.prototype.mul=function(It,yt){if(It.isZero()||yt.isZero())return new tt(0)._forceRed(this);var lt=It.mul(yt),pt=lt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),bt=lt.isub(pt).iushrn(this.shift),_t=bt;return bt.cmp(this.m)>=0?_t=bt.isub(this.m):bt.cmpn(0)<0&&(_t=bt.iadd(this.m)),_t._forceRed(this)},jt.prototype.invm=function(It){var yt=this.imod(It._invmp(this.m).mul(this.r2));return yt._forceRed(this)}})(_,commonjsGlobal)})(bn$4);var brorandExports={},brorand={get exports(){return brorandExports},set exports(_){brorandExports=_}},hasRequiredBrorand;function requireBrorand(){if(hasRequiredBrorand)return brorandExports;hasRequiredBrorand=1;var _;brorand.exports=function(et){return _||(_=new o(null)),_.generate(et)};function o(j){this.rand=j}if(brorandExports.Rand=o,o.prototype.generate=function(et){return this._rand(et)},o.prototype._rand=function(et){if(this.rand.getBytes)return this.rand.getBytes(et);for(var tt=new Uint8Array(et),rt=0;rt<tt.length;rt++)tt[rt]=this.rand.getByte();return tt},typeof self=="object")self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(et){var tt=new Uint8Array(et);return self.crypto.getRandomValues(tt),tt}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(et){var tt=new Uint8Array(et);return self.msCrypto.getRandomValues(tt),tt}:typeof window=="object"&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var $=requireCryptoBrowserify();if(typeof $.randomBytes!="function")throw new Error("Not supported");o.prototype._rand=function(et){return $.randomBytes(et)}}catch{}return brorandExports}var mr,hasRequiredMr;function requireMr(){if(hasRequiredMr)return mr;hasRequiredMr=1;var _=bnExports$4,o=requireBrorand();function $(j){this.rand=j||new o.Rand}return mr=$,$.create=function(et){return new $(et)},$.prototype._randbelow=function(et){var tt=et.bitLength(),rt=Math.ceil(tt/8);do var nt=new _(this.rand.generate(rt));while(nt.cmp(et)>=0);return nt},$.prototype._randrange=function(et,tt){var rt=tt.sub(et);return et.add(this._randbelow(rt))},$.prototype.test=function(et,tt,rt){var nt=et.bitLength(),it=_.mont(et),st=new _(1).toRed(it);tt||(tt=Math.max(1,nt/48|0));for(var ot=et.subn(1),at=0;!ot.testn(at);at++);for(var ct=et.shrn(at),ut=ot.toRed(it),ft=!0;tt>0;tt--){var ht=this._randrange(new _(2),ot);rt&&rt(ht);var mt=ht.toRed(it).redPow(ct);if(!(mt.cmp(st)===0||mt.cmp(ut)===0)){for(var gt=1;gt<at;gt++){if(mt=mt.redSqr(),mt.cmp(st)===0)return!1;if(mt.cmp(ut)===0)break}if(gt===at)return!1}}return ft},$.prototype.getDivisor=function(et,tt){var rt=et.bitLength(),nt=_.mont(et),it=new _(1).toRed(nt);tt||(tt=Math.max(1,rt/48|0));for(var st=et.subn(1),ot=0;!st.testn(ot);ot++);for(var at=et.shrn(ot),ct=st.toRed(nt);tt>0;tt--){var ut=this._randrange(new _(2),st),ft=et.gcd(ut);if(ft.cmpn(1)!==0)return ft;var ht=ut.toRed(nt).redPow(at);if(!(ht.cmp(it)===0||ht.cmp(ct)===0)){for(var mt=1;mt<ot;mt++){if(ht=ht.redSqr(),ht.cmp(it)===0)return ht.fromRed().subn(1).gcd(et);if(ht.cmp(ct)===0)break}if(mt===ot)return ht=ht.redSqr(),ht.fromRed().subn(1).gcd(et)}}return!1},mr}var generatePrime,hasRequiredGeneratePrime;function requireGeneratePrime(){if(hasRequiredGeneratePrime)return generatePrime;hasRequiredGeneratePrime=1;var _=requireBrowser$c();generatePrime=mt,mt.simpleSieve=ft,mt.fermatTest=ht;var o=bnExports$4,$=new o(24),j=requireMr(),et=new j,tt=new o(1),rt=new o(2),nt=new o(5);new o(16),new o(8);var it=new o(10),st=new o(3);new o(7);var ot=new o(11),at=new o(4);new o(12);var ct=null;function ut(){if(ct!==null)return ct;var gt=1048576,Et=[];Et[0]=2;for(var St=1,At=3;At<gt;At+=2){for(var kt=Math.ceil(Math.sqrt(At)),Rt=0;Rt<St&&Et[Rt]<=kt&&At%Et[Rt]!==0;Rt++);St!==Rt&&Et[Rt]<=kt||(Et[St++]=At)}return ct=Et,Et}function ft(gt){for(var Et=ut(),St=0;St<Et.length;St++)if(gt.modn(Et[St])===0)return gt.cmpn(Et[St])===0;return!0}function ht(gt){var Et=o.mont(gt);return rt.toRed(Et).redPow(gt.subn(1)).fromRed().cmpn(1)===0}function mt(gt,Et){if(gt<16)return Et===2||Et===5?new o([140,123]):new o([140,39]);Et=new o(Et);for(var St,At;;){for(St=new o(_(Math.ceil(gt/8)));St.bitLength()>gt;)St.ishrn(1);if(St.isEven()&&St.iadd(tt),St.testn(1)||St.iadd(rt),Et.cmp(rt)){if(!Et.cmp(nt))for(;St.mod(it).cmp(st);)St.iadd(at)}else for(;St.mod($).cmp(ot);)St.iadd(at);if(At=St.shrn(1),ft(At)&&ft(St)&&ht(At)&&ht(St)&&et.test(At)&&et.test(St))return St}}return generatePrime}const modp1={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"},require$$1$1={modp1,modp2,modp5,modp14,modp15,modp16,modp17,modp18};var dh,hasRequiredDh;function requireDh(){if(hasRequiredDh)return dh;hasRequiredDh=1;var _=bnExports$4,o=requireMr(),$=new o,j=new _(24),et=new _(11),tt=new _(10),rt=new _(3),nt=new _(7),it=requireGeneratePrime(),st=requireBrowser$c();dh=ft;function ot(mt,gt){return gt=gt||"utf8",buffer$2.Buffer.isBuffer(mt)||(mt=new buffer$2.Buffer(mt,gt)),this._pub=new _(mt),this}function at(mt,gt){return gt=gt||"utf8",buffer$2.Buffer.isBuffer(mt)||(mt=new buffer$2.Buffer(mt,gt)),this._priv=new _(mt),this}var ct={};function ut(mt,gt){var Et=gt.toString("hex"),St=[Et,mt.toString(16)].join("_");if(St in ct)return ct[St];var At=0;if(mt.isEven()||!it.simpleSieve||!it.fermatTest(mt)||!$.test(mt))return At+=1,Et==="02"||Et==="05"?At+=8:At+=4,ct[St]=At,At;$.test(mt.shrn(1))||(At+=2);var kt;switch(Et){case"02":mt.mod(j).cmp(et)&&(At+=8);break;case"05":kt=mt.mod(tt),kt.cmp(rt)&&kt.cmp(nt)&&(At+=8);break;default:At+=4}return ct[St]=At,At}function ft(mt,gt,Et){this.setGenerator(gt),this.__prime=new _(mt),this._prime=_.mont(this.__prime),this._primeLen=mt.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,Et?(this.setPublicKey=ot,this.setPrivateKey=at):this._primeCode=8}Object.defineProperty(ft.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=ut(this.__prime,this.__gen)),this._primeCode}}),ft.prototype.generateKeys=function(){return this._priv||(this._priv=new _(st(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},ft.prototype.computeSecret=function(mt){mt=new _(mt),mt=mt.toRed(this._prime);var gt=mt.redPow(this._priv).fromRed(),Et=new buffer$2.Buffer(gt.toArray()),St=this.getPrime();if(Et.length<St.length){var At=new buffer$2.Buffer(St.length-Et.length);At.fill(0),Et=buffer$2.Buffer.concat([At,Et])}return Et},ft.prototype.getPublicKey=function(gt){return ht(this._pub,gt)},ft.prototype.getPrivateKey=function(gt){return ht(this._priv,gt)},ft.prototype.getPrime=function(mt){return ht(this.__prime,mt)},ft.prototype.getGenerator=function(mt){return ht(this._gen,mt)},ft.prototype.setGenerator=function(mt,gt){return gt=gt||"utf8",buffer$2.Buffer.isBuffer(mt)||(mt=new buffer$2.Buffer(mt,gt)),this.__gen=mt,this._gen=new _(mt),this};function ht(mt,gt){var Et=new buffer$2.Buffer(mt.toArray());return gt?Et.toString(gt):Et}return dh}var hasRequiredBrowser$5;function requireBrowser$5(){if(hasRequiredBrowser$5)return browser$9;hasRequiredBrowser$5=1;var _=requireGeneratePrime(),o=require$$1$1,$=requireDh();function j(rt){var nt=new buffer$2.Buffer(o[rt].prime,"hex"),it=new buffer$2.Buffer(o[rt].gen,"hex");return new $(nt,it)}var et={binary:!0,hex:!0,base64:!0};function tt(rt,nt,it,st){return buffer$2.Buffer.isBuffer(nt)||et[nt]===void 0?tt(rt,"binary",nt,it):(nt=nt||"binary",st=st||"binary",it=it||new buffer$2.Buffer([2]),buffer$2.Buffer.isBuffer(it)||(it=new buffer$2.Buffer(it,st)),typeof rt=="number"?new $(_(rt,it),it,!0):(buffer$2.Buffer.isBuffer(rt)||(rt=new buffer$2.Buffer(rt,nt)),new $(rt,it,!0)))}return browser$9.DiffieHellmanGroup=browser$9.createDiffieHellmanGroup=browser$9.getDiffieHellman=j,browser$9.createDiffieHellman=browser$9.DiffieHellman=tt,browser$9}var signExports={},sign$2={get exports(){return signExports},set exports(_){signExports=_}},bnExports$3={},bn$3={get exports(){return bnExports$3},set exports(_){bnExports$3=_}},hasRequiredBn$1;function requireBn$1(){return hasRequiredBn$1||(hasRequiredBn$1=1,function(_){(function(o,$){function j(yt,lt){if(!yt)throw new Error(lt||"Assertion failed")}function et(yt,lt){yt.super_=lt;var pt=function(){};pt.prototype=lt.prototype,yt.prototype=new pt,yt.prototype.constructor=yt}function tt(yt,lt,pt){if(tt.isBN(yt))return yt;this.negative=0,this.words=null,this.length=0,this.red=null,yt!==null&&((lt==="le"||lt==="be")&&(pt=lt,lt=10),this._init(yt||0,lt||10,pt||"be"))}typeof o=="object"?o.exports=tt:$.BN=tt,tt.BN=tt,tt.wordSize=26;var rt;try{typeof window<"u"&&typeof window.Buffer<"u"?rt=window.Buffer:rt=buffer$2.Buffer}catch{}tt.isBN=function(lt){return lt instanceof tt?!0:lt!==null&&typeof lt=="object"&&lt.constructor.wordSize===tt.wordSize&&Array.isArray(lt.words)},tt.max=function(lt,pt){return lt.cmp(pt)>0?lt:pt},tt.min=function(lt,pt){return lt.cmp(pt)<0?lt:pt},tt.prototype._init=function(lt,pt,bt){if(typeof lt=="number")return this._initNumber(lt,pt,bt);if(typeof lt=="object")return this._initArray(lt,pt,bt);pt==="hex"&&(pt=16),j(pt===(pt|0)&&pt>=2&&pt<=36),lt=lt.toString().replace(/\s+/g,"");var _t=0;lt[0]==="-"&&(_t++,this.negative=1),_t<lt.length&&(pt===16?this._parseHex(lt,_t,bt):(this._parseBase(lt,pt,_t),bt==="le"&&this._initArray(this.toArray(),pt,bt)))},tt.prototype._initNumber=function(lt,pt,bt){lt<0&&(this.negative=1,lt=-lt),lt<67108864?(this.words=[lt&67108863],this.length=1):lt<4503599627370496?(this.words=[lt&67108863,lt/67108864&67108863],this.length=2):(j(lt<9007199254740992),this.words=[lt&67108863,lt/67108864&67108863,1],this.length=3),bt==="le"&&this._initArray(this.toArray(),pt,bt)},tt.prototype._initArray=function(lt,pt,bt){if(j(typeof lt.length=="number"),lt.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(lt.length/3),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t,Ct,xt=0;if(bt==="be")for(_t=lt.length-1,$t=0;_t>=0;_t-=3)Ct=lt[_t]|lt[_t-1]<<8|lt[_t-2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);else if(bt==="le")for(_t=0,$t=0;_t<lt.length;_t+=3)Ct=lt[_t]|lt[_t+1]<<8|lt[_t+2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);return this._strip()};function nt(yt,lt){var pt=yt.charCodeAt(lt);if(pt>=48&&pt<=57)return pt-48;if(pt>=65&&pt<=70)return pt-55;if(pt>=97&&pt<=102)return pt-87;j(!1,"Invalid character in "+yt)}function it(yt,lt,pt){var bt=nt(yt,pt);return pt-1>=lt&&(bt|=nt(yt,pt-1)<<4),bt}tt.prototype._parseHex=function(lt,pt,bt){this.length=Math.ceil((lt.length-pt)/6),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t=0,Ct=0,xt;if(bt==="be")for(_t=lt.length-1;_t>=pt;_t-=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8;else{var vt=lt.length-pt;for(_t=vt%2===0?pt+1:pt;_t<lt.length;_t+=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8}this._strip()};function st(yt,lt,pt,bt){for(var _t=0,$t=0,Ct=Math.min(yt.length,pt),xt=lt;xt<Ct;xt++){var vt=yt.charCodeAt(xt)-48;_t*=bt,vt>=49?$t=vt-49+10:vt>=17?$t=vt-17+10:$t=vt,j(vt>=0&&$t<bt,"Invalid character"),_t+=$t}return _t}tt.prototype._parseBase=function(lt,pt,bt){this.words=[0],this.length=1;for(var _t=0,$t=1;$t<=67108863;$t*=pt)_t++;_t--,$t=$t/pt|0;for(var Ct=lt.length-bt,xt=Ct%_t,vt=Math.min(Ct,Ct-xt)+bt,dt=0,wt=bt;wt<vt;wt+=_t)dt=st(lt,wt,wt+_t,pt),this.imuln($t),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt);if(xt!==0){var qt=1;for(dt=st(lt,wt,lt.length,pt),wt=0;wt<xt;wt++)qt*=pt;this.imuln(qt),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt)}this._strip()},tt.prototype.copy=function(lt){lt.words=new Array(this.length);for(var pt=0;pt<this.length;pt++)lt.words[pt]=this.words[pt];lt.length=this.length,lt.negative=this.negative,lt.red=this.red};function ot(yt,lt){yt.words=lt.words,yt.length=lt.length,yt.negative=lt.negative,yt.red=lt.red}if(tt.prototype._move=function(lt){ot(lt,this)},tt.prototype.clone=function(){var lt=new tt(null);return this.copy(lt),lt},tt.prototype._expand=function(lt){for(;this.length<lt;)this.words[this.length++]=0;return this},tt.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},tt.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{tt.prototype[Symbol.for("nodejs.util.inspect.custom")]=at}catch{tt.prototype.inspect=at}else tt.prototype.inspect=at;function at(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var ct=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],ut=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ft=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];tt.prototype.toString=function(lt,pt){lt=lt||10,pt=pt|0||1;var bt;if(lt===16||lt==="hex"){bt="";for(var _t=0,$t=0,Ct=0;Ct<this.length;Ct++){var xt=this.words[Ct],vt=((xt<<_t|$t)&16777215).toString(16);$t=xt>>>24-_t&16777215,_t+=2,_t>=26&&(_t-=26,Ct--),$t!==0||Ct!==this.length-1?bt=ct[6-vt.length]+vt+bt:bt=vt+bt}for($t!==0&&(bt=$t.toString(16)+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}if(lt===(lt|0)&&lt>=2&&lt<=36){var dt=ut[lt],wt=ft[lt];bt="";var qt=this.clone();for(qt.negative=0;!qt.isZero();){var Pt=qt.modrn(wt).toString(lt);qt=qt.idivn(wt),qt.isZero()?bt=Pt+bt:bt=ct[dt-Pt.length]+Pt+bt}for(this.isZero()&&(bt="0"+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}j(!1,"Base should be between 2 and 36")},tt.prototype.toNumber=function(){var lt=this.words[0];return this.length===2?lt+=this.words[1]*67108864:this.length===3&&this.words[2]===1?lt+=4503599627370496+this.words[1]*67108864:this.length>2&&j(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-lt:lt},tt.prototype.toJSON=function(){return this.toString(16,2)},rt&&(tt.prototype.toBuffer=function(lt,pt){return this.toArrayLike(rt,lt,pt)}),tt.prototype.toArray=function(lt,pt){return this.toArrayLike(Array,lt,pt)};var ht=function(lt,pt){return lt.allocUnsafe?lt.allocUnsafe(pt):new lt(pt)};tt.prototype.toArrayLike=function(lt,pt,bt){this._strip();var _t=this.byteLength(),$t=bt||Math.max(1,_t);j(_t<=$t,"byte array longer than desired length"),j($t>0,"Requested array length <= 0");var Ct=ht(lt,$t),xt=pt==="le"?"LE":"BE";return this["_toArrayLike"+xt](Ct,_t),Ct},tt.prototype._toArrayLikeLE=function(lt,pt){for(var bt=0,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt++]=xt&255,bt<lt.length&&(lt[bt++]=xt>>8&255),bt<lt.length&&(lt[bt++]=xt>>16&255),Ct===6?(bt<lt.length&&(lt[bt++]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt<lt.length)for(lt[bt++]=_t;bt<lt.length;)lt[bt++]=0},tt.prototype._toArrayLikeBE=function(lt,pt){for(var bt=lt.length-1,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt--]=xt&255,bt>=0&&(lt[bt--]=xt>>8&255),bt>=0&&(lt[bt--]=xt>>16&255),Ct===6?(bt>=0&&(lt[bt--]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt>=0)for(lt[bt--]=_t;bt>=0;)lt[bt--]=0},Math.clz32?tt.prototype._countBits=function(lt){return 32-Math.clz32(lt)}:tt.prototype._countBits=function(lt){var pt=lt,bt=0;return pt>=4096&&(bt+=13,pt>>>=13),pt>=64&&(bt+=7,pt>>>=7),pt>=8&&(bt+=4,pt>>>=4),pt>=2&&(bt+=2,pt>>>=2),bt+pt},tt.prototype._zeroBits=function(lt){if(lt===0)return 26;var pt=lt,bt=0;return pt&8191||(bt+=13,pt>>>=13),pt&127||(bt+=7,pt>>>=7),pt&15||(bt+=4,pt>>>=4),pt&3||(bt+=2,pt>>>=2),pt&1||bt++,bt},tt.prototype.bitLength=function(){var lt=this.words[this.length-1],pt=this._countBits(lt);return(this.length-1)*26+pt};function mt(yt){for(var lt=new Array(yt.bitLength()),pt=0;pt<lt.length;pt++){var bt=pt/26|0,_t=pt%26;lt[pt]=yt.words[bt]>>>_t&1}return lt}tt.prototype.zeroBits=function(){if(this.isZero())return 0;for(var lt=0,pt=0;pt<this.length;pt++){var bt=this._zeroBits(this.words[pt]);if(lt+=bt,bt!==26)break}return lt},tt.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},tt.prototype.toTwos=function(lt){return this.negative!==0?this.abs().inotn(lt).iaddn(1):this.clone()},tt.prototype.fromTwos=function(lt){return this.testn(lt-1)?this.notn(lt).iaddn(1).ineg():this.clone()},tt.prototype.isNeg=function(){return this.negative!==0},tt.prototype.neg=function(){return this.clone().ineg()},tt.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},tt.prototype.iuor=function(lt){for(;this.length<lt.length;)this.words[this.length++]=0;for(var pt=0;pt<lt.length;pt++)this.words[pt]=this.words[pt]|lt.words[pt];return this._strip()},tt.prototype.ior=function(lt){return j((this.negative|lt.negative)===0),this.iuor(lt)},tt.prototype.or=function(lt){return this.length>lt.length?this.clone().ior(lt):lt.clone().ior(this)},tt.prototype.uor=function(lt){return this.length>lt.length?this.clone().iuor(lt):lt.clone().iuor(this)},tt.prototype.iuand=function(lt){var pt;this.length>lt.length?pt=lt:pt=this;for(var bt=0;bt<pt.length;bt++)this.words[bt]=this.words[bt]&lt.words[bt];return this.length=pt.length,this._strip()},tt.prototype.iand=function(lt){return j((this.negative|lt.negative)===0),this.iuand(lt)},tt.prototype.and=function(lt){return this.length>lt.length?this.clone().iand(lt):lt.clone().iand(this)},tt.prototype.uand=function(lt){return this.length>lt.length?this.clone().iuand(lt):lt.clone().iuand(this)},tt.prototype.iuxor=function(lt){var pt,bt;this.length>lt.length?(pt=this,bt=lt):(pt=lt,bt=this);for(var _t=0;_t<bt.length;_t++)this.words[_t]=pt.words[_t]^bt.words[_t];if(this!==pt)for(;_t<pt.length;_t++)this.words[_t]=pt.words[_t];return this.length=pt.length,this._strip()},tt.prototype.ixor=function(lt){return j((this.negative|lt.negative)===0),this.iuxor(lt)},tt.prototype.xor=function(lt){return this.length>lt.length?this.clone().ixor(lt):lt.clone().ixor(this)},tt.prototype.uxor=function(lt){return this.length>lt.length?this.clone().iuxor(lt):lt.clone().iuxor(this)},tt.prototype.inotn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=Math.ceil(lt/26)|0,bt=lt%26;this._expand(pt),bt>0&&pt--;for(var _t=0;_t<pt;_t++)this.words[_t]=~this.words[_t]&67108863;return bt>0&&(this.words[_t]=~this.words[_t]&67108863>>26-bt),this._strip()},tt.prototype.notn=function(lt){return this.clone().inotn(lt)},tt.prototype.setn=function(lt,pt){j(typeof lt=="number"&&lt>=0);var bt=lt/26|0,_t=lt%26;return this._expand(bt+1),pt?this.words[bt]=this.words[bt]|1<<_t:this.words[bt]=this.words[bt]&~(1<<_t),this._strip()},tt.prototype.iadd=function(lt){var pt;if(this.negative!==0&&lt.negative===0)return this.negative=0,pt=this.isub(lt),this.negative^=1,this._normSign();if(this.negative===0&&lt.negative!==0)return lt.negative=0,pt=this.isub(lt),lt.negative=1,pt._normSign();var bt,_t;this.length>lt.length?(bt=this,_t=lt):(bt=lt,_t=this);for(var $t=0,Ct=0;Ct<_t.length;Ct++)pt=(bt.words[Ct]|0)+(_t.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;for(;$t!==0&&Ct<bt.length;Ct++)pt=(bt.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;if(this.length=bt.length,$t!==0)this.words[this.length]=$t,this.length++;else if(bt!==this)for(;Ct<bt.length;Ct++)this.words[Ct]=bt.words[Ct];return this},tt.prototype.add=function(lt){var pt;return lt.negative!==0&&this.negative===0?(lt.negative=0,pt=this.sub(lt),lt.negative^=1,pt):lt.negative===0&&this.negative!==0?(this.negative=0,pt=lt.sub(this),this.negative=1,pt):this.length>lt.length?this.clone().iadd(lt):lt.clone().iadd(this)},tt.prototype.isub=function(lt){if(lt.negative!==0){lt.negative=0;var pt=this.iadd(lt);return lt.negative=1,pt._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(lt),this.negative=1,this._normSign();var bt=this.cmp(lt);if(bt===0)return this.negative=0,this.length=1,this.words[0]=0,this;var _t,$t;bt>0?(_t=this,$t=lt):(_t=lt,$t=this);for(var Ct=0,xt=0;xt<$t.length;xt++)pt=(_t.words[xt]|0)-($t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;for(;Ct!==0&&xt<_t.length;xt++)pt=(_t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;if(Ct===0&&xt<_t.length&&_t!==this)for(;xt<_t.length;xt++)this.words[xt]=_t.words[xt];return this.length=Math.max(this.length,xt),_t!==this&&(this.negative=1),this._strip()},tt.prototype.sub=function(lt){return this.clone().isub(lt)};function gt(yt,lt,pt){pt.negative=lt.negative^yt.negative;var bt=yt.length+lt.length|0;pt.length=bt,bt=bt-1|0;var _t=yt.words[0]|0,$t=lt.words[0]|0,Ct=_t*$t,xt=Ct&67108863,vt=Ct/67108864|0;pt.words[0]=xt;for(var dt=1;dt<bt;dt++){for(var wt=vt>>>26,qt=vt&67108863,Pt=Math.min(dt,lt.length-1),Gt=Math.max(0,dt-yt.length+1);Gt<=Pt;Gt++){var Wt=dt-Gt|0;_t=yt.words[Wt]|0,$t=lt.words[Gt]|0,Ct=_t*$t+qt,wt+=Ct/67108864|0,qt=Ct&67108863}pt.words[dt]=qt|0,vt=wt|0}return vt!==0?pt.words[dt]=vt|0:pt.length--,pt._strip()}var Et=function(lt,pt,bt){var _t=lt.words,$t=pt.words,Ct=bt.words,xt=0,vt,dt,wt,qt=_t[0]|0,Pt=qt&8191,Gt=qt>>>13,Wt=_t[1]|0,Vt=Wt&8191,Ut=Wt>>>13,Mt=_t[2]|0,Lt=Mt&8191,Yt=Mt>>>13,lr=_t[3]|0,cr=lr&8191,ir=lr>>>13,Zt=_t[4]|0,Bt=Zt&8191,Ft=Zt>>>13,zt=_t[5]|0,Qt=zt&8191,nr=zt>>>13,gr=_t[6]|0,br=gr&8191,vr=gr>>>13,Nr=_t[7]|0,ar=Nr&8191,er=Nr>>>13,Xt=_t[8]|0,tr=Xt&8191,ur=Xt>>>13,pr=_t[9]|0,yr=pr&8191,wr=pr>>>13,Gr=$t[0]|0,$r=Gr&8191,Er=Gr>>>13,Wr=$t[1]|0,Vr=Wr&8191,Pr=Wr>>>13,nn=$t[2]|0,Kr=nn&8191,Dr=nn>>>13,Qr=$t[3]|0,Or=Qr&8191,Cr=Qr>>>13,Zr=$t[4]|0,Fr=Zr&8191,Ar=Zr>>>13,Xr=$t[5]|0,Mr=Xr&8191,Sr=Xr>>>13,Jr=$t[6]|0,Ur=Jr&8191,Rr=Jr>>>13,en=$t[7]|0,Br=en&8191,Ir=en>>>13,tn=$t[8]|0,qr=tn&8191,Lr=tn>>>13,sn=$t[9]|0,Hr=sn&8191,jr=sn>>>13;bt.negative=lt.negative^pt.negative,bt.length=19,vt=Math.imul(Pt,$r),dt=Math.imul(Pt,Er),dt=dt+Math.imul(Gt,$r)|0,wt=Math.imul(Gt,Er);var un=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(un>>>26)|0,un&=67108863,vt=Math.imul(Vt,$r),dt=Math.imul(Vt,Er),dt=dt+Math.imul(Ut,$r)|0,wt=Math.imul(Ut,Er),vt=vt+Math.imul(Pt,Vr)|0,dt=dt+Math.imul(Pt,Pr)|0,dt=dt+Math.imul(Gt,Vr)|0,wt=wt+Math.imul(Gt,Pr)|0;var dn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(dn>>>26)|0,dn&=67108863,vt=Math.imul(Lt,$r),dt=Math.imul(Lt,Er),dt=dt+Math.imul(Yt,$r)|0,wt=Math.imul(Yt,Er),vt=vt+Math.imul(Vt,Vr)|0,dt=dt+Math.imul(Vt,Pr)|0,dt=dt+Math.imul(Ut,Vr)|0,wt=wt+Math.imul(Ut,Pr)|0,vt=vt+Math.imul(Pt,Kr)|0,dt=dt+Math.imul(Pt,Dr)|0,dt=dt+Math.imul(Gt,Kr)|0,wt=wt+Math.imul(Gt,Dr)|0;var fn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(fn>>>26)|0,fn&=67108863,vt=Math.imul(cr,$r),dt=Math.imul(cr,Er),dt=dt+Math.imul(ir,$r)|0,wt=Math.imul(ir,Er),vt=vt+Math.imul(Lt,Vr)|0,dt=dt+Math.imul(Lt,Pr)|0,dt=dt+Math.imul(Yt,Vr)|0,wt=wt+Math.imul(Yt,Pr)|0,vt=vt+Math.imul(Vt,Kr)|0,dt=dt+Math.imul(Vt,Dr)|0,dt=dt+Math.imul(Ut,Kr)|0,wt=wt+Math.imul(Ut,Dr)|0,vt=vt+Math.imul(Pt,Or)|0,dt=dt+Math.imul(Pt,Cr)|0,dt=dt+Math.imul(Gt,Or)|0,wt=wt+Math.imul(Gt,Cr)|0;var an=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(an>>>26)|0,an&=67108863,vt=Math.imul(Bt,$r),dt=Math.imul(Bt,Er),dt=dt+Math.imul(Ft,$r)|0,wt=Math.imul(Ft,Er),vt=vt+Math.imul(cr,Vr)|0,dt=dt+Math.imul(cr,Pr)|0,dt=dt+Math.imul(ir,Vr)|0,wt=wt+Math.imul(ir,Pr)|0,vt=vt+Math.imul(Lt,Kr)|0,dt=dt+Math.imul(Lt,Dr)|0,dt=dt+Math.imul(Yt,Kr)|0,wt=wt+Math.imul(Yt,Dr)|0,vt=vt+Math.imul(Vt,Or)|0,dt=dt+Math.imul(Vt,Cr)|0,dt=dt+Math.imul(Ut,Or)|0,wt=wt+Math.imul(Ut,Cr)|0,vt=vt+Math.imul(Pt,Fr)|0,dt=dt+Math.imul(Pt,Ar)|0,dt=dt+Math.imul(Gt,Fr)|0,wt=wt+Math.imul(Gt,Ar)|0;var pn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(pn>>>26)|0,pn&=67108863,vt=Math.imul(Qt,$r),dt=Math.imul(Qt,Er),dt=dt+Math.imul(nr,$r)|0,wt=Math.imul(nr,Er),vt=vt+Math.imul(Bt,Vr)|0,dt=dt+Math.imul(Bt,Pr)|0,dt=dt+Math.imul(Ft,Vr)|0,wt=wt+Math.imul(Ft,Pr)|0,vt=vt+Math.imul(cr,Kr)|0,dt=dt+Math.imul(cr,Dr)|0,dt=dt+Math.imul(ir,Kr)|0,wt=wt+Math.imul(ir,Dr)|0,vt=vt+Math.imul(Lt,Or)|0,dt=dt+Math.imul(Lt,Cr)|0,dt=dt+Math.imul(Yt,Or)|0,wt=wt+Math.imul(Yt,Cr)|0,vt=vt+Math.imul(Vt,Fr)|0,dt=dt+Math.imul(Vt,Ar)|0,dt=dt+Math.imul(Ut,Fr)|0,wt=wt+Math.imul(Ut,Ar)|0,vt=vt+Math.imul(Pt,Mr)|0,dt=dt+Math.imul(Pt,Sr)|0,dt=dt+Math.imul(Gt,Mr)|0,wt=wt+Math.imul(Gt,Sr)|0;var _n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(_n>>>26)|0,_n&=67108863,vt=Math.imul(br,$r),dt=Math.imul(br,Er),dt=dt+Math.imul(vr,$r)|0,wt=Math.imul(vr,Er),vt=vt+Math.imul(Qt,Vr)|0,dt=dt+Math.imul(Qt,Pr)|0,dt=dt+Math.imul(nr,Vr)|0,wt=wt+Math.imul(nr,Pr)|0,vt=vt+Math.imul(Bt,Kr)|0,dt=dt+Math.imul(Bt,Dr)|0,dt=dt+Math.imul(Ft,Kr)|0,wt=wt+Math.imul(Ft,Dr)|0,vt=vt+Math.imul(cr,Or)|0,dt=dt+Math.imul(cr,Cr)|0,dt=dt+Math.imul(ir,Or)|0,wt=wt+Math.imul(ir,Cr)|0,vt=vt+Math.imul(Lt,Fr)|0,dt=dt+Math.imul(Lt,Ar)|0,dt=dt+Math.imul(Yt,Fr)|0,wt=wt+Math.imul(Yt,Ar)|0,vt=vt+Math.imul(Vt,Mr)|0,dt=dt+Math.imul(Vt,Sr)|0,dt=dt+Math.imul(Ut,Mr)|0,wt=wt+Math.imul(Ut,Sr)|0,vt=vt+Math.imul(Pt,Ur)|0,dt=dt+Math.imul(Pt,Rr)|0,dt=dt+Math.imul(Gt,Ur)|0,wt=wt+Math.imul(Gt,Rr)|0;var Tn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,vt=Math.imul(ar,$r),dt=Math.imul(ar,Er),dt=dt+Math.imul(er,$r)|0,wt=Math.imul(er,Er),vt=vt+Math.imul(br,Vr)|0,dt=dt+Math.imul(br,Pr)|0,dt=dt+Math.imul(vr,Vr)|0,wt=wt+Math.imul(vr,Pr)|0,vt=vt+Math.imul(Qt,Kr)|0,dt=dt+Math.imul(Qt,Dr)|0,dt=dt+Math.imul(nr,Kr)|0,wt=wt+Math.imul(nr,Dr)|0,vt=vt+Math.imul(Bt,Or)|0,dt=dt+Math.imul(Bt,Cr)|0,dt=dt+Math.imul(Ft,Or)|0,wt=wt+Math.imul(Ft,Cr)|0,vt=vt+Math.imul(cr,Fr)|0,dt=dt+Math.imul(cr,Ar)|0,dt=dt+Math.imul(ir,Fr)|0,wt=wt+Math.imul(ir,Ar)|0,vt=vt+Math.imul(Lt,Mr)|0,dt=dt+Math.imul(Lt,Sr)|0,dt=dt+Math.imul(Yt,Mr)|0,wt=wt+Math.imul(Yt,Sr)|0,vt=vt+Math.imul(Vt,Ur)|0,dt=dt+Math.imul(Vt,Rr)|0,dt=dt+Math.imul(Ut,Ur)|0,wt=wt+Math.imul(Ut,Rr)|0,vt=vt+Math.imul(Pt,Br)|0,dt=dt+Math.imul(Pt,Ir)|0,dt=dt+Math.imul(Gt,Br)|0,wt=wt+Math.imul(Gt,Ir)|0;var gn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(gn>>>26)|0,gn&=67108863,vt=Math.imul(tr,$r),dt=Math.imul(tr,Er),dt=dt+Math.imul(ur,$r)|0,wt=Math.imul(ur,Er),vt=vt+Math.imul(ar,Vr)|0,dt=dt+Math.imul(ar,Pr)|0,dt=dt+Math.imul(er,Vr)|0,wt=wt+Math.imul(er,Pr)|0,vt=vt+Math.imul(br,Kr)|0,dt=dt+Math.imul(br,Dr)|0,dt=dt+Math.imul(vr,Kr)|0,wt=wt+Math.imul(vr,Dr)|0,vt=vt+Math.imul(Qt,Or)|0,dt=dt+Math.imul(Qt,Cr)|0,dt=dt+Math.imul(nr,Or)|0,wt=wt+Math.imul(nr,Cr)|0,vt=vt+Math.imul(Bt,Fr)|0,dt=dt+Math.imul(Bt,Ar)|0,dt=dt+Math.imul(Ft,Fr)|0,wt=wt+Math.imul(Ft,Ar)|0,vt=vt+Math.imul(cr,Mr)|0,dt=dt+Math.imul(cr,Sr)|0,dt=dt+Math.imul(ir,Mr)|0,wt=wt+Math.imul(ir,Sr)|0,vt=vt+Math.imul(Lt,Ur)|0,dt=dt+Math.imul(Lt,Rr)|0,dt=dt+Math.imul(Yt,Ur)|0,wt=wt+Math.imul(Yt,Rr)|0,vt=vt+Math.imul(Vt,Br)|0,dt=dt+Math.imul(Vt,Ir)|0,dt=dt+Math.imul(Ut,Br)|0,wt=wt+Math.imul(Ut,Ir)|0,vt=vt+Math.imul(Pt,qr)|0,dt=dt+Math.imul(Pt,Lr)|0,dt=dt+Math.imul(Gt,qr)|0,wt=wt+Math.imul(Gt,Lr)|0;var En=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(En>>>26)|0,En&=67108863,vt=Math.imul(yr,$r),dt=Math.imul(yr,Er),dt=dt+Math.imul(wr,$r)|0,wt=Math.imul(wr,Er),vt=vt+Math.imul(tr,Vr)|0,dt=dt+Math.imul(tr,Pr)|0,dt=dt+Math.imul(ur,Vr)|0,wt=wt+Math.imul(ur,Pr)|0,vt=vt+Math.imul(ar,Kr)|0,dt=dt+Math.imul(ar,Dr)|0,dt=dt+Math.imul(er,Kr)|0,wt=wt+Math.imul(er,Dr)|0,vt=vt+Math.imul(br,Or)|0,dt=dt+Math.imul(br,Cr)|0,dt=dt+Math.imul(vr,Or)|0,wt=wt+Math.imul(vr,Cr)|0,vt=vt+Math.imul(Qt,Fr)|0,dt=dt+Math.imul(Qt,Ar)|0,dt=dt+Math.imul(nr,Fr)|0,wt=wt+Math.imul(nr,Ar)|0,vt=vt+Math.imul(Bt,Mr)|0,dt=dt+Math.imul(Bt,Sr)|0,dt=dt+Math.imul(Ft,Mr)|0,wt=wt+Math.imul(Ft,Sr)|0,vt=vt+Math.imul(cr,Ur)|0,dt=dt+Math.imul(cr,Rr)|0,dt=dt+Math.imul(ir,Ur)|0,wt=wt+Math.imul(ir,Rr)|0,vt=vt+Math.imul(Lt,Br)|0,dt=dt+Math.imul(Lt,Ir)|0,dt=dt+Math.imul(Yt,Br)|0,wt=wt+Math.imul(Yt,Ir)|0,vt=vt+Math.imul(Vt,qr)|0,dt=dt+Math.imul(Vt,Lr)|0,dt=dt+Math.imul(Ut,qr)|0,wt=wt+Math.imul(Ut,Lr)|0,vt=vt+Math.imul(Pt,Hr)|0,dt=dt+Math.imul(Pt,jr)|0,dt=dt+Math.imul(Gt,Hr)|0,wt=wt+Math.imul(Gt,jr)|0;var Cn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,vt=Math.imul(yr,Vr),dt=Math.imul(yr,Pr),dt=dt+Math.imul(wr,Vr)|0,wt=Math.imul(wr,Pr),vt=vt+Math.imul(tr,Kr)|0,dt=dt+Math.imul(tr,Dr)|0,dt=dt+Math.imul(ur,Kr)|0,wt=wt+Math.imul(ur,Dr)|0,vt=vt+Math.imul(ar,Or)|0,dt=dt+Math.imul(ar,Cr)|0,dt=dt+Math.imul(er,Or)|0,wt=wt+Math.imul(er,Cr)|0,vt=vt+Math.imul(br,Fr)|0,dt=dt+Math.imul(br,Ar)|0,dt=dt+Math.imul(vr,Fr)|0,wt=wt+Math.imul(vr,Ar)|0,vt=vt+Math.imul(Qt,Mr)|0,dt=dt+Math.imul(Qt,Sr)|0,dt=dt+Math.imul(nr,Mr)|0,wt=wt+Math.imul(nr,Sr)|0,vt=vt+Math.imul(Bt,Ur)|0,dt=dt+Math.imul(Bt,Rr)|0,dt=dt+Math.imul(Ft,Ur)|0,wt=wt+Math.imul(Ft,Rr)|0,vt=vt+Math.imul(cr,Br)|0,dt=dt+Math.imul(cr,Ir)|0,dt=dt+Math.imul(ir,Br)|0,wt=wt+Math.imul(ir,Ir)|0,vt=vt+Math.imul(Lt,qr)|0,dt=dt+Math.imul(Lt,Lr)|0,dt=dt+Math.imul(Yt,qr)|0,wt=wt+Math.imul(Yt,Lr)|0,vt=vt+Math.imul(Vt,Hr)|0,dt=dt+Math.imul(Vt,jr)|0,dt=dt+Math.imul(Ut,Hr)|0,wt=wt+Math.imul(Ut,jr)|0;var mn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(mn>>>26)|0,mn&=67108863,vt=Math.imul(yr,Kr),dt=Math.imul(yr,Dr),dt=dt+Math.imul(wr,Kr)|0,wt=Math.imul(wr,Dr),vt=vt+Math.imul(tr,Or)|0,dt=dt+Math.imul(tr,Cr)|0,dt=dt+Math.imul(ur,Or)|0,wt=wt+Math.imul(ur,Cr)|0,vt=vt+Math.imul(ar,Fr)|0,dt=dt+Math.imul(ar,Ar)|0,dt=dt+Math.imul(er,Fr)|0,wt=wt+Math.imul(er,Ar)|0,vt=vt+Math.imul(br,Mr)|0,dt=dt+Math.imul(br,Sr)|0,dt=dt+Math.imul(vr,Mr)|0,wt=wt+Math.imul(vr,Sr)|0,vt=vt+Math.imul(Qt,Ur)|0,dt=dt+Math.imul(Qt,Rr)|0,dt=dt+Math.imul(nr,Ur)|0,wt=wt+Math.imul(nr,Rr)|0,vt=vt+Math.imul(Bt,Br)|0,dt=dt+Math.imul(Bt,Ir)|0,dt=dt+Math.imul(Ft,Br)|0,wt=wt+Math.imul(Ft,Ir)|0,vt=vt+Math.imul(cr,qr)|0,dt=dt+Math.imul(cr,Lr)|0,dt=dt+Math.imul(ir,qr)|0,wt=wt+Math.imul(ir,Lr)|0,vt=vt+Math.imul(Lt,Hr)|0,dt=dt+Math.imul(Lt,jr)|0,dt=dt+Math.imul(Yt,Hr)|0,wt=wt+Math.imul(Yt,jr)|0;var xn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(xn>>>26)|0,xn&=67108863,vt=Math.imul(yr,Or),dt=Math.imul(yr,Cr),dt=dt+Math.imul(wr,Or)|0,wt=Math.imul(wr,Cr),vt=vt+Math.imul(tr,Fr)|0,dt=dt+Math.imul(tr,Ar)|0,dt=dt+Math.imul(ur,Fr)|0,wt=wt+Math.imul(ur,Ar)|0,vt=vt+Math.imul(ar,Mr)|0,dt=dt+Math.imul(ar,Sr)|0,dt=dt+Math.imul(er,Mr)|0,wt=wt+Math.imul(er,Sr)|0,vt=vt+Math.imul(br,Ur)|0,dt=dt+Math.imul(br,Rr)|0,dt=dt+Math.imul(vr,Ur)|0,wt=wt+Math.imul(vr,Rr)|0,vt=vt+Math.imul(Qt,Br)|0,dt=dt+Math.imul(Qt,Ir)|0,dt=dt+Math.imul(nr,Br)|0,wt=wt+Math.imul(nr,Ir)|0,vt=vt+Math.imul(Bt,qr)|0,dt=dt+Math.imul(Bt,Lr)|0,dt=dt+Math.imul(Ft,qr)|0,wt=wt+Math.imul(Ft,Lr)|0,vt=vt+Math.imul(cr,Hr)|0,dt=dt+Math.imul(cr,jr)|0,dt=dt+Math.imul(ir,Hr)|0,wt=wt+Math.imul(ir,jr)|0;var An=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(An>>>26)|0,An&=67108863,vt=Math.imul(yr,Fr),dt=Math.imul(yr,Ar),dt=dt+Math.imul(wr,Fr)|0,wt=Math.imul(wr,Ar),vt=vt+Math.imul(tr,Mr)|0,dt=dt+Math.imul(tr,Sr)|0,dt=dt+Math.imul(ur,Mr)|0,wt=wt+Math.imul(ur,Sr)|0,vt=vt+Math.imul(ar,Ur)|0,dt=dt+Math.imul(ar,Rr)|0,dt=dt+Math.imul(er,Ur)|0,wt=wt+Math.imul(er,Rr)|0,vt=vt+Math.imul(br,Br)|0,dt=dt+Math.imul(br,Ir)|0,dt=dt+Math.imul(vr,Br)|0,wt=wt+Math.imul(vr,Ir)|0,vt=vt+Math.imul(Qt,qr)|0,dt=dt+Math.imul(Qt,Lr)|0,dt=dt+Math.imul(nr,qr)|0,wt=wt+Math.imul(nr,Lr)|0,vt=vt+Math.imul(Bt,Hr)|0,dt=dt+Math.imul(Bt,jr)|0,dt=dt+Math.imul(Ft,Hr)|0,wt=wt+Math.imul(Ft,jr)|0;var $n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+($n>>>26)|0,$n&=67108863,vt=Math.imul(yr,Mr),dt=Math.imul(yr,Sr),dt=dt+Math.imul(wr,Mr)|0,wt=Math.imul(wr,Sr),vt=vt+Math.imul(tr,Ur)|0,dt=dt+Math.imul(tr,Rr)|0,dt=dt+Math.imul(ur,Ur)|0,wt=wt+Math.imul(ur,Rr)|0,vt=vt+Math.imul(ar,Br)|0,dt=dt+Math.imul(ar,Ir)|0,dt=dt+Math.imul(er,Br)|0,wt=wt+Math.imul(er,Ir)|0,vt=vt+Math.imul(br,qr)|0,dt=dt+Math.imul(br,Lr)|0,dt=dt+Math.imul(vr,qr)|0,wt=wt+Math.imul(vr,Lr)|0,vt=vt+Math.imul(Qt,Hr)|0,dt=dt+Math.imul(Qt,jr)|0,dt=dt+Math.imul(nr,Hr)|0,wt=wt+Math.imul(nr,jr)|0;var Rn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,vt=Math.imul(yr,Ur),dt=Math.imul(yr,Rr),dt=dt+Math.imul(wr,Ur)|0,wt=Math.imul(wr,Rr),vt=vt+Math.imul(tr,Br)|0,dt=dt+Math.imul(tr,Ir)|0,dt=dt+Math.imul(ur,Br)|0,wt=wt+Math.imul(ur,Ir)|0,vt=vt+Math.imul(ar,qr)|0,dt=dt+Math.imul(ar,Lr)|0,dt=dt+Math.imul(er,qr)|0,wt=wt+Math.imul(er,Lr)|0,vt=vt+Math.imul(br,Hr)|0,dt=dt+Math.imul(br,jr)|0,dt=dt+Math.imul(vr,Hr)|0,wt=wt+Math.imul(vr,jr)|0;var Sn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Sn>>>26)|0,Sn&=67108863,vt=Math.imul(yr,Br),dt=Math.imul(yr,Ir),dt=dt+Math.imul(wr,Br)|0,wt=Math.imul(wr,Ir),vt=vt+Math.imul(tr,qr)|0,dt=dt+Math.imul(tr,Lr)|0,dt=dt+Math.imul(ur,qr)|0,wt=wt+Math.imul(ur,Lr)|0,vt=vt+Math.imul(ar,Hr)|0,dt=dt+Math.imul(ar,jr)|0,dt=dt+Math.imul(er,Hr)|0,wt=wt+Math.imul(er,jr)|0;var In=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(In>>>26)|0,In&=67108863,vt=Math.imul(yr,qr),dt=Math.imul(yr,Lr),dt=dt+Math.imul(wr,qr)|0,wt=Math.imul(wr,Lr),vt=vt+Math.imul(tr,Hr)|0,dt=dt+Math.imul(tr,jr)|0,dt=dt+Math.imul(ur,Hr)|0,wt=wt+Math.imul(ur,jr)|0;var kn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(kn>>>26)|0,kn&=67108863,vt=Math.imul(yr,Hr),dt=Math.imul(yr,jr),dt=dt+Math.imul(wr,Hr)|0,wt=Math.imul(wr,jr);var Pn=(xt+vt|0)+((dt&8191)<<13)|0;return xt=(wt+(dt>>>13)|0)+(Pn>>>26)|0,Pn&=67108863,Ct[0]=un,Ct[1]=dn,Ct[2]=fn,Ct[3]=an,Ct[4]=pn,Ct[5]=_n,Ct[6]=Tn,Ct[7]=gn,Ct[8]=En,Ct[9]=Cn,Ct[10]=mn,Ct[11]=xn,Ct[12]=An,Ct[13]=$n,Ct[14]=Rn,Ct[15]=Sn,Ct[16]=In,Ct[17]=kn,Ct[18]=Pn,xt!==0&&(Ct[19]=xt,bt.length++),bt};Math.imul||(Et=gt);function St(yt,lt,pt){pt.negative=lt.negative^yt.negative,pt.length=yt.length+lt.length;for(var bt=0,_t=0,$t=0;$t<pt.length-1;$t++){var Ct=_t;_t=0;for(var xt=bt&67108863,vt=Math.min($t,lt.length-1),dt=Math.max(0,$t-yt.length+1);dt<=vt;dt++){var wt=$t-dt,qt=yt.words[wt]|0,Pt=lt.words[dt]|0,Gt=qt*Pt,Wt=Gt&67108863;Ct=Ct+(Gt/67108864|0)|0,Wt=Wt+xt|0,xt=Wt&67108863,Ct=Ct+(Wt>>>26)|0,_t+=Ct>>>26,Ct&=67108863}pt.words[$t]=xt,bt=Ct,Ct=_t}return bt!==0?pt.words[$t]=bt:pt.length--,pt._strip()}function At(yt,lt,pt){return St(yt,lt,pt)}tt.prototype.mulTo=function(lt,pt){var bt,_t=this.length+lt.length;return this.length===10&&lt.length===10?bt=Et(this,lt,pt):_t<63?bt=gt(this,lt,pt):_t<1024?bt=St(this,lt,pt):bt=At(this,lt,pt),bt},tt.prototype.mul=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),this.mulTo(lt,pt)},tt.prototype.mulf=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),At(this,lt,pt)},tt.prototype.imul=function(lt){return this.clone().mulTo(lt,this)},tt.prototype.imuln=function(lt){var pt=lt<0;pt&&(lt=-lt),j(typeof lt=="number"),j(lt<67108864);for(var bt=0,_t=0;_t<this.length;_t++){var $t=(this.words[_t]|0)*lt,Ct=($t&67108863)+(bt&67108863);bt>>=26,bt+=$t/67108864|0,bt+=Ct>>>26,this.words[_t]=Ct&67108863}return bt!==0&&(this.words[_t]=bt,this.length++),pt?this.ineg():this},tt.prototype.muln=function(lt){return this.clone().imuln(lt)},tt.prototype.sqr=function(){return this.mul(this)},tt.prototype.isqr=function(){return this.imul(this.clone())},tt.prototype.pow=function(lt){var pt=mt(lt);if(pt.length===0)return new tt(1);for(var bt=this,_t=0;_t<pt.length&&pt[_t]===0;_t++,bt=bt.sqr());if(++_t<pt.length)for(var $t=bt.sqr();_t<pt.length;_t++,$t=$t.sqr())pt[_t]!==0&&(bt=bt.mul($t));return bt},tt.prototype.iushln=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=67108863>>>26-pt<<26-pt,$t;if(pt!==0){var Ct=0;for($t=0;$t<this.length;$t++){var xt=this.words[$t]&_t,vt=(this.words[$t]|0)-xt<<pt;this.words[$t]=vt|Ct,Ct=xt>>>26-pt}Ct&&(this.words[$t]=Ct,this.length++)}if(bt!==0){for($t=this.length-1;$t>=0;$t--)this.words[$t+bt]=this.words[$t];for($t=0;$t<bt;$t++)this.words[$t]=0;this.length+=bt}return this._strip()},tt.prototype.ishln=function(lt){return j(this.negative===0),this.iushln(lt)},tt.prototype.iushrn=function(lt,pt,bt){j(typeof lt=="number"&&lt>=0);var _t;pt?_t=(pt-pt%26)/26:_t=0;var $t=lt%26,Ct=Math.min((lt-$t)/26,this.length),xt=67108863^67108863>>>$t<<$t,vt=bt;if(_t-=Ct,_t=Math.max(0,_t),vt){for(var dt=0;dt<Ct;dt++)vt.words[dt]=this.words[dt];vt.length=Ct}if(Ct!==0)if(this.length>Ct)for(this.length-=Ct,dt=0;dt<this.length;dt++)this.words[dt]=this.words[dt+Ct];else this.words[0]=0,this.length=1;var wt=0;for(dt=this.length-1;dt>=0&&(wt!==0||dt>=_t);dt--){var qt=this.words[dt]|0;this.words[dt]=wt<<26-$t|qt>>>$t,wt=qt&xt}return vt&&wt!==0&&(vt.words[vt.length++]=wt),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},tt.prototype.ishrn=function(lt,pt,bt){return j(this.negative===0),this.iushrn(lt,pt,bt)},tt.prototype.shln=function(lt){return this.clone().ishln(lt)},tt.prototype.ushln=function(lt){return this.clone().iushln(lt)},tt.prototype.shrn=function(lt){return this.clone().ishrn(lt)},tt.prototype.ushrn=function(lt){return this.clone().iushrn(lt)},tt.prototype.testn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return!1;var $t=this.words[bt];return!!($t&_t)},tt.prototype.imaskn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26;if(j(this.negative===0,"imaskn works only with positive numbers"),this.length<=bt)return this;if(pt!==0&&bt++,this.length=Math.min(bt,this.length),pt!==0){var _t=67108863^67108863>>>pt<<pt;this.words[this.length-1]&=_t}return this._strip()},tt.prototype.maskn=function(lt){return this.clone().imaskn(lt)},tt.prototype.iaddn=function(lt){return j(typeof lt=="number"),j(lt<67108864),lt<0?this.isubn(-lt):this.negative!==0?this.length===1&&(this.words[0]|0)<=lt?(this.words[0]=lt-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(lt),this.negative=1,this):this._iaddn(lt)},tt.prototype._iaddn=function(lt){this.words[0]+=lt;for(var pt=0;pt<this.length&&this.words[pt]>=67108864;pt++)this.words[pt]-=67108864,pt===this.length-1?this.words[pt+1]=1:this.words[pt+1]++;return this.length=Math.max(this.length,pt+1),this},tt.prototype.isubn=function(lt){if(j(typeof lt=="number"),j(lt<67108864),lt<0)return this.iaddn(-lt);if(this.negative!==0)return this.negative=0,this.iaddn(lt),this.negative=1,this;if(this.words[0]-=lt,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var pt=0;pt<this.length&&this.words[pt]<0;pt++)this.words[pt]+=67108864,this.words[pt+1]-=1;return this._strip()},tt.prototype.addn=function(lt){return this.clone().iaddn(lt)},tt.prototype.subn=function(lt){return this.clone().isubn(lt)},tt.prototype.iabs=function(){return this.negative=0,this},tt.prototype.abs=function(){return this.clone().iabs()},tt.prototype._ishlnsubmul=function(lt,pt,bt){var _t=lt.length+bt,$t;this._expand(_t);var Ct,xt=0;for($t=0;$t<lt.length;$t++){Ct=(this.words[$t+bt]|0)+xt;var vt=(lt.words[$t]|0)*pt;Ct-=vt&67108863,xt=(Ct>>26)-(vt/67108864|0),this.words[$t+bt]=Ct&67108863}for(;$t<this.length-bt;$t++)Ct=(this.words[$t+bt]|0)+xt,xt=Ct>>26,this.words[$t+bt]=Ct&67108863;if(xt===0)return this._strip();for(j(xt===-1),xt=0,$t=0;$t<this.length;$t++)Ct=-(this.words[$t]|0)+xt,xt=Ct>>26,this.words[$t]=Ct&67108863;return this.negative=1,this._strip()},tt.prototype._wordDiv=function(lt,pt){var bt=this.length-lt.length,_t=this.clone(),$t=lt,Ct=$t.words[$t.length-1]|0,xt=this._countBits(Ct);bt=26-xt,bt!==0&&($t=$t.ushln(bt),_t.iushln(bt),Ct=$t.words[$t.length-1]|0);var vt=_t.length-$t.length,dt;if(pt!=="mod"){dt=new tt(null),dt.length=vt+1,dt.words=new Array(dt.length);for(var wt=0;wt<dt.length;wt++)dt.words[wt]=0}var qt=_t.clone()._ishlnsubmul($t,1,vt);qt.negative===0&&(_t=qt,dt&&(dt.words[vt]=1));for(var Pt=vt-1;Pt>=0;Pt--){var Gt=(_t.words[$t.length+Pt]|0)*67108864+(_t.words[$t.length+Pt-1]|0);for(Gt=Math.min(Gt/Ct|0,67108863),_t._ishlnsubmul($t,Gt,Pt);_t.negative!==0;)Gt--,_t.negative=0,_t._ishlnsubmul($t,1,Pt),_t.isZero()||(_t.negative^=1);dt&&(dt.words[Pt]=Gt)}return dt&&dt._strip(),_t._strip(),pt!=="div"&&bt!==0&&_t.iushrn(bt),{div:dt||null,mod:_t}},tt.prototype.divmod=function(lt,pt,bt){if(j(!lt.isZero()),this.isZero())return{div:new tt(0),mod:new tt(0)};var _t,$t,Ct;return this.negative!==0&&lt.negative===0?(Ct=this.neg().divmod(lt,pt),pt!=="mod"&&(_t=Ct.div.neg()),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.iadd(lt)),{div:_t,mod:$t}):this.negative===0&&lt.negative!==0?(Ct=this.divmod(lt.neg(),pt),pt!=="mod"&&(_t=Ct.div.neg()),{div:_t,mod:Ct.mod}):this.negative&lt.negative?(Ct=this.neg().divmod(lt.neg(),pt),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.isub(lt)),{div:Ct.div,mod:$t}):lt.length>this.length||this.cmp(lt)<0?{div:new tt(0),mod:this}:lt.length===1?pt==="div"?{div:this.divn(lt.words[0]),mod:null}:pt==="mod"?{div:null,mod:new tt(this.modrn(lt.words[0]))}:{div:this.divn(lt.words[0]),mod:new tt(this.modrn(lt.words[0]))}:this._wordDiv(lt,pt)},tt.prototype.div=function(lt){return this.divmod(lt,"div",!1).div},tt.prototype.mod=function(lt){return this.divmod(lt,"mod",!1).mod},tt.prototype.umod=function(lt){return this.divmod(lt,"mod",!0).mod},tt.prototype.divRound=function(lt){var pt=this.divmod(lt);if(pt.mod.isZero())return pt.div;var bt=pt.div.negative!==0?pt.mod.isub(lt):pt.mod,_t=lt.ushrn(1),$t=lt.andln(1),Ct=bt.cmp(_t);return Ct<0||$t===1&&Ct===0?pt.div:pt.div.negative!==0?pt.div.isubn(1):pt.div.iaddn(1)},tt.prototype.modrn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=(1<<26)%lt,_t=0,$t=this.length-1;$t>=0;$t--)_t=(bt*_t+(this.words[$t]|0))%lt;return pt?-_t:_t},tt.prototype.modn=function(lt){return this.modrn(lt)},tt.prototype.idivn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=0,_t=this.length-1;_t>=0;_t--){var $t=(this.words[_t]|0)+bt*67108864;this.words[_t]=$t/lt|0,bt=$t%lt}return this._strip(),pt?this.ineg():this},tt.prototype.divn=function(lt){return this.clone().idivn(lt)},tt.prototype.egcd=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=new tt(0),xt=new tt(1),vt=0;pt.isEven()&&bt.isEven();)pt.iushrn(1),bt.iushrn(1),++vt;for(var dt=bt.clone(),wt=pt.clone();!pt.isZero();){for(var qt=0,Pt=1;!(pt.words[0]&Pt)&&qt<26;++qt,Pt<<=1);if(qt>0)for(pt.iushrn(qt);qt-- >0;)(_t.isOdd()||$t.isOdd())&&(_t.iadd(dt),$t.isub(wt)),_t.iushrn(1),$t.iushrn(1);for(var Gt=0,Wt=1;!(bt.words[0]&Wt)&&Gt<26;++Gt,Wt<<=1);if(Gt>0)for(bt.iushrn(Gt);Gt-- >0;)(Ct.isOdd()||xt.isOdd())&&(Ct.iadd(dt),xt.isub(wt)),Ct.iushrn(1),xt.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub(Ct),$t.isub(xt)):(bt.isub(pt),Ct.isub(_t),xt.isub($t))}return{a:Ct,b:xt,gcd:bt.iushln(vt)}},tt.prototype._invmp=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=bt.clone();pt.cmpn(1)>0&&bt.cmpn(1)>0;){for(var xt=0,vt=1;!(pt.words[0]&vt)&&xt<26;++xt,vt<<=1);if(xt>0)for(pt.iushrn(xt);xt-- >0;)_t.isOdd()&&_t.iadd(Ct),_t.iushrn(1);for(var dt=0,wt=1;!(bt.words[0]&wt)&&dt<26;++dt,wt<<=1);if(dt>0)for(bt.iushrn(dt);dt-- >0;)$t.isOdd()&&$t.iadd(Ct),$t.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub($t)):(bt.isub(pt),$t.isub(_t))}var qt;return pt.cmpn(1)===0?qt=_t:qt=$t,qt.cmpn(0)<0&&qt.iadd(lt),qt},tt.prototype.gcd=function(lt){if(this.isZero())return lt.abs();if(lt.isZero())return this.abs();var pt=this.clone(),bt=lt.clone();pt.negative=0,bt.negative=0;for(var _t=0;pt.isEven()&&bt.isEven();_t++)pt.iushrn(1),bt.iushrn(1);do{for(;pt.isEven();)pt.iushrn(1);for(;bt.isEven();)bt.iushrn(1);var $t=pt.cmp(bt);if($t<0){var Ct=pt;pt=bt,bt=Ct}else if($t===0||bt.cmpn(1)===0)break;pt.isub(bt)}while(!0);return bt.iushln(_t)},tt.prototype.invm=function(lt){return this.egcd(lt).a.umod(lt)},tt.prototype.isEven=function(){return(this.words[0]&1)===0},tt.prototype.isOdd=function(){return(this.words[0]&1)===1},tt.prototype.andln=function(lt){return this.words[0]&lt},tt.prototype.bincn=function(lt){j(typeof lt=="number");var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return this._expand(bt+1),this.words[bt]|=_t,this;for(var $t=_t,Ct=bt;$t!==0&&Ct<this.length;Ct++){var xt=this.words[Ct]|0;xt+=$t,$t=xt>>>26,xt&=67108863,this.words[Ct]=xt}return $t!==0&&(this.words[Ct]=$t,this.length++),this},tt.prototype.isZero=function(){return this.length===1&&this.words[0]===0},tt.prototype.cmpn=function(lt){var pt=lt<0;if(this.negative!==0&&!pt)return-1;if(this.negative===0&&pt)return 1;this._strip();var bt;if(this.length>1)bt=1;else{pt&&(lt=-lt),j(lt<=67108863,"Number is too big");var _t=this.words[0]|0;bt=_t===lt?0:_t<lt?-1:1}return this.negative!==0?-bt|0:bt},tt.prototype.cmp=function(lt){if(this.negative!==0&&lt.negative===0)return-1;if(this.negative===0&&lt.negative!==0)return 1;var pt=this.ucmp(lt);return this.negative!==0?-pt|0:pt},tt.prototype.ucmp=function(lt){if(this.length>lt.length)return 1;if(this.length<lt.length)return-1;for(var pt=0,bt=this.length-1;bt>=0;bt--){var _t=this.words[bt]|0,$t=lt.words[bt]|0;if(_t!==$t){_t<$t?pt=-1:_t>$t&&(pt=1);break}}return pt},tt.prototype.gtn=function(lt){return this.cmpn(lt)===1},tt.prototype.gt=function(lt){return this.cmp(lt)===1},tt.prototype.gten=function(lt){return this.cmpn(lt)>=0},tt.prototype.gte=function(lt){return this.cmp(lt)>=0},tt.prototype.ltn=function(lt){return this.cmpn(lt)===-1},tt.prototype.lt=function(lt){return this.cmp(lt)===-1},tt.prototype.lten=function(lt){return this.cmpn(lt)<=0},tt.prototype.lte=function(lt){return this.cmp(lt)<=0},tt.prototype.eqn=function(lt){return this.cmpn(lt)===0},tt.prototype.eq=function(lt){return this.cmp(lt)===0},tt.red=function(lt){return new Nt(lt)},tt.prototype.toRed=function(lt){return j(!this.red,"Already a number in reduction context"),j(this.negative===0,"red works only with positives"),lt.convertTo(this)._forceRed(lt)},tt.prototype.fromRed=function(){return j(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},tt.prototype._forceRed=function(lt){return this.red=lt,this},tt.prototype.forceRed=function(lt){return j(!this.red,"Already a number in reduction context"),this._forceRed(lt)},tt.prototype.redAdd=function(lt){return j(this.red,"redAdd works only with red numbers"),this.red.add(this,lt)},tt.prototype.redIAdd=function(lt){return j(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,lt)},tt.prototype.redSub=function(lt){return j(this.red,"redSub works only with red numbers"),this.red.sub(this,lt)},tt.prototype.redISub=function(lt){return j(this.red,"redISub works only with red numbers"),this.red.isub(this,lt)},tt.prototype.redShl=function(lt){return j(this.red,"redShl works only with red numbers"),this.red.shl(this,lt)},tt.prototype.redMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.mul(this,lt)},tt.prototype.redIMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.imul(this,lt)},tt.prototype.redSqr=function(){return j(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},tt.prototype.redISqr=function(){return j(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},tt.prototype.redSqrt=function(){return j(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},tt.prototype.redInvm=function(){return j(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},tt.prototype.redNeg=function(){return j(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},tt.prototype.redPow=function(lt){return j(this.red&&!lt.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,lt)};var kt={k256:null,p224:null,p192:null,p25519:null};function Rt(yt,lt){this.name=yt,this.p=new tt(lt,16),this.n=this.p.bitLength(),this.k=new tt(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Rt.prototype._tmp=function(){var lt=new tt(null);return lt.words=new Array(Math.ceil(this.n/13)),lt},Rt.prototype.ireduce=function(lt){var pt=lt,bt;do this.split(pt,this.tmp),pt=this.imulK(pt),pt=pt.iadd(this.tmp),bt=pt.bitLength();while(bt>this.n);var _t=bt<this.n?-1:pt.ucmp(this.p);return _t===0?(pt.words[0]=0,pt.length=1):_t>0?pt.isub(this.p):pt.strip!==void 0?pt.strip():pt._strip(),pt},Rt.prototype.split=function(lt,pt){lt.iushrn(this.n,0,pt)},Rt.prototype.imulK=function(lt){return lt.imul(this.k)};function Tt(){Rt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}et(Tt,Rt),Tt.prototype.split=function(lt,pt){for(var bt=4194303,_t=Math.min(lt.length,9),$t=0;$t<_t;$t++)pt.words[$t]=lt.words[$t];if(pt.length=_t,lt.length<=9){lt.words[0]=0,lt.length=1;return}var Ct=lt.words[9];for(pt.words[pt.length++]=Ct&bt,$t=10;$t<lt.length;$t++){var xt=lt.words[$t]|0;lt.words[$t-10]=(xt&bt)<<4|Ct>>>22,Ct=xt}Ct>>>=22,lt.words[$t-10]=Ct,Ct===0&&lt.length>10?lt.length-=10:lt.length-=9},Tt.prototype.imulK=function(lt){lt.words[lt.length]=0,lt.words[lt.length+1]=0,lt.length+=2;for(var pt=0,bt=0;bt<lt.length;bt++){var _t=lt.words[bt]|0;pt+=_t*977,lt.words[bt]=pt&67108863,pt=_t*64+(pt/67108864|0)}return lt.words[lt.length-1]===0&&(lt.length--,lt.words[lt.length-1]===0&&lt.length--),lt};function Dt(){Rt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}et(Dt,Rt);function Ot(){Rt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}et(Ot,Rt);function jt(){Rt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}et(jt,Rt),jt.prototype.imulK=function(lt){for(var pt=0,bt=0;bt<lt.length;bt++){var _t=(lt.words[bt]|0)*19+pt,$t=_t&67108863;_t>>>=26,lt.words[bt]=$t,pt=_t}return pt!==0&&(lt.words[lt.length++]=pt),lt},tt._prime=function(lt){if(kt[lt])return kt[lt];var pt;if(lt==="k256")pt=new Tt;else if(lt==="p224")pt=new Dt;else if(lt==="p192")pt=new Ot;else if(lt==="p25519")pt=new jt;else throw new Error("Unknown prime "+lt);return kt[lt]=pt,pt};function Nt(yt){if(typeof yt=="string"){var lt=tt._prime(yt);this.m=lt.p,this.prime=lt}else j(yt.gtn(1),"modulus must be greater than 1"),this.m=yt,this.prime=null}Nt.prototype._verify1=function(lt){j(lt.negative===0,"red works only with positives"),j(lt.red,"red works only with red numbers")},Nt.prototype._verify2=function(lt,pt){j((lt.negative|pt.negative)===0,"red works only with positives"),j(lt.red&&lt.red===pt.red,"red works only with red numbers")},Nt.prototype.imod=function(lt){return this.prime?this.prime.ireduce(lt)._forceRed(this):(ot(lt,lt.umod(this.m)._forceRed(this)),lt)},Nt.prototype.neg=function(lt){return lt.isZero()?lt.clone():this.m.sub(lt)._forceRed(this)},Nt.prototype.add=function(lt,pt){this._verify2(lt,pt);var bt=lt.add(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt._forceRed(this)},Nt.prototype.iadd=function(lt,pt){this._verify2(lt,pt);var bt=lt.iadd(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt},Nt.prototype.sub=function(lt,pt){this._verify2(lt,pt);var bt=lt.sub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt._forceRed(this)},Nt.prototype.isub=function(lt,pt){this._verify2(lt,pt);var bt=lt.isub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt},Nt.prototype.shl=function(lt,pt){return this._verify1(lt),this.imod(lt.ushln(pt))},Nt.prototype.imul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.imul(pt))},Nt.prototype.mul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.mul(pt))},Nt.prototype.isqr=function(lt){return this.imul(lt,lt.clone())},Nt.prototype.sqr=function(lt){return this.mul(lt,lt)},Nt.prototype.sqrt=function(lt){if(lt.isZero())return lt.clone();var pt=this.m.andln(3);if(j(pt%2===1),pt===3){var bt=this.m.add(new tt(1)).iushrn(2);return this.pow(lt,bt)}for(var _t=this.m.subn(1),$t=0;!_t.isZero()&&_t.andln(1)===0;)$t++,_t.iushrn(1);j(!_t.isZero());var Ct=new tt(1).toRed(this),xt=Ct.redNeg(),vt=this.m.subn(1).iushrn(1),dt=this.m.bitLength();for(dt=new tt(2*dt*dt).toRed(this);this.pow(dt,vt).cmp(xt)!==0;)dt.redIAdd(xt);for(var wt=this.pow(dt,_t),qt=this.pow(lt,_t.addn(1).iushrn(1)),Pt=this.pow(lt,_t),Gt=$t;Pt.cmp(Ct)!==0;){for(var Wt=Pt,Vt=0;Wt.cmp(Ct)!==0;Vt++)Wt=Wt.redSqr();j(Vt<Gt);var Ut=this.pow(wt,new tt(1).iushln(Gt-Vt-1));qt=qt.redMul(Ut),wt=Ut.redSqr(),Pt=Pt.redMul(wt),Gt=Vt}return qt},Nt.prototype.invm=function(lt){var pt=lt._invmp(this.m);return pt.negative!==0?(pt.negative=0,this.imod(pt).redNeg()):this.imod(pt)},Nt.prototype.pow=function(lt,pt){if(pt.isZero())return new tt(1).toRed(this);if(pt.cmpn(1)===0)return lt.clone();var bt=4,_t=new Array(1<<bt);_t[0]=new tt(1).toRed(this),_t[1]=lt;for(var $t=2;$t<_t.length;$t++)_t[$t]=this.mul(_t[$t-1],lt);var Ct=_t[0],xt=0,vt=0,dt=pt.bitLength()%26;for(dt===0&&(dt=26),$t=pt.length-1;$t>=0;$t--){for(var wt=pt.words[$t],qt=dt-1;qt>=0;qt--){var Pt=wt>>qt&1;if(Ct!==_t[0]&&(Ct=this.sqr(Ct)),Pt===0&&xt===0){vt=0;continue}xt<<=1,xt|=Pt,vt++,!(vt!==bt&&($t!==0||qt!==0))&&(Ct=this.mul(Ct,_t[xt]),vt=0,xt=0)}dt=26}return Ct},Nt.prototype.convertTo=function(lt){var pt=lt.umod(this.m);return pt===lt?pt.clone():pt},Nt.prototype.convertFrom=function(lt){var pt=lt.clone();return pt.red=null,pt},tt.mont=function(lt){return new It(lt)};function It(yt){Nt.call(this,yt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new tt(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}et(It,Nt),It.prototype.convertTo=function(lt){return this.imod(lt.ushln(this.shift))},It.prototype.convertFrom=function(lt){var pt=this.imod(lt.mul(this.rinv));return pt.red=null,pt},It.prototype.imul=function(lt,pt){if(lt.isZero()||pt.isZero())return lt.words[0]=0,lt.length=1,lt;var bt=lt.imul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.mul=function(lt,pt){if(lt.isZero()||pt.isZero())return new tt(0)._forceRed(this);var bt=lt.mul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.invm=function(lt){var pt=this.imod(lt._invmp(this.m).mul(this.r2));return pt._forceRed(this)}})(_,commonjsGlobal)}(bn$3)),bnExports$3}var browserifyRsa,hasRequiredBrowserifyRsa;function requireBrowserifyRsa(){if(hasRequiredBrowserifyRsa)return browserifyRsa;hasRequiredBrowserifyRsa=1;var _=requireBn$1(),o=requireBrowser$c();function $(tt){var rt=j(tt),nt=rt.toRed(_.mont(tt.modulus)).redPow(new _(tt.publicExponent)).fromRed();return{blinder:nt,unblinder:rt.invm(tt.modulus)}}function j(tt){var rt=tt.modulus.byteLength(),nt;do nt=new _(o(rt));while(nt.cmp(tt.modulus)>=0||!nt.umod(tt.prime1)||!nt.umod(tt.prime2));return nt}function et(tt,rt){var nt=$(rt),it=rt.modulus.byteLength(),st=new _(tt).mul(nt.blinder).umod(rt.modulus),ot=st.toRed(_.mont(rt.prime1)),at=st.toRed(_.mont(rt.prime2)),ct=rt.coefficient,ut=rt.prime1,ft=rt.prime2,ht=ot.redPow(rt.exponent1).fromRed(),mt=at.redPow(rt.exponent2).fromRed(),gt=ht.isub(mt).imul(ct).umod(ut).imul(ft);return mt.iadd(gt).imul(nt.unblinder).umod(rt.modulus).toArrayLike(buffer$2.Buffer,"be",it)}return et.getr=j,browserifyRsa=et,browserifyRsa}var elliptic$3={};const name$6="elliptic",version$n="6.5.4",description="EC cryptography",main="lib/elliptic.js",files=["lib"],scripts={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository={type:"git",url:"git@github.com:indutny/elliptic"},keywords=["EC","Elliptic","curve","Cryptography"],author="Fedor Indutny <fedor@indutny.com>",license="MIT",bugs={url:"https://github.com/indutny/elliptic/issues"},homepage="https://github.com/indutny/elliptic",devDependencies={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},require$$0={name:name$6,version:version$n,description,main,files,scripts,repository,keywords,author,license,bugs,homepage,devDependencies,dependencies};var utils$n={},utils$m={};(function(_){var o=_;function $(tt,rt){if(Array.isArray(tt))return tt.slice();if(!tt)return[];var nt=[];if(typeof tt!="string"){for(var it=0;it<tt.length;it++)nt[it]=tt[it]|0;return nt}if(rt==="hex"){tt=tt.replace(/[^a-z0-9]+/ig,""),tt.length%2!==0&&(tt="0"+tt);for(var it=0;it<tt.length;it+=2)nt.push(parseInt(tt[it]+tt[it+1],16))}else for(var it=0;it<tt.length;it++){var st=tt.charCodeAt(it),ot=st>>8,at=st&255;ot?nt.push(ot,at):nt.push(at)}return nt}o.toArray=$;function j(tt){return tt.length===1?"0"+tt:tt}o.zero2=j;function et(tt){for(var rt="",nt=0;nt<tt.length;nt++)rt+=j(tt[nt].toString(16));return rt}o.toHex=et,o.encode=function(rt,nt){return nt==="hex"?et(rt):rt}})(utils$m);(function(_){var o=_,$=bnExports$4,j=minimalisticAssert$1,et=utils$m;o.assert=j,o.toArray=et.toArray,o.zero2=et.zero2,o.toHex=et.toHex,o.encode=et.encode;function tt(ot,at,ct){var ut=new Array(Math.max(ot.bitLength(),ct)+1);ut.fill(0);for(var ft=1<<at+1,ht=ot.clone(),mt=0;mt<ut.length;mt++){var gt,Et=ht.andln(ft-1);ht.isOdd()?(Et>(ft>>1)-1?gt=(ft>>1)-Et:gt=Et,ht.isubn(gt)):gt=0,ut[mt]=gt,ht.iushrn(1)}return ut}o.getNAF=tt;function rt(ot,at){var ct=[[],[]];ot=ot.clone(),at=at.clone();for(var ut=0,ft=0,ht;ot.cmpn(-ut)>0||at.cmpn(-ft)>0;){var mt=ot.andln(3)+ut&3,gt=at.andln(3)+ft&3;mt===3&&(mt=-1),gt===3&&(gt=-1);var Et;mt&1?(ht=ot.andln(7)+ut&7,(ht===3||ht===5)&&gt===2?Et=-mt:Et=mt):Et=0,ct[0].push(Et);var St;gt&1?(ht=at.andln(7)+ft&7,(ht===3||ht===5)&&mt===2?St=-gt:St=gt):St=0,ct[1].push(St),2*ut===Et+1&&(ut=1-ut),2*ft===St+1&&(ft=1-ft),ot.iushrn(1),at.iushrn(1)}return ct}o.getJSF=rt;function nt(ot,at,ct){var ut="_"+at;ot.prototype[at]=function(){return this[ut]!==void 0?this[ut]:this[ut]=ct.call(this)}}o.cachedProperty=nt;function it(ot){return typeof ot=="string"?o.toArray(ot,"hex"):ot}o.parseBytes=it;function st(ot){return new $(ot,"hex","le")}o.intFromLE=st})(utils$n);var curve={},BN$9=bnExports$4,utils$l=utils$n,getNAF$1=utils$l.getNAF,getJSF$1=utils$l.getJSF,assert$k=utils$l.assert;function BaseCurve$1(_,o){this.type=_,this.p=new BN$9(o.p,16),this.red=o.prime?BN$9.red(o.prime):BN$9.mont(this.p),this.zero=new BN$9(0).toRed(this.red),this.one=new BN$9(1).toRed(this.red),this.two=new BN$9(2).toRed(this.red),this.n=o.n&&new BN$9(o.n,16),this.g=o.g&&this.pointFromJSON(o.g,o.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var $=this.n&&this.p.div(this.n);!$||$.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var base$7=BaseCurve$1;BaseCurve$1.prototype.point=function _(){throw new Error("Not implemented")};BaseCurve$1.prototype.validate=function _(){throw new Error("Not implemented")};BaseCurve$1.prototype._fixedNafMul=function _(o,$){assert$k(o.precomputed);var j=o._getDoubles(),et=getNAF$1($,1,this._bitLength),tt=(1<<j.step+1)-(j.step%2===0?2:1);tt/=3;var rt=[],nt,it;for(nt=0;nt<et.length;nt+=j.step){it=0;for(var st=nt+j.step-1;st>=nt;st--)it=(it<<1)+et[st];rt.push(it)}for(var ot=this.jpoint(null,null,null),at=this.jpoint(null,null,null),ct=tt;ct>0;ct--){for(nt=0;nt<rt.length;nt++)it=rt[nt],it===ct?at=at.mixedAdd(j.points[nt]):it===-ct&&(at=at.mixedAdd(j.points[nt].neg()));ot=ot.add(at)}return ot.toP()};BaseCurve$1.prototype._wnafMul=function _(o,$){var j=4,et=o._getNAFPoints(j);j=et.wnd;for(var tt=et.points,rt=getNAF$1($,j,this._bitLength),nt=this.jpoint(null,null,null),it=rt.length-1;it>=0;it--){for(var st=0;it>=0&&rt[it]===0;it--)st++;if(it>=0&&st++,nt=nt.dblp(st),it<0)break;var ot=rt[it];assert$k(ot!==0),o.type==="affine"?ot>0?nt=nt.mixedAdd(tt[ot-1>>1]):nt=nt.mixedAdd(tt[-ot-1>>1].neg()):ot>0?nt=nt.add(tt[ot-1>>1]):nt=nt.add(tt[-ot-1>>1].neg())}return o.type==="affine"?nt.toP():nt};BaseCurve$1.prototype._wnafMulAdd=function _(o,$,j,et,tt){var rt=this._wnafT1,nt=this._wnafT2,it=this._wnafT3,st=0,ot,at,ct;for(ot=0;ot<et;ot++){ct=$[ot];var ut=ct._getNAFPoints(o);rt[ot]=ut.wnd,nt[ot]=ut.points}for(ot=et-1;ot>=1;ot-=2){var ft=ot-1,ht=ot;if(rt[ft]!==1||rt[ht]!==1){it[ft]=getNAF$1(j[ft],rt[ft],this._bitLength),it[ht]=getNAF$1(j[ht],rt[ht],this._bitLength),st=Math.max(it[ft].length,st),st=Math.max(it[ht].length,st);continue}var mt=[$[ft],null,null,$[ht]];$[ft].y.cmp($[ht].y)===0?(mt[1]=$[ft].add($[ht]),mt[2]=$[ft].toJ().mixedAdd($[ht].neg())):$[ft].y.cmp($[ht].y.redNeg())===0?(mt[1]=$[ft].toJ().mixedAdd($[ht]),mt[2]=$[ft].add($[ht].neg())):(mt[1]=$[ft].toJ().mixedAdd($[ht]),mt[2]=$[ft].toJ().mixedAdd($[ht].neg()));var gt=[-3,-1,-5,-7,0,7,5,1,3],Et=getJSF$1(j[ft],j[ht]);for(st=Math.max(Et[0].length,st),it[ft]=new Array(st),it[ht]=new Array(st),at=0;at<st;at++){var St=Et[0][at]|0,At=Et[1][at]|0;it[ft][at]=gt[(St+1)*3+(At+1)],it[ht][at]=0,nt[ft]=mt}}var kt=this.jpoint(null,null,null),Rt=this._wnafT4;for(ot=st;ot>=0;ot--){for(var Tt=0;ot>=0;){var Dt=!0;for(at=0;at<et;at++)Rt[at]=it[at][ot]|0,Rt[at]!==0&&(Dt=!1);if(!Dt)break;Tt++,ot--}if(ot>=0&&Tt++,kt=kt.dblp(Tt),ot<0)break;for(at=0;at<et;at++){var Ot=Rt[at];Ot!==0&&(Ot>0?ct=nt[at][Ot-1>>1]:Ot<0&&(ct=nt[at][-Ot-1>>1].neg()),ct.type==="affine"?kt=kt.mixedAdd(ct):kt=kt.add(ct))}}for(ot=0;ot<et;ot++)nt[ot]=null;return tt?kt:kt.toP()};function BasePoint$1(_,o){this.curve=_,this.type=o,this.precomputed=null}BaseCurve$1.BasePoint=BasePoint$1;BasePoint$1.prototype.eq=function _(){throw new Error("Not implemented")};BasePoint$1.prototype.validate=function _(){return this.curve.validate(this)};BaseCurve$1.prototype.decodePoint=function _(o,$){o=utils$l.toArray(o,$);var j=this.p.byteLength();if((o[0]===4||o[0]===6||o[0]===7)&&o.length-1===2*j){o[0]===6?assert$k(o[o.length-1]%2===0):o[0]===7&&assert$k(o[o.length-1]%2===1);var et=this.point(o.slice(1,1+j),o.slice(1+j,1+2*j));return et}else if((o[0]===2||o[0]===3)&&o.length-1===j)return this.pointFromX(o.slice(1,1+j),o[0]===3);throw new Error("Unknown point format")};BasePoint$1.prototype.encodeCompressed=function _(o){return this.encode(o,!0)};BasePoint$1.prototype._encode=function _(o){var $=this.curve.p.byteLength(),j=this.getX().toArray("be",$);return o?[this.getY().isEven()?2:3].concat(j):[4].concat(j,this.getY().toArray("be",$))};BasePoint$1.prototype.encode=function _(o,$){return utils$l.encode(this._encode($),o)};BasePoint$1.prototype.precompute=function _(o){if(this.precomputed)return this;var $={doubles:null,naf:null,beta:null};return $.naf=this._getNAFPoints(8),$.doubles=this._getDoubles(4,o),$.beta=this._getBeta(),this.precomputed=$,this};BasePoint$1.prototype._hasDoubles=function _(o){if(!this.precomputed)return!1;var $=this.precomputed.doubles;return $?$.points.length>=Math.ceil((o.bitLength()+1)/$.step):!1};BasePoint$1.prototype._getDoubles=function _(o,$){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var j=[this],et=this,tt=0;tt<$;tt+=o){for(var rt=0;rt<o;rt++)et=et.dbl();j.push(et)}return{step:o,points:j}};BasePoint$1.prototype._getNAFPoints=function _(o){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var $=[this],j=(1<<o)-1,et=j===1?null:this.dbl(),tt=1;tt<j;tt++)$[tt]=$[tt-1].add(et);return{wnd:o,points:$}};BasePoint$1.prototype._getBeta=function _(){return null};BasePoint$1.prototype.dblp=function _(o){for(var $=this,j=0;j<o;j++)$=$.dbl();return $};var utils$k=utils$n,BN$8=bnExports$4,inherits$4=inherits_browserExports,Base$2=base$7,assert$j=utils$k.assert;function ShortCurve$1(_){Base$2.call(this,"short",_),this.a=new BN$8(_.a,16).toRed(this.red),this.b=new BN$8(_.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(_),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}inherits$4(ShortCurve$1,Base$2);var short=ShortCurve$1;ShortCurve$1.prototype._getEndomorphism=function _(o){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var $,j;if(o.beta)$=new BN$8(o.beta,16).toRed(this.red);else{var et=this._getEndoRoots(this.p);$=et[0].cmp(et[1])<0?et[0]:et[1],$=$.toRed(this.red)}if(o.lambda)j=new BN$8(o.lambda,16);else{var tt=this._getEndoRoots(this.n);this.g.mul(tt[0]).x.cmp(this.g.x.redMul($))===0?j=tt[0]:(j=tt[1],assert$j(this.g.mul(j).x.cmp(this.g.x.redMul($))===0))}var rt;return o.basis?rt=o.basis.map(function(nt){return{a:new BN$8(nt.a,16),b:new BN$8(nt.b,16)}}):rt=this._getEndoBasis(j),{beta:$,lambda:j,basis:rt}}};ShortCurve$1.prototype._getEndoRoots=function _(o){var $=o===this.p?this.red:BN$8.mont(o),j=new BN$8(2).toRed($).redInvm(),et=j.redNeg(),tt=new BN$8(3).toRed($).redNeg().redSqrt().redMul(j),rt=et.redAdd(tt).fromRed(),nt=et.redSub(tt).fromRed();return[rt,nt]};ShortCurve$1.prototype._getEndoBasis=function _(o){for(var $=this.n.ushrn(Math.floor(this.n.bitLength()/2)),j=o,et=this.n.clone(),tt=new BN$8(1),rt=new BN$8(0),nt=new BN$8(0),it=new BN$8(1),st,ot,at,ct,ut,ft,ht,mt=0,gt,Et;j.cmpn(0)!==0;){var St=et.div(j);gt=et.sub(St.mul(j)),Et=nt.sub(St.mul(tt));var At=it.sub(St.mul(rt));if(!at&&gt.cmp($)<0)st=ht.neg(),ot=tt,at=gt.neg(),ct=Et;else if(at&&++mt===2)break;ht=gt,et=j,j=gt,nt=tt,tt=Et,it=rt,rt=At}ut=gt.neg(),ft=Et;var kt=at.sqr().add(ct.sqr()),Rt=ut.sqr().add(ft.sqr());return Rt.cmp(kt)>=0&&(ut=st,ft=ot),at.negative&&(at=at.neg(),ct=ct.neg()),ut.negative&&(ut=ut.neg(),ft=ft.neg()),[{a:at,b:ct},{a:ut,b:ft}]};ShortCurve$1.prototype._endoSplit=function _(o){var $=this.endo.basis,j=$[0],et=$[1],tt=et.b.mul(o).divRound(this.n),rt=j.b.neg().mul(o).divRound(this.n),nt=tt.mul(j.a),it=rt.mul(et.a),st=tt.mul(j.b),ot=rt.mul(et.b),at=o.sub(nt).sub(it),ct=st.add(ot).neg();return{k1:at,k2:ct}};ShortCurve$1.prototype.pointFromX=function _(o,$){o=new BN$8(o,16),o.red||(o=o.toRed(this.red));var j=o.redSqr().redMul(o).redIAdd(o.redMul(this.a)).redIAdd(this.b),et=j.redSqrt();if(et.redSqr().redSub(j).cmp(this.zero)!==0)throw new Error("invalid point");var tt=et.fromRed().isOdd();return($&&!tt||!$&&tt)&&(et=et.redNeg()),this.point(o,et)};ShortCurve$1.prototype.validate=function _(o){if(o.inf)return!0;var $=o.x,j=o.y,et=this.a.redMul($),tt=$.redSqr().redMul($).redIAdd(et).redIAdd(this.b);return j.redSqr().redISub(tt).cmpn(0)===0};ShortCurve$1.prototype._endoWnafMulAdd=function _(o,$,j){for(var et=this._endoWnafT1,tt=this._endoWnafT2,rt=0;rt<o.length;rt++){var nt=this._endoSplit($[rt]),it=o[rt],st=it._getBeta();nt.k1.negative&&(nt.k1.ineg(),it=it.neg(!0)),nt.k2.negative&&(nt.k2.ineg(),st=st.neg(!0)),et[rt*2]=it,et[rt*2+1]=st,tt[rt*2]=nt.k1,tt[rt*2+1]=nt.k2}for(var ot=this._wnafMulAdd(1,et,tt,rt*2,j),at=0;at<rt*2;at++)et[at]=null,tt[at]=null;return ot};function Point$5(_,o,$,j){Base$2.BasePoint.call(this,_,"affine"),o===null&&$===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN$8(o,16),this.y=new BN$8($,16),j&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}inherits$4(Point$5,Base$2.BasePoint);ShortCurve$1.prototype.point=function _(o,$,j){return new Point$5(this,o,$,j)};ShortCurve$1.prototype.pointFromJSON=function _(o,$){return Point$5.fromJSON(this,o,$)};Point$5.prototype._getBeta=function _(){if(this.curve.endo){var o=this.precomputed;if(o&&o.beta)return o.beta;var $=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(o){var j=this.curve,et=function(tt){return j.point(tt.x.redMul(j.endo.beta),tt.y)};o.beta=$,$.precomputed={beta:null,naf:o.naf&&{wnd:o.naf.wnd,points:o.naf.points.map(et)},doubles:o.doubles&&{step:o.doubles.step,points:o.doubles.points.map(et)}}}return $}};Point$5.prototype.toJSON=function _(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Point$5.fromJSON=function _(o,$,j){typeof $=="string"&&($=JSON.parse($));var et=o.point($[0],$[1],j);if(!$[2])return et;function tt(nt){return o.point(nt[0],nt[1],j)}var rt=$[2];return et.precomputed={beta:null,doubles:rt.doubles&&{step:rt.doubles.step,points:[et].concat(rt.doubles.points.map(tt))},naf:rt.naf&&{wnd:rt.naf.wnd,points:[et].concat(rt.naf.points.map(tt))}},et};Point$5.prototype.inspect=function _(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Point$5.prototype.isInfinity=function _(){return this.inf};Point$5.prototype.add=function _(o){if(this.inf)return o;if(o.inf)return this;if(this.eq(o))return this.dbl();if(this.neg().eq(o))return this.curve.point(null,null);if(this.x.cmp(o.x)===0)return this.curve.point(null,null);var $=this.y.redSub(o.y);$.cmpn(0)!==0&&($=$.redMul(this.x.redSub(o.x).redInvm()));var j=$.redSqr().redISub(this.x).redISub(o.x),et=$.redMul(this.x.redSub(j)).redISub(this.y);return this.curve.point(j,et)};Point$5.prototype.dbl=function _(){if(this.inf)return this;var o=this.y.redAdd(this.y);if(o.cmpn(0)===0)return this.curve.point(null,null);var $=this.curve.a,j=this.x.redSqr(),et=o.redInvm(),tt=j.redAdd(j).redIAdd(j).redIAdd($).redMul(et),rt=tt.redSqr().redISub(this.x.redAdd(this.x)),nt=tt.redMul(this.x.redSub(rt)).redISub(this.y);return this.curve.point(rt,nt)};Point$5.prototype.getX=function _(){return this.x.fromRed()};Point$5.prototype.getY=function _(){return this.y.fromRed()};Point$5.prototype.mul=function _(o){return o=new BN$8(o,16),this.isInfinity()?this:this._hasDoubles(o)?this.curve._fixedNafMul(this,o):this.curve.endo?this.curve._endoWnafMulAdd([this],[o]):this.curve._wnafMul(this,o)};Point$5.prototype.mulAdd=function _(o,$,j){var et=[this,$],tt=[o,j];return this.curve.endo?this.curve._endoWnafMulAdd(et,tt):this.curve._wnafMulAdd(1,et,tt,2)};Point$5.prototype.jmulAdd=function _(o,$,j){var et=[this,$],tt=[o,j];return this.curve.endo?this.curve._endoWnafMulAdd(et,tt,!0):this.curve._wnafMulAdd(1,et,tt,2,!0)};Point$5.prototype.eq=function _(o){return this===o||this.inf===o.inf&&(this.inf||this.x.cmp(o.x)===0&&this.y.cmp(o.y)===0)};Point$5.prototype.neg=function _(o){if(this.inf)return this;var $=this.curve.point(this.x,this.y.redNeg());if(o&&this.precomputed){var j=this.precomputed,et=function(tt){return tt.neg()};$.precomputed={naf:j.naf&&{wnd:j.naf.wnd,points:j.naf.points.map(et)},doubles:j.doubles&&{step:j.doubles.step,points:j.doubles.points.map(et)}}}return $};Point$5.prototype.toJ=function _(){if(this.inf)return this.curve.jpoint(null,null,null);var o=this.curve.jpoint(this.x,this.y,this.curve.one);return o};function JPoint$1(_,o,$,j){Base$2.BasePoint.call(this,_,"jacobian"),o===null&&$===null&&j===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN$8(0)):(this.x=new BN$8(o,16),this.y=new BN$8($,16),this.z=new BN$8(j,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}inherits$4(JPoint$1,Base$2.BasePoint);ShortCurve$1.prototype.jpoint=function _(o,$,j){return new JPoint$1(this,o,$,j)};JPoint$1.prototype.toP=function _(){if(this.isInfinity())return this.curve.point(null,null);var o=this.z.redInvm(),$=o.redSqr(),j=this.x.redMul($),et=this.y.redMul($).redMul(o);return this.curve.point(j,et)};JPoint$1.prototype.neg=function _(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};JPoint$1.prototype.add=function _(o){if(this.isInfinity())return o;if(o.isInfinity())return this;var $=o.z.redSqr(),j=this.z.redSqr(),et=this.x.redMul($),tt=o.x.redMul(j),rt=this.y.redMul($.redMul(o.z)),nt=o.y.redMul(j.redMul(this.z)),it=et.redSub(tt),st=rt.redSub(nt);if(it.cmpn(0)===0)return st.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var ot=it.redSqr(),at=ot.redMul(it),ct=et.redMul(ot),ut=st.redSqr().redIAdd(at).redISub(ct).redISub(ct),ft=st.redMul(ct.redISub(ut)).redISub(rt.redMul(at)),ht=this.z.redMul(o.z).redMul(it);return this.curve.jpoint(ut,ft,ht)};JPoint$1.prototype.mixedAdd=function _(o){if(this.isInfinity())return o.toJ();if(o.isInfinity())return this;var $=this.z.redSqr(),j=this.x,et=o.x.redMul($),tt=this.y,rt=o.y.redMul($).redMul(this.z),nt=j.redSub(et),it=tt.redSub(rt);if(nt.cmpn(0)===0)return it.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var st=nt.redSqr(),ot=st.redMul(nt),at=j.redMul(st),ct=it.redSqr().redIAdd(ot).redISub(at).redISub(at),ut=it.redMul(at.redISub(ct)).redISub(tt.redMul(ot)),ft=this.z.redMul(nt);return this.curve.jpoint(ct,ut,ft)};JPoint$1.prototype.dblp=function _(o){if(o===0)return this;if(this.isInfinity())return this;if(!o)return this.dbl();var $;if(this.curve.zeroA||this.curve.threeA){var j=this;for($=0;$<o;$++)j=j.dbl();return j}var et=this.curve.a,tt=this.curve.tinv,rt=this.x,nt=this.y,it=this.z,st=it.redSqr().redSqr(),ot=nt.redAdd(nt);for($=0;$<o;$++){var at=rt.redSqr(),ct=ot.redSqr(),ut=ct.redSqr(),ft=at.redAdd(at).redIAdd(at).redIAdd(et.redMul(st)),ht=rt.redMul(ct),mt=ft.redSqr().redISub(ht.redAdd(ht)),gt=ht.redISub(mt),Et=ft.redMul(gt);Et=Et.redIAdd(Et).redISub(ut);var St=ot.redMul(it);$+1<o&&(st=st.redMul(ut)),rt=mt,it=St,ot=Et}return this.curve.jpoint(rt,ot.redMul(tt),it)};JPoint$1.prototype.dbl=function _(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};JPoint$1.prototype._zeroDbl=function _(){var o,$,j;if(this.zOne){var et=this.x.redSqr(),tt=this.y.redSqr(),rt=tt.redSqr(),nt=this.x.redAdd(tt).redSqr().redISub(et).redISub(rt);nt=nt.redIAdd(nt);var it=et.redAdd(et).redIAdd(et),st=it.redSqr().redISub(nt).redISub(nt),ot=rt.redIAdd(rt);ot=ot.redIAdd(ot),ot=ot.redIAdd(ot),o=st,$=it.redMul(nt.redISub(st)).redISub(ot),j=this.y.redAdd(this.y)}else{var at=this.x.redSqr(),ct=this.y.redSqr(),ut=ct.redSqr(),ft=this.x.redAdd(ct).redSqr().redISub(at).redISub(ut);ft=ft.redIAdd(ft);var ht=at.redAdd(at).redIAdd(at),mt=ht.redSqr(),gt=ut.redIAdd(ut);gt=gt.redIAdd(gt),gt=gt.redIAdd(gt),o=mt.redISub(ft).redISub(ft),$=ht.redMul(ft.redISub(o)).redISub(gt),j=this.y.redMul(this.z),j=j.redIAdd(j)}return this.curve.jpoint(o,$,j)};JPoint$1.prototype._threeDbl=function _(){var o,$,j;if(this.zOne){var et=this.x.redSqr(),tt=this.y.redSqr(),rt=tt.redSqr(),nt=this.x.redAdd(tt).redSqr().redISub(et).redISub(rt);nt=nt.redIAdd(nt);var it=et.redAdd(et).redIAdd(et).redIAdd(this.curve.a),st=it.redSqr().redISub(nt).redISub(nt);o=st;var ot=rt.redIAdd(rt);ot=ot.redIAdd(ot),ot=ot.redIAdd(ot),$=it.redMul(nt.redISub(st)).redISub(ot),j=this.y.redAdd(this.y)}else{var at=this.z.redSqr(),ct=this.y.redSqr(),ut=this.x.redMul(ct),ft=this.x.redSub(at).redMul(this.x.redAdd(at));ft=ft.redAdd(ft).redIAdd(ft);var ht=ut.redIAdd(ut);ht=ht.redIAdd(ht);var mt=ht.redAdd(ht);o=ft.redSqr().redISub(mt),j=this.y.redAdd(this.z).redSqr().redISub(ct).redISub(at);var gt=ct.redSqr();gt=gt.redIAdd(gt),gt=gt.redIAdd(gt),gt=gt.redIAdd(gt),$=ft.redMul(ht.redISub(o)).redISub(gt)}return this.curve.jpoint(o,$,j)};JPoint$1.prototype._dbl=function _(){var o=this.curve.a,$=this.x,j=this.y,et=this.z,tt=et.redSqr().redSqr(),rt=$.redSqr(),nt=j.redSqr(),it=rt.redAdd(rt).redIAdd(rt).redIAdd(o.redMul(tt)),st=$.redAdd($);st=st.redIAdd(st);var ot=st.redMul(nt),at=it.redSqr().redISub(ot.redAdd(ot)),ct=ot.redISub(at),ut=nt.redSqr();ut=ut.redIAdd(ut),ut=ut.redIAdd(ut),ut=ut.redIAdd(ut);var ft=it.redMul(ct).redISub(ut),ht=j.redAdd(j).redMul(et);return this.curve.jpoint(at,ft,ht)};JPoint$1.prototype.trpl=function _(){if(!this.curve.zeroA)return this.dbl().add(this);var o=this.x.redSqr(),$=this.y.redSqr(),j=this.z.redSqr(),et=$.redSqr(),tt=o.redAdd(o).redIAdd(o),rt=tt.redSqr(),nt=this.x.redAdd($).redSqr().redISub(o).redISub(et);nt=nt.redIAdd(nt),nt=nt.redAdd(nt).redIAdd(nt),nt=nt.redISub(rt);var it=nt.redSqr(),st=et.redIAdd(et);st=st.redIAdd(st),st=st.redIAdd(st),st=st.redIAdd(st);var ot=tt.redIAdd(nt).redSqr().redISub(rt).redISub(it).redISub(st),at=$.redMul(ot);at=at.redIAdd(at),at=at.redIAdd(at);var ct=this.x.redMul(it).redISub(at);ct=ct.redIAdd(ct),ct=ct.redIAdd(ct);var ut=this.y.redMul(ot.redMul(st.redISub(ot)).redISub(nt.redMul(it)));ut=ut.redIAdd(ut),ut=ut.redIAdd(ut),ut=ut.redIAdd(ut);var ft=this.z.redAdd(nt).redSqr().redISub(j).redISub(it);return this.curve.jpoint(ct,ut,ft)};JPoint$1.prototype.mul=function _(o,$){return o=new BN$8(o,$),this.curve._wnafMul(this,o)};JPoint$1.prototype.eq=function _(o){if(o.type==="affine")return this.eq(o.toJ());if(this===o)return!0;var $=this.z.redSqr(),j=o.z.redSqr();if(this.x.redMul(j).redISub(o.x.redMul($)).cmpn(0)!==0)return!1;var et=$.redMul(this.z),tt=j.redMul(o.z);return this.y.redMul(tt).redISub(o.y.redMul(et)).cmpn(0)===0};JPoint$1.prototype.eqXToP=function _(o){var $=this.z.redSqr(),j=o.toRed(this.curve.red).redMul($);if(this.x.cmp(j)===0)return!0;for(var et=o.clone(),tt=this.curve.redN.redMul($);;){if(et.iadd(this.curve.n),et.cmp(this.curve.p)>=0)return!1;if(j.redIAdd(tt),this.x.cmp(j)===0)return!0}};JPoint$1.prototype.inspect=function _(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};JPoint$1.prototype.isInfinity=function _(){return this.z.cmpn(0)===0};var BN$7=bnExports$4,inherits$3=inherits_browserExports,Base$1=base$7,utils$j=utils$n;function MontCurve(_){Base$1.call(this,"mont",_),this.a=new BN$7(_.a,16).toRed(this.red),this.b=new BN$7(_.b,16).toRed(this.red),this.i4=new BN$7(4).toRed(this.red).redInvm(),this.two=new BN$7(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}inherits$3(MontCurve,Base$1);var mont=MontCurve;MontCurve.prototype.validate=function _(o){var $=o.normalize().x,j=$.redSqr(),et=j.redMul($).redAdd(j.redMul(this.a)).redAdd($),tt=et.redSqrt();return tt.redSqr().cmp(et)===0};function Point$4(_,o,$){Base$1.BasePoint.call(this,_,"projective"),o===null&&$===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN$7(o,16),this.z=new BN$7($,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}inherits$3(Point$4,Base$1.BasePoint);MontCurve.prototype.decodePoint=function _(o,$){return this.point(utils$j.toArray(o,$),1)};MontCurve.prototype.point=function _(o,$){return new Point$4(this,o,$)};MontCurve.prototype.pointFromJSON=function _(o){return Point$4.fromJSON(this,o)};Point$4.prototype.precompute=function _(){};Point$4.prototype._encode=function _(){return this.getX().toArray("be",this.curve.p.byteLength())};Point$4.fromJSON=function _(o,$){return new Point$4(o,$[0],$[1]||o.one)};Point$4.prototype.inspect=function _(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point$4.prototype.isInfinity=function _(){return this.z.cmpn(0)===0};Point$4.prototype.dbl=function _(){var o=this.x.redAdd(this.z),$=o.redSqr(),j=this.x.redSub(this.z),et=j.redSqr(),tt=$.redSub(et),rt=$.redMul(et),nt=tt.redMul(et.redAdd(this.curve.a24.redMul(tt)));return this.curve.point(rt,nt)};Point$4.prototype.add=function _(){throw new Error("Not supported on Montgomery curve")};Point$4.prototype.diffAdd=function _(o,$){var j=this.x.redAdd(this.z),et=this.x.redSub(this.z),tt=o.x.redAdd(o.z),rt=o.x.redSub(o.z),nt=rt.redMul(j),it=tt.redMul(et),st=$.z.redMul(nt.redAdd(it).redSqr()),ot=$.x.redMul(nt.redISub(it).redSqr());return this.curve.point(st,ot)};Point$4.prototype.mul=function _(o){for(var $=o.clone(),j=this,et=this.curve.point(null,null),tt=this,rt=[];$.cmpn(0)!==0;$.iushrn(1))rt.push($.andln(1));for(var nt=rt.length-1;nt>=0;nt--)rt[nt]===0?(j=j.diffAdd(et,tt),et=et.dbl()):(et=j.diffAdd(et,tt),j=j.dbl());return et};Point$4.prototype.mulAdd=function _(){throw new Error("Not supported on Montgomery curve")};Point$4.prototype.jumlAdd=function _(){throw new Error("Not supported on Montgomery curve")};Point$4.prototype.eq=function _(o){return this.getX().cmp(o.getX())===0};Point$4.prototype.normalize=function _(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Point$4.prototype.getX=function _(){return this.normalize(),this.x.fromRed()};var utils$i=utils$n,BN$6=bnExports$4,inherits$2=inherits_browserExports,Base=base$7,assert$i=utils$i.assert;function EdwardsCurve(_){this.twisted=(_.a|0)!==1,this.mOneA=this.twisted&&(_.a|0)===-1,this.extended=this.mOneA,Base.call(this,"edwards",_),this.a=new BN$6(_.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN$6(_.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN$6(_.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),assert$i(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(_.c|0)===1}inherits$2(EdwardsCurve,Base);var edwards=EdwardsCurve;EdwardsCurve.prototype._mulA=function _(o){return this.mOneA?o.redNeg():this.a.redMul(o)};EdwardsCurve.prototype._mulC=function _(o){return this.oneC?o:this.c.redMul(o)};EdwardsCurve.prototype.jpoint=function _(o,$,j,et){return this.point(o,$,j,et)};EdwardsCurve.prototype.pointFromX=function _(o,$){o=new BN$6(o,16),o.red||(o=o.toRed(this.red));var j=o.redSqr(),et=this.c2.redSub(this.a.redMul(j)),tt=this.one.redSub(this.c2.redMul(this.d).redMul(j)),rt=et.redMul(tt.redInvm()),nt=rt.redSqrt();if(nt.redSqr().redSub(rt).cmp(this.zero)!==0)throw new Error("invalid point");var it=nt.fromRed().isOdd();return($&&!it||!$&&it)&&(nt=nt.redNeg()),this.point(o,nt)};EdwardsCurve.prototype.pointFromY=function _(o,$){o=new BN$6(o,16),o.red||(o=o.toRed(this.red));var j=o.redSqr(),et=j.redSub(this.c2),tt=j.redMul(this.d).redMul(this.c2).redSub(this.a),rt=et.redMul(tt.redInvm());if(rt.cmp(this.zero)===0){if($)throw new Error("invalid point");return this.point(this.zero,o)}var nt=rt.redSqrt();if(nt.redSqr().redSub(rt).cmp(this.zero)!==0)throw new Error("invalid point");return nt.fromRed().isOdd()!==$&&(nt=nt.redNeg()),this.point(nt,o)};EdwardsCurve.prototype.validate=function _(o){if(o.isInfinity())return!0;o.normalize();var $=o.x.redSqr(),j=o.y.redSqr(),et=$.redMul(this.a).redAdd(j),tt=this.c2.redMul(this.one.redAdd(this.d.redMul($).redMul(j)));return et.cmp(tt)===0};function Point$3(_,o,$,j,et){Base.BasePoint.call(this,_,"projective"),o===null&&$===null&&j===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN$6(o,16),this.y=new BN$6($,16),this.z=j?new BN$6(j,16):this.curve.one,this.t=et&&new BN$6(et,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}inherits$2(Point$3,Base.BasePoint);EdwardsCurve.prototype.pointFromJSON=function _(o){return Point$3.fromJSON(this,o)};EdwardsCurve.prototype.point=function _(o,$,j,et){return new Point$3(this,o,$,j,et)};Point$3.fromJSON=function _(o,$){return new Point$3(o,$[0],$[1],$[2])};Point$3.prototype.inspect=function _(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point$3.prototype.isInfinity=function _(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Point$3.prototype._extDbl=function _(){var o=this.x.redSqr(),$=this.y.redSqr(),j=this.z.redSqr();j=j.redIAdd(j);var et=this.curve._mulA(o),tt=this.x.redAdd(this.y).redSqr().redISub(o).redISub($),rt=et.redAdd($),nt=rt.redSub(j),it=et.redSub($),st=tt.redMul(nt),ot=rt.redMul(it),at=tt.redMul(it),ct=nt.redMul(rt);return this.curve.point(st,ot,ct,at)};Point$3.prototype._projDbl=function _(){var o=this.x.redAdd(this.y).redSqr(),$=this.x.redSqr(),j=this.y.redSqr(),et,tt,rt,nt,it,st;if(this.curve.twisted){nt=this.curve._mulA($);var ot=nt.redAdd(j);this.zOne?(et=o.redSub($).redSub(j).redMul(ot.redSub(this.curve.two)),tt=ot.redMul(nt.redSub(j)),rt=ot.redSqr().redSub(ot).redSub(ot)):(it=this.z.redSqr(),st=ot.redSub(it).redISub(it),et=o.redSub($).redISub(j).redMul(st),tt=ot.redMul(nt.redSub(j)),rt=ot.redMul(st))}else nt=$.redAdd(j),it=this.curve._mulC(this.z).redSqr(),st=nt.redSub(it).redSub(it),et=this.curve._mulC(o.redISub(nt)).redMul(st),tt=this.curve._mulC(nt).redMul($.redISub(j)),rt=nt.redMul(st);return this.curve.point(et,tt,rt)};Point$3.prototype.dbl=function _(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Point$3.prototype._extAdd=function _(o){var $=this.y.redSub(this.x).redMul(o.y.redSub(o.x)),j=this.y.redAdd(this.x).redMul(o.y.redAdd(o.x)),et=this.t.redMul(this.curve.dd).redMul(o.t),tt=this.z.redMul(o.z.redAdd(o.z)),rt=j.redSub($),nt=tt.redSub(et),it=tt.redAdd(et),st=j.redAdd($),ot=rt.redMul(nt),at=it.redMul(st),ct=rt.redMul(st),ut=nt.redMul(it);return this.curve.point(ot,at,ut,ct)};Point$3.prototype._projAdd=function _(o){var $=this.z.redMul(o.z),j=$.redSqr(),et=this.x.redMul(o.x),tt=this.y.redMul(o.y),rt=this.curve.d.redMul(et).redMul(tt),nt=j.redSub(rt),it=j.redAdd(rt),st=this.x.redAdd(this.y).redMul(o.x.redAdd(o.y)).redISub(et).redISub(tt),ot=$.redMul(nt).redMul(st),at,ct;return this.curve.twisted?(at=$.redMul(it).redMul(tt.redSub(this.curve._mulA(et))),ct=nt.redMul(it)):(at=$.redMul(it).redMul(tt.redSub(et)),ct=this.curve._mulC(nt).redMul(it)),this.curve.point(ot,at,ct)};Point$3.prototype.add=function _(o){return this.isInfinity()?o:o.isInfinity()?this:this.curve.extended?this._extAdd(o):this._projAdd(o)};Point$3.prototype.mul=function _(o){return this._hasDoubles(o)?this.curve._fixedNafMul(this,o):this.curve._wnafMul(this,o)};Point$3.prototype.mulAdd=function _(o,$,j){return this.curve._wnafMulAdd(1,[this,$],[o,j],2,!1)};Point$3.prototype.jmulAdd=function _(o,$,j){return this.curve._wnafMulAdd(1,[this,$],[o,j],2,!0)};Point$3.prototype.normalize=function _(){if(this.zOne)return this;var o=this.z.redInvm();return this.x=this.x.redMul(o),this.y=this.y.redMul(o),this.t&&(this.t=this.t.redMul(o)),this.z=this.curve.one,this.zOne=!0,this};Point$3.prototype.neg=function _(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Point$3.prototype.getX=function _(){return this.normalize(),this.x.fromRed()};Point$3.prototype.getY=function _(){return this.normalize(),this.y.fromRed()};Point$3.prototype.eq=function _(o){return this===o||this.getX().cmp(o.getX())===0&&this.getY().cmp(o.getY())===0};Point$3.prototype.eqXToP=function _(o){var $=o.toRed(this.curve.red).redMul(this.z);if(this.x.cmp($)===0)return!0;for(var j=o.clone(),et=this.curve.redN.redMul(this.z);;){if(j.iadd(this.curve.n),j.cmp(this.curve.p)>=0)return!1;if($.redIAdd(et),this.x.cmp($)===0)return!0}};Point$3.prototype.toP=Point$3.prototype.normalize;Point$3.prototype.mixedAdd=Point$3.prototype.add;(function(_){var o=_;o.base=base$7,o.short=short,o.mont=mont,o.edwards=edwards})(curve);var curves$1={},hash$5={},utils$h={},assert$h=minimalisticAssert$1,inherits$1=inherits_browserExports;utils$h.inherits=inherits$1;function isSurrogatePair(_,o){return(_.charCodeAt(o)&64512)!==55296||o<0||o+1>=_.length?!1:(_.charCodeAt(o+1)&64512)===56320}function toArray(_,o){if(Array.isArray(_))return _.slice();if(!_)return[];var $=[];if(typeof _=="string")if(o){if(o==="hex")for(_=_.replace(/[^a-z0-9]+/ig,""),_.length%2!==0&&(_="0"+_),et=0;et<_.length;et+=2)$.push(parseInt(_[et]+_[et+1],16))}else for(var j=0,et=0;et<_.length;et++){var tt=_.charCodeAt(et);tt<128?$[j++]=tt:tt<2048?($[j++]=tt>>6|192,$[j++]=tt&63|128):isSurrogatePair(_,et)?(tt=65536+((tt&1023)<<10)+(_.charCodeAt(++et)&1023),$[j++]=tt>>18|240,$[j++]=tt>>12&63|128,$[j++]=tt>>6&63|128,$[j++]=tt&63|128):($[j++]=tt>>12|224,$[j++]=tt>>6&63|128,$[j++]=tt&63|128)}else for(et=0;et<_.length;et++)$[et]=_[et]|0;return $}utils$h.toArray=toArray;function toHex$1(_){for(var o="",$=0;$<_.length;$++)o+=zero2(_[$].toString(16));return o}utils$h.toHex=toHex$1;function htonl(_){var o=_>>>24|_>>>8&65280|_<<8&16711680|(_&255)<<24;return o>>>0}utils$h.htonl=htonl;function toHex32(_,o){for(var $="",j=0;j<_.length;j++){var et=_[j];o==="little"&&(et=htonl(et)),$+=zero8(et.toString(16))}return $}utils$h.toHex32=toHex32;function zero2(_){return _.length===1?"0"+_:_}utils$h.zero2=zero2;function zero8(_){return _.length===7?"0"+_:_.length===6?"00"+_:_.length===5?"000"+_:_.length===4?"0000"+_:_.length===3?"00000"+_:_.length===2?"000000"+_:_.length===1?"0000000"+_:_}utils$h.zero8=zero8;function join32(_,o,$,j){var et=$-o;assert$h(et%4===0);for(var tt=new Array(et/4),rt=0,nt=o;rt<tt.length;rt++,nt+=4){var it;j==="big"?it=_[nt]<<24|_[nt+1]<<16|_[nt+2]<<8|_[nt+3]:it=_[nt+3]<<24|_[nt+2]<<16|_[nt+1]<<8|_[nt],tt[rt]=it>>>0}return tt}utils$h.join32=join32;function split32(_,o){for(var $=new Array(_.length*4),j=0,et=0;j<_.length;j++,et+=4){var tt=_[j];o==="big"?($[et]=tt>>>24,$[et+1]=tt>>>16&255,$[et+2]=tt>>>8&255,$[et+3]=tt&255):($[et+3]=tt>>>24,$[et+2]=tt>>>16&255,$[et+1]=tt>>>8&255,$[et]=tt&255)}return $}utils$h.split32=split32;function rotr32$1(_,o){return _>>>o|_<<32-o}utils$h.rotr32=rotr32$1;function rotl32$2(_,o){return _<<o|_>>>32-o}utils$h.rotl32=rotl32$2;function sum32$3(_,o){return _+o>>>0}utils$h.sum32=sum32$3;function sum32_3$1(_,o,$){return _+o+$>>>0}utils$h.sum32_3=sum32_3$1;function sum32_4$2(_,o,$,j){return _+o+$+j>>>0}utils$h.sum32_4=sum32_4$2;function sum32_5$2(_,o,$,j,et){return _+o+$+j+et>>>0}utils$h.sum32_5=sum32_5$2;function sum64$1(_,o,$,j){var et=_[o],tt=_[o+1],rt=j+tt>>>0,nt=(rt<j?1:0)+$+et;_[o]=nt>>>0,_[o+1]=rt}utils$h.sum64=sum64$1;function sum64_hi$1(_,o,$,j){var et=o+j>>>0,tt=(et<o?1:0)+_+$;return tt>>>0}utils$h.sum64_hi=sum64_hi$1;function sum64_lo$1(_,o,$,j){var et=o+j;return et>>>0}utils$h.sum64_lo=sum64_lo$1;function sum64_4_hi$1(_,o,$,j,et,tt,rt,nt){var it=0,st=o;st=st+j>>>0,it+=st<o?1:0,st=st+tt>>>0,it+=st<tt?1:0,st=st+nt>>>0,it+=st<nt?1:0;var ot=_+$+et+rt+it;return ot>>>0}utils$h.sum64_4_hi=sum64_4_hi$1;function sum64_4_lo$1(_,o,$,j,et,tt,rt,nt){var it=o+j+tt+nt;return it>>>0}utils$h.sum64_4_lo=sum64_4_lo$1;function sum64_5_hi$1(_,o,$,j,et,tt,rt,nt,it,st){var ot=0,at=o;at=at+j>>>0,ot+=at<o?1:0,at=at+tt>>>0,ot+=at<tt?1:0,at=at+nt>>>0,ot+=at<nt?1:0,at=at+st>>>0,ot+=at<st?1:0;var ct=_+$+et+rt+it+ot;return ct>>>0}utils$h.sum64_5_hi=sum64_5_hi$1;function sum64_5_lo$1(_,o,$,j,et,tt,rt,nt,it,st){var ot=o+j+tt+nt+st;return ot>>>0}utils$h.sum64_5_lo=sum64_5_lo$1;function rotr64_hi$1(_,o,$){var j=o<<32-$|_>>>$;return j>>>0}utils$h.rotr64_hi=rotr64_hi$1;function rotr64_lo$1(_,o,$){var j=_<<32-$|o>>>$;return j>>>0}utils$h.rotr64_lo=rotr64_lo$1;function shr64_hi$1(_,o,$){return _>>>$}utils$h.shr64_hi=shr64_hi$1;function shr64_lo$1(_,o,$){var j=_<<32-$|o>>>$;return j>>>0}utils$h.shr64_lo=shr64_lo$1;var common$7={},utils$g=utils$h,assert$g=minimalisticAssert$1;function BlockHash$4(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}common$7.BlockHash=BlockHash$4;BlockHash$4.prototype.update=function _(o,$){if(o=utils$g.toArray(o,$),this.pending?this.pending=this.pending.concat(o):this.pending=o,this.pendingTotal+=o.length,this.pending.length>=this._delta8){o=this.pending;var j=o.length%this._delta8;this.pending=o.slice(o.length-j,o.length),this.pending.length===0&&(this.pending=null),o=utils$g.join32(o,0,o.length-j,this.endian);for(var et=0;et<o.length;et+=this._delta32)this._update(o,et,et+this._delta32)}return this};BlockHash$4.prototype.digest=function _(o){return this.update(this._pad()),assert$g(this.pending===null),this._digest(o)};BlockHash$4.prototype._pad=function _(){var o=this.pendingTotal,$=this._delta8,j=$-(o+this.padLength)%$,et=new Array(j+this.padLength);et[0]=128;for(var tt=1;tt<j;tt++)et[tt]=0;if(o<<=3,this.endian==="big"){for(var rt=8;rt<this.padLength;rt++)et[tt++]=0;et[tt++]=0,et[tt++]=0,et[tt++]=0,et[tt++]=0,et[tt++]=o>>>24&255,et[tt++]=o>>>16&255,et[tt++]=o>>>8&255,et[tt++]=o&255}else for(et[tt++]=o&255,et[tt++]=o>>>8&255,et[tt++]=o>>>16&255,et[tt++]=o>>>24&255,et[tt++]=0,et[tt++]=0,et[tt++]=0,et[tt++]=0,rt=8;rt<this.padLength;rt++)et[tt++]=0;return et};var sha$2={},common$6={},utils$f=utils$h,rotr32=utils$f.rotr32;function ft_1$1(_,o,$,j){if(_===0)return ch32$1(o,$,j);if(_===1||_===3)return p32(o,$,j);if(_===2)return maj32$1(o,$,j)}common$6.ft_1=ft_1$1;function ch32$1(_,o,$){return _&o^~_&$}common$6.ch32=ch32$1;function maj32$1(_,o,$){return _&o^_&$^o&$}common$6.maj32=maj32$1;function p32(_,o,$){return _^o^$}common$6.p32=p32;function s0_256$1(_){return rotr32(_,2)^rotr32(_,13)^rotr32(_,22)}common$6.s0_256=s0_256$1;function s1_256$1(_){return rotr32(_,6)^rotr32(_,11)^rotr32(_,25)}common$6.s1_256=s1_256$1;function g0_256$1(_){return rotr32(_,7)^rotr32(_,18)^_>>>3}common$6.g0_256=g0_256$1;function g1_256$1(_){return rotr32(_,17)^rotr32(_,19)^_>>>10}common$6.g1_256=g1_256$1;var utils$e=utils$h,common$5=common$7,shaCommon$1=common$6,rotl32$1=utils$e.rotl32,sum32$2=utils$e.sum32,sum32_5$1=utils$e.sum32_5,ft_1=shaCommon$1.ft_1,BlockHash$3=common$5.BlockHash,sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash$3.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}utils$e.inherits(SHA1,BlockHash$3);var _1=SHA1;SHA1.blockSize=512;SHA1.outSize=160;SHA1.hmacStrength=80;SHA1.padLength=64;SHA1.prototype._update=function _(o,$){for(var j=this.W,et=0;et<16;et++)j[et]=o[$+et];for(;et<j.length;et++)j[et]=rotl32$1(j[et-3]^j[et-8]^j[et-14]^j[et-16],1);var tt=this.h[0],rt=this.h[1],nt=this.h[2],it=this.h[3],st=this.h[4];for(et=0;et<j.length;et++){var ot=~~(et/20),at=sum32_5$1(rotl32$1(tt,5),ft_1(ot,rt,nt,it),st,j[et],sha1_K[ot]);st=it,it=nt,nt=rotl32$1(rt,30),rt=tt,tt=at}this.h[0]=sum32$2(this.h[0],tt),this.h[1]=sum32$2(this.h[1],rt),this.h[2]=sum32$2(this.h[2],nt),this.h[3]=sum32$2(this.h[3],it),this.h[4]=sum32$2(this.h[4],st)};SHA1.prototype._digest=function _(o){return o==="hex"?utils$e.toHex32(this.h,"big"):utils$e.split32(this.h,"big")};var utils$d=utils$h,common$4=common$7,shaCommon=common$6,assert$f=minimalisticAssert$1,sum32$1=utils$d.sum32,sum32_4$1=utils$d.sum32_4,sum32_5=utils$d.sum32_5,ch32=shaCommon.ch32,maj32=shaCommon.maj32,s0_256=shaCommon.s0_256,s1_256=shaCommon.s1_256,g0_256=shaCommon.g0_256,g1_256=shaCommon.g1_256,BlockHash$2=common$4.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function SHA256$1(){if(!(this instanceof SHA256$1))return new SHA256$1;BlockHash$2.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,this.W=new Array(64)}utils$d.inherits(SHA256$1,BlockHash$2);var _256=SHA256$1;SHA256$1.blockSize=512;SHA256$1.outSize=256;SHA256$1.hmacStrength=192;SHA256$1.padLength=64;SHA256$1.prototype._update=function _(o,$){for(var j=this.W,et=0;et<16;et++)j[et]=o[$+et];for(;et<j.length;et++)j[et]=sum32_4$1(g1_256(j[et-2]),j[et-7],g0_256(j[et-15]),j[et-16]);var tt=this.h[0],rt=this.h[1],nt=this.h[2],it=this.h[3],st=this.h[4],ot=this.h[5],at=this.h[6],ct=this.h[7];for(assert$f(this.k.length===j.length),et=0;et<j.length;et++){var ut=sum32_5(ct,s1_256(st),ch32(st,ot,at),this.k[et],j[et]),ft=sum32$1(s0_256(tt),maj32(tt,rt,nt));ct=at,at=ot,ot=st,st=sum32$1(it,ut),it=nt,nt=rt,rt=tt,tt=sum32$1(ut,ft)}this.h[0]=sum32$1(this.h[0],tt),this.h[1]=sum32$1(this.h[1],rt),this.h[2]=sum32$1(this.h[2],nt),this.h[3]=sum32$1(this.h[3],it),this.h[4]=sum32$1(this.h[4],st),this.h[5]=sum32$1(this.h[5],ot),this.h[6]=sum32$1(this.h[6],at),this.h[7]=sum32$1(this.h[7],ct)};SHA256$1.prototype._digest=function _(o){return o==="hex"?utils$d.toHex32(this.h,"big"):utils$d.split32(this.h,"big")};var utils$c=utils$h,SHA256=_256;function SHA224(){if(!(this instanceof SHA224))return new SHA224;SHA256.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}utils$c.inherits(SHA224,SHA256);var _224=SHA224;SHA224.blockSize=512;SHA224.outSize=224;SHA224.hmacStrength=192;SHA224.padLength=64;SHA224.prototype._digest=function _(o){return o==="hex"?utils$c.toHex32(this.h.slice(0,7),"big"):utils$c.split32(this.h.slice(0,7),"big")};var utils$b=utils$h,common$3=common$7,assert$e=minimalisticAssert$1,rotr64_hi=utils$b.rotr64_hi,rotr64_lo=utils$b.rotr64_lo,shr64_hi=utils$b.shr64_hi,shr64_lo=utils$b.shr64_lo,sum64=utils$b.sum64,sum64_hi=utils$b.sum64_hi,sum64_lo=utils$b.sum64_lo,sum64_4_hi=utils$b.sum64_4_hi,sum64_4_lo=utils$b.sum64_4_lo,sum64_5_hi=utils$b.sum64_5_hi,sum64_5_lo=utils$b.sum64_5_lo,BlockHash$1=common$3.BlockHash,sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512$1(){if(!(this instanceof SHA512$1))return new SHA512$1;BlockHash$1.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,this.W=new Array(160)}utils$b.inherits(SHA512$1,BlockHash$1);var _512=SHA512$1;SHA512$1.blockSize=1024;SHA512$1.outSize=512;SHA512$1.hmacStrength=192;SHA512$1.padLength=128;SHA512$1.prototype._prepareBlock=function _(o,$){for(var j=this.W,et=0;et<32;et++)j[et]=o[$+et];for(;et<j.length;et+=2){var tt=g1_512_hi(j[et-4],j[et-3]),rt=g1_512_lo(j[et-4],j[et-3]),nt=j[et-14],it=j[et-13],st=g0_512_hi(j[et-30],j[et-29]),ot=g0_512_lo(j[et-30],j[et-29]),at=j[et-32],ct=j[et-31];j[et]=sum64_4_hi(tt,rt,nt,it,st,ot,at,ct),j[et+1]=sum64_4_lo(tt,rt,nt,it,st,ot,at,ct)}};SHA512$1.prototype._update=function _(o,$){this._prepareBlock(o,$);var j=this.W,et=this.h[0],tt=this.h[1],rt=this.h[2],nt=this.h[3],it=this.h[4],st=this.h[5],ot=this.h[6],at=this.h[7],ct=this.h[8],ut=this.h[9],ft=this.h[10],ht=this.h[11],mt=this.h[12],gt=this.h[13],Et=this.h[14],St=this.h[15];assert$e(this.k.length===j.length);for(var At=0;At<j.length;At+=2){var kt=Et,Rt=St,Tt=s1_512_hi(ct,ut),Dt=s1_512_lo(ct,ut),Ot=ch64_hi(ct,ut,ft,ht,mt),jt=ch64_lo(ct,ut,ft,ht,mt,gt),Nt=this.k[At],It=this.k[At+1],yt=j[At],lt=j[At+1],pt=sum64_5_hi(kt,Rt,Tt,Dt,Ot,jt,Nt,It,yt,lt),bt=sum64_5_lo(kt,Rt,Tt,Dt,Ot,jt,Nt,It,yt,lt);kt=s0_512_hi(et,tt),Rt=s0_512_lo(et,tt),Tt=maj64_hi(et,tt,rt,nt,it),Dt=maj64_lo(et,tt,rt,nt,it,st);var _t=sum64_hi(kt,Rt,Tt,Dt),$t=sum64_lo(kt,Rt,Tt,Dt);Et=mt,St=gt,mt=ft,gt=ht,ft=ct,ht=ut,ct=sum64_hi(ot,at,pt,bt),ut=sum64_lo(at,at,pt,bt),ot=it,at=st,it=rt,st=nt,rt=et,nt=tt,et=sum64_hi(pt,bt,_t,$t),tt=sum64_lo(pt,bt,_t,$t)}sum64(this.h,0,et,tt),sum64(this.h,2,rt,nt),sum64(this.h,4,it,st),sum64(this.h,6,ot,at),sum64(this.h,8,ct,ut),sum64(this.h,10,ft,ht),sum64(this.h,12,mt,gt),sum64(this.h,14,Et,St)};SHA512$1.prototype._digest=function _(o){return o==="hex"?utils$b.toHex32(this.h,"big"):utils$b.split32(this.h,"big")};function ch64_hi(_,o,$,j,et){var tt=_&$^~_&et;return tt<0&&(tt+=4294967296),tt}function ch64_lo(_,o,$,j,et,tt){var rt=o&j^~o&tt;return rt<0&&(rt+=4294967296),rt}function maj64_hi(_,o,$,j,et){var tt=_&$^_&et^$&et;return tt<0&&(tt+=4294967296),tt}function maj64_lo(_,o,$,j,et,tt){var rt=o&j^o&tt^j&tt;return rt<0&&(rt+=4294967296),rt}function s0_512_hi(_,o){var $=rotr64_hi(_,o,28),j=rotr64_hi(o,_,2),et=rotr64_hi(o,_,7),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}function s0_512_lo(_,o){var $=rotr64_lo(_,o,28),j=rotr64_lo(o,_,2),et=rotr64_lo(o,_,7),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}function s1_512_hi(_,o){var $=rotr64_hi(_,o,14),j=rotr64_hi(_,o,18),et=rotr64_hi(o,_,9),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}function s1_512_lo(_,o){var $=rotr64_lo(_,o,14),j=rotr64_lo(_,o,18),et=rotr64_lo(o,_,9),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}function g0_512_hi(_,o){var $=rotr64_hi(_,o,1),j=rotr64_hi(_,o,8),et=shr64_hi(_,o,7),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}function g0_512_lo(_,o){var $=rotr64_lo(_,o,1),j=rotr64_lo(_,o,8),et=shr64_lo(_,o,7),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}function g1_512_hi(_,o){var $=rotr64_hi(_,o,19),j=rotr64_hi(o,_,29),et=shr64_hi(_,o,6),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}function g1_512_lo(_,o){var $=rotr64_lo(_,o,19),j=rotr64_lo(o,_,29),et=shr64_lo(_,o,6),tt=$^j^et;return tt<0&&(tt+=4294967296),tt}var utils$a=utils$h,SHA512=_512;function SHA384(){if(!(this instanceof SHA384))return new SHA384;SHA512.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}utils$a.inherits(SHA384,SHA512);var _384=SHA384;SHA384.blockSize=1024;SHA384.outSize=384;SHA384.hmacStrength=192;SHA384.padLength=128;SHA384.prototype._digest=function _(o){return o==="hex"?utils$a.toHex32(this.h.slice(0,12),"big"):utils$a.split32(this.h.slice(0,12),"big")};sha$2.sha1=_1;sha$2.sha224=_224;sha$2.sha256=_256;sha$2.sha384=_384;sha$2.sha512=_512;var ripemd={},utils$9=utils$h,common$2=common$7,rotl32=utils$9.rotl32,sum32=utils$9.sum32,sum32_3=utils$9.sum32_3,sum32_4=utils$9.sum32_4,BlockHash=common$2.BlockHash;function RIPEMD160(){if(!(this instanceof RIPEMD160))return new RIPEMD160;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}utils$9.inherits(RIPEMD160,BlockHash);ripemd.ripemd160=RIPEMD160;RIPEMD160.blockSize=512;RIPEMD160.outSize=160;RIPEMD160.hmacStrength=192;RIPEMD160.padLength=64;RIPEMD160.prototype._update=function _(o,$){for(var j=this.h[0],et=this.h[1],tt=this.h[2],rt=this.h[3],nt=this.h[4],it=j,st=et,ot=tt,at=rt,ct=nt,ut=0;ut<80;ut++){var ft=sum32(rotl32(sum32_4(j,f(ut,et,tt,rt),o[r[ut]+$],K$1(ut)),s$2[ut]),nt);j=nt,nt=rt,rt=rotl32(tt,10),tt=et,et=ft,ft=sum32(rotl32(sum32_4(it,f(79-ut,st,ot,at),o[rh[ut]+$],Kh(ut)),sh[ut]),ct),it=ct,ct=at,at=rotl32(ot,10),ot=st,st=ft}ft=sum32_3(this.h[1],tt,at),this.h[1]=sum32_3(this.h[2],rt,ct),this.h[2]=sum32_3(this.h[3],nt,it),this.h[3]=sum32_3(this.h[4],j,st),this.h[4]=sum32_3(this.h[0],et,ot),this.h[0]=ft};RIPEMD160.prototype._digest=function _(o){return o==="hex"?utils$9.toHex32(this.h,"little"):utils$9.split32(this.h,"little")};function f(_,o,$,j){return _<=15?o^$^j:_<=31?o&$|~o&j:_<=47?(o|~$)^j:_<=63?o&j|$&~j:o^($|~j)}function K$1(_){return _<=15?0:_<=31?1518500249:_<=47?1859775393:_<=63?2400959708:2840853838}function Kh(_){return _<=15?1352829926:_<=31?1548603684:_<=47?1836072691:_<=63?2053994217:0}var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s$2=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],utils$8=utils$h,assert$d=minimalisticAssert$1;function Hmac(_,o,$){if(!(this instanceof Hmac))return new Hmac(_,o,$);this.Hash=_,this.blockSize=_.blockSize/8,this.outSize=_.outSize/8,this.inner=null,this.outer=null,this._init(utils$8.toArray(o,$))}var hmac$2=Hmac;Hmac.prototype._init=function _(o){o.length>this.blockSize&&(o=new this.Hash().update(o).digest()),assert$d(o.length<=this.blockSize);for(var $=o.length;$<this.blockSize;$++)o.push(0);for($=0;$<o.length;$++)o[$]^=54;for(this.inner=new this.Hash().update(o),$=0;$<o.length;$++)o[$]^=106;this.outer=new this.Hash().update(o)};Hmac.prototype.update=function _(o,$){return this.inner.update(o,$),this};Hmac.prototype.digest=function _(o){return this.outer.update(this.inner.digest()),this.outer.digest(o)};(function(_){var o=_;o.utils=utils$h,o.common=common$7,o.sha=sha$2,o.ripemd=ripemd,o.hmac=hmac$2,o.sha1=o.sha.sha1,o.sha256=o.sha.sha256,o.sha224=o.sha.sha224,o.sha384=o.sha.sha384,o.sha512=o.sha.sha512,o.ripemd160=o.ripemd.ripemd160})(hash$5);var secp256k1$1,hasRequiredSecp256k1;function requireSecp256k1(){return hasRequiredSecp256k1||(hasRequiredSecp256k1=1,secp256k1$1={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),secp256k1$1}(function(_){var o=_,$=hash$5,j=curve,et=utils$n,tt=et.assert;function rt(st){st.type==="short"?this.curve=new j.short(st):st.type==="edwards"?this.curve=new j.edwards(st):this.curve=new j.mont(st),this.g=this.curve.g,this.n=this.curve.n,this.hash=st.hash,tt(this.g.validate(),"Invalid curve"),tt(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}o.PresetCurve=rt;function nt(st,ot){Object.defineProperty(o,st,{configurable:!0,enumerable:!0,get:function(){var at=new rt(ot);return Object.defineProperty(o,st,{configurable:!0,enumerable:!0,value:at}),at}})}nt("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:$.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),nt("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:$.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),nt("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:$.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),nt("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:$.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),nt("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:$.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),nt("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:$.sha256,gRed:!1,g:["9"]}),nt("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:$.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var it;try{it=requireSecp256k1()}catch{it=void 0}nt("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:$.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",it]})})(curves$1);var hash$4=hash$5,utils$7=utils$m,assert$c=minimalisticAssert$1;function HmacDRBG$1(_){if(!(this instanceof HmacDRBG$1))return new HmacDRBG$1(_);this.hash=_.hash,this.predResist=!!_.predResist,this.outLen=this.hash.outSize,this.minEntropy=_.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var o=utils$7.toArray(_.entropy,_.entropyEnc||"hex"),$=utils$7.toArray(_.nonce,_.nonceEnc||"hex"),j=utils$7.toArray(_.pers,_.persEnc||"hex");assert$c(o.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(o,$,j)}var hmacDrbg$1=HmacDRBG$1;HmacDRBG$1.prototype._init=function _(o,$,j){var et=o.concat($).concat(j);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var tt=0;tt<this.V.length;tt++)this.K[tt]=0,this.V[tt]=1;this._update(et),this._reseed=1,this.reseedInterval=281474976710656};HmacDRBG$1.prototype._hmac=function _(){return new hash$4.hmac(this.hash,this.K)};HmacDRBG$1.prototype._update=function _(o){var $=this._hmac().update(this.V).update([0]);o&&($=$.update(o)),this.K=$.digest(),this.V=this._hmac().update(this.V).digest(),o&&(this.K=this._hmac().update(this.V).update([1]).update(o).digest(),this.V=this._hmac().update(this.V).digest())};HmacDRBG$1.prototype.reseed=function _(o,$,j,et){typeof $!="string"&&(et=j,j=$,$=null),o=utils$7.toArray(o,$),j=utils$7.toArray(j,et),assert$c(o.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(o.concat(j||[])),this._reseed=1};HmacDRBG$1.prototype.generate=function _(o,$,j,et){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof $!="string"&&(et=j,j=$,$=null),j&&(j=utils$7.toArray(j,et||"hex"),this._update(j));for(var tt=[];tt.length<o;)this.V=this._hmac().update(this.V).digest(),tt=tt.concat(this.V);var rt=tt.slice(0,o);return this._update(j),this._reseed++,utils$7.encode(rt,$)};var BN$5=bnExports$4,utils$6=utils$n,assert$b=utils$6.assert;function KeyPair$3(_,o){this.ec=_,this.priv=null,this.pub=null,o.priv&&this._importPrivate(o.priv,o.privEnc),o.pub&&this._importPublic(o.pub,o.pubEnc)}var key$2=KeyPair$3;KeyPair$3.fromPublic=function _(o,$,j){return $ instanceof KeyPair$3?$:new KeyPair$3(o,{pub:$,pubEnc:j})};KeyPair$3.fromPrivate=function _(o,$,j){return $ instanceof KeyPair$3?$:new KeyPair$3(o,{priv:$,privEnc:j})};KeyPair$3.prototype.validate=function _(){var o=this.getPublic();return o.isInfinity()?{result:!1,reason:"Invalid public key"}:o.validate()?o.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};KeyPair$3.prototype.getPublic=function _(o,$){return typeof o=="string"&&($=o,o=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),$?this.pub.encode($,o):this.pub};KeyPair$3.prototype.getPrivate=function _(o){return o==="hex"?this.priv.toString(16,2):this.priv};KeyPair$3.prototype._importPrivate=function _(o,$){this.priv=new BN$5(o,$||16),this.priv=this.priv.umod(this.ec.curve.n)};KeyPair$3.prototype._importPublic=function _(o,$){if(o.x||o.y){this.ec.curve.type==="mont"?assert$b(o.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&assert$b(o.x&&o.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(o.x,o.y);return}this.pub=this.ec.curve.decodePoint(o,$)};KeyPair$3.prototype.derive=function _(o){return o.validate()||assert$b(o.validate(),"public point not validated"),o.mul(this.priv).getX()};KeyPair$3.prototype.sign=function _(o,$,j){return this.ec.sign(o,this,$,j)};KeyPair$3.prototype.verify=function _(o,$){return this.ec.verify(o,$,this)};KeyPair$3.prototype.inspect=function _(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var BN$4=bnExports$4,utils$5=utils$n,assert$a=utils$5.assert;function Signature$5(_,o){if(_ instanceof Signature$5)return _;this._importDER(_,o)||(assert$a(_.r&&_.s,"Signature without r or s"),this.r=new BN$4(_.r,16),this.s=new BN$4(_.s,16),_.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=_.recoveryParam)}var signature$2=Signature$5;function Position$1(){this.place=0}function getLength$2(_,o){var $=_[o.place++];if(!($&128))return $;var j=$&15;if(j===0||j>4)return!1;for(var et=0,tt=0,rt=o.place;tt<j;tt++,rt++)et<<=8,et|=_[rt],et>>>=0;return et<=127?!1:(o.place=rt,et)}function rmPadding$1(_){for(var o=0,$=_.length-1;!_[o]&&!(_[o+1]&128)&&o<$;)o++;return o===0?_:_.slice(o)}Signature$5.prototype._importDER=function _(o,$){o=utils$5.toArray(o,$);var j=new Position$1;if(o[j.place++]!==48)return!1;var et=getLength$2(o,j);if(et===!1||et+j.place!==o.length||o[j.place++]!==2)return!1;var tt=getLength$2(o,j);if(tt===!1)return!1;var rt=o.slice(j.place,tt+j.place);if(j.place+=tt,o[j.place++]!==2)return!1;var nt=getLength$2(o,j);if(nt===!1||o.length!==nt+j.place)return!1;var it=o.slice(j.place,nt+j.place);if(rt[0]===0)if(rt[1]&128)rt=rt.slice(1);else return!1;if(it[0]===0)if(it[1]&128)it=it.slice(1);else return!1;return this.r=new BN$4(rt),this.s=new BN$4(it),this.recoveryParam=null,!0};function constructLength$1(_,o){if(o<128){_.push(o);return}var $=1+(Math.log(o)/Math.LN2>>>3);for(_.push($|128);--$;)_.push(o>>>($<<3)&255);_.push(o)}Signature$5.prototype.toDER=function _(o){var $=this.r.toArray(),j=this.s.toArray();for($[0]&128&&($=[0].concat($)),j[0]&128&&(j=[0].concat(j)),$=rmPadding$1($),j=rmPadding$1(j);!j[0]&&!(j[1]&128);)j=j.slice(1);var et=[2];constructLength$1(et,$.length),et=et.concat($),et.push(2),constructLength$1(et,j.length);var tt=et.concat(j),rt=[48];return constructLength$1(rt,tt.length),rt=rt.concat(tt),utils$5.encode(rt,o)};var ec$3,hasRequiredEc;function requireEc(){if(hasRequiredEc)return ec$3;hasRequiredEc=1;var _=bnExports$4,o=hmacDrbg$1,$=utils$n,j=curves$1,et=requireBrorand(),tt=$.assert,rt=key$2,nt=signature$2;function it(st){if(!(this instanceof it))return new it(st);typeof st=="string"&&(tt(Object.prototype.hasOwnProperty.call(j,st),"Unknown curve "+st),st=j[st]),st instanceof j.PresetCurve&&(st={curve:st}),this.curve=st.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=st.curve.g,this.g.precompute(st.curve.n.bitLength()+1),this.hash=st.hash||st.curve.hash}return ec$3=it,it.prototype.keyPair=function(ot){return new rt(this,ot)},it.prototype.keyFromPrivate=function(ot,at){return rt.fromPrivate(this,ot,at)},it.prototype.keyFromPublic=function(ot,at){return rt.fromPublic(this,ot,at)},it.prototype.genKeyPair=function(ot){ot||(ot={});for(var at=new o({hash:this.hash,pers:ot.pers,persEnc:ot.persEnc||"utf8",entropy:ot.entropy||et(this.hash.hmacStrength),entropyEnc:ot.entropy&&ot.entropyEnc||"utf8",nonce:this.n.toArray()}),ct=this.n.byteLength(),ut=this.n.sub(new _(2));;){var ft=new _(at.generate(ct));if(!(ft.cmp(ut)>0))return ft.iaddn(1),this.keyFromPrivate(ft)}},it.prototype._truncateToN=function(ot,at){var ct=ot.byteLength()*8-this.n.bitLength();return ct>0&&(ot=ot.ushrn(ct)),!at&&ot.cmp(this.n)>=0?ot.sub(this.n):ot},it.prototype.sign=function(ot,at,ct,ut){typeof ct=="object"&&(ut=ct,ct=null),ut||(ut={}),at=this.keyFromPrivate(at,ct),ot=this._truncateToN(new _(ot,16));for(var ft=this.n.byteLength(),ht=at.getPrivate().toArray("be",ft),mt=ot.toArray("be",ft),gt=new o({hash:this.hash,entropy:ht,nonce:mt,pers:ut.pers,persEnc:ut.persEnc||"utf8"}),Et=this.n.sub(new _(1)),St=0;;St++){var At=ut.k?ut.k(St):new _(gt.generate(this.n.byteLength()));if(At=this._truncateToN(At,!0),!(At.cmpn(1)<=0||At.cmp(Et)>=0)){var kt=this.g.mul(At);if(!kt.isInfinity()){var Rt=kt.getX(),Tt=Rt.umod(this.n);if(Tt.cmpn(0)!==0){var Dt=At.invm(this.n).mul(Tt.mul(at.getPrivate()).iadd(ot));if(Dt=Dt.umod(this.n),Dt.cmpn(0)!==0){var Ot=(kt.getY().isOdd()?1:0)|(Rt.cmp(Tt)!==0?2:0);return ut.canonical&&Dt.cmp(this.nh)>0&&(Dt=this.n.sub(Dt),Ot^=1),new nt({r:Tt,s:Dt,recoveryParam:Ot})}}}}}},it.prototype.verify=function(ot,at,ct,ut){ot=this._truncateToN(new _(ot,16)),ct=this.keyFromPublic(ct,ut),at=new nt(at,"hex");var ft=at.r,ht=at.s;if(ft.cmpn(1)<0||ft.cmp(this.n)>=0||ht.cmpn(1)<0||ht.cmp(this.n)>=0)return!1;var mt=ht.invm(this.n),gt=mt.mul(ot).umod(this.n),Et=mt.mul(ft).umod(this.n),St;return this.curve._maxwellTrick?(St=this.g.jmulAdd(gt,ct.getPublic(),Et),St.isInfinity()?!1:St.eqXToP(ft)):(St=this.g.mulAdd(gt,ct.getPublic(),Et),St.isInfinity()?!1:St.getX().umod(this.n).cmp(ft)===0)},it.prototype.recoverPubKey=function(st,ot,at,ct){tt((3&at)===at,"The recovery param is more than two bits"),ot=new nt(ot,ct);var ut=this.n,ft=new _(st),ht=ot.r,mt=ot.s,gt=at&1,Et=at>>1;if(ht.cmp(this.curve.p.umod(this.curve.n))>=0&&Et)throw new Error("Unable to find sencond key candinate");Et?ht=this.curve.pointFromX(ht.add(this.curve.n),gt):ht=this.curve.pointFromX(ht,gt);var St=ot.r.invm(ut),At=ut.sub(ft).mul(St).umod(ut),kt=mt.mul(St).umod(ut);return this.g.mulAdd(At,ht,kt)},it.prototype.getKeyRecoveryParam=function(st,ot,at,ct){if(ot=new nt(ot,ct),ot.recoveryParam!==null)return ot.recoveryParam;for(var ut=0;ut<4;ut++){var ft;try{ft=this.recoverPubKey(st,ot,ut)}catch{continue}if(ft.eq(at))return ut}throw new Error("Unable to find valid recovery factor")},ec$3}var utils$4=utils$n,assert$9=utils$4.assert,parseBytes$3=utils$4.parseBytes,cachedProperty$1=utils$4.cachedProperty;function KeyPair$2(_,o){this.eddsa=_,this._secret=parseBytes$3(o.secret),_.isPoint(o.pub)?this._pub=o.pub:this._pubBytes=parseBytes$3(o.pub)}KeyPair$2.fromPublic=function _(o,$){return $ instanceof KeyPair$2?$:new KeyPair$2(o,{pub:$})};KeyPair$2.fromSecret=function _(o,$){return $ instanceof KeyPair$2?$:new KeyPair$2(o,{secret:$})};KeyPair$2.prototype.secret=function _(){return this._secret};cachedProperty$1(KeyPair$2,"pubBytes",function _(){return this.eddsa.encodePoint(this.pub())});cachedProperty$1(KeyPair$2,"pub",function _(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});cachedProperty$1(KeyPair$2,"privBytes",function _(){var o=this.eddsa,$=this.hash(),j=o.encodingLength-1,et=$.slice(0,o.encodingLength);return et[0]&=248,et[j]&=127,et[j]|=64,et});cachedProperty$1(KeyPair$2,"priv",function _(){return this.eddsa.decodeInt(this.privBytes())});cachedProperty$1(KeyPair$2,"hash",function _(){return this.eddsa.hash().update(this.secret()).digest()});cachedProperty$1(KeyPair$2,"messagePrefix",function _(){return this.hash().slice(this.eddsa.encodingLength)});KeyPair$2.prototype.sign=function _(o){return assert$9(this._secret,"KeyPair can only verify"),this.eddsa.sign(o,this)};KeyPair$2.prototype.verify=function _(o,$){return this.eddsa.verify(o,$,this)};KeyPair$2.prototype.getSecret=function _(o){return assert$9(this._secret,"KeyPair is public only"),utils$4.encode(this.secret(),o)};KeyPair$2.prototype.getPublic=function _(o){return utils$4.encode(this.pubBytes(),o)};var key$1=KeyPair$2,BN$3=bnExports$4,utils$3=utils$n,assert$8=utils$3.assert,cachedProperty=utils$3.cachedProperty,parseBytes$2=utils$3.parseBytes;function Signature$4(_,o){this.eddsa=_,typeof o!="object"&&(o=parseBytes$2(o)),Array.isArray(o)&&(o={R:o.slice(0,_.encodingLength),S:o.slice(_.encodingLength)}),assert$8(o.R&&o.S,"Signature without R or S"),_.isPoint(o.R)&&(this._R=o.R),o.S instanceof BN$3&&(this._S=o.S),this._Rencoded=Array.isArray(o.R)?o.R:o.Rencoded,this._Sencoded=Array.isArray(o.S)?o.S:o.Sencoded}cachedProperty(Signature$4,"S",function _(){return this.eddsa.decodeInt(this.Sencoded())});cachedProperty(Signature$4,"R",function _(){return this.eddsa.decodePoint(this.Rencoded())});cachedProperty(Signature$4,"Rencoded",function _(){return this.eddsa.encodePoint(this.R())});cachedProperty(Signature$4,"Sencoded",function _(){return this.eddsa.encodeInt(this.S())});Signature$4.prototype.toBytes=function _(){return this.Rencoded().concat(this.Sencoded())};Signature$4.prototype.toHex=function _(){return utils$3.encode(this.toBytes(),"hex").toUpperCase()};var signature$1=Signature$4,hash$3=hash$5,curves=curves$1,utils$2=utils$n,assert$7=utils$2.assert,parseBytes$1=utils$2.parseBytes,KeyPair$1=key$1,Signature$3=signature$1;function EDDSA(_){if(assert$7(_==="ed25519","only tested with ed25519 so far"),!(this instanceof EDDSA))return new EDDSA(_);_=curves[_].curve,this.curve=_,this.g=_.g,this.g.precompute(_.n.bitLength()+1),this.pointClass=_.point().constructor,this.encodingLength=Math.ceil(_.n.bitLength()/8),this.hash=hash$3.sha512}var eddsa=EDDSA;EDDSA.prototype.sign=function _(o,$){o=parseBytes$1(o);var j=this.keyFromSecret($),et=this.hashInt(j.messagePrefix(),o),tt=this.g.mul(et),rt=this.encodePoint(tt),nt=this.hashInt(rt,j.pubBytes(),o).mul(j.priv()),it=et.add(nt).umod(this.curve.n);return this.makeSignature({R:tt,S:it,Rencoded:rt})};EDDSA.prototype.verify=function _(o,$,j){o=parseBytes$1(o),$=this.makeSignature($);var et=this.keyFromPublic(j),tt=this.hashInt($.Rencoded(),et.pubBytes(),o),rt=this.g.mul($.S()),nt=$.R().add(et.pub().mul(tt));return nt.eq(rt)};EDDSA.prototype.hashInt=function _(){for(var o=this.hash(),$=0;$<arguments.length;$++)o.update(arguments[$]);return utils$2.intFromLE(o.digest()).umod(this.curve.n)};EDDSA.prototype.keyFromPublic=function _(o){return KeyPair$1.fromPublic(this,o)};EDDSA.prototype.keyFromSecret=function _(o){return KeyPair$1.fromSecret(this,o)};EDDSA.prototype.makeSignature=function _(o){return o instanceof Signature$3?o:new Signature$3(this,o)};EDDSA.prototype.encodePoint=function _(o){var $=o.getY().toArray("le",this.encodingLength);return $[this.encodingLength-1]|=o.getX().isOdd()?128:0,$};EDDSA.prototype.decodePoint=function _(o){o=utils$2.parseBytes(o);var $=o.length-1,j=o.slice(0,$).concat(o[$]&-129),et=(o[$]&128)!==0,tt=utils$2.intFromLE(j);return this.curve.pointFromY(tt,et)};EDDSA.prototype.encodeInt=function _(o){return o.toArray("le",this.encodingLength)};EDDSA.prototype.decodeInt=function _(o){return utils$2.intFromLE(o)};EDDSA.prototype.isPoint=function _(o){return o instanceof this.pointClass};var hasRequiredElliptic;function requireElliptic(){return hasRequiredElliptic||(hasRequiredElliptic=1,function(_){var o=_;o.version=require$$0.version,o.utils=utils$n,o.rand=requireBrorand(),o.curve=curve,o.curves=curves$1,o.ec=requireEc(),o.eddsa=eddsa}(elliptic$3)),elliptic$3}var bnExports$2={},bn$2={get exports(){return bnExports$2},set exports(_){bnExports$2=_}},hasRequiredBn;function requireBn(){return hasRequiredBn||(hasRequiredBn=1,function(_){(function(o,$){function j(yt,lt){if(!yt)throw new Error(lt||"Assertion failed")}function et(yt,lt){yt.super_=lt;var pt=function(){};pt.prototype=lt.prototype,yt.prototype=new pt,yt.prototype.constructor=yt}function tt(yt,lt,pt){if(tt.isBN(yt))return yt;this.negative=0,this.words=null,this.length=0,this.red=null,yt!==null&&((lt==="le"||lt==="be")&&(pt=lt,lt=10),this._init(yt||0,lt||10,pt||"be"))}typeof o=="object"?o.exports=tt:$.BN=tt,tt.BN=tt,tt.wordSize=26;var rt;try{typeof window<"u"&&typeof window.Buffer<"u"?rt=window.Buffer:rt=buffer$2.Buffer}catch{}tt.isBN=function(lt){return lt instanceof tt?!0:lt!==null&&typeof lt=="object"&&lt.constructor.wordSize===tt.wordSize&&Array.isArray(lt.words)},tt.max=function(lt,pt){return lt.cmp(pt)>0?lt:pt},tt.min=function(lt,pt){return lt.cmp(pt)<0?lt:pt},tt.prototype._init=function(lt,pt,bt){if(typeof lt=="number")return this._initNumber(lt,pt,bt);if(typeof lt=="object")return this._initArray(lt,pt,bt);pt==="hex"&&(pt=16),j(pt===(pt|0)&&pt>=2&&pt<=36),lt=lt.toString().replace(/\s+/g,"");var _t=0;lt[0]==="-"&&(_t++,this.negative=1),_t<lt.length&&(pt===16?this._parseHex(lt,_t,bt):(this._parseBase(lt,pt,_t),bt==="le"&&this._initArray(this.toArray(),pt,bt)))},tt.prototype._initNumber=function(lt,pt,bt){lt<0&&(this.negative=1,lt=-lt),lt<67108864?(this.words=[lt&67108863],this.length=1):lt<4503599627370496?(this.words=[lt&67108863,lt/67108864&67108863],this.length=2):(j(lt<9007199254740992),this.words=[lt&67108863,lt/67108864&67108863,1],this.length=3),bt==="le"&&this._initArray(this.toArray(),pt,bt)},tt.prototype._initArray=function(lt,pt,bt){if(j(typeof lt.length=="number"),lt.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(lt.length/3),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t,Ct,xt=0;if(bt==="be")for(_t=lt.length-1,$t=0;_t>=0;_t-=3)Ct=lt[_t]|lt[_t-1]<<8|lt[_t-2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);else if(bt==="le")for(_t=0,$t=0;_t<lt.length;_t+=3)Ct=lt[_t]|lt[_t+1]<<8|lt[_t+2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);return this._strip()};function nt(yt,lt){var pt=yt.charCodeAt(lt);if(pt>=48&&pt<=57)return pt-48;if(pt>=65&&pt<=70)return pt-55;if(pt>=97&&pt<=102)return pt-87;j(!1,"Invalid character in "+yt)}function it(yt,lt,pt){var bt=nt(yt,pt);return pt-1>=lt&&(bt|=nt(yt,pt-1)<<4),bt}tt.prototype._parseHex=function(lt,pt,bt){this.length=Math.ceil((lt.length-pt)/6),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t=0,Ct=0,xt;if(bt==="be")for(_t=lt.length-1;_t>=pt;_t-=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8;else{var vt=lt.length-pt;for(_t=vt%2===0?pt+1:pt;_t<lt.length;_t+=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8}this._strip()};function st(yt,lt,pt,bt){for(var _t=0,$t=0,Ct=Math.min(yt.length,pt),xt=lt;xt<Ct;xt++){var vt=yt.charCodeAt(xt)-48;_t*=bt,vt>=49?$t=vt-49+10:vt>=17?$t=vt-17+10:$t=vt,j(vt>=0&&$t<bt,"Invalid character"),_t+=$t}return _t}tt.prototype._parseBase=function(lt,pt,bt){this.words=[0],this.length=1;for(var _t=0,$t=1;$t<=67108863;$t*=pt)_t++;_t--,$t=$t/pt|0;for(var Ct=lt.length-bt,xt=Ct%_t,vt=Math.min(Ct,Ct-xt)+bt,dt=0,wt=bt;wt<vt;wt+=_t)dt=st(lt,wt,wt+_t,pt),this.imuln($t),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt);if(xt!==0){var qt=1;for(dt=st(lt,wt,lt.length,pt),wt=0;wt<xt;wt++)qt*=pt;this.imuln(qt),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt)}this._strip()},tt.prototype.copy=function(lt){lt.words=new Array(this.length);for(var pt=0;pt<this.length;pt++)lt.words[pt]=this.words[pt];lt.length=this.length,lt.negative=this.negative,lt.red=this.red};function ot(yt,lt){yt.words=lt.words,yt.length=lt.length,yt.negative=lt.negative,yt.red=lt.red}if(tt.prototype._move=function(lt){ot(lt,this)},tt.prototype.clone=function(){var lt=new tt(null);return this.copy(lt),lt},tt.prototype._expand=function(lt){for(;this.length<lt;)this.words[this.length++]=0;return this},tt.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},tt.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{tt.prototype[Symbol.for("nodejs.util.inspect.custom")]=at}catch{tt.prototype.inspect=at}else tt.prototype.inspect=at;function at(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var ct=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],ut=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ft=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];tt.prototype.toString=function(lt,pt){lt=lt||10,pt=pt|0||1;var bt;if(lt===16||lt==="hex"){bt="";for(var _t=0,$t=0,Ct=0;Ct<this.length;Ct++){var xt=this.words[Ct],vt=((xt<<_t|$t)&16777215).toString(16);$t=xt>>>24-_t&16777215,_t+=2,_t>=26&&(_t-=26,Ct--),$t!==0||Ct!==this.length-1?bt=ct[6-vt.length]+vt+bt:bt=vt+bt}for($t!==0&&(bt=$t.toString(16)+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}if(lt===(lt|0)&&lt>=2&&lt<=36){var dt=ut[lt],wt=ft[lt];bt="";var qt=this.clone();for(qt.negative=0;!qt.isZero();){var Pt=qt.modrn(wt).toString(lt);qt=qt.idivn(wt),qt.isZero()?bt=Pt+bt:bt=ct[dt-Pt.length]+Pt+bt}for(this.isZero()&&(bt="0"+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}j(!1,"Base should be between 2 and 36")},tt.prototype.toNumber=function(){var lt=this.words[0];return this.length===2?lt+=this.words[1]*67108864:this.length===3&&this.words[2]===1?lt+=4503599627370496+this.words[1]*67108864:this.length>2&&j(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-lt:lt},tt.prototype.toJSON=function(){return this.toString(16,2)},rt&&(tt.prototype.toBuffer=function(lt,pt){return this.toArrayLike(rt,lt,pt)}),tt.prototype.toArray=function(lt,pt){return this.toArrayLike(Array,lt,pt)};var ht=function(lt,pt){return lt.allocUnsafe?lt.allocUnsafe(pt):new lt(pt)};tt.prototype.toArrayLike=function(lt,pt,bt){this._strip();var _t=this.byteLength(),$t=bt||Math.max(1,_t);j(_t<=$t,"byte array longer than desired length"),j($t>0,"Requested array length <= 0");var Ct=ht(lt,$t),xt=pt==="le"?"LE":"BE";return this["_toArrayLike"+xt](Ct,_t),Ct},tt.prototype._toArrayLikeLE=function(lt,pt){for(var bt=0,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt++]=xt&255,bt<lt.length&&(lt[bt++]=xt>>8&255),bt<lt.length&&(lt[bt++]=xt>>16&255),Ct===6?(bt<lt.length&&(lt[bt++]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt<lt.length)for(lt[bt++]=_t;bt<lt.length;)lt[bt++]=0},tt.prototype._toArrayLikeBE=function(lt,pt){for(var bt=lt.length-1,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt--]=xt&255,bt>=0&&(lt[bt--]=xt>>8&255),bt>=0&&(lt[bt--]=xt>>16&255),Ct===6?(bt>=0&&(lt[bt--]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt>=0)for(lt[bt--]=_t;bt>=0;)lt[bt--]=0},Math.clz32?tt.prototype._countBits=function(lt){return 32-Math.clz32(lt)}:tt.prototype._countBits=function(lt){var pt=lt,bt=0;return pt>=4096&&(bt+=13,pt>>>=13),pt>=64&&(bt+=7,pt>>>=7),pt>=8&&(bt+=4,pt>>>=4),pt>=2&&(bt+=2,pt>>>=2),bt+pt},tt.prototype._zeroBits=function(lt){if(lt===0)return 26;var pt=lt,bt=0;return pt&8191||(bt+=13,pt>>>=13),pt&127||(bt+=7,pt>>>=7),pt&15||(bt+=4,pt>>>=4),pt&3||(bt+=2,pt>>>=2),pt&1||bt++,bt},tt.prototype.bitLength=function(){var lt=this.words[this.length-1],pt=this._countBits(lt);return(this.length-1)*26+pt};function mt(yt){for(var lt=new Array(yt.bitLength()),pt=0;pt<lt.length;pt++){var bt=pt/26|0,_t=pt%26;lt[pt]=yt.words[bt]>>>_t&1}return lt}tt.prototype.zeroBits=function(){if(this.isZero())return 0;for(var lt=0,pt=0;pt<this.length;pt++){var bt=this._zeroBits(this.words[pt]);if(lt+=bt,bt!==26)break}return lt},tt.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},tt.prototype.toTwos=function(lt){return this.negative!==0?this.abs().inotn(lt).iaddn(1):this.clone()},tt.prototype.fromTwos=function(lt){return this.testn(lt-1)?this.notn(lt).iaddn(1).ineg():this.clone()},tt.prototype.isNeg=function(){return this.negative!==0},tt.prototype.neg=function(){return this.clone().ineg()},tt.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},tt.prototype.iuor=function(lt){for(;this.length<lt.length;)this.words[this.length++]=0;for(var pt=0;pt<lt.length;pt++)this.words[pt]=this.words[pt]|lt.words[pt];return this._strip()},tt.prototype.ior=function(lt){return j((this.negative|lt.negative)===0),this.iuor(lt)},tt.prototype.or=function(lt){return this.length>lt.length?this.clone().ior(lt):lt.clone().ior(this)},tt.prototype.uor=function(lt){return this.length>lt.length?this.clone().iuor(lt):lt.clone().iuor(this)},tt.prototype.iuand=function(lt){var pt;this.length>lt.length?pt=lt:pt=this;for(var bt=0;bt<pt.length;bt++)this.words[bt]=this.words[bt]&lt.words[bt];return this.length=pt.length,this._strip()},tt.prototype.iand=function(lt){return j((this.negative|lt.negative)===0),this.iuand(lt)},tt.prototype.and=function(lt){return this.length>lt.length?this.clone().iand(lt):lt.clone().iand(this)},tt.prototype.uand=function(lt){return this.length>lt.length?this.clone().iuand(lt):lt.clone().iuand(this)},tt.prototype.iuxor=function(lt){var pt,bt;this.length>lt.length?(pt=this,bt=lt):(pt=lt,bt=this);for(var _t=0;_t<bt.length;_t++)this.words[_t]=pt.words[_t]^bt.words[_t];if(this!==pt)for(;_t<pt.length;_t++)this.words[_t]=pt.words[_t];return this.length=pt.length,this._strip()},tt.prototype.ixor=function(lt){return j((this.negative|lt.negative)===0),this.iuxor(lt)},tt.prototype.xor=function(lt){return this.length>lt.length?this.clone().ixor(lt):lt.clone().ixor(this)},tt.prototype.uxor=function(lt){return this.length>lt.length?this.clone().iuxor(lt):lt.clone().iuxor(this)},tt.prototype.inotn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=Math.ceil(lt/26)|0,bt=lt%26;this._expand(pt),bt>0&&pt--;for(var _t=0;_t<pt;_t++)this.words[_t]=~this.words[_t]&67108863;return bt>0&&(this.words[_t]=~this.words[_t]&67108863>>26-bt),this._strip()},tt.prototype.notn=function(lt){return this.clone().inotn(lt)},tt.prototype.setn=function(lt,pt){j(typeof lt=="number"&&lt>=0);var bt=lt/26|0,_t=lt%26;return this._expand(bt+1),pt?this.words[bt]=this.words[bt]|1<<_t:this.words[bt]=this.words[bt]&~(1<<_t),this._strip()},tt.prototype.iadd=function(lt){var pt;if(this.negative!==0&&lt.negative===0)return this.negative=0,pt=this.isub(lt),this.negative^=1,this._normSign();if(this.negative===0&&lt.negative!==0)return lt.negative=0,pt=this.isub(lt),lt.negative=1,pt._normSign();var bt,_t;this.length>lt.length?(bt=this,_t=lt):(bt=lt,_t=this);for(var $t=0,Ct=0;Ct<_t.length;Ct++)pt=(bt.words[Ct]|0)+(_t.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;for(;$t!==0&&Ct<bt.length;Ct++)pt=(bt.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;if(this.length=bt.length,$t!==0)this.words[this.length]=$t,this.length++;else if(bt!==this)for(;Ct<bt.length;Ct++)this.words[Ct]=bt.words[Ct];return this},tt.prototype.add=function(lt){var pt;return lt.negative!==0&&this.negative===0?(lt.negative=0,pt=this.sub(lt),lt.negative^=1,pt):lt.negative===0&&this.negative!==0?(this.negative=0,pt=lt.sub(this),this.negative=1,pt):this.length>lt.length?this.clone().iadd(lt):lt.clone().iadd(this)},tt.prototype.isub=function(lt){if(lt.negative!==0){lt.negative=0;var pt=this.iadd(lt);return lt.negative=1,pt._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(lt),this.negative=1,this._normSign();var bt=this.cmp(lt);if(bt===0)return this.negative=0,this.length=1,this.words[0]=0,this;var _t,$t;bt>0?(_t=this,$t=lt):(_t=lt,$t=this);for(var Ct=0,xt=0;xt<$t.length;xt++)pt=(_t.words[xt]|0)-($t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;for(;Ct!==0&&xt<_t.length;xt++)pt=(_t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;if(Ct===0&&xt<_t.length&&_t!==this)for(;xt<_t.length;xt++)this.words[xt]=_t.words[xt];return this.length=Math.max(this.length,xt),_t!==this&&(this.negative=1),this._strip()},tt.prototype.sub=function(lt){return this.clone().isub(lt)};function gt(yt,lt,pt){pt.negative=lt.negative^yt.negative;var bt=yt.length+lt.length|0;pt.length=bt,bt=bt-1|0;var _t=yt.words[0]|0,$t=lt.words[0]|0,Ct=_t*$t,xt=Ct&67108863,vt=Ct/67108864|0;pt.words[0]=xt;for(var dt=1;dt<bt;dt++){for(var wt=vt>>>26,qt=vt&67108863,Pt=Math.min(dt,lt.length-1),Gt=Math.max(0,dt-yt.length+1);Gt<=Pt;Gt++){var Wt=dt-Gt|0;_t=yt.words[Wt]|0,$t=lt.words[Gt]|0,Ct=_t*$t+qt,wt+=Ct/67108864|0,qt=Ct&67108863}pt.words[dt]=qt|0,vt=wt|0}return vt!==0?pt.words[dt]=vt|0:pt.length--,pt._strip()}var Et=function(lt,pt,bt){var _t=lt.words,$t=pt.words,Ct=bt.words,xt=0,vt,dt,wt,qt=_t[0]|0,Pt=qt&8191,Gt=qt>>>13,Wt=_t[1]|0,Vt=Wt&8191,Ut=Wt>>>13,Mt=_t[2]|0,Lt=Mt&8191,Yt=Mt>>>13,lr=_t[3]|0,cr=lr&8191,ir=lr>>>13,Zt=_t[4]|0,Bt=Zt&8191,Ft=Zt>>>13,zt=_t[5]|0,Qt=zt&8191,nr=zt>>>13,gr=_t[6]|0,br=gr&8191,vr=gr>>>13,Nr=_t[7]|0,ar=Nr&8191,er=Nr>>>13,Xt=_t[8]|0,tr=Xt&8191,ur=Xt>>>13,pr=_t[9]|0,yr=pr&8191,wr=pr>>>13,Gr=$t[0]|0,$r=Gr&8191,Er=Gr>>>13,Wr=$t[1]|0,Vr=Wr&8191,Pr=Wr>>>13,nn=$t[2]|0,Kr=nn&8191,Dr=nn>>>13,Qr=$t[3]|0,Or=Qr&8191,Cr=Qr>>>13,Zr=$t[4]|0,Fr=Zr&8191,Ar=Zr>>>13,Xr=$t[5]|0,Mr=Xr&8191,Sr=Xr>>>13,Jr=$t[6]|0,Ur=Jr&8191,Rr=Jr>>>13,en=$t[7]|0,Br=en&8191,Ir=en>>>13,tn=$t[8]|0,qr=tn&8191,Lr=tn>>>13,sn=$t[9]|0,Hr=sn&8191,jr=sn>>>13;bt.negative=lt.negative^pt.negative,bt.length=19,vt=Math.imul(Pt,$r),dt=Math.imul(Pt,Er),dt=dt+Math.imul(Gt,$r)|0,wt=Math.imul(Gt,Er);var un=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(un>>>26)|0,un&=67108863,vt=Math.imul(Vt,$r),dt=Math.imul(Vt,Er),dt=dt+Math.imul(Ut,$r)|0,wt=Math.imul(Ut,Er),vt=vt+Math.imul(Pt,Vr)|0,dt=dt+Math.imul(Pt,Pr)|0,dt=dt+Math.imul(Gt,Vr)|0,wt=wt+Math.imul(Gt,Pr)|0;var dn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(dn>>>26)|0,dn&=67108863,vt=Math.imul(Lt,$r),dt=Math.imul(Lt,Er),dt=dt+Math.imul(Yt,$r)|0,wt=Math.imul(Yt,Er),vt=vt+Math.imul(Vt,Vr)|0,dt=dt+Math.imul(Vt,Pr)|0,dt=dt+Math.imul(Ut,Vr)|0,wt=wt+Math.imul(Ut,Pr)|0,vt=vt+Math.imul(Pt,Kr)|0,dt=dt+Math.imul(Pt,Dr)|0,dt=dt+Math.imul(Gt,Kr)|0,wt=wt+Math.imul(Gt,Dr)|0;var fn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(fn>>>26)|0,fn&=67108863,vt=Math.imul(cr,$r),dt=Math.imul(cr,Er),dt=dt+Math.imul(ir,$r)|0,wt=Math.imul(ir,Er),vt=vt+Math.imul(Lt,Vr)|0,dt=dt+Math.imul(Lt,Pr)|0,dt=dt+Math.imul(Yt,Vr)|0,wt=wt+Math.imul(Yt,Pr)|0,vt=vt+Math.imul(Vt,Kr)|0,dt=dt+Math.imul(Vt,Dr)|0,dt=dt+Math.imul(Ut,Kr)|0,wt=wt+Math.imul(Ut,Dr)|0,vt=vt+Math.imul(Pt,Or)|0,dt=dt+Math.imul(Pt,Cr)|0,dt=dt+Math.imul(Gt,Or)|0,wt=wt+Math.imul(Gt,Cr)|0;var an=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(an>>>26)|0,an&=67108863,vt=Math.imul(Bt,$r),dt=Math.imul(Bt,Er),dt=dt+Math.imul(Ft,$r)|0,wt=Math.imul(Ft,Er),vt=vt+Math.imul(cr,Vr)|0,dt=dt+Math.imul(cr,Pr)|0,dt=dt+Math.imul(ir,Vr)|0,wt=wt+Math.imul(ir,Pr)|0,vt=vt+Math.imul(Lt,Kr)|0,dt=dt+Math.imul(Lt,Dr)|0,dt=dt+Math.imul(Yt,Kr)|0,wt=wt+Math.imul(Yt,Dr)|0,vt=vt+Math.imul(Vt,Or)|0,dt=dt+Math.imul(Vt,Cr)|0,dt=dt+Math.imul(Ut,Or)|0,wt=wt+Math.imul(Ut,Cr)|0,vt=vt+Math.imul(Pt,Fr)|0,dt=dt+Math.imul(Pt,Ar)|0,dt=dt+Math.imul(Gt,Fr)|0,wt=wt+Math.imul(Gt,Ar)|0;var pn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(pn>>>26)|0,pn&=67108863,vt=Math.imul(Qt,$r),dt=Math.imul(Qt,Er),dt=dt+Math.imul(nr,$r)|0,wt=Math.imul(nr,Er),vt=vt+Math.imul(Bt,Vr)|0,dt=dt+Math.imul(Bt,Pr)|0,dt=dt+Math.imul(Ft,Vr)|0,wt=wt+Math.imul(Ft,Pr)|0,vt=vt+Math.imul(cr,Kr)|0,dt=dt+Math.imul(cr,Dr)|0,dt=dt+Math.imul(ir,Kr)|0,wt=wt+Math.imul(ir,Dr)|0,vt=vt+Math.imul(Lt,Or)|0,dt=dt+Math.imul(Lt,Cr)|0,dt=dt+Math.imul(Yt,Or)|0,wt=wt+Math.imul(Yt,Cr)|0,vt=vt+Math.imul(Vt,Fr)|0,dt=dt+Math.imul(Vt,Ar)|0,dt=dt+Math.imul(Ut,Fr)|0,wt=wt+Math.imul(Ut,Ar)|0,vt=vt+Math.imul(Pt,Mr)|0,dt=dt+Math.imul(Pt,Sr)|0,dt=dt+Math.imul(Gt,Mr)|0,wt=wt+Math.imul(Gt,Sr)|0;var _n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(_n>>>26)|0,_n&=67108863,vt=Math.imul(br,$r),dt=Math.imul(br,Er),dt=dt+Math.imul(vr,$r)|0,wt=Math.imul(vr,Er),vt=vt+Math.imul(Qt,Vr)|0,dt=dt+Math.imul(Qt,Pr)|0,dt=dt+Math.imul(nr,Vr)|0,wt=wt+Math.imul(nr,Pr)|0,vt=vt+Math.imul(Bt,Kr)|0,dt=dt+Math.imul(Bt,Dr)|0,dt=dt+Math.imul(Ft,Kr)|0,wt=wt+Math.imul(Ft,Dr)|0,vt=vt+Math.imul(cr,Or)|0,dt=dt+Math.imul(cr,Cr)|0,dt=dt+Math.imul(ir,Or)|0,wt=wt+Math.imul(ir,Cr)|0,vt=vt+Math.imul(Lt,Fr)|0,dt=dt+Math.imul(Lt,Ar)|0,dt=dt+Math.imul(Yt,Fr)|0,wt=wt+Math.imul(Yt,Ar)|0,vt=vt+Math.imul(Vt,Mr)|0,dt=dt+Math.imul(Vt,Sr)|0,dt=dt+Math.imul(Ut,Mr)|0,wt=wt+Math.imul(Ut,Sr)|0,vt=vt+Math.imul(Pt,Ur)|0,dt=dt+Math.imul(Pt,Rr)|0,dt=dt+Math.imul(Gt,Ur)|0,wt=wt+Math.imul(Gt,Rr)|0;var Tn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,vt=Math.imul(ar,$r),dt=Math.imul(ar,Er),dt=dt+Math.imul(er,$r)|0,wt=Math.imul(er,Er),vt=vt+Math.imul(br,Vr)|0,dt=dt+Math.imul(br,Pr)|0,dt=dt+Math.imul(vr,Vr)|0,wt=wt+Math.imul(vr,Pr)|0,vt=vt+Math.imul(Qt,Kr)|0,dt=dt+Math.imul(Qt,Dr)|0,dt=dt+Math.imul(nr,Kr)|0,wt=wt+Math.imul(nr,Dr)|0,vt=vt+Math.imul(Bt,Or)|0,dt=dt+Math.imul(Bt,Cr)|0,dt=dt+Math.imul(Ft,Or)|0,wt=wt+Math.imul(Ft,Cr)|0,vt=vt+Math.imul(cr,Fr)|0,dt=dt+Math.imul(cr,Ar)|0,dt=dt+Math.imul(ir,Fr)|0,wt=wt+Math.imul(ir,Ar)|0,vt=vt+Math.imul(Lt,Mr)|0,dt=dt+Math.imul(Lt,Sr)|0,dt=dt+Math.imul(Yt,Mr)|0,wt=wt+Math.imul(Yt,Sr)|0,vt=vt+Math.imul(Vt,Ur)|0,dt=dt+Math.imul(Vt,Rr)|0,dt=dt+Math.imul(Ut,Ur)|0,wt=wt+Math.imul(Ut,Rr)|0,vt=vt+Math.imul(Pt,Br)|0,dt=dt+Math.imul(Pt,Ir)|0,dt=dt+Math.imul(Gt,Br)|0,wt=wt+Math.imul(Gt,Ir)|0;var gn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(gn>>>26)|0,gn&=67108863,vt=Math.imul(tr,$r),dt=Math.imul(tr,Er),dt=dt+Math.imul(ur,$r)|0,wt=Math.imul(ur,Er),vt=vt+Math.imul(ar,Vr)|0,dt=dt+Math.imul(ar,Pr)|0,dt=dt+Math.imul(er,Vr)|0,wt=wt+Math.imul(er,Pr)|0,vt=vt+Math.imul(br,Kr)|0,dt=dt+Math.imul(br,Dr)|0,dt=dt+Math.imul(vr,Kr)|0,wt=wt+Math.imul(vr,Dr)|0,vt=vt+Math.imul(Qt,Or)|0,dt=dt+Math.imul(Qt,Cr)|0,dt=dt+Math.imul(nr,Or)|0,wt=wt+Math.imul(nr,Cr)|0,vt=vt+Math.imul(Bt,Fr)|0,dt=dt+Math.imul(Bt,Ar)|0,dt=dt+Math.imul(Ft,Fr)|0,wt=wt+Math.imul(Ft,Ar)|0,vt=vt+Math.imul(cr,Mr)|0,dt=dt+Math.imul(cr,Sr)|0,dt=dt+Math.imul(ir,Mr)|0,wt=wt+Math.imul(ir,Sr)|0,vt=vt+Math.imul(Lt,Ur)|0,dt=dt+Math.imul(Lt,Rr)|0,dt=dt+Math.imul(Yt,Ur)|0,wt=wt+Math.imul(Yt,Rr)|0,vt=vt+Math.imul(Vt,Br)|0,dt=dt+Math.imul(Vt,Ir)|0,dt=dt+Math.imul(Ut,Br)|0,wt=wt+Math.imul(Ut,Ir)|0,vt=vt+Math.imul(Pt,qr)|0,dt=dt+Math.imul(Pt,Lr)|0,dt=dt+Math.imul(Gt,qr)|0,wt=wt+Math.imul(Gt,Lr)|0;var En=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(En>>>26)|0,En&=67108863,vt=Math.imul(yr,$r),dt=Math.imul(yr,Er),dt=dt+Math.imul(wr,$r)|0,wt=Math.imul(wr,Er),vt=vt+Math.imul(tr,Vr)|0,dt=dt+Math.imul(tr,Pr)|0,dt=dt+Math.imul(ur,Vr)|0,wt=wt+Math.imul(ur,Pr)|0,vt=vt+Math.imul(ar,Kr)|0,dt=dt+Math.imul(ar,Dr)|0,dt=dt+Math.imul(er,Kr)|0,wt=wt+Math.imul(er,Dr)|0,vt=vt+Math.imul(br,Or)|0,dt=dt+Math.imul(br,Cr)|0,dt=dt+Math.imul(vr,Or)|0,wt=wt+Math.imul(vr,Cr)|0,vt=vt+Math.imul(Qt,Fr)|0,dt=dt+Math.imul(Qt,Ar)|0,dt=dt+Math.imul(nr,Fr)|0,wt=wt+Math.imul(nr,Ar)|0,vt=vt+Math.imul(Bt,Mr)|0,dt=dt+Math.imul(Bt,Sr)|0,dt=dt+Math.imul(Ft,Mr)|0,wt=wt+Math.imul(Ft,Sr)|0,vt=vt+Math.imul(cr,Ur)|0,dt=dt+Math.imul(cr,Rr)|0,dt=dt+Math.imul(ir,Ur)|0,wt=wt+Math.imul(ir,Rr)|0,vt=vt+Math.imul(Lt,Br)|0,dt=dt+Math.imul(Lt,Ir)|0,dt=dt+Math.imul(Yt,Br)|0,wt=wt+Math.imul(Yt,Ir)|0,vt=vt+Math.imul(Vt,qr)|0,dt=dt+Math.imul(Vt,Lr)|0,dt=dt+Math.imul(Ut,qr)|0,wt=wt+Math.imul(Ut,Lr)|0,vt=vt+Math.imul(Pt,Hr)|0,dt=dt+Math.imul(Pt,jr)|0,dt=dt+Math.imul(Gt,Hr)|0,wt=wt+Math.imul(Gt,jr)|0;var Cn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,vt=Math.imul(yr,Vr),dt=Math.imul(yr,Pr),dt=dt+Math.imul(wr,Vr)|0,wt=Math.imul(wr,Pr),vt=vt+Math.imul(tr,Kr)|0,dt=dt+Math.imul(tr,Dr)|0,dt=dt+Math.imul(ur,Kr)|0,wt=wt+Math.imul(ur,Dr)|0,vt=vt+Math.imul(ar,Or)|0,dt=dt+Math.imul(ar,Cr)|0,dt=dt+Math.imul(er,Or)|0,wt=wt+Math.imul(er,Cr)|0,vt=vt+Math.imul(br,Fr)|0,dt=dt+Math.imul(br,Ar)|0,dt=dt+Math.imul(vr,Fr)|0,wt=wt+Math.imul(vr,Ar)|0,vt=vt+Math.imul(Qt,Mr)|0,dt=dt+Math.imul(Qt,Sr)|0,dt=dt+Math.imul(nr,Mr)|0,wt=wt+Math.imul(nr,Sr)|0,vt=vt+Math.imul(Bt,Ur)|0,dt=dt+Math.imul(Bt,Rr)|0,dt=dt+Math.imul(Ft,Ur)|0,wt=wt+Math.imul(Ft,Rr)|0,vt=vt+Math.imul(cr,Br)|0,dt=dt+Math.imul(cr,Ir)|0,dt=dt+Math.imul(ir,Br)|0,wt=wt+Math.imul(ir,Ir)|0,vt=vt+Math.imul(Lt,qr)|0,dt=dt+Math.imul(Lt,Lr)|0,dt=dt+Math.imul(Yt,qr)|0,wt=wt+Math.imul(Yt,Lr)|0,vt=vt+Math.imul(Vt,Hr)|0,dt=dt+Math.imul(Vt,jr)|0,dt=dt+Math.imul(Ut,Hr)|0,wt=wt+Math.imul(Ut,jr)|0;var mn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(mn>>>26)|0,mn&=67108863,vt=Math.imul(yr,Kr),dt=Math.imul(yr,Dr),dt=dt+Math.imul(wr,Kr)|0,wt=Math.imul(wr,Dr),vt=vt+Math.imul(tr,Or)|0,dt=dt+Math.imul(tr,Cr)|0,dt=dt+Math.imul(ur,Or)|0,wt=wt+Math.imul(ur,Cr)|0,vt=vt+Math.imul(ar,Fr)|0,dt=dt+Math.imul(ar,Ar)|0,dt=dt+Math.imul(er,Fr)|0,wt=wt+Math.imul(er,Ar)|0,vt=vt+Math.imul(br,Mr)|0,dt=dt+Math.imul(br,Sr)|0,dt=dt+Math.imul(vr,Mr)|0,wt=wt+Math.imul(vr,Sr)|0,vt=vt+Math.imul(Qt,Ur)|0,dt=dt+Math.imul(Qt,Rr)|0,dt=dt+Math.imul(nr,Ur)|0,wt=wt+Math.imul(nr,Rr)|0,vt=vt+Math.imul(Bt,Br)|0,dt=dt+Math.imul(Bt,Ir)|0,dt=dt+Math.imul(Ft,Br)|0,wt=wt+Math.imul(Ft,Ir)|0,vt=vt+Math.imul(cr,qr)|0,dt=dt+Math.imul(cr,Lr)|0,dt=dt+Math.imul(ir,qr)|0,wt=wt+Math.imul(ir,Lr)|0,vt=vt+Math.imul(Lt,Hr)|0,dt=dt+Math.imul(Lt,jr)|0,dt=dt+Math.imul(Yt,Hr)|0,wt=wt+Math.imul(Yt,jr)|0;var xn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(xn>>>26)|0,xn&=67108863,vt=Math.imul(yr,Or),dt=Math.imul(yr,Cr),dt=dt+Math.imul(wr,Or)|0,wt=Math.imul(wr,Cr),vt=vt+Math.imul(tr,Fr)|0,dt=dt+Math.imul(tr,Ar)|0,dt=dt+Math.imul(ur,Fr)|0,wt=wt+Math.imul(ur,Ar)|0,vt=vt+Math.imul(ar,Mr)|0,dt=dt+Math.imul(ar,Sr)|0,dt=dt+Math.imul(er,Mr)|0,wt=wt+Math.imul(er,Sr)|0,vt=vt+Math.imul(br,Ur)|0,dt=dt+Math.imul(br,Rr)|0,dt=dt+Math.imul(vr,Ur)|0,wt=wt+Math.imul(vr,Rr)|0,vt=vt+Math.imul(Qt,Br)|0,dt=dt+Math.imul(Qt,Ir)|0,dt=dt+Math.imul(nr,Br)|0,wt=wt+Math.imul(nr,Ir)|0,vt=vt+Math.imul(Bt,qr)|0,dt=dt+Math.imul(Bt,Lr)|0,dt=dt+Math.imul(Ft,qr)|0,wt=wt+Math.imul(Ft,Lr)|0,vt=vt+Math.imul(cr,Hr)|0,dt=dt+Math.imul(cr,jr)|0,dt=dt+Math.imul(ir,Hr)|0,wt=wt+Math.imul(ir,jr)|0;var An=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(An>>>26)|0,An&=67108863,vt=Math.imul(yr,Fr),dt=Math.imul(yr,Ar),dt=dt+Math.imul(wr,Fr)|0,wt=Math.imul(wr,Ar),vt=vt+Math.imul(tr,Mr)|0,dt=dt+Math.imul(tr,Sr)|0,dt=dt+Math.imul(ur,Mr)|0,wt=wt+Math.imul(ur,Sr)|0,vt=vt+Math.imul(ar,Ur)|0,dt=dt+Math.imul(ar,Rr)|0,dt=dt+Math.imul(er,Ur)|0,wt=wt+Math.imul(er,Rr)|0,vt=vt+Math.imul(br,Br)|0,dt=dt+Math.imul(br,Ir)|0,dt=dt+Math.imul(vr,Br)|0,wt=wt+Math.imul(vr,Ir)|0,vt=vt+Math.imul(Qt,qr)|0,dt=dt+Math.imul(Qt,Lr)|0,dt=dt+Math.imul(nr,qr)|0,wt=wt+Math.imul(nr,Lr)|0,vt=vt+Math.imul(Bt,Hr)|0,dt=dt+Math.imul(Bt,jr)|0,dt=dt+Math.imul(Ft,Hr)|0,wt=wt+Math.imul(Ft,jr)|0;var $n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+($n>>>26)|0,$n&=67108863,vt=Math.imul(yr,Mr),dt=Math.imul(yr,Sr),dt=dt+Math.imul(wr,Mr)|0,wt=Math.imul(wr,Sr),vt=vt+Math.imul(tr,Ur)|0,dt=dt+Math.imul(tr,Rr)|0,dt=dt+Math.imul(ur,Ur)|0,wt=wt+Math.imul(ur,Rr)|0,vt=vt+Math.imul(ar,Br)|0,dt=dt+Math.imul(ar,Ir)|0,dt=dt+Math.imul(er,Br)|0,wt=wt+Math.imul(er,Ir)|0,vt=vt+Math.imul(br,qr)|0,dt=dt+Math.imul(br,Lr)|0,dt=dt+Math.imul(vr,qr)|0,wt=wt+Math.imul(vr,Lr)|0,vt=vt+Math.imul(Qt,Hr)|0,dt=dt+Math.imul(Qt,jr)|0,dt=dt+Math.imul(nr,Hr)|0,wt=wt+Math.imul(nr,jr)|0;var Rn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,vt=Math.imul(yr,Ur),dt=Math.imul(yr,Rr),dt=dt+Math.imul(wr,Ur)|0,wt=Math.imul(wr,Rr),vt=vt+Math.imul(tr,Br)|0,dt=dt+Math.imul(tr,Ir)|0,dt=dt+Math.imul(ur,Br)|0,wt=wt+Math.imul(ur,Ir)|0,vt=vt+Math.imul(ar,qr)|0,dt=dt+Math.imul(ar,Lr)|0,dt=dt+Math.imul(er,qr)|0,wt=wt+Math.imul(er,Lr)|0,vt=vt+Math.imul(br,Hr)|0,dt=dt+Math.imul(br,jr)|0,dt=dt+Math.imul(vr,Hr)|0,wt=wt+Math.imul(vr,jr)|0;var Sn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Sn>>>26)|0,Sn&=67108863,vt=Math.imul(yr,Br),dt=Math.imul(yr,Ir),dt=dt+Math.imul(wr,Br)|0,wt=Math.imul(wr,Ir),vt=vt+Math.imul(tr,qr)|0,dt=dt+Math.imul(tr,Lr)|0,dt=dt+Math.imul(ur,qr)|0,wt=wt+Math.imul(ur,Lr)|0,vt=vt+Math.imul(ar,Hr)|0,dt=dt+Math.imul(ar,jr)|0,dt=dt+Math.imul(er,Hr)|0,wt=wt+Math.imul(er,jr)|0;var In=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(In>>>26)|0,In&=67108863,vt=Math.imul(yr,qr),dt=Math.imul(yr,Lr),dt=dt+Math.imul(wr,qr)|0,wt=Math.imul(wr,Lr),vt=vt+Math.imul(tr,Hr)|0,dt=dt+Math.imul(tr,jr)|0,dt=dt+Math.imul(ur,Hr)|0,wt=wt+Math.imul(ur,jr)|0;var kn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(kn>>>26)|0,kn&=67108863,vt=Math.imul(yr,Hr),dt=Math.imul(yr,jr),dt=dt+Math.imul(wr,Hr)|0,wt=Math.imul(wr,jr);var Pn=(xt+vt|0)+((dt&8191)<<13)|0;return xt=(wt+(dt>>>13)|0)+(Pn>>>26)|0,Pn&=67108863,Ct[0]=un,Ct[1]=dn,Ct[2]=fn,Ct[3]=an,Ct[4]=pn,Ct[5]=_n,Ct[6]=Tn,Ct[7]=gn,Ct[8]=En,Ct[9]=Cn,Ct[10]=mn,Ct[11]=xn,Ct[12]=An,Ct[13]=$n,Ct[14]=Rn,Ct[15]=Sn,Ct[16]=In,Ct[17]=kn,Ct[18]=Pn,xt!==0&&(Ct[19]=xt,bt.length++),bt};Math.imul||(Et=gt);function St(yt,lt,pt){pt.negative=lt.negative^yt.negative,pt.length=yt.length+lt.length;for(var bt=0,_t=0,$t=0;$t<pt.length-1;$t++){var Ct=_t;_t=0;for(var xt=bt&67108863,vt=Math.min($t,lt.length-1),dt=Math.max(0,$t-yt.length+1);dt<=vt;dt++){var wt=$t-dt,qt=yt.words[wt]|0,Pt=lt.words[dt]|0,Gt=qt*Pt,Wt=Gt&67108863;Ct=Ct+(Gt/67108864|0)|0,Wt=Wt+xt|0,xt=Wt&67108863,Ct=Ct+(Wt>>>26)|0,_t+=Ct>>>26,Ct&=67108863}pt.words[$t]=xt,bt=Ct,Ct=_t}return bt!==0?pt.words[$t]=bt:pt.length--,pt._strip()}function At(yt,lt,pt){return St(yt,lt,pt)}tt.prototype.mulTo=function(lt,pt){var bt,_t=this.length+lt.length;return this.length===10&&lt.length===10?bt=Et(this,lt,pt):_t<63?bt=gt(this,lt,pt):_t<1024?bt=St(this,lt,pt):bt=At(this,lt,pt),bt},tt.prototype.mul=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),this.mulTo(lt,pt)},tt.prototype.mulf=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),At(this,lt,pt)},tt.prototype.imul=function(lt){return this.clone().mulTo(lt,this)},tt.prototype.imuln=function(lt){var pt=lt<0;pt&&(lt=-lt),j(typeof lt=="number"),j(lt<67108864);for(var bt=0,_t=0;_t<this.length;_t++){var $t=(this.words[_t]|0)*lt,Ct=($t&67108863)+(bt&67108863);bt>>=26,bt+=$t/67108864|0,bt+=Ct>>>26,this.words[_t]=Ct&67108863}return bt!==0&&(this.words[_t]=bt,this.length++),pt?this.ineg():this},tt.prototype.muln=function(lt){return this.clone().imuln(lt)},tt.prototype.sqr=function(){return this.mul(this)},tt.prototype.isqr=function(){return this.imul(this.clone())},tt.prototype.pow=function(lt){var pt=mt(lt);if(pt.length===0)return new tt(1);for(var bt=this,_t=0;_t<pt.length&&pt[_t]===0;_t++,bt=bt.sqr());if(++_t<pt.length)for(var $t=bt.sqr();_t<pt.length;_t++,$t=$t.sqr())pt[_t]!==0&&(bt=bt.mul($t));return bt},tt.prototype.iushln=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=67108863>>>26-pt<<26-pt,$t;if(pt!==0){var Ct=0;for($t=0;$t<this.length;$t++){var xt=this.words[$t]&_t,vt=(this.words[$t]|0)-xt<<pt;this.words[$t]=vt|Ct,Ct=xt>>>26-pt}Ct&&(this.words[$t]=Ct,this.length++)}if(bt!==0){for($t=this.length-1;$t>=0;$t--)this.words[$t+bt]=this.words[$t];for($t=0;$t<bt;$t++)this.words[$t]=0;this.length+=bt}return this._strip()},tt.prototype.ishln=function(lt){return j(this.negative===0),this.iushln(lt)},tt.prototype.iushrn=function(lt,pt,bt){j(typeof lt=="number"&&lt>=0);var _t;pt?_t=(pt-pt%26)/26:_t=0;var $t=lt%26,Ct=Math.min((lt-$t)/26,this.length),xt=67108863^67108863>>>$t<<$t,vt=bt;if(_t-=Ct,_t=Math.max(0,_t),vt){for(var dt=0;dt<Ct;dt++)vt.words[dt]=this.words[dt];vt.length=Ct}if(Ct!==0)if(this.length>Ct)for(this.length-=Ct,dt=0;dt<this.length;dt++)this.words[dt]=this.words[dt+Ct];else this.words[0]=0,this.length=1;var wt=0;for(dt=this.length-1;dt>=0&&(wt!==0||dt>=_t);dt--){var qt=this.words[dt]|0;this.words[dt]=wt<<26-$t|qt>>>$t,wt=qt&xt}return vt&&wt!==0&&(vt.words[vt.length++]=wt),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},tt.prototype.ishrn=function(lt,pt,bt){return j(this.negative===0),this.iushrn(lt,pt,bt)},tt.prototype.shln=function(lt){return this.clone().ishln(lt)},tt.prototype.ushln=function(lt){return this.clone().iushln(lt)},tt.prototype.shrn=function(lt){return this.clone().ishrn(lt)},tt.prototype.ushrn=function(lt){return this.clone().iushrn(lt)},tt.prototype.testn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return!1;var $t=this.words[bt];return!!($t&_t)},tt.prototype.imaskn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26;if(j(this.negative===0,"imaskn works only with positive numbers"),this.length<=bt)return this;if(pt!==0&&bt++,this.length=Math.min(bt,this.length),pt!==0){var _t=67108863^67108863>>>pt<<pt;this.words[this.length-1]&=_t}return this._strip()},tt.prototype.maskn=function(lt){return this.clone().imaskn(lt)},tt.prototype.iaddn=function(lt){return j(typeof lt=="number"),j(lt<67108864),lt<0?this.isubn(-lt):this.negative!==0?this.length===1&&(this.words[0]|0)<=lt?(this.words[0]=lt-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(lt),this.negative=1,this):this._iaddn(lt)},tt.prototype._iaddn=function(lt){this.words[0]+=lt;for(var pt=0;pt<this.length&&this.words[pt]>=67108864;pt++)this.words[pt]-=67108864,pt===this.length-1?this.words[pt+1]=1:this.words[pt+1]++;return this.length=Math.max(this.length,pt+1),this},tt.prototype.isubn=function(lt){if(j(typeof lt=="number"),j(lt<67108864),lt<0)return this.iaddn(-lt);if(this.negative!==0)return this.negative=0,this.iaddn(lt),this.negative=1,this;if(this.words[0]-=lt,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var pt=0;pt<this.length&&this.words[pt]<0;pt++)this.words[pt]+=67108864,this.words[pt+1]-=1;return this._strip()},tt.prototype.addn=function(lt){return this.clone().iaddn(lt)},tt.prototype.subn=function(lt){return this.clone().isubn(lt)},tt.prototype.iabs=function(){return this.negative=0,this},tt.prototype.abs=function(){return this.clone().iabs()},tt.prototype._ishlnsubmul=function(lt,pt,bt){var _t=lt.length+bt,$t;this._expand(_t);var Ct,xt=0;for($t=0;$t<lt.length;$t++){Ct=(this.words[$t+bt]|0)+xt;var vt=(lt.words[$t]|0)*pt;Ct-=vt&67108863,xt=(Ct>>26)-(vt/67108864|0),this.words[$t+bt]=Ct&67108863}for(;$t<this.length-bt;$t++)Ct=(this.words[$t+bt]|0)+xt,xt=Ct>>26,this.words[$t+bt]=Ct&67108863;if(xt===0)return this._strip();for(j(xt===-1),xt=0,$t=0;$t<this.length;$t++)Ct=-(this.words[$t]|0)+xt,xt=Ct>>26,this.words[$t]=Ct&67108863;return this.negative=1,this._strip()},tt.prototype._wordDiv=function(lt,pt){var bt=this.length-lt.length,_t=this.clone(),$t=lt,Ct=$t.words[$t.length-1]|0,xt=this._countBits(Ct);bt=26-xt,bt!==0&&($t=$t.ushln(bt),_t.iushln(bt),Ct=$t.words[$t.length-1]|0);var vt=_t.length-$t.length,dt;if(pt!=="mod"){dt=new tt(null),dt.length=vt+1,dt.words=new Array(dt.length);for(var wt=0;wt<dt.length;wt++)dt.words[wt]=0}var qt=_t.clone()._ishlnsubmul($t,1,vt);qt.negative===0&&(_t=qt,dt&&(dt.words[vt]=1));for(var Pt=vt-1;Pt>=0;Pt--){var Gt=(_t.words[$t.length+Pt]|0)*67108864+(_t.words[$t.length+Pt-1]|0);for(Gt=Math.min(Gt/Ct|0,67108863),_t._ishlnsubmul($t,Gt,Pt);_t.negative!==0;)Gt--,_t.negative=0,_t._ishlnsubmul($t,1,Pt),_t.isZero()||(_t.negative^=1);dt&&(dt.words[Pt]=Gt)}return dt&&dt._strip(),_t._strip(),pt!=="div"&&bt!==0&&_t.iushrn(bt),{div:dt||null,mod:_t}},tt.prototype.divmod=function(lt,pt,bt){if(j(!lt.isZero()),this.isZero())return{div:new tt(0),mod:new tt(0)};var _t,$t,Ct;return this.negative!==0&&lt.negative===0?(Ct=this.neg().divmod(lt,pt),pt!=="mod"&&(_t=Ct.div.neg()),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.iadd(lt)),{div:_t,mod:$t}):this.negative===0&&lt.negative!==0?(Ct=this.divmod(lt.neg(),pt),pt!=="mod"&&(_t=Ct.div.neg()),{div:_t,mod:Ct.mod}):this.negative&lt.negative?(Ct=this.neg().divmod(lt.neg(),pt),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.isub(lt)),{div:Ct.div,mod:$t}):lt.length>this.length||this.cmp(lt)<0?{div:new tt(0),mod:this}:lt.length===1?pt==="div"?{div:this.divn(lt.words[0]),mod:null}:pt==="mod"?{div:null,mod:new tt(this.modrn(lt.words[0]))}:{div:this.divn(lt.words[0]),mod:new tt(this.modrn(lt.words[0]))}:this._wordDiv(lt,pt)},tt.prototype.div=function(lt){return this.divmod(lt,"div",!1).div},tt.prototype.mod=function(lt){return this.divmod(lt,"mod",!1).mod},tt.prototype.umod=function(lt){return this.divmod(lt,"mod",!0).mod},tt.prototype.divRound=function(lt){var pt=this.divmod(lt);if(pt.mod.isZero())return pt.div;var bt=pt.div.negative!==0?pt.mod.isub(lt):pt.mod,_t=lt.ushrn(1),$t=lt.andln(1),Ct=bt.cmp(_t);return Ct<0||$t===1&&Ct===0?pt.div:pt.div.negative!==0?pt.div.isubn(1):pt.div.iaddn(1)},tt.prototype.modrn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=(1<<26)%lt,_t=0,$t=this.length-1;$t>=0;$t--)_t=(bt*_t+(this.words[$t]|0))%lt;return pt?-_t:_t},tt.prototype.modn=function(lt){return this.modrn(lt)},tt.prototype.idivn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=0,_t=this.length-1;_t>=0;_t--){var $t=(this.words[_t]|0)+bt*67108864;this.words[_t]=$t/lt|0,bt=$t%lt}return this._strip(),pt?this.ineg():this},tt.prototype.divn=function(lt){return this.clone().idivn(lt)},tt.prototype.egcd=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=new tt(0),xt=new tt(1),vt=0;pt.isEven()&&bt.isEven();)pt.iushrn(1),bt.iushrn(1),++vt;for(var dt=bt.clone(),wt=pt.clone();!pt.isZero();){for(var qt=0,Pt=1;!(pt.words[0]&Pt)&&qt<26;++qt,Pt<<=1);if(qt>0)for(pt.iushrn(qt);qt-- >0;)(_t.isOdd()||$t.isOdd())&&(_t.iadd(dt),$t.isub(wt)),_t.iushrn(1),$t.iushrn(1);for(var Gt=0,Wt=1;!(bt.words[0]&Wt)&&Gt<26;++Gt,Wt<<=1);if(Gt>0)for(bt.iushrn(Gt);Gt-- >0;)(Ct.isOdd()||xt.isOdd())&&(Ct.iadd(dt),xt.isub(wt)),Ct.iushrn(1),xt.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub(Ct),$t.isub(xt)):(bt.isub(pt),Ct.isub(_t),xt.isub($t))}return{a:Ct,b:xt,gcd:bt.iushln(vt)}},tt.prototype._invmp=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=bt.clone();pt.cmpn(1)>0&&bt.cmpn(1)>0;){for(var xt=0,vt=1;!(pt.words[0]&vt)&&xt<26;++xt,vt<<=1);if(xt>0)for(pt.iushrn(xt);xt-- >0;)_t.isOdd()&&_t.iadd(Ct),_t.iushrn(1);for(var dt=0,wt=1;!(bt.words[0]&wt)&&dt<26;++dt,wt<<=1);if(dt>0)for(bt.iushrn(dt);dt-- >0;)$t.isOdd()&&$t.iadd(Ct),$t.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub($t)):(bt.isub(pt),$t.isub(_t))}var qt;return pt.cmpn(1)===0?qt=_t:qt=$t,qt.cmpn(0)<0&&qt.iadd(lt),qt},tt.prototype.gcd=function(lt){if(this.isZero())return lt.abs();if(lt.isZero())return this.abs();var pt=this.clone(),bt=lt.clone();pt.negative=0,bt.negative=0;for(var _t=0;pt.isEven()&&bt.isEven();_t++)pt.iushrn(1),bt.iushrn(1);do{for(;pt.isEven();)pt.iushrn(1);for(;bt.isEven();)bt.iushrn(1);var $t=pt.cmp(bt);if($t<0){var Ct=pt;pt=bt,bt=Ct}else if($t===0||bt.cmpn(1)===0)break;pt.isub(bt)}while(!0);return bt.iushln(_t)},tt.prototype.invm=function(lt){return this.egcd(lt).a.umod(lt)},tt.prototype.isEven=function(){return(this.words[0]&1)===0},tt.prototype.isOdd=function(){return(this.words[0]&1)===1},tt.prototype.andln=function(lt){return this.words[0]&lt},tt.prototype.bincn=function(lt){j(typeof lt=="number");var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return this._expand(bt+1),this.words[bt]|=_t,this;for(var $t=_t,Ct=bt;$t!==0&&Ct<this.length;Ct++){var xt=this.words[Ct]|0;xt+=$t,$t=xt>>>26,xt&=67108863,this.words[Ct]=xt}return $t!==0&&(this.words[Ct]=$t,this.length++),this},tt.prototype.isZero=function(){return this.length===1&&this.words[0]===0},tt.prototype.cmpn=function(lt){var pt=lt<0;if(this.negative!==0&&!pt)return-1;if(this.negative===0&&pt)return 1;this._strip();var bt;if(this.length>1)bt=1;else{pt&&(lt=-lt),j(lt<=67108863,"Number is too big");var _t=this.words[0]|0;bt=_t===lt?0:_t<lt?-1:1}return this.negative!==0?-bt|0:bt},tt.prototype.cmp=function(lt){if(this.negative!==0&&lt.negative===0)return-1;if(this.negative===0&&lt.negative!==0)return 1;var pt=this.ucmp(lt);return this.negative!==0?-pt|0:pt},tt.prototype.ucmp=function(lt){if(this.length>lt.length)return 1;if(this.length<lt.length)return-1;for(var pt=0,bt=this.length-1;bt>=0;bt--){var _t=this.words[bt]|0,$t=lt.words[bt]|0;if(_t!==$t){_t<$t?pt=-1:_t>$t&&(pt=1);break}}return pt},tt.prototype.gtn=function(lt){return this.cmpn(lt)===1},tt.prototype.gt=function(lt){return this.cmp(lt)===1},tt.prototype.gten=function(lt){return this.cmpn(lt)>=0},tt.prototype.gte=function(lt){return this.cmp(lt)>=0},tt.prototype.ltn=function(lt){return this.cmpn(lt)===-1},tt.prototype.lt=function(lt){return this.cmp(lt)===-1},tt.prototype.lten=function(lt){return this.cmpn(lt)<=0},tt.prototype.lte=function(lt){return this.cmp(lt)<=0},tt.prototype.eqn=function(lt){return this.cmpn(lt)===0},tt.prototype.eq=function(lt){return this.cmp(lt)===0},tt.red=function(lt){return new Nt(lt)},tt.prototype.toRed=function(lt){return j(!this.red,"Already a number in reduction context"),j(this.negative===0,"red works only with positives"),lt.convertTo(this)._forceRed(lt)},tt.prototype.fromRed=function(){return j(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},tt.prototype._forceRed=function(lt){return this.red=lt,this},tt.prototype.forceRed=function(lt){return j(!this.red,"Already a number in reduction context"),this._forceRed(lt)},tt.prototype.redAdd=function(lt){return j(this.red,"redAdd works only with red numbers"),this.red.add(this,lt)},tt.prototype.redIAdd=function(lt){return j(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,lt)},tt.prototype.redSub=function(lt){return j(this.red,"redSub works only with red numbers"),this.red.sub(this,lt)},tt.prototype.redISub=function(lt){return j(this.red,"redISub works only with red numbers"),this.red.isub(this,lt)},tt.prototype.redShl=function(lt){return j(this.red,"redShl works only with red numbers"),this.red.shl(this,lt)},tt.prototype.redMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.mul(this,lt)},tt.prototype.redIMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.imul(this,lt)},tt.prototype.redSqr=function(){return j(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},tt.prototype.redISqr=function(){return j(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},tt.prototype.redSqrt=function(){return j(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},tt.prototype.redInvm=function(){return j(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},tt.prototype.redNeg=function(){return j(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},tt.prototype.redPow=function(lt){return j(this.red&&!lt.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,lt)};var kt={k256:null,p224:null,p192:null,p25519:null};function Rt(yt,lt){this.name=yt,this.p=new tt(lt,16),this.n=this.p.bitLength(),this.k=new tt(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Rt.prototype._tmp=function(){var lt=new tt(null);return lt.words=new Array(Math.ceil(this.n/13)),lt},Rt.prototype.ireduce=function(lt){var pt=lt,bt;do this.split(pt,this.tmp),pt=this.imulK(pt),pt=pt.iadd(this.tmp),bt=pt.bitLength();while(bt>this.n);var _t=bt<this.n?-1:pt.ucmp(this.p);return _t===0?(pt.words[0]=0,pt.length=1):_t>0?pt.isub(this.p):pt.strip!==void 0?pt.strip():pt._strip(),pt},Rt.prototype.split=function(lt,pt){lt.iushrn(this.n,0,pt)},Rt.prototype.imulK=function(lt){return lt.imul(this.k)};function Tt(){Rt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}et(Tt,Rt),Tt.prototype.split=function(lt,pt){for(var bt=4194303,_t=Math.min(lt.length,9),$t=0;$t<_t;$t++)pt.words[$t]=lt.words[$t];if(pt.length=_t,lt.length<=9){lt.words[0]=0,lt.length=1;return}var Ct=lt.words[9];for(pt.words[pt.length++]=Ct&bt,$t=10;$t<lt.length;$t++){var xt=lt.words[$t]|0;lt.words[$t-10]=(xt&bt)<<4|Ct>>>22,Ct=xt}Ct>>>=22,lt.words[$t-10]=Ct,Ct===0&&lt.length>10?lt.length-=10:lt.length-=9},Tt.prototype.imulK=function(lt){lt.words[lt.length]=0,lt.words[lt.length+1]=0,lt.length+=2;for(var pt=0,bt=0;bt<lt.length;bt++){var _t=lt.words[bt]|0;pt+=_t*977,lt.words[bt]=pt&67108863,pt=_t*64+(pt/67108864|0)}return lt.words[lt.length-1]===0&&(lt.length--,lt.words[lt.length-1]===0&&lt.length--),lt};function Dt(){Rt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}et(Dt,Rt);function Ot(){Rt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}et(Ot,Rt);function jt(){Rt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}et(jt,Rt),jt.prototype.imulK=function(lt){for(var pt=0,bt=0;bt<lt.length;bt++){var _t=(lt.words[bt]|0)*19+pt,$t=_t&67108863;_t>>>=26,lt.words[bt]=$t,pt=_t}return pt!==0&&(lt.words[lt.length++]=pt),lt},tt._prime=function(lt){if(kt[lt])return kt[lt];var pt;if(lt==="k256")pt=new Tt;else if(lt==="p224")pt=new Dt;else if(lt==="p192")pt=new Ot;else if(lt==="p25519")pt=new jt;else throw new Error("Unknown prime "+lt);return kt[lt]=pt,pt};function Nt(yt){if(typeof yt=="string"){var lt=tt._prime(yt);this.m=lt.p,this.prime=lt}else j(yt.gtn(1),"modulus must be greater than 1"),this.m=yt,this.prime=null}Nt.prototype._verify1=function(lt){j(lt.negative===0,"red works only with positives"),j(lt.red,"red works only with red numbers")},Nt.prototype._verify2=function(lt,pt){j((lt.negative|pt.negative)===0,"red works only with positives"),j(lt.red&&lt.red===pt.red,"red works only with red numbers")},Nt.prototype.imod=function(lt){return this.prime?this.prime.ireduce(lt)._forceRed(this):(ot(lt,lt.umod(this.m)._forceRed(this)),lt)},Nt.prototype.neg=function(lt){return lt.isZero()?lt.clone():this.m.sub(lt)._forceRed(this)},Nt.prototype.add=function(lt,pt){this._verify2(lt,pt);var bt=lt.add(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt._forceRed(this)},Nt.prototype.iadd=function(lt,pt){this._verify2(lt,pt);var bt=lt.iadd(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt},Nt.prototype.sub=function(lt,pt){this._verify2(lt,pt);var bt=lt.sub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt._forceRed(this)},Nt.prototype.isub=function(lt,pt){this._verify2(lt,pt);var bt=lt.isub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt},Nt.prototype.shl=function(lt,pt){return this._verify1(lt),this.imod(lt.ushln(pt))},Nt.prototype.imul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.imul(pt))},Nt.prototype.mul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.mul(pt))},Nt.prototype.isqr=function(lt){return this.imul(lt,lt.clone())},Nt.prototype.sqr=function(lt){return this.mul(lt,lt)},Nt.prototype.sqrt=function(lt){if(lt.isZero())return lt.clone();var pt=this.m.andln(3);if(j(pt%2===1),pt===3){var bt=this.m.add(new tt(1)).iushrn(2);return this.pow(lt,bt)}for(var _t=this.m.subn(1),$t=0;!_t.isZero()&&_t.andln(1)===0;)$t++,_t.iushrn(1);j(!_t.isZero());var Ct=new tt(1).toRed(this),xt=Ct.redNeg(),vt=this.m.subn(1).iushrn(1),dt=this.m.bitLength();for(dt=new tt(2*dt*dt).toRed(this);this.pow(dt,vt).cmp(xt)!==0;)dt.redIAdd(xt);for(var wt=this.pow(dt,_t),qt=this.pow(lt,_t.addn(1).iushrn(1)),Pt=this.pow(lt,_t),Gt=$t;Pt.cmp(Ct)!==0;){for(var Wt=Pt,Vt=0;Wt.cmp(Ct)!==0;Vt++)Wt=Wt.redSqr();j(Vt<Gt);var Ut=this.pow(wt,new tt(1).iushln(Gt-Vt-1));qt=qt.redMul(Ut),wt=Ut.redSqr(),Pt=Pt.redMul(wt),Gt=Vt}return qt},Nt.prototype.invm=function(lt){var pt=lt._invmp(this.m);return pt.negative!==0?(pt.negative=0,this.imod(pt).redNeg()):this.imod(pt)},Nt.prototype.pow=function(lt,pt){if(pt.isZero())return new tt(1).toRed(this);if(pt.cmpn(1)===0)return lt.clone();var bt=4,_t=new Array(1<<bt);_t[0]=new tt(1).toRed(this),_t[1]=lt;for(var $t=2;$t<_t.length;$t++)_t[$t]=this.mul(_t[$t-1],lt);var Ct=_t[0],xt=0,vt=0,dt=pt.bitLength()%26;for(dt===0&&(dt=26),$t=pt.length-1;$t>=0;$t--){for(var wt=pt.words[$t],qt=dt-1;qt>=0;qt--){var Pt=wt>>qt&1;if(Ct!==_t[0]&&(Ct=this.sqr(Ct)),Pt===0&&xt===0){vt=0;continue}xt<<=1,xt|=Pt,vt++,!(vt!==bt&&($t!==0||qt!==0))&&(Ct=this.mul(Ct,_t[xt]),vt=0,xt=0)}dt=26}return Ct},Nt.prototype.convertTo=function(lt){var pt=lt.umod(this.m);return pt===lt?pt.clone():pt},Nt.prototype.convertFrom=function(lt){var pt=lt.clone();return pt.red=null,pt},tt.mont=function(lt){return new It(lt)};function It(yt){Nt.call(this,yt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new tt(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}et(It,Nt),It.prototype.convertTo=function(lt){return this.imod(lt.ushln(this.shift))},It.prototype.convertFrom=function(lt){var pt=this.imod(lt.mul(this.rinv));return pt.red=null,pt},It.prototype.imul=function(lt,pt){if(lt.isZero()||pt.isZero())return lt.words[0]=0,lt.length=1,lt;var bt=lt.imul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.mul=function(lt,pt){if(lt.isZero()||pt.isZero())return new tt(0)._forceRed(this);var bt=lt.mul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.invm=function(lt){var pt=this.imod(lt._invmp(this.m).mul(this.r2));return pt._forceRed(this)}})(_,commonjsGlobal)}(bn$2)),bnExports$2}var asn1$6={},asn1$5={},api$1={},encoders={},safer_1,hasRequiredSafer;function requireSafer(){if(hasRequiredSafer)return safer_1;hasRequiredSafer=1;var _=buffer$2,o=_.Buffer,$={},j;for(j in _)_.hasOwnProperty(j)&&(j==="SlowBuffer"||j==="Buffer"||($[j]=_[j]));var et=$.Buffer={};for(j in o)o.hasOwnProperty(j)&&(j==="allocUnsafe"||j==="allocUnsafeSlow"||(et[j]=o[j]));if($.Buffer.prototype=o.prototype,(!et.from||et.from===Uint8Array.from)&&(et.from=function(tt,rt,nt){if(typeof tt=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof tt);if(tt&&typeof tt.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof tt);return o(tt,rt,nt)}),et.alloc||(et.alloc=function(tt,rt,nt){if(typeof tt!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof tt);if(tt<0||tt>=2*(1<<30))throw new RangeError('The value "'+tt+'" is invalid for option "size"');var it=o(tt);return!rt||rt.length===0?it.fill(0):typeof nt=="string"?it.fill(rt,nt):it.fill(rt),it}),!$.kStringMaxLength)try{$.kStringMaxLength=browserExports$3.binding("buffer").kStringMaxLength}catch{}return $.constants||($.constants={MAX_LENGTH:$.kMaxLength},$.kStringMaxLength&&($.constants.MAX_STRING_LENGTH=$.kStringMaxLength)),safer_1=$,safer_1}var reporter={},hasRequiredReporter;function requireReporter(){if(hasRequiredReporter)return reporter;hasRequiredReporter=1;const _=inherits_browserExports;function o(j){this._reporterState={obj:null,path:[],options:j||{},errors:[]}}reporter.Reporter=o,o.prototype.isError=function(et){return et instanceof $},o.prototype.save=function(){const et=this._reporterState;return{obj:et.obj,pathLen:et.path.length}},o.prototype.restore=function(et){const tt=this._reporterState;tt.obj=et.obj,tt.path=tt.path.slice(0,et.pathLen)},o.prototype.enterKey=function(et){return this._reporterState.path.push(et)},o.prototype.exitKey=function(et){const tt=this._reporterState;tt.path=tt.path.slice(0,et-1)},o.prototype.leaveKey=function(et,tt,rt){const nt=this._reporterState;this.exitKey(et),nt.obj!==null&&(nt.obj[tt]=rt)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const et=this._reporterState,tt=et.obj;return et.obj={},tt},o.prototype.leaveObject=function(et){const tt=this._reporterState,rt=tt.obj;return tt.obj=et,rt},o.prototype.error=function(et){let tt;const rt=this._reporterState,nt=et instanceof $;if(nt?tt=et:tt=new $(rt.path.map(function(it){return"["+JSON.stringify(it)+"]"}).join(""),et.message||et,et.stack),!rt.options.partial)throw tt;return nt||rt.errors.push(tt),tt},o.prototype.wrapResult=function(et){const tt=this._reporterState;return tt.options.partial?{result:this.isError(et)?null:et,errors:tt.errors}:et};function $(j,et){this.path=j,this.rethrow(et)}return _($,Error),$.prototype.rethrow=function(et){if(this.message=et+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,$),!this.stack)try{throw new Error(this.message)}catch(tt){this.stack=tt.stack}return this},reporter}var buffer={},hasRequiredBuffer;function requireBuffer(){if(hasRequiredBuffer)return buffer;hasRequiredBuffer=1;const _=inherits_browserExports,o=requireReporter().Reporter,$=requireSafer().Buffer;function j(tt,rt){if(o.call(this,rt),!$.isBuffer(tt)){this.error("Input not Buffer");return}this.base=tt,this.offset=0,this.length=tt.length}_(j,o),buffer.DecoderBuffer=j,j.isDecoderBuffer=function(rt){return rt instanceof j?!0:typeof rt=="object"&&$.isBuffer(rt.base)&&rt.constructor.name==="DecoderBuffer"&&typeof rt.offset=="number"&&typeof rt.length=="number"&&typeof rt.save=="function"&&typeof rt.restore=="function"&&typeof rt.isEmpty=="function"&&typeof rt.readUInt8=="function"&&typeof rt.skip=="function"&&typeof rt.raw=="function"},j.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},j.prototype.restore=function(rt){const nt=new j(this.base);return nt.offset=rt.offset,nt.length=this.offset,this.offset=rt.offset,o.prototype.restore.call(this,rt.reporter),nt},j.prototype.isEmpty=function(){return this.offset===this.length},j.prototype.readUInt8=function(rt){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(rt||"DecoderBuffer overrun")},j.prototype.skip=function(rt,nt){if(!(this.offset+rt<=this.length))return this.error(nt||"DecoderBuffer overrun");const it=new j(this.base);return it._reporterState=this._reporterState,it.offset=this.offset,it.length=this.offset+rt,this.offset+=rt,it},j.prototype.raw=function(rt){return this.base.slice(rt?rt.offset:this.offset,this.length)};function et(tt,rt){if(Array.isArray(tt))this.length=0,this.value=tt.map(function(nt){return et.isEncoderBuffer(nt)||(nt=new et(nt,rt)),this.length+=nt.length,nt},this);else if(typeof tt=="number"){if(!(0<=tt&&tt<=255))return rt.error("non-byte EncoderBuffer value");this.value=tt,this.length=1}else if(typeof tt=="string")this.value=tt,this.length=$.byteLength(tt);else if($.isBuffer(tt))this.value=tt,this.length=tt.length;else return rt.error("Unsupported type: "+typeof tt)}return buffer.EncoderBuffer=et,et.isEncoderBuffer=function(rt){return rt instanceof et?!0:typeof rt=="object"&&rt.constructor.name==="EncoderBuffer"&&typeof rt.length=="number"&&typeof rt.join=="function"},et.prototype.join=function(rt,nt){return rt||(rt=$.alloc(this.length)),nt||(nt=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(it){it.join(rt,nt),nt+=it.length}):(typeof this.value=="number"?rt[nt]=this.value:typeof this.value=="string"?rt.write(this.value,nt):$.isBuffer(this.value)&&this.value.copy(rt,nt),nt+=this.length)),rt},buffer}var node$1,hasRequiredNode;function requireNode(){if(hasRequiredNode)return node$1;hasRequiredNode=1;const _=requireReporter().Reporter,o=requireBuffer().EncoderBuffer,$=requireBuffer().DecoderBuffer,j=minimalisticAssert$1,et=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],tt=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(et),rt=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function nt(st,ot,at){const ct={};this._baseState=ct,ct.name=at,ct.enc=st,ct.parent=ot||null,ct.children=null,ct.tag=null,ct.args=null,ct.reverseArgs=null,ct.choice=null,ct.optional=!1,ct.any=!1,ct.obj=!1,ct.use=null,ct.useDecoder=null,ct.key=null,ct.default=null,ct.explicit=null,ct.implicit=null,ct.contains=null,ct.parent||(ct.children=[],this._wrap())}node$1=nt;const it=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return nt.prototype.clone=function(){const ot=this._baseState,at={};it.forEach(function(ut){at[ut]=ot[ut]});const ct=new this.constructor(at.parent);return ct._baseState=at,ct},nt.prototype._wrap=function(){const ot=this._baseState;tt.forEach(function(at){this[at]=function(){const ut=new this.constructor(this);return ot.children.push(ut),ut[at].apply(ut,arguments)}},this)},nt.prototype._init=function(ot){const at=this._baseState;j(at.parent===null),ot.call(this),at.children=at.children.filter(function(ct){return ct._baseState.parent===this},this),j.equal(at.children.length,1,"Root node can have only one child")},nt.prototype._useArgs=function(ot){const at=this._baseState,ct=ot.filter(function(ut){return ut instanceof this.constructor},this);ot=ot.filter(function(ut){return!(ut instanceof this.constructor)},this),ct.length!==0&&(j(at.children===null),at.children=ct,ct.forEach(function(ut){ut._baseState.parent=this},this)),ot.length!==0&&(j(at.args===null),at.args=ot,at.reverseArgs=ot.map(function(ut){if(typeof ut!="object"||ut.constructor!==Object)return ut;const ft={};return Object.keys(ut).forEach(function(ht){ht==(ht|0)&&(ht|=0);const mt=ut[ht];ft[mt]=ht}),ft}))},rt.forEach(function(st){nt.prototype[st]=function(){const at=this._baseState;throw new Error(st+" not implemented for encoding: "+at.enc)}}),et.forEach(function(st){nt.prototype[st]=function(){const at=this._baseState,ct=Array.prototype.slice.call(arguments);return j(at.tag===null),at.tag=st,this._useArgs(ct),this}}),nt.prototype.use=function(ot){j(ot);const at=this._baseState;return j(at.use===null),at.use=ot,this},nt.prototype.optional=function(){const ot=this._baseState;return ot.optional=!0,this},nt.prototype.def=function(ot){const at=this._baseState;return j(at.default===null),at.default=ot,at.optional=!0,this},nt.prototype.explicit=function(ot){const at=this._baseState;return j(at.explicit===null&&at.implicit===null),at.explicit=ot,this},nt.prototype.implicit=function(ot){const at=this._baseState;return j(at.explicit===null&&at.implicit===null),at.implicit=ot,this},nt.prototype.obj=function(){const ot=this._baseState,at=Array.prototype.slice.call(arguments);return ot.obj=!0,at.length!==0&&this._useArgs(at),this},nt.prototype.key=function(ot){const at=this._baseState;return j(at.key===null),at.key=ot,this},nt.prototype.any=function(){const ot=this._baseState;return ot.any=!0,this},nt.prototype.choice=function(ot){const at=this._baseState;return j(at.choice===null),at.choice=ot,this._useArgs(Object.keys(ot).map(function(ct){return ot[ct]})),this},nt.prototype.contains=function(ot){const at=this._baseState;return j(at.use===null),at.contains=ot,this},nt.prototype._decode=function(ot,at){const ct=this._baseState;if(ct.parent===null)return ot.wrapResult(ct.children[0]._decode(ot,at));let ut=ct.default,ft=!0,ht=null;if(ct.key!==null&&(ht=ot.enterKey(ct.key)),ct.optional){let gt=null;if(ct.explicit!==null?gt=ct.explicit:ct.implicit!==null?gt=ct.implicit:ct.tag!==null&&(gt=ct.tag),gt===null&&!ct.any){const Et=ot.save();try{ct.choice===null?this._decodeGeneric(ct.tag,ot,at):this._decodeChoice(ot,at),ft=!0}catch{ft=!1}ot.restore(Et)}else if(ft=this._peekTag(ot,gt,ct.any),ot.isError(ft))return ft}let mt;if(ct.obj&&ft&&(mt=ot.enterObject()),ft){if(ct.explicit!==null){const Et=this._decodeTag(ot,ct.explicit);if(ot.isError(Et))return Et;ot=Et}const gt=ot.offset;if(ct.use===null&&ct.choice===null){let Et;ct.any&&(Et=ot.save());const St=this._decodeTag(ot,ct.implicit!==null?ct.implicit:ct.tag,ct.any);if(ot.isError(St))return St;ct.any?ut=ot.raw(Et):ot=St}if(at&&at.track&&ct.tag!==null&&at.track(ot.path(),gt,ot.length,"tagged"),at&&at.track&&ct.tag!==null&&at.track(ot.path(),ot.offset,ot.length,"content"),ct.any||(ct.choice===null?ut=this._decodeGeneric(ct.tag,ot,at):ut=this._decodeChoice(ot,at)),ot.isError(ut))return ut;if(!ct.any&&ct.choice===null&&ct.children!==null&&ct.children.forEach(function(St){St._decode(ot,at)}),ct.contains&&(ct.tag==="octstr"||ct.tag==="bitstr")){const Et=new $(ut);ut=this._getUse(ct.contains,ot._reporterState.obj)._decode(Et,at)}}return ct.obj&&ft&&(ut=ot.leaveObject(mt)),ct.key!==null&&(ut!==null||ft===!0)?ot.leaveKey(ht,ct.key,ut):ht!==null&&ot.exitKey(ht),ut},nt.prototype._decodeGeneric=function(ot,at,ct){const ut=this._baseState;return ot==="seq"||ot==="set"?null:ot==="seqof"||ot==="setof"?this._decodeList(at,ot,ut.args[0],ct):/str$/.test(ot)?this._decodeStr(at,ot,ct):ot==="objid"&&ut.args?this._decodeObjid(at,ut.args[0],ut.args[1],ct):ot==="objid"?this._decodeObjid(at,null,null,ct):ot==="gentime"||ot==="utctime"?this._decodeTime(at,ot,ct):ot==="null_"?this._decodeNull(at,ct):ot==="bool"?this._decodeBool(at,ct):ot==="objDesc"?this._decodeStr(at,ot,ct):ot==="int"||ot==="enum"?this._decodeInt(at,ut.args&&ut.args[0],ct):ut.use!==null?this._getUse(ut.use,at._reporterState.obj)._decode(at,ct):at.error("unknown tag: "+ot)},nt.prototype._getUse=function(ot,at){const ct=this._baseState;return ct.useDecoder=this._use(ot,at),j(ct.useDecoder._baseState.parent===null),ct.useDecoder=ct.useDecoder._baseState.children[0],ct.implicit!==ct.useDecoder._baseState.implicit&&(ct.useDecoder=ct.useDecoder.clone(),ct.useDecoder._baseState.implicit=ct.implicit),ct.useDecoder},nt.prototype._decodeChoice=function(ot,at){const ct=this._baseState;let ut=null,ft=!1;return Object.keys(ct.choice).some(function(ht){const mt=ot.save(),gt=ct.choice[ht];try{const Et=gt._decode(ot,at);if(ot.isError(Et))return!1;ut={type:ht,value:Et},ft=!0}catch{return ot.restore(mt),!1}return!0},this),ft?ut:ot.error("Choice not matched")},nt.prototype._createEncoderBuffer=function(ot){return new o(ot,this.reporter)},nt.prototype._encode=function(ot,at,ct){const ut=this._baseState;if(ut.default!==null&&ut.default===ot)return;const ft=this._encodeValue(ot,at,ct);if(ft!==void 0&&!this._skipDefault(ft,at,ct))return ft},nt.prototype._encodeValue=function(ot,at,ct){const ut=this._baseState;if(ut.parent===null)return ut.children[0]._encode(ot,at||new _);let ft=null;if(this.reporter=at,ut.optional&&ot===void 0)if(ut.default!==null)ot=ut.default;else return;let ht=null,mt=!1;if(ut.any)ft=this._createEncoderBuffer(ot);else if(ut.choice)ft=this._encodeChoice(ot,at);else if(ut.contains)ht=this._getUse(ut.contains,ct)._encode(ot,at),mt=!0;else if(ut.children)ht=ut.children.map(function(gt){if(gt._baseState.tag==="null_")return gt._encode(null,at,ot);if(gt._baseState.key===null)return at.error("Child should have a key");const Et=at.enterKey(gt._baseState.key);if(typeof ot!="object")return at.error("Child expected, but input is not object");const St=gt._encode(ot[gt._baseState.key],at,ot);return at.leaveKey(Et),St},this).filter(function(gt){return gt}),ht=this._createEncoderBuffer(ht);else if(ut.tag==="seqof"||ut.tag==="setof"){if(!(ut.args&&ut.args.length===1))return at.error("Too many args for : "+ut.tag);if(!Array.isArray(ot))return at.error("seqof/setof, but data is not Array");const gt=this.clone();gt._baseState.implicit=null,ht=this._createEncoderBuffer(ot.map(function(Et){const St=this._baseState;return this._getUse(St.args[0],ot)._encode(Et,at)},gt))}else ut.use!==null?ft=this._getUse(ut.use,ct)._encode(ot,at):(ht=this._encodePrimitive(ut.tag,ot),mt=!0);if(!ut.any&&ut.choice===null){const gt=ut.implicit!==null?ut.implicit:ut.tag,Et=ut.implicit===null?"universal":"context";gt===null?ut.use===null&&at.error("Tag could be omitted only for .use()"):ut.use===null&&(ft=this._encodeComposite(gt,mt,Et,ht))}return ut.explicit!==null&&(ft=this._encodeComposite(ut.explicit,!1,"context",ft)),ft},nt.prototype._encodeChoice=function(ot,at){const ct=this._baseState,ut=ct.choice[ot.type];return ut||j(!1,ot.type+" not found in "+JSON.stringify(Object.keys(ct.choice))),ut._encode(ot.value,at)},nt.prototype._encodePrimitive=function(ot,at){const ct=this._baseState;if(/str$/.test(ot))return this._encodeStr(at,ot);if(ot==="objid"&&ct.args)return this._encodeObjid(at,ct.reverseArgs[0],ct.args[1]);if(ot==="objid")return this._encodeObjid(at,null,null);if(ot==="gentime"||ot==="utctime")return this._encodeTime(at,ot);if(ot==="null_")return this._encodeNull();if(ot==="int"||ot==="enum")return this._encodeInt(at,ct.args&&ct.reverseArgs[0]);if(ot==="bool")return this._encodeBool(at);if(ot==="objDesc")return this._encodeStr(at,ot);throw new Error("Unsupported tag: "+ot)},nt.prototype._isNumstr=function(ot){return/^[0-9 ]*$/.test(ot)},nt.prototype._isPrintstr=function(ot){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(ot)},node$1}var der={},hasRequiredDer$2;function requireDer$2(){return hasRequiredDer$2||(hasRequiredDer$2=1,function(_){function o($){const j={};return Object.keys($).forEach(function(et){(et|0)==et&&(et=et|0);const tt=$[et];j[tt]=et}),j}_.tagClass={0:"universal",1:"application",2:"context",3:"private"},_.tagClassByName=o(_.tagClass),_.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},_.tagByName=o(_.tag)}(der)),der}var der_1$1,hasRequiredDer$1;function requireDer$1(){if(hasRequiredDer$1)return der_1$1;hasRequiredDer$1=1;const _=inherits_browserExports,o=requireSafer().Buffer,$=requireNode(),j=requireDer$2();function et(it){this.enc="der",this.name=it.name,this.entity=it,this.tree=new tt,this.tree._init(it.body)}der_1$1=et,et.prototype.encode=function(st,ot){return this.tree._encode(st,ot).join()};function tt(it){$.call(this,"der",it)}_(tt,$),tt.prototype._encodeComposite=function(st,ot,at,ct){const ut=nt(st,ot,at,this.reporter);if(ct.length<128){const mt=o.alloc(2);return mt[0]=ut,mt[1]=ct.length,this._createEncoderBuffer([mt,ct])}let ft=1;for(let mt=ct.length;mt>=256;mt>>=8)ft++;const ht=o.alloc(1+1+ft);ht[0]=ut,ht[1]=128|ft;for(let mt=1+ft,gt=ct.length;gt>0;mt--,gt>>=8)ht[mt]=gt&255;return this._createEncoderBuffer([ht,ct])},tt.prototype._encodeStr=function(st,ot){if(ot==="bitstr")return this._createEncoderBuffer([st.unused|0,st.data]);if(ot==="bmpstr"){const at=o.alloc(st.length*2);for(let ct=0;ct<st.length;ct++)at.writeUInt16BE(st.charCodeAt(ct),ct*2);return this._createEncoderBuffer(at)}else return ot==="numstr"?this._isNumstr(st)?this._createEncoderBuffer(st):this.reporter.error("Encoding of string type: numstr supports only digits and space"):ot==="printstr"?this._isPrintstr(st)?this._createEncoderBuffer(st):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(ot)?this._createEncoderBuffer(st):ot==="objDesc"?this._createEncoderBuffer(st):this.reporter.error("Encoding of string type: "+ot+" unsupported")},tt.prototype._encodeObjid=function(st,ot,at){if(typeof st=="string"){if(!ot)return this.reporter.error("string objid given, but no values map found");if(!ot.hasOwnProperty(st))return this.reporter.error("objid not found in values map");st=ot[st].split(/[\s.]+/g);for(let ht=0;ht<st.length;ht++)st[ht]|=0}else if(Array.isArray(st)){st=st.slice();for(let ht=0;ht<st.length;ht++)st[ht]|=0}if(!Array.isArray(st))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(st));if(!at){if(st[1]>=40)return this.reporter.error("Second objid identifier OOB");st.splice(0,2,st[0]*40+st[1])}let ct=0;for(let ht=0;ht<st.length;ht++){let mt=st[ht];for(ct++;mt>=128;mt>>=7)ct++}const ut=o.alloc(ct);let ft=ut.length-1;for(let ht=st.length-1;ht>=0;ht--){let mt=st[ht];for(ut[ft--]=mt&127;(mt>>=7)>0;)ut[ft--]=128|mt&127}return this._createEncoderBuffer(ut)};function rt(it){return it<10?"0"+it:it}tt.prototype._encodeTime=function(st,ot){let at;const ct=new Date(st);return ot==="gentime"?at=[rt(ct.getUTCFullYear()),rt(ct.getUTCMonth()+1),rt(ct.getUTCDate()),rt(ct.getUTCHours()),rt(ct.getUTCMinutes()),rt(ct.getUTCSeconds()),"Z"].join(""):ot==="utctime"?at=[rt(ct.getUTCFullYear()%100),rt(ct.getUTCMonth()+1),rt(ct.getUTCDate()),rt(ct.getUTCHours()),rt(ct.getUTCMinutes()),rt(ct.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+ot+" time is not supported yet"),this._encodeStr(at,"octstr")},tt.prototype._encodeNull=function(){return this._createEncoderBuffer("")},tt.prototype._encodeInt=function(st,ot){if(typeof st=="string"){if(!ot)return this.reporter.error("String int or enum given, but no values map");if(!ot.hasOwnProperty(st))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(st));st=ot[st]}if(typeof st!="number"&&!o.isBuffer(st)){const ut=st.toArray();!st.sign&&ut[0]&128&&ut.unshift(0),st=o.from(ut)}if(o.isBuffer(st)){let ut=st.length;st.length===0&&ut++;const ft=o.alloc(ut);return st.copy(ft),st.length===0&&(ft[0]=0),this._createEncoderBuffer(ft)}if(st<128)return this._createEncoderBuffer(st);if(st<256)return this._createEncoderBuffer([0,st]);let at=1;for(let ut=st;ut>=256;ut>>=8)at++;const ct=new Array(at);for(let ut=ct.length-1;ut>=0;ut--)ct[ut]=st&255,st>>=8;return ct[0]&128&&ct.unshift(0),this._createEncoderBuffer(o.from(ct))},tt.prototype._encodeBool=function(st){return this._createEncoderBuffer(st?255:0)},tt.prototype._use=function(st,ot){return typeof st=="function"&&(st=st(ot)),st._getEncoder("der").tree},tt.prototype._skipDefault=function(st,ot,at){const ct=this._baseState;let ut;if(ct.default===null)return!1;const ft=st.join();if(ct.defaultBuffer===void 0&&(ct.defaultBuffer=this._encodeValue(ct.default,ot,at).join()),ft.length!==ct.defaultBuffer.length)return!1;for(ut=0;ut<ft.length;ut++)if(ft[ut]!==ct.defaultBuffer[ut])return!1;return!0};function nt(it,st,ot,at){let ct;if(it==="seqof"?it="seq":it==="setof"&&(it="set"),j.tagByName.hasOwnProperty(it))ct=j.tagByName[it];else if(typeof it=="number"&&(it|0)===it)ct=it;else return at.error("Unknown tag: "+it);return ct>=31?at.error("Multi-octet tag encoding unsupported"):(st||(ct|=32),ct|=j.tagClassByName[ot||"universal"]<<6,ct)}return der_1$1}var pem$2,hasRequiredPem$1;function requirePem$1(){if(hasRequiredPem$1)return pem$2;hasRequiredPem$1=1;const _=inherits_browserExports,o=requireDer$1();function $(j){o.call(this,j),this.enc="pem"}return _($,o),pem$2=$,$.prototype.encode=function(et,tt){const nt=o.prototype.encode.call(this,et).toString("base64"),it=["-----BEGIN "+tt.label+"-----"];for(let st=0;st<nt.length;st+=64)it.push(nt.slice(st,st+64));return it.push("-----END "+tt.label+"-----"),it.join(`
`)},pem$2}var hasRequiredEncoders;function requireEncoders(){return hasRequiredEncoders||(hasRequiredEncoders=1,function(_){const o=_;o.der=requireDer$1(),o.pem=requirePem$1()}(encoders)),encoders}var decoders$4={},der_1,hasRequiredDer;function requireDer(){if(hasRequiredDer)return der_1;hasRequiredDer=1;const _=inherits_browserExports,o=bnExports$4,$=requireBuffer().DecoderBuffer,j=requireNode(),et=requireDer$2();function tt(st){this.enc="der",this.name=st.name,this.entity=st,this.tree=new rt,this.tree._init(st.body)}der_1=tt,tt.prototype.decode=function(ot,at){return $.isDecoderBuffer(ot)||(ot=new $(ot,at)),this.tree._decode(ot,at)};function rt(st){j.call(this,"der",st)}_(rt,j),rt.prototype._peekTag=function(ot,at,ct){if(ot.isEmpty())return!1;const ut=ot.save(),ft=nt(ot,'Failed to peek tag: "'+at+'"');return ot.isError(ft)?ft:(ot.restore(ut),ft.tag===at||ft.tagStr===at||ft.tagStr+"of"===at||ct)},rt.prototype._decodeTag=function(ot,at,ct){const ut=nt(ot,'Failed to decode tag of "'+at+'"');if(ot.isError(ut))return ut;let ft=it(ot,ut.primitive,'Failed to get length of "'+at+'"');if(ot.isError(ft))return ft;if(!ct&&ut.tag!==at&&ut.tagStr!==at&&ut.tagStr+"of"!==at)return ot.error('Failed to match tag: "'+at+'"');if(ut.primitive||ft!==null)return ot.skip(ft,'Failed to match body of: "'+at+'"');const ht=ot.save(),mt=this._skipUntilEnd(ot,'Failed to skip indefinite length body: "'+this.tag+'"');return ot.isError(mt)?mt:(ft=ot.offset-ht.offset,ot.restore(ht),ot.skip(ft,'Failed to match body of: "'+at+'"'))},rt.prototype._skipUntilEnd=function(ot,at){for(;;){const ct=nt(ot,at);if(ot.isError(ct))return ct;const ut=it(ot,ct.primitive,at);if(ot.isError(ut))return ut;let ft;if(ct.primitive||ut!==null?ft=ot.skip(ut):ft=this._skipUntilEnd(ot,at),ot.isError(ft))return ft;if(ct.tagStr==="end")break}},rt.prototype._decodeList=function(ot,at,ct,ut){const ft=[];for(;!ot.isEmpty();){const ht=this._peekTag(ot,"end");if(ot.isError(ht))return ht;const mt=ct.decode(ot,"der",ut);if(ot.isError(mt)&&ht)break;ft.push(mt)}return ft},rt.prototype._decodeStr=function(ot,at){if(at==="bitstr"){const ct=ot.readUInt8();return ot.isError(ct)?ct:{unused:ct,data:ot.raw()}}else if(at==="bmpstr"){const ct=ot.raw();if(ct.length%2===1)return ot.error("Decoding of string type: bmpstr length mismatch");let ut="";for(let ft=0;ft<ct.length/2;ft++)ut+=String.fromCharCode(ct.readUInt16BE(ft*2));return ut}else if(at==="numstr"){const ct=ot.raw().toString("ascii");return this._isNumstr(ct)?ct:ot.error("Decoding of string type: numstr unsupported characters")}else{if(at==="octstr")return ot.raw();if(at==="objDesc")return ot.raw();if(at==="printstr"){const ct=ot.raw().toString("ascii");return this._isPrintstr(ct)?ct:ot.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(at)?ot.raw().toString():ot.error("Decoding of string type: "+at+" unsupported")}},rt.prototype._decodeObjid=function(ot,at,ct){let ut;const ft=[];let ht=0,mt=0;for(;!ot.isEmpty();)mt=ot.readUInt8(),ht<<=7,ht|=mt&127,mt&128||(ft.push(ht),ht=0);mt&128&&ft.push(ht);const gt=ft[0]/40|0,Et=ft[0]%40;if(ct?ut=ft:ut=[gt,Et].concat(ft.slice(1)),at){let St=at[ut.join(" ")];St===void 0&&(St=at[ut.join(".")]),St!==void 0&&(ut=St)}return ut},rt.prototype._decodeTime=function(ot,at){const ct=ot.raw().toString();let ut,ft,ht,mt,gt,Et;if(at==="gentime")ut=ct.slice(0,4)|0,ft=ct.slice(4,6)|0,ht=ct.slice(6,8)|0,mt=ct.slice(8,10)|0,gt=ct.slice(10,12)|0,Et=ct.slice(12,14)|0;else if(at==="utctime")ut=ct.slice(0,2)|0,ft=ct.slice(2,4)|0,ht=ct.slice(4,6)|0,mt=ct.slice(6,8)|0,gt=ct.slice(8,10)|0,Et=ct.slice(10,12)|0,ut<70?ut=2e3+ut:ut=1900+ut;else return ot.error("Decoding "+at+" time is not supported yet");return Date.UTC(ut,ft-1,ht,mt,gt,Et,0)},rt.prototype._decodeNull=function(){return null},rt.prototype._decodeBool=function(ot){const at=ot.readUInt8();return ot.isError(at)?at:at!==0},rt.prototype._decodeInt=function(ot,at){const ct=ot.raw();let ut=new o(ct);return at&&(ut=at[ut.toString(10)]||ut),ut},rt.prototype._use=function(ot,at){return typeof ot=="function"&&(ot=ot(at)),ot._getDecoder("der").tree};function nt(st,ot){let at=st.readUInt8(ot);if(st.isError(at))return at;const ct=et.tagClass[at>>6],ut=(at&32)===0;if((at&31)===31){let ht=at;for(at=0;(ht&128)===128;){if(ht=st.readUInt8(ot),st.isError(ht))return ht;at<<=7,at|=ht&127}}else at&=31;const ft=et.tag[at];return{cls:ct,primitive:ut,tag:at,tagStr:ft}}function it(st,ot,at){let ct=st.readUInt8(at);if(st.isError(ct))return ct;if(!ot&&ct===128)return null;if(!(ct&128))return ct;const ut=ct&127;if(ut>4)return st.error("length octect is too long");ct=0;for(let ft=0;ft<ut;ft++){ct<<=8;const ht=st.readUInt8(at);if(st.isError(ht))return ht;ct|=ht}return ct}return der_1}var pem$1,hasRequiredPem;function requirePem(){if(hasRequiredPem)return pem$1;hasRequiredPem=1;const _=inherits_browserExports,o=requireSafer().Buffer,$=requireDer();function j(et){$.call(this,et),this.enc="pem"}return _(j,$),pem$1=j,j.prototype.decode=function(tt,rt){const nt=tt.toString().split(/[\r\n]+/g),it=rt.label.toUpperCase(),st=/^-----(BEGIN|END) ([^-]+)-----$/;let ot=-1,at=-1;for(let ft=0;ft<nt.length;ft++){const ht=nt[ft].match(st);if(ht!==null&&ht[2]===it)if(ot===-1){if(ht[1]!=="BEGIN")break;ot=ft}else{if(ht[1]!=="END")break;at=ft;break}}if(ot===-1||at===-1)throw new Error("PEM section not found for: "+it);const ct=nt.slice(ot+1,at).join("");ct.replace(/[^a-z0-9+/=]+/gi,"");const ut=o.from(ct,"base64");return $.prototype.decode.call(this,ut,rt)},pem$1}var hasRequiredDecoders;function requireDecoders(){return hasRequiredDecoders||(hasRequiredDecoders=1,function(_){const o=_;o.der=requireDer(),o.pem=requirePem()}(decoders$4)),decoders$4}var hasRequiredApi;function requireApi(){return hasRequiredApi||(hasRequiredApi=1,function(_){const o=requireEncoders(),$=requireDecoders(),j=inherits_browserExports,et=_;et.define=function(nt,it){return new tt(nt,it)};function tt(rt,nt){this.name=rt,this.body=nt,this.decoders={},this.encoders={}}tt.prototype._createNamed=function(nt){const it=this.name;function st(ot){this._initNamed(ot,it)}return j(st,nt),st.prototype._initNamed=function(at,ct){nt.call(this,at,ct)},new st(this)},tt.prototype._getDecoder=function(nt){return nt=nt||"der",this.decoders.hasOwnProperty(nt)||(this.decoders[nt]=this._createNamed($[nt])),this.decoders[nt]},tt.prototype.decode=function(nt,it,st){return this._getDecoder(it).decode(nt,st)},tt.prototype._getEncoder=function(nt){return nt=nt||"der",this.encoders.hasOwnProperty(nt)||(this.encoders[nt]=this._createNamed(o[nt])),this.encoders[nt]},tt.prototype.encode=function(nt,it,st){return this._getEncoder(it).encode(nt,st)}}(api$1)),api$1}var base$6={},hasRequiredBase;function requireBase(){return hasRequiredBase||(hasRequiredBase=1,function(_){const o=_;o.Reporter=requireReporter().Reporter,o.DecoderBuffer=requireBuffer().DecoderBuffer,o.EncoderBuffer=requireBuffer().EncoderBuffer,o.Node=requireNode()}(base$6)),base$6}var constants$3={},hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,function(_){const o=_;o._reverse=function(j){const et={};return Object.keys(j).forEach(function(tt){(tt|0)==tt&&(tt=tt|0);const rt=j[tt];et[rt]=tt}),et},o.der=requireDer$2()}(constants$3)),constants$3}var hasRequiredAsn1$1;function requireAsn1$1(){return hasRequiredAsn1$1||(hasRequiredAsn1$1=1,function(_){const o=_;o.bignum=bnExports$4,o.define=requireApi().define,o.base=requireBase(),o.constants=requireConstants(),o.decoders=requireDecoders(),o.encoders=requireEncoders()}(asn1$5)),asn1$5}var certificate,hasRequiredCertificate;function requireCertificate(){if(hasRequiredCertificate)return certificate;hasRequiredCertificate=1;var _=requireAsn1$1(),o=_.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),$=_.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),j=_.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),et=_.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(j),this.key("subjectPublicKey").bitstr())}),tt=_.define("RelativeDistinguishedName",function(){this.setof($)}),rt=_.define("RDNSequence",function(){this.seqof(tt)}),nt=_.define("Name",function(){this.choice({rdnSequence:this.use(rt)})}),it=_.define("Validity",function(){this.seq().obj(this.key("notBefore").use(o),this.key("notAfter").use(o))}),st=_.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),ot=_.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(j),this.key("issuer").use(nt),this.key("validity").use(it),this.key("subject").use(nt),this.key("subjectPublicKeyInfo").use(et),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(st).optional())}),at=_.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(ot),this.key("signatureAlgorithm").use(j),this.key("signatureValue").bitstr())});return certificate=at,certificate}var hasRequiredAsn1;function requireAsn1(){if(hasRequiredAsn1)return asn1$6;hasRequiredAsn1=1;var _=requireAsn1$1();asn1$6.certificate=requireCertificate();var o=_.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});asn1$6.RSAPrivateKey=o;var $=_.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});asn1$6.RSAPublicKey=$;var j=_.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(et),this.key("subjectPublicKey").bitstr())});asn1$6.PublicKey=j;var et=_.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),tt=_.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(et),this.key("subjectPrivateKey").octstr())});asn1$6.PrivateKey=tt;var rt=_.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});asn1$6.EncryptedPrivateKey=rt;var nt=_.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});asn1$6.DSAPrivateKey=nt,asn1$6.DSAparam=_.define("DSAparam",function(){this.int()});var it=_.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(st),this.key("publicKey").optional().explicit(1).bitstr())});asn1$6.ECPrivateKey=it;var st=_.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});return asn1$6.signature=_.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}),asn1$6}const require$$1={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"};var fixProc,hasRequiredFixProc;function requireFixProc(){if(hasRequiredFixProc)return fixProc;hasRequiredFixProc=1;var _=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,$=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,j=requireEvp_bytestokey(),et=requireBrowser$7(),tt=safeBufferExports.Buffer;return fixProc=function(rt,nt){var it=rt.toString(),st=it.match(_),ot;if(st){var ct="aes"+st[1],ut=tt.from(st[2],"hex"),ft=tt.from(st[3].replace(/[\r\n]/g,""),"base64"),ht=j(nt,ut.slice(0,8),parseInt(st[1],10)).key,mt=[],gt=et.createDecipheriv(ct,ht,ut);mt.push(gt.update(ft)),mt.push(gt.final()),ot=tt.concat(mt)}else{var at=it.match($);ot=tt.from(at[2].replace(/[\r\n]/g,""),"base64")}var Et=it.match(o)[1];return{tag:Et,data:ot}},fixProc}var parseAsn1,hasRequiredParseAsn1;function requireParseAsn1(){if(hasRequiredParseAsn1)return parseAsn1;hasRequiredParseAsn1=1;var _=requireAsn1(),o=require$$1,$=requireFixProc(),j=requireBrowser$7(),et=requireBrowser$8(),tt=safeBufferExports.Buffer;parseAsn1=rt;function rt(it){var st;typeof it=="object"&&!tt.isBuffer(it)&&(st=it.passphrase,it=it.key),typeof it=="string"&&(it=tt.from(it));var ot=$(it,st),at=ot.tag,ct=ot.data,ut,ft;switch(at){case"CERTIFICATE":ft=_.certificate.decode(ct,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(ft||(ft=_.PublicKey.decode(ct,"der")),ut=ft.algorithm.algorithm.join("."),ut){case"1.2.840.113549.1.1.1":return _.RSAPublicKey.decode(ft.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return ft.subjectPrivateKey=ft.subjectPublicKey,{type:"ec",data:ft};case"1.2.840.10040.4.1":return ft.algorithm.params.pub_key=_.DSAparam.decode(ft.subjectPublicKey.data,"der"),{type:"dsa",data:ft.algorithm.params};default:throw new Error("unknown key id "+ut)}case"ENCRYPTED PRIVATE KEY":ct=_.EncryptedPrivateKey.decode(ct,"der"),ct=nt(ct,st);case"PRIVATE KEY":switch(ft=_.PrivateKey.decode(ct,"der"),ut=ft.algorithm.algorithm.join("."),ut){case"1.2.840.113549.1.1.1":return _.RSAPrivateKey.decode(ft.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:ft.algorithm.curve,privateKey:_.ECPrivateKey.decode(ft.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return ft.algorithm.params.priv_key=_.DSAparam.decode(ft.subjectPrivateKey,"der"),{type:"dsa",params:ft.algorithm.params};default:throw new Error("unknown key id "+ut)}case"RSA PUBLIC KEY":return _.RSAPublicKey.decode(ct,"der");case"RSA PRIVATE KEY":return _.RSAPrivateKey.decode(ct,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:_.DSAPrivateKey.decode(ct,"der")};case"EC PRIVATE KEY":return ct=_.ECPrivateKey.decode(ct,"der"),{curve:ct.parameters.value,privateKey:ct.privateKey};default:throw new Error("unknown key type "+at)}}rt.signature=_.signature;function nt(it,st){var ot=it.algorithm.decrypt.kde.kdeparams.salt,at=parseInt(it.algorithm.decrypt.kde.kdeparams.iters.toString(),10),ct=o[it.algorithm.decrypt.cipher.algo.join(".")],ut=it.algorithm.decrypt.cipher.iv,ft=it.subjectPrivateKey,ht=parseInt(ct.split("-")[1],10)/8,mt=et.pbkdf2Sync(st,ot,at,ht,"sha1"),gt=j.createDecipheriv(ct,mt,ut),Et=[];return Et.push(gt.update(ft)),Et.push(gt.final()),tt.concat(Et)}return parseAsn1}const require$$4={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var hasRequiredSign;function requireSign(){if(hasRequiredSign)return signExports;hasRequiredSign=1;var _=safeBufferExports.Buffer,o=requireBrowser$9(),$=requireBrowserifyRsa(),j=requireElliptic().ec,et=requireBn(),tt=requireParseAsn1(),rt=require$$4;function nt(mt,gt,Et,St,At){var kt=tt(gt);if(kt.curve){if(St!=="ecdsa"&&St!=="ecdsa/rsa")throw new Error("wrong private key type");return it(mt,kt)}else if(kt.type==="dsa"){if(St!=="dsa")throw new Error("wrong private key type");return st(mt,kt,Et)}else if(St!=="rsa"&&St!=="ecdsa/rsa")throw new Error("wrong private key type");mt=_.concat([At,mt]);for(var Rt=kt.modulus.byteLength(),Tt=[0,1];mt.length+Tt.length+1<Rt;)Tt.push(255);Tt.push(0);for(var Dt=-1;++Dt<mt.length;)Tt.push(mt[Dt]);var Ot=$(Tt,kt);return Ot}function it(mt,gt){var Et=rt[gt.curve.join(".")];if(!Et)throw new Error("unknown curve "+gt.curve.join("."));var St=new j(Et),At=St.keyFromPrivate(gt.privateKey),kt=At.sign(mt);return _.from(kt.toDER())}function st(mt,gt,Et){for(var St=gt.params.priv_key,At=gt.params.p,kt=gt.params.q,Rt=gt.params.g,Tt=new et(0),Dt,Ot=ct(mt,kt).mod(kt),jt=!1,Nt=at(St,kt,mt,Et);jt===!1;)Dt=ft(kt,Nt,Et),Tt=ht(Rt,Dt,At,kt),jt=Dt.invm(kt).imul(Ot.add(St.mul(Tt))).mod(kt),jt.cmpn(0)===0&&(jt=!1,Tt=new et(0));return ot(Tt,jt)}function ot(mt,gt){mt=mt.toArray(),gt=gt.toArray(),mt[0]&128&&(mt=[0].concat(mt)),gt[0]&128&&(gt=[0].concat(gt));var Et=mt.length+gt.length+4,St=[48,Et,2,mt.length];return St=St.concat(mt,[2,gt.length],gt),_.from(St)}function at(mt,gt,Et,St){if(mt=_.from(mt.toArray()),mt.length<gt.byteLength()){var At=_.alloc(gt.byteLength()-mt.length);mt=_.concat([At,mt])}var kt=Et.length,Rt=ut(Et,gt),Tt=_.alloc(kt);Tt.fill(1);var Dt=_.alloc(kt);return Dt=o(St,Dt).update(Tt).update(_.from([0])).update(mt).update(Rt).digest(),Tt=o(St,Dt).update(Tt).digest(),Dt=o(St,Dt).update(Tt).update(_.from([1])).update(mt).update(Rt).digest(),Tt=o(St,Dt).update(Tt).digest(),{k:Dt,v:Tt}}function ct(mt,gt){var Et=new et(mt),St=(mt.length<<3)-gt.bitLength();return St>0&&Et.ishrn(St),Et}function ut(mt,gt){mt=ct(mt,gt),mt=mt.mod(gt);var Et=_.from(mt.toArray());if(Et.length<gt.byteLength()){var St=_.alloc(gt.byteLength()-Et.length);Et=_.concat([St,Et])}return Et}function ft(mt,gt,Et){var St,At;do{for(St=_.alloc(0);St.length*8<mt.bitLength();)gt.v=o(Et,gt.k).update(gt.v).digest(),St=_.concat([St,gt.v]);At=ct(St,mt),gt.k=o(Et,gt.k).update(gt.v).update(_.from([0])).digest(),gt.v=o(Et,gt.k).update(gt.v).digest()}while(At.cmp(mt)!==-1);return At}function ht(mt,gt,Et,St){return mt.toRed(et.mont(Et)).redPow(gt).fromRed().mod(St)}return sign$2.exports=nt,signExports.getKey=at,signExports.makeKey=ft,signExports}var verify_1,hasRequiredVerify;function requireVerify(){if(hasRequiredVerify)return verify_1;hasRequiredVerify=1;var _=safeBufferExports.Buffer,o=requireBn(),$=requireElliptic().ec,j=requireParseAsn1(),et=require$$4;function tt(st,ot,at,ct,ut){var ft=j(at);if(ft.type==="ec"){if(ct!=="ecdsa"&&ct!=="ecdsa/rsa")throw new Error("wrong public key type");return rt(st,ot,ft)}else if(ft.type==="dsa"){if(ct!=="dsa")throw new Error("wrong public key type");return nt(st,ot,ft)}else if(ct!=="rsa"&&ct!=="ecdsa/rsa")throw new Error("wrong public key type");ot=_.concat([ut,ot]);for(var ht=ft.modulus.byteLength(),mt=[1],gt=0;ot.length+mt.length+2<ht;)mt.push(255),gt++;mt.push(0);for(var Et=-1;++Et<ot.length;)mt.push(ot[Et]);mt=_.from(mt);var St=o.mont(ft.modulus);st=new o(st).toRed(St),st=st.redPow(new o(ft.publicExponent)),st=_.from(st.fromRed().toArray());var At=gt<8?1:0;for(ht=Math.min(st.length,mt.length),st.length!==mt.length&&(At=1),Et=-1;++Et<ht;)At|=st[Et]^mt[Et];return At===0}function rt(st,ot,at){var ct=et[at.data.algorithm.curve.join(".")];if(!ct)throw new Error("unknown curve "+at.data.algorithm.curve.join("."));var ut=new $(ct),ft=at.data.subjectPrivateKey.data;return ut.verify(ot,st,ft)}function nt(st,ot,at){var ct=at.data.p,ut=at.data.q,ft=at.data.g,ht=at.data.pub_key,mt=j.signature.decode(st,"der"),gt=mt.s,Et=mt.r;it(gt,ut),it(Et,ut);var St=o.mont(ct),At=gt.invm(ut),kt=ft.toRed(St).redPow(new o(ot).mul(At).mod(ut)).fromRed().mul(ht.toRed(St).redPow(Et.mul(At).mod(ut)).fromRed()).mod(ct).mod(ut);return kt.cmp(Et)===0}function it(st,ot){if(st.cmpn(0)<=0)throw new Error("invalid sig");if(st.cmp(ot)>=ot)throw new Error("invalid sig")}return verify_1=tt,verify_1}var browser$8,hasRequiredBrowser$4;function requireBrowser$4(){if(hasRequiredBrowser$4)return browser$8;hasRequiredBrowser$4=1;var _=safeBufferExports.Buffer,o=requireBrowser$a(),$=requireReadableBrowser(),j=inherits_browserExports,et=requireSign(),tt=requireVerify(),rt=require$$6;Object.keys(rt).forEach(function(at){rt[at].id=_.from(rt[at].id,"hex"),rt[at.toLowerCase()]=rt[at]});function nt(at){$.Writable.call(this);var ct=rt[at];if(!ct)throw new Error("Unknown message digest");this._hashType=ct.hash,this._hash=o(ct.hash),this._tag=ct.id,this._signType=ct.sign}j(nt,$.Writable),nt.prototype._write=function(ct,ut,ft){this._hash.update(ct),ft()},nt.prototype.update=function(ct,ut){return typeof ct=="string"&&(ct=_.from(ct,ut)),this._hash.update(ct),this},nt.prototype.sign=function(ct,ut){this.end();var ft=this._hash.digest(),ht=et(ft,ct,this._hashType,this._signType,this._tag);return ut?ht.toString(ut):ht};function it(at){$.Writable.call(this);var ct=rt[at];if(!ct)throw new Error("Unknown message digest");this._hash=o(ct.hash),this._tag=ct.id,this._signType=ct.sign}j(it,$.Writable),it.prototype._write=function(ct,ut,ft){this._hash.update(ct),ft()},it.prototype.update=function(ct,ut){return typeof ct=="string"&&(ct=_.from(ct,ut)),this._hash.update(ct),this},it.prototype.verify=function(ct,ut,ft){typeof ut=="string"&&(ut=_.from(ut,ft)),this.end();var ht=this._hash.digest();return tt(ut,ht,ct,this._signType,this._tag)};function st(at){return new nt(at)}function ot(at){return new it(at)}return browser$8={Sign:st,Verify:ot,createSign:st,createVerify:ot},browser$8}var browser$7,hasRequiredBrowser$3;function requireBrowser$3(){if(hasRequiredBrowser$3)return browser$7;hasRequiredBrowser$3=1;var _=requireElliptic(),o=bnExports$4;browser$7=function(rt){return new j(rt)};var $={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};$.p224=$.secp224r1,$.p256=$.secp256r1=$.prime256v1,$.p192=$.secp192r1=$.prime192v1,$.p384=$.secp384r1,$.p521=$.secp521r1;function j(tt){this.curveType=$[tt],this.curveType||(this.curveType={name:tt}),this.curve=new _.ec(this.curveType.name),this.keys=void 0}j.prototype.generateKeys=function(tt,rt){return this.keys=this.curve.genKeyPair(),this.getPublicKey(tt,rt)},j.prototype.computeSecret=function(tt,rt,nt){rt=rt||"utf8",buffer$2.Buffer.isBuffer(tt)||(tt=new buffer$2.Buffer(tt,rt));var it=this.curve.keyFromPublic(tt).getPublic(),st=it.mul(this.keys.getPrivate()).getX();return et(st,nt,this.curveType.byteLength)},j.prototype.getPublicKey=function(tt,rt){var nt=this.keys.getPublic(rt==="compressed",!0);return rt==="hybrid"&&(nt[nt.length-1]%2?nt[0]=7:nt[0]=6),et(nt,tt)},j.prototype.getPrivateKey=function(tt){return et(this.keys.getPrivate(),tt)},j.prototype.setPublicKey=function(tt,rt){return rt=rt||"utf8",buffer$2.Buffer.isBuffer(tt)||(tt=new buffer$2.Buffer(tt,rt)),this.keys._importPublic(tt),this},j.prototype.setPrivateKey=function(tt,rt){rt=rt||"utf8",buffer$2.Buffer.isBuffer(tt)||(tt=new buffer$2.Buffer(tt,rt));var nt=new o(tt);return nt=nt.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(nt),this};function et(tt,rt,nt){Array.isArray(tt)||(tt=tt.toArray());var it=new buffer$2.Buffer(tt);if(nt&&it.length<nt){var st=new buffer$2.Buffer(nt-it.length);st.fill(0),it=buffer$2.Buffer.concat([st,it])}return rt?it.toString(rt):it}return browser$7}var browser$6={},mgf,hasRequiredMgf;function requireMgf(){if(hasRequiredMgf)return mgf;hasRequiredMgf=1;var _=requireBrowser$a(),o=safeBufferExports.Buffer;mgf=function(j,et){for(var tt=o.alloc(0),rt=0,nt;tt.length<et;)nt=$(rt++),tt=o.concat([tt,_("sha1").update(j).update(nt).digest()]);return tt.slice(0,et)};function $(j){var et=o.allocUnsafe(4);return et.writeUInt32BE(j,0),et}return mgf}var xor$1,hasRequiredXor;function requireXor(){return hasRequiredXor||(hasRequiredXor=1,xor$1=function(o,$){for(var j=o.length,et=-1;++et<j;)o[et]^=$[et];return o}),xor$1}var withPublic_1,hasRequiredWithPublic;function requireWithPublic(){if(hasRequiredWithPublic)return withPublic_1;hasRequiredWithPublic=1;var _=bnExports$4,o=safeBufferExports.Buffer;function $(j,et){return o.from(j.toRed(_.mont(et.modulus)).redPow(new _(et.publicExponent)).fromRed().toArray())}return withPublic_1=$,withPublic_1}var publicEncrypt,hasRequiredPublicEncrypt;function requirePublicEncrypt(){if(hasRequiredPublicEncrypt)return publicEncrypt;hasRequiredPublicEncrypt=1;var _=requireParseAsn1(),o=requireBrowser$c(),$=requireBrowser$a(),j=requireMgf(),et=requireXor(),tt=bnExports$4,rt=requireWithPublic(),nt=requireBrowserifyRsa(),it=safeBufferExports.Buffer;publicEncrypt=function(ut,ft,ht){var mt;ut.padding?mt=ut.padding:ht?mt=1:mt=4;var gt=_(ut),Et;if(mt===4)Et=st(gt,ft);else if(mt===1)Et=ot(gt,ft,ht);else if(mt===3){if(Et=new tt(ft),Et.cmp(gt.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return ht?nt(Et,gt):rt(Et,gt)};function st(ct,ut){var ft=ct.modulus.byteLength(),ht=ut.length,mt=$("sha1").update(it.alloc(0)).digest(),gt=mt.length,Et=2*gt;if(ht>ft-Et-2)throw new Error("message too long");var St=it.alloc(ft-ht-Et-2),At=ft-gt-1,kt=o(gt),Rt=et(it.concat([mt,St,it.alloc(1,1),ut],At),j(kt,At)),Tt=et(kt,j(Rt,gt));return new tt(it.concat([it.alloc(1),Tt,Rt],ft))}function ot(ct,ut,ft){var ht=ut.length,mt=ct.modulus.byteLength();if(ht>mt-11)throw new Error("message too long");var gt;return ft?gt=it.alloc(mt-ht-3,255):gt=at(mt-ht-3),new tt(it.concat([it.from([0,ft?1:2]),gt,it.alloc(1),ut],mt))}function at(ct){for(var ut=it.allocUnsafe(ct),ft=0,ht=o(ct*2),mt=0,gt;ft<ct;)mt===ht.length&&(ht=o(ct*2),mt=0),gt=ht[mt++],gt&&(ut[ft++]=gt);return ut}return publicEncrypt}var privateDecrypt,hasRequiredPrivateDecrypt;function requirePrivateDecrypt(){if(hasRequiredPrivateDecrypt)return privateDecrypt;hasRequiredPrivateDecrypt=1;var _=requireParseAsn1(),o=requireMgf(),$=requireXor(),j=bnExports$4,et=requireBrowserifyRsa(),tt=requireBrowser$a(),rt=requireWithPublic(),nt=safeBufferExports.Buffer;privateDecrypt=function(ct,ut,ft){var ht;ct.padding?ht=ct.padding:ft?ht=1:ht=4;var mt=_(ct),gt=mt.modulus.byteLength();if(ut.length>gt||new j(ut).cmp(mt.modulus)>=0)throw new Error("decryption error");var Et;ft?Et=rt(new j(ut),mt):Et=et(ut,mt);var St=nt.alloc(gt-Et.length);if(Et=nt.concat([St,Et],gt),ht===4)return it(mt,Et);if(ht===1)return st(mt,Et,ft);if(ht===3)return Et;throw new Error("unknown padding")};function it(at,ct){var ut=at.modulus.byteLength(),ft=tt("sha1").update(nt.alloc(0)).digest(),ht=ft.length;if(ct[0]!==0)throw new Error("decryption error");var mt=ct.slice(1,ht+1),gt=ct.slice(ht+1),Et=$(mt,o(gt,ht)),St=$(gt,o(Et,ut-ht-1));if(ot(ft,St.slice(0,ht)))throw new Error("decryption error");for(var At=ht;St[At]===0;)At++;if(St[At++]!==1)throw new Error("decryption error");return St.slice(At)}function st(at,ct,ut){for(var ft=ct.slice(0,2),ht=2,mt=0;ct[ht++]!==0;)if(ht>=ct.length){mt++;break}var gt=ct.slice(2,ht-1);if((ft.toString("hex")!=="0002"&&!ut||ft.toString("hex")!=="0001"&&ut)&&mt++,gt.length<8&&mt++,mt)throw new Error("decryption error");return ct.slice(ht)}function ot(at,ct){at=nt.from(at),ct=nt.from(ct);var ut=0,ft=at.length;at.length!==ct.length&&(ut++,ft=Math.min(at.length,ct.length));for(var ht=-1;++ht<ft;)ut+=at[ht]^ct[ht];return ut}return privateDecrypt}var hasRequiredBrowser$2;function requireBrowser$2(){return hasRequiredBrowser$2||(hasRequiredBrowser$2=1,function(_){_.publicEncrypt=requirePublicEncrypt(),_.privateDecrypt=requirePrivateDecrypt(),_.privateEncrypt=function($,j){return _.publicEncrypt($,j,!0)},_.publicDecrypt=function($,j){return _.privateDecrypt($,j,!0)}}(browser$6)),browser$6}var browser$5={},hasRequiredBrowser$1;function requireBrowser$1(){if(hasRequiredBrowser$1)return browser$5;hasRequiredBrowser$1=1;function _(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var o=safeBufferExports,$=requireBrowser$c(),j=o.Buffer,et=o.kMaxLength,tt=commonjsGlobal.crypto||commonjsGlobal.msCrypto,rt=Math.pow(2,32)-1;function nt(ct,ut){if(typeof ct!="number"||ct!==ct)throw new TypeError("offset must be a number");if(ct>rt||ct<0)throw new TypeError("offset must be a uint32");if(ct>et||ct>ut)throw new RangeError("offset out of range")}function it(ct,ut,ft){if(typeof ct!="number"||ct!==ct)throw new TypeError("size must be a number");if(ct>rt||ct<0)throw new TypeError("size must be a uint32");if(ct+ut>ft||ct>et)throw new RangeError("buffer too small")}tt&&tt.getRandomValues||!browserExports$3.browser?(browser$5.randomFill=st,browser$5.randomFillSync=at):(browser$5.randomFill=_,browser$5.randomFillSync=_);function st(ct,ut,ft,ht){if(!j.isBuffer(ct)&&!(ct instanceof commonjsGlobal.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof ut=="function")ht=ut,ut=0,ft=ct.length;else if(typeof ft=="function")ht=ft,ft=ct.length-ut;else if(typeof ht!="function")throw new TypeError('"cb" argument must be a function');return nt(ut,ct.length),it(ft,ut,ct.length),ot(ct,ut,ft,ht)}function ot(ct,ut,ft,ht){if(browserExports$3.browser){var mt=ct.buffer,gt=new Uint8Array(mt,ut,ft);if(tt.getRandomValues(gt),ht){browserExports$3.nextTick(function(){ht(null,ct)});return}return ct}if(ht){$(ft,function(St,At){if(St)return ht(St);At.copy(ct,ut),ht(null,ct)});return}var Et=$(ft);return Et.copy(ct,ut),ct}function at(ct,ut,ft){if(typeof ut>"u"&&(ut=0),!j.isBuffer(ct)&&!(ct instanceof commonjsGlobal.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return nt(ut,ct.length),ft===void 0&&(ft=ct.length-ut),it(ft,ut,ct.length),ot(ct,ut,ft)}return browser$5}var hasRequiredCryptoBrowserify;function requireCryptoBrowserify(){if(hasRequiredCryptoBrowserify)return cryptoBrowserify;hasRequiredCryptoBrowserify=1,cryptoBrowserify.randomBytes=cryptoBrowserify.rng=cryptoBrowserify.pseudoRandomBytes=cryptoBrowserify.prng=requireBrowser$c(),cryptoBrowserify.createHash=cryptoBrowserify.Hash=requireBrowser$a(),cryptoBrowserify.createHmac=cryptoBrowserify.Hmac=requireBrowser$9();var _=requireAlgos(),o=Object.keys(_),$=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(o);cryptoBrowserify.getHashes=function(){return $};var j=requireBrowser$8();cryptoBrowserify.pbkdf2=j.pbkdf2,cryptoBrowserify.pbkdf2Sync=j.pbkdf2Sync;var et=requireBrowser$6();cryptoBrowserify.Cipher=et.Cipher,cryptoBrowserify.createCipher=et.createCipher,cryptoBrowserify.Cipheriv=et.Cipheriv,cryptoBrowserify.createCipheriv=et.createCipheriv,cryptoBrowserify.Decipher=et.Decipher,cryptoBrowserify.createDecipher=et.createDecipher,cryptoBrowserify.Decipheriv=et.Decipheriv,cryptoBrowserify.createDecipheriv=et.createDecipheriv,cryptoBrowserify.getCiphers=et.getCiphers,cryptoBrowserify.listCiphers=et.listCiphers;var tt=requireBrowser$5();cryptoBrowserify.DiffieHellmanGroup=tt.DiffieHellmanGroup,cryptoBrowserify.createDiffieHellmanGroup=tt.createDiffieHellmanGroup,cryptoBrowserify.getDiffieHellman=tt.getDiffieHellman,cryptoBrowserify.createDiffieHellman=tt.createDiffieHellman,cryptoBrowserify.DiffieHellman=tt.DiffieHellman;var rt=requireBrowser$4();cryptoBrowserify.createSign=rt.createSign,cryptoBrowserify.Sign=rt.Sign,cryptoBrowserify.createVerify=rt.createVerify,cryptoBrowserify.Verify=rt.Verify,cryptoBrowserify.createECDH=requireBrowser$3();var nt=requireBrowser$2();cryptoBrowserify.publicEncrypt=nt.publicEncrypt,cryptoBrowserify.privateEncrypt=nt.privateEncrypt,cryptoBrowserify.publicDecrypt=nt.publicDecrypt,cryptoBrowserify.privateDecrypt=nt.privateDecrypt;var it=requireBrowser$1();return cryptoBrowserify.randomFill=it.randomFill,cryptoBrowserify.randomFillSync=it.randomFillSync,cryptoBrowserify.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},cryptoBrowserify.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6},cryptoBrowserify}var forge$i=forge$s,pkcs5=forge$i.pkcs5=forge$i.pkcs5||{},crypto$5;forge$i.util.isNodejs&&!forge$i.options.usePureJavaScript&&(crypto$5=requireCryptoBrowserify());var pbkdf2$3=forge$i.pbkdf2=pkcs5.pbkdf2=function(_,o,$,j,et,tt){if(typeof et=="function"&&(tt=et,et=null),forge$i.util.isNodejs&&!forge$i.options.usePureJavaScript&&crypto$5.pbkdf2&&(et===null||typeof et!="object")&&(crypto$5.pbkdf2Sync.length>4||!et||et==="sha1"))return typeof et!="string"&&(et="sha1"),_=buffer$2.Buffer.from(_,"binary"),o=buffer$2.Buffer.from(o,"binary"),tt?crypto$5.pbkdf2Sync.length===4?crypto$5.pbkdf2(_,o,$,j,function(St,At){if(St)return tt(St);tt(null,At.toString("binary"))}):crypto$5.pbkdf2(_,o,$,j,et,function(St,At){if(St)return tt(St);tt(null,At.toString("binary"))}):crypto$5.pbkdf2Sync.length===4?crypto$5.pbkdf2Sync(_,o,$,j).toString("binary"):crypto$5.pbkdf2Sync(_,o,$,j,et).toString("binary");if((typeof et>"u"||et===null)&&(et="sha1"),typeof et=="string"){if(!(et in forge$i.md.algorithms))throw new Error("Unknown hash algorithm: "+et);et=forge$i.md[et].create()}var rt=et.digestLength;if(j>4294967295*rt){var nt=new Error("Derived key is too long.");if(tt)return tt(nt);throw nt}var it=Math.ceil(j/rt),st=j-(it-1)*rt,ot=forge$i.hmac.create();ot.start(et,_);var at="",ct,ut,ft;if(!tt){for(var ht=1;ht<=it;++ht){ot.start(null,null),ot.update(o),ot.update(forge$i.util.int32ToBytes(ht)),ct=ft=ot.digest().getBytes();for(var mt=2;mt<=$;++mt)ot.start(null,null),ot.update(ft),ut=ot.digest().getBytes(),ct=forge$i.util.xorBytes(ct,ut,rt),ft=ut;at+=ht<it?ct:ct.substr(0,st)}return at}var ht=1,mt;function gt(){if(ht>it)return tt(null,at);ot.start(null,null),ot.update(o),ot.update(forge$i.util.int32ToBytes(ht)),ct=ft=ot.digest().getBytes(),mt=2,Et()}function Et(){if(mt<=$)return ot.start(null,null),ot.update(ft),ut=ot.digest().getBytes(),ct=forge$i.util.xorBytes(ct,ut,rt),ft=ut,++mt,forge$i.util.setImmediate(Et);at+=ht<it?ct:ct.substr(0,st),++ht,gt()}gt()},forge$h=forge$s,pem=forge$h.pem=forge$h.pem||{};pem.encode=function(_,o){o=o||{};var $="-----BEGIN "+_.type+`-----\r
`,j;if(_.procType&&(j={name:"Proc-Type",values:[String(_.procType.version),_.procType.type]},$+=foldHeader(j)),_.contentDomain&&(j={name:"Content-Domain",values:[_.contentDomain]},$+=foldHeader(j)),_.dekInfo&&(j={name:"DEK-Info",values:[_.dekInfo.algorithm]},_.dekInfo.parameters&&j.values.push(_.dekInfo.parameters),$+=foldHeader(j)),_.headers)for(var et=0;et<_.headers.length;++et)$+=foldHeader(_.headers[et]);return _.procType&&($+=`\r
`),$+=forge$h.util.encode64(_.body,o.maxline||64)+`\r
`,$+="-----END "+_.type+`-----\r
`,$};pem.decode=function(_){for(var o=[],$=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,j=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,et=/\r?\n/,tt;tt=$.exec(_),!!tt;){var rt=tt[1];rt==="NEW CERTIFICATE REQUEST"&&(rt="CERTIFICATE REQUEST");var nt={type:rt,procType:null,contentDomain:null,dekInfo:null,headers:[],body:forge$h.util.decode64(tt[3])};if(o.push(nt),!!tt[2]){for(var it=tt[2].split(et),st=0;tt&&st<it.length;){for(var ot=it[st].replace(/\s+$/,""),at=st+1;at<it.length;++at){var ct=it[at];if(!/\s/.test(ct[0]))break;ot+=ct,st=at}if(tt=ot.match(j),tt){for(var ut={name:tt[1],values:[]},ft=tt[2].split(","),ht=0;ht<ft.length;++ht)ut.values.push(ltrim(ft[ht]));if(nt.procType)if(!nt.contentDomain&&ut.name==="Content-Domain")nt.contentDomain=ft[0]||"";else if(!nt.dekInfo&&ut.name==="DEK-Info"){if(ut.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');nt.dekInfo={algorithm:ft[0],parameters:ft[1]||null}}else nt.headers.push(ut);else{if(ut.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(ut.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');nt.procType={version:ft[0],type:ft[1]}}}++st}if(nt.procType==="ENCRYPTED"&&!nt.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(o.length===0)throw new Error("Invalid PEM formatted message.");return o};function foldHeader(_){for(var o=_.name+": ",$=[],j=function(it,st){return" "+st},et=0;et<_.values.length;++et)$.push(_.values[et].replace(/^(\S+\r\n)/,j));o+=$.join(",")+`\r
`;for(var tt=0,rt=-1,et=0;et<o.length;++et,++tt)if(tt>65&&rt!==-1){var nt=o[rt];nt===","?(++rt,o=o.substr(0,rt)+`\r
 `+o.substr(rt)):o=o.substr(0,rt)+`\r
`+nt+o.substr(rt+1),tt=et-rt-1,rt=-1,++et}else(o[et]===" "||o[et]==="	"||o[et]===",")&&(rt=et);return o}function ltrim(_){return _.replace(/^\s+/,"")}var forge$g=forge$s,sha256$5=forge$g.sha256=forge$g.sha256||{};forge$g.md.sha256=forge$g.md.algorithms.sha256=sha256$5;sha256$5.create=function(){_initialized$2||_init$2();var _=null,o=forge$g.util.createBuffer(),$=new Array(64),j={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return j.start=function(){j.messageLength=0,j.fullMessageLength=j.messageLength64=[];for(var et=j.messageLengthSize/4,tt=0;tt<et;++tt)j.fullMessageLength.push(0);return o=forge$g.util.createBuffer(),_={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},j},j.start(),j.update=function(et,tt){tt==="utf8"&&(et=forge$g.util.encodeUtf8(et));var rt=et.length;j.messageLength+=rt,rt=[rt/4294967296>>>0,rt>>>0];for(var nt=j.fullMessageLength.length-1;nt>=0;--nt)j.fullMessageLength[nt]+=rt[1],rt[1]=rt[0]+(j.fullMessageLength[nt]/4294967296>>>0),j.fullMessageLength[nt]=j.fullMessageLength[nt]>>>0,rt[0]=rt[1]/4294967296>>>0;return o.putBytes(et),_update$2(_,$,o),(o.read>2048||o.length()===0)&&o.compact(),j},j.digest=function(){var et=forge$g.util.createBuffer();et.putBytes(o.bytes());var tt=j.fullMessageLength[j.fullMessageLength.length-1]+j.messageLengthSize,rt=tt&j.blockLength-1;et.putBytes(_padding$2.substr(0,j.blockLength-rt));for(var nt,it,st=j.fullMessageLength[0]*8,ot=0;ot<j.fullMessageLength.length-1;++ot)nt=j.fullMessageLength[ot+1]*8,it=nt/4294967296>>>0,st+=it,et.putInt32(st>>>0),st=nt>>>0;et.putInt32(st);var at={h0:_.h0,h1:_.h1,h2:_.h2,h3:_.h3,h4:_.h4,h5:_.h5,h6:_.h6,h7:_.h7};_update$2(at,$,et);var ct=forge$g.util.createBuffer();return ct.putInt32(at.h0),ct.putInt32(at.h1),ct.putInt32(at.h2),ct.putInt32(at.h3),ct.putInt32(at.h4),ct.putInt32(at.h5),ct.putInt32(at.h6),ct.putInt32(at.h7),ct},j};var _padding$2=null,_initialized$2=!1,_k$1=null;function _init$2(){_padding$2=String.fromCharCode(128),_padding$2+=forge$g.util.fillString(String.fromCharCode(0),64),_k$1=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_initialized$2=!0}function _update$2(_,o,$){for(var j,et,tt,rt,nt,it,st,ot,at,ct,ut,ft,ht,mt,gt,Et=$.length();Et>=64;){for(st=0;st<16;++st)o[st]=$.getInt32();for(;st<64;++st)j=o[st-2],j=(j>>>17|j<<15)^(j>>>19|j<<13)^j>>>10,et=o[st-15],et=(et>>>7|et<<25)^(et>>>18|et<<14)^et>>>3,o[st]=j+o[st-7]+et+o[st-16]|0;for(ot=_.h0,at=_.h1,ct=_.h2,ut=_.h3,ft=_.h4,ht=_.h5,mt=_.h6,gt=_.h7,st=0;st<64;++st)rt=(ft>>>6|ft<<26)^(ft>>>11|ft<<21)^(ft>>>25|ft<<7),nt=mt^ft&(ht^mt),tt=(ot>>>2|ot<<30)^(ot>>>13|ot<<19)^(ot>>>22|ot<<10),it=ot&at|ct&(ot^at),j=gt+rt+nt+_k$1[st]+o[st],et=tt+it,gt=mt,mt=ht,ht=ft,ft=ut+j>>>0,ut=ct,ct=at,at=ot,ot=j+et>>>0;_.h0=_.h0+ot|0,_.h1=_.h1+at|0,_.h2=_.h2+ct|0,_.h3=_.h3+ut|0,_.h4=_.h4+ft|0,_.h5=_.h5+ht|0,_.h6=_.h6+mt|0,_.h7=_.h7+gt|0,Et-=64}}var forge$f=forge$s,_crypto$1=null;forge$f.util.isNodejs&&!forge$f.options.usePureJavaScript&&!browserExports$3.versions["node-webkit"]&&(_crypto$1=requireCryptoBrowserify());var prng=forge$f.prng=forge$f.prng||{};prng.create=function(_){for(var o={plugin:_,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},$=_.md,j=new Array(32),et=0;et<32;++et)j[et]=$.create();o.pools=j,o.pool=0,o.generate=function(st,ot){if(!ot)return o.generateSync(st);var at=o.plugin.cipher,ct=o.plugin.increment,ut=o.plugin.formatKey,ft=o.plugin.formatSeed,ht=forge$f.util.createBuffer();o.key=null,mt();function mt(gt){if(gt)return ot(gt);if(ht.length()>=st)return ot(null,ht.getBytes(st));if(o.generated>1048575&&(o.key=null),o.key===null)return forge$f.util.nextTick(function(){tt(mt)});var Et=at(o.key,o.seed);o.generated+=Et.length,ht.putBytes(Et),o.key=ut(at(o.key,ct(o.seed))),o.seed=ft(at(o.key,o.seed)),forge$f.util.setImmediate(mt)}},o.generateSync=function(st){var ot=o.plugin.cipher,at=o.plugin.increment,ct=o.plugin.formatKey,ut=o.plugin.formatSeed;o.key=null;for(var ft=forge$f.util.createBuffer();ft.length()<st;){o.generated>1048575&&(o.key=null),o.key===null&&rt();var ht=ot(o.key,o.seed);o.generated+=ht.length,ft.putBytes(ht),o.key=ct(ot(o.key,at(o.seed))),o.seed=ut(ot(o.key,o.seed))}return ft.getBytes(st)};function tt(st){if(o.pools[0].messageLength>=32)return nt(),st();var ot=32-o.pools[0].messageLength<<5;o.seedFile(ot,function(at,ct){if(at)return st(at);o.collect(ct),nt(),st()})}function rt(){if(o.pools[0].messageLength>=32)return nt();var st=32-o.pools[0].messageLength<<5;o.collect(o.seedFileSync(st)),nt()}function nt(){o.reseeds=o.reseeds===4294967295?0:o.reseeds+1;var st=o.plugin.md.create();st.update(o.keyBytes);for(var ot=1,at=0;at<32;++at)o.reseeds%ot===0&&(st.update(o.pools[at].digest().getBytes()),o.pools[at].start()),ot=ot<<1;o.keyBytes=st.digest().getBytes(),st.start(),st.update(o.keyBytes);var ct=st.digest().getBytes();o.key=o.plugin.formatKey(o.keyBytes),o.seed=o.plugin.formatSeed(ct),o.generated=0}function it(st){var ot=null,at=forge$f.util.globalScope,ct=at.crypto||at.msCrypto;ct&&ct.getRandomValues&&(ot=function(kt){return ct.getRandomValues(kt)});var ut=forge$f.util.createBuffer();if(ot)for(;ut.length()<st;){var ft=Math.max(1,Math.min(st-ut.length(),65536)/4),ht=new Uint32Array(Math.floor(ft));try{ot(ht);for(var mt=0;mt<ht.length;++mt)ut.putInt32(ht[mt])}catch(kt){if(!(typeof QuotaExceededError<"u"&&kt instanceof QuotaExceededError))throw kt}}if(ut.length()<st)for(var gt,Et,St,At=Math.floor(Math.random()*65536);ut.length()<st;){Et=16807*(At&65535),gt=16807*(At>>16),Et+=(gt&32767)<<16,Et+=gt>>15,Et=(Et&2147483647)+(Et>>31),At=Et&4294967295;for(var mt=0;mt<3;++mt)St=At>>>(mt<<3),St^=Math.floor(Math.random()*256),ut.putByte(St&255)}return ut.getBytes(st)}return _crypto$1?(o.seedFile=function(st,ot){_crypto$1.randomBytes(st,function(at,ct){if(at)return ot(at);ot(null,ct.toString())})},o.seedFileSync=function(st){return _crypto$1.randomBytes(st).toString()}):(o.seedFile=function(st,ot){try{ot(null,it(st))}catch(at){ot(at)}},o.seedFileSync=it),o.collect=function(st){for(var ot=st.length,at=0;at<ot;++at)o.pools[o.pool].update(st.substr(at,1)),o.pool=o.pool===31?0:o.pool+1},o.collectInt=function(st,ot){for(var at="",ct=0;ct<ot;ct+=8)at+=String.fromCharCode(st>>ct&255);o.collect(at)},o.registerWorker=function(st){if(st===self)o.seedFile=function(at,ct){function ut(ft){var ht=ft.data;ht.forge&&ht.forge.prng&&(self.removeEventListener("message",ut),ct(ht.forge.prng.err,ht.forge.prng.bytes))}self.addEventListener("message",ut),self.postMessage({forge:{prng:{needed:at}}})};else{var ot=function(at){var ct=at.data;ct.forge&&ct.forge.prng&&o.seedFile(ct.forge.prng.needed,function(ut,ft){st.postMessage({forge:{prng:{err:ut,bytes:ft}}})})};st.addEventListener("message",ot)}},o};var forge$e=forge$s;(function(){forge$e.random&&forge$e.random.getBytes||function(_){var o={},$=new Array(4),j=forge$e.util.createBuffer();o.formatKey=function(at){var ct=forge$e.util.createBuffer(at);return at=new Array(4),at[0]=ct.getInt32(),at[1]=ct.getInt32(),at[2]=ct.getInt32(),at[3]=ct.getInt32(),forge$e.aes._expandKey(at,!1)},o.formatSeed=function(at){var ct=forge$e.util.createBuffer(at);return at=new Array(4),at[0]=ct.getInt32(),at[1]=ct.getInt32(),at[2]=ct.getInt32(),at[3]=ct.getInt32(),at},o.cipher=function(at,ct){return forge$e.aes._updateBlock(at,ct,$,!1),j.putInt32($[0]),j.putInt32($[1]),j.putInt32($[2]),j.putInt32($[3]),j.getBytes()},o.increment=function(at){return++at[3],at},o.md=forge$e.md.sha256;function et(){var at=forge$e.prng.create(o);return at.getBytes=function(ct,ut){return at.generate(ct,ut)},at.getBytesSync=function(ct){return at.generate(ct)},at}var tt=et(),rt=null,nt=forge$e.util.globalScope,it=nt.crypto||nt.msCrypto;if(it&&it.getRandomValues&&(rt=function(at){return it.getRandomValues(at)}),!forge$e.util.isNodejs&&!rt){if(tt.collectInt(+new Date,32),typeof navigator<"u"){var st="";for(var ot in navigator)try{typeof navigator[ot]=="string"&&(st+=navigator[ot])}catch{}tt.collect(st),st=null}_&&(_().mousemove(function(at){tt.collectInt(at.clientX,16),tt.collectInt(at.clientY,16)}),_().keypress(function(at){tt.collectInt(at.charCode,8)}))}if(!forge$e.random)forge$e.random=tt;else for(var ot in tt)forge$e.random[ot]=tt[ot];forge$e.random.createInstance=et}(typeof jQuery<"u"?jQuery:null)})();var forge$d=forge$s,piTable=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s$1=[1,2,3,5],rol=function(_,o){return _<<o&65535|(_&65535)>>16-o},ror=function(_,o){return(_&65535)>>o|_<<16-o&65535};forge$d.rc2=forge$d.rc2||{};forge$d.rc2.expandKey=function(_,o){typeof _=="string"&&(_=forge$d.util.createBuffer(_)),o=o||128;var $=_,j=_.length(),et=o,tt=Math.ceil(et/8),rt=255>>(et&7),nt;for(nt=j;nt<128;nt++)$.putByte(piTable[$.at(nt-1)+$.at(nt-j)&255]);for($.setAt(128-tt,piTable[$.at(128-tt)&rt]),nt=127-tt;nt>=0;nt--)$.setAt(nt,piTable[$.at(nt+1)^$.at(nt+tt)]);return $};var createCipher=function(_,o,$){var j=!1,et=null,tt=null,rt=null,nt,it,st,ot,at=[];for(_=forge$d.rc2.expandKey(_,o),st=0;st<64;st++)at.push(_.getInt16Le());$?(nt=function(ft){for(st=0;st<4;st++)ft[st]+=at[ot]+(ft[(st+3)%4]&ft[(st+2)%4])+(~ft[(st+3)%4]&ft[(st+1)%4]),ft[st]=rol(ft[st],s$1[st]),ot++},it=function(ft){for(st=0;st<4;st++)ft[st]+=at[ft[(st+3)%4]&63]}):(nt=function(ft){for(st=3;st>=0;st--)ft[st]=ror(ft[st],s$1[st]),ft[st]-=at[ot]+(ft[(st+3)%4]&ft[(st+2)%4])+(~ft[(st+3)%4]&ft[(st+1)%4]),ot--},it=function(ft){for(st=3;st>=0;st--)ft[st]-=at[ft[(st+3)%4]&63]});var ct=function(ft){var ht=[];for(st=0;st<4;st++){var mt=et.getInt16Le();rt!==null&&($?mt^=rt.getInt16Le():rt.putInt16Le(mt)),ht.push(mt&65535)}ot=$?0:63;for(var gt=0;gt<ft.length;gt++)for(var Et=0;Et<ft[gt][0];Et++)ft[gt][1](ht);for(st=0;st<4;st++)rt!==null&&($?rt.putInt16Le(ht[st]):ht[st]^=rt.getInt16Le()),tt.putInt16Le(ht[st])},ut=null;return ut={start:function(ft,ht){ft&&typeof ft=="string"&&(ft=forge$d.util.createBuffer(ft)),j=!1,et=forge$d.util.createBuffer(),tt=ht||new forge$d.util.createBuffer,rt=ft,ut.output=tt},update:function(ft){for(j||et.putBuffer(ft);et.length()>=8;)ct([[5,nt],[1,it],[6,nt],[1,it],[5,nt]])},finish:function(ft){var ht=!0;if($)if(ft)ht=ft(8,et,!$);else{var mt=et.length()===8?8:8-et.length();et.fillWithByte(mt,mt)}if(ht&&(j=!0,ut.update()),!$&&(ht=et.length()===0,ht))if(ft)ht=ft(8,tt,!$);else{var gt=tt.length(),Et=tt.at(gt-1);Et>gt?ht=!1:tt.truncate(Et)}return ht}},ut};forge$d.rc2.startEncrypting=function(_,o,$){var j=forge$d.rc2.createEncryptionCipher(_,128);return j.start(o,$),j};forge$d.rc2.createEncryptionCipher=function(_,o){return createCipher(_,o,!0)};forge$d.rc2.startDecrypting=function(_,o,$){var j=forge$d.rc2.createDecryptionCipher(_,128);return j.start(o,$),j};forge$d.rc2.createDecryptionCipher=function(_,o){return createCipher(_,o,!1)};var forge$c=forge$s;forge$c.jsbn=forge$c.jsbn||{};var dbits;function BigInteger$2(_,o,$){this.data=[],_!=null&&(typeof _=="number"?this.fromNumber(_,o,$):o==null&&typeof _!="string"?this.fromString(_,256):this.fromString(_,o))}forge$c.jsbn.BigInteger=BigInteger$2;function nbi(){return new BigInteger$2(null)}function am1(_,o,$,j,et,tt){for(;--tt>=0;){var rt=o*this.data[_++]+$.data[j]+et;et=Math.floor(rt/67108864),$.data[j++]=rt&67108863}return et}function am2(_,o,$,j,et,tt){for(var rt=o&32767,nt=o>>15;--tt>=0;){var it=this.data[_]&32767,st=this.data[_++]>>15,ot=nt*it+st*rt;it=rt*it+((ot&32767)<<15)+$.data[j]+(et&1073741823),et=(it>>>30)+(ot>>>15)+nt*st+(et>>>30),$.data[j++]=it&1073741823}return et}function am3(_,o,$,j,et,tt){for(var rt=o&16383,nt=o>>14;--tt>=0;){var it=this.data[_]&16383,st=this.data[_++]>>14,ot=nt*it+st*rt;it=rt*it+((ot&16383)<<14)+$.data[j]+et,et=(it>>28)+(ot>>14)+nt*st,$.data[j++]=it&268435455}return et}typeof navigator>"u"?(BigInteger$2.prototype.am=am3,dbits=28):navigator.appName=="Microsoft Internet Explorer"?(BigInteger$2.prototype.am=am2,dbits=30):navigator.appName!="Netscape"?(BigInteger$2.prototype.am=am1,dbits=26):(BigInteger$2.prototype.am=am3,dbits=28);BigInteger$2.prototype.DB=dbits;BigInteger$2.prototype.DM=(1<<dbits)-1;BigInteger$2.prototype.DV=1<<dbits;var BI_FP=52;BigInteger$2.prototype.FV=Math.pow(2,BI_FP);BigInteger$2.prototype.F1=BI_FP-dbits;BigInteger$2.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv)BI_RC[rr++]=vv;rr="a".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;rr="A".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(_){return BI_RM.charAt(_)}function intAt(_,o){var $=BI_RC[_.charCodeAt(o)];return $??-1}function bnpCopyTo(_){for(var o=this.t-1;o>=0;--o)_.data[o]=this.data[o];_.t=this.t,_.s=this.s}function bnpFromInt(_){this.t=1,this.s=_<0?-1:0,_>0?this.data[0]=_:_<-1?this.data[0]=_+this.DV:this.t=0}function nbv(_){var o=nbi();return o.fromInt(_),o}function bnpFromString(_,o){var $;if(o==16)$=4;else if(o==8)$=3;else if(o==256)$=8;else if(o==2)$=1;else if(o==32)$=5;else if(o==4)$=2;else{this.fromRadix(_,o);return}this.t=0,this.s=0;for(var j=_.length,et=!1,tt=0;--j>=0;){var rt=$==8?_[j]&255:intAt(_,j);if(rt<0){_.charAt(j)=="-"&&(et=!0);continue}et=!1,tt==0?this.data[this.t++]=rt:tt+$>this.DB?(this.data[this.t-1]|=(rt&(1<<this.DB-tt)-1)<<tt,this.data[this.t++]=rt>>this.DB-tt):this.data[this.t-1]|=rt<<tt,tt+=$,tt>=this.DB&&(tt-=this.DB)}$==8&&_[0]&128&&(this.s=-1,tt>0&&(this.data[this.t-1]|=(1<<this.DB-tt)-1<<tt)),this.clamp(),et&&BigInteger$2.ZERO.subTo(this,this)}function bnpClamp(){for(var _=this.s&this.DM;this.t>0&&this.data[this.t-1]==_;)--this.t}function bnToString(_){if(this.s<0)return"-"+this.negate().toString(_);var o;if(_==16)o=4;else if(_==8)o=3;else if(_==2)o=1;else if(_==32)o=5;else if(_==4)o=2;else return this.toRadix(_);var $=(1<<o)-1,j,et=!1,tt="",rt=this.t,nt=this.DB-rt*this.DB%o;if(rt-- >0)for(nt<this.DB&&(j=this.data[rt]>>nt)>0&&(et=!0,tt=int2char(j));rt>=0;)nt<o?(j=(this.data[rt]&(1<<nt)-1)<<o-nt,j|=this.data[--rt]>>(nt+=this.DB-o)):(j=this.data[rt]>>(nt-=o)&$,nt<=0&&(nt+=this.DB,--rt)),j>0&&(et=!0),et&&(tt+=int2char(j));return et?tt:"0"}function bnNegate(){var _=nbi();return BigInteger$2.ZERO.subTo(this,_),_}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(_){var o=this.s-_.s;if(o!=0)return o;var $=this.t;if(o=$-_.t,o!=0)return this.s<0?-o:o;for(;--$>=0;)if((o=this.data[$]-_.data[$])!=0)return o;return 0}function nbits(_){var o=1,$;return($=_>>>16)!=0&&(_=$,o+=16),($=_>>8)!=0&&(_=$,o+=8),($=_>>4)!=0&&(_=$,o+=4),($=_>>2)!=0&&(_=$,o+=2),($=_>>1)!=0&&(_=$,o+=1),o}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(_,o){var $;for($=this.t-1;$>=0;--$)o.data[$+_]=this.data[$];for($=_-1;$>=0;--$)o.data[$]=0;o.t=this.t+_,o.s=this.s}function bnpDRShiftTo(_,o){for(var $=_;$<this.t;++$)o.data[$-_]=this.data[$];o.t=Math.max(this.t-_,0),o.s=this.s}function bnpLShiftTo(_,o){var $=_%this.DB,j=this.DB-$,et=(1<<j)-1,tt=Math.floor(_/this.DB),rt=this.s<<$&this.DM,nt;for(nt=this.t-1;nt>=0;--nt)o.data[nt+tt+1]=this.data[nt]>>j|rt,rt=(this.data[nt]&et)<<$;for(nt=tt-1;nt>=0;--nt)o.data[nt]=0;o.data[tt]=rt,o.t=this.t+tt+1,o.s=this.s,o.clamp()}function bnpRShiftTo(_,o){o.s=this.s;var $=Math.floor(_/this.DB);if($>=this.t){o.t=0;return}var j=_%this.DB,et=this.DB-j,tt=(1<<j)-1;o.data[0]=this.data[$]>>j;for(var rt=$+1;rt<this.t;++rt)o.data[rt-$-1]|=(this.data[rt]&tt)<<et,o.data[rt-$]=this.data[rt]>>j;j>0&&(o.data[this.t-$-1]|=(this.s&tt)<<et),o.t=this.t-$,o.clamp()}function bnpSubTo(_,o){for(var $=0,j=0,et=Math.min(_.t,this.t);$<et;)j+=this.data[$]-_.data[$],o.data[$++]=j&this.DM,j>>=this.DB;if(_.t<this.t){for(j-=_.s;$<this.t;)j+=this.data[$],o.data[$++]=j&this.DM,j>>=this.DB;j+=this.s}else{for(j+=this.s;$<_.t;)j-=_.data[$],o.data[$++]=j&this.DM,j>>=this.DB;j-=_.s}o.s=j<0?-1:0,j<-1?o.data[$++]=this.DV+j:j>0&&(o.data[$++]=j),o.t=$,o.clamp()}function bnpMultiplyTo(_,o){var $=this.abs(),j=_.abs(),et=$.t;for(o.t=et+j.t;--et>=0;)o.data[et]=0;for(et=0;et<j.t;++et)o.data[et+$.t]=$.am(0,j.data[et],o,et,0,$.t);o.s=0,o.clamp(),this.s!=_.s&&BigInteger$2.ZERO.subTo(o,o)}function bnpSquareTo(_){for(var o=this.abs(),$=_.t=2*o.t;--$>=0;)_.data[$]=0;for($=0;$<o.t-1;++$){var j=o.am($,o.data[$],_,2*$,0,1);(_.data[$+o.t]+=o.am($+1,2*o.data[$],_,2*$+1,j,o.t-$-1))>=o.DV&&(_.data[$+o.t]-=o.DV,_.data[$+o.t+1]=1)}_.t>0&&(_.data[_.t-1]+=o.am($,o.data[$],_,2*$,0,1)),_.s=0,_.clamp()}function bnpDivRemTo(_,o,$){var j=_.abs();if(!(j.t<=0)){var et=this.abs();if(et.t<j.t){o!=null&&o.fromInt(0),$!=null&&this.copyTo($);return}$==null&&($=nbi());var tt=nbi(),rt=this.s,nt=_.s,it=this.DB-nbits(j.data[j.t-1]);it>0?(j.lShiftTo(it,tt),et.lShiftTo(it,$)):(j.copyTo(tt),et.copyTo($));var st=tt.t,ot=tt.data[st-1];if(ot!=0){var at=ot*(1<<this.F1)+(st>1?tt.data[st-2]>>this.F2:0),ct=this.FV/at,ut=(1<<this.F1)/at,ft=1<<this.F2,ht=$.t,mt=ht-st,gt=o??nbi();for(tt.dlShiftTo(mt,gt),$.compareTo(gt)>=0&&($.data[$.t++]=1,$.subTo(gt,$)),BigInteger$2.ONE.dlShiftTo(st,gt),gt.subTo(tt,tt);tt.t<st;)tt.data[tt.t++]=0;for(;--mt>=0;){var Et=$.data[--ht]==ot?this.DM:Math.floor($.data[ht]*ct+($.data[ht-1]+ft)*ut);if(($.data[ht]+=tt.am(0,Et,$,mt,0,st))<Et)for(tt.dlShiftTo(mt,gt),$.subTo(gt,$);$.data[ht]<--Et;)$.subTo(gt,$)}o!=null&&($.drShiftTo(st,o),rt!=nt&&BigInteger$2.ZERO.subTo(o,o)),$.t=st,$.clamp(),it>0&&$.rShiftTo(it,$),rt<0&&BigInteger$2.ZERO.subTo($,$)}}}function bnMod(_){var o=nbi();return this.abs().divRemTo(_,null,o),this.s<0&&o.compareTo(BigInteger$2.ZERO)>0&&_.subTo(o,o),o}function Classic(_){this.m=_}function cConvert(_){return _.s<0||_.compareTo(this.m)>=0?_.mod(this.m):_}function cRevert(_){return _}function cReduce(_){_.divRemTo(this.m,null,_)}function cMulTo(_,o,$){_.multiplyTo(o,$),this.reduce($)}function cSqrTo(_,o){_.squareTo(o),this.reduce(o)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var _=this.data[0];if(!(_&1))return 0;var o=_&3;return o=o*(2-(_&15)*o)&15,o=o*(2-(_&255)*o)&255,o=o*(2-((_&65535)*o&65535))&65535,o=o*(2-_*o%this.DV)%this.DV,o>0?this.DV-o:-o}function Montgomery(_){this.m=_,this.mp=_.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<_.DB-15)-1,this.mt2=2*_.t}function montConvert(_){var o=nbi();return _.abs().dlShiftTo(this.m.t,o),o.divRemTo(this.m,null,o),_.s<0&&o.compareTo(BigInteger$2.ZERO)>0&&this.m.subTo(o,o),o}function montRevert(_){var o=nbi();return _.copyTo(o),this.reduce(o),o}function montReduce(_){for(;_.t<=this.mt2;)_.data[_.t++]=0;for(var o=0;o<this.m.t;++o){var $=_.data[o]&32767,j=$*this.mpl+(($*this.mph+(_.data[o]>>15)*this.mpl&this.um)<<15)&_.DM;for($=o+this.m.t,_.data[$]+=this.m.am(0,j,_,o,0,this.m.t);_.data[$]>=_.DV;)_.data[$]-=_.DV,_.data[++$]++}_.clamp(),_.drShiftTo(this.m.t,_),_.compareTo(this.m)>=0&&_.subTo(this.m,_)}function montSqrTo(_,o){_.squareTo(o),this.reduce(o)}function montMulTo(_,o,$){_.multiplyTo(o,$),this.reduce($)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this.data[0]&1:this.s)==0}function bnpExp(_,o){if(_>4294967295||_<1)return BigInteger$2.ONE;var $=nbi(),j=nbi(),et=o.convert(this),tt=nbits(_)-1;for(et.copyTo($);--tt>=0;)if(o.sqrTo($,j),(_&1<<tt)>0)o.mulTo(j,et,$);else{var rt=$;$=j,j=rt}return o.revert($)}function bnModPowInt(_,o){var $;return _<256||o.isEven()?$=new Classic(o):$=new Montgomery(o),this.exp(_,$)}BigInteger$2.prototype.copyTo=bnpCopyTo;BigInteger$2.prototype.fromInt=bnpFromInt;BigInteger$2.prototype.fromString=bnpFromString;BigInteger$2.prototype.clamp=bnpClamp;BigInteger$2.prototype.dlShiftTo=bnpDLShiftTo;BigInteger$2.prototype.drShiftTo=bnpDRShiftTo;BigInteger$2.prototype.lShiftTo=bnpLShiftTo;BigInteger$2.prototype.rShiftTo=bnpRShiftTo;BigInteger$2.prototype.subTo=bnpSubTo;BigInteger$2.prototype.multiplyTo=bnpMultiplyTo;BigInteger$2.prototype.squareTo=bnpSquareTo;BigInteger$2.prototype.divRemTo=bnpDivRemTo;BigInteger$2.prototype.invDigit=bnpInvDigit;BigInteger$2.prototype.isEven=bnpIsEven;BigInteger$2.prototype.exp=bnpExp;BigInteger$2.prototype.toString=bnToString;BigInteger$2.prototype.negate=bnNegate;BigInteger$2.prototype.abs=bnAbs;BigInteger$2.prototype.compareTo=bnCompareTo;BigInteger$2.prototype.bitLength=bnBitLength;BigInteger$2.prototype.mod=bnMod;BigInteger$2.prototype.modPowInt=bnModPowInt;BigInteger$2.ZERO=nbv(0);BigInteger$2.ONE=nbv(1);function bnClone(){var _=nbi();return this.copyTo(_),_}function bnIntValue(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return this.t==0?this.s:this.data[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this.data[0]<<16>>16}function bnpChunkSize(_){return Math.floor(Math.LN2*this.DB/Math.log(_))}function bnSigNum(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function bnpToRadix(_){if(_==null&&(_=10),this.signum()==0||_<2||_>36)return"0";var o=this.chunkSize(_),$=Math.pow(_,o),j=nbv($),et=nbi(),tt=nbi(),rt="";for(this.divRemTo(j,et,tt);et.signum()>0;)rt=($+tt.intValue()).toString(_).substr(1)+rt,et.divRemTo(j,et,tt);return tt.intValue().toString(_)+rt}function bnpFromRadix(_,o){this.fromInt(0),o==null&&(o=10);for(var $=this.chunkSize(o),j=Math.pow(o,$),et=!1,tt=0,rt=0,nt=0;nt<_.length;++nt){var it=intAt(_,nt);if(it<0){_.charAt(nt)=="-"&&this.signum()==0&&(et=!0);continue}rt=o*rt+it,++tt>=$&&(this.dMultiply(j),this.dAddOffset(rt,0),tt=0,rt=0)}tt>0&&(this.dMultiply(Math.pow(o,tt)),this.dAddOffset(rt,0)),et&&BigInteger$2.ZERO.subTo(this,this)}function bnpFromNumber(_,o,$){if(typeof o=="number")if(_<2)this.fromInt(1);else for(this.fromNumber(_,$),this.testBit(_-1)||this.bitwiseTo(BigInteger$2.ONE.shiftLeft(_-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(o);)this.dAddOffset(2,0),this.bitLength()>_&&this.subTo(BigInteger$2.ONE.shiftLeft(_-1),this);else{var j=new Array,et=_&7;j.length=(_>>3)+1,o.nextBytes(j),et>0?j[0]&=(1<<et)-1:j[0]=0,this.fromString(j,256)}}function bnToByteArray(){var _=this.t,o=new Array;o[0]=this.s;var $=this.DB-_*this.DB%8,j,et=0;if(_-- >0)for($<this.DB&&(j=this.data[_]>>$)!=(this.s&this.DM)>>$&&(o[et++]=j|this.s<<this.DB-$);_>=0;)$<8?(j=(this.data[_]&(1<<$)-1)<<8-$,j|=this.data[--_]>>($+=this.DB-8)):(j=this.data[_]>>($-=8)&255,$<=0&&($+=this.DB,--_)),j&128&&(j|=-256),et==0&&(this.s&128)!=(j&128)&&++et,(et>0||j!=this.s)&&(o[et++]=j);return o}function bnEquals(_){return this.compareTo(_)==0}function bnMin(_){return this.compareTo(_)<0?this:_}function bnMax(_){return this.compareTo(_)>0?this:_}function bnpBitwiseTo(_,o,$){var j,et,tt=Math.min(_.t,this.t);for(j=0;j<tt;++j)$.data[j]=o(this.data[j],_.data[j]);if(_.t<this.t){for(et=_.s&this.DM,j=tt;j<this.t;++j)$.data[j]=o(this.data[j],et);$.t=this.t}else{for(et=this.s&this.DM,j=tt;j<_.t;++j)$.data[j]=o(et,_.data[j]);$.t=_.t}$.s=o(this.s,_.s),$.clamp()}function op_and(_,o){return _&o}function bnAnd(_){var o=nbi();return this.bitwiseTo(_,op_and,o),o}function op_or(_,o){return _|o}function bnOr(_){var o=nbi();return this.bitwiseTo(_,op_or,o),o}function op_xor(_,o){return _^o}function bnXor(_){var o=nbi();return this.bitwiseTo(_,op_xor,o),o}function op_andnot(_,o){return _&~o}function bnAndNot(_){var o=nbi();return this.bitwiseTo(_,op_andnot,o),o}function bnNot(){for(var _=nbi(),o=0;o<this.t;++o)_.data[o]=this.DM&~this.data[o];return _.t=this.t,_.s=~this.s,_}function bnShiftLeft(_){var o=nbi();return _<0?this.rShiftTo(-_,o):this.lShiftTo(_,o),o}function bnShiftRight(_){var o=nbi();return _<0?this.lShiftTo(-_,o):this.rShiftTo(_,o),o}function lbit(_){if(_==0)return-1;var o=0;return _&65535||(_>>=16,o+=16),_&255||(_>>=8,o+=8),_&15||(_>>=4,o+=4),_&3||(_>>=2,o+=2),_&1||++o,o}function bnGetLowestSetBit(){for(var _=0;_<this.t;++_)if(this.data[_]!=0)return _*this.DB+lbit(this.data[_]);return this.s<0?this.t*this.DB:-1}function cbit(_){for(var o=0;_!=0;)_&=_-1,++o;return o}function bnBitCount(){for(var _=0,o=this.s&this.DM,$=0;$<this.t;++$)_+=cbit(this.data[$]^o);return _}function bnTestBit(_){var o=Math.floor(_/this.DB);return o>=this.t?this.s!=0:(this.data[o]&1<<_%this.DB)!=0}function bnpChangeBit(_,o){var $=BigInteger$2.ONE.shiftLeft(_);return this.bitwiseTo($,o,$),$}function bnSetBit(_){return this.changeBit(_,op_or)}function bnClearBit(_){return this.changeBit(_,op_andnot)}function bnFlipBit(_){return this.changeBit(_,op_xor)}function bnpAddTo(_,o){for(var $=0,j=0,et=Math.min(_.t,this.t);$<et;)j+=this.data[$]+_.data[$],o.data[$++]=j&this.DM,j>>=this.DB;if(_.t<this.t){for(j+=_.s;$<this.t;)j+=this.data[$],o.data[$++]=j&this.DM,j>>=this.DB;j+=this.s}else{for(j+=this.s;$<_.t;)j+=_.data[$],o.data[$++]=j&this.DM,j>>=this.DB;j+=_.s}o.s=j<0?-1:0,j>0?o.data[$++]=j:j<-1&&(o.data[$++]=this.DV+j),o.t=$,o.clamp()}function bnAdd(_){var o=nbi();return this.addTo(_,o),o}function bnSubtract(_){var o=nbi();return this.subTo(_,o),o}function bnMultiply(_){var o=nbi();return this.multiplyTo(_,o),o}function bnDivide(_){var o=nbi();return this.divRemTo(_,o,null),o}function bnRemainder(_){var o=nbi();return this.divRemTo(_,null,o),o}function bnDivideAndRemainder(_){var o=nbi(),$=nbi();return this.divRemTo(_,o,$),new Array(o,$)}function bnpDMultiply(_){this.data[this.t]=this.am(0,_-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(_,o){if(_!=0){for(;this.t<=o;)this.data[this.t++]=0;for(this.data[o]+=_;this.data[o]>=this.DV;)this.data[o]-=this.DV,++o>=this.t&&(this.data[this.t++]=0),++this.data[o]}}function NullExp(){}function nNop(_){return _}function nMulTo(_,o,$){_.multiplyTo(o,$)}function nSqrTo(_,o){_.squareTo(o)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(_){return this.exp(_,new NullExp)}function bnpMultiplyLowerTo(_,o,$){var j=Math.min(this.t+_.t,o);for($.s=0,$.t=j;j>0;)$.data[--j]=0;var et;for(et=$.t-this.t;j<et;++j)$.data[j+this.t]=this.am(0,_.data[j],$,j,0,this.t);for(et=Math.min(_.t,o);j<et;++j)this.am(0,_.data[j],$,j,0,o-j);$.clamp()}function bnpMultiplyUpperTo(_,o,$){--o;var j=$.t=this.t+_.t-o;for($.s=0;--j>=0;)$.data[j]=0;for(j=Math.max(o-this.t,0);j<_.t;++j)$.data[this.t+j-o]=this.am(o-j,_.data[j],$,0,0,this.t+j-o);$.clamp(),$.drShiftTo(1,$)}function Barrett(_){this.r2=nbi(),this.q3=nbi(),BigInteger$2.ONE.dlShiftTo(2*_.t,this.r2),this.mu=this.r2.divide(_),this.m=_}function barrettConvert(_){if(_.s<0||_.t>2*this.m.t)return _.mod(this.m);if(_.compareTo(this.m)<0)return _;var o=nbi();return _.copyTo(o),this.reduce(o),o}function barrettRevert(_){return _}function barrettReduce(_){for(_.drShiftTo(this.m.t-1,this.r2),_.t>this.m.t+1&&(_.t=this.m.t+1,_.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);_.compareTo(this.r2)<0;)_.dAddOffset(1,this.m.t+1);for(_.subTo(this.r2,_);_.compareTo(this.m)>=0;)_.subTo(this.m,_)}function barrettSqrTo(_,o){_.squareTo(o),this.reduce(o)}function barrettMulTo(_,o,$){_.multiplyTo(o,$),this.reduce($)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(_,o){var $=_.bitLength(),j,et=nbv(1),tt;if($<=0)return et;$<18?j=1:$<48?j=3:$<144?j=4:$<768?j=5:j=6,$<8?tt=new Classic(o):o.isEven()?tt=new Barrett(o):tt=new Montgomery(o);var rt=new Array,nt=3,it=j-1,st=(1<<j)-1;if(rt[1]=tt.convert(this),j>1){var ot=nbi();for(tt.sqrTo(rt[1],ot);nt<=st;)rt[nt]=nbi(),tt.mulTo(ot,rt[nt-2],rt[nt]),nt+=2}var at=_.t-1,ct,ut=!0,ft=nbi(),ht;for($=nbits(_.data[at])-1;at>=0;){for($>=it?ct=_.data[at]>>$-it&st:(ct=(_.data[at]&(1<<$+1)-1)<<it-$,at>0&&(ct|=_.data[at-1]>>this.DB+$-it)),nt=j;!(ct&1);)ct>>=1,--nt;if(($-=nt)<0&&($+=this.DB,--at),ut)rt[ct].copyTo(et),ut=!1;else{for(;nt>1;)tt.sqrTo(et,ft),tt.sqrTo(ft,et),nt-=2;nt>0?tt.sqrTo(et,ft):(ht=et,et=ft,ft=ht),tt.mulTo(ft,rt[ct],et)}for(;at>=0&&!(_.data[at]&1<<$);)tt.sqrTo(et,ft),ht=et,et=ft,ft=ht,--$<0&&($=this.DB-1,--at)}return tt.revert(et)}function bnGCD(_){var o=this.s<0?this.negate():this.clone(),$=_.s<0?_.negate():_.clone();if(o.compareTo($)<0){var j=o;o=$,$=j}var et=o.getLowestSetBit(),tt=$.getLowestSetBit();if(tt<0)return o;for(et<tt&&(tt=et),tt>0&&(o.rShiftTo(tt,o),$.rShiftTo(tt,$));o.signum()>0;)(et=o.getLowestSetBit())>0&&o.rShiftTo(et,o),(et=$.getLowestSetBit())>0&&$.rShiftTo(et,$),o.compareTo($)>=0?(o.subTo($,o),o.rShiftTo(1,o)):($.subTo(o,$),$.rShiftTo(1,$));return tt>0&&$.lShiftTo(tt,$),$}function bnpModInt(_){if(_<=0)return 0;var o=this.DV%_,$=this.s<0?_-1:0;if(this.t>0)if(o==0)$=this.data[0]%_;else for(var j=this.t-1;j>=0;--j)$=(o*$+this.data[j])%_;return $}function bnModInverse(_){var o=_.isEven();if(this.isEven()&&o||_.signum()==0)return BigInteger$2.ZERO;for(var $=_.clone(),j=this.clone(),et=nbv(1),tt=nbv(0),rt=nbv(0),nt=nbv(1);$.signum()!=0;){for(;$.isEven();)$.rShiftTo(1,$),o?((!et.isEven()||!tt.isEven())&&(et.addTo(this,et),tt.subTo(_,tt)),et.rShiftTo(1,et)):tt.isEven()||tt.subTo(_,tt),tt.rShiftTo(1,tt);for(;j.isEven();)j.rShiftTo(1,j),o?((!rt.isEven()||!nt.isEven())&&(rt.addTo(this,rt),nt.subTo(_,nt)),rt.rShiftTo(1,rt)):nt.isEven()||nt.subTo(_,nt),nt.rShiftTo(1,nt);$.compareTo(j)>=0?($.subTo(j,$),o&&et.subTo(rt,et),tt.subTo(nt,tt)):(j.subTo($,j),o&&rt.subTo(et,rt),nt.subTo(tt,nt))}if(j.compareTo(BigInteger$2.ONE)!=0)return BigInteger$2.ZERO;if(nt.compareTo(_)>=0)return nt.subtract(_);if(nt.signum()<0)nt.addTo(_,nt);else return nt;return nt.signum()<0?nt.add(_):nt}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(_){var o,$=this.abs();if($.t==1&&$.data[0]<=lowprimes[lowprimes.length-1]){for(o=0;o<lowprimes.length;++o)if($.data[0]==lowprimes[o])return!0;return!1}if($.isEven())return!1;for(o=1;o<lowprimes.length;){for(var j=lowprimes[o],et=o+1;et<lowprimes.length&&j<lplim;)j*=lowprimes[et++];for(j=$.modInt(j);o<et;)if(j%lowprimes[o++]==0)return!1}return $.millerRabin(_)}function bnpMillerRabin(_){var o=this.subtract(BigInteger$2.ONE),$=o.getLowestSetBit();if($<=0)return!1;for(var j=o.shiftRight($),et=bnGetPrng(),tt,rt=0;rt<_;++rt){do tt=new BigInteger$2(this.bitLength(),et);while(tt.compareTo(BigInteger$2.ONE)<=0||tt.compareTo(o)>=0);var nt=tt.modPow(j,this);if(nt.compareTo(BigInteger$2.ONE)!=0&&nt.compareTo(o)!=0){for(var it=1;it++<$&&nt.compareTo(o)!=0;)if(nt=nt.modPowInt(2,this),nt.compareTo(BigInteger$2.ONE)==0)return!1;if(nt.compareTo(o)!=0)return!1}}return!0}function bnGetPrng(){return{nextBytes:function(_){for(var o=0;o<_.length;++o)_[o]=Math.floor(Math.random()*256)}}}BigInteger$2.prototype.chunkSize=bnpChunkSize;BigInteger$2.prototype.toRadix=bnpToRadix;BigInteger$2.prototype.fromRadix=bnpFromRadix;BigInteger$2.prototype.fromNumber=bnpFromNumber;BigInteger$2.prototype.bitwiseTo=bnpBitwiseTo;BigInteger$2.prototype.changeBit=bnpChangeBit;BigInteger$2.prototype.addTo=bnpAddTo;BigInteger$2.prototype.dMultiply=bnpDMultiply;BigInteger$2.prototype.dAddOffset=bnpDAddOffset;BigInteger$2.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger$2.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger$2.prototype.modInt=bnpModInt;BigInteger$2.prototype.millerRabin=bnpMillerRabin;BigInteger$2.prototype.clone=bnClone;BigInteger$2.prototype.intValue=bnIntValue;BigInteger$2.prototype.byteValue=bnByteValue;BigInteger$2.prototype.shortValue=bnShortValue;BigInteger$2.prototype.signum=bnSigNum;BigInteger$2.prototype.toByteArray=bnToByteArray;BigInteger$2.prototype.equals=bnEquals;BigInteger$2.prototype.min=bnMin;BigInteger$2.prototype.max=bnMax;BigInteger$2.prototype.and=bnAnd;BigInteger$2.prototype.or=bnOr;BigInteger$2.prototype.xor=bnXor;BigInteger$2.prototype.andNot=bnAndNot;BigInteger$2.prototype.not=bnNot;BigInteger$2.prototype.shiftLeft=bnShiftLeft;BigInteger$2.prototype.shiftRight=bnShiftRight;BigInteger$2.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger$2.prototype.bitCount=bnBitCount;BigInteger$2.prototype.testBit=bnTestBit;BigInteger$2.prototype.setBit=bnSetBit;BigInteger$2.prototype.clearBit=bnClearBit;BigInteger$2.prototype.flipBit=bnFlipBit;BigInteger$2.prototype.add=bnAdd;BigInteger$2.prototype.subtract=bnSubtract;BigInteger$2.prototype.multiply=bnMultiply;BigInteger$2.prototype.divide=bnDivide;BigInteger$2.prototype.remainder=bnRemainder;BigInteger$2.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger$2.prototype.modPow=bnModPow;BigInteger$2.prototype.modInverse=bnModInverse;BigInteger$2.prototype.pow=bnPow;BigInteger$2.prototype.gcd=bnGCD;BigInteger$2.prototype.isProbablePrime=bnIsProbablePrime;var forge$b=forge$s,sha1=forge$b.sha1=forge$b.sha1||{};forge$b.md.sha1=forge$b.md.algorithms.sha1=sha1;sha1.create=function(){_initialized$1||_init$1();var _=null,o=forge$b.util.createBuffer(),$=new Array(80),j={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return j.start=function(){j.messageLength=0,j.fullMessageLength=j.messageLength64=[];for(var et=j.messageLengthSize/4,tt=0;tt<et;++tt)j.fullMessageLength.push(0);return o=forge$b.util.createBuffer(),_={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},j},j.start(),j.update=function(et,tt){tt==="utf8"&&(et=forge$b.util.encodeUtf8(et));var rt=et.length;j.messageLength+=rt,rt=[rt/4294967296>>>0,rt>>>0];for(var nt=j.fullMessageLength.length-1;nt>=0;--nt)j.fullMessageLength[nt]+=rt[1],rt[1]=rt[0]+(j.fullMessageLength[nt]/4294967296>>>0),j.fullMessageLength[nt]=j.fullMessageLength[nt]>>>0,rt[0]=rt[1]/4294967296>>>0;return o.putBytes(et),_update$1(_,$,o),(o.read>2048||o.length()===0)&&o.compact(),j},j.digest=function(){var et=forge$b.util.createBuffer();et.putBytes(o.bytes());var tt=j.fullMessageLength[j.fullMessageLength.length-1]+j.messageLengthSize,rt=tt&j.blockLength-1;et.putBytes(_padding$1.substr(0,j.blockLength-rt));for(var nt,it,st=j.fullMessageLength[0]*8,ot=0;ot<j.fullMessageLength.length-1;++ot)nt=j.fullMessageLength[ot+1]*8,it=nt/4294967296>>>0,st+=it,et.putInt32(st>>>0),st=nt>>>0;et.putInt32(st);var at={h0:_.h0,h1:_.h1,h2:_.h2,h3:_.h3,h4:_.h4};_update$1(at,$,et);var ct=forge$b.util.createBuffer();return ct.putInt32(at.h0),ct.putInt32(at.h1),ct.putInt32(at.h2),ct.putInt32(at.h3),ct.putInt32(at.h4),ct},j};var _padding$1=null,_initialized$1=!1;function _init$1(){_padding$1=String.fromCharCode(128),_padding$1+=forge$b.util.fillString(String.fromCharCode(0),64),_initialized$1=!0}function _update$1(_,o,$){for(var j,et,tt,rt,nt,it,st,ot,at=$.length();at>=64;){for(et=_.h0,tt=_.h1,rt=_.h2,nt=_.h3,it=_.h4,ot=0;ot<16;++ot)j=$.getInt32(),o[ot]=j,st=nt^tt&(rt^nt),j=(et<<5|et>>>27)+st+it+1518500249+j,it=nt,nt=rt,rt=(tt<<30|tt>>>2)>>>0,tt=et,et=j;for(;ot<20;++ot)j=o[ot-3]^o[ot-8]^o[ot-14]^o[ot-16],j=j<<1|j>>>31,o[ot]=j,st=nt^tt&(rt^nt),j=(et<<5|et>>>27)+st+it+1518500249+j,it=nt,nt=rt,rt=(tt<<30|tt>>>2)>>>0,tt=et,et=j;for(;ot<32;++ot)j=o[ot-3]^o[ot-8]^o[ot-14]^o[ot-16],j=j<<1|j>>>31,o[ot]=j,st=tt^rt^nt,j=(et<<5|et>>>27)+st+it+1859775393+j,it=nt,nt=rt,rt=(tt<<30|tt>>>2)>>>0,tt=et,et=j;for(;ot<40;++ot)j=o[ot-6]^o[ot-16]^o[ot-28]^o[ot-32],j=j<<2|j>>>30,o[ot]=j,st=tt^rt^nt,j=(et<<5|et>>>27)+st+it+1859775393+j,it=nt,nt=rt,rt=(tt<<30|tt>>>2)>>>0,tt=et,et=j;for(;ot<60;++ot)j=o[ot-6]^o[ot-16]^o[ot-28]^o[ot-32],j=j<<2|j>>>30,o[ot]=j,st=tt&rt|nt&(tt^rt),j=(et<<5|et>>>27)+st+it+2400959708+j,it=nt,nt=rt,rt=(tt<<30|tt>>>2)>>>0,tt=et,et=j;for(;ot<80;++ot)j=o[ot-6]^o[ot-16]^o[ot-28]^o[ot-32],j=j<<2|j>>>30,o[ot]=j,st=tt^rt^nt,j=(et<<5|et>>>27)+st+it+3395469782+j,it=nt,nt=rt,rt=(tt<<30|tt>>>2)>>>0,tt=et,et=j;_.h0=_.h0+et|0,_.h1=_.h1+tt|0,_.h2=_.h2+rt|0,_.h3=_.h3+nt|0,_.h4=_.h4+it|0,at-=64}}var forge$a=forge$s,pkcs1=forge$a.pkcs1=forge$a.pkcs1||{};pkcs1.encode_rsa_oaep=function(_,o,$){var j,et,tt,rt;typeof $=="string"?(j=$,et=arguments[3]||void 0,tt=arguments[4]||void 0):$&&(j=$.label||void 0,et=$.seed||void 0,tt=$.md||void 0,$.mgf1&&$.mgf1.md&&(rt=$.mgf1.md)),tt?tt.start():tt=forge$a.md.sha1.create(),rt||(rt=tt);var nt=Math.ceil(_.n.bitLength()/8),it=nt-2*tt.digestLength-2;if(o.length>it){var st=new Error("RSAES-OAEP input message length is too long.");throw st.length=o.length,st.maxLength=it,st}j||(j=""),tt.update(j,"raw");for(var ot=tt.digest(),at="",ct=it-o.length,ut=0;ut<ct;ut++)at+="\0";var ft=ot.getBytes()+at+""+o;if(!et)et=forge$a.random.getBytes(tt.digestLength);else if(et.length!==tt.digestLength){var st=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw st.seedLength=et.length,st.digestLength=tt.digestLength,st}var ht=rsa_mgf1(et,nt-tt.digestLength-1,rt),mt=forge$a.util.xorBytes(ft,ht,ft.length),gt=rsa_mgf1(mt,tt.digestLength,rt),Et=forge$a.util.xorBytes(et,gt,et.length);return"\0"+Et+mt};pkcs1.decode_rsa_oaep=function(_,o,$){var j,et,tt;typeof $=="string"?(j=$,et=arguments[3]||void 0):$&&(j=$.label||void 0,et=$.md||void 0,$.mgf1&&$.mgf1.md&&(tt=$.mgf1.md));var rt=Math.ceil(_.n.bitLength()/8);if(o.length!==rt){var mt=new Error("RSAES-OAEP encoded message length is invalid.");throw mt.length=o.length,mt.expectedLength=rt,mt}if(et===void 0?et=forge$a.md.sha1.create():et.start(),tt||(tt=et),rt<2*et.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");j||(j=""),et.update(j,"raw");for(var nt=et.digest().getBytes(),it=o.charAt(0),st=o.substring(1,et.digestLength+1),ot=o.substring(1+et.digestLength),at=rsa_mgf1(ot,et.digestLength,tt),ct=forge$a.util.xorBytes(st,at,st.length),ut=rsa_mgf1(ct,rt-et.digestLength-1,tt),ft=forge$a.util.xorBytes(ot,ut,ot.length),ht=ft.substring(0,et.digestLength),mt=it!=="\0",gt=0;gt<et.digestLength;++gt)mt|=nt.charAt(gt)!==ht.charAt(gt);for(var Et=1,St=et.digestLength,At=et.digestLength;At<ft.length;At++){var kt=ft.charCodeAt(At),Rt=kt&1^1,Tt=Et?65534:0;mt|=kt&Tt,Et=Et&Rt,St+=Et}if(mt||ft.charCodeAt(St)!==1)throw new Error("Invalid RSAES-OAEP padding.");return ft.substring(St+1)};function rsa_mgf1(_,o,$){$||($=forge$a.md.sha1.create());for(var j="",et=Math.ceil(o/$.digestLength),tt=0;tt<et;++tt){var rt=String.fromCharCode(tt>>24&255,tt>>16&255,tt>>8&255,tt&255);$.start(),$.update(_+rt),j+=$.digest().getBytes()}return j.substring(0,o)}var forge$9=forge$s;(function(){if(forge$9.prime)return;var _=forge$9.prime=forge$9.prime||{},o=forge$9.jsbn.BigInteger,$=[6,4,2,4,2,4,6,2],j=new o(null);j.fromInt(30);var et=function(at,ct){return at|ct};_.generateProbablePrime=function(at,ct,ut){typeof ct=="function"&&(ut=ct,ct={}),ct=ct||{};var ft=ct.algorithm||"PRIMEINC";typeof ft=="string"&&(ft={name:ft}),ft.options=ft.options||{};var ht=ct.prng||forge$9.random,mt={nextBytes:function(gt){for(var Et=ht.getBytesSync(gt.length),St=0;St<gt.length;++St)gt[St]=Et.charCodeAt(St)}};if(ft.name==="PRIMEINC")return tt(at,mt,ft.options,ut);throw new Error("Invalid prime generation algorithm: "+ft.name)};function tt(at,ct,ut,ft){return"workers"in ut?it(at,ct,ut,ft):rt(at,ct,ut,ft)}function rt(at,ct,ut,ft){var ht=st(at,ct),mt=0,gt=ot(ht.bitLength());"millerRabinTests"in ut&&(gt=ut.millerRabinTests);var Et=10;"maxBlockTime"in ut&&(Et=ut.maxBlockTime),nt(ht,at,ct,mt,gt,Et,ft)}function nt(at,ct,ut,ft,ht,mt,gt){var Et=+new Date;do{if(at.bitLength()>ct&&(at=st(ct,ut)),at.isProbablePrime(ht))return gt(null,at);at.dAddOffset($[ft++%8],0)}while(mt<0||+new Date-Et<mt);forge$9.util.setImmediate(function(){nt(at,ct,ut,ft,ht,mt,gt)})}function it(at,ct,ut,ft){if(typeof Worker>"u")return rt(at,ct,ut,ft);var ht=st(at,ct),mt=ut.workers,gt=ut.workLoad||100,Et=gt*30/8,St=ut.workerScript||"forge/prime.worker.js";if(mt===-1)return forge$9.util.estimateCores(function(kt,Rt){kt&&(Rt=2),mt=Rt-1,At()});At();function At(){mt=Math.max(1,mt);for(var kt=[],Rt=0;Rt<mt;++Rt)kt[Rt]=new Worker(St);for(var Rt=0;Rt<mt;++Rt)kt[Rt].addEventListener("message",Dt);var Tt=!1;function Dt(Ot){if(!Tt){var jt=Ot.data;if(jt.found){for(var Nt=0;Nt<kt.length;++Nt)kt[Nt].terminate();return Tt=!0,ft(null,new o(jt.prime,16))}ht.bitLength()>at&&(ht=st(at,ct));var It=ht.toString(16);Ot.target.postMessage({hex:It,workLoad:gt}),ht.dAddOffset(Et,0)}}}}function st(at,ct){var ut=new o(at,ct),ft=at-1;return ut.testBit(ft)||ut.bitwiseTo(o.ONE.shiftLeft(ft),et,ut),ut.dAddOffset(31-ut.mod(j).byteValue(),0),ut}function ot(at){return at<=100?27:at<=150?18:at<=200?15:at<=250?12:at<=300?9:at<=350?8:at<=400?7:at<=500?6:at<=600?5:at<=800?4:at<=1250?3:2}})();var forge$8=forge$s;if(typeof BigInteger$1>"u")var BigInteger$1=forge$8.jsbn.BigInteger;var _crypto=forge$8.util.isNodejs?requireCryptoBrowserify():null,asn1$4=forge$8.asn1,util$1=forge$8.util;forge$8.pki=forge$8.pki||{};forge$8.pki.rsa=forge$8.rsa=forge$8.rsa||{};var pki$3=forge$8.pki,GCD_30_DELTA=[6,4,2,4,2,4,6,2],privateKeyValidator={name:"PrivateKeyInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},rsaPrivateKeyValidator={name:"RSAPrivateKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},rsaPublicKeyValidator={name:"RSAPublicKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},publicKeyValidator$1=forge$8.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},digestInfoValidator={name:"DigestInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},emsaPkcs1v15encode=function(_){var o;if(_.algorithm in pki$3.oids)o=pki$3.oids[_.algorithm];else{var $=new Error("Unknown message digest algorithm.");throw $.algorithm=_.algorithm,$}var j=asn1$4.oidToDer(o).getBytes(),et=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[]),tt=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[]);tt.value.push(asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,j)),tt.value.push(asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.NULL,!1,""));var rt=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,_.digest().getBytes());return et.value.push(tt),et.value.push(rt),asn1$4.toDer(et).getBytes()},_modPow=function(_,o,$){if($)return _.modPow(o.e,o.n);if(!o.p||!o.q)return _.modPow(o.d,o.n);o.dP||(o.dP=o.d.mod(o.p.subtract(BigInteger$1.ONE))),o.dQ||(o.dQ=o.d.mod(o.q.subtract(BigInteger$1.ONE))),o.qInv||(o.qInv=o.q.modInverse(o.p));var j;do j=new BigInteger$1(forge$8.util.bytesToHex(forge$8.random.getBytes(o.n.bitLength()/8)),16);while(j.compareTo(o.n)>=0||!j.gcd(o.n).equals(BigInteger$1.ONE));_=_.multiply(j.modPow(o.e,o.n)).mod(o.n);for(var et=_.mod(o.p).modPow(o.dP,o.p),tt=_.mod(o.q).modPow(o.dQ,o.q);et.compareTo(tt)<0;)et=et.add(o.p);var rt=et.subtract(tt).multiply(o.qInv).mod(o.p).multiply(o.q).add(tt);return rt=rt.multiply(j.modInverse(o.n)).mod(o.n),rt};pki$3.rsa.encrypt=function(_,o,$){var j=$,et,tt=Math.ceil(o.n.bitLength()/8);$!==!1&&$!==!0?(j=$===2,et=_encodePkcs1_v1_5(_,o,$)):(et=forge$8.util.createBuffer(),et.putBytes(_));for(var rt=new BigInteger$1(et.toHex(),16),nt=_modPow(rt,o,j),it=nt.toString(16),st=forge$8.util.createBuffer(),ot=tt-Math.ceil(it.length/2);ot>0;)st.putByte(0),--ot;return st.putBytes(forge$8.util.hexToBytes(it)),st.getBytes()};pki$3.rsa.decrypt=function(_,o,$,j){var et=Math.ceil(o.n.bitLength()/8);if(_.length!==et){var tt=new Error("Encrypted message length is invalid.");throw tt.length=_.length,tt.expected=et,tt}var rt=new BigInteger$1(forge$8.util.createBuffer(_).toHex(),16);if(rt.compareTo(o.n)>=0)throw new Error("Encrypted message is invalid.");for(var nt=_modPow(rt,o,$),it=nt.toString(16),st=forge$8.util.createBuffer(),ot=et-Math.ceil(it.length/2);ot>0;)st.putByte(0),--ot;return st.putBytes(forge$8.util.hexToBytes(it)),j!==!1?_decodePkcs1_v1_5(st.getBytes(),o,$):st.getBytes()};pki$3.rsa.createKeyPairGenerationState=function(_,o,$){typeof _=="string"&&(_=parseInt(_,10)),_=_||2048,$=$||{};var j=$.prng||forge$8.random,et={nextBytes:function(nt){for(var it=j.getBytesSync(nt.length),st=0;st<nt.length;++st)nt[st]=it.charCodeAt(st)}},tt=$.algorithm||"PRIMEINC",rt;if(tt==="PRIMEINC")rt={algorithm:tt,state:0,bits:_,rng:et,eInt:o||65537,e:new BigInteger$1(null),p:null,q:null,qBits:_>>1,pBits:_-(_>>1),pqState:0,num:null,keys:null},rt.e.fromInt(rt.eInt);else throw new Error("Invalid key generation algorithm: "+tt);return rt};pki$3.rsa.stepKeyPairGenerationState=function(_,o){"algorithm"in _||(_.algorithm="PRIMEINC");var $=new BigInteger$1(null);$.fromInt(30);for(var j=0,et=function(at,ct){return at|ct},tt=+new Date,rt,nt=0;_.keys===null&&(o<=0||nt<o);){if(_.state===0){var it=_.p===null?_.pBits:_.qBits,st=it-1;_.pqState===0?(_.num=new BigInteger$1(it,_.rng),_.num.testBit(st)||_.num.bitwiseTo(BigInteger$1.ONE.shiftLeft(st),et,_.num),_.num.dAddOffset(31-_.num.mod($).byteValue(),0),j=0,++_.pqState):_.pqState===1?_.num.bitLength()>it?_.pqState=0:_.num.isProbablePrime(_getMillerRabinTests(_.num.bitLength()))?++_.pqState:_.num.dAddOffset(GCD_30_DELTA[j++%8],0):_.pqState===2?_.pqState=_.num.subtract(BigInteger$1.ONE).gcd(_.e).compareTo(BigInteger$1.ONE)===0?3:0:_.pqState===3&&(_.pqState=0,_.p===null?_.p=_.num:_.q=_.num,_.p!==null&&_.q!==null&&++_.state,_.num=null)}else if(_.state===1)_.p.compareTo(_.q)<0&&(_.num=_.p,_.p=_.q,_.q=_.num),++_.state;else if(_.state===2)_.p1=_.p.subtract(BigInteger$1.ONE),_.q1=_.q.subtract(BigInteger$1.ONE),_.phi=_.p1.multiply(_.q1),++_.state;else if(_.state===3)_.phi.gcd(_.e).compareTo(BigInteger$1.ONE)===0?++_.state:(_.p=null,_.q=null,_.state=0);else if(_.state===4)_.n=_.p.multiply(_.q),_.n.bitLength()===_.bits?++_.state:(_.q=null,_.state=0);else if(_.state===5){var ot=_.e.modInverse(_.phi);_.keys={privateKey:pki$3.rsa.setPrivateKey(_.n,_.e,ot,_.p,_.q,ot.mod(_.p1),ot.mod(_.q1),_.q.modInverse(_.p)),publicKey:pki$3.rsa.setPublicKey(_.n,_.e)}}rt=+new Date,nt+=rt-tt,tt=rt}return _.keys!==null};pki$3.rsa.generateKeyPair=function(_,o,$,j){if(arguments.length===1?typeof _=="object"?($=_,_=void 0):typeof _=="function"&&(j=_,_=void 0):arguments.length===2?typeof _=="number"?typeof o=="function"?(j=o,o=void 0):typeof o!="number"&&($=o,o=void 0):($=_,j=o,_=void 0,o=void 0):arguments.length===3&&(typeof o=="number"?typeof $=="function"&&(j=$,$=void 0):(j=$,$=o,o=void 0)),$=$||{},_===void 0&&(_=$.bits||2048),o===void 0&&(o=$.e||65537),!$.prng&&_>=256&&_<=16384&&(o===65537||o===3)){if(j){if(_detectNodeCrypto("generateKeyPair"))return _crypto.generateKeyPair("rsa",{modulusLength:_,publicExponent:o,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(nt,it,st){if(nt)return j(nt);j(null,{privateKey:pki$3.privateKeyFromPem(st),publicKey:pki$3.publicKeyFromPem(it)})});if(_detectSubtleCrypto("generateKey")&&_detectSubtleCrypto("exportKey"))return util$1.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:_,publicExponent:_intToUint8Array(o),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(nt){return util$1.globalScope.crypto.subtle.exportKey("pkcs8",nt.privateKey)}).then(void 0,function(nt){j(nt)}).then(function(nt){if(nt){var it=pki$3.privateKeyFromAsn1(asn1$4.fromDer(forge$8.util.createBuffer(nt)));j(null,{privateKey:it,publicKey:pki$3.setRsaPublicKey(it.n,it.e)})}});if(_detectSubtleMsCrypto("generateKey")&&_detectSubtleMsCrypto("exportKey")){var et=util$1.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:_,publicExponent:_intToUint8Array(o),hash:{name:"SHA-256"}},!0,["sign","verify"]);et.oncomplete=function(nt){var it=nt.target.result,st=util$1.globalScope.msCrypto.subtle.exportKey("pkcs8",it.privateKey);st.oncomplete=function(ot){var at=ot.target.result,ct=pki$3.privateKeyFromAsn1(asn1$4.fromDer(forge$8.util.createBuffer(at)));j(null,{privateKey:ct,publicKey:pki$3.setRsaPublicKey(ct.n,ct.e)})},st.onerror=function(ot){j(ot)}},et.onerror=function(nt){j(nt)};return}}else if(_detectNodeCrypto("generateKeyPairSync")){var tt=_crypto.generateKeyPairSync("rsa",{modulusLength:_,publicExponent:o,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pki$3.privateKeyFromPem(tt.privateKey),publicKey:pki$3.publicKeyFromPem(tt.publicKey)}}}var rt=pki$3.rsa.createKeyPairGenerationState(_,o,$);if(!j)return pki$3.rsa.stepKeyPairGenerationState(rt,0),rt.keys;_generateKeyPair(rt,$,j)};pki$3.setRsaPublicKey=pki$3.rsa.setPublicKey=function(_,o){var $={n:_,e:o};return $.encrypt=function(j,et,tt){if(typeof et=="string"?et=et.toUpperCase():et===void 0&&(et="RSAES-PKCS1-V1_5"),et==="RSAES-PKCS1-V1_5")et={encode:function(nt,it,st){return _encodePkcs1_v1_5(nt,it,2).getBytes()}};else if(et==="RSA-OAEP"||et==="RSAES-OAEP")et={encode:function(nt,it){return forge$8.pkcs1.encode_rsa_oaep(it,nt,tt)}};else if(["RAW","NONE","NULL",null].indexOf(et)!==-1)et={encode:function(nt){return nt}};else if(typeof et=="string")throw new Error('Unsupported encryption scheme: "'+et+'".');var rt=et.encode(j,$,!0);return pki$3.rsa.encrypt(rt,$,!0)},$.verify=function(j,et,tt,rt){typeof tt=="string"?tt=tt.toUpperCase():tt===void 0&&(tt="RSASSA-PKCS1-V1_5"),rt===void 0&&(rt={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in rt||(rt._parseAllDigestBytes=!0),tt==="RSASSA-PKCS1-V1_5"?tt={verify:function(it,st){st=_decodePkcs1_v1_5(st,$,!0);var ot=asn1$4.fromDer(st,{parseAllBytes:rt._parseAllDigestBytes}),at={},ct=[];if(!asn1$4.validate(ot,digestInfoValidator,at,ct)){var ut=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw ut.errors=ct,ut}var ft=asn1$4.derToOid(at.algorithmIdentifier);if(!(ft===forge$8.oids.md2||ft===forge$8.oids.md5||ft===forge$8.oids.sha1||ft===forge$8.oids.sha224||ft===forge$8.oids.sha256||ft===forge$8.oids.sha384||ft===forge$8.oids.sha512||ft===forge$8.oids["sha512-224"]||ft===forge$8.oids["sha512-256"])){var ut=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw ut.oid=ft,ut}if((ft===forge$8.oids.md2||ft===forge$8.oids.md5)&&!("parameters"in at))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return it===at.digest}}:(tt==="NONE"||tt==="NULL"||tt===null)&&(tt={verify:function(it,st){return st=_decodePkcs1_v1_5(st,$,!0),it===st}});var nt=pki$3.rsa.decrypt(et,$,!0,!1);return tt.verify(j,nt,$.n.bitLength())},$};pki$3.setRsaPrivateKey=pki$3.rsa.setPrivateKey=function(_,o,$,j,et,tt,rt,nt){var it={n:_,e:o,d:$,p:j,q:et,dP:tt,dQ:rt,qInv:nt};return it.decrypt=function(st,ot,at){typeof ot=="string"?ot=ot.toUpperCase():ot===void 0&&(ot="RSAES-PKCS1-V1_5");var ct=pki$3.rsa.decrypt(st,it,!1,!1);if(ot==="RSAES-PKCS1-V1_5")ot={decode:_decodePkcs1_v1_5};else if(ot==="RSA-OAEP"||ot==="RSAES-OAEP")ot={decode:function(ut,ft){return forge$8.pkcs1.decode_rsa_oaep(ft,ut,at)}};else if(["RAW","NONE","NULL",null].indexOf(ot)!==-1)ot={decode:function(ut){return ut}};else throw new Error('Unsupported encryption scheme: "'+ot+'".');return ot.decode(ct,it,!1)},it.sign=function(st,ot){var at=!1;typeof ot=="string"&&(ot=ot.toUpperCase()),ot===void 0||ot==="RSASSA-PKCS1-V1_5"?(ot={encode:emsaPkcs1v15encode},at=1):(ot==="NONE"||ot==="NULL"||ot===null)&&(ot={encode:function(){return st}},at=1);var ct=ot.encode(st,it.n.bitLength());return pki$3.rsa.encrypt(ct,it,at)},it};pki$3.wrapRsaPrivateKey=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,asn1$4.integerToDer(0).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(pki$3.oids.rsaEncryption).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.NULL,!1,"")]),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,asn1$4.toDer(_).getBytes())])};pki$3.privateKeyFromAsn1=function(_){var o={},$=[];if(asn1$4.validate(_,privateKeyValidator,o,$)&&(_=asn1$4.fromDer(forge$8.util.createBuffer(o.privateKey))),o={},$=[],!asn1$4.validate(_,rsaPrivateKeyValidator,o,$)){var j=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw j.errors=$,j}var et,tt,rt,nt,it,st,ot,at;return et=forge$8.util.createBuffer(o.privateKeyModulus).toHex(),tt=forge$8.util.createBuffer(o.privateKeyPublicExponent).toHex(),rt=forge$8.util.createBuffer(o.privateKeyPrivateExponent).toHex(),nt=forge$8.util.createBuffer(o.privateKeyPrime1).toHex(),it=forge$8.util.createBuffer(o.privateKeyPrime2).toHex(),st=forge$8.util.createBuffer(o.privateKeyExponent1).toHex(),ot=forge$8.util.createBuffer(o.privateKeyExponent2).toHex(),at=forge$8.util.createBuffer(o.privateKeyCoefficient).toHex(),pki$3.setRsaPrivateKey(new BigInteger$1(et,16),new BigInteger$1(tt,16),new BigInteger$1(rt,16),new BigInteger$1(nt,16),new BigInteger$1(it,16),new BigInteger$1(st,16),new BigInteger$1(ot,16),new BigInteger$1(at,16))};pki$3.privateKeyToAsn1=pki$3.privateKeyToRSAPrivateKey=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,asn1$4.integerToDer(0).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.n)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.e)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.d)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.p)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.q)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.dP)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.dQ)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.qInv))])};pki$3.publicKeyFromAsn1=function(_){var o={},$=[];if(asn1$4.validate(_,publicKeyValidator$1,o,$)){var j=asn1$4.derToOid(o.publicKeyOid);if(j!==pki$3.oids.rsaEncryption){var et=new Error("Cannot read public key. Unknown OID.");throw et.oid=j,et}_=o.rsaPublicKey}if($=[],!asn1$4.validate(_,rsaPublicKeyValidator,o,$)){var et=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw et.errors=$,et}var tt=forge$8.util.createBuffer(o.publicKeyModulus).toHex(),rt=forge$8.util.createBuffer(o.publicKeyExponent).toHex();return pki$3.setRsaPublicKey(new BigInteger$1(tt,16),new BigInteger$1(rt,16))};pki$3.publicKeyToAsn1=pki$3.publicKeyToSubjectPublicKeyInfo=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(pki$3.oids.rsaEncryption).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.NULL,!1,"")]),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.BITSTRING,!1,[pki$3.publicKeyToRSAPublicKey(_)])])};pki$3.publicKeyToRSAPublicKey=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.n)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.e))])};function _encodePkcs1_v1_5(_,o,$){var j=forge$8.util.createBuffer(),et=Math.ceil(o.n.bitLength()/8);if(_.length>et-11){var tt=new Error("Message is too long for PKCS#1 v1.5 padding.");throw tt.length=_.length,tt.max=et-11,tt}j.putByte(0),j.putByte($);var rt=et-3-_.length,nt;if($===0||$===1){nt=$===0?0:255;for(var it=0;it<rt;++it)j.putByte(nt)}else for(;rt>0;){for(var st=0,ot=forge$8.random.getBytes(rt),it=0;it<rt;++it)nt=ot.charCodeAt(it),nt===0?++st:j.putByte(nt);rt=st}return j.putByte(0),j.putBytes(_),j}function _decodePkcs1_v1_5(_,o,$,j){var et=Math.ceil(o.n.bitLength()/8),tt=forge$8.util.createBuffer(_),rt=tt.getByte(),nt=tt.getByte();if(rt!==0||$&&nt!==0&&nt!==1||!$&&nt!=2||$&&nt===0&&typeof j>"u")throw new Error("Encryption block is invalid.");var it=0;if(nt===0){it=et-3-j;for(var st=0;st<it;++st)if(tt.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(nt===1)for(it=0;tt.length()>1;){if(tt.getByte()!==255){--tt.read;break}++it}else if(nt===2)for(it=0;tt.length()>1;){if(tt.getByte()===0){--tt.read;break}++it}var ot=tt.getByte();if(ot!==0||it!==et-3-tt.length())throw new Error("Encryption block is invalid.");return tt.getBytes()}function _generateKeyPair(_,o,$){typeof o=="function"&&($=o,o={}),o=o||{};var j={algorithm:{name:o.algorithm||"PRIMEINC",options:{workers:o.workers||2,workLoad:o.workLoad||100,workerScript:o.workerScript}}};"prng"in o&&(j.prng=o.prng),et();function et(){tt(_.pBits,function(nt,it){if(nt)return $(nt);if(_.p=it,_.q!==null)return rt(nt,_.q);tt(_.qBits,rt)})}function tt(nt,it){forge$8.prime.generateProbablePrime(nt,j,it)}function rt(nt,it){if(nt)return $(nt);if(_.q=it,_.p.compareTo(_.q)<0){var st=_.p;_.p=_.q,_.q=st}if(_.p.subtract(BigInteger$1.ONE).gcd(_.e).compareTo(BigInteger$1.ONE)!==0){_.p=null,et();return}if(_.q.subtract(BigInteger$1.ONE).gcd(_.e).compareTo(BigInteger$1.ONE)!==0){_.q=null,tt(_.qBits,rt);return}if(_.p1=_.p.subtract(BigInteger$1.ONE),_.q1=_.q.subtract(BigInteger$1.ONE),_.phi=_.p1.multiply(_.q1),_.phi.gcd(_.e).compareTo(BigInteger$1.ONE)!==0){_.p=_.q=null,et();return}if(_.n=_.p.multiply(_.q),_.n.bitLength()!==_.bits){_.q=null,tt(_.qBits,rt);return}var ot=_.e.modInverse(_.phi);_.keys={privateKey:pki$3.rsa.setPrivateKey(_.n,_.e,ot,_.p,_.q,ot.mod(_.p1),ot.mod(_.q1),_.q.modInverse(_.p)),publicKey:pki$3.rsa.setPublicKey(_.n,_.e)},$(null,_.keys)}}function _bnToBytes(_){var o=_.toString(16);o[0]>="8"&&(o="00"+o);var $=forge$8.util.hexToBytes(o);return $.length>1&&($.charCodeAt(0)===0&&!($.charCodeAt(1)&128)||$.charCodeAt(0)===255&&($.charCodeAt(1)&128)===128)?$.substr(1):$}function _getMillerRabinTests(_){return _<=100?27:_<=150?18:_<=200?15:_<=250?12:_<=300?9:_<=350?8:_<=400?7:_<=500?6:_<=600?5:_<=800?4:_<=1250?3:2}function _detectNodeCrypto(_){return forge$8.util.isNodejs&&typeof _crypto[_]=="function"}function _detectSubtleCrypto(_){return typeof util$1.globalScope<"u"&&typeof util$1.globalScope.crypto=="object"&&typeof util$1.globalScope.crypto.subtle=="object"&&typeof util$1.globalScope.crypto.subtle[_]=="function"}function _detectSubtleMsCrypto(_){return typeof util$1.globalScope<"u"&&typeof util$1.globalScope.msCrypto=="object"&&typeof util$1.globalScope.msCrypto.subtle=="object"&&typeof util$1.globalScope.msCrypto.subtle[_]=="function"}function _intToUint8Array(_){for(var o=forge$8.util.hexToBytes(_.toString(16)),$=new Uint8Array(o.length),j=0;j<o.length;++j)$[j]=o.charCodeAt(j);return $}var forge$7=forge$s;if(typeof BigInteger>"u")var BigInteger=forge$7.jsbn.BigInteger;var asn1$3=forge$7.asn1,pki$2=forge$7.pki=forge$7.pki||{};pki$2.pbe=forge$7.pbe=forge$7.pbe||{};var oids$1=pki$2.oids,encryptedPrivateKeyValidator={name:"EncryptedPrivateKeyInfo",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},PBES2AlgorithmsValidator={name:"PBES2Algorithms",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},pkcs12PbeParamsValidator={name:"pkcs-12PbeParams",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.INTEGER,constructed:!1,capture:"iterations"}]};pki$2.encryptPrivateKeyInfo=function(_,o,$){$=$||{},$.saltSize=$.saltSize||8,$.count=$.count||2048,$.algorithm=$.algorithm||"aes128",$.prfAlgorithm=$.prfAlgorithm||"sha1";var j=forge$7.random.getBytesSync($.saltSize),et=$.count,tt=asn1$3.integerToDer(et),rt,nt,it;if($.algorithm.indexOf("aes")===0||$.algorithm==="des"){var st,ot,at;switch($.algorithm){case"aes128":rt=16,st=16,ot=oids$1["aes128-CBC"],at=forge$7.aes.createEncryptionCipher;break;case"aes192":rt=24,st=16,ot=oids$1["aes192-CBC"],at=forge$7.aes.createEncryptionCipher;break;case"aes256":rt=32,st=16,ot=oids$1["aes256-CBC"],at=forge$7.aes.createEncryptionCipher;break;case"des":rt=8,st=8,ot=oids$1.desCBC,at=forge$7.des.createEncryptionCipher;break;default:var ct=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw ct.algorithm=$.algorithm,ct}var ut="hmacWith"+$.prfAlgorithm.toUpperCase(),ft=prfAlgorithmToMessageDigest(ut),ht=forge$7.pkcs5.pbkdf2(o,j,et,rt,ft),mt=forge$7.random.getBytesSync(st),gt=at(ht);gt.start(mt),gt.update(asn1$3.toDer(_)),gt.finish(),it=gt.output.getBytes();var Et=createPbkdf2Params(j,tt,rt,ut);nt=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(oids$1.pkcs5PBES2).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(oids$1.pkcs5PBKDF2).getBytes()),Et]),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(ot).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,mt)])])])}else if($.algorithm==="3des"){rt=24;var St=new forge$7.util.ByteBuffer(j),ht=pki$2.pbe.generatePkcs12Key(o,St,1,et,rt),mt=pki$2.pbe.generatePkcs12Key(o,St,2,et,rt),gt=forge$7.des.createEncryptionCipher(ht);gt.start(mt),gt.update(asn1$3.toDer(_)),gt.finish(),it=gt.output.getBytes(),nt=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(oids$1["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,j),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.INTEGER,!1,tt.getBytes())])])}else{var ct=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw ct.algorithm=$.algorithm,ct}var At=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[nt,asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,it)]);return At};pki$2.decryptPrivateKeyInfo=function(_,o){var $=null,j={},et=[];if(!asn1$3.validate(_,encryptedPrivateKeyValidator,j,et)){var tt=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw tt.errors=et,tt}var rt=asn1$3.derToOid(j.encryptionOid),nt=pki$2.pbe.getCipher(rt,j.encryptionParams,o),it=forge$7.util.createBuffer(j.encryptedData);return nt.update(it),nt.finish()&&($=asn1$3.fromDer(nt.output)),$};pki$2.encryptedPrivateKeyToPem=function(_,o){var $={type:"ENCRYPTED PRIVATE KEY",body:asn1$3.toDer(_).getBytes()};return forge$7.pem.encode($,{maxline:o})};pki$2.encryptedPrivateKeyFromPem=function(_){var o=forge$7.pem.decode(_)[0];if(o.type!=="ENCRYPTED PRIVATE KEY"){var $=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw $.headerType=o.type,$}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return asn1$3.fromDer(o.body)};pki$2.encryptRsaPrivateKey=function(_,o,$){if($=$||{},!$.legacy){var j=pki$2.wrapRsaPrivateKey(pki$2.privateKeyToAsn1(_));return j=pki$2.encryptPrivateKeyInfo(j,o,$),pki$2.encryptedPrivateKeyToPem(j)}var et,tt,rt,nt;switch($.algorithm){case"aes128":et="AES-128-CBC",rt=16,tt=forge$7.random.getBytesSync(16),nt=forge$7.aes.createEncryptionCipher;break;case"aes192":et="AES-192-CBC",rt=24,tt=forge$7.random.getBytesSync(16),nt=forge$7.aes.createEncryptionCipher;break;case"aes256":et="AES-256-CBC",rt=32,tt=forge$7.random.getBytesSync(16),nt=forge$7.aes.createEncryptionCipher;break;case"3des":et="DES-EDE3-CBC",rt=24,tt=forge$7.random.getBytesSync(8),nt=forge$7.des.createEncryptionCipher;break;case"des":et="DES-CBC",rt=8,tt=forge$7.random.getBytesSync(8),nt=forge$7.des.createEncryptionCipher;break;default:var it=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+$.algorithm+'".');throw it.algorithm=$.algorithm,it}var st=forge$7.pbe.opensslDeriveBytes(o,tt.substr(0,8),rt),ot=nt(st);ot.start(tt),ot.update(asn1$3.toDer(pki$2.privateKeyToAsn1(_))),ot.finish();var at={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:et,parameters:forge$7.util.bytesToHex(tt).toUpperCase()},body:ot.output.getBytes()};return forge$7.pem.encode(at)};pki$2.decryptRsaPrivateKey=function(_,o){var $=null,j=forge$7.pem.decode(_)[0];if(j.type!=="ENCRYPTED PRIVATE KEY"&&j.type!=="PRIVATE KEY"&&j.type!=="RSA PRIVATE KEY"){var et=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw et.headerType=et,et}if(j.procType&&j.procType.type==="ENCRYPTED"){var tt,rt;switch(j.dekInfo.algorithm){case"DES-CBC":tt=8,rt=forge$7.des.createDecryptionCipher;break;case"DES-EDE3-CBC":tt=24,rt=forge$7.des.createDecryptionCipher;break;case"AES-128-CBC":tt=16,rt=forge$7.aes.createDecryptionCipher;break;case"AES-192-CBC":tt=24,rt=forge$7.aes.createDecryptionCipher;break;case"AES-256-CBC":tt=32,rt=forge$7.aes.createDecryptionCipher;break;case"RC2-40-CBC":tt=5,rt=function(at){return forge$7.rc2.createDecryptionCipher(at,40)};break;case"RC2-64-CBC":tt=8,rt=function(at){return forge$7.rc2.createDecryptionCipher(at,64)};break;case"RC2-128-CBC":tt=16,rt=function(at){return forge$7.rc2.createDecryptionCipher(at,128)};break;default:var et=new Error('Could not decrypt private key; unsupported encryption algorithm "'+j.dekInfo.algorithm+'".');throw et.algorithm=j.dekInfo.algorithm,et}var nt=forge$7.util.hexToBytes(j.dekInfo.parameters),it=forge$7.pbe.opensslDeriveBytes(o,nt.substr(0,8),tt),st=rt(it);if(st.start(nt),st.update(forge$7.util.createBuffer(j.body)),st.finish())$=st.output.getBytes();else return $}else $=j.body;return j.type==="ENCRYPTED PRIVATE KEY"?$=pki$2.decryptPrivateKeyInfo(asn1$3.fromDer($),o):$=asn1$3.fromDer($),$!==null&&($=pki$2.privateKeyFromAsn1($)),$};pki$2.pbe.generatePkcs12Key=function(_,o,$,j,et,tt){var rt,nt;if(typeof tt>"u"||tt===null){if(!("sha1"in forge$7.md))throw new Error('"sha1" hash algorithm unavailable.');tt=forge$7.md.sha1.create()}var it=tt.digestLength,st=tt.blockLength,ot=new forge$7.util.ByteBuffer,at=new forge$7.util.ByteBuffer;if(_!=null){for(nt=0;nt<_.length;nt++)at.putInt16(_.charCodeAt(nt));at.putInt16(0)}var ct=at.length(),ut=o.length(),ft=new forge$7.util.ByteBuffer;ft.fillWithByte($,st);var ht=st*Math.ceil(ut/st),mt=new forge$7.util.ByteBuffer;for(nt=0;nt<ht;nt++)mt.putByte(o.at(nt%ut));var gt=st*Math.ceil(ct/st),Et=new forge$7.util.ByteBuffer;for(nt=0;nt<gt;nt++)Et.putByte(at.at(nt%ct));var St=mt;St.putBuffer(Et);for(var At=Math.ceil(et/it),kt=1;kt<=At;kt++){var Rt=new forge$7.util.ByteBuffer;Rt.putBytes(ft.bytes()),Rt.putBytes(St.bytes());for(var Tt=0;Tt<j;Tt++)tt.start(),tt.update(Rt.getBytes()),Rt=tt.digest();var Dt=new forge$7.util.ByteBuffer;for(nt=0;nt<st;nt++)Dt.putByte(Rt.at(nt%it));var Ot=Math.ceil(ut/st)+Math.ceil(ct/st),jt=new forge$7.util.ByteBuffer;for(rt=0;rt<Ot;rt++){var Nt=new forge$7.util.ByteBuffer(St.getBytes(st)),It=511;for(nt=Dt.length()-1;nt>=0;nt--)It=It>>8,It+=Dt.at(nt)+Nt.at(nt),Nt.setAt(nt,It&255);jt.putBuffer(Nt)}St=jt,ot.putBuffer(Rt)}return ot.truncate(ot.length()-et),ot};pki$2.pbe.getCipher=function(_,o,$){switch(_){case pki$2.oids.pkcs5PBES2:return pki$2.pbe.getCipherForPBES2(_,o,$);case pki$2.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case pki$2.oids["pbewithSHAAnd40BitRC2-CBC"]:return pki$2.pbe.getCipherForPKCS12PBE(_,o,$);default:var j=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw j.oid=_,j.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],j}};pki$2.pbe.getCipherForPBES2=function(_,o,$){var j={},et=[];if(!asn1$3.validate(o,PBES2AlgorithmsValidator,j,et)){var tt=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw tt.errors=et,tt}if(_=asn1$3.derToOid(j.kdfOid),_!==pki$2.oids.pkcs5PBKDF2){var tt=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw tt.oid=_,tt.supportedOids=["pkcs5PBKDF2"],tt}if(_=asn1$3.derToOid(j.encOid),_!==pki$2.oids["aes128-CBC"]&&_!==pki$2.oids["aes192-CBC"]&&_!==pki$2.oids["aes256-CBC"]&&_!==pki$2.oids["des-EDE3-CBC"]&&_!==pki$2.oids.desCBC){var tt=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw tt.oid=_,tt.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],tt}var rt=j.kdfSalt,nt=forge$7.util.createBuffer(j.kdfIterationCount);nt=nt.getInt(nt.length()<<3);var it,st;switch(pki$2.oids[_]){case"aes128-CBC":it=16,st=forge$7.aes.createDecryptionCipher;break;case"aes192-CBC":it=24,st=forge$7.aes.createDecryptionCipher;break;case"aes256-CBC":it=32,st=forge$7.aes.createDecryptionCipher;break;case"des-EDE3-CBC":it=24,st=forge$7.des.createDecryptionCipher;break;case"desCBC":it=8,st=forge$7.des.createDecryptionCipher;break}var ot=prfOidToMessageDigest(j.prfOid),at=forge$7.pkcs5.pbkdf2($,rt,nt,it,ot),ct=j.encIv,ut=st(at);return ut.start(ct),ut};pki$2.pbe.getCipherForPKCS12PBE=function(_,o,$){var j={},et=[];if(!asn1$3.validate(o,pkcs12PbeParamsValidator,j,et)){var tt=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw tt.errors=et,tt}var rt=forge$7.util.createBuffer(j.salt),nt=forge$7.util.createBuffer(j.iterations);nt=nt.getInt(nt.length()<<3);var it,st,ot;switch(_){case pki$2.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:it=24,st=8,ot=forge$7.des.startDecrypting;break;case pki$2.oids["pbewithSHAAnd40BitRC2-CBC"]:it=5,st=8,ot=function(ht,mt){var gt=forge$7.rc2.createDecryptionCipher(ht,40);return gt.start(mt,null),gt};break;default:var tt=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw tt.oid=_,tt}var at=prfOidToMessageDigest(j.prfOid),ct=pki$2.pbe.generatePkcs12Key($,rt,1,nt,it,at);at.start();var ut=pki$2.pbe.generatePkcs12Key($,rt,2,nt,st,at);return ot(ct,ut)};pki$2.pbe.opensslDeriveBytes=function(_,o,$,j){if(typeof j>"u"||j===null){if(!("md5"in forge$7.md))throw new Error('"md5" hash algorithm unavailable.');j=forge$7.md.md5.create()}o===null&&(o="");for(var et=[hash$2(j,_+o)],tt=16,rt=1;tt<$;++rt,tt+=16)et.push(hash$2(j,et[rt-1]+_+o));return et.join("").substr(0,$)};function hash$2(_,o){return _.start().update(o).digest().getBytes()}function prfOidToMessageDigest(_){var o;if(!_)o="hmacWithSHA1";else if(o=pki$2.oids[asn1$3.derToOid(_)],!o){var $=new Error("Unsupported PRF OID.");throw $.oid=_,$.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],$}return prfAlgorithmToMessageDigest(o)}function prfAlgorithmToMessageDigest(_){var o=forge$7.md;switch(_){case"hmacWithSHA224":o=forge$7.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":_=_.substr(8).toLowerCase();break;default:var $=new Error("Unsupported PRF algorithm.");throw $.algorithm=_,$.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],$}if(!o||!(_ in o))throw new Error("Unknown hash algorithm: "+_);return o[_].create()}function createPbkdf2Params(_,o,$,j){var et=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,_),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.INTEGER,!1,o.getBytes())]);return j!=="hmacWithSHA1"&&et.value.push(asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.INTEGER,!1,forge$7.util.hexToBytes($.toString(16))),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(pki$2.oids[j]).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.NULL,!1,"")])),et}function concat$2(_,o){o==null&&(o=_.reduce((et,tt)=>et+tt.length,0));const $=allocUnsafe$5(o);let j=0;for(const et of _)$.set(et,j),j+=et.length;return asUint8Array$2($)}function bigIntegerToUintBase64url(_,o){let $=Uint8Array.from(_.abs().toByteArray());if($=$[0]===0?$.subarray(1):$,o!=null){if($.length>o)throw new Error("byte array longer than desired length");$=concat$2([new Uint8Array(o-$.length),$])}return toString$a($,"base64url")}function base64urlToBigInteger(_){const o=base64urlToBuffer(_);return new forge$s.jsbn.BigInteger(toString$a(o,"base16"),16)}function base64urlToBuffer(_,o){let $=fromString$8(_,"base64urlpad");if(o!=null){if($.length>o)throw new Error("byte array longer than desired length");$=concat$2([new Uint8Array(o-$.length),$])}return $}function equals$6(_,o){if(_===o)return!0;if(_.byteLength!==o.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==o[$])return!1;return!0}const bits={"P-256":256,"P-384":384,"P-521":521},curveTypes=Object.keys(bits);curveTypes.join(" / ");function create$9(_){const o=(_==null?void 0:_.algorithm)??"AES-GCM";let $=(_==null?void 0:_.keyLength)??16;const j=(_==null?void 0:_.nonceLength)??12,et=(_==null?void 0:_.digest)??"SHA-256",tt=(_==null?void 0:_.saltLength)??16,rt=(_==null?void 0:_.iterations)??32767,nt=webcrypto.get();$*=8;async function it(at,ct){const ut=nt.getRandomValues(new Uint8Array(tt)),ft=nt.getRandomValues(new Uint8Array(j)),ht={name:o,iv:ft};typeof ct=="string"&&(ct=fromString$8(ct));const mt={name:"PBKDF2",salt:ut,iterations:rt,hash:{name:et}},gt=await nt.subtle.importKey("raw",ct,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),Et=await nt.subtle.deriveKey(mt,gt,{name:o,length:$},!0,["encrypt"]),St=await nt.subtle.encrypt(ht,Et,at);return concat$2([ut,ht.iv,new Uint8Array(St)])}async function st(at,ct){const ut=at.subarray(0,tt),ft=at.subarray(tt,tt+j),ht=at.subarray(tt+j),mt={name:o,iv:ft};typeof ct=="string"&&(ct=fromString$8(ct));const gt={name:"PBKDF2",salt:ut,iterations:rt,hash:{name:et}},Et=await nt.subtle.importKey("raw",ct,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),St=await nt.subtle.deriveKey(gt,Et,{name:o,length:$},!0,["decrypt"]),At=await nt.subtle.decrypt(mt,St,ht);return new Uint8Array(At)}return{encrypt:it,decrypt:st}}async function importer$1(_,o){const $=base64$6.decode(_);return await create$9().decrypt($,o)}var forge$6=forge$s,sha512$1=forge$6.sha512=forge$6.sha512||{};forge$6.md.sha512=forge$6.md.algorithms.sha512=sha512$1;var sha384=forge$6.sha384=forge$6.sha512.sha384=forge$6.sha512.sha384||{};sha384.create=function(){return sha512$1.create("SHA-384")};forge$6.md.sha384=forge$6.md.algorithms.sha384=sha384;forge$6.sha512.sha256=forge$6.sha512.sha256||{create:function(){return sha512$1.create("SHA-512/256")}};forge$6.md["sha512/256"]=forge$6.md.algorithms["sha512/256"]=forge$6.sha512.sha256;forge$6.sha512.sha224=forge$6.sha512.sha224||{create:function(){return sha512$1.create("SHA-512/224")}};forge$6.md["sha512/224"]=forge$6.md.algorithms["sha512/224"]=forge$6.sha512.sha224;sha512$1.create=function(_){if(_initialized||_init(),typeof _>"u"&&(_="SHA-512"),!(_ in _states))throw new Error("Invalid SHA-512 algorithm: "+_);for(var o=_states[_],$=null,j=forge$6.util.createBuffer(),et=new Array(80),tt=0;tt<80;++tt)et[tt]=new Array(2);var rt=64;switch(_){case"SHA-384":rt=48;break;case"SHA-512/256":rt=32;break;case"SHA-512/224":rt=28;break}var nt={algorithm:_.replace("-","").toLowerCase(),blockLength:128,digestLength:rt,messageLength:0,fullMessageLength:null,messageLengthSize:16};return nt.start=function(){nt.messageLength=0,nt.fullMessageLength=nt.messageLength128=[];for(var it=nt.messageLengthSize/4,st=0;st<it;++st)nt.fullMessageLength.push(0);j=forge$6.util.createBuffer(),$=new Array(o.length);for(var st=0;st<o.length;++st)$[st]=o[st].slice(0);return nt},nt.start(),nt.update=function(it,st){st==="utf8"&&(it=forge$6.util.encodeUtf8(it));var ot=it.length;nt.messageLength+=ot,ot=[ot/4294967296>>>0,ot>>>0];for(var at=nt.fullMessageLength.length-1;at>=0;--at)nt.fullMessageLength[at]+=ot[1],ot[1]=ot[0]+(nt.fullMessageLength[at]/4294967296>>>0),nt.fullMessageLength[at]=nt.fullMessageLength[at]>>>0,ot[0]=ot[1]/4294967296>>>0;return j.putBytes(it),_update($,et,j),(j.read>2048||j.length()===0)&&j.compact(),nt},nt.digest=function(){var it=forge$6.util.createBuffer();it.putBytes(j.bytes());var st=nt.fullMessageLength[nt.fullMessageLength.length-1]+nt.messageLengthSize,ot=st&nt.blockLength-1;it.putBytes(_padding.substr(0,nt.blockLength-ot));for(var at,ct,ut=nt.fullMessageLength[0]*8,ft=0;ft<nt.fullMessageLength.length-1;++ft)at=nt.fullMessageLength[ft+1]*8,ct=at/4294967296>>>0,ut+=ct,it.putInt32(ut>>>0),ut=at>>>0;it.putInt32(ut);for(var ht=new Array($.length),ft=0;ft<$.length;++ft)ht[ft]=$[ft].slice(0);_update(ht,et,it);var mt=forge$6.util.createBuffer(),gt;_==="SHA-512"?gt=ht.length:_==="SHA-384"?gt=ht.length-2:gt=ht.length-4;for(var ft=0;ft<gt;++ft)mt.putInt32(ht[ft][0]),(ft!==gt-1||_!=="SHA-512/224")&&mt.putInt32(ht[ft][1]);return mt},nt};var _padding=null,_initialized=!1,_k=null,_states=null;function _init(){_padding=String.fromCharCode(128),_padding+=forge$6.util.fillString(String.fromCharCode(0),128),_k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],_states={},_states["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],_states["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],_states["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],_states["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_initialized=!0}function _update(_,o,$){for(var j,et,tt,rt,nt,it,st,ot,at,ct,ut,ft,ht,mt,gt,Et,St,At,kt,Rt,Tt,Dt,Ot,jt,Nt,It,yt,lt,pt,bt,_t,$t,Ct,xt,vt,dt=$.length();dt>=128;){for(pt=0;pt<16;++pt)o[pt][0]=$.getInt32()>>>0,o[pt][1]=$.getInt32()>>>0;for(;pt<80;++pt)$t=o[pt-2],bt=$t[0],_t=$t[1],j=((bt>>>19|_t<<13)^(_t>>>29|bt<<3)^bt>>>6)>>>0,et=((bt<<13|_t>>>19)^(_t<<3|bt>>>29)^(bt<<26|_t>>>6))>>>0,xt=o[pt-15],bt=xt[0],_t=xt[1],tt=((bt>>>1|_t<<31)^(bt>>>8|_t<<24)^bt>>>7)>>>0,rt=((bt<<31|_t>>>1)^(bt<<24|_t>>>8)^(bt<<25|_t>>>7))>>>0,Ct=o[pt-7],vt=o[pt-16],_t=et+Ct[1]+rt+vt[1],o[pt][0]=j+Ct[0]+tt+vt[0]+(_t/4294967296>>>0)>>>0,o[pt][1]=_t>>>0;for(ht=_[0][0],mt=_[0][1],gt=_[1][0],Et=_[1][1],St=_[2][0],At=_[2][1],kt=_[3][0],Rt=_[3][1],Tt=_[4][0],Dt=_[4][1],Ot=_[5][0],jt=_[5][1],Nt=_[6][0],It=_[6][1],yt=_[7][0],lt=_[7][1],pt=0;pt<80;++pt)st=((Tt>>>14|Dt<<18)^(Tt>>>18|Dt<<14)^(Dt>>>9|Tt<<23))>>>0,ot=((Tt<<18|Dt>>>14)^(Tt<<14|Dt>>>18)^(Dt<<23|Tt>>>9))>>>0,at=(Nt^Tt&(Ot^Nt))>>>0,ct=(It^Dt&(jt^It))>>>0,nt=((ht>>>28|mt<<4)^(mt>>>2|ht<<30)^(mt>>>7|ht<<25))>>>0,it=((ht<<4|mt>>>28)^(mt<<30|ht>>>2)^(mt<<25|ht>>>7))>>>0,ut=(ht&gt|St&(ht^gt))>>>0,ft=(mt&Et|At&(mt^Et))>>>0,_t=lt+ot+ct+_k[pt][1]+o[pt][1],j=yt+st+at+_k[pt][0]+o[pt][0]+(_t/4294967296>>>0)>>>0,et=_t>>>0,_t=it+ft,tt=nt+ut+(_t/4294967296>>>0)>>>0,rt=_t>>>0,yt=Nt,lt=It,Nt=Ot,It=jt,Ot=Tt,jt=Dt,_t=Rt+et,Tt=kt+j+(_t/4294967296>>>0)>>>0,Dt=_t>>>0,kt=St,Rt=At,St=gt,At=Et,gt=ht,Et=mt,_t=et+rt,ht=j+tt+(_t/4294967296>>>0)>>>0,mt=_t>>>0;_t=_[0][1]+mt,_[0][0]=_[0][0]+ht+(_t/4294967296>>>0)>>>0,_[0][1]=_t>>>0,_t=_[1][1]+Et,_[1][0]=_[1][0]+gt+(_t/4294967296>>>0)>>>0,_[1][1]=_t>>>0,_t=_[2][1]+At,_[2][0]=_[2][0]+St+(_t/4294967296>>>0)>>>0,_[2][1]=_t>>>0,_t=_[3][1]+Rt,_[3][0]=_[3][0]+kt+(_t/4294967296>>>0)>>>0,_[3][1]=_t>>>0,_t=_[4][1]+Dt,_[4][0]=_[4][0]+Tt+(_t/4294967296>>>0)>>>0,_[4][1]=_t>>>0,_t=_[5][1]+jt,_[5][0]=_[5][0]+Ot+(_t/4294967296>>>0)>>>0,_[5][1]=_t>>>0,_t=_[6][1]+It,_[6][0]=_[6][0]+Nt+(_t/4294967296>>>0)>>>0,_[6][1]=_t>>>0,_t=_[7][1]+lt,_[7][0]=_[7][0]+yt+(_t/4294967296>>>0)>>>0,_[7][1]=_t>>>0,dt-=128}}var cryptoBrowserifyExports=requireCryptoBrowserify();const index=getDefaultExportFromCjs(cryptoBrowserifyExports),nodeCrypto=_mergeNamespaces({__proto__:null,default:index},[cryptoBrowserifyExports]);/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const _0n$1=BigInt(0),_1n$1=BigInt(1),_2n$1=BigInt(2),_3n=BigInt(3),_8n$1=BigInt(8),CURVE$1=Object.freeze({a:_0n$1,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:_1n$1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),divNearest=(_,o)=>(_+o/_2n$1)/o,endo={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(_){const{n:o}=CURVE$1,$=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),j=-_1n$1*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),et=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),tt=$,rt=BigInt("0x100000000000000000000000000000000"),nt=divNearest(tt*_,o),it=divNearest(-j*_,o);let st=mod$1(_-nt*$-it*et,o),ot=mod$1(-nt*j-it*tt,o);const at=st>rt,ct=ot>rt;if(at&&(st=o-st),ct&&(ot=o-ot),st>rt||ot>rt)throw new Error("splitScalarEndo: Endomorphism failed, k="+_);return{k1neg:at,k1:st,k2neg:ct,k2:ot}}},fieldLen=32,groupLen=32,hashLen=32,compressedLen=fieldLen+1,uncompressedLen=2*fieldLen+1;function weierstrass(_){const{a:o,b:$}=CURVE$1,j=mod$1(_*_),et=mod$1(j*_);return mod$1(et+o*_+$)}const USE_ENDOMORPHISM=CURVE$1.a===_0n$1;class ShaError extends Error{constructor(o){super(o)}}function assertJacPoint(_){if(!(_ instanceof JacobianPoint))throw new TypeError("JacobianPoint expected")}class JacobianPoint{constructor(o,$,j){this.x=o,this.y=$,this.z=j}static fromAffine(o){if(!(o instanceof Point$2))throw new TypeError("JacobianPoint#fromAffine: expected Point");return o.equals(Point$2.ZERO)?JacobianPoint.ZERO:new JacobianPoint(o.x,o.y,_1n$1)}static toAffineBatch(o){const $=invertBatch$1(o.map(j=>j.z));return o.map((j,et)=>j.toAffine($[et]))}static normalizeZ(o){return JacobianPoint.toAffineBatch(o).map(JacobianPoint.fromAffine)}equals(o){assertJacPoint(o);const{x:$,y:j,z:et}=this,{x:tt,y:rt,z:nt}=o,it=mod$1(et*et),st=mod$1(nt*nt),ot=mod$1($*st),at=mod$1(tt*it),ct=mod$1(mod$1(j*nt)*st),ut=mod$1(mod$1(rt*et)*it);return ot===at&&ct===ut}negate(){return new JacobianPoint(this.x,mod$1(-this.y),this.z)}double(){const{x:o,y:$,z:j}=this,et=mod$1(o*o),tt=mod$1($*$),rt=mod$1(tt*tt),nt=o+tt,it=mod$1(_2n$1*(mod$1(nt*nt)-et-rt)),st=mod$1(_3n*et),ot=mod$1(st*st),at=mod$1(ot-_2n$1*it),ct=mod$1(st*(it-at)-_8n$1*rt),ut=mod$1(_2n$1*$*j);return new JacobianPoint(at,ct,ut)}add(o){assertJacPoint(o);const{x:$,y:j,z:et}=this,{x:tt,y:rt,z:nt}=o;if(tt===_0n$1||rt===_0n$1)return this;if($===_0n$1||j===_0n$1)return o;const it=mod$1(et*et),st=mod$1(nt*nt),ot=mod$1($*st),at=mod$1(tt*it),ct=mod$1(mod$1(j*nt)*st),ut=mod$1(mod$1(rt*et)*it),ft=mod$1(at-ot),ht=mod$1(ut-ct);if(ft===_0n$1)return ht===_0n$1?this.double():JacobianPoint.ZERO;const mt=mod$1(ft*ft),gt=mod$1(ft*mt),Et=mod$1(ot*mt),St=mod$1(ht*ht-gt-_2n$1*Et),At=mod$1(ht*(Et-St)-ct*gt),kt=mod$1(et*nt*ft);return new JacobianPoint(St,At,kt)}subtract(o){return this.add(o.negate())}multiplyUnsafe(o){const $=JacobianPoint.ZERO;if(typeof o=="bigint"&&o===_0n$1)return $;let j=normalizeScalar$1(o);if(j===_1n$1)return this;if(!USE_ENDOMORPHISM){let at=$,ct=this;for(;j>_0n$1;)j&_1n$1&&(at=at.add(ct)),ct=ct.double(),j>>=_1n$1;return at}let{k1neg:et,k1:tt,k2neg:rt,k2:nt}=endo.splitScalar(j),it=$,st=$,ot=this;for(;tt>_0n$1||nt>_0n$1;)tt&_1n$1&&(it=it.add(ot)),nt&_1n$1&&(st=st.add(ot)),ot=ot.double(),tt>>=_1n$1,nt>>=_1n$1;return et&&(it=it.negate()),rt&&(st=st.negate()),st=new JacobianPoint(mod$1(st.x*endo.beta),st.y,st.z),it.add(st)}precomputeWindow(o){const $=USE_ENDOMORPHISM?128/o+1:256/o+1,j=[];let et=this,tt=et;for(let rt=0;rt<$;rt++){tt=et,j.push(tt);for(let nt=1;nt<2**(o-1);nt++)tt=tt.add(et),j.push(tt);et=tt.double()}return j}wNAF(o,$){!$&&this.equals(JacobianPoint.BASE)&&($=Point$2.BASE);const j=$&&$._WINDOW_SIZE||1;if(256%j)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let et=$&&pointPrecomputes$1.get($);et||(et=this.precomputeWindow(j),$&&j!==1&&(et=JacobianPoint.normalizeZ(et),pointPrecomputes$1.set($,et)));let tt=JacobianPoint.ZERO,rt=JacobianPoint.BASE;const nt=1+(USE_ENDOMORPHISM?128/j:256/j),it=2**(j-1),st=BigInt(2**j-1),ot=2**j,at=BigInt(j);for(let ct=0;ct<nt;ct++){const ut=ct*it;let ft=Number(o&st);o>>=at,ft>it&&(ft-=ot,o+=_1n$1);const ht=ut,mt=ut+Math.abs(ft)-1,gt=ct%2!==0,Et=ft<0;ft===0?rt=rt.add(constTimeNegate$1(gt,et[ht])):tt=tt.add(constTimeNegate$1(Et,et[mt]))}return{p:tt,f:rt}}multiply(o,$){let j=normalizeScalar$1(o),et,tt;if(USE_ENDOMORPHISM){const{k1neg:rt,k1:nt,k2neg:it,k2:st}=endo.splitScalar(j);let{p:ot,f:at}=this.wNAF(nt,$),{p:ct,f:ut}=this.wNAF(st,$);ot=constTimeNegate$1(rt,ot),ct=constTimeNegate$1(it,ct),ct=new JacobianPoint(mod$1(ct.x*endo.beta),ct.y,ct.z),et=ot.add(ct),tt=at.add(ut)}else{const{p:rt,f:nt}=this.wNAF(j,$);et=rt,tt=nt}return JacobianPoint.normalizeZ([et,tt])[0]}toAffine(o){const{x:$,y:j,z:et}=this,tt=this.equals(JacobianPoint.ZERO);o==null&&(o=tt?_8n$1:invert$1(et));const rt=o,nt=mod$1(rt*rt),it=mod$1(nt*rt),st=mod$1($*nt),ot=mod$1(j*it),at=mod$1(et*rt);if(tt)return Point$2.ZERO;if(at!==_1n$1)throw new Error("invZ was invalid");return new Point$2(st,ot)}}JacobianPoint.BASE=new JacobianPoint(CURVE$1.Gx,CURVE$1.Gy,_1n$1);JacobianPoint.ZERO=new JacobianPoint(_0n$1,_1n$1,_0n$1);function constTimeNegate$1(_,o){const $=o.negate();return _?$:o}const pointPrecomputes$1=new WeakMap;let Point$2=class Wn{constructor(o,$){this.x=o,this.y=$}_setWindowSize(o){this._WINDOW_SIZE=o,pointPrecomputes$1.delete(this)}hasEvenY(){return this.y%_2n$1===_0n$1}static fromCompressedHex(o){const $=o.length===32,j=bytesToNumber($?o:o.subarray(1));if(!isValidFieldElement(j))throw new Error("Point is not on curve");const et=weierstrass(j);let tt=sqrtMod(et);const rt=(tt&_1n$1)===_1n$1;$?rt&&(tt=mod$1(-tt)):(o[0]&1)===1!==rt&&(tt=mod$1(-tt));const nt=new Wn(j,tt);return nt.assertValidity(),nt}static fromUncompressedHex(o){const $=bytesToNumber(o.subarray(1,fieldLen+1)),j=bytesToNumber(o.subarray(fieldLen+1,fieldLen*2+1)),et=new Wn($,j);return et.assertValidity(),et}static fromHex(o){const $=ensureBytes$1(o),j=$.length,et=$[0];if(j===fieldLen)return this.fromCompressedHex($);if(j===compressedLen&&(et===2||et===3))return this.fromCompressedHex($);if(j===uncompressedLen&&et===4)return this.fromUncompressedHex($);throw new Error(`Point.fromHex: received invalid point. Expected 32-${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes, not ${j}`)}static fromPrivateKey(o){return Wn.BASE.multiply(normalizePrivateKey(o))}static fromSignature(o,$,j){const{r:et,s:tt}=normalizeSignature($);if(![0,1,2,3].includes(j))throw new Error("Cannot recover: invalid recovery bit");const rt=truncateHash(ensureBytes$1(o)),{n:nt}=CURVE$1,it=j===2||j===3?et+nt:et,st=invert$1(it,nt),ot=mod$1(-rt*st,nt),at=mod$1(tt*st,nt),ct=j&1?"03":"02",ut=Wn.fromHex(ct+numTo32bStr(it)),ft=Wn.BASE.multiplyAndAddUnsafe(ut,ot,at);if(!ft)throw new Error("Cannot recover signature: point at infinify");return ft.assertValidity(),ft}toRawBytes(o=!1){return hexToBytes$2(this.toHex(o))}toHex(o=!1){const $=numTo32bStr(this.x);return o?`${this.hasEvenY()?"02":"03"}${$}`:`04${$}${numTo32bStr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const o="Point is not on elliptic curve",{x:$,y:j}=this;if(!isValidFieldElement($)||!isValidFieldElement(j))throw new Error(o);const et=mod$1(j*j),tt=weierstrass($);if(mod$1(et-tt)!==_0n$1)throw new Error(o)}equals(o){return this.x===o.x&&this.y===o.y}negate(){return new Wn(this.x,mod$1(-this.y))}double(){return JacobianPoint.fromAffine(this).double().toAffine()}add(o){return JacobianPoint.fromAffine(this).add(JacobianPoint.fromAffine(o)).toAffine()}subtract(o){return this.add(o.negate())}multiply(o){return JacobianPoint.fromAffine(this).multiply(o,this).toAffine()}multiplyAndAddUnsafe(o,$,j){const et=JacobianPoint.fromAffine(this),tt=$===_0n$1||$===_1n$1||this!==Wn.BASE?et.multiplyUnsafe($):et.multiply($),rt=JacobianPoint.fromAffine(o).multiplyUnsafe(j),nt=tt.add(rt);return nt.equals(JacobianPoint.ZERO)?void 0:nt.toAffine()}};Point$2.BASE=new Point$2(CURVE$1.Gx,CURVE$1.Gy);Point$2.ZERO=new Point$2(_0n$1,_0n$1);function sliceDER(_){return Number.parseInt(_[0],16)>=8?"00"+_:_}function parseDERInt(_){if(_.length<2||_[0]!==2)throw new Error(`Invalid signature integer tag: ${bytesToHex$2(_)}`);const o=_[1],$=_.subarray(2,o+2);if(!o||$.length!==o)throw new Error("Invalid signature integer: wrong length");if($[0]===0&&$[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:bytesToNumber($),left:_.subarray(o+2)}}function parseDERSignature(_){if(_.length<2||_[0]!=48)throw new Error(`Invalid signature tag: ${bytesToHex$2(_)}`);if(_[1]!==_.length-2)throw new Error("Invalid signature: incorrect length");const{data:o,left:$}=parseDERInt(_.subarray(2)),{data:j,left:et}=parseDERInt($);if(et.length)throw new Error(`Invalid signature: left bytes after parsing: ${bytesToHex$2(et)}`);return{r:o,s:j}}let Signature$2=class Ns{constructor(o,$){this.r=o,this.s=$,this.assertValidity()}static fromCompact(o){const $=o instanceof Uint8Array,j="Signature.fromCompact";if(typeof o!="string"&&!$)throw new TypeError(`${j}: Expected string or Uint8Array`);const et=$?bytesToHex$2(o):o;if(et.length!==128)throw new Error(`${j}: Expected 64-byte hex`);return new Ns(hexToNumber(et.slice(0,64)),hexToNumber(et.slice(64,128)))}static fromDER(o){const $=o instanceof Uint8Array;if(typeof o!="string"&&!$)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:j,s:et}=parseDERSignature($?o:hexToBytes$2(o));return new Ns(j,et)}static fromHex(o){return this.fromDER(o)}assertValidity(){const{r:o,s:$}=this;if(!isWithinCurveOrder(o))throw new Error("Invalid Signature: r must be 0 < r < n");if(!isWithinCurveOrder($))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const o=CURVE$1.n>>_1n$1;return this.s>o}normalizeS(){return this.hasHighS()?new Ns(this.r,mod$1(-this.s,CURVE$1.n)):this}toDERRawBytes(){return hexToBytes$2(this.toDERHex())}toDERHex(){const o=sliceDER(numberToHexUnpadded(this.s)),$=sliceDER(numberToHexUnpadded(this.r)),j=o.length/2,et=$.length/2,tt=numberToHexUnpadded(j),rt=numberToHexUnpadded(et);return`30${numberToHexUnpadded(et+j+4)}02${rt}${$}02${tt}${o}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return hexToBytes$2(this.toCompactHex())}toCompactHex(){return numTo32bStr(this.r)+numTo32bStr(this.s)}};function concatBytes$1(..._){if(!_.every(j=>j instanceof Uint8Array))throw new Error("Uint8Array list expected");if(_.length===1)return _[0];const o=_.reduce((j,et)=>j+et.length,0),$=new Uint8Array(o);for(let j=0,et=0;j<_.length;j++){const tt=_[j];$.set(tt,et),et+=tt.length}return $}const hexes$1=Array.from({length:256},(_,o)=>o.toString(16).padStart(2,"0"));function bytesToHex$2(_){if(!(_ instanceof Uint8Array))throw new Error("Expected Uint8Array");let o="";for(let $=0;$<_.length;$++)o+=hexes$1[_[$]];return o}const POW_2_256$1=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function numTo32bStr(_){if(typeof _!="bigint")throw new Error("Expected bigint");if(!(_0n$1<=_&&_<POW_2_256$1))throw new Error("Expected number 0 <= n < 2^256");return _.toString(16).padStart(64,"0")}function numTo32b(_){const o=hexToBytes$2(numTo32bStr(_));if(o.length!==32)throw new Error("Error: expected 32 bytes");return o}function numberToHexUnpadded(_){const o=_.toString(16);return o.length&1?`0${o}`:o}function hexToNumber(_){if(typeof _!="string")throw new TypeError("hexToNumber: expected string, got "+typeof _);return BigInt(`0x${_}`)}function hexToBytes$2(_){if(typeof _!="string")throw new TypeError("hexToBytes: expected string, got "+typeof _);if(_.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+_.length);const o=new Uint8Array(_.length/2);for(let $=0;$<o.length;$++){const j=$*2,et=_.slice(j,j+2),tt=Number.parseInt(et,16);if(Number.isNaN(tt)||tt<0)throw new Error("Invalid byte sequence");o[$]=tt}return o}function bytesToNumber(_){return hexToNumber(bytesToHex$2(_))}function ensureBytes$1(_){return _ instanceof Uint8Array?Uint8Array.from(_):hexToBytes$2(_)}function normalizeScalar$1(_){if(typeof _=="number"&&Number.isSafeInteger(_)&&_>0)return BigInt(_);if(typeof _=="bigint"&&isWithinCurveOrder(_))return _;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function mod$1(_,o=CURVE$1.P){const $=_%o;return $>=_0n$1?$:o+$}function pow2$1(_,o){const{P:$}=CURVE$1;let j=_;for(;o-- >_0n$1;)j*=j,j%=$;return j}function sqrtMod(_){const{P:o}=CURVE$1,$=BigInt(6),j=BigInt(11),et=BigInt(22),tt=BigInt(23),rt=BigInt(44),nt=BigInt(88),it=_*_*_%o,st=it*it*_%o,ot=pow2$1(st,_3n)*st%o,at=pow2$1(ot,_3n)*st%o,ct=pow2$1(at,_2n$1)*it%o,ut=pow2$1(ct,j)*ct%o,ft=pow2$1(ut,et)*ut%o,ht=pow2$1(ft,rt)*ft%o,mt=pow2$1(ht,nt)*ht%o,gt=pow2$1(mt,rt)*ft%o,Et=pow2$1(gt,_3n)*st%o,St=pow2$1(Et,tt)*ut%o,At=pow2$1(St,$)*it%o,kt=pow2$1(At,_2n$1);if(kt*kt%o!==_)throw new Error("Cannot find square root");return kt}function invert$1(_,o=CURVE$1.P){if(_===_0n$1||o<=_0n$1)throw new Error(`invert: expected positive integers, got n=${_} mod=${o}`);let $=mod$1(_,o),j=o,et=_0n$1,tt=_1n$1;for(;$!==_0n$1;){const nt=j/$,it=j%$,st=et-tt*nt;j=$,$=it,et=tt,tt=st}if(j!==_1n$1)throw new Error("invert: does not exist");return mod$1(et,o)}function invertBatch$1(_,o=CURVE$1.P){const $=new Array(_.length),j=_.reduce((tt,rt,nt)=>rt===_0n$1?tt:($[nt]=tt,mod$1(tt*rt,o)),_1n$1),et=invert$1(j,o);return _.reduceRight((tt,rt,nt)=>rt===_0n$1?tt:($[nt]=mod$1(tt*$[nt],o),mod$1(tt*rt,o)),et),$}function bits2int_2(_){const o=_.length*8-groupLen*8,$=bytesToNumber(_);return o>0?$>>BigInt(o):$}function truncateHash(_,o=!1){const $=bits2int_2(_);if(o)return $;const{n:j}=CURVE$1;return $>=j?$-j:$}let _sha256Sync,_hmacSha256Sync;class HmacDrbg{constructor(o,$){if(this.hashLen=o,this.qByteLen=$,typeof o!="number"||o<2)throw new Error("hashLen must be a number");if(typeof $!="number"||$<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(o).fill(1),this.k=new Uint8Array(o).fill(0),this.counter=0}hmac(...o){return utils$1.hmacSha256(this.k,...o)}hmacSync(...o){return _hmacSha256Sync(this.k,...o)}checkSync(){if(typeof _hmacSha256Sync!="function")throw new ShaError("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(o=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),o),this.v=await this.hmac(this.v),o.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),o),this.v=await this.hmac(this.v))}reseedSync(o=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),o),this.v=this.hmacSync(this.v),o.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),o),this.v=this.hmacSync(this.v))}async generate(){this.incr();let o=0;const $=[];for(;o<this.qByteLen;){this.v=await this.hmac(this.v);const j=this.v.slice();$.push(j),o+=this.v.length}return concatBytes$1(...$)}generateSync(){this.checkSync(),this.incr();let o=0;const $=[];for(;o<this.qByteLen;){this.v=this.hmacSync(this.v);const j=this.v.slice();$.push(j),o+=this.v.length}return concatBytes$1(...$)}}function isWithinCurveOrder(_){return _0n$1<_&&_<CURVE$1.n}function isValidFieldElement(_){return _0n$1<_&&_<CURVE$1.P}function kmdToSig(_,o,$,j=!0){const{n:et}=CURVE$1,tt=truncateHash(_,!0);if(!isWithinCurveOrder(tt))return;const rt=invert$1(tt,et),nt=Point$2.BASE.multiply(tt),it=mod$1(nt.x,et);if(it===_0n$1)return;const st=mod$1(rt*mod$1(o+$*it,et),et);if(st===_0n$1)return;let ot=new Signature$2(it,st),at=(nt.x===ot.r?0:2)|Number(nt.y&_1n$1);return j&&ot.hasHighS()&&(ot=ot.normalizeS(),at^=1),{sig:ot,recovery:at}}function normalizePrivateKey(_){let o;if(typeof _=="bigint")o=_;else if(typeof _=="number"&&Number.isSafeInteger(_)&&_>0)o=BigInt(_);else if(typeof _=="string"){if(_.length!==2*groupLen)throw new Error("Expected 32 bytes of private key");o=hexToNumber(_)}else if(_ instanceof Uint8Array){if(_.length!==groupLen)throw new Error("Expected 32 bytes of private key");o=bytesToNumber(_)}else throw new TypeError("Expected valid private key");if(!isWithinCurveOrder(o))throw new Error("Expected private key: 0 < key < n");return o}function normalizePublicKey(_){return _ instanceof Point$2?(_.assertValidity(),_):Point$2.fromHex(_)}function normalizeSignature(_){if(_ instanceof Signature$2)return _.assertValidity(),_;try{return Signature$2.fromDER(_)}catch{return Signature$2.fromCompact(_)}}function getPublicKey$1(_,o=!1){return Point$2.fromPrivateKey(_).toRawBytes(o)}function bits2int(_){const o=_.length>fieldLen?_.slice(0,fieldLen):_;return bytesToNumber(o)}function bits2octets(_){const o=bits2int(_),$=mod$1(o,CURVE$1.n);return int2octets($<_0n$1?o:$)}function int2octets(_){return numTo32b(_)}function initSigArgs(_,o,$){if(_==null)throw new Error(`sign: expected valid message hash, not "${_}"`);const j=ensureBytes$1(_),et=normalizePrivateKey(o),tt=[int2octets(et),bits2octets(j)];if($!=null){$===!0&&($=utils$1.randomBytes(fieldLen));const it=ensureBytes$1($);if(it.length!==fieldLen)throw new Error(`sign: Expected ${fieldLen} bytes of extra data`);tt.push(it)}const rt=concatBytes$1(...tt),nt=bits2int(j);return{seed:rt,m:nt,d:et}}function finalizeSig(_,o){const{sig:$,recovery:j}=_,{der:et,recovered:tt}=Object.assign({canonical:!0,der:!0},o),rt=et?$.toDERRawBytes():$.toCompactRawBytes();return tt?[rt,j]:rt}async function sign$1(_,o,$={}){const{seed:j,m:et,d:tt}=initSigArgs(_,o,$.extraEntropy),rt=new HmacDrbg(hashLen,groupLen);await rt.reseed(j);let nt;for(;!(nt=kmdToSig(await rt.generate(),et,tt,$.canonical));)await rt.reseed();return finalizeSig(nt,$)}const vopts={strict:!0};function verify$3(_,o,$,j=vopts){let et;try{et=normalizeSignature(_),o=ensureBytes$1(o)}catch{return!1}const{r:tt,s:rt}=et;if(j.strict&&et.hasHighS())return!1;const nt=truncateHash(o);let it;try{it=normalizePublicKey($)}catch{return!1}const{n:st}=CURVE$1,ot=invert$1(rt,st),at=mod$1(nt*ot,st),ct=mod$1(tt*ot,st),ut=Point$2.BASE.multiplyAndAddUnsafe(it,at,ct);return ut?mod$1(ut.x,st)===tt:!1}Point$2.BASE._setWindowSize(8);const crypto$4={node:nodeCrypto,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},TAGGED_HASH_PREFIXES={},utils$1={bytesToHex:bytesToHex$2,hexToBytes:hexToBytes$2,concatBytes:concatBytes$1,mod:mod$1,invert:invert$1,isValidPrivateKey(_){try{return normalizePrivateKey(_),!0}catch{return!1}},_bigintTo32Bytes:numTo32b,_normalizePrivateKey:normalizePrivateKey,hashToPrivateKey:_=>{_=ensureBytes$1(_);const o=groupLen+8;if(_.length<o||_.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");const $=mod$1(bytesToNumber(_),CURVE$1.n-_1n$1)+_1n$1;return numTo32b($)},randomBytes:(_=32)=>{if(crypto$4.web)return crypto$4.web.getRandomValues(new Uint8Array(_));if(crypto$4.node){const{randomBytes:o}=crypto$4.node;return Uint8Array.from(o(_))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>utils$1.hashToPrivateKey(utils$1.randomBytes(groupLen+8)),precompute(_=8,o=Point$2.BASE){const $=o===Point$2.BASE?o:new Point$2(o.x,o.y);return $._setWindowSize(_),$.multiply(_3n),$},sha256:async(..._)=>{if(crypto$4.web){const o=await crypto$4.web.subtle.digest("SHA-256",concatBytes$1(..._));return new Uint8Array(o)}else if(crypto$4.node){const{createHash:o}=crypto$4.node,$=o("sha256");return _.forEach(j=>$.update(j)),Uint8Array.from($.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(_,...o)=>{if(crypto$4.web){const $=await crypto$4.web.subtle.importKey("raw",_,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),j=concatBytes$1(...o),et=await crypto$4.web.subtle.sign("HMAC",$,j);return new Uint8Array(et)}else if(crypto$4.node){const{createHmac:$}=crypto$4.node,j=$("sha256",_);return o.forEach(et=>j.update(et)),Uint8Array.from(j.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(_,...o)=>{let $=TAGGED_HASH_PREFIXES[_];if($===void 0){const j=await utils$1.sha256(Uint8Array.from(_,et=>et.charCodeAt(0)));$=concatBytes$1(j,j),TAGGED_HASH_PREFIXES[_]=$}return utils$1.sha256($,...o)},taggedHashSync:(_,...o)=>{if(typeof _sha256Sync!="function")throw new ShaError("sha256Sync is undefined, you need to set it");let $=TAGGED_HASH_PREFIXES[_];if($===void 0){const j=_sha256Sync(Uint8Array.from(_,et=>et.charCodeAt(0)));$=concatBytes$1(j,j),TAGGED_HASH_PREFIXES[_]=$}return _sha256Sync($,...o)},_JacobianPoint:JacobianPoint};Object.defineProperties(utils$1,{sha256Sync:{configurable:!1,get(){return _sha256Sync},set(_){_sha256Sync||(_sha256Sync=_)}},hmacSha256Sync:{configurable:!1,get(){return _hmacSha256Sync},set(_){_hmacSha256Sync||(_hmacSha256Sync=_)}}});function randomBytes$3(_){if(isNaN(_)||_<=0)throw new CodeError("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return utils$1.randomBytes(_)}function pkcs1ToJwk(_){const o=forge$s.asn1.fromDer(toString$a(_,"ascii")),$=forge$s.pki.privateKeyFromAsn1(o);return{kty:"RSA",n:bigIntegerToUintBase64url($.n),e:bigIntegerToUintBase64url($.e),d:bigIntegerToUintBase64url($.d),p:bigIntegerToUintBase64url($.p),q:bigIntegerToUintBase64url($.q),dp:bigIntegerToUintBase64url($.dP),dq:bigIntegerToUintBase64url($.dQ),qi:bigIntegerToUintBase64url($.qInv),alg:"RS256"}}function jwkToPkcs1(_){if(_.n==null||_.e==null||_.d==null||_.p==null||_.q==null||_.dp==null||_.dq==null||_.qi==null)throw new CodeError("JWK was missing components","ERR_INVALID_PARAMETERS");const o=forge$s.pki.privateKeyToAsn1({n:base64urlToBigInteger(_.n),e:base64urlToBigInteger(_.e),d:base64urlToBigInteger(_.d),p:base64urlToBigInteger(_.p),q:base64urlToBigInteger(_.q),dP:base64urlToBigInteger(_.dp),dQ:base64urlToBigInteger(_.dq),qInv:base64urlToBigInteger(_.qi)});return fromString$8(forge$s.asn1.toDer(o).getBytes(),"ascii")}function pkixToJwk(_){const o=forge$s.asn1.fromDer(toString$a(_,"ascii")),$=forge$s.pki.publicKeyFromAsn1(o);return{kty:"RSA",n:bigIntegerToUintBase64url($.n),e:bigIntegerToUintBase64url($.e)}}function jwkToPkix(_){if(_.n==null||_.e==null)throw new CodeError("JWK was missing components","ERR_INVALID_PARAMETERS");const o=forge$s.pki.publicKeyToAsn1({n:base64urlToBigInteger(_.n),e:base64urlToBigInteger(_.e)});return fromString$8(forge$s.asn1.toDer(o).getBytes(),"ascii")}function convert$1(_,o){return o.map($=>base64urlToBigInteger(_[$]))}function jwk2priv(_){return forge$s.pki.setRsaPrivateKey(...convert$1(_,["n","e","d","p","q","dp","dq","qi"]))}function jwk2pub(_){return forge$s.pki.setRsaPublicKey(...convert$1(_,["n","e"]))}async function generateKey$2(_){const o=await webcrypto.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:_,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),$=await exportKey(o);return{privateKey:$[0],publicKey:$[1]}}async function unmarshalPrivateKey$1(_){const $=[await webcrypto.get().subtle.importKey("jwk",_,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate(_)],j=await exportKey({privateKey:$[0],publicKey:$[1]});return{privateKey:j[0],publicKey:j[1]}}async function hashAndSign$2(_,o){const $=await webcrypto.get().subtle.importKey("jwk",_,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),j=await webcrypto.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},$,Uint8Array.from(o));return new Uint8Array(j,0,j.byteLength)}async function hashAndVerify$2(_,o,$){const j=await webcrypto.get().subtle.importKey("jwk",_,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await webcrypto.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},j,o,$)}async function exportKey(_){if(_.privateKey==null||_.publicKey==null)throw new CodeError("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([webcrypto.get().subtle.exportKey("jwk",_.privateKey),webcrypto.get().subtle.exportKey("jwk",_.publicKey)])}async function derivePublicFromPrivate(_){return await webcrypto.get().subtle.importKey("jwk",{kty:_.kty,n:_.n,e:_.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function convertKey(_,o,$,j){const et=o?jwk2pub(_):jwk2priv(_),tt=toString$a(Uint8Array.from($),"ascii"),rt=j(tt,et);return fromString$8(rt,"ascii")}function encrypt$1(_,o){return convertKey(_,!0,o,($,j)=>j.encrypt($))}function decrypt$2(_,o){return convertKey(_,!1,o,($,j)=>j.decrypt($))}async function exporter$1(_,o){const j=await create$9().encrypt(_,o);return base64$6.encode(j)}class RsaPublicKey{constructor(o){this._key=o}async verify(o,$){return await hashAndVerify$2(this._key,$,o)}marshal(){return jwkToPkix(this._key)}get bytes(){return PublicKey.encode({Type:KeyType.RSA,Data:this.marshal()}).subarray()}encrypt(o){return encrypt$1(this._key,o)}equals(o){return equals$6(this.bytes,o.bytes)}async hash(){const{bytes:o}=await sha256$8.digest(this.bytes);return o}}class RsaPrivateKey{constructor(o,$){this._key=o,this._publicKey=$}genSecret(){return randomBytes$3(16)}async sign(o){return await hashAndSign$2(this._key,o)}get public(){if(this._publicKey==null)throw new CodeError("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey(this._publicKey)}decrypt(o){return decrypt$2(this._key,o)}marshal(){return jwkToPkcs1(this._key)}get bytes(){return PrivateKey.encode({Type:KeyType.RSA,Data:this.marshal()}).subarray()}equals(o){return equals$6(this.bytes,o.bytes)}async hash(){const{bytes:o}=await sha256$8.digest(this.bytes);return o}async id(){const o=await this.public.hash();return toString$a(o,"base58btc")}async export(o,$="pkcs-8"){if($==="pkcs-8"){const j=new forge$s.util.ByteBuffer(this.marshal()),et=forge$s.asn1.fromDer(j),tt=forge$s.pki.privateKeyFromAsn1(et),rt={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return forge$s.pki.encryptRsaPrivateKey(tt,o,rt)}else{if($==="libp2p-key")return await exporter$1(this.bytes,o);throw new CodeError(`export format '${$}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}}async function unmarshalRsaPrivateKey(_){const o=pkcs1ToJwk(_),$=await unmarshalPrivateKey$1(o);return new RsaPrivateKey($.privateKey,$.publicKey)}function unmarshalRsaPublicKey(_){const o=pkixToJwk(_);return new RsaPublicKey(o)}async function fromJwk(_){const o=await unmarshalPrivateKey$1(_);return new RsaPrivateKey(o.privateKey,o.publicKey)}async function generateKeyPair$3(_){const o=await generateKey$2(_);return new RsaPrivateKey(o.privateKey,o.publicKey)}const RSA=Object.freeze(Object.defineProperty({__proto__:null,RsaPrivateKey,RsaPublicKey,fromJwk,generateKeyPair:generateKeyPair$3,unmarshalRsaPrivateKey,unmarshalRsaPublicKey},Symbol.toStringTag,{value:"Module"}));/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const _0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2),_8n=BigInt(8),CU_O=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),CURVE=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:CU_O,n:CU_O,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),POW_2_256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),SQRT_M1=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");const SQRT_AD_MINUS_ONE=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),INVSQRT_A_MINUS_D=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),ONE_MINUS_D_SQ=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),D_MINUS_ONE_SQ=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class ExtendedPoint{constructor(o,$,j,et){this.x=o,this.y=$,this.z=j,this.t=et}static fromAffine(o){if(!(o instanceof Point$1))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return o.equals(Point$1.ZERO)?ExtendedPoint.ZERO:new ExtendedPoint(o.x,o.y,_1n,mod(o.x*o.y))}static toAffineBatch(o){const $=invertBatch(o.map(j=>j.z));return o.map((j,et)=>j.toAffine($[et]))}static normalizeZ(o){return this.toAffineBatch(o).map(this.fromAffine)}equals(o){assertExtPoint(o);const{x:$,y:j,z:et}=this,{x:tt,y:rt,z:nt}=o,it=mod($*nt),st=mod(tt*et),ot=mod(j*nt),at=mod(rt*et);return it===st&&ot===at}negate(){return new ExtendedPoint(mod(-this.x),this.y,this.z,mod(-this.t))}double(){const{x:o,y:$,z:j}=this,{a:et}=CURVE,tt=mod(o*o),rt=mod($*$),nt=mod(_2n*mod(j*j)),it=mod(et*tt),st=o+$,ot=mod(mod(st*st)-tt-rt),at=it+rt,ct=at-nt,ut=it-rt,ft=mod(ot*ct),ht=mod(at*ut),mt=mod(ot*ut),gt=mod(ct*at);return new ExtendedPoint(ft,ht,gt,mt)}add(o){assertExtPoint(o);const{x:$,y:j,z:et,t:tt}=this,{x:rt,y:nt,z:it,t:st}=o,ot=mod((j-$)*(nt+rt)),at=mod((j+$)*(nt-rt)),ct=mod(at-ot);if(ct===_0n)return this.double();const ut=mod(et*_2n*st),ft=mod(tt*_2n*it),ht=ft+ut,mt=at+ot,gt=ft-ut,Et=mod(ht*ct),St=mod(mt*gt),At=mod(ht*gt),kt=mod(ct*mt);return new ExtendedPoint(Et,St,kt,At)}subtract(o){return this.add(o.negate())}precomputeWindow(o){const $=1+256/o,j=[];let et=this,tt=et;for(let rt=0;rt<$;rt++){tt=et,j.push(tt);for(let nt=1;nt<2**(o-1);nt++)tt=tt.add(et),j.push(tt);et=tt.double()}return j}wNAF(o,$){!$&&this.equals(ExtendedPoint.BASE)&&($=Point$1.BASE);const j=$&&$._WINDOW_SIZE||1;if(256%j)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let et=$&&pointPrecomputes.get($);et||(et=this.precomputeWindow(j),$&&j!==1&&(et=ExtendedPoint.normalizeZ(et),pointPrecomputes.set($,et)));let tt=ExtendedPoint.ZERO,rt=ExtendedPoint.BASE;const nt=1+256/j,it=2**(j-1),st=BigInt(2**j-1),ot=2**j,at=BigInt(j);for(let ct=0;ct<nt;ct++){const ut=ct*it;let ft=Number(o&st);o>>=at,ft>it&&(ft-=ot,o+=_1n);const ht=ut,mt=ut+Math.abs(ft)-1,gt=ct%2!==0,Et=ft<0;ft===0?rt=rt.add(constTimeNegate(gt,et[ht])):tt=tt.add(constTimeNegate(Et,et[mt]))}return ExtendedPoint.normalizeZ([tt,rt])[0]}multiply(o,$){return this.wNAF(normalizeScalar(o,CURVE.l),$)}multiplyUnsafe(o){let $=normalizeScalar(o,CURVE.l,!1);const j=ExtendedPoint.BASE,et=ExtendedPoint.ZERO;if($===_0n)return et;if(this.equals(et)||$===_1n)return this;if(this.equals(j))return this.wNAF($);let tt=et,rt=this;for(;$>_0n;)$&_1n&&(tt=tt.add(rt)),rt=rt.double(),$>>=_1n;return tt}isSmallOrder(){return this.multiplyUnsafe(CURVE.h).equals(ExtendedPoint.ZERO)}isTorsionFree(){let o=this.multiplyUnsafe(CURVE.l/_2n).double();return CURVE.l%_2n&&(o=o.add(this)),o.equals(ExtendedPoint.ZERO)}toAffine(o){const{x:$,y:j,z:et}=this,tt=this.equals(ExtendedPoint.ZERO);o==null&&(o=tt?_8n:invert(et));const rt=mod($*o),nt=mod(j*o),it=mod(et*o);if(tt)return Point$1.ZERO;if(it!==_1n)throw new Error("invZ was invalid");return new Point$1(rt,nt)}fromRistrettoBytes(){legacyRist()}toRistrettoBytes(){legacyRist()}fromRistrettoHash(){legacyRist()}}ExtendedPoint.BASE=new ExtendedPoint(CURVE.Gx,CURVE.Gy,_1n,mod(CURVE.Gx*CURVE.Gy));ExtendedPoint.ZERO=new ExtendedPoint(_0n,_1n,_1n,_0n);function constTimeNegate(_,o){const $=o.negate();return _?$:o}function assertExtPoint(_){if(!(_ instanceof ExtendedPoint))throw new TypeError("ExtendedPoint expected")}function assertRstPoint(_){if(!(_ instanceof RistrettoPoint))throw new TypeError("RistrettoPoint expected")}function legacyRist(){throw new Error("Legacy method: switch to RistrettoPoint")}class RistrettoPoint{constructor(o){this.ep=o}static calcElligatorRistrettoMap(o){const{d:$}=CURVE,j=mod(SQRT_M1*o*o),et=mod((j+_1n)*ONE_MINUS_D_SQ);let tt=BigInt(-1);const rt=mod((tt-$*j)*mod(j+$));let{isValid:nt,value:it}=uvRatio(et,rt),st=mod(it*o);edIsNegative(st)||(st=mod(-st)),nt||(it=st),nt||(tt=j);const ot=mod(tt*(j-_1n)*D_MINUS_ONE_SQ-rt),at=it*it,ct=mod((it+it)*rt),ut=mod(ot*SQRT_AD_MINUS_ONE),ft=mod(_1n-at),ht=mod(_1n+at);return new ExtendedPoint(mod(ct*ht),mod(ft*ut),mod(ut*ht),mod(ct*ft))}static hashToCurve(o){o=ensureBytes(o,64);const $=bytes255ToNumberLE(o.slice(0,32)),j=this.calcElligatorRistrettoMap($),et=bytes255ToNumberLE(o.slice(32,64)),tt=this.calcElligatorRistrettoMap(et);return new RistrettoPoint(j.add(tt))}static fromHex(o){o=ensureBytes(o,32);const{a:$,d:j}=CURVE,et="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",tt=bytes255ToNumberLE(o);if(!equalBytes(numberTo32BytesLE(tt),o)||edIsNegative(tt))throw new Error(et);const rt=mod(tt*tt),nt=mod(_1n+$*rt),it=mod(_1n-$*rt),st=mod(nt*nt),ot=mod(it*it),at=mod($*j*st-ot),{isValid:ct,value:ut}=invertSqrt(mod(at*ot)),ft=mod(ut*it),ht=mod(ut*ft*at);let mt=mod((tt+tt)*ft);edIsNegative(mt)&&(mt=mod(-mt));const gt=mod(nt*ht),Et=mod(mt*gt);if(!ct||edIsNegative(Et)||gt===_0n)throw new Error(et);return new RistrettoPoint(new ExtendedPoint(mt,gt,_1n,Et))}toRawBytes(){let{x:o,y:$,z:j,t:et}=this.ep;const tt=mod(mod(j+$)*mod(j-$)),rt=mod(o*$),nt=mod(rt*rt),{value:it}=invertSqrt(mod(tt*nt)),st=mod(it*tt),ot=mod(it*rt),at=mod(st*ot*et);let ct;if(edIsNegative(et*at)){let ft=mod($*SQRT_M1),ht=mod(o*SQRT_M1);o=ft,$=ht,ct=mod(st*INVSQRT_A_MINUS_D)}else ct=ot;edIsNegative(o*at)&&($=mod(-$));let ut=mod((j-$)*ct);return edIsNegative(ut)&&(ut=mod(-ut)),numberTo32BytesLE(ut)}toHex(){return bytesToHex$1(this.toRawBytes())}toString(){return this.toHex()}equals(o){assertRstPoint(o);const $=this.ep,j=o.ep,et=mod($.x*j.y)===mod($.y*j.x),tt=mod($.y*j.y)===mod($.x*j.x);return et||tt}add(o){return assertRstPoint(o),new RistrettoPoint(this.ep.add(o.ep))}subtract(o){return assertRstPoint(o),new RistrettoPoint(this.ep.subtract(o.ep))}multiply(o){return new RistrettoPoint(this.ep.multiply(o))}multiplyUnsafe(o){return new RistrettoPoint(this.ep.multiplyUnsafe(o))}}RistrettoPoint.BASE=new RistrettoPoint(ExtendedPoint.BASE);RistrettoPoint.ZERO=new RistrettoPoint(ExtendedPoint.ZERO);const pointPrecomputes=new WeakMap;let Point$1=class lo{constructor(o,$){this.x=o,this.y=$}_setWindowSize(o){this._WINDOW_SIZE=o,pointPrecomputes.delete(this)}static fromHex(o,$=!0){const{d:j,P:et}=CURVE;o=ensureBytes(o,32);const tt=o.slice();tt[31]=o[31]&-129;const rt=bytesToNumberLE(tt);if($&&rt>=et)throw new Error("Expected 0 < hex < P");if(!$&&rt>=POW_2_256)throw new Error("Expected 0 < hex < 2**256");const nt=mod(rt*rt),it=mod(nt-_1n),st=mod(j*nt+_1n);let{isValid:ot,value:at}=uvRatio(it,st);if(!ot)throw new Error("Point.fromHex: invalid y coordinate");const ct=(at&_1n)===_1n;return(o[31]&128)!==0!==ct&&(at=mod(-at)),new lo(at,rt)}static async fromPrivateKey(o){return(await getExtendedPublicKey(o)).point}toRawBytes(){const o=numberTo32BytesLE(this.y);return o[31]|=this.x&_1n?128:0,o}toHex(){return bytesToHex$1(this.toRawBytes())}toX25519(){const{y:o}=this,$=mod((_1n+o)*invert(_1n-o));return numberTo32BytesLE($)}isTorsionFree(){return ExtendedPoint.fromAffine(this).isTorsionFree()}equals(o){return this.x===o.x&&this.y===o.y}negate(){return new lo(mod(-this.x),this.y)}add(o){return ExtendedPoint.fromAffine(this).add(ExtendedPoint.fromAffine(o)).toAffine()}subtract(o){return this.add(o.negate())}multiply(o){return ExtendedPoint.fromAffine(this).multiply(o,this).toAffine()}};Point$1.BASE=new Point$1(CURVE.Gx,CURVE.Gy);Point$1.ZERO=new Point$1(_0n,_1n);let Signature$1=class ko{constructor(o,$){this.r=o,this.s=$,this.assertValidity()}static fromHex(o){const $=ensureBytes(o,64),j=Point$1.fromHex($.slice(0,32),!1),et=bytesToNumberLE($.slice(32,64));return new ko(j,et)}assertValidity(){const{r:o,s:$}=this;if(!(o instanceof Point$1))throw new Error("Expected Point instance");return normalizeScalar($,CURVE.l,!1),this}toRawBytes(){const o=new Uint8Array(64);return o.set(this.r.toRawBytes()),o.set(numberTo32BytesLE(this.s),32),o}toHex(){return bytesToHex$1(this.toRawBytes())}};function concatBytes(..._){if(!_.every(j=>j instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(_.length===1)return _[0];const o=_.reduce((j,et)=>j+et.length,0),$=new Uint8Array(o);for(let j=0,et=0;j<_.length;j++){const tt=_[j];$.set(tt,et),et+=tt.length}return $}const hexes=Array.from({length:256},(_,o)=>o.toString(16).padStart(2,"0"));function bytesToHex$1(_){if(!(_ instanceof Uint8Array))throw new Error("Uint8Array expected");let o="";for(let $=0;$<_.length;$++)o+=hexes[_[$]];return o}function hexToBytes$1(_){if(typeof _!="string")throw new TypeError("hexToBytes: expected string, got "+typeof _);if(_.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const o=new Uint8Array(_.length/2);for(let $=0;$<o.length;$++){const j=$*2,et=_.slice(j,j+2),tt=Number.parseInt(et,16);if(Number.isNaN(tt)||tt<0)throw new Error("Invalid byte sequence");o[$]=tt}return o}function numberTo32BytesBE(_){const $=_.toString(16).padStart(64,"0");return hexToBytes$1($)}function numberTo32BytesLE(_){return numberTo32BytesBE(_).reverse()}function edIsNegative(_){return(mod(_)&_1n)===_1n}function bytesToNumberLE(_){if(!(_ instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+bytesToHex$1(Uint8Array.from(_).reverse()))}const MAX_255B=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function bytes255ToNumberLE(_){return mod(bytesToNumberLE(_)&MAX_255B)}function mod(_,o=CURVE.P){const $=_%o;return $>=_0n?$:o+$}function invert(_,o=CURVE.P){if(_===_0n||o<=_0n)throw new Error(`invert: expected positive integers, got n=${_} mod=${o}`);let $=mod(_,o),j=o,et=_0n,tt=_1n;for(;$!==_0n;){const nt=j/$,it=j%$,st=et-tt*nt;j=$,$=it,et=tt,tt=st}if(j!==_1n)throw new Error("invert: does not exist");return mod(et,o)}function invertBatch(_,o=CURVE.P){const $=new Array(_.length),j=_.reduce((tt,rt,nt)=>rt===_0n?tt:($[nt]=tt,mod(tt*rt,o)),_1n),et=invert(j,o);return _.reduceRight((tt,rt,nt)=>rt===_0n?tt:($[nt]=mod(tt*$[nt],o),mod(tt*rt,o)),et),$}function pow2(_,o){const{P:$}=CURVE;let j=_;for(;o-- >_0n;)j*=j,j%=$;return j}function pow_2_252_3(_){const{P:o}=CURVE,$=BigInt(5),j=BigInt(10),et=BigInt(20),tt=BigInt(40),rt=BigInt(80),it=_*_%o*_%o,st=pow2(it,_2n)*it%o,ot=pow2(st,_1n)*_%o,at=pow2(ot,$)*ot%o,ct=pow2(at,j)*at%o,ut=pow2(ct,et)*ct%o,ft=pow2(ut,tt)*ut%o,ht=pow2(ft,rt)*ft%o,mt=pow2(ht,rt)*ft%o,gt=pow2(mt,j)*at%o;return{pow_p_5_8:pow2(gt,_2n)*_%o,b2:it}}function uvRatio(_,o){const $=mod(o*o*o),j=mod($*$*o),et=pow_2_252_3(_*j).pow_p_5_8;let tt=mod(_*$*et);const rt=mod(o*tt*tt),nt=tt,it=mod(tt*SQRT_M1),st=rt===_,ot=rt===mod(-_),at=rt===mod(-_*SQRT_M1);return st&&(tt=nt),(ot||at)&&(tt=it),edIsNegative(tt)&&(tt=mod(-tt)),{isValid:st||ot,value:tt}}function invertSqrt(_){return uvRatio(_1n,_)}function modlLE(_){return mod(bytesToNumberLE(_),CURVE.l)}function equalBytes(_,o){if(_.length!==o.length)return!1;for(let $=0;$<_.length;$++)if(_[$]!==o[$])return!1;return!0}function ensureBytes(_,o){const $=_ instanceof Uint8Array?Uint8Array.from(_):hexToBytes$1(_);if(typeof o=="number"&&$.length!==o)throw new Error(`Expected ${o} bytes`);return $}function normalizeScalar(_,o,$=!0){if(!o)throw new TypeError("Specify max value");if(typeof _=="number"&&Number.isSafeInteger(_)&&(_=BigInt(_)),typeof _=="bigint"&&_<o){if($){if(_0n<_)return _}else if(_0n<=_)return _}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function adjustBytes25519(_){return _[0]&=248,_[31]&=127,_[31]|=64,_}function checkPrivateKey(_){if(_=typeof _=="bigint"||typeof _=="number"?numberTo32BytesBE(normalizeScalar(_,POW_2_256)):ensureBytes(_),_.length!==32)throw new Error("Expected 32 bytes");return _}function getKeyFromHash(_){const o=adjustBytes25519(_.slice(0,32)),$=_.slice(32,64),j=modlLE(o),et=Point$1.BASE.multiply(j),tt=et.toRawBytes();return{head:o,prefix:$,scalar:j,point:et,pointBytes:tt}}let _sha512Sync;async function getExtendedPublicKey(_){return getKeyFromHash(await utils.sha512(checkPrivateKey(_)))}async function getPublicKey(_){return(await getExtendedPublicKey(_)).pointBytes}async function sign(_,o){_=ensureBytes(_);const{prefix:$,scalar:j,pointBytes:et}=await getExtendedPublicKey(o),tt=modlLE(await utils.sha512($,_)),rt=Point$1.BASE.multiply(tt),nt=modlLE(await utils.sha512(rt.toRawBytes(),et,_)),it=mod(tt+nt*j,CURVE.l);return new Signature$1(rt,it).toRawBytes()}function prepareVerification(_,o,$){o=ensureBytes(o),$ instanceof Point$1||($=Point$1.fromHex($,!1));const{r:j,s:et}=_ instanceof Signature$1?_.assertValidity():Signature$1.fromHex(_),tt=ExtendedPoint.BASE.multiplyUnsafe(et);return{r:j,s:et,SB:tt,pub:$,msg:o}}function finishVerification(_,o,$,j){const et=modlLE(j),tt=ExtendedPoint.fromAffine(_).multiplyUnsafe(et);return ExtendedPoint.fromAffine(o).add(tt).subtract($).multiplyUnsafe(CURVE.h).equals(ExtendedPoint.ZERO)}async function verify$2(_,o,$){const{r:j,SB:et,msg:tt,pub:rt}=prepareVerification(_,o,$),nt=await utils.sha512(j.toRawBytes(),rt.toRawBytes(),tt);return finishVerification(rt,j,et,nt)}Point$1.BASE._setWindowSize(8);const crypto$3={node:nodeCrypto,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},utils={bytesToHex:bytesToHex$1,hexToBytes:hexToBytes$1,concatBytes,getExtendedPublicKey,mod,invert,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:_=>{if(_=ensureBytes(_),_.length<40||_.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return mod(bytesToNumberLE(_),CURVE.l-_1n)+_1n},randomBytes:(_=32)=>{if(crypto$3.web)return crypto$3.web.getRandomValues(new Uint8Array(_));if(crypto$3.node){const{randomBytes:o}=crypto$3.node;return new Uint8Array(o(_).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>utils.randomBytes(32),sha512:async(..._)=>{const o=concatBytes(..._);if(crypto$3.web){const $=await crypto$3.web.subtle.digest("SHA-512",o.buffer);return new Uint8Array($)}else{if(crypto$3.node)return Uint8Array.from(crypto$3.node.createHash("sha512").update(o).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(_=8,o=Point$1.BASE){const $=o.equals(Point$1.BASE)?o:new Point$1(o.x,o.y);return $._setWindowSize(_),$.multiply(_2n),$},sha512Sync:void 0};Object.defineProperties(utils,{sha512Sync:{configurable:!1,get(){return _sha512Sync},set(_){_sha512Sync||(_sha512Sync=_)}}});const PUBLIC_KEY_BYTE_LENGTH=32,PRIVATE_KEY_BYTE_LENGTH=64,KEYS_BYTE_LENGTH=32;async function generateKey$1(){const _=utils.randomPrivateKey(),o=await getPublicKey(_);return{privateKey:concatKeys(_,o),publicKey:o}}async function generateKeyFromSeed(_){if(_.length!==KEYS_BYTE_LENGTH)throw new TypeError('"seed" must be 32 bytes in length.');if(!(_ instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const o=_,$=await getPublicKey(o);return{privateKey:concatKeys(o,$),publicKey:$}}async function hashAndSign$1(_,o){const $=_.subarray(0,KEYS_BYTE_LENGTH);return await sign(o,$)}async function hashAndVerify$1(_,o,$){return await verify$2(o,$,_)}function concatKeys(_,o){const $=new Uint8Array(PRIVATE_KEY_BYTE_LENGTH);for(let j=0;j<KEYS_BYTE_LENGTH;j++)$[j]=_[j],$[KEYS_BYTE_LENGTH+j]=o[j];return $}class Ed25519PublicKey{constructor(o){this._key=ensureKey(o,PUBLIC_KEY_BYTE_LENGTH)}async verify(o,$){return await hashAndVerify$1(this._key,$,o)}marshal(){return this._key}get bytes(){return PublicKey.encode({Type:KeyType.Ed25519,Data:this.marshal()}).subarray()}equals(o){return equals$6(this.bytes,o.bytes)}async hash(){const{bytes:o}=await sha256$8.digest(this.bytes);return o}}class Ed25519PrivateKey{constructor(o,$){this._key=ensureKey(o,PRIVATE_KEY_BYTE_LENGTH),this._publicKey=ensureKey($,PUBLIC_KEY_BYTE_LENGTH)}async sign(o){return await hashAndSign$1(this._key,o)}get public(){return new Ed25519PublicKey(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey.encode({Type:KeyType.Ed25519,Data:this.marshal()}).subarray()}equals(o){return equals$6(this.bytes,o.bytes)}async hash(){const{bytes:o}=await sha256$8.digest(this.bytes);return o}async id(){const o=identity$3.digest(this.public.bytes);return base58btc$4.encode(o.bytes).substring(1)}async export(o,$="libp2p-key"){if($==="libp2p-key")return await exporter$1(this.bytes,o);throw new CodeError(`export format '${$}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function unmarshalEd25519PrivateKey(_){if(_.length>PRIVATE_KEY_BYTE_LENGTH){_=ensureKey(_,PRIVATE_KEY_BYTE_LENGTH+PUBLIC_KEY_BYTE_LENGTH);const j=_.subarray(0,PRIVATE_KEY_BYTE_LENGTH),et=_.subarray(PRIVATE_KEY_BYTE_LENGTH,_.length);return new Ed25519PrivateKey(j,et)}_=ensureKey(_,PRIVATE_KEY_BYTE_LENGTH);const o=_.subarray(0,PRIVATE_KEY_BYTE_LENGTH),$=_.subarray(PUBLIC_KEY_BYTE_LENGTH);return new Ed25519PrivateKey(o,$)}function unmarshalEd25519PublicKey(_){return _=ensureKey(_,PUBLIC_KEY_BYTE_LENGTH),new Ed25519PublicKey(_)}async function generateKeyPair$2(){const{privateKey:_,publicKey:o}=await generateKey$1();return new Ed25519PrivateKey(_,o)}async function generateKeyPairFromSeed(_){const{privateKey:o,publicKey:$}=await generateKeyFromSeed(_);return new Ed25519PrivateKey(o,$)}function ensureKey(_,o){if(_=Uint8Array.from(_??[]),_.length!==o)throw new CodeError(`Key must be a Uint8Array of length ${o}, got ${_.length}`,"ERR_INVALID_KEY_TYPE");return _}const Ed25519=Object.freeze(Object.defineProperty({__proto__:null,Ed25519PrivateKey,Ed25519PublicKey,generateKeyPair:generateKeyPair$2,generateKeyPairFromSeed,unmarshalEd25519PrivateKey,unmarshalEd25519PublicKey},Symbol.toStringTag,{value:"Module"}));function generateKey(){return utils$1.randomPrivateKey()}async function hashAndSign(_,o){const{digest:$}=await sha256$8.digest(o);try{return await sign$1($,_)}catch(j){throw new CodeError(String(j),"ERR_INVALID_INPUT")}}async function hashAndVerify(_,o,$){try{const{digest:j}=await sha256$8.digest($);return verify$3(o,j,_)}catch(j){throw new CodeError(String(j),"ERR_INVALID_INPUT")}}function compressPublicKey(_){return Point$2.fromHex(_).toRawBytes(!0)}function validatePrivateKey(_){try{getPublicKey$1(_,!0)}catch(o){throw new CodeError(String(o),"ERR_INVALID_PRIVATE_KEY")}}function validatePublicKey(_){try{Point$2.fromHex(_)}catch(o){throw new CodeError(String(o),"ERR_INVALID_PUBLIC_KEY")}}function computePublicKey$1(_){try{return getPublicKey$1(_,!0)}catch(o){throw new CodeError(String(o),"ERR_INVALID_PRIVATE_KEY")}}class Secp256k1PublicKey{constructor(o){validatePublicKey(o),this._key=o}async verify(o,$){return await hashAndVerify(this._key,$,o)}marshal(){return compressPublicKey(this._key)}get bytes(){return PublicKey.encode({Type:KeyType.Secp256k1,Data:this.marshal()}).subarray()}equals(o){return equals$6(this.bytes,o.bytes)}async hash(){const{bytes:o}=await sha256$8.digest(this.bytes);return o}}class Secp256k1PrivateKey{constructor(o,$){this._key=o,this._publicKey=$??computePublicKey$1(o),validatePrivateKey(this._key),validatePublicKey(this._publicKey)}async sign(o){return await hashAndSign(this._key,o)}get public(){return new Secp256k1PublicKey(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey.encode({Type:KeyType.Secp256k1,Data:this.marshal()}).subarray()}equals(o){return equals$6(this.bytes,o.bytes)}async hash(){const{bytes:o}=await sha256$8.digest(this.bytes);return o}async id(){const o=await this.public.hash();return toString$a(o,"base58btc")}async export(o,$="libp2p-key"){if($==="libp2p-key")return await exporter$1(this.bytes,o);throw new CodeError(`export format '${$}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function unmarshalSecp256k1PrivateKey(_){return new Secp256k1PrivateKey(_)}function unmarshalSecp256k1PublicKey(_){return new Secp256k1PublicKey(_)}async function generateKeyPair$1(){const _=generateKey();return new Secp256k1PrivateKey(_)}const Secp256k1=Object.freeze(Object.defineProperty({__proto__:null,Secp256k1PrivateKey,Secp256k1PublicKey,generateKeyPair:generateKeyPair$1,unmarshalSecp256k1PrivateKey,unmarshalSecp256k1PublicKey},Symbol.toStringTag,{value:"Module"})),supportedKeys={rsa:RSA,ed25519:Ed25519,secp256k1:Secp256k1};function unsupportedKey(_){const o=Object.keys(supportedKeys).join(" / ");return new CodeError(`invalid or unsupported key type ${_}. Must be ${o}`,"ERR_UNSUPPORTED_KEY_TYPE")}function typeToKey(_){if(_=_.toLowerCase(),_==="rsa"||_==="ed25519"||_==="secp256k1")return supportedKeys[_];throw unsupportedKey(_)}async function generateKeyPair(_,o){return await typeToKey(_).generateKeyPair(o??2048)}function unmarshalPublicKey(_){const o=PublicKey.decode(_),$=o.Data??new Uint8Array;switch(o.Type){case KeyType.RSA:return supportedKeys.rsa.unmarshalRsaPublicKey($);case KeyType.Ed25519:return supportedKeys.ed25519.unmarshalEd25519PublicKey($);case KeyType.Secp256k1:return supportedKeys.secp256k1.unmarshalSecp256k1PublicKey($);default:throw unsupportedKey(o.Type??"RSA")}}function marshalPublicKey(_,o){return o=(o??"rsa").toLowerCase(),typeToKey(o),_.bytes}async function unmarshalPrivateKey(_){const o=PrivateKey.decode(_),$=o.Data??new Uint8Array;switch(o.Type){case KeyType.RSA:return await supportedKeys.rsa.unmarshalRsaPrivateKey($);case KeyType.Ed25519:return supportedKeys.ed25519.unmarshalEd25519PrivateKey($);case KeyType.Secp256k1:return supportedKeys.secp256k1.unmarshalSecp256k1PrivateKey($);default:throw unsupportedKey(o.Type??"RSA")}}function marshalPrivateKey(_,o){return o=(o??"rsa").toLowerCase(),typeToKey(o),_.bytes}async function importKey(_,o){try{const et=await importer$1(_,o);return await unmarshalPrivateKey(et)}catch{}const $=forge$s.pki.decryptRsaPrivateKey(_,o);if($===null)throw new CodeError("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let j=forge$s.asn1.toDer(forge$s.pki.privateKeyToAsn1($));return j=fromString$8(j.getBytes(),"ascii"),await supportedKeys.rsa.unmarshalRsaPrivateKey(j)}const hashName={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function pbkdf2$2(_,o,$,j,et){if(et!=="sha1"&&et!=="sha2-256"&&et!=="sha2-512"){const nt=Object.keys(hashName).join(" / ");throw new CodeError(`Hash '${et}' is unknown or not supported. Must be ${nt}`,"ERR_UNSUPPORTED_HASH_TYPE")}const tt=hashName[et],rt=pbkdf2$3(_,o,$,j,tt);return utilExports.encode64(rt,null)}const errors$1={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function assert$6(_,o){if(!_)throw new Error(o)}function isUint8Array(_,o,$){if(assert$6(o instanceof Uint8Array,`Expected ${_} to be an Uint8Array`),$!==void 0)if(Array.isArray($)){const j=$.join(", "),et=`Expected ${_} to be an Uint8Array with length [${j}]`;assert$6($.includes(o.length),et)}else{const j=`Expected ${_} to be an Uint8Array with length ${$}`;assert$6(o.length===$,j)}}function isCompressed(_){assert$6(toTypeString(_)==="Boolean","Expected compressed to be a Boolean")}function getAssertedOutput(_=$=>new Uint8Array($),o){return typeof _=="function"&&(_=_(o)),isUint8Array("output",_,o),_}function toTypeString(_){return Object.prototype.toString.call(_).slice(8,-1)}var lib=_=>({contextRandomize(o){switch(assert$6(o===null||o instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),o!==null&&isUint8Array("seed",o,32),_.contextRandomize(o)){case 1:throw new Error(errors$1.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(o){return isUint8Array("private key",o,32),_.privateKeyVerify(o)===0},privateKeyNegate(o){switch(isUint8Array("private key",o,32),_.privateKeyNegate(o)){case 0:return o;case 1:throw new Error(errors$1.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(o,$){switch(isUint8Array("private key",o,32),isUint8Array("tweak",$,32),_.privateKeyTweakAdd(o,$)){case 0:return o;case 1:throw new Error(errors$1.TWEAK_ADD)}},privateKeyTweakMul(o,$){switch(isUint8Array("private key",o,32),isUint8Array("tweak",$,32),_.privateKeyTweakMul(o,$)){case 0:return o;case 1:throw new Error(errors$1.TWEAK_MUL)}},publicKeyVerify(o){return isUint8Array("public key",o,[33,65]),_.publicKeyVerify(o)===0},publicKeyCreate(o,$=!0,j){switch(isUint8Array("private key",o,32),isCompressed($),j=getAssertedOutput(j,$?33:65),_.publicKeyCreate(j,o)){case 0:return j;case 1:throw new Error(errors$1.SECKEY_INVALID);case 2:throw new Error(errors$1.PUBKEY_SERIALIZE)}},publicKeyConvert(o,$=!0,j){switch(isUint8Array("public key",o,[33,65]),isCompressed($),j=getAssertedOutput(j,$?33:65),_.publicKeyConvert(j,o)){case 0:return j;case 1:throw new Error(errors$1.PUBKEY_PARSE);case 2:throw new Error(errors$1.PUBKEY_SERIALIZE)}},publicKeyNegate(o,$=!0,j){switch(isUint8Array("public key",o,[33,65]),isCompressed($),j=getAssertedOutput(j,$?33:65),_.publicKeyNegate(j,o)){case 0:return j;case 1:throw new Error(errors$1.PUBKEY_PARSE);case 2:throw new Error(errors$1.IMPOSSIBLE_CASE);case 3:throw new Error(errors$1.PUBKEY_SERIALIZE)}},publicKeyCombine(o,$=!0,j){assert$6(Array.isArray(o),"Expected public keys to be an Array"),assert$6(o.length>0,"Expected public keys array will have more than zero items");for(const et of o)isUint8Array("public key",et,[33,65]);switch(isCompressed($),j=getAssertedOutput(j,$?33:65),_.publicKeyCombine(j,o)){case 0:return j;case 1:throw new Error(errors$1.PUBKEY_PARSE);case 2:throw new Error(errors$1.PUBKEY_COMBINE);case 3:throw new Error(errors$1.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(o,$,j=!0,et){switch(isUint8Array("public key",o,[33,65]),isUint8Array("tweak",$,32),isCompressed(j),et=getAssertedOutput(et,j?33:65),_.publicKeyTweakAdd(et,o,$)){case 0:return et;case 1:throw new Error(errors$1.PUBKEY_PARSE);case 2:throw new Error(errors$1.TWEAK_ADD)}},publicKeyTweakMul(o,$,j=!0,et){switch(isUint8Array("public key",o,[33,65]),isUint8Array("tweak",$,32),isCompressed(j),et=getAssertedOutput(et,j?33:65),_.publicKeyTweakMul(et,o,$)){case 0:return et;case 1:throw new Error(errors$1.PUBKEY_PARSE);case 2:throw new Error(errors$1.TWEAK_MUL)}},signatureNormalize(o){switch(isUint8Array("signature",o,64),_.signatureNormalize(o)){case 0:return o;case 1:throw new Error(errors$1.SIG_PARSE)}},signatureExport(o,$){isUint8Array("signature",o,64),$=getAssertedOutput($,72);const j={output:$,outputlen:72};switch(_.signatureExport(j,o)){case 0:return $.slice(0,j.outputlen);case 1:throw new Error(errors$1.SIG_PARSE);case 2:throw new Error(errors$1.IMPOSSIBLE_CASE)}},signatureImport(o,$){switch(isUint8Array("signature",o),$=getAssertedOutput($,64),_.signatureImport($,o)){case 0:return $;case 1:throw new Error(errors$1.SIG_PARSE);case 2:throw new Error(errors$1.IMPOSSIBLE_CASE)}},ecdsaSign(o,$,j={},et){isUint8Array("message",o,32),isUint8Array("private key",$,32),assert$6(toTypeString(j)==="Object","Expected options to be an Object"),j.data!==void 0&&isUint8Array("options.data",j.data),j.noncefn!==void 0&&assert$6(toTypeString(j.noncefn)==="Function","Expected options.noncefn to be a Function"),et=getAssertedOutput(et,64);const tt={signature:et,recid:null};switch(_.ecdsaSign(tt,o,$,j.data,j.noncefn)){case 0:return tt;case 1:throw new Error(errors$1.SIGN);case 2:throw new Error(errors$1.IMPOSSIBLE_CASE)}},ecdsaVerify(o,$,j){switch(isUint8Array("signature",o,64),isUint8Array("message",$,32),isUint8Array("public key",j,[33,65]),_.ecdsaVerify(o,$,j)){case 0:return!0;case 3:return!1;case 1:throw new Error(errors$1.SIG_PARSE);case 2:throw new Error(errors$1.PUBKEY_PARSE)}},ecdsaRecover(o,$,j,et=!0,tt){switch(isUint8Array("signature",o,64),assert$6(toTypeString($)==="Number"&&$>=0&&$<=3,"Expected recovery id to be a Number within interval [0, 3]"),isUint8Array("message",j,32),isCompressed(et),tt=getAssertedOutput(tt,et?33:65),_.ecdsaRecover(tt,o,$,j)){case 0:return tt;case 1:throw new Error(errors$1.SIG_PARSE);case 2:throw new Error(errors$1.RECOVER);case 3:throw new Error(errors$1.IMPOSSIBLE_CASE)}},ecdh(o,$,j={},et){switch(isUint8Array("public key",o,[33,65]),isUint8Array("private key",$,32),assert$6(toTypeString(j)==="Object","Expected options to be an Object"),j.data!==void 0&&isUint8Array("options.data",j.data),j.hashfn!==void 0?(assert$6(toTypeString(j.hashfn)==="Function","Expected options.hashfn to be a Function"),j.xbuf!==void 0&&isUint8Array("options.xbuf",j.xbuf,32),j.ybuf!==void 0&&isUint8Array("options.ybuf",j.ybuf,32),isUint8Array("output",et)):et=getAssertedOutput(et,32),_.ecdh(et,o,$,j.data,j.hashfn,j.xbuf,j.ybuf)){case 0:return et;case 1:throw new Error(errors$1.PUBKEY_PARSE);case 2:throw new Error(errors$1.ECDH)}}});const EC$5=requireElliptic().ec,ec$2=new EC$5("secp256k1"),ecparams=ec$2.curve,BN$2=ecparams.n.constructor;function loadCompressedPublicKey(_,o){let $=new BN$2(o);if($.cmp(ecparams.p)>=0)return null;$=$.toRed(ecparams.red);let j=$.redSqr().redIMul($).redIAdd(ecparams.b).redSqrt();return _===3!==j.isOdd()&&(j=j.redNeg()),ec$2.keyPair({pub:{x:$,y:j}})}function loadUncompressedPublicKey(_,o,$){let j=new BN$2(o),et=new BN$2($);if(j.cmp(ecparams.p)>=0||et.cmp(ecparams.p)>=0||(j=j.toRed(ecparams.red),et=et.toRed(ecparams.red),(_===6||_===7)&&et.isOdd()!==(_===7)))return null;const tt=j.redSqr().redIMul(j);return et.redSqr().redISub(tt.redIAdd(ecparams.b)).isZero()?ec$2.keyPair({pub:{x:j,y:et}}):null}function loadPublicKey(_){const o=_[0];switch(o){case 2:case 3:return _.length!==33?null:loadCompressedPublicKey(o,_.subarray(1,33));case 4:case 6:case 7:return _.length!==65?null:loadUncompressedPublicKey(o,_.subarray(1,33),_.subarray(33,65));default:return null}}function savePublicKey(_,o){const $=o.encode(null,_.length===33);for(let j=0;j<_.length;++j)_[j]=$[j]}var elliptic$2={contextRandomize(){return 0},privateKeyVerify(_){const o=new BN$2(_);return o.cmp(ecparams.n)<0&&!o.isZero()?0:1},privateKeyNegate(_){const o=new BN$2(_),$=ecparams.n.sub(o).umod(ecparams.n).toArrayLike(Uint8Array,"be",32);return _.set($),0},privateKeyTweakAdd(_,o){const $=new BN$2(o);if($.cmp(ecparams.n)>=0||($.iadd(new BN$2(_)),$.cmp(ecparams.n)>=0&&$.isub(ecparams.n),$.isZero()))return 1;const j=$.toArrayLike(Uint8Array,"be",32);return _.set(j),0},privateKeyTweakMul(_,o){let $=new BN$2(o);if($.cmp(ecparams.n)>=0||$.isZero())return 1;$.imul(new BN$2(_)),$.cmp(ecparams.n)>=0&&($=$.umod(ecparams.n));const j=$.toArrayLike(Uint8Array,"be",32);return _.set(j),0},publicKeyVerify(_){return loadPublicKey(_)===null?1:0},publicKeyCreate(_,o){const $=new BN$2(o);if($.cmp(ecparams.n)>=0||$.isZero())return 1;const j=ec$2.keyFromPrivate(o).getPublic();return savePublicKey(_,j),0},publicKeyConvert(_,o){const $=loadPublicKey(o);if($===null)return 1;const j=$.getPublic();return savePublicKey(_,j),0},publicKeyNegate(_,o){const $=loadPublicKey(o);if($===null)return 1;const j=$.getPublic();return j.y=j.y.redNeg(),savePublicKey(_,j),0},publicKeyCombine(_,o){const $=new Array(o.length);for(let et=0;et<o.length;++et)if($[et]=loadPublicKey(o[et]),$[et]===null)return 1;let j=$[0].getPublic();for(let et=1;et<$.length;++et)j=j.add($[et].pub);return j.isInfinity()?2:(savePublicKey(_,j),0)},publicKeyTweakAdd(_,o,$){const j=loadPublicKey(o);if(j===null)return 1;if($=new BN$2($),$.cmp(ecparams.n)>=0)return 2;const et=j.getPublic().add(ecparams.g.mul($));return et.isInfinity()?2:(savePublicKey(_,et),0)},publicKeyTweakMul(_,o,$){const j=loadPublicKey(o);if(j===null)return 1;if($=new BN$2($),$.cmp(ecparams.n)>=0||$.isZero())return 2;const et=j.getPublic().mul($);return savePublicKey(_,et),0},signatureNormalize(_){const o=new BN$2(_.subarray(0,32)),$=new BN$2(_.subarray(32,64));return o.cmp(ecparams.n)>=0||$.cmp(ecparams.n)>=0?1:($.cmp(ec$2.nh)===1&&_.set(ecparams.n.sub($).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(_,o){const $=o.subarray(0,32),j=o.subarray(32,64);if(new BN$2($).cmp(ecparams.n)>=0||new BN$2(j).cmp(ecparams.n)>=0)return 1;const{output:et}=_;let tt=et.subarray(4,4+33);tt[0]=0,tt.set($,1);let rt=33,nt=0;for(;rt>1&&tt[nt]===0&&!(tt[nt+1]&128);--rt,++nt);if(tt=tt.subarray(nt),tt[0]&128||rt>1&&tt[0]===0&&!(tt[1]&128))return 1;let it=et.subarray(6+33,6+33+33);it[0]=0,it.set(j,1);let st=33,ot=0;for(;st>1&&it[ot]===0&&!(it[ot+1]&128);--st,++ot);return it=it.subarray(ot),it[0]&128||st>1&&it[0]===0&&!(it[1]&128)?1:(_.outputlen=6+rt+st,et[0]=48,et[1]=_.outputlen-2,et[2]=2,et[3]=tt.length,et.set(tt,4),et[4+rt]=2,et[5+rt]=it.length,et.set(it,6+rt),0)},signatureImport(_,o){if(o.length<8||o.length>72||o[0]!==48||o[1]!==o.length-2||o[2]!==2)return 1;const $=o[3];if($===0||5+$>=o.length||o[4+$]!==2)return 1;const j=o[5+$];if(j===0||6+$+j!==o.length||o[4]&128||$>1&&o[4]===0&&!(o[5]&128)||o[$+6]&128||j>1&&o[$+6]===0&&!(o[$+7]&128))return 1;let et=o.subarray(4,4+$);if(et.length===33&&et[0]===0&&(et=et.subarray(1)),et.length>32)return 1;let tt=o.subarray(6+$);if(tt.length===33&&tt[0]===0&&(tt=tt.slice(1)),tt.length>32)throw new Error("S length is too long");let rt=new BN$2(et);rt.cmp(ecparams.n)>=0&&(rt=new BN$2(0));let nt=new BN$2(o.subarray(6+$));return nt.cmp(ecparams.n)>=0&&(nt=new BN$2(0)),_.set(rt.toArrayLike(Uint8Array,"be",32),0),_.set(nt.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(_,o,$,j,et){if(et){const nt=et;et=it=>{const st=nt(o,$,null,j,it);if(!(st instanceof Uint8Array&&st.length===32))throw new Error("This is the way");return new BN$2(st)}}const tt=new BN$2($);if(tt.cmp(ecparams.n)>=0||tt.isZero())return 1;let rt;try{rt=ec$2.sign(o,$,{canonical:!0,k:et,pers:j})}catch{return 1}return _.signature.set(rt.r.toArrayLike(Uint8Array,"be",32),0),_.signature.set(rt.s.toArrayLike(Uint8Array,"be",32),32),_.recid=rt.recoveryParam,0},ecdsaVerify(_,o,$){const j={r:_.subarray(0,32),s:_.subarray(32,64)},et=new BN$2(j.r),tt=new BN$2(j.s);if(et.cmp(ecparams.n)>=0||tt.cmp(ecparams.n)>=0)return 1;if(tt.cmp(ec$2.nh)===1||et.isZero()||tt.isZero())return 3;const rt=loadPublicKey($);if(rt===null)return 2;const nt=rt.getPublic();return ec$2.verify(o,j,nt)?0:3},ecdsaRecover(_,o,$,j){const et={r:o.slice(0,32),s:o.slice(32,64)},tt=new BN$2(et.r),rt=new BN$2(et.s);if(tt.cmp(ecparams.n)>=0||rt.cmp(ecparams.n)>=0)return 1;if(tt.isZero()||rt.isZero())return 2;let nt;try{nt=ec$2.recoverPubKey(j,et,$)}catch{return 2}return savePublicKey(_,nt),0},ecdh(_,o,$,j,et,tt,rt){const nt=loadPublicKey(o);if(nt===null)return 1;const it=new BN$2($);if(it.cmp(ecparams.n)>=0||it.isZero())return 2;const st=nt.getPublic().mul(it);if(et===void 0){const ot=st.encode(null,!0),at=ec$2.hash().update(ot).digest();for(let ct=0;ct<32;++ct)_[ct]=at[ct]}else{tt||(tt=new Uint8Array(32));const ot=st.getX().toArray("be",32);for(let ft=0;ft<32;++ft)tt[ft]=ot[ft];rt||(rt=new Uint8Array(32));const at=st.getY().toArray("be",32);for(let ft=0;ft<32;++ft)rt[ft]=at[ft];const ct=et(tt,rt,j);if(!(ct instanceof Uint8Array&&ct.length===_.length))return 2;_.set(ct)}return 0}},elliptic$1=lib(elliptic$2),events$1=eventsExports,inherits=inherits_browserExports,lru=LRU;function LRU(_){if(!(this instanceof LRU))return new LRU(_);typeof _=="number"&&(_={max:_}),_||(_={}),events$1.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=_.max||1e3,this.maxAge=_.maxAge||0}inherits(LRU,events$1.EventEmitter);Object.defineProperty(LRU.prototype,"keys",{get:function(){return Object.keys(this.cache)}});LRU.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0};LRU.prototype.remove=function(_){if(typeof _!="string"&&(_=""+_),!!this.cache.hasOwnProperty(_)){var o=this.cache[_];return delete this.cache[_],this._unlink(_,o.prev,o.next),o.value}};LRU.prototype._unlink=function(_,o,$){this.length--,this.length===0?this.head=this.tail=null:this.head===_?(this.head=o,this.cache[this.head].next=null):this.tail===_?(this.tail=$,this.cache[this.tail].prev=null):(this.cache[o].next=$,this.cache[$].prev=o)};LRU.prototype.peek=function(_){if(this.cache.hasOwnProperty(_)){var o=this.cache[_];if(this._checkAge(_,o))return o.value}};LRU.prototype.set=function(_,o){typeof _!="string"&&(_=""+_);var $;if(this.cache.hasOwnProperty(_)){if($=this.cache[_],$.value=o,this.maxAge&&($.modified=Date.now()),_===this.head)return o;this._unlink(_,$.prev,$.next)}else $={value:o,modified:0,next:null,prev:null},this.maxAge&&($.modified=Date.now()),this.cache[_]=$,this.length===this.max&&this.evict();return this.length++,$.next=null,$.prev=this.head,this.head&&(this.cache[this.head].next=_),this.head=_,this.tail||(this.tail=_),o};LRU.prototype._checkAge=function(_,o){return this.maxAge&&Date.now()-o.modified>this.maxAge?(this.remove(_),this.emit("evict",{key:_,value:o.value}),!1):!0};LRU.prototype.get=function(_){if(typeof _!="string"&&(_=""+_),!!this.cache.hasOwnProperty(_)){var o=this.cache[_];if(this._checkAge(_,o))return this.head!==_&&(_===this.tail?(this.tail=o.next,this.cache[this.tail].prev=null):this.cache[o.prev].next=o.next,this.cache[o.next].prev=o.prev,this.cache[this.head].next=_,o.prev=this.head,o.next=null,this.head=_),o.value}};LRU.prototype.evict=function(){if(this.tail){var _=this.tail,o=this.remove(this.tail);this.emit("evict",{key:_,value:o})}};var ellipticExports=requireElliptic();const elliptic=getDefaultExportFromCjs(ellipticExports),{ec:EC$4}=elliptic,verify$1=async(_,o,$)=>{if(!_)throw new Error("No signature given");if(!o)throw new Error("Given publicKey was undefined");if(!$)throw new Error("Given input data was undefined");let j=!1;const et=new EC$4("secp256k1"),tt=et.keyPair({pub:o,pubEnc:"hex"});try{j=et.verify($,_,tt)}catch{}return Promise.resolve(j)},v0=Object.freeze(Object.defineProperty({__proto__:null,verify:verify$1},Symbol.toStringTag,{value:"Module"})),unmarshal$2=supportedKeys.secp256k1.unmarshalSecp256k1PublicKey,verify=async(_,o,$)=>{if(!_)throw new Error("No signature given");if(!o)throw new Error("Given publicKey was undefined");if(!$)throw new Error("Given input data was undefined");safeBufferExports.Buffer.isBuffer($)||($=safeBufferExports.Buffer.from($));const j=(tt,rt,nt)=>tt.verify(rt,nt);let et=!1;try{const tt=unmarshal$2(safeBufferExports.Buffer.from(o,"hex"));et=await j(tt,$,safeBufferExports.Buffer.from(_,"hex"))}catch{}return Promise.resolve(et)},v1=Object.freeze(Object.defineProperty({__proto__:null,verify},Symbol.toStringTag,{value:"Module"})),verifiers$1={v0,v1},verifier=_=>verifiers$1[_],{ec:EC$3}=elliptic,ec$1=new EC$3("secp256k1"),unmarshal$1=supportedKeys.secp256k1.unmarshalSecp256k1PrivateKey;function createStore(_="./keystore"){return new Level(_,{})}const verifiedCache=new lru(1e3);class Keystore{constructor(o={}){typeof o=="string"?this._store=createStore(o):typeof o.open=="function"?this._store=o:typeof o.store=="string"?this._store=createStore(o.store):this._store=o.store||createStore(),this._cache=o.cache||new lru(100)}async open(){if(!this._store)throw new Error("Keystore: No store found to open");await this._store.open()}async close(){this._store&&await this._store.close()}async hasKey(o){if(!o)throw new Error("id needed to check a key");if(this._store.status&&this._store.status!=="open")return null;let $=!1;try{const j=this._cache.get(o)||await this._store.get(o);$=j!=null}catch{console.error("Error: ENOENT: no such file or directory")}return $}async createKey(o,{entropy:$}={}){if(!o)throw new Error("id needed to create a key");if(this._store.status&&this._store.status!=="open")return null;const j=ec$1.genKeyPair({entropy:$}).getPrivate().toArrayLike(safeBufferExports.Buffer),et=safeBufferExports.Buffer.alloc(32);j.copy(et,et.length-j.length);const tt=await unmarshal$1(et),rt=tt.public.marshal(),nt=elliptic$1.publicKeyConvert(safeBufferExports.Buffer.from(rt),!1),it={publicKey:safeBufferExports.Buffer.from(nt).toString("hex"),privateKey:safeBufferExports.Buffer.from(tt.marshal()).toString("hex")};try{await this._store.put(o,JSON.stringify(it))}catch(st){console.log(st)}return this._cache.set(o,it),tt}async getKey(o){if(!o)throw new Error("id needed to get a key");if(this._store||await this.open(),this._store.status&&this._store.status!=="open")return null;const $=this._cache.get(o);let j;try{j=$||await this._store.get(o)}catch{}if(!j)return;const et=$||JSON.parse(j);if(et)return $||this._cache.set(o,et),unmarshal$1(safeBufferExports.Buffer.from(et.privateKey,"hex"))}async sign(o,$){if(!o)throw new Error("No signing key given");if(!$)throw new Error("Given input data was undefined");return safeBufferExports.Buffer.isBuffer($)||($=safeBufferExports.Buffer.from($)),safeBufferExports.Buffer.from(await o.sign($)).toString("hex")}getPublic(o,$={}){const j=["hex","buffer"],et=typeof $.decompress>"u"?!0:$.decompress,tt=$.format||"hex";if(j.indexOf(tt)===-1)throw new Error("Supported formats are `hex` and `buffer`");let rt=o.public.marshal();return et&&(rt=elliptic$1.publicKeyConvert(safeBufferExports.Buffer.from(rt),!1)),rt=safeBufferExports.Buffer.from(rt),tt==="buffer"?rt:rt.toString("hex")}async verify(o,$,j,et="v1"){return Keystore.verify(o,$,j,et)}static async verify(o,$,j,et="v1"){const tt=verifiedCache.get(o);let rt=!1;if(tt){const nt=(it,st,ot)=>{let at;return ot==="v0"?at=safeBufferExports.Buffer.compare(safeBufferExports.Buffer.alloc(30,it),safeBufferExports.Buffer.alloc(30,st))===0:at=safeBufferExports.Buffer.isBuffer(st)?safeBufferExports.Buffer.compare(it,st)===0:it===st,at};rt=tt.publicKey===$&&nt(tt.data,j,et)}else{const nt=await verifier(et).verify(o,$,j);rt=nt,nt&&verifiedCache.set(o,{publicKey:$,data:j})}return rt}}const isDefined$1=_=>_!=null;class Identity{constructor(o,$,j,et,tt,rt){if(!isDefined$1(o))throw new Error("Identity id is required");if(!isDefined$1($))throw new Error("Invalid public key");if(!isDefined$1(j))throw new Error("Signature of the id (idSignature) is required");if(!isDefined$1(et))throw new Error("Signature of (publicKey + idSignature) is required");if(!isDefined$1(tt))throw new Error("Identity type is required");if(!isDefined$1(rt))throw new Error("Identity provider is required");this._id=o,this._publicKey=$,this._signatures=Object.assign({},{id:j},{publicKey:et}),this._type=tt,this._provider=rt}get id(){return this._id}get publicKey(){return this._publicKey}get signatures(){return this._signatures}get type(){return this._type}get provider(){return this._provider}toJSON(){return{id:this.id,publicKey:this.publicKey,signatures:this.signatures,type:this.type}}static isIdentity(o){return o.id!==void 0&&o.publicKey!==void 0&&o.signatures!==void 0&&o.signatures.id!==void 0&&o.signatures.publicKey!==void 0&&o.type!==void 0}static toJSON(o){return{id:o.id,publicKey:o.publicKey,signatures:o.signatures,type:o.type}}}class IdentityProvider{async getId(o){}async signIdentity(o,$){}static async verifyIdentity(o){}static get type(){throw new Error("'static get type ()' needs to be defined in the inheriting class")}get type(){return this.constructor.type}}const type$4="orbitdb";class OrbitDBIdentityProvider extends IdentityProvider{constructor(o){if(super(),!o)throw new Error("OrbitDBIdentityProvider requires a keystore");this._keystore=o}static get type(){return type$4}async getId(o={}){const $=o.id;if(!$)throw new Error("id is required");const j=this._keystore,et=await j.getKey($)||await j.createKey($);return buffer$2.Buffer.from(et.public.marshal()).toString("hex")}async signIdentity(o,$={}){const j=$.id;if(!j)throw new Error("id is required");const et=this._keystore,tt=await et.getKey(j);if(!tt)throw new Error(`Signing key for '${j}' not found`);return et.sign(tt,o)}static async verifyIdentity(o){return Keystore.verify(o.signatures.publicKey,o.id,o.publicKey+o.signatures.id)}}function compare$1(_,o){for(let $=0;$<_.byteLength;$++){if(_[$]<o[$])return-1;if(_[$]>o[$])return 1}return _.byteLength>o.byteLength?1:_.byteLength<o.byteLength?-1:0}function xor(_,o){if(_.length!==o.length)throw new Error("Inputs should have the same length");const $=allocUnsafe$5(_.length);for(let j=0;j<_.length;j++)$[j]=_[j]^o[j];return asUint8Array$2($)}function _catch(_,o){try{var $=_()}catch(j){return o(j)}return $&&$.then?$.then(void 0,o):$}function inMemoryCache(){const _=new Map;return function(o,$){try{let et=function(rt){if(j)return rt;const nt=_.get(o.didUrl);return nt!==void 0?nt:Promise.resolve($()).then(function(it){var st;return((st=it.didResolutionMetadata)==null?void 0:st.error)!=="notFound"&&_.set(o.didUrl,it),it})},j;const tt=function(){if(o.params&&o.params["no-cache"]==="true")return Promise.resolve($()).then(function(rt){return j=1,rt})}();return Promise.resolve(tt&&tt.then?tt.then(et):et(tt))}catch(j){return Promise.reject(j)}}}function noCache(_,o){return o()}const PCT_ENCODED="(?:%[0-9a-fA-F]{2})",ID_CHAR=`(?:[a-zA-Z0-9._-]|${PCT_ENCODED})`,METHOD="([a-z0-9]+)",METHOD_ID=`((?:${ID_CHAR}*:)*(${ID_CHAR}+))`,PARAM_CHAR="[a-zA-Z0-9_.:%-]",PARAM=`;${PARAM_CHAR}+=${PARAM_CHAR}*`,PARAMS=`((${PARAM})*)`,PATH$1="(/[^#?]*)?",QUERY="([?][^#]*)?",FRAGMENT="(#.*)?",DID_MATCHER=new RegExp(`^did:${METHOD}:${METHOD_ID}${PARAMS}${PATH$1}${QUERY}${FRAGMENT}$`);function parse$6(_){if(_===""||!_)return null;const o=_.match(DID_MATCHER);if(o){const $={did:`did:${o[1]}:${o[2]}`,method:o[1],id:o[2],didUrl:_};if(o[4]){const j=o[4].slice(1).split(";");$.params={};for(const et of j){const tt=et.split("=");$.params[tt[0]]=tt[1]}}return o[6]&&($.path=o[6]),o[7]&&($.query=o[7].slice(1)),o[8]&&($.fragment=o[8].slice(1)),$}return null}const EMPTY_RESULT={didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};function wrapLegacyResolver(_){return function(o,$,j){try{return Promise.resolve(_catch(function(){return Promise.resolve(_(o,$,j)).then(function(et){return{...EMPTY_RESULT,didResolutionMetadata:{contentType:"application/did+ld+json"},didDocument:et}})},function(et){return{...EMPTY_RESULT,didResolutionMetadata:{error:"notFound",message:et.toString()}}}))}catch(et){return Promise.reject(et)}}}let Resolver$1=class{constructor(o={},$={}){this.registry=void 0,this.cache=void 0,this.registry=o,this.cache=$.cache===!0?inMemoryCache():$.cache||noCache,$.legacyResolvers&&Object.keys($.legacyResolvers).map(j=>{this.registry[j]||(this.registry[j]=wrapLegacyResolver($.legacyResolvers[j]))})}resolve(o,$={}){try{const j=this,et=parse$6(o);if(et===null)return Promise.resolve({...EMPTY_RESULT,didResolutionMetadata:{error:"invalidDid"}});const tt=j.registry[et.method];return tt?Promise.resolve(j.cache(et,()=>tt(et.did,et,j,$))):Promise.resolve({...EMPTY_RESULT,didResolutionMetadata:{error:"unsupportedDidMethod"}})}catch(j){return Promise.reject(j)}}};function asUint8Array$1(_){return globalThis.Buffer!=null?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_}function allocUnsafe$4(_=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array$1(globalThis.Buffer.allocUnsafe(_)):new Uint8Array(_)}function concat$1(_,o){o||(o=_.reduce((et,tt)=>et+tt.length,0));const $=allocUnsafe$4(o);let j=0;for(const et of _)$.set(et,j),j+=et.length;return asUint8Array$1($)}function base$5(_,o){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var et=0;et<_.length;et++){var tt=_.charAt(et),rt=tt.charCodeAt(0);if($[rt]!==255)throw new TypeError(tt+" is ambiguous");$[rt]=et}var nt=_.length,it=_.charAt(0),st=Math.log(nt)/Math.log(256),ot=Math.log(256)/Math.log(nt);function at(ft){if(ft instanceof Uint8Array||(ArrayBuffer.isView(ft)?ft=new Uint8Array(ft.buffer,ft.byteOffset,ft.byteLength):Array.isArray(ft)&&(ft=Uint8Array.from(ft))),!(ft instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ft.length===0)return"";for(var ht=0,mt=0,gt=0,Et=ft.length;gt!==Et&&ft[gt]===0;)gt++,ht++;for(var St=(Et-gt)*ot+1>>>0,At=new Uint8Array(St);gt!==Et;){for(var kt=ft[gt],Rt=0,Tt=St-1;(kt!==0||Rt<mt)&&Tt!==-1;Tt--,Rt++)kt+=256*At[Tt]>>>0,At[Tt]=kt%nt>>>0,kt=kt/nt>>>0;if(kt!==0)throw new Error("Non-zero carry");mt=Rt,gt++}for(var Dt=St-mt;Dt!==St&&At[Dt]===0;)Dt++;for(var Ot=it.repeat(ht);Dt<St;++Dt)Ot+=_.charAt(At[Dt]);return Ot}function ct(ft){if(typeof ft!="string")throw new TypeError("Expected String");if(ft.length===0)return new Uint8Array;var ht=0;if(ft[ht]!==" "){for(var mt=0,gt=0;ft[ht]===it;)mt++,ht++;for(var Et=(ft.length-ht)*st+1>>>0,St=new Uint8Array(Et);ft[ht];){var At=$[ft.charCodeAt(ht)];if(At===255)return;for(var kt=0,Rt=Et-1;(At!==0||kt<gt)&&Rt!==-1;Rt--,kt++)At+=nt*St[Rt]>>>0,St[Rt]=At%256>>>0,At=At/256>>>0;if(At!==0)throw new Error("Non-zero carry");gt=kt,ht++}if(ft[ht]!==" "){for(var Tt=Et-gt;Tt!==Et&&St[Tt]===0;)Tt++;for(var Dt=new Uint8Array(mt+(Et-Tt)),Ot=mt;Tt!==Et;)Dt[Ot++]=St[Tt++];return Dt}}}function ut(ft){var ht=ct(ft);if(ht)return ht;throw new Error(`Non-${o} character`)}return{encode:at,decodeUnsafe:ct,decode:ut}}var src$7=base$5,_brrp__multiformats_scope_baseX$3=src$7;const coerce$3=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},fromString$7=_=>new TextEncoder().encode(_),toString$9=_=>new TextDecoder().decode(_);let Encoder$5=class{constructor(o,$,j){this.name=o,this.prefix=$,this.baseEncode=j}encode(o){if(o instanceof Uint8Array)return`${this.prefix}${this.baseEncode(o)}`;throw Error("Unknown type, must be binary type")}},Decoder$5=class{constructor(o,$,j){if(this.name=o,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(o){if(typeof o=="string"){if(o.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(o)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(o.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(o){return or$4(this,o)}},ComposedDecoder$3=class{constructor(o){this.decoders=o}or(o){return or$4(this,o)}decode(o){const $=o[0],j=this.decoders[$];if(j)return j.decode(o);throw RangeError(`Unable to decode multibase string ${JSON.stringify(o)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$4=(_,o)=>new ComposedDecoder$3({..._.decoders||{[_.prefix]:_},...o.decoders||{[o.prefix]:o}});let Codec$3=class{constructor(o,$,j,et){this.name=o,this.prefix=$,this.baseEncode=j,this.baseDecode=et,this.encoder=new Encoder$5(o,$,j),this.decoder=new Decoder$5(o,$,et)}encode(o){return this.encoder.encode(o)}decode(o){return this.decoder.decode(o)}};const from$5=({name:_,prefix:o,encode:$,decode:j})=>new Codec$3(_,o,$,j),baseX$3=({prefix:_,name:o,alphabet:$})=>{const{encode:j,decode:et}=_brrp__multiformats_scope_baseX$3($,o);return from$5({prefix:_,name:o,encode:j,decode:tt=>coerce$3(et(tt))})},decode$s=(_,o,$,j)=>{const et={};for(let ot=0;ot<o.length;++ot)et[o[ot]]=ot;let tt=_.length;for(;_[tt-1]==="=";)--tt;const rt=new Uint8Array(tt*$/8|0);let nt=0,it=0,st=0;for(let ot=0;ot<tt;++ot){const at=et[_[ot]];if(at===void 0)throw new SyntaxError(`Non-${j} character`);it=it<<$|at,nt+=$,nt>=8&&(nt-=8,rt[st++]=255&it>>nt)}if(nt>=$||255&it<<8-nt)throw new SyntaxError("Unexpected end of data");return rt},encode$u=(_,o,$)=>{const j=o[o.length-1]==="=",et=(1<<$)-1;let tt="",rt=0,nt=0;for(let it=0;it<_.length;++it)for(nt=nt<<8|_[it],rt+=8;rt>$;)rt-=$,tt+=o[et&nt>>rt];if(rt&&(tt+=o[et&nt<<$-rt]),j)for(;tt.length*$&7;)tt+="=";return tt},rfc4648$3=({name:_,prefix:o,bitsPerChar:$,alphabet:j})=>from$5({prefix:o,name:_,encode(et){return encode$u(et,j,$)},decode(et){return decode$s(et,j,$,_)}}),identity$2=from$5({prefix:"\0",name:"identity",encode:_=>toString$9(_),decode:_=>fromString$7(_)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$2},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$3({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$3({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),base10$2=baseX$3({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$3({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$3({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base32$4=rfc4648$3({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$3({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$3({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$3({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$3({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$3({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$3({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$3({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$1=rfc4648$3({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$5=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$4,base32hex:base32hex$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32hexupper:base32hexupper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32upper:base32upper$1,base32z:base32z$1},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$3({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$3({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base58btc$3=baseX$3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$3,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"})),base64$2=rfc4648$3({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$3({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$3({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$3({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$3=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$2,base64pad:base64pad$1,base64url:base64url$1,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from(""),alphabetBytesToChars$1=alphabet$2.reduce((_,o,$)=>(_[$]=o,_),[]),alphabetCharsToBytes$1=alphabet$2.reduce((_,o,$)=>(_[o.codePointAt(0)]=$,_),[]);function encode$t(_){return _.reduce((o,$)=>(o+=alphabetBytesToChars$1[$],o),"")}function decode$r(_){const o=[];for(const $ of _){const j=alphabetCharsToBytes$1[$.codePointAt(0)];if(j===void 0)throw new Error(`Non-base256emoji character: ${$}`);o.push(j)}return new Uint8Array(o)}const base256emoji$2=from$5({prefix:"",name:"base256emoji",encode:encode$t,decode:decode$r}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases$1={...identityBase$1,...base2$3,...base8$3,...base10$3,...base16$3,...base32$5,...base36$3,...base58$1,...base64$3,...base256emoji$3};function createCodec$4(_,o,$,j){return{name:_,prefix:o,encoder:{name:_,prefix:o,encode:$},decoder:{decode:j}}}const string$1=createCodec$4("utf8","u",_=>"u"+new TextDecoder("utf8").decode(_),_=>new TextEncoder().encode(_.substring(1))),ascii$2=createCodec$4("ascii","a",_=>{let o="a";for(let $=0;$<_.length;$++)o+=String.fromCharCode(_[$]);return o},_=>{_=_.substring(1);const o=allocUnsafe$4(_.length);for(let $=0;$<_.length;$++)o[$]=_.charCodeAt($);return o}),BASES$1={utf8:string$1,"utf-8":string$1,hex:bases$1.base16,latin1:ascii$2,ascii:ascii$2,binary:ascii$2,...bases$1};function fromString$6(_,o="utf8"){const $=BASES$1[o];if(!$)throw new Error(`Unsupported encoding "${o}"`);return(o==="utf8"||o==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$1(globalThis.Buffer.from(_,"utf-8")):$.decoder.decode(`${$.prefix}${_}`)}function toString$8(_,o="utf8"){const $=BASES$1[o];if(!$)throw new Error(`Unsupported encoding "${o}"`);return(o==="utf8"||o==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(_.buffer,_.byteOffset,_.byteLength).toString("utf8"):$.encoder.encode(_).substring(1)}var sha256$4={},binary={},int={};(function(_){Object.defineProperty(_,"__esModule",{value:!0});function o(nt,it){var st=nt>>>16&65535,ot=nt&65535,at=it>>>16&65535,ct=it&65535;return ot*ct+(st*ct+ot*at<<16>>>0)|0}_.mul=Math.imul||o;function $(nt,it){return nt+it|0}_.add=$;function j(nt,it){return nt-it|0}_.sub=j;function et(nt,it){return nt<<it|nt>>>32-it}_.rotl=et;function tt(nt,it){return nt<<32-it|nt>>>it}_.rotr=tt;function rt(nt){return typeof nt=="number"&&isFinite(nt)&&Math.floor(nt)===nt}_.isInteger=Number.isInteger||rt,_.MAX_SAFE_INTEGER=9007199254740991,_.isSafeInteger=function(nt){return _.isInteger(nt)&&nt>=-_.MAX_SAFE_INTEGER&&nt<=_.MAX_SAFE_INTEGER}})(int);Object.defineProperty(binary,"__esModule",{value:!0});var int_1=int;function readInt16BE(_,o){return o===void 0&&(o=0),(_[o+0]<<8|_[o+1])<<16>>16}binary.readInt16BE=readInt16BE;function readUint16BE(_,o){return o===void 0&&(o=0),(_[o+0]<<8|_[o+1])>>>0}binary.readUint16BE=readUint16BE;function readInt16LE(_,o){return o===void 0&&(o=0),(_[o+1]<<8|_[o])<<16>>16}binary.readInt16LE=readInt16LE;function readUint16LE(_,o){return o===void 0&&(o=0),(_[o+1]<<8|_[o])>>>0}binary.readUint16LE=readUint16LE;function writeUint16BE(_,o,$){return o===void 0&&(o=new Uint8Array(2)),$===void 0&&($=0),o[$+0]=_>>>8,o[$+1]=_>>>0,o}binary.writeUint16BE=writeUint16BE;binary.writeInt16BE=writeUint16BE;function writeUint16LE(_,o,$){return o===void 0&&(o=new Uint8Array(2)),$===void 0&&($=0),o[$+0]=_>>>0,o[$+1]=_>>>8,o}binary.writeUint16LE=writeUint16LE;binary.writeInt16LE=writeUint16LE;function readInt32BE(_,o){return o===void 0&&(o=0),_[o]<<24|_[o+1]<<16|_[o+2]<<8|_[o+3]}binary.readInt32BE=readInt32BE;function readUint32BE(_,o){return o===void 0&&(o=0),(_[o]<<24|_[o+1]<<16|_[o+2]<<8|_[o+3])>>>0}binary.readUint32BE=readUint32BE;function readInt32LE(_,o){return o===void 0&&(o=0),_[o+3]<<24|_[o+2]<<16|_[o+1]<<8|_[o]}binary.readInt32LE=readInt32LE;function readUint32LE(_,o){return o===void 0&&(o=0),(_[o+3]<<24|_[o+2]<<16|_[o+1]<<8|_[o])>>>0}binary.readUint32LE=readUint32LE;function writeUint32BE$1(_,o,$){return o===void 0&&(o=new Uint8Array(4)),$===void 0&&($=0),o[$+0]=_>>>24,o[$+1]=_>>>16,o[$+2]=_>>>8,o[$+3]=_>>>0,o}binary.writeUint32BE=writeUint32BE$1;binary.writeInt32BE=writeUint32BE$1;function writeUint32LE(_,o,$){return o===void 0&&(o=new Uint8Array(4)),$===void 0&&($=0),o[$+0]=_>>>0,o[$+1]=_>>>8,o[$+2]=_>>>16,o[$+3]=_>>>24,o}binary.writeUint32LE=writeUint32LE;binary.writeInt32LE=writeUint32LE;function readInt64BE(_,o){o===void 0&&(o=0);var $=readInt32BE(_,o),j=readInt32BE(_,o+4);return $*4294967296+j-(j>>31)*4294967296}binary.readInt64BE=readInt64BE;function readUint64BE(_,o){o===void 0&&(o=0);var $=readUint32BE(_,o),j=readUint32BE(_,o+4);return $*4294967296+j}binary.readUint64BE=readUint64BE;function readInt64LE(_,o){o===void 0&&(o=0);var $=readInt32LE(_,o),j=readInt32LE(_,o+4);return j*4294967296+$-($>>31)*4294967296}binary.readInt64LE=readInt64LE;function readUint64LE(_,o){o===void 0&&(o=0);var $=readUint32LE(_,o),j=readUint32LE(_,o+4);return j*4294967296+$}binary.readUint64LE=readUint64LE;function writeUint64BE(_,o,$){return o===void 0&&(o=new Uint8Array(8)),$===void 0&&($=0),writeUint32BE$1(_/4294967296>>>0,o,$),writeUint32BE$1(_>>>0,o,$+4),o}binary.writeUint64BE=writeUint64BE;binary.writeInt64BE=writeUint64BE;function writeUint64LE(_,o,$){return o===void 0&&(o=new Uint8Array(8)),$===void 0&&($=0),writeUint32LE(_>>>0,o,$),writeUint32LE(_/4294967296>>>0,o,$+4),o}binary.writeUint64LE=writeUint64LE;binary.writeInt64LE=writeUint64LE;function readUintBE(_,o,$){if($===void 0&&($=0),_%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(_/8>o.length-$)throw new Error("readUintBE: array is too short for the given bitLength");for(var j=0,et=1,tt=_/8+$-1;tt>=$;tt--)j+=o[tt]*et,et*=256;return j}binary.readUintBE=readUintBE;function readUintLE(_,o,$){if($===void 0&&($=0),_%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(_/8>o.length-$)throw new Error("readUintLE: array is too short for the given bitLength");for(var j=0,et=1,tt=$;tt<$+_/8;tt++)j+=o[tt]*et,et*=256;return j}binary.readUintLE=readUintLE;function writeUintBE(_,o,$,j){if($===void 0&&($=new Uint8Array(_/8)),j===void 0&&(j=0),_%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!int_1.isSafeInteger(o))throw new Error("writeUintBE value must be an integer");for(var et=1,tt=_/8+j-1;tt>=j;tt--)$[tt]=o/et&255,et*=256;return $}binary.writeUintBE=writeUintBE;function writeUintLE(_,o,$,j){if($===void 0&&($=new Uint8Array(_/8)),j===void 0&&(j=0),_%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!int_1.isSafeInteger(o))throw new Error("writeUintLE value must be an integer");for(var et=1,tt=j;tt<j+_/8;tt++)$[tt]=o/et&255,et*=256;return $}binary.writeUintLE=writeUintLE;function readFloat32BE(_,o){o===void 0&&(o=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat32(o)}binary.readFloat32BE=readFloat32BE;function readFloat32LE(_,o){o===void 0&&(o=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat32(o,!0)}binary.readFloat32LE=readFloat32LE;function readFloat64BE(_,o){o===void 0&&(o=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat64(o)}binary.readFloat64BE=readFloat64BE;function readFloat64LE(_,o){o===void 0&&(o=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat64(o,!0)}binary.readFloat64LE=readFloat64LE;function writeFloat32BE(_,o,$){o===void 0&&(o=new Uint8Array(4)),$===void 0&&($=0);var j=new DataView(o.buffer,o.byteOffset,o.byteLength);return j.setFloat32($,_),o}binary.writeFloat32BE=writeFloat32BE;function writeFloat32LE(_,o,$){o===void 0&&(o=new Uint8Array(4)),$===void 0&&($=0);var j=new DataView(o.buffer,o.byteOffset,o.byteLength);return j.setFloat32($,_,!0),o}binary.writeFloat32LE=writeFloat32LE;function writeFloat64BE(_,o,$){o===void 0&&(o=new Uint8Array(8)),$===void 0&&($=0);var j=new DataView(o.buffer,o.byteOffset,o.byteLength);return j.setFloat64($,_),o}binary.writeFloat64BE=writeFloat64BE;function writeFloat64LE(_,o,$){o===void 0&&(o=new Uint8Array(8)),$===void 0&&($=0);var j=new DataView(o.buffer,o.byteOffset,o.byteLength);return j.setFloat64($,_,!0),o}binary.writeFloat64LE=writeFloat64LE;var wipe$1={};Object.defineProperty(wipe$1,"__esModule",{value:!0});function wipe(_){for(var o=0;o<_.length;o++)_[o]=0;return _}wipe$1.wipe=wipe;(function(_){Object.defineProperty(_,"__esModule",{value:!0});var o=binary,$=wipe$1;_.DIGEST_LENGTH=32,_.BLOCK_SIZE=64;var j=function(){function nt(){this.digestLength=_.DIGEST_LENGTH,this.blockSize=_.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return nt.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},nt.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},nt.prototype.clean=function(){$.wipe(this._buffer),$.wipe(this._temp),this.reset()},nt.prototype.update=function(it,st){if(st===void 0&&(st=it.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var ot=0;if(this._bytesHashed+=st,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&st>0;)this._buffer[this._bufferLength++]=it[ot++],st--;this._bufferLength===this.blockSize&&(tt(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(st>=this.blockSize&&(ot=tt(this._temp,this._state,it,ot,st),st%=this.blockSize);st>0;)this._buffer[this._bufferLength++]=it[ot++],st--;return this},nt.prototype.finish=function(it){if(!this._finished){var st=this._bytesHashed,ot=this._bufferLength,at=st/536870912|0,ct=st<<3,ut=st%64<56?64:128;this._buffer[ot]=128;for(var ft=ot+1;ft<ut-8;ft++)this._buffer[ft]=0;o.writeUint32BE(at,this._buffer,ut-8),o.writeUint32BE(ct,this._buffer,ut-4),tt(this._temp,this._state,this._buffer,0,ut),this._finished=!0}for(var ft=0;ft<this.digestLength/4;ft++)o.writeUint32BE(this._state[ft],it,ft*4);return this},nt.prototype.digest=function(){var it=new Uint8Array(this.digestLength);return this.finish(it),it},nt.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},nt.prototype.restoreState=function(it){return this._state.set(it.state),this._bufferLength=it.bufferLength,it.buffer&&this._buffer.set(it.buffer),this._bytesHashed=it.bytesHashed,this._finished=!1,this},nt.prototype.cleanSavedState=function(it){$.wipe(it.state),it.buffer&&$.wipe(it.buffer),it.bufferLength=0,it.bytesHashed=0},nt}();_.SHA256=j;var et=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function tt(nt,it,st,ot,at){for(;at>=64;){for(var ct=it[0],ut=it[1],ft=it[2],ht=it[3],mt=it[4],gt=it[5],Et=it[6],St=it[7],At=0;At<16;At++){var kt=ot+At*4;nt[At]=o.readUint32BE(st,kt)}for(var At=16;At<64;At++){var Rt=nt[At-2],Tt=(Rt>>>17|Rt<<32-17)^(Rt>>>19|Rt<<32-19)^Rt>>>10;Rt=nt[At-15];var Dt=(Rt>>>7|Rt<<32-7)^(Rt>>>18|Rt<<32-18)^Rt>>>3;nt[At]=(Tt+nt[At-7]|0)+(Dt+nt[At-16]|0)}for(var At=0;At<64;At++){var Tt=(((mt>>>6|mt<<26)^(mt>>>11|mt<<21)^(mt>>>25|mt<<7))+(mt&gt^~mt&Et)|0)+(St+(et[At]+nt[At]|0)|0)|0,Dt=((ct>>>2|ct<<32-2)^(ct>>>13|ct<<32-13)^(ct>>>22|ct<<32-22))+(ct&ut^ct&ft^ut&ft)|0;St=Et,Et=gt,gt=mt,mt=ht+Tt|0,ht=ft,ft=ut,ut=ct,ct=Tt+Dt|0}it[0]+=ct,it[1]+=ut,it[2]+=ft,it[3]+=ht,it[4]+=mt,it[5]+=gt,it[6]+=Et,it[7]+=St,ot+=64,at-=64}return ot}function rt(nt){var it=new j;it.update(nt);var st=it.digest();return it.clean(),st}_.hash=rt})(sha256$4);var sha3Exports={},sha3$1={get exports(){return sha3Exports},set exports(_){sha3Exports=_}};(function(_){(function(){var o="input is invalid type",$="finalize already called",j=typeof window=="object",et=j?window:{};et.JS_SHA3_NO_WINDOW&&(j=!1);var tt=!j&&typeof self=="object",rt=!et.JS_SHA3_NO_NODE_JS&&typeof browserExports$3=="object"&&browserExports$3.versions&&browserExports$3.versions.node;rt?et=commonjsGlobal:tt&&(et=self);var nt=!et.JS_SHA3_NO_COMMON_JS&&!0&&_.exports,it=!et.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",st="0123456789abcdef".split(""),ot=[31,7936,2031616,520093696],at=[4,1024,262144,67108864],ct=[1,256,65536,16777216],ut=[6,1536,393216,100663296],ft=[0,8,16,24],ht=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],mt=[224,256,384,512],gt=[128,256],Et=["hex","buffer","arrayBuffer","array","digest"],St={128:168,256:136};(et.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(Pt){return Object.prototype.toString.call(Pt)==="[object Array]"}),it&&(et.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(Pt){return typeof Pt=="object"&&Pt.buffer&&Pt.buffer.constructor===ArrayBuffer});for(var At=function(Pt,Gt,Wt){return function(Vt){return new dt(Pt,Gt,Pt).update(Vt)[Wt]()}},kt=function(Pt,Gt,Wt){return function(Vt,Ut){return new dt(Pt,Gt,Ut).update(Vt)[Wt]()}},Rt=function(Pt,Gt,Wt){return function(Vt,Ut,Mt,Lt){return lt["cshake"+Pt].update(Vt,Ut,Mt,Lt)[Wt]()}},Tt=function(Pt,Gt,Wt){return function(Vt,Ut,Mt,Lt){return lt["kmac"+Pt].update(Vt,Ut,Mt,Lt)[Wt]()}},Dt=function(Pt,Gt,Wt,Vt){for(var Ut=0;Ut<Et.length;++Ut){var Mt=Et[Ut];Pt[Mt]=Gt(Wt,Vt,Mt)}return Pt},Ot=function(Pt,Gt){var Wt=At(Pt,Gt,"hex");return Wt.create=function(){return new dt(Pt,Gt,Pt)},Wt.update=function(Vt){return Wt.create().update(Vt)},Dt(Wt,At,Pt,Gt)},jt=function(Pt,Gt){var Wt=kt(Pt,Gt,"hex");return Wt.create=function(Vt){return new dt(Pt,Gt,Vt)},Wt.update=function(Vt,Ut){return Wt.create(Ut).update(Vt)},Dt(Wt,kt,Pt,Gt)},Nt=function(Pt,Gt){var Wt=St[Pt],Vt=Rt(Pt,Gt,"hex");return Vt.create=function(Ut,Mt,Lt){return!Mt&&!Lt?lt["shake"+Pt].create(Ut):new dt(Pt,Gt,Ut).bytepad([Mt,Lt],Wt)},Vt.update=function(Ut,Mt,Lt,Yt){return Vt.create(Mt,Lt,Yt).update(Ut)},Dt(Vt,Rt,Pt,Gt)},It=function(Pt,Gt){var Wt=St[Pt],Vt=Tt(Pt,Gt,"hex");return Vt.create=function(Ut,Mt,Lt){return new wt(Pt,Gt,Mt).bytepad(["KMAC",Lt],Wt).bytepad([Ut],Wt)},Vt.update=function(Ut,Mt,Lt,Yt){return Vt.create(Ut,Lt,Yt).update(Mt)},Dt(Vt,Tt,Pt,Gt)},yt=[{name:"keccak",padding:ct,bits:mt,createMethod:Ot},{name:"sha3",padding:ut,bits:mt,createMethod:Ot},{name:"shake",padding:ot,bits:gt,createMethod:jt},{name:"cshake",padding:at,bits:gt,createMethod:Nt},{name:"kmac",padding:at,bits:gt,createMethod:It}],lt={},pt=[],bt=0;bt<yt.length;++bt)for(var _t=yt[bt],$t=_t.bits,Ct=0;Ct<$t.length;++Ct){var xt=_t.name+"_"+$t[Ct];if(pt.push(xt),lt[xt]=_t.createMethod($t[Ct],_t.padding),_t.name!=="sha3"){var vt=_t.name+$t[Ct];pt.push(vt),lt[vt]=lt[xt]}}function dt(Pt,Gt,Wt){this.blocks=[],this.s=[],this.padding=Gt,this.outputBits=Wt,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(Pt<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=Wt>>5,this.extraBytes=(Wt&31)>>3;for(var Vt=0;Vt<50;++Vt)this.s[Vt]=0}dt.prototype.update=function(Pt){if(this.finalized)throw new Error($);var Gt,Wt=typeof Pt;if(Wt!=="string"){if(Wt==="object"){if(Pt===null)throw new Error(o);if(it&&Pt.constructor===ArrayBuffer)Pt=new Uint8Array(Pt);else if(!Array.isArray(Pt)&&(!it||!ArrayBuffer.isView(Pt)))throw new Error(o)}else throw new Error(o);Gt=!0}for(var Vt=this.blocks,Ut=this.byteCount,Mt=Pt.length,Lt=this.blockCount,Yt=0,lr=this.s,cr,ir;Yt<Mt;){if(this.reset)for(this.reset=!1,Vt[0]=this.block,cr=1;cr<Lt+1;++cr)Vt[cr]=0;if(Gt)for(cr=this.start;Yt<Mt&&cr<Ut;++Yt)Vt[cr>>2]|=Pt[Yt]<<ft[cr++&3];else for(cr=this.start;Yt<Mt&&cr<Ut;++Yt)ir=Pt.charCodeAt(Yt),ir<128?Vt[cr>>2]|=ir<<ft[cr++&3]:ir<2048?(Vt[cr>>2]|=(192|ir>>6)<<ft[cr++&3],Vt[cr>>2]|=(128|ir&63)<<ft[cr++&3]):ir<55296||ir>=57344?(Vt[cr>>2]|=(224|ir>>12)<<ft[cr++&3],Vt[cr>>2]|=(128|ir>>6&63)<<ft[cr++&3],Vt[cr>>2]|=(128|ir&63)<<ft[cr++&3]):(ir=65536+((ir&1023)<<10|Pt.charCodeAt(++Yt)&1023),Vt[cr>>2]|=(240|ir>>18)<<ft[cr++&3],Vt[cr>>2]|=(128|ir>>12&63)<<ft[cr++&3],Vt[cr>>2]|=(128|ir>>6&63)<<ft[cr++&3],Vt[cr>>2]|=(128|ir&63)<<ft[cr++&3]);if(this.lastByteIndex=cr,cr>=Ut){for(this.start=cr-Ut,this.block=Vt[Lt],cr=0;cr<Lt;++cr)lr[cr]^=Vt[cr];qt(lr),this.reset=!0}else this.start=cr}return this},dt.prototype.encode=function(Pt,Gt){var Wt=Pt&255,Vt=1,Ut=[Wt];for(Pt=Pt>>8,Wt=Pt&255;Wt>0;)Ut.unshift(Wt),Pt=Pt>>8,Wt=Pt&255,++Vt;return Gt?Ut.push(Vt):Ut.unshift(Vt),this.update(Ut),Ut.length},dt.prototype.encodeString=function(Pt){var Gt,Wt=typeof Pt;if(Wt!=="string"){if(Wt==="object"){if(Pt===null)throw new Error(o);if(it&&Pt.constructor===ArrayBuffer)Pt=new Uint8Array(Pt);else if(!Array.isArray(Pt)&&(!it||!ArrayBuffer.isView(Pt)))throw new Error(o)}else throw new Error(o);Gt=!0}var Vt=0,Ut=Pt.length;if(Gt)Vt=Ut;else for(var Mt=0;Mt<Pt.length;++Mt){var Lt=Pt.charCodeAt(Mt);Lt<128?Vt+=1:Lt<2048?Vt+=2:Lt<55296||Lt>=57344?Vt+=3:(Lt=65536+((Lt&1023)<<10|Pt.charCodeAt(++Mt)&1023),Vt+=4)}return Vt+=this.encode(Vt*8),this.update(Pt),Vt},dt.prototype.bytepad=function(Pt,Gt){for(var Wt=this.encode(Gt),Vt=0;Vt<Pt.length;++Vt)Wt+=this.encodeString(Pt[Vt]);var Ut=Gt-Wt%Gt,Mt=[];return Mt.length=Ut,this.update(Mt),this},dt.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var Pt=this.blocks,Gt=this.lastByteIndex,Wt=this.blockCount,Vt=this.s;if(Pt[Gt>>2]|=this.padding[Gt&3],this.lastByteIndex===this.byteCount)for(Pt[0]=Pt[Wt],Gt=1;Gt<Wt+1;++Gt)Pt[Gt]=0;for(Pt[Wt-1]|=2147483648,Gt=0;Gt<Wt;++Gt)Vt[Gt]^=Pt[Gt];qt(Vt)}},dt.prototype.toString=dt.prototype.hex=function(){this.finalize();for(var Pt=this.blockCount,Gt=this.s,Wt=this.outputBlocks,Vt=this.extraBytes,Ut=0,Mt=0,Lt="",Yt;Mt<Wt;){for(Ut=0;Ut<Pt&&Mt<Wt;++Ut,++Mt)Yt=Gt[Ut],Lt+=st[Yt>>4&15]+st[Yt&15]+st[Yt>>12&15]+st[Yt>>8&15]+st[Yt>>20&15]+st[Yt>>16&15]+st[Yt>>28&15]+st[Yt>>24&15];Mt%Pt===0&&(qt(Gt),Ut=0)}return Vt&&(Yt=Gt[Ut],Lt+=st[Yt>>4&15]+st[Yt&15],Vt>1&&(Lt+=st[Yt>>12&15]+st[Yt>>8&15]),Vt>2&&(Lt+=st[Yt>>20&15]+st[Yt>>16&15])),Lt},dt.prototype.arrayBuffer=function(){this.finalize();var Pt=this.blockCount,Gt=this.s,Wt=this.outputBlocks,Vt=this.extraBytes,Ut=0,Mt=0,Lt=this.outputBits>>3,Yt;Vt?Yt=new ArrayBuffer(Wt+1<<2):Yt=new ArrayBuffer(Lt);for(var lr=new Uint32Array(Yt);Mt<Wt;){for(Ut=0;Ut<Pt&&Mt<Wt;++Ut,++Mt)lr[Mt]=Gt[Ut];Mt%Pt===0&&qt(Gt)}return Vt&&(lr[Ut]=Gt[Ut],Yt=Yt.slice(0,Lt)),Yt},dt.prototype.buffer=dt.prototype.arrayBuffer,dt.prototype.digest=dt.prototype.array=function(){this.finalize();for(var Pt=this.blockCount,Gt=this.s,Wt=this.outputBlocks,Vt=this.extraBytes,Ut=0,Mt=0,Lt=[],Yt,lr;Mt<Wt;){for(Ut=0;Ut<Pt&&Mt<Wt;++Ut,++Mt)Yt=Mt<<2,lr=Gt[Ut],Lt[Yt]=lr&255,Lt[Yt+1]=lr>>8&255,Lt[Yt+2]=lr>>16&255,Lt[Yt+3]=lr>>24&255;Mt%Pt===0&&qt(Gt)}return Vt&&(Yt=Mt<<2,lr=Gt[Ut],Lt[Yt]=lr&255,Vt>1&&(Lt[Yt+1]=lr>>8&255),Vt>2&&(Lt[Yt+2]=lr>>16&255)),Lt};function wt(Pt,Gt,Wt){dt.call(this,Pt,Gt,Wt)}wt.prototype=new dt,wt.prototype.finalize=function(){return this.encode(this.outputBits,!0),dt.prototype.finalize.call(this)};var qt=function(Pt){var Gt,Wt,Vt,Ut,Mt,Lt,Yt,lr,cr,ir,Zt,Bt,Ft,zt,Qt,nr,gr,br,vr,Nr,ar,er,Xt,tr,ur,pr,yr,wr,Gr,$r,Er,Wr,Vr,Pr,nn,Kr,Dr,Qr,Or,Cr,Zr,Fr,Ar,Xr,Mr,Sr,Jr,Ur,Rr,en,Br,Ir,tn,qr,Lr,sn,Hr,jr,un,dn,fn,an,pn;for(Vt=0;Vt<48;Vt+=2)Ut=Pt[0]^Pt[10]^Pt[20]^Pt[30]^Pt[40],Mt=Pt[1]^Pt[11]^Pt[21]^Pt[31]^Pt[41],Lt=Pt[2]^Pt[12]^Pt[22]^Pt[32]^Pt[42],Yt=Pt[3]^Pt[13]^Pt[23]^Pt[33]^Pt[43],lr=Pt[4]^Pt[14]^Pt[24]^Pt[34]^Pt[44],cr=Pt[5]^Pt[15]^Pt[25]^Pt[35]^Pt[45],ir=Pt[6]^Pt[16]^Pt[26]^Pt[36]^Pt[46],Zt=Pt[7]^Pt[17]^Pt[27]^Pt[37]^Pt[47],Bt=Pt[8]^Pt[18]^Pt[28]^Pt[38]^Pt[48],Ft=Pt[9]^Pt[19]^Pt[29]^Pt[39]^Pt[49],Gt=Bt^(Lt<<1|Yt>>>31),Wt=Ft^(Yt<<1|Lt>>>31),Pt[0]^=Gt,Pt[1]^=Wt,Pt[10]^=Gt,Pt[11]^=Wt,Pt[20]^=Gt,Pt[21]^=Wt,Pt[30]^=Gt,Pt[31]^=Wt,Pt[40]^=Gt,Pt[41]^=Wt,Gt=Ut^(lr<<1|cr>>>31),Wt=Mt^(cr<<1|lr>>>31),Pt[2]^=Gt,Pt[3]^=Wt,Pt[12]^=Gt,Pt[13]^=Wt,Pt[22]^=Gt,Pt[23]^=Wt,Pt[32]^=Gt,Pt[33]^=Wt,Pt[42]^=Gt,Pt[43]^=Wt,Gt=Lt^(ir<<1|Zt>>>31),Wt=Yt^(Zt<<1|ir>>>31),Pt[4]^=Gt,Pt[5]^=Wt,Pt[14]^=Gt,Pt[15]^=Wt,Pt[24]^=Gt,Pt[25]^=Wt,Pt[34]^=Gt,Pt[35]^=Wt,Pt[44]^=Gt,Pt[45]^=Wt,Gt=lr^(Bt<<1|Ft>>>31),Wt=cr^(Ft<<1|Bt>>>31),Pt[6]^=Gt,Pt[7]^=Wt,Pt[16]^=Gt,Pt[17]^=Wt,Pt[26]^=Gt,Pt[27]^=Wt,Pt[36]^=Gt,Pt[37]^=Wt,Pt[46]^=Gt,Pt[47]^=Wt,Gt=ir^(Ut<<1|Mt>>>31),Wt=Zt^(Mt<<1|Ut>>>31),Pt[8]^=Gt,Pt[9]^=Wt,Pt[18]^=Gt,Pt[19]^=Wt,Pt[28]^=Gt,Pt[29]^=Wt,Pt[38]^=Gt,Pt[39]^=Wt,Pt[48]^=Gt,Pt[49]^=Wt,zt=Pt[0],Qt=Pt[1],Sr=Pt[11]<<4|Pt[10]>>>28,Jr=Pt[10]<<4|Pt[11]>>>28,wr=Pt[20]<<3|Pt[21]>>>29,Gr=Pt[21]<<3|Pt[20]>>>29,dn=Pt[31]<<9|Pt[30]>>>23,fn=Pt[30]<<9|Pt[31]>>>23,Fr=Pt[40]<<18|Pt[41]>>>14,Ar=Pt[41]<<18|Pt[40]>>>14,Pr=Pt[2]<<1|Pt[3]>>>31,nn=Pt[3]<<1|Pt[2]>>>31,nr=Pt[13]<<12|Pt[12]>>>20,gr=Pt[12]<<12|Pt[13]>>>20,Ur=Pt[22]<<10|Pt[23]>>>22,Rr=Pt[23]<<10|Pt[22]>>>22,$r=Pt[33]<<13|Pt[32]>>>19,Er=Pt[32]<<13|Pt[33]>>>19,an=Pt[42]<<2|Pt[43]>>>30,pn=Pt[43]<<2|Pt[42]>>>30,qr=Pt[5]<<30|Pt[4]>>>2,Lr=Pt[4]<<30|Pt[5]>>>2,Kr=Pt[14]<<6|Pt[15]>>>26,Dr=Pt[15]<<6|Pt[14]>>>26,br=Pt[25]<<11|Pt[24]>>>21,vr=Pt[24]<<11|Pt[25]>>>21,en=Pt[34]<<15|Pt[35]>>>17,Br=Pt[35]<<15|Pt[34]>>>17,Wr=Pt[45]<<29|Pt[44]>>>3,Vr=Pt[44]<<29|Pt[45]>>>3,tr=Pt[6]<<28|Pt[7]>>>4,ur=Pt[7]<<28|Pt[6]>>>4,sn=Pt[17]<<23|Pt[16]>>>9,Hr=Pt[16]<<23|Pt[17]>>>9,Qr=Pt[26]<<25|Pt[27]>>>7,Or=Pt[27]<<25|Pt[26]>>>7,Nr=Pt[36]<<21|Pt[37]>>>11,ar=Pt[37]<<21|Pt[36]>>>11,Ir=Pt[47]<<24|Pt[46]>>>8,tn=Pt[46]<<24|Pt[47]>>>8,Xr=Pt[8]<<27|Pt[9]>>>5,Mr=Pt[9]<<27|Pt[8]>>>5,pr=Pt[18]<<20|Pt[19]>>>12,yr=Pt[19]<<20|Pt[18]>>>12,jr=Pt[29]<<7|Pt[28]>>>25,un=Pt[28]<<7|Pt[29]>>>25,Cr=Pt[38]<<8|Pt[39]>>>24,Zr=Pt[39]<<8|Pt[38]>>>24,er=Pt[48]<<14|Pt[49]>>>18,Xt=Pt[49]<<14|Pt[48]>>>18,Pt[0]=zt^~nr&br,Pt[1]=Qt^~gr&vr,Pt[10]=tr^~pr&wr,Pt[11]=ur^~yr&Gr,Pt[20]=Pr^~Kr&Qr,Pt[21]=nn^~Dr&Or,Pt[30]=Xr^~Sr&Ur,Pt[31]=Mr^~Jr&Rr,Pt[40]=qr^~sn&jr,Pt[41]=Lr^~Hr&un,Pt[2]=nr^~br&Nr,Pt[3]=gr^~vr&ar,Pt[12]=pr^~wr&$r,Pt[13]=yr^~Gr&Er,Pt[22]=Kr^~Qr&Cr,Pt[23]=Dr^~Or&Zr,Pt[32]=Sr^~Ur&en,Pt[33]=Jr^~Rr&Br,Pt[42]=sn^~jr&dn,Pt[43]=Hr^~un&fn,Pt[4]=br^~Nr&er,Pt[5]=vr^~ar&Xt,Pt[14]=wr^~$r&Wr,Pt[15]=Gr^~Er&Vr,Pt[24]=Qr^~Cr&Fr,Pt[25]=Or^~Zr&Ar,Pt[34]=Ur^~en&Ir,Pt[35]=Rr^~Br&tn,Pt[44]=jr^~dn&an,Pt[45]=un^~fn&pn,Pt[6]=Nr^~er&zt,Pt[7]=ar^~Xt&Qt,Pt[16]=$r^~Wr&tr,Pt[17]=Er^~Vr&ur,Pt[26]=Cr^~Fr&Pr,Pt[27]=Zr^~Ar&nn,Pt[36]=en^~Ir&Xr,Pt[37]=Br^~tn&Mr,Pt[46]=dn^~an&qr,Pt[47]=fn^~pn&Lr,Pt[8]=er^~zt&nr,Pt[9]=Xt^~Qt&gr,Pt[18]=Wr^~tr&pr,Pt[19]=Vr^~ur&yr,Pt[28]=Fr^~Pr&Kr,Pt[29]=Ar^~nn&Dr,Pt[38]=Ir^~Xr&Sr,Pt[39]=tn^~Mr&Jr,Pt[48]=an^~qr&sn,Pt[49]=pn^~Lr&Hr,Pt[0]^=ht[Vt],Pt[1]^=ht[Vt+1]};if(nt)_.exports=lt;else for(bt=0;bt<pt.length;++bt)et[pt[bt]]=lt[pt[bt]]})()})(sha3$1);const sha3=sha3Exports;var ed25519={},random={},system={},browser$4={};Object.defineProperty(browser$4,"__esModule",{value:!0});browser$4.BrowserRandomSource=void 0;const QUOTA=65536;class BrowserRandomSource{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const o=typeof self<"u"?self.crypto||self.msCrypto:null;o&&o.getRandomValues!==void 0&&(this._crypto=o,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(o){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const $=new Uint8Array(o);for(let j=0;j<$.length;j+=QUOTA)this._crypto.getRandomValues($.subarray(j,j+Math.min($.length-j,QUOTA)));return $}}browser$4.BrowserRandomSource=BrowserRandomSource;function commonjsRequire$1(_){throw new Error('Could not dynamically require "'+_+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var node={};Object.defineProperty(node,"__esModule",{value:!0});node.NodeRandomSource=void 0;const wipe_1$4=wipe$1;class NodeRandomSource{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof commonjsRequire$1<"u"){const o=requireCryptoBrowserify();o&&o.randomBytes&&(this._crypto=o,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(o){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let $=this._crypto.randomBytes(o);if($.length!==o)throw new Error("NodeRandomSource: got fewer bytes than requested");const j=new Uint8Array(o);for(let et=0;et<j.length;et++)j[et]=$[et];return(0,wipe_1$4.wipe)($),j}}node.NodeRandomSource=NodeRandomSource;Object.defineProperty(system,"__esModule",{value:!0});system.SystemRandomSource=void 0;const browser_1=browser$4,node_1=node;class SystemRandomSource{constructor(){if(this.isAvailable=!1,this.name="",this._source=new browser_1.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new node_1.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(o){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(o)}}system.SystemRandomSource=SystemRandomSource;(function(_){Object.defineProperty(_,"__esModule",{value:!0}),_.randomStringForEntropy=_.randomString=_.randomUint32=_.randomBytes=_.defaultRandomSource=void 0;const o=system,$=binary,j=wipe$1;_.defaultRandomSource=new o.SystemRandomSource;function et(st,ot=_.defaultRandomSource){return ot.randomBytes(st)}_.randomBytes=et;function tt(st=_.defaultRandomSource){const ot=et(4,st),at=(0,$.readUint32LE)(ot);return(0,j.wipe)(ot),at}_.randomUint32=tt;const rt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function nt(st,ot=rt,at=_.defaultRandomSource){if(ot.length<2)throw new Error("randomString charset is too short");if(ot.length>256)throw new Error("randomString charset is too long");let ct="";const ut=ot.length,ft=256-256%ut;for(;st>0;){const ht=et(Math.ceil(st*256/ft),at);for(let mt=0;mt<ht.length&&st>0;mt++){const gt=ht[mt];gt<ft&&(ct+=ot.charAt(gt%ut),st--)}(0,j.wipe)(ht)}return ct}_.randomString=nt;function it(st,ot=rt,at=_.defaultRandomSource){const ct=Math.ceil(st/(Math.log(ot.length)/Math.LN2));return nt(ct,ot,at)}_.randomStringForEntropy=it})(random);var sha512={};(function(_){Object.defineProperty(_,"__esModule",{value:!0});var o=binary,$=wipe$1;_.DIGEST_LENGTH=64,_.BLOCK_SIZE=128;var j=function(){function nt(){this.digestLength=_.DIGEST_LENGTH,this.blockSize=_.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return nt.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},nt.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},nt.prototype.clean=function(){$.wipe(this._buffer),$.wipe(this._tempHi),$.wipe(this._tempLo),this.reset()},nt.prototype.update=function(it,st){if(st===void 0&&(st=it.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var ot=0;if(this._bytesHashed+=st,this._bufferLength>0){for(;this._bufferLength<_.BLOCK_SIZE&&st>0;)this._buffer[this._bufferLength++]=it[ot++],st--;this._bufferLength===this.blockSize&&(tt(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(st>=this.blockSize&&(ot=tt(this._tempHi,this._tempLo,this._stateHi,this._stateLo,it,ot,st),st%=this.blockSize);st>0;)this._buffer[this._bufferLength++]=it[ot++],st--;return this},nt.prototype.finish=function(it){if(!this._finished){var st=this._bytesHashed,ot=this._bufferLength,at=st/536870912|0,ct=st<<3,ut=st%128<112?128:256;this._buffer[ot]=128;for(var ft=ot+1;ft<ut-8;ft++)this._buffer[ft]=0;o.writeUint32BE(at,this._buffer,ut-8),o.writeUint32BE(ct,this._buffer,ut-4),tt(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,ut),this._finished=!0}for(var ft=0;ft<this.digestLength/8;ft++)o.writeUint32BE(this._stateHi[ft],it,ft*8),o.writeUint32BE(this._stateLo[ft],it,ft*8+4);return this},nt.prototype.digest=function(){var it=new Uint8Array(this.digestLength);return this.finish(it),it},nt.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},nt.prototype.restoreState=function(it){return this._stateHi.set(it.stateHi),this._stateLo.set(it.stateLo),this._bufferLength=it.bufferLength,it.buffer&&this._buffer.set(it.buffer),this._bytesHashed=it.bytesHashed,this._finished=!1,this},nt.prototype.cleanSavedState=function(it){$.wipe(it.stateHi),$.wipe(it.stateLo),it.buffer&&$.wipe(it.buffer),it.bufferLength=0,it.bytesHashed=0},nt}();_.SHA512=j;var et=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function tt(nt,it,st,ot,at,ct,ut){for(var ft=st[0],ht=st[1],mt=st[2],gt=st[3],Et=st[4],St=st[5],At=st[6],kt=st[7],Rt=ot[0],Tt=ot[1],Dt=ot[2],Ot=ot[3],jt=ot[4],Nt=ot[5],It=ot[6],yt=ot[7],lt,pt,bt,_t,$t,Ct,xt,vt;ut>=128;){for(var dt=0;dt<16;dt++){var wt=8*dt+ct;nt[dt]=o.readUint32BE(at,wt),it[dt]=o.readUint32BE(at,wt+4)}for(var dt=0;dt<80;dt++){var qt=ft,Pt=ht,Gt=mt,Wt=gt,Vt=Et,Ut=St,Mt=At,Lt=kt,Yt=Rt,lr=Tt,cr=Dt,ir=Ot,Zt=jt,Bt=Nt,Ft=It,zt=yt;if(lt=kt,pt=yt,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=(Et>>>14|jt<<32-14)^(Et>>>18|jt<<32-18)^(jt>>>41-32|Et<<32-(41-32)),pt=(jt>>>14|Et<<32-14)^(jt>>>18|Et<<32-18)^(Et>>>41-32|jt<<32-(41-32)),$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,lt=Et&St^~Et&At,pt=jt&Nt^~jt&It,$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,lt=et[dt*2],pt=et[dt*2+1],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,lt=nt[dt%16],pt=it[dt%16],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,bt=xt&65535|vt<<16,_t=$t&65535|Ct<<16,lt=bt,pt=_t,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=(ft>>>28|Rt<<32-28)^(Rt>>>34-32|ft<<32-(34-32))^(Rt>>>39-32|ft<<32-(39-32)),pt=(Rt>>>28|ft<<32-28)^(ft>>>34-32|Rt<<32-(34-32))^(ft>>>39-32|Rt<<32-(39-32)),$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,lt=ft&ht^ft&mt^ht&mt,pt=Rt&Tt^Rt&Dt^Tt&Dt,$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,Lt=xt&65535|vt<<16,zt=$t&65535|Ct<<16,lt=Wt,pt=ir,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=bt,pt=_t,$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,Wt=xt&65535|vt<<16,ir=$t&65535|Ct<<16,ht=qt,mt=Pt,gt=Gt,Et=Wt,St=Vt,At=Ut,kt=Mt,ft=Lt,Tt=Yt,Dt=lr,Ot=cr,jt=ir,Nt=Zt,It=Bt,yt=Ft,Rt=zt,dt%16===15)for(var wt=0;wt<16;wt++)lt=nt[wt],pt=it[wt],$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=nt[(wt+9)%16],pt=it[(wt+9)%16],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,bt=nt[(wt+1)%16],_t=it[(wt+1)%16],lt=(bt>>>1|_t<<32-1)^(bt>>>8|_t<<32-8)^bt>>>7,pt=(_t>>>1|bt<<32-1)^(_t>>>8|bt<<32-8)^(_t>>>7|bt<<32-7),$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,bt=nt[(wt+14)%16],_t=it[(wt+14)%16],lt=(bt>>>19|_t<<32-19)^(_t>>>61-32|bt<<32-(61-32))^bt>>>6,pt=(_t>>>19|bt<<32-19)^(bt>>>61-32|_t<<32-(61-32))^(_t>>>6|bt<<32-6),$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,nt[wt]=xt&65535|vt<<16,it[wt]=$t&65535|Ct<<16}lt=ft,pt=Rt,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[0],pt=ot[0],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[0]=ft=xt&65535|vt<<16,ot[0]=Rt=$t&65535|Ct<<16,lt=ht,pt=Tt,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[1],pt=ot[1],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[1]=ht=xt&65535|vt<<16,ot[1]=Tt=$t&65535|Ct<<16,lt=mt,pt=Dt,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[2],pt=ot[2],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[2]=mt=xt&65535|vt<<16,ot[2]=Dt=$t&65535|Ct<<16,lt=gt,pt=Ot,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[3],pt=ot[3],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[3]=gt=xt&65535|vt<<16,ot[3]=Ot=$t&65535|Ct<<16,lt=Et,pt=jt,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[4],pt=ot[4],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[4]=Et=xt&65535|vt<<16,ot[4]=jt=$t&65535|Ct<<16,lt=St,pt=Nt,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[5],pt=ot[5],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[5]=St=xt&65535|vt<<16,ot[5]=Nt=$t&65535|Ct<<16,lt=At,pt=It,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[6],pt=ot[6],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[6]=At=xt&65535|vt<<16,ot[6]=It=$t&65535|Ct<<16,lt=kt,pt=yt,$t=pt&65535,Ct=pt>>>16,xt=lt&65535,vt=lt>>>16,lt=st[7],pt=ot[7],$t+=pt&65535,Ct+=pt>>>16,xt+=lt&65535,vt+=lt>>>16,Ct+=$t>>>16,xt+=Ct>>>16,vt+=xt>>>16,st[7]=kt=xt&65535|vt<<16,ot[7]=yt=$t&65535|Ct<<16,ct+=128,ut-=128}return ct}function rt(nt){var it=new j;it.update(nt);var st=it.digest();return it.clean(),st}_.hash=rt})(sha512);(function(_){Object.defineProperty(_,"__esModule",{value:!0}),_.convertSecretKeyToX25519=_.convertPublicKeyToX25519=_.verify=_.sign=_.extractPublicKeyFromSecretKey=_.generateKeyPair=_.generateKeyPairFromSeed=_.SEED_LENGTH=_.SECRET_KEY_LENGTH=_.PUBLIC_KEY_LENGTH=_.SIGNATURE_LENGTH=void 0;const o=random,$=sha512,j=wipe$1;_.SIGNATURE_LENGTH=64,_.PUBLIC_KEY_LENGTH=32,_.SECRET_KEY_LENGTH=64,_.SEED_LENGTH=32;function et(Wt){const Vt=new Float64Array(16);if(Wt)for(let Ut=0;Ut<Wt.length;Ut++)Vt[Ut]=Wt[Ut];return Vt}const tt=new Uint8Array(32);tt[0]=9;const rt=et(),nt=et([1]),it=et([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),st=et([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ot=et([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),at=et([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),ct=et([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ut(Wt,Vt){for(let Ut=0;Ut<16;Ut++)Wt[Ut]=Vt[Ut]|0}function ft(Wt){let Vt=1;for(let Ut=0;Ut<16;Ut++){let Mt=Wt[Ut]+Vt+65535;Vt=Math.floor(Mt/65536),Wt[Ut]=Mt-Vt*65536}Wt[0]+=Vt-1+37*(Vt-1)}function ht(Wt,Vt,Ut){const Mt=~(Ut-1);for(let Lt=0;Lt<16;Lt++){const Yt=Mt&(Wt[Lt]^Vt[Lt]);Wt[Lt]^=Yt,Vt[Lt]^=Yt}}function mt(Wt,Vt){const Ut=et(),Mt=et();for(let Lt=0;Lt<16;Lt++)Mt[Lt]=Vt[Lt];ft(Mt),ft(Mt),ft(Mt);for(let Lt=0;Lt<2;Lt++){Ut[0]=Mt[0]-65517;for(let lr=1;lr<15;lr++)Ut[lr]=Mt[lr]-65535-(Ut[lr-1]>>16&1),Ut[lr-1]&=65535;Ut[15]=Mt[15]-32767-(Ut[14]>>16&1);const Yt=Ut[15]>>16&1;Ut[14]&=65535,ht(Mt,Ut,1-Yt)}for(let Lt=0;Lt<16;Lt++)Wt[2*Lt]=Mt[Lt]&255,Wt[2*Lt+1]=Mt[Lt]>>8}function gt(Wt,Vt){let Ut=0;for(let Mt=0;Mt<32;Mt++)Ut|=Wt[Mt]^Vt[Mt];return(1&Ut-1>>>8)-1}function Et(Wt,Vt){const Ut=new Uint8Array(32),Mt=new Uint8Array(32);return mt(Ut,Wt),mt(Mt,Vt),gt(Ut,Mt)}function St(Wt){const Vt=new Uint8Array(32);return mt(Vt,Wt),Vt[0]&1}function At(Wt,Vt){for(let Ut=0;Ut<16;Ut++)Wt[Ut]=Vt[2*Ut]+(Vt[2*Ut+1]<<8);Wt[15]&=32767}function kt(Wt,Vt,Ut){for(let Mt=0;Mt<16;Mt++)Wt[Mt]=Vt[Mt]+Ut[Mt]}function Rt(Wt,Vt,Ut){for(let Mt=0;Mt<16;Mt++)Wt[Mt]=Vt[Mt]-Ut[Mt]}function Tt(Wt,Vt,Ut){let Mt,Lt,Yt=0,lr=0,cr=0,ir=0,Zt=0,Bt=0,Ft=0,zt=0,Qt=0,nr=0,gr=0,br=0,vr=0,Nr=0,ar=0,er=0,Xt=0,tr=0,ur=0,pr=0,yr=0,wr=0,Gr=0,$r=0,Er=0,Wr=0,Vr=0,Pr=0,nn=0,Kr=0,Dr=0,Qr=Ut[0],Or=Ut[1],Cr=Ut[2],Zr=Ut[3],Fr=Ut[4],Ar=Ut[5],Xr=Ut[6],Mr=Ut[7],Sr=Ut[8],Jr=Ut[9],Ur=Ut[10],Rr=Ut[11],en=Ut[12],Br=Ut[13],Ir=Ut[14],tn=Ut[15];Mt=Vt[0],Yt+=Mt*Qr,lr+=Mt*Or,cr+=Mt*Cr,ir+=Mt*Zr,Zt+=Mt*Fr,Bt+=Mt*Ar,Ft+=Mt*Xr,zt+=Mt*Mr,Qt+=Mt*Sr,nr+=Mt*Jr,gr+=Mt*Ur,br+=Mt*Rr,vr+=Mt*en,Nr+=Mt*Br,ar+=Mt*Ir,er+=Mt*tn,Mt=Vt[1],lr+=Mt*Qr,cr+=Mt*Or,ir+=Mt*Cr,Zt+=Mt*Zr,Bt+=Mt*Fr,Ft+=Mt*Ar,zt+=Mt*Xr,Qt+=Mt*Mr,nr+=Mt*Sr,gr+=Mt*Jr,br+=Mt*Ur,vr+=Mt*Rr,Nr+=Mt*en,ar+=Mt*Br,er+=Mt*Ir,Xt+=Mt*tn,Mt=Vt[2],cr+=Mt*Qr,ir+=Mt*Or,Zt+=Mt*Cr,Bt+=Mt*Zr,Ft+=Mt*Fr,zt+=Mt*Ar,Qt+=Mt*Xr,nr+=Mt*Mr,gr+=Mt*Sr,br+=Mt*Jr,vr+=Mt*Ur,Nr+=Mt*Rr,ar+=Mt*en,er+=Mt*Br,Xt+=Mt*Ir,tr+=Mt*tn,Mt=Vt[3],ir+=Mt*Qr,Zt+=Mt*Or,Bt+=Mt*Cr,Ft+=Mt*Zr,zt+=Mt*Fr,Qt+=Mt*Ar,nr+=Mt*Xr,gr+=Mt*Mr,br+=Mt*Sr,vr+=Mt*Jr,Nr+=Mt*Ur,ar+=Mt*Rr,er+=Mt*en,Xt+=Mt*Br,tr+=Mt*Ir,ur+=Mt*tn,Mt=Vt[4],Zt+=Mt*Qr,Bt+=Mt*Or,Ft+=Mt*Cr,zt+=Mt*Zr,Qt+=Mt*Fr,nr+=Mt*Ar,gr+=Mt*Xr,br+=Mt*Mr,vr+=Mt*Sr,Nr+=Mt*Jr,ar+=Mt*Ur,er+=Mt*Rr,Xt+=Mt*en,tr+=Mt*Br,ur+=Mt*Ir,pr+=Mt*tn,Mt=Vt[5],Bt+=Mt*Qr,Ft+=Mt*Or,zt+=Mt*Cr,Qt+=Mt*Zr,nr+=Mt*Fr,gr+=Mt*Ar,br+=Mt*Xr,vr+=Mt*Mr,Nr+=Mt*Sr,ar+=Mt*Jr,er+=Mt*Ur,Xt+=Mt*Rr,tr+=Mt*en,ur+=Mt*Br,pr+=Mt*Ir,yr+=Mt*tn,Mt=Vt[6],Ft+=Mt*Qr,zt+=Mt*Or,Qt+=Mt*Cr,nr+=Mt*Zr,gr+=Mt*Fr,br+=Mt*Ar,vr+=Mt*Xr,Nr+=Mt*Mr,ar+=Mt*Sr,er+=Mt*Jr,Xt+=Mt*Ur,tr+=Mt*Rr,ur+=Mt*en,pr+=Mt*Br,yr+=Mt*Ir,wr+=Mt*tn,Mt=Vt[7],zt+=Mt*Qr,Qt+=Mt*Or,nr+=Mt*Cr,gr+=Mt*Zr,br+=Mt*Fr,vr+=Mt*Ar,Nr+=Mt*Xr,ar+=Mt*Mr,er+=Mt*Sr,Xt+=Mt*Jr,tr+=Mt*Ur,ur+=Mt*Rr,pr+=Mt*en,yr+=Mt*Br,wr+=Mt*Ir,Gr+=Mt*tn,Mt=Vt[8],Qt+=Mt*Qr,nr+=Mt*Or,gr+=Mt*Cr,br+=Mt*Zr,vr+=Mt*Fr,Nr+=Mt*Ar,ar+=Mt*Xr,er+=Mt*Mr,Xt+=Mt*Sr,tr+=Mt*Jr,ur+=Mt*Ur,pr+=Mt*Rr,yr+=Mt*en,wr+=Mt*Br,Gr+=Mt*Ir,$r+=Mt*tn,Mt=Vt[9],nr+=Mt*Qr,gr+=Mt*Or,br+=Mt*Cr,vr+=Mt*Zr,Nr+=Mt*Fr,ar+=Mt*Ar,er+=Mt*Xr,Xt+=Mt*Mr,tr+=Mt*Sr,ur+=Mt*Jr,pr+=Mt*Ur,yr+=Mt*Rr,wr+=Mt*en,Gr+=Mt*Br,$r+=Mt*Ir,Er+=Mt*tn,Mt=Vt[10],gr+=Mt*Qr,br+=Mt*Or,vr+=Mt*Cr,Nr+=Mt*Zr,ar+=Mt*Fr,er+=Mt*Ar,Xt+=Mt*Xr,tr+=Mt*Mr,ur+=Mt*Sr,pr+=Mt*Jr,yr+=Mt*Ur,wr+=Mt*Rr,Gr+=Mt*en,$r+=Mt*Br,Er+=Mt*Ir,Wr+=Mt*tn,Mt=Vt[11],br+=Mt*Qr,vr+=Mt*Or,Nr+=Mt*Cr,ar+=Mt*Zr,er+=Mt*Fr,Xt+=Mt*Ar,tr+=Mt*Xr,ur+=Mt*Mr,pr+=Mt*Sr,yr+=Mt*Jr,wr+=Mt*Ur,Gr+=Mt*Rr,$r+=Mt*en,Er+=Mt*Br,Wr+=Mt*Ir,Vr+=Mt*tn,Mt=Vt[12],vr+=Mt*Qr,Nr+=Mt*Or,ar+=Mt*Cr,er+=Mt*Zr,Xt+=Mt*Fr,tr+=Mt*Ar,ur+=Mt*Xr,pr+=Mt*Mr,yr+=Mt*Sr,wr+=Mt*Jr,Gr+=Mt*Ur,$r+=Mt*Rr,Er+=Mt*en,Wr+=Mt*Br,Vr+=Mt*Ir,Pr+=Mt*tn,Mt=Vt[13],Nr+=Mt*Qr,ar+=Mt*Or,er+=Mt*Cr,Xt+=Mt*Zr,tr+=Mt*Fr,ur+=Mt*Ar,pr+=Mt*Xr,yr+=Mt*Mr,wr+=Mt*Sr,Gr+=Mt*Jr,$r+=Mt*Ur,Er+=Mt*Rr,Wr+=Mt*en,Vr+=Mt*Br,Pr+=Mt*Ir,nn+=Mt*tn,Mt=Vt[14],ar+=Mt*Qr,er+=Mt*Or,Xt+=Mt*Cr,tr+=Mt*Zr,ur+=Mt*Fr,pr+=Mt*Ar,yr+=Mt*Xr,wr+=Mt*Mr,Gr+=Mt*Sr,$r+=Mt*Jr,Er+=Mt*Ur,Wr+=Mt*Rr,Vr+=Mt*en,Pr+=Mt*Br,nn+=Mt*Ir,Kr+=Mt*tn,Mt=Vt[15],er+=Mt*Qr,Xt+=Mt*Or,tr+=Mt*Cr,ur+=Mt*Zr,pr+=Mt*Fr,yr+=Mt*Ar,wr+=Mt*Xr,Gr+=Mt*Mr,$r+=Mt*Sr,Er+=Mt*Jr,Wr+=Mt*Ur,Vr+=Mt*Rr,Pr+=Mt*en,nn+=Mt*Br,Kr+=Mt*Ir,Dr+=Mt*tn,Yt+=38*Xt,lr+=38*tr,cr+=38*ur,ir+=38*pr,Zt+=38*yr,Bt+=38*wr,Ft+=38*Gr,zt+=38*$r,Qt+=38*Er,nr+=38*Wr,gr+=38*Vr,br+=38*Pr,vr+=38*nn,Nr+=38*Kr,ar+=38*Dr,Lt=1,Mt=Yt+Lt+65535,Lt=Math.floor(Mt/65536),Yt=Mt-Lt*65536,Mt=lr+Lt+65535,Lt=Math.floor(Mt/65536),lr=Mt-Lt*65536,Mt=cr+Lt+65535,Lt=Math.floor(Mt/65536),cr=Mt-Lt*65536,Mt=ir+Lt+65535,Lt=Math.floor(Mt/65536),ir=Mt-Lt*65536,Mt=Zt+Lt+65535,Lt=Math.floor(Mt/65536),Zt=Mt-Lt*65536,Mt=Bt+Lt+65535,Lt=Math.floor(Mt/65536),Bt=Mt-Lt*65536,Mt=Ft+Lt+65535,Lt=Math.floor(Mt/65536),Ft=Mt-Lt*65536,Mt=zt+Lt+65535,Lt=Math.floor(Mt/65536),zt=Mt-Lt*65536,Mt=Qt+Lt+65535,Lt=Math.floor(Mt/65536),Qt=Mt-Lt*65536,Mt=nr+Lt+65535,Lt=Math.floor(Mt/65536),nr=Mt-Lt*65536,Mt=gr+Lt+65535,Lt=Math.floor(Mt/65536),gr=Mt-Lt*65536,Mt=br+Lt+65535,Lt=Math.floor(Mt/65536),br=Mt-Lt*65536,Mt=vr+Lt+65535,Lt=Math.floor(Mt/65536),vr=Mt-Lt*65536,Mt=Nr+Lt+65535,Lt=Math.floor(Mt/65536),Nr=Mt-Lt*65536,Mt=ar+Lt+65535,Lt=Math.floor(Mt/65536),ar=Mt-Lt*65536,Mt=er+Lt+65535,Lt=Math.floor(Mt/65536),er=Mt-Lt*65536,Yt+=Lt-1+37*(Lt-1),Lt=1,Mt=Yt+Lt+65535,Lt=Math.floor(Mt/65536),Yt=Mt-Lt*65536,Mt=lr+Lt+65535,Lt=Math.floor(Mt/65536),lr=Mt-Lt*65536,Mt=cr+Lt+65535,Lt=Math.floor(Mt/65536),cr=Mt-Lt*65536,Mt=ir+Lt+65535,Lt=Math.floor(Mt/65536),ir=Mt-Lt*65536,Mt=Zt+Lt+65535,Lt=Math.floor(Mt/65536),Zt=Mt-Lt*65536,Mt=Bt+Lt+65535,Lt=Math.floor(Mt/65536),Bt=Mt-Lt*65536,Mt=Ft+Lt+65535,Lt=Math.floor(Mt/65536),Ft=Mt-Lt*65536,Mt=zt+Lt+65535,Lt=Math.floor(Mt/65536),zt=Mt-Lt*65536,Mt=Qt+Lt+65535,Lt=Math.floor(Mt/65536),Qt=Mt-Lt*65536,Mt=nr+Lt+65535,Lt=Math.floor(Mt/65536),nr=Mt-Lt*65536,Mt=gr+Lt+65535,Lt=Math.floor(Mt/65536),gr=Mt-Lt*65536,Mt=br+Lt+65535,Lt=Math.floor(Mt/65536),br=Mt-Lt*65536,Mt=vr+Lt+65535,Lt=Math.floor(Mt/65536),vr=Mt-Lt*65536,Mt=Nr+Lt+65535,Lt=Math.floor(Mt/65536),Nr=Mt-Lt*65536,Mt=ar+Lt+65535,Lt=Math.floor(Mt/65536),ar=Mt-Lt*65536,Mt=er+Lt+65535,Lt=Math.floor(Mt/65536),er=Mt-Lt*65536,Yt+=Lt-1+37*(Lt-1),Wt[0]=Yt,Wt[1]=lr,Wt[2]=cr,Wt[3]=ir,Wt[4]=Zt,Wt[5]=Bt,Wt[6]=Ft,Wt[7]=zt,Wt[8]=Qt,Wt[9]=nr,Wt[10]=gr,Wt[11]=br,Wt[12]=vr,Wt[13]=Nr,Wt[14]=ar,Wt[15]=er}function Dt(Wt,Vt){Tt(Wt,Vt,Vt)}function Ot(Wt,Vt){const Ut=et();let Mt;for(Mt=0;Mt<16;Mt++)Ut[Mt]=Vt[Mt];for(Mt=253;Mt>=0;Mt--)Dt(Ut,Ut),Mt!==2&&Mt!==4&&Tt(Ut,Ut,Vt);for(Mt=0;Mt<16;Mt++)Wt[Mt]=Ut[Mt]}function jt(Wt,Vt){const Ut=et();let Mt;for(Mt=0;Mt<16;Mt++)Ut[Mt]=Vt[Mt];for(Mt=250;Mt>=0;Mt--)Dt(Ut,Ut),Mt!==1&&Tt(Ut,Ut,Vt);for(Mt=0;Mt<16;Mt++)Wt[Mt]=Ut[Mt]}function Nt(Wt,Vt){const Ut=et(),Mt=et(),Lt=et(),Yt=et(),lr=et(),cr=et(),ir=et(),Zt=et(),Bt=et();Rt(Ut,Wt[1],Wt[0]),Rt(Bt,Vt[1],Vt[0]),Tt(Ut,Ut,Bt),kt(Mt,Wt[0],Wt[1]),kt(Bt,Vt[0],Vt[1]),Tt(Mt,Mt,Bt),Tt(Lt,Wt[3],Vt[3]),Tt(Lt,Lt,st),Tt(Yt,Wt[2],Vt[2]),kt(Yt,Yt,Yt),Rt(lr,Mt,Ut),Rt(cr,Yt,Lt),kt(ir,Yt,Lt),kt(Zt,Mt,Ut),Tt(Wt[0],lr,cr),Tt(Wt[1],Zt,ir),Tt(Wt[2],ir,cr),Tt(Wt[3],lr,Zt)}function It(Wt,Vt,Ut){for(let Mt=0;Mt<4;Mt++)ht(Wt[Mt],Vt[Mt],Ut)}function yt(Wt,Vt){const Ut=et(),Mt=et(),Lt=et();Ot(Lt,Vt[2]),Tt(Ut,Vt[0],Lt),Tt(Mt,Vt[1],Lt),mt(Wt,Mt),Wt[31]^=St(Ut)<<7}function lt(Wt,Vt,Ut){ut(Wt[0],rt),ut(Wt[1],nt),ut(Wt[2],nt),ut(Wt[3],rt);for(let Mt=255;Mt>=0;--Mt){const Lt=Ut[Mt/8|0]>>(Mt&7)&1;It(Wt,Vt,Lt),Nt(Vt,Wt),Nt(Wt,Wt),It(Wt,Vt,Lt)}}function pt(Wt,Vt){const Ut=[et(),et(),et(),et()];ut(Ut[0],ot),ut(Ut[1],at),ut(Ut[2],nt),Tt(Ut[3],ot,at),lt(Wt,Ut,Vt)}function bt(Wt){if(Wt.length!==_.SEED_LENGTH)throw new Error(`ed25519: seed must be ${_.SEED_LENGTH} bytes`);const Vt=(0,$.hash)(Wt);Vt[0]&=248,Vt[31]&=127,Vt[31]|=64;const Ut=new Uint8Array(32),Mt=[et(),et(),et(),et()];pt(Mt,Vt),yt(Ut,Mt);const Lt=new Uint8Array(64);return Lt.set(Wt),Lt.set(Ut,32),{publicKey:Ut,secretKey:Lt}}_.generateKeyPairFromSeed=bt;function _t(Wt){const Vt=(0,o.randomBytes)(32,Wt),Ut=bt(Vt);return(0,j.wipe)(Vt),Ut}_.generateKeyPair=_t;function $t(Wt){if(Wt.length!==_.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${_.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(Wt.subarray(32))}_.extractPublicKeyFromSecretKey=$t;const Ct=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function xt(Wt,Vt){let Ut,Mt,Lt,Yt;for(Mt=63;Mt>=32;--Mt){for(Ut=0,Lt=Mt-32,Yt=Mt-12;Lt<Yt;++Lt)Vt[Lt]+=Ut-16*Vt[Mt]*Ct[Lt-(Mt-32)],Ut=Math.floor((Vt[Lt]+128)/256),Vt[Lt]-=Ut*256;Vt[Lt]+=Ut,Vt[Mt]=0}for(Ut=0,Lt=0;Lt<32;Lt++)Vt[Lt]+=Ut-(Vt[31]>>4)*Ct[Lt],Ut=Vt[Lt]>>8,Vt[Lt]&=255;for(Lt=0;Lt<32;Lt++)Vt[Lt]-=Ut*Ct[Lt];for(Mt=0;Mt<32;Mt++)Vt[Mt+1]+=Vt[Mt]>>8,Wt[Mt]=Vt[Mt]&255}function vt(Wt){const Vt=new Float64Array(64);for(let Ut=0;Ut<64;Ut++)Vt[Ut]=Wt[Ut];for(let Ut=0;Ut<64;Ut++)Wt[Ut]=0;xt(Wt,Vt)}function dt(Wt,Vt){const Ut=new Float64Array(64),Mt=[et(),et(),et(),et()],Lt=(0,$.hash)(Wt.subarray(0,32));Lt[0]&=248,Lt[31]&=127,Lt[31]|=64;const Yt=new Uint8Array(64);Yt.set(Lt.subarray(32),32);const lr=new $.SHA512;lr.update(Yt.subarray(32)),lr.update(Vt);const cr=lr.digest();lr.clean(),vt(cr),pt(Mt,cr),yt(Yt,Mt),lr.reset(),lr.update(Yt.subarray(0,32)),lr.update(Wt.subarray(32)),lr.update(Vt);const ir=lr.digest();vt(ir);for(let Zt=0;Zt<32;Zt++)Ut[Zt]=cr[Zt];for(let Zt=0;Zt<32;Zt++)for(let Bt=0;Bt<32;Bt++)Ut[Zt+Bt]+=ir[Zt]*Lt[Bt];return xt(Yt.subarray(32),Ut),Yt}_.sign=dt;function wt(Wt,Vt){const Ut=et(),Mt=et(),Lt=et(),Yt=et(),lr=et(),cr=et(),ir=et();return ut(Wt[2],nt),At(Wt[1],Vt),Dt(Lt,Wt[1]),Tt(Yt,Lt,it),Rt(Lt,Lt,Wt[2]),kt(Yt,Wt[2],Yt),Dt(lr,Yt),Dt(cr,lr),Tt(ir,cr,lr),Tt(Ut,ir,Lt),Tt(Ut,Ut,Yt),jt(Ut,Ut),Tt(Ut,Ut,Lt),Tt(Ut,Ut,Yt),Tt(Ut,Ut,Yt),Tt(Wt[0],Ut,Yt),Dt(Mt,Wt[0]),Tt(Mt,Mt,Yt),Et(Mt,Lt)&&Tt(Wt[0],Wt[0],ct),Dt(Mt,Wt[0]),Tt(Mt,Mt,Yt),Et(Mt,Lt)?-1:(St(Wt[0])===Vt[31]>>7&&Rt(Wt[0],rt,Wt[0]),Tt(Wt[3],Wt[0],Wt[1]),0)}function qt(Wt,Vt,Ut){const Mt=new Uint8Array(32),Lt=[et(),et(),et(),et()],Yt=[et(),et(),et(),et()];if(Ut.length!==_.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${_.SIGNATURE_LENGTH} bytes`);if(wt(Yt,Wt))return!1;const lr=new $.SHA512;lr.update(Ut.subarray(0,32)),lr.update(Wt),lr.update(Vt);const cr=lr.digest();return vt(cr),lt(Lt,Yt,cr),pt(Yt,Ut.subarray(32)),Nt(Lt,Yt),yt(Mt,Lt),!gt(Ut,Mt)}_.verify=qt;function Pt(Wt){let Vt=[et(),et(),et(),et()];if(wt(Vt,Wt))throw new Error("Ed25519: invalid public key");let Ut=et(),Mt=et(),Lt=Vt[1];kt(Ut,nt,Lt),Rt(Mt,nt,Lt),Ot(Mt,Mt),Tt(Ut,Ut,Mt);let Yt=new Uint8Array(32);return mt(Yt,Ut),Yt}_.convertPublicKeyToX25519=Pt;function Gt(Wt){const Vt=(0,$.hash)(Wt.subarray(0,32));Vt[0]&=248,Vt[31]&=127,Vt[31]|=64;const Ut=new Uint8Array(Vt.subarray(0,32));return(0,j.wipe)(Vt),Ut}_.convertSecretKeyToX25519=Gt})(ed25519);var dist={};Object.defineProperty(dist,"__esModule",{value:!0});dist.bech32m=bech32=dist.bech32=void 0;const ALPHABET="qpzry9x8gf2tvdw0s3jn54khce6mua7l",ALPHABET_MAP={};for(let _=0;_<ALPHABET.length;_++){const o=ALPHABET.charAt(_);ALPHABET_MAP[o]=_}function polymodStep(_){const o=_>>25;return(_&33554431)<<5^-(o>>0&1)&996825010^-(o>>1&1)&642813549^-(o>>2&1)&513874426^-(o>>3&1)&1027748829^-(o>>4&1)&705979059}function prefixChk(_){let o=1;for(let $=0;$<_.length;++$){const j=_.charCodeAt($);if(j<33||j>126)return"Invalid prefix ("+_+")";o=polymodStep(o)^j>>5}o=polymodStep(o);for(let $=0;$<_.length;++$){const j=_.charCodeAt($);o=polymodStep(o)^j&31}return o}function convert(_,o,$,j){let et=0,tt=0;const rt=(1<<$)-1,nt=[];for(let it=0;it<_.length;++it)for(et=et<<o|_[it],tt+=o;tt>=$;)tt-=$,nt.push(et>>tt&rt);if(j)tt>0&&nt.push(et<<$-tt&rt);else{if(tt>=o)return"Excess padding";if(et<<$-tt&rt)return"Non-zero padding"}return nt}function toWords(_){return convert(_,8,5,!0)}function fromWordsUnsafe(_){const o=convert(_,5,8,!1);if(Array.isArray(o))return o}function fromWords(_){const o=convert(_,5,8,!1);if(Array.isArray(o))return o;throw new Error(o)}function getLibraryFromEncoding(_){let o;_==="bech32"?o=1:o=734539939;function $(rt,nt,it){if(it=it||90,rt.length+7+nt.length>it)throw new TypeError("Exceeds length limit");rt=rt.toLowerCase();let st=prefixChk(rt);if(typeof st=="string")throw new Error(st);let ot=rt+"1";for(let at=0;at<nt.length;++at){const ct=nt[at];if(ct>>5)throw new Error("Non 5-bit word");st=polymodStep(st)^ct,ot+=ALPHABET.charAt(ct)}for(let at=0;at<6;++at)st=polymodStep(st);st^=o;for(let at=0;at<6;++at){const ct=st>>(5-at)*5&31;ot+=ALPHABET.charAt(ct)}return ot}function j(rt,nt){if(nt=nt||90,rt.length<8)return rt+" too short";if(rt.length>nt)return"Exceeds length limit";const it=rt.toLowerCase(),st=rt.toUpperCase();if(rt!==it&&rt!==st)return"Mixed-case string "+rt;rt=it;const ot=rt.lastIndexOf("1");if(ot===-1)return"No separator character for "+rt;if(ot===0)return"Missing prefix for "+rt;const at=rt.slice(0,ot),ct=rt.slice(ot+1);if(ct.length<6)return"Data too short";let ut=prefixChk(at);if(typeof ut=="string")return ut;const ft=[];for(let ht=0;ht<ct.length;++ht){const mt=ct.charAt(ht),gt=ALPHABET_MAP[mt];if(gt===void 0)return"Unknown character "+mt;ut=polymodStep(ut)^gt,!(ht+6>=ct.length)&&ft.push(gt)}return ut!==o?"Invalid checksum for "+rt:{prefix:at,words:ft}}function et(rt,nt){const it=j(rt,nt);if(typeof it=="object")return it}function tt(rt,nt){const it=j(rt,nt);if(typeof it=="object")return it;throw new Error(it)}return{decodeUnsafe:et,decode:tt,encode:$,toWords,fromWordsUnsafe,fromWords}}var bech32=dist.bech32=getLibraryFromEncoding("bech32");dist.bech32m=getLibraryFromEncoding("bech32m");var x25519={};(function(_){Object.defineProperty(_,"__esModule",{value:!0}),_.sharedKey=_.generateKeyPair=_.generateKeyPairFromSeed=_.scalarMultBase=_.scalarMult=_.SHARED_KEY_LENGTH=_.SECRET_KEY_LENGTH=_.PUBLIC_KEY_LENGTH=void 0;const o=random,$=wipe$1;_.PUBLIC_KEY_LENGTH=32,_.SECRET_KEY_LENGTH=32,_.SHARED_KEY_LENGTH=32;function j(At){const kt=new Float64Array(16);if(At)for(let Rt=0;Rt<At.length;Rt++)kt[Rt]=At[Rt];return kt}const et=new Uint8Array(32);et[0]=9;const tt=j([56129,1]);function rt(At){let kt=1;for(let Rt=0;Rt<16;Rt++){let Tt=At[Rt]+kt+65535;kt=Math.floor(Tt/65536),At[Rt]=Tt-kt*65536}At[0]+=kt-1+37*(kt-1)}function nt(At,kt,Rt){const Tt=~(Rt-1);for(let Dt=0;Dt<16;Dt++){const Ot=Tt&(At[Dt]^kt[Dt]);At[Dt]^=Ot,kt[Dt]^=Ot}}function it(At,kt){const Rt=j(),Tt=j();for(let Dt=0;Dt<16;Dt++)Tt[Dt]=kt[Dt];rt(Tt),rt(Tt),rt(Tt);for(let Dt=0;Dt<2;Dt++){Rt[0]=Tt[0]-65517;for(let jt=1;jt<15;jt++)Rt[jt]=Tt[jt]-65535-(Rt[jt-1]>>16&1),Rt[jt-1]&=65535;Rt[15]=Tt[15]-32767-(Rt[14]>>16&1);const Ot=Rt[15]>>16&1;Rt[14]&=65535,nt(Tt,Rt,1-Ot)}for(let Dt=0;Dt<16;Dt++)At[2*Dt]=Tt[Dt]&255,At[2*Dt+1]=Tt[Dt]>>8}function st(At,kt){for(let Rt=0;Rt<16;Rt++)At[Rt]=kt[2*Rt]+(kt[2*Rt+1]<<8);At[15]&=32767}function ot(At,kt,Rt){for(let Tt=0;Tt<16;Tt++)At[Tt]=kt[Tt]+Rt[Tt]}function at(At,kt,Rt){for(let Tt=0;Tt<16;Tt++)At[Tt]=kt[Tt]-Rt[Tt]}function ct(At,kt,Rt){let Tt,Dt,Ot=0,jt=0,Nt=0,It=0,yt=0,lt=0,pt=0,bt=0,_t=0,$t=0,Ct=0,xt=0,vt=0,dt=0,wt=0,qt=0,Pt=0,Gt=0,Wt=0,Vt=0,Ut=0,Mt=0,Lt=0,Yt=0,lr=0,cr=0,ir=0,Zt=0,Bt=0,Ft=0,zt=0,Qt=Rt[0],nr=Rt[1],gr=Rt[2],br=Rt[3],vr=Rt[4],Nr=Rt[5],ar=Rt[6],er=Rt[7],Xt=Rt[8],tr=Rt[9],ur=Rt[10],pr=Rt[11],yr=Rt[12],wr=Rt[13],Gr=Rt[14],$r=Rt[15];Tt=kt[0],Ot+=Tt*Qt,jt+=Tt*nr,Nt+=Tt*gr,It+=Tt*br,yt+=Tt*vr,lt+=Tt*Nr,pt+=Tt*ar,bt+=Tt*er,_t+=Tt*Xt,$t+=Tt*tr,Ct+=Tt*ur,xt+=Tt*pr,vt+=Tt*yr,dt+=Tt*wr,wt+=Tt*Gr,qt+=Tt*$r,Tt=kt[1],jt+=Tt*Qt,Nt+=Tt*nr,It+=Tt*gr,yt+=Tt*br,lt+=Tt*vr,pt+=Tt*Nr,bt+=Tt*ar,_t+=Tt*er,$t+=Tt*Xt,Ct+=Tt*tr,xt+=Tt*ur,vt+=Tt*pr,dt+=Tt*yr,wt+=Tt*wr,qt+=Tt*Gr,Pt+=Tt*$r,Tt=kt[2],Nt+=Tt*Qt,It+=Tt*nr,yt+=Tt*gr,lt+=Tt*br,pt+=Tt*vr,bt+=Tt*Nr,_t+=Tt*ar,$t+=Tt*er,Ct+=Tt*Xt,xt+=Tt*tr,vt+=Tt*ur,dt+=Tt*pr,wt+=Tt*yr,qt+=Tt*wr,Pt+=Tt*Gr,Gt+=Tt*$r,Tt=kt[3],It+=Tt*Qt,yt+=Tt*nr,lt+=Tt*gr,pt+=Tt*br,bt+=Tt*vr,_t+=Tt*Nr,$t+=Tt*ar,Ct+=Tt*er,xt+=Tt*Xt,vt+=Tt*tr,dt+=Tt*ur,wt+=Tt*pr,qt+=Tt*yr,Pt+=Tt*wr,Gt+=Tt*Gr,Wt+=Tt*$r,Tt=kt[4],yt+=Tt*Qt,lt+=Tt*nr,pt+=Tt*gr,bt+=Tt*br,_t+=Tt*vr,$t+=Tt*Nr,Ct+=Tt*ar,xt+=Tt*er,vt+=Tt*Xt,dt+=Tt*tr,wt+=Tt*ur,qt+=Tt*pr,Pt+=Tt*yr,Gt+=Tt*wr,Wt+=Tt*Gr,Vt+=Tt*$r,Tt=kt[5],lt+=Tt*Qt,pt+=Tt*nr,bt+=Tt*gr,_t+=Tt*br,$t+=Tt*vr,Ct+=Tt*Nr,xt+=Tt*ar,vt+=Tt*er,dt+=Tt*Xt,wt+=Tt*tr,qt+=Tt*ur,Pt+=Tt*pr,Gt+=Tt*yr,Wt+=Tt*wr,Vt+=Tt*Gr,Ut+=Tt*$r,Tt=kt[6],pt+=Tt*Qt,bt+=Tt*nr,_t+=Tt*gr,$t+=Tt*br,Ct+=Tt*vr,xt+=Tt*Nr,vt+=Tt*ar,dt+=Tt*er,wt+=Tt*Xt,qt+=Tt*tr,Pt+=Tt*ur,Gt+=Tt*pr,Wt+=Tt*yr,Vt+=Tt*wr,Ut+=Tt*Gr,Mt+=Tt*$r,Tt=kt[7],bt+=Tt*Qt,_t+=Tt*nr,$t+=Tt*gr,Ct+=Tt*br,xt+=Tt*vr,vt+=Tt*Nr,dt+=Tt*ar,wt+=Tt*er,qt+=Tt*Xt,Pt+=Tt*tr,Gt+=Tt*ur,Wt+=Tt*pr,Vt+=Tt*yr,Ut+=Tt*wr,Mt+=Tt*Gr,Lt+=Tt*$r,Tt=kt[8],_t+=Tt*Qt,$t+=Tt*nr,Ct+=Tt*gr,xt+=Tt*br,vt+=Tt*vr,dt+=Tt*Nr,wt+=Tt*ar,qt+=Tt*er,Pt+=Tt*Xt,Gt+=Tt*tr,Wt+=Tt*ur,Vt+=Tt*pr,Ut+=Tt*yr,Mt+=Tt*wr,Lt+=Tt*Gr,Yt+=Tt*$r,Tt=kt[9],$t+=Tt*Qt,Ct+=Tt*nr,xt+=Tt*gr,vt+=Tt*br,dt+=Tt*vr,wt+=Tt*Nr,qt+=Tt*ar,Pt+=Tt*er,Gt+=Tt*Xt,Wt+=Tt*tr,Vt+=Tt*ur,Ut+=Tt*pr,Mt+=Tt*yr,Lt+=Tt*wr,Yt+=Tt*Gr,lr+=Tt*$r,Tt=kt[10],Ct+=Tt*Qt,xt+=Tt*nr,vt+=Tt*gr,dt+=Tt*br,wt+=Tt*vr,qt+=Tt*Nr,Pt+=Tt*ar,Gt+=Tt*er,Wt+=Tt*Xt,Vt+=Tt*tr,Ut+=Tt*ur,Mt+=Tt*pr,Lt+=Tt*yr,Yt+=Tt*wr,lr+=Tt*Gr,cr+=Tt*$r,Tt=kt[11],xt+=Tt*Qt,vt+=Tt*nr,dt+=Tt*gr,wt+=Tt*br,qt+=Tt*vr,Pt+=Tt*Nr,Gt+=Tt*ar,Wt+=Tt*er,Vt+=Tt*Xt,Ut+=Tt*tr,Mt+=Tt*ur,Lt+=Tt*pr,Yt+=Tt*yr,lr+=Tt*wr,cr+=Tt*Gr,ir+=Tt*$r,Tt=kt[12],vt+=Tt*Qt,dt+=Tt*nr,wt+=Tt*gr,qt+=Tt*br,Pt+=Tt*vr,Gt+=Tt*Nr,Wt+=Tt*ar,Vt+=Tt*er,Ut+=Tt*Xt,Mt+=Tt*tr,Lt+=Tt*ur,Yt+=Tt*pr,lr+=Tt*yr,cr+=Tt*wr,ir+=Tt*Gr,Zt+=Tt*$r,Tt=kt[13],dt+=Tt*Qt,wt+=Tt*nr,qt+=Tt*gr,Pt+=Tt*br,Gt+=Tt*vr,Wt+=Tt*Nr,Vt+=Tt*ar,Ut+=Tt*er,Mt+=Tt*Xt,Lt+=Tt*tr,Yt+=Tt*ur,lr+=Tt*pr,cr+=Tt*yr,ir+=Tt*wr,Zt+=Tt*Gr,Bt+=Tt*$r,Tt=kt[14],wt+=Tt*Qt,qt+=Tt*nr,Pt+=Tt*gr,Gt+=Tt*br,Wt+=Tt*vr,Vt+=Tt*Nr,Ut+=Tt*ar,Mt+=Tt*er,Lt+=Tt*Xt,Yt+=Tt*tr,lr+=Tt*ur,cr+=Tt*pr,ir+=Tt*yr,Zt+=Tt*wr,Bt+=Tt*Gr,Ft+=Tt*$r,Tt=kt[15],qt+=Tt*Qt,Pt+=Tt*nr,Gt+=Tt*gr,Wt+=Tt*br,Vt+=Tt*vr,Ut+=Tt*Nr,Mt+=Tt*ar,Lt+=Tt*er,Yt+=Tt*Xt,lr+=Tt*tr,cr+=Tt*ur,ir+=Tt*pr,Zt+=Tt*yr,Bt+=Tt*wr,Ft+=Tt*Gr,zt+=Tt*$r,Ot+=38*Pt,jt+=38*Gt,Nt+=38*Wt,It+=38*Vt,yt+=38*Ut,lt+=38*Mt,pt+=38*Lt,bt+=38*Yt,_t+=38*lr,$t+=38*cr,Ct+=38*ir,xt+=38*Zt,vt+=38*Bt,dt+=38*Ft,wt+=38*zt,Dt=1,Tt=Ot+Dt+65535,Dt=Math.floor(Tt/65536),Ot=Tt-Dt*65536,Tt=jt+Dt+65535,Dt=Math.floor(Tt/65536),jt=Tt-Dt*65536,Tt=Nt+Dt+65535,Dt=Math.floor(Tt/65536),Nt=Tt-Dt*65536,Tt=It+Dt+65535,Dt=Math.floor(Tt/65536),It=Tt-Dt*65536,Tt=yt+Dt+65535,Dt=Math.floor(Tt/65536),yt=Tt-Dt*65536,Tt=lt+Dt+65535,Dt=Math.floor(Tt/65536),lt=Tt-Dt*65536,Tt=pt+Dt+65535,Dt=Math.floor(Tt/65536),pt=Tt-Dt*65536,Tt=bt+Dt+65535,Dt=Math.floor(Tt/65536),bt=Tt-Dt*65536,Tt=_t+Dt+65535,Dt=Math.floor(Tt/65536),_t=Tt-Dt*65536,Tt=$t+Dt+65535,Dt=Math.floor(Tt/65536),$t=Tt-Dt*65536,Tt=Ct+Dt+65535,Dt=Math.floor(Tt/65536),Ct=Tt-Dt*65536,Tt=xt+Dt+65535,Dt=Math.floor(Tt/65536),xt=Tt-Dt*65536,Tt=vt+Dt+65535,Dt=Math.floor(Tt/65536),vt=Tt-Dt*65536,Tt=dt+Dt+65535,Dt=Math.floor(Tt/65536),dt=Tt-Dt*65536,Tt=wt+Dt+65535,Dt=Math.floor(Tt/65536),wt=Tt-Dt*65536,Tt=qt+Dt+65535,Dt=Math.floor(Tt/65536),qt=Tt-Dt*65536,Ot+=Dt-1+37*(Dt-1),Dt=1,Tt=Ot+Dt+65535,Dt=Math.floor(Tt/65536),Ot=Tt-Dt*65536,Tt=jt+Dt+65535,Dt=Math.floor(Tt/65536),jt=Tt-Dt*65536,Tt=Nt+Dt+65535,Dt=Math.floor(Tt/65536),Nt=Tt-Dt*65536,Tt=It+Dt+65535,Dt=Math.floor(Tt/65536),It=Tt-Dt*65536,Tt=yt+Dt+65535,Dt=Math.floor(Tt/65536),yt=Tt-Dt*65536,Tt=lt+Dt+65535,Dt=Math.floor(Tt/65536),lt=Tt-Dt*65536,Tt=pt+Dt+65535,Dt=Math.floor(Tt/65536),pt=Tt-Dt*65536,Tt=bt+Dt+65535,Dt=Math.floor(Tt/65536),bt=Tt-Dt*65536,Tt=_t+Dt+65535,Dt=Math.floor(Tt/65536),_t=Tt-Dt*65536,Tt=$t+Dt+65535,Dt=Math.floor(Tt/65536),$t=Tt-Dt*65536,Tt=Ct+Dt+65535,Dt=Math.floor(Tt/65536),Ct=Tt-Dt*65536,Tt=xt+Dt+65535,Dt=Math.floor(Tt/65536),xt=Tt-Dt*65536,Tt=vt+Dt+65535,Dt=Math.floor(Tt/65536),vt=Tt-Dt*65536,Tt=dt+Dt+65535,Dt=Math.floor(Tt/65536),dt=Tt-Dt*65536,Tt=wt+Dt+65535,Dt=Math.floor(Tt/65536),wt=Tt-Dt*65536,Tt=qt+Dt+65535,Dt=Math.floor(Tt/65536),qt=Tt-Dt*65536,Ot+=Dt-1+37*(Dt-1),At[0]=Ot,At[1]=jt,At[2]=Nt,At[3]=It,At[4]=yt,At[5]=lt,At[6]=pt,At[7]=bt,At[8]=_t,At[9]=$t,At[10]=Ct,At[11]=xt,At[12]=vt,At[13]=dt,At[14]=wt,At[15]=qt}function ut(At,kt){ct(At,kt,kt)}function ft(At,kt){const Rt=j();for(let Tt=0;Tt<16;Tt++)Rt[Tt]=kt[Tt];for(let Tt=253;Tt>=0;Tt--)ut(Rt,Rt),Tt!==2&&Tt!==4&&ct(Rt,Rt,kt);for(let Tt=0;Tt<16;Tt++)At[Tt]=Rt[Tt]}function ht(At,kt){const Rt=new Uint8Array(32),Tt=new Float64Array(80),Dt=j(),Ot=j(),jt=j(),Nt=j(),It=j(),yt=j();for(let _t=0;_t<31;_t++)Rt[_t]=At[_t];Rt[31]=At[31]&127|64,Rt[0]&=248,st(Tt,kt);for(let _t=0;_t<16;_t++)Ot[_t]=Tt[_t];Dt[0]=Nt[0]=1;for(let _t=254;_t>=0;--_t){const $t=Rt[_t>>>3]>>>(_t&7)&1;nt(Dt,Ot,$t),nt(jt,Nt,$t),ot(It,Dt,jt),at(Dt,Dt,jt),ot(jt,Ot,Nt),at(Ot,Ot,Nt),ut(Nt,It),ut(yt,Dt),ct(Dt,jt,Dt),ct(jt,Ot,It),ot(It,Dt,jt),at(Dt,Dt,jt),ut(Ot,Dt),at(jt,Nt,yt),ct(Dt,jt,tt),ot(Dt,Dt,Nt),ct(jt,jt,Dt),ct(Dt,Nt,yt),ct(Nt,Ot,Tt),ut(Ot,It),nt(Dt,Ot,$t),nt(jt,Nt,$t)}for(let _t=0;_t<16;_t++)Tt[_t+16]=Dt[_t],Tt[_t+32]=jt[_t],Tt[_t+48]=Ot[_t],Tt[_t+64]=Nt[_t];const lt=Tt.subarray(32),pt=Tt.subarray(16);ft(lt,lt),ct(pt,pt,lt);const bt=new Uint8Array(32);return it(bt,pt),bt}_.scalarMult=ht;function mt(At){return ht(At,et)}_.scalarMultBase=mt;function gt(At){if(At.length!==_.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${_.SECRET_KEY_LENGTH} bytes`);const kt=new Uint8Array(At);return{publicKey:mt(kt),secretKey:kt}}_.generateKeyPairFromSeed=gt;function Et(At){const kt=(0,o.randomBytes)(32,At),Rt=gt(kt);return(0,$.wipe)(kt),Rt}_.generateKeyPair=Et;function St(At,kt,Rt=!1){if(At.length!==_.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(kt.length!==_.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const Tt=ht(At,kt);if(Rt){let Dt=0;for(let Ot=0;Ot<Tt.length;Ot++)Dt|=Tt[Ot];if(Dt===0)throw new Error("X25519: invalid shared key")}return Tt}_.sharedKey=St})(x25519);var xchacha20poly1305={},xchacha20={},chacha={};Object.defineProperty(chacha,"__esModule",{value:!0});var binary_1$1=binary,wipe_1$3=wipe$1,ROUNDS$1=20;function core(_,o,$){for(var j=1634760805,et=857760878,tt=2036477234,rt=1797285236,nt=$[3]<<24|$[2]<<16|$[1]<<8|$[0],it=$[7]<<24|$[6]<<16|$[5]<<8|$[4],st=$[11]<<24|$[10]<<16|$[9]<<8|$[8],ot=$[15]<<24|$[14]<<16|$[13]<<8|$[12],at=$[19]<<24|$[18]<<16|$[17]<<8|$[16],ct=$[23]<<24|$[22]<<16|$[21]<<8|$[20],ut=$[27]<<24|$[26]<<16|$[25]<<8|$[24],ft=$[31]<<24|$[30]<<16|$[29]<<8|$[28],ht=o[3]<<24|o[2]<<16|o[1]<<8|o[0],mt=o[7]<<24|o[6]<<16|o[5]<<8|o[4],gt=o[11]<<24|o[10]<<16|o[9]<<8|o[8],Et=o[15]<<24|o[14]<<16|o[13]<<8|o[12],St=j,At=et,kt=tt,Rt=rt,Tt=nt,Dt=it,Ot=st,jt=ot,Nt=at,It=ct,yt=ut,lt=ft,pt=ht,bt=mt,_t=gt,$t=Et,Ct=0;Ct<ROUNDS$1;Ct+=2)St=St+Tt|0,pt^=St,pt=pt>>>32-16|pt<<16,Nt=Nt+pt|0,Tt^=Nt,Tt=Tt>>>32-12|Tt<<12,At=At+Dt|0,bt^=At,bt=bt>>>32-16|bt<<16,It=It+bt|0,Dt^=It,Dt=Dt>>>32-12|Dt<<12,kt=kt+Ot|0,_t^=kt,_t=_t>>>32-16|_t<<16,yt=yt+_t|0,Ot^=yt,Ot=Ot>>>32-12|Ot<<12,Rt=Rt+jt|0,$t^=Rt,$t=$t>>>32-16|$t<<16,lt=lt+$t|0,jt^=lt,jt=jt>>>32-12|jt<<12,kt=kt+Ot|0,_t^=kt,_t=_t>>>32-8|_t<<8,yt=yt+_t|0,Ot^=yt,Ot=Ot>>>32-7|Ot<<7,Rt=Rt+jt|0,$t^=Rt,$t=$t>>>32-8|$t<<8,lt=lt+$t|0,jt^=lt,jt=jt>>>32-7|jt<<7,At=At+Dt|0,bt^=At,bt=bt>>>32-8|bt<<8,It=It+bt|0,Dt^=It,Dt=Dt>>>32-7|Dt<<7,St=St+Tt|0,pt^=St,pt=pt>>>32-8|pt<<8,Nt=Nt+pt|0,Tt^=Nt,Tt=Tt>>>32-7|Tt<<7,St=St+Dt|0,$t^=St,$t=$t>>>32-16|$t<<16,yt=yt+$t|0,Dt^=yt,Dt=Dt>>>32-12|Dt<<12,At=At+Ot|0,pt^=At,pt=pt>>>32-16|pt<<16,lt=lt+pt|0,Ot^=lt,Ot=Ot>>>32-12|Ot<<12,kt=kt+jt|0,bt^=kt,bt=bt>>>32-16|bt<<16,Nt=Nt+bt|0,jt^=Nt,jt=jt>>>32-12|jt<<12,Rt=Rt+Tt|0,_t^=Rt,_t=_t>>>32-16|_t<<16,It=It+_t|0,Tt^=It,Tt=Tt>>>32-12|Tt<<12,kt=kt+jt|0,bt^=kt,bt=bt>>>32-8|bt<<8,Nt=Nt+bt|0,jt^=Nt,jt=jt>>>32-7|jt<<7,Rt=Rt+Tt|0,_t^=Rt,_t=_t>>>32-8|_t<<8,It=It+_t|0,Tt^=It,Tt=Tt>>>32-7|Tt<<7,At=At+Ot|0,pt^=At,pt=pt>>>32-8|pt<<8,lt=lt+pt|0,Ot^=lt,Ot=Ot>>>32-7|Ot<<7,St=St+Dt|0,$t^=St,$t=$t>>>32-8|$t<<8,yt=yt+$t|0,Dt^=yt,Dt=Dt>>>32-7|Dt<<7;binary_1$1.writeUint32LE(St+j|0,_,0),binary_1$1.writeUint32LE(At+et|0,_,4),binary_1$1.writeUint32LE(kt+tt|0,_,8),binary_1$1.writeUint32LE(Rt+rt|0,_,12),binary_1$1.writeUint32LE(Tt+nt|0,_,16),binary_1$1.writeUint32LE(Dt+it|0,_,20),binary_1$1.writeUint32LE(Ot+st|0,_,24),binary_1$1.writeUint32LE(jt+ot|0,_,28),binary_1$1.writeUint32LE(Nt+at|0,_,32),binary_1$1.writeUint32LE(It+ct|0,_,36),binary_1$1.writeUint32LE(yt+ut|0,_,40),binary_1$1.writeUint32LE(lt+ft|0,_,44),binary_1$1.writeUint32LE(pt+ht|0,_,48),binary_1$1.writeUint32LE(bt+mt|0,_,52),binary_1$1.writeUint32LE(_t+gt|0,_,56),binary_1$1.writeUint32LE($t+Et|0,_,60)}function streamXOR$1(_,o,$,j,et){if(et===void 0&&(et=0),_.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(j.length<$.length)throw new Error("ChaCha: destination is shorter than source");var tt,rt;if(et===0){if(o.length!==8&&o.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");tt=new Uint8Array(16),rt=tt.length-o.length,tt.set(o,rt)}else{if(o.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");tt=o,rt=et}for(var nt=new Uint8Array(64),it=0;it<$.length;it+=64){core(nt,tt,_);for(var st=it;st<it+64&&st<$.length;st++)j[st]=$[st]^nt[st-it];incrementCounter(tt,0,rt)}return wipe_1$3.wipe(nt),et===0&&wipe_1$3.wipe(tt),j}chacha.streamXOR=streamXOR$1;function stream$1(_,o,$,j){return j===void 0&&(j=0),wipe_1$3.wipe($),streamXOR$1(_,o,$,$,j)}chacha.stream=stream$1;function incrementCounter(_,o,$){for(var j=1;$--;)j=j+(_[o]&255)|0,_[o]=j&255,j>>>=8,o++;if(j>0)throw new Error("ChaCha: counter overflow")}Object.defineProperty(xchacha20,"__esModule",{value:!0});var binary_1=binary,wipe_1$2=wipe$1,chacha_1=chacha,ROUNDS=20;function streamXOR(_,o,$,j){if(o.length!==24)throw new Error("XChaCha20 nonce must be 24 bytes");var et=hchacha(_,o.subarray(0,16),new Uint8Array(32)),tt=new Uint8Array(12);tt.set(o.subarray(16),4);var rt=chacha_1.streamXOR(et,tt,$,j);return wipe_1$2.wipe(et),rt}xchacha20.streamXOR=streamXOR;function stream(_,o,$){return wipe_1$2.wipe($),streamXOR(_,o,$,$)}xchacha20.stream=stream;function hchacha(_,o,$){for(var j=1634760805,et=857760878,tt=2036477234,rt=1797285236,nt=_[3]<<24|_[2]<<16|_[1]<<8|_[0],it=_[7]<<24|_[6]<<16|_[5]<<8|_[4],st=_[11]<<24|_[10]<<16|_[9]<<8|_[8],ot=_[15]<<24|_[14]<<16|_[13]<<8|_[12],at=_[19]<<24|_[18]<<16|_[17]<<8|_[16],ct=_[23]<<24|_[22]<<16|_[21]<<8|_[20],ut=_[27]<<24|_[26]<<16|_[25]<<8|_[24],ft=_[31]<<24|_[30]<<16|_[29]<<8|_[28],ht=o[3]<<24|o[2]<<16|o[1]<<8|o[0],mt=o[7]<<24|o[6]<<16|o[5]<<8|o[4],gt=o[11]<<24|o[10]<<16|o[9]<<8|o[8],Et=o[15]<<24|o[14]<<16|o[13]<<8|o[12],St=j,At=et,kt=tt,Rt=rt,Tt=nt,Dt=it,Ot=st,jt=ot,Nt=at,It=ct,yt=ut,lt=ft,pt=ht,bt=mt,_t=gt,$t=Et,Ct=0;Ct<ROUNDS;Ct+=2)St=St+Tt|0,pt^=St,pt=pt>>>32-16|pt<<16,Nt=Nt+pt|0,Tt^=Nt,Tt=Tt>>>32-12|Tt<<12,At=At+Dt|0,bt^=At,bt=bt>>>32-16|bt<<16,It=It+bt|0,Dt^=It,Dt=Dt>>>32-12|Dt<<12,kt=kt+Ot|0,_t^=kt,_t=_t>>>32-16|_t<<16,yt=yt+_t|0,Ot^=yt,Ot=Ot>>>32-12|Ot<<12,Rt=Rt+jt|0,$t^=Rt,$t=$t>>>32-16|$t<<16,lt=lt+$t|0,jt^=lt,jt=jt>>>32-12|jt<<12,kt=kt+Ot|0,_t^=kt,_t=_t>>>32-8|_t<<8,yt=yt+_t|0,Ot^=yt,Ot=Ot>>>32-7|Ot<<7,Rt=Rt+jt|0,$t^=Rt,$t=$t>>>32-8|$t<<8,lt=lt+$t|0,jt^=lt,jt=jt>>>32-7|jt<<7,At=At+Dt|0,bt^=At,bt=bt>>>32-8|bt<<8,It=It+bt|0,Dt^=It,Dt=Dt>>>32-7|Dt<<7,St=St+Tt|0,pt^=St,pt=pt>>>32-8|pt<<8,Nt=Nt+pt|0,Tt^=Nt,Tt=Tt>>>32-7|Tt<<7,St=St+Dt|0,$t^=St,$t=$t>>>32-16|$t<<16,yt=yt+$t|0,Dt^=yt,Dt=Dt>>>32-12|Dt<<12,At=At+Ot|0,pt^=At,pt=pt>>>32-16|pt<<16,lt=lt+pt|0,Ot^=lt,Ot=Ot>>>32-12|Ot<<12,kt=kt+jt|0,bt^=kt,bt=bt>>>32-16|bt<<16,Nt=Nt+bt|0,jt^=Nt,jt=jt>>>32-12|jt<<12,Rt=Rt+Tt|0,_t^=Rt,_t=_t>>>32-16|_t<<16,It=It+_t|0,Tt^=It,Tt=Tt>>>32-12|Tt<<12,kt=kt+jt|0,bt^=kt,bt=bt>>>32-8|bt<<8,Nt=Nt+bt|0,jt^=Nt,jt=jt>>>32-7|jt<<7,Rt=Rt+Tt|0,_t^=Rt,_t=_t>>>32-8|_t<<8,It=It+_t|0,Tt^=It,Tt=Tt>>>32-7|Tt<<7,At=At+Ot|0,pt^=At,pt=pt>>>32-8|pt<<8,lt=lt+pt|0,Ot^=lt,Ot=Ot>>>32-7|Ot<<7,St=St+Dt|0,$t^=St,$t=$t>>>32-8|$t<<8,yt=yt+$t|0,Dt^=yt,Dt=Dt>>>32-7|Dt<<7;return binary_1.writeUint32LE(St,$,0),binary_1.writeUint32LE(At,$,4),binary_1.writeUint32LE(kt,$,8),binary_1.writeUint32LE(Rt,$,12),binary_1.writeUint32LE(pt,$,16),binary_1.writeUint32LE(bt,$,20),binary_1.writeUint32LE(_t,$,24),binary_1.writeUint32LE($t,$,28),$}xchacha20.hchacha=hchacha;var chacha20poly1305={},poly1305={},constantTime={};Object.defineProperty(constantTime,"__esModule",{value:!0});function select$1(_,o,$){return~(_-1)&o|_-1&$}constantTime.select=select$1;function lessOrEqual(_,o){return(_|0)-(o|0)-1>>>31&1}constantTime.lessOrEqual=lessOrEqual;function compare(_,o){if(_.length!==o.length)return 0;for(var $=0,j=0;j<_.length;j++)$|=_[j]^o[j];return 1&$-1>>>8}constantTime.compare=compare;function equal(_,o){return _.length===0||o.length===0?!1:compare(_,o)!==0}constantTime.equal=equal;(function(_){Object.defineProperty(_,"__esModule",{value:!0});var o=constantTime,$=wipe$1;_.DIGEST_LENGTH=16;var j=function(){function rt(nt){this.digestLength=_.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var it=nt[0]|nt[1]<<8;this._r[0]=it&8191;var st=nt[2]|nt[3]<<8;this._r[1]=(it>>>13|st<<3)&8191;var ot=nt[4]|nt[5]<<8;this._r[2]=(st>>>10|ot<<6)&7939;var at=nt[6]|nt[7]<<8;this._r[3]=(ot>>>7|at<<9)&8191;var ct=nt[8]|nt[9]<<8;this._r[4]=(at>>>4|ct<<12)&255,this._r[5]=ct>>>1&8190;var ut=nt[10]|nt[11]<<8;this._r[6]=(ct>>>14|ut<<2)&8191;var ft=nt[12]|nt[13]<<8;this._r[7]=(ut>>>11|ft<<5)&8065;var ht=nt[14]|nt[15]<<8;this._r[8]=(ft>>>8|ht<<8)&8191,this._r[9]=ht>>>5&127,this._pad[0]=nt[16]|nt[17]<<8,this._pad[1]=nt[18]|nt[19]<<8,this._pad[2]=nt[20]|nt[21]<<8,this._pad[3]=nt[22]|nt[23]<<8,this._pad[4]=nt[24]|nt[25]<<8,this._pad[5]=nt[26]|nt[27]<<8,this._pad[6]=nt[28]|nt[29]<<8,this._pad[7]=nt[30]|nt[31]<<8}return rt.prototype._blocks=function(nt,it,st){for(var ot=this._fin?0:2048,at=this._h[0],ct=this._h[1],ut=this._h[2],ft=this._h[3],ht=this._h[4],mt=this._h[5],gt=this._h[6],Et=this._h[7],St=this._h[8],At=this._h[9],kt=this._r[0],Rt=this._r[1],Tt=this._r[2],Dt=this._r[3],Ot=this._r[4],jt=this._r[5],Nt=this._r[6],It=this._r[7],yt=this._r[8],lt=this._r[9];st>=16;){var pt=nt[it+0]|nt[it+1]<<8;at+=pt&8191;var bt=nt[it+2]|nt[it+3]<<8;ct+=(pt>>>13|bt<<3)&8191;var _t=nt[it+4]|nt[it+5]<<8;ut+=(bt>>>10|_t<<6)&8191;var $t=nt[it+6]|nt[it+7]<<8;ft+=(_t>>>7|$t<<9)&8191;var Ct=nt[it+8]|nt[it+9]<<8;ht+=($t>>>4|Ct<<12)&8191,mt+=Ct>>>1&8191;var xt=nt[it+10]|nt[it+11]<<8;gt+=(Ct>>>14|xt<<2)&8191;var vt=nt[it+12]|nt[it+13]<<8;Et+=(xt>>>11|vt<<5)&8191;var dt=nt[it+14]|nt[it+15]<<8;St+=(vt>>>8|dt<<8)&8191,At+=dt>>>5|ot;var wt=0,qt=wt;qt+=at*kt,qt+=ct*(5*lt),qt+=ut*(5*yt),qt+=ft*(5*It),qt+=ht*(5*Nt),wt=qt>>>13,qt&=8191,qt+=mt*(5*jt),qt+=gt*(5*Ot),qt+=Et*(5*Dt),qt+=St*(5*Tt),qt+=At*(5*Rt),wt+=qt>>>13,qt&=8191;var Pt=wt;Pt+=at*Rt,Pt+=ct*kt,Pt+=ut*(5*lt),Pt+=ft*(5*yt),Pt+=ht*(5*It),wt=Pt>>>13,Pt&=8191,Pt+=mt*(5*Nt),Pt+=gt*(5*jt),Pt+=Et*(5*Ot),Pt+=St*(5*Dt),Pt+=At*(5*Tt),wt+=Pt>>>13,Pt&=8191;var Gt=wt;Gt+=at*Tt,Gt+=ct*Rt,Gt+=ut*kt,Gt+=ft*(5*lt),Gt+=ht*(5*yt),wt=Gt>>>13,Gt&=8191,Gt+=mt*(5*It),Gt+=gt*(5*Nt),Gt+=Et*(5*jt),Gt+=St*(5*Ot),Gt+=At*(5*Dt),wt+=Gt>>>13,Gt&=8191;var Wt=wt;Wt+=at*Dt,Wt+=ct*Tt,Wt+=ut*Rt,Wt+=ft*kt,Wt+=ht*(5*lt),wt=Wt>>>13,Wt&=8191,Wt+=mt*(5*yt),Wt+=gt*(5*It),Wt+=Et*(5*Nt),Wt+=St*(5*jt),Wt+=At*(5*Ot),wt+=Wt>>>13,Wt&=8191;var Vt=wt;Vt+=at*Ot,Vt+=ct*Dt,Vt+=ut*Tt,Vt+=ft*Rt,Vt+=ht*kt,wt=Vt>>>13,Vt&=8191,Vt+=mt*(5*lt),Vt+=gt*(5*yt),Vt+=Et*(5*It),Vt+=St*(5*Nt),Vt+=At*(5*jt),wt+=Vt>>>13,Vt&=8191;var Ut=wt;Ut+=at*jt,Ut+=ct*Ot,Ut+=ut*Dt,Ut+=ft*Tt,Ut+=ht*Rt,wt=Ut>>>13,Ut&=8191,Ut+=mt*kt,Ut+=gt*(5*lt),Ut+=Et*(5*yt),Ut+=St*(5*It),Ut+=At*(5*Nt),wt+=Ut>>>13,Ut&=8191;var Mt=wt;Mt+=at*Nt,Mt+=ct*jt,Mt+=ut*Ot,Mt+=ft*Dt,Mt+=ht*Tt,wt=Mt>>>13,Mt&=8191,Mt+=mt*Rt,Mt+=gt*kt,Mt+=Et*(5*lt),Mt+=St*(5*yt),Mt+=At*(5*It),wt+=Mt>>>13,Mt&=8191;var Lt=wt;Lt+=at*It,Lt+=ct*Nt,Lt+=ut*jt,Lt+=ft*Ot,Lt+=ht*Dt,wt=Lt>>>13,Lt&=8191,Lt+=mt*Tt,Lt+=gt*Rt,Lt+=Et*kt,Lt+=St*(5*lt),Lt+=At*(5*yt),wt+=Lt>>>13,Lt&=8191;var Yt=wt;Yt+=at*yt,Yt+=ct*It,Yt+=ut*Nt,Yt+=ft*jt,Yt+=ht*Ot,wt=Yt>>>13,Yt&=8191,Yt+=mt*Dt,Yt+=gt*Tt,Yt+=Et*Rt,Yt+=St*kt,Yt+=At*(5*lt),wt+=Yt>>>13,Yt&=8191;var lr=wt;lr+=at*lt,lr+=ct*yt,lr+=ut*It,lr+=ft*Nt,lr+=ht*jt,wt=lr>>>13,lr&=8191,lr+=mt*Ot,lr+=gt*Dt,lr+=Et*Tt,lr+=St*Rt,lr+=At*kt,wt+=lr>>>13,lr&=8191,wt=(wt<<2)+wt|0,wt=wt+qt|0,qt=wt&8191,wt=wt>>>13,Pt+=wt,at=qt,ct=Pt,ut=Gt,ft=Wt,ht=Vt,mt=Ut,gt=Mt,Et=Lt,St=Yt,At=lr,it+=16,st-=16}this._h[0]=at,this._h[1]=ct,this._h[2]=ut,this._h[3]=ft,this._h[4]=ht,this._h[5]=mt,this._h[6]=gt,this._h[7]=Et,this._h[8]=St,this._h[9]=At},rt.prototype.finish=function(nt,it){it===void 0&&(it=0);var st=new Uint16Array(10),ot,at,ct,ut;if(this._leftover){for(ut=this._leftover,this._buffer[ut++]=1;ut<16;ut++)this._buffer[ut]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(ot=this._h[1]>>>13,this._h[1]&=8191,ut=2;ut<10;ut++)this._h[ut]+=ot,ot=this._h[ut]>>>13,this._h[ut]&=8191;for(this._h[0]+=ot*5,ot=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=ot,ot=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=ot,st[0]=this._h[0]+5,ot=st[0]>>>13,st[0]&=8191,ut=1;ut<10;ut++)st[ut]=this._h[ut]+ot,ot=st[ut]>>>13,st[ut]&=8191;for(st[9]-=1<<13,at=(ot^1)-1,ut=0;ut<10;ut++)st[ut]&=at;for(at=~at,ut=0;ut<10;ut++)this._h[ut]=this._h[ut]&at|st[ut];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,ct=this._h[0]+this._pad[0],this._h[0]=ct&65535,ut=1;ut<8;ut++)ct=(this._h[ut]+this._pad[ut]|0)+(ct>>>16)|0,this._h[ut]=ct&65535;return nt[it+0]=this._h[0]>>>0,nt[it+1]=this._h[0]>>>8,nt[it+2]=this._h[1]>>>0,nt[it+3]=this._h[1]>>>8,nt[it+4]=this._h[2]>>>0,nt[it+5]=this._h[2]>>>8,nt[it+6]=this._h[3]>>>0,nt[it+7]=this._h[3]>>>8,nt[it+8]=this._h[4]>>>0,nt[it+9]=this._h[4]>>>8,nt[it+10]=this._h[5]>>>0,nt[it+11]=this._h[5]>>>8,nt[it+12]=this._h[6]>>>0,nt[it+13]=this._h[6]>>>8,nt[it+14]=this._h[7]>>>0,nt[it+15]=this._h[7]>>>8,this._finished=!0,this},rt.prototype.update=function(nt){var it=0,st=nt.length,ot;if(this._leftover){ot=16-this._leftover,ot>st&&(ot=st);for(var at=0;at<ot;at++)this._buffer[this._leftover+at]=nt[it+at];if(st-=ot,it+=ot,this._leftover+=ot,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(st>=16&&(ot=st-st%16,this._blocks(nt,it,ot),it+=ot,st-=ot),st){for(var at=0;at<st;at++)this._buffer[this._leftover+at]=nt[it+at];this._leftover+=st}return this},rt.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var nt=new Uint8Array(16);return this.finish(nt),nt},rt.prototype.clean=function(){return $.wipe(this._buffer),$.wipe(this._r),$.wipe(this._h),$.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},rt}();_.Poly1305=j;function et(rt,nt){var it=new j(rt);it.update(nt);var st=it.digest();return it.clean(),st}_.oneTimeAuth=et;function tt(rt,nt){return rt.length!==_.DIGEST_LENGTH||nt.length!==_.DIGEST_LENGTH?!1:o.equal(rt,nt)}_.equal=tt})(poly1305);(function(_){Object.defineProperty(_,"__esModule",{value:!0});var o=chacha,$=poly1305,j=wipe$1,et=binary,tt=constantTime;_.KEY_LENGTH=32,_.NONCE_LENGTH=12,_.TAG_LENGTH=16;var rt=new Uint8Array(16),nt=function(){function it(st){if(this.nonceLength=_.NONCE_LENGTH,this.tagLength=_.TAG_LENGTH,st.length!==_.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(st)}return it.prototype.seal=function(st,ot,at,ct){if(st.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var ut=new Uint8Array(16);ut.set(st,ut.length-st.length);var ft=new Uint8Array(32);o.stream(this._key,ut,ft,4);var ht=ot.length+this.tagLength,mt;if(ct){if(ct.length!==ht)throw new Error("ChaCha20Poly1305: incorrect destination length");mt=ct}else mt=new Uint8Array(ht);return o.streamXOR(this._key,ut,ot,mt,4),this._authenticate(mt.subarray(mt.length-this.tagLength,mt.length),ft,mt.subarray(0,mt.length-this.tagLength),at),j.wipe(ut),mt},it.prototype.open=function(st,ot,at,ct){if(st.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(ot.length<this.tagLength)return null;var ut=new Uint8Array(16);ut.set(st,ut.length-st.length);var ft=new Uint8Array(32);o.stream(this._key,ut,ft,4);var ht=new Uint8Array(this.tagLength);if(this._authenticate(ht,ft,ot.subarray(0,ot.length-this.tagLength),at),!tt.equal(ht,ot.subarray(ot.length-this.tagLength,ot.length)))return null;var mt=ot.length-this.tagLength,gt;if(ct){if(ct.length!==mt)throw new Error("ChaCha20Poly1305: incorrect destination length");gt=ct}else gt=new Uint8Array(mt);return o.streamXOR(this._key,ut,ot.subarray(0,ot.length-this.tagLength),gt,4),j.wipe(ut),gt},it.prototype.clean=function(){return j.wipe(this._key),this},it.prototype._authenticate=function(st,ot,at,ct){var ut=new $.Poly1305(ot);ct&&(ut.update(ct),ct.length%16>0&&ut.update(rt.subarray(ct.length%16))),ut.update(at),at.length%16>0&&ut.update(rt.subarray(at.length%16));var ft=new Uint8Array(8);ct&&et.writeUint64LE(ct.length,ft),ut.update(ft),et.writeUint64LE(at.length,ft),ut.update(ft);for(var ht=ut.digest(),mt=0;mt<ht.length;mt++)st[mt]=ht[mt];ut.clean(),j.wipe(ht),j.wipe(ft)},it}();_.ChaCha20Poly1305=nt})(chacha20poly1305);(function(_){Object.defineProperty(_,"__esModule",{value:!0});var o=xchacha20,$=chacha20poly1305,j=wipe$1;_.KEY_LENGTH=32,_.NONCE_LENGTH=24,_.TAG_LENGTH=16;var et=function(){function tt(rt){if(this.nonceLength=_.NONCE_LENGTH,this.tagLength=_.TAG_LENGTH,rt.length!==_.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(rt)}return tt.prototype.seal=function(rt,nt,it,st){if(rt.length!==24)throw new Error("XChaCha20Poly1305: incorrect nonce length");var ot=o.hchacha(this._key,rt.subarray(0,16),new Uint8Array(32)),at=new Uint8Array(12);at.set(rt.subarray(16),4);var ct=new $.ChaCha20Poly1305(ot),ut=ct.seal(at,nt,it,st);return j.wipe(ot),j.wipe(at),ct.clean(),ut},tt.prototype.open=function(rt,nt,it,st){if(rt.length!==24)throw new Error("XChaCha20Poly1305: incorrect nonce length");if(nt.length<this.tagLength)return null;var ot=o.hchacha(this._key,rt.subarray(0,16),new Uint8Array(32)),at=new Uint8Array(12);at.set(rt.subarray(16),4);var ct=new $.ChaCha20Poly1305(ot),ut=ct.open(at,nt,it,st);return j.wipe(ot),j.wipe(at),ct.clean(),ut},tt.prototype.clean=function(){return j.wipe(this._key),this},tt}();_.XChaCha20Poly1305=et})(xchacha20poly1305);function bytesToBase64url(_){return toString$8(_,"base64url")}function base64ToBytes(_){const o=_.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return fromString$6(o,"base64url")}function base58ToBytes(_){return fromString$6(_,"base58btc")}function bytesToBase58(_){return toString$8(_,"base58btc")}function hexToBytes(_){const o=_.startsWith("0x")?_.substring(2):_;return fromString$6(o.toLowerCase(),"base16")}function encodeBase64url(_){return bytesToBase64url(fromString$6(_))}function decodeBase64url(_){return toString$8(base64ToBytes(_))}function bytesToHex(_){return toString$8(_,"base16")}function stringToBytes$4(_){return fromString$6(_)}const zl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],sl=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sr=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],hl=[0,1518500249,1859775393,2400959708,2840853838],hr=[1352829926,1548603684,1836072691,2053994217,0];function rotl(_,o){return _<<o|_>>>32-o}function fn1(_,o,$,j,et,tt,rt,nt){return rotl(_+(o^$^j)+tt+rt|0,nt)+et|0}function fn2(_,o,$,j,et,tt,rt,nt){return rotl(_+(o&$|~o&j)+tt+rt|0,nt)+et|0}function fn3(_,o,$,j,et,tt,rt,nt){return rotl(_+((o|~$)^j)+tt+rt|0,nt)+et|0}function fn4(_,o,$,j,et,tt,rt,nt){return rotl(_+(o&j|$&~j)+tt+rt|0,nt)+et|0}function fn5(_,o,$,j,et,tt,rt,nt){return rotl(_+(o^($|~j))+tt+rt|0,nt)+et|0}class Ripemd160{constructor(o=64){this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this._blockOffset=0,this._block=void 0,this._blockSize=void 0,this._length=[0,0,0,0],this._finalized=void 0,this.update=$=>{if(this._finalized)throw new Error("Digest already called");const j=this._block;let et=0;for(;this._blockOffset+$.length-et>=this._blockSize;){for(let tt=this._blockOffset;tt<this._blockSize;)j[tt++]=$[et++];this._update(),this._blockOffset=0}for(;et<$.length;)j[this._blockOffset++]=$[et++];for(let tt=0,rt=$.length*8;rt>0;++tt)this._length[tt]+=rt,rt=this._length[tt]/4294967296|0,rt>0&&(this._length[tt]-=4294967296*rt);return this},this.digest=()=>{if(this._finalized)throw new Error("Digest already called");this._finalized=!0;const $=this._digest();this._block.fill(0),this._blockOffset=0;for(let j=0;j<4;++j)this._length[j]=0;return $},this._update=()=>{const $=new Array(16),j=new DataView(this._block.buffer);for(let ht=0;ht<16;++ht)$[ht]=$[ht]=j.getInt32(ht*4,!0);let et=this._a|0,tt=this._b|0,rt=this._c|0,nt=this._d|0,it=this._e|0,st=this._a|0,ot=this._b|0,at=this._c|0,ct=this._d|0,ut=this._e|0;for(let ht=0;ht<80;ht+=1){let mt,gt;ht<16?(mt=fn1(et,tt,rt,nt,it,$[zl[ht]],hl[0],sl[ht]),gt=fn5(st,ot,at,ct,ut,$[zr[ht]],hr[0],sr[ht])):ht<32?(mt=fn2(et,tt,rt,nt,it,$[zl[ht]],hl[1],sl[ht]),gt=fn4(st,ot,at,ct,ut,$[zr[ht]],hr[1],sr[ht])):ht<48?(mt=fn3(et,tt,rt,nt,it,$[zl[ht]],hl[2],sl[ht]),gt=fn3(st,ot,at,ct,ut,$[zr[ht]],hr[2],sr[ht])):ht<64?(mt=fn4(et,tt,rt,nt,it,$[zl[ht]],hl[3],sl[ht]),gt=fn2(st,ot,at,ct,ut,$[zr[ht]],hr[3],sr[ht])):(mt=fn5(et,tt,rt,nt,it,$[zl[ht]],hl[4],sl[ht]),gt=fn1(st,ot,at,ct,ut,$[zr[ht]],hr[4],sr[ht])),et=it,it=nt,nt=rotl(rt,10),rt=tt,tt=mt,st=ut,ut=ct,ct=rotl(at,10),at=ot,ot=gt}const ft=this._b+rt+ct|0;this._b=this._c+nt+ut|0,this._c=this._d+it+st|0,this._d=this._e+et+ot|0,this._e=this._a+tt+at|0,this._a=ft},this._digest=()=>{this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56);const $=new DataView(this._block.buffer);$.setUint32(56,this._length[0],!0),$.setUint32(60,this._length[1],!0),this._block=new Uint8Array($.buffer),this._update();const j=new DataView(new Uint8Array(20).buffer);return j.setInt32(0,this._a,!0),j.setInt32(4,this._b,!0),j.setInt32(8,this._c,!0),j.setInt32(12,this._d,!0),j.setInt32(16,this._e,!0),new Uint8Array(j.buffer)},this._block=new Uint8Array(o),this._blockSize=o,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}}function sha256$3(_){const o=typeof _=="string"?fromString$6(_):_;return sha256$4.hash(o)}function keccak(_){return new Uint8Array(sha3.keccak_256.arrayBuffer(_))}function toEthereumAddress(_){const o=fromString$6(_.slice(2),"base16");return`0x${toString$8(keccak(o).slice(-20),"base16")}`}function ripemd160$1(_){return new Ripemd160().update(_).digest()}function writeUint32BE(_,o=new Uint8Array(4)){const $=fromString$6(_.toString(),"base10");return o.set($,4-$.length),o}const lengthAndInput=_=>concat$1([writeUint32BE(_.length),_]);function concatKDF(_,o,$,j,et){if(o!==256)throw new Error(`Unsupported key length: ${o}`);const tt=concat$1([lengthAndInput(fromString$6($)),lengthAndInput(typeof j>"u"?new Uint8Array(0):j),lengthAndInput(typeof et>"u"?new Uint8Array(0):et),writeUint32BE(o)]);return sha256$3(concat$1([writeUint32BE(1),_,tt]))}new elliptic.ec("secp256k1");new elliptic.ec("p256");const publicKeyToAddress$1=(_,o)=>{const $=toString$8(base58ToBytes(o).slice(0,1),"hex"),j=fromString$6(_,"hex"),et=ripemd160$1(sha256$3(j)),tt=$+toString$8(et,"hex"),rt=sha256$3(fromString$6(tt,"hex")),nt=sha256$3(rt),it=toString$8(nt,"hex").substring(0,8),st=tt+it;return bytesToBase58(fromString$6(st,"hex"))},EC$2=elliptic.ec,publicKeyToAddress=(_,o)=>{const j=new EC$2("secp256k1").keyFromPublic(_,"hex").getPublic().encode("hex",!0),et=fromString$6(j,"hex"),tt=ripemd160$1(sha256$3(et)),rt=bech32.toWords(tt);return bech32.encode(o,rt).replace(o,"")},verifyBlockchainAccountId=(_,o)=>{if(o){const $=o.split(":");switch($[0]){case"bip122":$[$.length-1]=publicKeyToAddress$1(_,$[$.length-1]);break;case"cosmos":$[$.length-1]=publicKeyToAddress(_,$[1]);break;case"eip155":$[$.length-1]=toEthereumAddress(_);break;default:return!1}return $.join(":").toLowerCase()===o.toLowerCase()}return!1},secp256k1=new elliptic.ec("secp256k1"),secp256r1=new elliptic.ec("p256");function toSignatureObject(_,o=!1){const $=base64ToBytes(_);if($.length!==(o?65:64))throw new Error("wrong signature length");const j=bytesToHex($.slice(0,32)),et=bytesToHex($.slice(32,64)),tt={r:j,s:et};return o&&(tt.recoveryParam=$[64]),tt}function extractPublicKeyBytes(_){if(_.publicKeyBase58)return base58ToBytes(_.publicKeyBase58);if(_.publicKeyBase64)return base64ToBytes(_.publicKeyBase64);if(_.publicKeyHex)return hexToBytes(_.publicKeyHex);if(_.publicKeyJwk&&_.publicKeyJwk.crv==="secp256k1"&&_.publicKeyJwk.x&&_.publicKeyJwk.y)return hexToBytes(secp256k1.keyFromPublic({x:bytesToHex(base64ToBytes(_.publicKeyJwk.x)),y:bytesToHex(base64ToBytes(_.publicKeyJwk.y))}).getPublic("hex"));if(_.publicKeyJwk&&_.publicKeyJwk.crv==="P-256"&&_.publicKeyJwk.x&&_.publicKeyJwk.y)return hexToBytes(secp256r1.keyFromPublic({x:bytesToHex(base64ToBytes(_.publicKeyJwk.x)),y:bytesToHex(base64ToBytes(_.publicKeyJwk.y))}).getPublic("hex"));if(_.publicKeyJwk&&_.publicKeyJwk.kty==="OKP"&&_.publicKeyJwk.crv==="Ed25519"&&_.publicKeyJwk.x)return base64ToBytes(_.publicKeyJwk.x);if(_.publicKeyMultibase){const{base16:o,base58btc:$,base64:j,base64url:et}=bases$1;return o.decoder.or($.decoder.or(j.decoder.or(et.decoder))).decode(_.publicKeyMultibase)}return new Uint8Array}function verifyES256(_,o,$){const j=sha256$3(_),et=toSignatureObject(o),rt=$.filter(({ethereumAddress:nt,blockchainAccountId:it})=>typeof nt>"u"&&typeof it>"u").find(nt=>{try{const it=extractPublicKeyBytes(nt);return secp256r1.keyFromPublic(it).verify(j,et)}catch{return!1}});if(!rt)throw new Error("invalid_signature: Signature invalid for JWT");return rt}function verifyES256K(_,o,$){const j=sha256$3(_),et=toSignatureObject(o),tt=$.filter(({ethereumAddress:it,blockchainAccountId:st})=>typeof it>"u"&&typeof st>"u"),rt=$.filter(({ethereumAddress:it,blockchainAccountId:st})=>typeof it<"u"||typeof st<"u");let nt=tt.find(it=>{try{const st=extractPublicKeyBytes(it);return secp256k1.keyFromPublic(st).verify(j,et)}catch{return!1}});if(!nt&&rt.length>0&&(nt=verifyRecoverableES256K(_,o,rt)),!nt)throw new Error("invalid_signature: Signature invalid for JWT");return nt}function verifyRecoverableES256K(_,o,$){let j;if(o.length>86)j=[toSignatureObject(o,!0)];else{const rt=toSignatureObject(o,!1);j=[{...rt,recoveryParam:0},{...rt,recoveryParam:1}]}const et=rt=>{const nt=sha256$3(_),it=secp256k1.recoverPubKey(nt,rt,rt.recoveryParam),st=it.encode("hex"),ot=it.encode("hex",!0),at=toEthereumAddress(st).toLowerCase();return $.find(ut=>{var ft,ht,mt;const gt=bytesToHex(extractPublicKeyBytes(ut));return gt===st||gt===ot||((ft=ut.ethereumAddress)==null?void 0:ft.toLowerCase())===at||((ht=ut.blockchainAccountId)==null||(mt=ht.split("@eip155"))==null?void 0:mt[0].toLowerCase())===at||verifyBlockchainAccountId(st,ut.blockchainAccountId)})},tt=j.map(et).filter(rt=>typeof rt<"u");if(tt.length===0)throw new Error("invalid_signature: Signature invalid for JWT");return tt[0]}function verifyEd25519(_,o,$){const j=stringToBytes$4(_),et=base64ToBytes(o),tt=$.find(rt=>ed25519.verify(extractPublicKeyBytes(rt),j,et));if(!tt)throw new Error("invalid_signature: Signature invalid for JWT");return tt}const algorithms={ES256:verifyES256,ES256K:verifyES256K,"ES256K-R":verifyRecoverableES256K,Ed25519:verifyEd25519,EdDSA:verifyEd25519};function VerifierAlgorithm(_){const o=algorithms[_];if(!o)throw new Error(`not_supported: Unsupported algorithm ${_}`);return o}VerifierAlgorithm.toSignatureObject=toSignatureObject;function decodeJWS(_){const o=_.match(/^([a-zA-Z0-9_-]+)\.([a-zA-Z0-9_-]+)\.([a-zA-Z0-9_-]+)$/);if(o)return{header:JSON.parse(decodeBase64url(o[1])),payload:o[2],signature:o[3],data:`${o[1]}.${o[2]}`};throw new Error("invalid_argument: Incorrect format JWS")}function verifyJWSDecoded({header:_,data:o,signature:$},j){return Array.isArray(j)||(j=[j]),VerifierAlgorithm(_.alg)(o,$,j)}function verifyJWS(_,o){const $=decodeJWS(_);return verifyJWSDecoded($,o)}const _iteratorSymbol=typeof Symbol<"u"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function _settle(_,o,$){if(!_.s){if($ instanceof _Pact)if($.s)o&1&&(o=$.s),$=$.v;else{$.o=_settle.bind(null,_,o);return}if($&&$.then){$.then(_settle.bind(null,_,o),_settle.bind(null,_,2));return}_.s=o,_.v=$;const j=_.o;j&&j(_)}}const _Pact=function(){function _(){}return _.prototype.then=function(o,$){const j=new _,et=this.s;if(et){const tt=et&1?o:$;if(tt){try{_settle(j,1,tt(this.v))}catch(rt){_settle(j,2,rt)}return j}else return this}return this.o=function(tt){try{const rt=tt.v;tt.s&1?_settle(j,1,o?o(rt):rt):$?_settle(j,1,$(rt)):_settle(j,2,rt)}catch(rt){_settle(j,2,rt)}},j},_}();function _isSettledPact(_){return _ instanceof _Pact&&_.s&1}function _forTo(_,o,$){var j=-1,et,tt;function rt(nt){try{for(;++j<_.length&&(!$||!$());)if(nt=o(j),nt&&nt.then)if(_isSettledPact(nt))nt=nt.v;else{nt.then(rt,tt||(tt=_settle.bind(null,et=new _Pact,2)));return}et?_settle(et,1,nt):et=nt}catch(it){_settle(et||(et=new _Pact),2,it)}}return rt(),et}function _forOf(_,o,$){if(typeof _[_iteratorSymbol]=="function"){let ot=function(at){try{for(;!(et=j.next()).done&&(!$||!$());)if(at=o(et.value),at&&at.then)if(_isSettledPact(at))at=at.v;else{at.then(ot,rt||(rt=_settle.bind(null,tt=new _Pact,2)));return}tt?_settle(tt,1,at):tt=at}catch(ct){_settle(tt||(tt=new _Pact),2,ct)}};var j=_[_iteratorSymbol](),et,tt,rt;if(ot(),j.return){var nt=function(at){try{et.done||j.return()}catch{}return at};if(tt&&tt.then)return tt.then(nt,function(at){throw nt(at)});nt()}return tt}if(!("length"in _))throw new TypeError("Object is not iterable");for(var it=[],st=0;st<_.length;st++)it.push(_[st]);return _forTo(it,function(ot){return o(it[ot])},$)}function encodeJWE({ciphertext:_,tag:o,iv:$,protectedHeader:j,recipient:et},tt){const rt={protected:j,iv:bytesToBase64url($),ciphertext:bytesToBase64url(_),tag:bytesToBase64url(o)};return tt&&(rt.aad=bytesToBase64url(tt)),et&&(rt.recipients=[et]),rt}const createJWE=function(_,o,$={},j){try{if(o[0].alg==="dir"){if(o.length>1)throw new Error('not_supported: Can only do "dir" encryption to one key.');return Promise.resolve(o[0].encrypt(_,$,j)).then(function(et){return encodeJWE(et,j)})}else{const et=o[0].enc;if(!o.reduce((it,st)=>it&&st.enc===et,!0))throw new Error("invalid_argument: Incompatible encrypters passed");let tt,rt;const nt=_forOf(o,function(it){const st=function(){return tt?Promise.resolve(it.encryptCek==null?void 0:it.encryptCek(tt)).then(function(ot){if(ot){var at,ct;(at=rt)==null||(ct=at.recipients)==null||ct.push(ot)}}):Promise.resolve(it.encrypt(_,$,j)).then(function(ot){tt=ot.cek,rt=encodeJWE(ot,j)})}();if(st&&st.then)return st.then(function(){})});return Promise.resolve(nt&&nt.then?nt.then(function(){return rt}):rt)}}catch(et){return Promise.reject(et)}},resolveX25519Encrypters=function(_,o){try{const $=function(et,tt=[]){try{return Promise.resolve(o.resolve(et)).then(function({didResolutionMetadata:rt,didDocument:nt}){function it(){var at,ct;const ut=(at=nt.keyAgreement)==null||(ct=at.map(ht=>typeof ht=="string"?[...nt.publicKey||[],...nt.verificationMethod||[]].find(mt=>mt.id===ht):ht))==null?void 0:ct.filter(ht=>typeof ht<"u"),ft=(ut==null?void 0:ut.filter(ht=>ht.type==="X25519KeyAgreementKey2019"&&!!ht.publicKeyBase58))||[];if(!ft.length&&!st.length)throw new Error(`no_suitable_keys: Could not find x25519 key for ${et}`);return ft.map(ht=>x25519Encrypter(base58ToBytes(ht.publicKeyBase58),ht.id)).concat(...st)}if(tt.push(et),rt!=null&&rt.error||nt==null)throw new Error(`resolver_error: Could not resolve ${et}: ${rt.error}, ${rt.message}`);let st=[];if(!nt.controller&&!nt.keyAgreement)throw new Error(`no_suitable_keys: Could not find x25519 key for ${et}`);const ot=function(){if(nt.controller){let at=Array.isArray(nt.controller)?nt.controller:[nt.controller];at=at.filter(ut=>!tt.includes(ut));const ct=at.map(ut=>$(ut,tt).catch(()=>[]));return Promise.resolve(Promise.all(ct)).then(function(ut){st=[].concat(...ut)})}}();return ot&&ot.then?ot.then(it):it(ot)})}catch(rt){return Promise.reject(rt)}},j=_.map(et=>$(et));return Promise.resolve(Promise.all(j)).then(function(et){return[].concat(...et)})}catch($){return Promise.reject($)}};function xc20pEncrypter(_){const o=new xchacha20poly1305.XChaCha20Poly1305(_);return($,j)=>{const et=random.randomBytes(o.nonceLength),tt=o.seal(et,$,j);return{ciphertext:tt.subarray(0,tt.length-o.tagLength),tag:tt.subarray(tt.length-o.tagLength),iv:et}}}function xc20pDirEncrypter(_){const o=function(tt,rt={},nt){try{const it=encodeBase64url(JSON.stringify(Object.assign({alg:et},rt,{enc:j}))),st=fromString$6(nt?`${it}.${bytesToBase64url(nt)}`:it);return Promise.resolve({...$(tt,st),protectedHeader:it})}catch(it){return Promise.reject(it)}},$=xc20pEncrypter(_),j="XC20P",et="dir";return{alg:et,enc:j,encrypt:o}}function x25519Encrypter(_,o){const $=function(nt,it={},st){try{Object.assign(it,{alg:void 0});const ot=random.randomBytes(32);return Promise.resolve(xc20pDirEncrypter(ot).encrypt(nt,it,st)).then(function(at){return Promise.resolve(j(ot)).then(function(ct){return{...at,recipient:ct,cek:ot}})})}catch(ot){return Promise.reject(ot)}},j=function(nt){try{const it=x25519.generateKeyPair(),st=x25519.sharedKey(it.secretKey,_),ot=concatKDF(st,tt,et),at=xc20pEncrypter(ot)(nt),ct={encrypted_key:bytesToBase64url(at.ciphertext),header:{alg:et,iv:bytesToBase64url(at.iv),tag:bytesToBase64url(at.tag),epk:{kty:"OKP",crv:rt,x:bytesToBase64url(it.publicKey)}}};return o&&(ct.header.kid=o),Promise.resolve(ct)}catch(it){return Promise.reject(it)}},et="ECDH-ES+XC20PKW",rt="X25519";return{alg:et,enc:"XC20P",encrypt:$,encryptCek:j}}var encode_1$4=encode$s,MSB$7=128,REST$7=127,MSBALL$4=~REST$7,INT$4=Math.pow(2,31);function encode$s(_,o,$){o=o||[],$=$||0;for(var j=$;_>=INT$4;)o[$++]=_&255|MSB$7,_/=128;for(;_&MSBALL$4;)o[$++]=_&255|MSB$7,_>>>=7;return o[$]=_|0,encode$s.bytes=$-j+1,o}var decode$q=read$6,MSB$1$3=128,REST$1$3=127;function read$6(_,j){var $=0,j=j||0,et=0,tt=j,rt,nt=_.length;do{if(tt>=nt)throw read$6.bytes=0,new RangeError("Could not decode varint");rt=_[tt++],$+=et<28?(rt&REST$1$3)<<et:(rt&REST$1$3)*Math.pow(2,et),et+=7}while(rt>=MSB$1$3);return read$6.bytes=tt-j,$}var N1$5=Math.pow(2,7),N2$5=Math.pow(2,14),N3$5=Math.pow(2,21),N4$5=Math.pow(2,28),N5$5=Math.pow(2,35),N6$5=Math.pow(2,42),N7$5=Math.pow(2,49),N8$5=Math.pow(2,56),N9$5=Math.pow(2,63),length$6=function(_){return _<N1$5?1:_<N2$5?2:_<N3$5?3:_<N4$5?4:_<N5$5?5:_<N6$5?6:_<N7$5?7:_<N8$5?8:_<N9$5?9:10},varint$5={encode:encode_1$4,decode:decode$q,encodingLength:length$6},_brrp_varint$2=varint$5;const decode$p=(_,o=0)=>[_brrp_varint$2.decode(_,o),_brrp_varint$2.decode.bytes],encodeTo$2=(_,o,$=0)=>(_brrp_varint$2.encode(_,o,$),o),encodingLength$2=_=>_brrp_varint$2.encodingLength(_),equals$5=(_,o)=>{if(_===o)return!0;if(_.byteLength!==o.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==o[$])return!1;return!0},coerce$2=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},create$8=(_,o)=>{const $=o.byteLength,j=encodingLength$2(_),et=j+encodingLength$2($),tt=new Uint8Array(et+$);return encodeTo$2(_,tt,0),encodeTo$2($,tt,j),tt.set(o,et),new Digest$2(_,$,o,tt)},decode$o=_=>{const o=coerce$2(_),[$,j]=decode$p(o),[et,tt]=decode$p(o.subarray(j)),rt=o.subarray(j+tt);if(rt.byteLength!==et)throw new Error("Incorrect length");return new Digest$2($,et,rt,o)},equals$4=(_,o)=>_===o?!0:_.code===o.code&&_.size===o.size&&equals$5(_.bytes,o.bytes);let Digest$2=class{constructor(o,$,j,et){this.code=o,this.size=$,this.digest=j,this.bytes=et}};function base$4(_,o){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var et=0;et<_.length;et++){var tt=_.charAt(et),rt=tt.charCodeAt(0);if($[rt]!==255)throw new TypeError(tt+" is ambiguous");$[rt]=et}var nt=_.length,it=_.charAt(0),st=Math.log(nt)/Math.log(256),ot=Math.log(256)/Math.log(nt);function at(ft){if(ft instanceof Uint8Array||(ArrayBuffer.isView(ft)?ft=new Uint8Array(ft.buffer,ft.byteOffset,ft.byteLength):Array.isArray(ft)&&(ft=Uint8Array.from(ft))),!(ft instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ft.length===0)return"";for(var ht=0,mt=0,gt=0,Et=ft.length;gt!==Et&&ft[gt]===0;)gt++,ht++;for(var St=(Et-gt)*ot+1>>>0,At=new Uint8Array(St);gt!==Et;){for(var kt=ft[gt],Rt=0,Tt=St-1;(kt!==0||Rt<mt)&&Tt!==-1;Tt--,Rt++)kt+=256*At[Tt]>>>0,At[Tt]=kt%nt>>>0,kt=kt/nt>>>0;if(kt!==0)throw new Error("Non-zero carry");mt=Rt,gt++}for(var Dt=St-mt;Dt!==St&&At[Dt]===0;)Dt++;for(var Ot=it.repeat(ht);Dt<St;++Dt)Ot+=_.charAt(At[Dt]);return Ot}function ct(ft){if(typeof ft!="string")throw new TypeError("Expected String");if(ft.length===0)return new Uint8Array;var ht=0;if(ft[ht]!==" "){for(var mt=0,gt=0;ft[ht]===it;)mt++,ht++;for(var Et=(ft.length-ht)*st+1>>>0,St=new Uint8Array(Et);ft[ht];){var At=$[ft.charCodeAt(ht)];if(At===255)return;for(var kt=0,Rt=Et-1;(At!==0||kt<gt)&&Rt!==-1;Rt--,kt++)At+=nt*St[Rt]>>>0,St[Rt]=At%256>>>0,At=At/256>>>0;if(At!==0)throw new Error("Non-zero carry");gt=kt,ht++}if(ft[ht]!==" "){for(var Tt=Et-gt;Tt!==Et&&St[Tt]===0;)Tt++;for(var Dt=new Uint8Array(mt+(Et-Tt)),Ot=mt;Tt!==Et;)Dt[Ot++]=St[Tt++];return Dt}}}function ut(ft){var ht=ct(ft);if(ht)return ht;throw new Error(`Non-${o} character`)}return{encode:at,decodeUnsafe:ct,decode:ut}}var src$6=base$4,_brrp__multiformats_scope_baseX$2=src$6;let Encoder$4=class{constructor(o,$,j){this.name=o,this.prefix=$,this.baseEncode=j}encode(o){if(o instanceof Uint8Array)return`${this.prefix}${this.baseEncode(o)}`;throw Error("Unknown type, must be binary type")}},Decoder$4=class{constructor(o,$,j){if(this.name=o,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(o){if(typeof o=="string"){if(o.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(o)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(o.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(o){return or$3(this,o)}},ComposedDecoder$2=class{constructor(o){this.decoders=o}or(o){return or$3(this,o)}decode(o){const $=o[0],j=this.decoders[$];if(j)return j.decode(o);throw RangeError(`Unable to decode multibase string ${JSON.stringify(o)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$3=(_,o)=>new ComposedDecoder$2({..._.decoders||{[_.prefix]:_},...o.decoders||{[o.prefix]:o}});let Codec$2=class{constructor(o,$,j,et){this.name=o,this.prefix=$,this.baseEncode=j,this.baseDecode=et,this.encoder=new Encoder$4(o,$,j),this.decoder=new Decoder$4(o,$,et)}encode(o){return this.encoder.encode(o)}decode(o){return this.decoder.decode(o)}};const from$4=({name:_,prefix:o,encode:$,decode:j})=>new Codec$2(_,o,$,j),baseX$2=({prefix:_,name:o,alphabet:$})=>{const{encode:j,decode:et}=_brrp__multiformats_scope_baseX$2($,o);return from$4({prefix:_,name:o,encode:j,decode:tt=>coerce$2(et(tt))})},decode$n=(_,o,$,j)=>{const et={};for(let ot=0;ot<o.length;++ot)et[o[ot]]=ot;let tt=_.length;for(;_[tt-1]==="=";)--tt;const rt=new Uint8Array(tt*$/8|0);let nt=0,it=0,st=0;for(let ot=0;ot<tt;++ot){const at=et[_[ot]];if(at===void 0)throw new SyntaxError(`Non-${j} character`);it=it<<$|at,nt+=$,nt>=8&&(nt-=8,rt[st++]=255&it>>nt)}if(nt>=$||255&it<<8-nt)throw new SyntaxError("Unexpected end of data");return rt},encode$r=(_,o,$)=>{const j=o[o.length-1]==="=",et=(1<<$)-1;let tt="",rt=0,nt=0;for(let it=0;it<_.length;++it)for(nt=nt<<8|_[it],rt+=8;rt>$;)rt-=$,tt+=o[et&nt>>rt];if(rt&&(tt+=o[et&nt<<$-rt]),j)for(;tt.length*$&7;)tt+="=";return tt},rfc4648$2=({name:_,prefix:o,bitsPerChar:$,alphabet:j})=>from$4({prefix:o,name:_,encode(et){return encode$r(et,j,$)},decode(et){return decode$n(et,j,$,_)}}),base58btc$2=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});const base32$3=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});let CID$2=class Bn{constructor(o,$,j,et){this.code=$,this.version=o,this.multihash=j,this.bytes=et,this.byteOffset=et.byteOffset,this.byteLength=et.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:hidden$2,byteLength:hidden$2,code:readonly$4,version:readonly$4,multihash:readonly$4,bytes:readonly$4,_baseCache:hidden$2,asCID:hidden$2})}toV0(){switch(this.version){case 0:return this;default:{const{code:o,multihash:$}=this;if(o!==DAG_PB_CODE$2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if($.code!==SHA_256_CODE$2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Bn.createV0($)}}}toV1(){switch(this.version){case 0:{const{code:o,digest:$}=this.multihash,j=create$8(o,$);return Bn.createV1(this.code,j)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(o){return o&&this.code===o.code&&this.version===o.version&&equals$4(this.multihash,o.multihash)}toString(o){const{bytes:$,version:j,_baseCache:et}=this;switch(j){case 0:return toStringV0$2($,et,o||base58btc$2.encoder);default:return toStringV1$2($,et,o||base32$3.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(o){return deprecate$2(/^0\.0/,IS_CID_DEPRECATION$2),!!(o&&(o[cidSymbol$2]||o.asCID===o))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(o){if(o instanceof Bn)return o;if(o!=null&&o.asCID===o){const{version:$,code:j,multihash:et,bytes:tt}=o;return new Bn($,j,et,tt||encodeCID$3($,j,et.bytes))}else if(o!=null&&o[cidSymbol$2]===!0){const{version:$,multihash:j,code:et}=o,tt=decode$o(j);return Bn.create($,et,tt)}else return null}static create(o,$,j){if(typeof $!="number")throw new Error("String codecs are no longer supported");switch(o){case 0:{if($!==DAG_PB_CODE$2)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$2}) block encoding`);return new Bn(o,$,j,j.bytes)}case 1:{const et=encodeCID$3(o,$,j.bytes);return new Bn(o,$,j,et)}default:throw new Error("Invalid version")}}static createV0(o){return Bn.create(0,DAG_PB_CODE$2,o)}static createV1(o,$){return Bn.create(1,o,$)}static decode(o){const[$,j]=Bn.decodeFirst(o);if(j.length)throw new Error("Incorrect length");return $}static decodeFirst(o){const $=Bn.inspectBytes(o),j=$.size-$.multihashSize,et=coerce$2(o.subarray(j,j+$.multihashSize));if(et.byteLength!==$.multihashSize)throw new Error("Incorrect length");const tt=et.subarray($.multihashSize-$.digestSize),rt=new Digest$2($.multihashCode,$.digestSize,tt,et);return[$.version===0?Bn.createV0(rt):Bn.createV1($.codec,rt),o.subarray($.size)]}static inspectBytes(o){let $=0;const j=()=>{const[at,ct]=decode$p(o.subarray($));return $+=ct,at};let et=j(),tt=DAG_PB_CODE$2;if(et===18?(et=0,$=0):et===1&&(tt=j()),et!==0&&et!==1)throw new RangeError(`Invalid CID version ${et}`);const rt=$,nt=j(),it=j(),st=$+it,ot=st-rt;return{version:et,codec:tt,multihashCode:nt,digestSize:it,multihashSize:ot,size:st}}static parse(o,$){const[j,et]=parseCIDtoBytes$2(o,$),tt=Bn.decode(et);return tt._baseCache.set(j,o),tt}};const parseCIDtoBytes$2=(_,o)=>{switch(_[0]){case"Q":{const $=o||base58btc$2;return[base58btc$2.prefix,$.decode(`${base58btc$2.prefix}${_}`)]}case base58btc$2.prefix:{const $=o||base58btc$2;return[base58btc$2.prefix,$.decode(_)]}case base32$3.prefix:{const $=o||base32$3;return[base32$3.prefix,$.decode(_)]}default:{if(o==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[_[0],o.decode(_)]}}},toStringV0$2=(_,o,$)=>{const{prefix:j}=$;if(j!==base58btc$2.prefix)throw Error(`Cannot string encode V0 in ${$.name} encoding`);const et=o.get(j);if(et==null){const tt=$.encode(_).slice(1);return o.set(j,tt),tt}else return et},toStringV1$2=(_,o,$)=>{const{prefix:j}=$,et=o.get(j);if(et==null){const tt=$.encode(_);return o.set(j,tt),tt}else return et},DAG_PB_CODE$2=112,SHA_256_CODE$2=18,encodeCID$3=(_,o,$)=>{const j=encodingLength$2(_),et=j+encodingLength$2(o),tt=new Uint8Array(et+$.byteLength);return encodeTo$2(_,tt,0),encodeTo$2(o,tt,j),tt.set($,et),tt},cidSymbol$2=Symbol.for("@ipld/js-cid/CID"),readonly$4={writable:!1,configurable:!1,enumerable:!0},hidden$2={writable:!1,enumerable:!1,configurable:!1},version$m="0.0.0-dev",deprecate$2=(_,o)=>{if(_.test(version$m))console.warn(o);else throw new Error(o)},IS_CID_DEPRECATION$2=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,from$3=({name:_,code:o,encode:$})=>new Hasher$1(_,o,$);let Hasher$1=class{constructor(o,$,j){this.name=o,this.code=$,this.encode=j}digest(o){if(o instanceof Uint8Array){const $=this.encode(o);return $ instanceof Uint8Array?create$8(this.code,$):$.then(j=>create$8(this.code,j))}else throw Error("Unknown type, must be binary type")}};const readonly$3=({enumerable:_=!0,configurable:o=!1}={})=>({enumerable:_,configurable:o,writable:!1}),links$2=function*(_,o){if(_!=null&&!(_ instanceof Uint8Array))for(const[$,j]of Object.entries(_)){const et=[...o,$];if(j!=null&&typeof j=="object")if(Array.isArray(j))for(const[tt,rt]of j.entries()){const nt=[...et,tt],it=CID$2.asCID(rt);it?yield[nt.join("/"),it]:typeof rt=="object"&&(yield*links$2(rt,nt))}else{const tt=CID$2.asCID(j);tt?yield[et.join("/"),tt]:yield*links$2(j,et)}}},tree$1=function*(_,o){if(_!=null)for(const[$,j]of Object.entries(_)){const et=[...o,$];if(yield et.join("/"),j!=null&&!(j instanceof Uint8Array)&&typeof j=="object"&&!CID$2.asCID(j))if(Array.isArray(j))for(const[tt,rt]of j.entries()){const nt=[...et,tt];yield nt.join("/"),typeof rt=="object"&&!CID$2.asCID(rt)&&(yield*tree$1(rt,nt))}else yield*tree$1(j,et)}},get$3=(_,o)=>{let $=_;for(const[j,et]of o.entries()){if($=$[et],$==null)throw new Error(`Object has no property at ${o.slice(0,j+1).map(rt=>`[${JSON.stringify(rt)}]`).join("")}`);const tt=CID$2.asCID($);if(tt)return{value:tt,remaining:o.slice(j+1).join("/")}}return{value:$}};let Block$1=class{constructor({cid:o,bytes:$,value:j}){if(!o||!$||typeof j>"u")throw new Error("Missing required argument");this.cid=o,this.bytes=$,this.value=j,this.asBlock=this,Object.defineProperties(this,{cid:readonly$3(),bytes:readonly$3(),value:readonly$3(),asBlock:readonly$3()})}links(){return links$2(this.value,[])}tree(){return tree$1(this.value,[])}get(o="/"){return get$3(this.value,o.split("/").filter(Boolean))}};const encode$q=async({value:_,codec:o,hasher:$})=>{if(typeof _>"u")throw new Error('Missing required argument "value"');if(!o||!$)throw new Error("Missing required argument: codec or hasher");const j=o.encode(_),et=await $.digest(j),tt=CID$2.create(1,o.code,et);return new Block$1({value:_,bytes:j,cid:tt})},sha$1=_=>async o=>new Uint8Array(await crypto.subtle.digest(_,o)),sha256$2=from$3({name:"sha2-256",code:18,encode:sha$1("SHA-256")}),code$4=0,name$5="identity",encode$p=coerce$2,digest=_=>create$8(code$4,encode$p(_)),identity$1={code:code$4,name:name$5,encode:encode$p,digest};rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});const CID_CBOR_TAG$1=42;function cidEncoder$2(_){if(_.asCID!==_)return null;const o=CID$2.asCID(_);if(!o)return null;const $=new Uint8Array(o.bytes.byteLength+1);return $.set(o.bytes,1),[new Token(Type.tag,CID_CBOR_TAG$1),new Token(Type.bytes,$)]}function undefinedEncoder$2(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$2(_){if(Number.isNaN(_))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(_===1/0||_===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions$2={float64:!0,typeEncoders:{Object:cidEncoder$2,undefined:undefinedEncoder$2,number:numberEncoder$2}};function cidDecoder$1(_){if(_[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$2.decode(_.subarray(1))}const decodeOptions$2={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};decodeOptions$2.tags[CID_CBOR_TAG$1]=cidDecoder$1;const name$4="dag-cbor",code$3=113,encode$o=_=>encode$A(_,encodeOptions$2),decode$m=_=>decode$x(_,decodeOptions$2),dagCBOR=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$m,encode:encode$o,name:name$4},Symbol.toStringTag,{value:"Module"})),ENC_BLOCK_SIZE=24;async function encodePayload$1(_){const o=await encode$q({value:_,codec:dagCBOR,hasher:sha256$2});return{cid:o.cid,linkedBlock:o.bytes}}function pad(_,o=ENC_BLOCK_SIZE){const $=(o-_.length%o)%o,j=new Uint8Array(_.length+$);return j.set(_,0),j}async function encodeIdentityCID(_){return(await encode$q({value:_,codec:dagCBOR,hasher:identity$1})).cid}function decodeIdentityCID(_){if(_=CID$2.asCID(_),_.code!==code$3)throw new Error("CID codec must be dag-cbor");if(_.multihash.code!==identity$1.code)throw new Error("CID must use identity multihash");return decode$m(_.multihash.digest)}async function prepareCleartext(_,o){return pad((await encodeIdentityCID(_)).bytes,o)}function decodeCleartext(_){return decodeIdentityCID(CID$2.decodeFirst(_)[0])}const abortedReasonSymbol=Symbol("aborted");function abortable(_,o){if(o.aborted)return Promise.reject(abortedReasonSymbol);let $;const j=new Promise((et,tt)=>{$=tt});return o.addEventListener("abort",()=>{$(abortedReasonSymbol)}),Promise.race([_,j])}let nanoid$1=(_=21)=>crypto.getRandomValues(new Uint8Array(_)).reduce((o,$)=>($&=63,$<36?o+=$.toString(36):$<62?o+=($-26).toString(36).toUpperCase():$>62?o+="-":o+="_",o),"");const ABORT_REQUEST_METHOD="utils_abort_request";var ERROR_CODE;(function(_){_[_.PARSE_ERROR=-32700]="PARSE_ERROR",_[_.INVALID_REQUEST=-32600]="INVALID_REQUEST",_[_.METHOD_NOT_FOUND=-32601]="METHOD_NOT_FOUND",_[_.INVALID_PARAMS=-32602]="INVALID_PARAMS",_[_.INTERNAL_ERROR=-32603]="INTERNAL_ERROR"})(ERROR_CODE||(ERROR_CODE={}));const ERROR_MESSAGE={[ERROR_CODE.PARSE_ERROR]:"Parse error",[ERROR_CODE.INVALID_REQUEST]:"Invalid request",[ERROR_CODE.METHOD_NOT_FOUND]:"Method not found",[ERROR_CODE.INVALID_PARAMS]:"Invalid params",[ERROR_CODE.INTERNAL_ERROR]:"Internal error"};function isServerError(_){return-32e3>=_&&_>=-32099}function getErrorMessage(_){return ERROR_MESSAGE[_.toString()]??(isServerError(_)?"Server error":"Application error")}class RPCError extends Error{static fromObject(o){return new RPCError(o.code,o.message,o.data)}toObject(){return{code:this.code,data:this.data,message:this.message}}constructor(o,$,j){super(),Object.setPrototypeOf(this,RPCError.prototype),this.code=o,this.data=j,this.message=$??getErrorMessage(o)}}function createErrorFactory(_){const o=ERROR_MESSAGE[_];return function(j){return new RPCError(_,o,j)}}createErrorFactory(ERROR_CODE.PARSE_ERROR);createErrorFactory(ERROR_CODE.INVALID_REQUEST);createErrorFactory(ERROR_CODE.METHOD_NOT_FOUND);createErrorFactory(ERROR_CODE.INVALID_PARAMS);createErrorFactory(ERROR_CODE.INTERNAL_ERROR);function _checkPrivateRedeclaration(_,o){if(o.has(_))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classApplyDescriptorGet(_,o){return o.get?o.get.call(_):o.value}function _classApplyDescriptorSet(_,o,$){if(o.set)o.set.call(_,$);else{if(!o.writable)throw new TypeError("attempted to set read only private field");o.value=$}}function _classExtractFieldDescriptor(_,o,$){if(!o.has(_))throw new TypeError("attempted to "+$+" private field on non-instance");return o.get(_)}function _classPrivateFieldGet(_,o){var $=_classExtractFieldDescriptor(_,o,"get");return _classApplyDescriptorGet(_,$)}function _classPrivateFieldInit(_,o,$){_checkPrivateRedeclaration(_,o),o.set(_,$)}function _classPrivateFieldSet(_,o,$){var j=_classExtractFieldDescriptor(_,o,"set");return _classApplyDescriptorSet(_,j,$),$}var _connection=new WeakMap;class RPCClient{get connection(){return _classPrivateFieldGet(this,_connection)}createID(){return nanoid$1()}request(o,$=void 0,j={}){const{signal:et}=j;if(et!=null&&et.aborted)return Promise.reject(abortedReasonSymbol);const tt=this.createID(),rt=_classPrivateFieldGet(this,_connection).send({jsonrpc:"2.0",id:tt,method:o,params:$}).then(nt=>{if(nt==null)throw new Error("Missing response");if(nt.error!=null)throw RPCError.fromObject(nt.error);return nt.result});return et==null?rt:(et.addEventListener("abort",()=>{this.notify(ABORT_REQUEST_METHOD,{id:tt})}),abortable(rt,et))}async notify(o,$=void 0){await _classPrivateFieldGet(this,_connection).send({jsonrpc:"2.0",method:o,params:$})}constructor(o){_classPrivateFieldInit(this,_connection,{writable:!0,value:void 0}),_classPrivateFieldSet(this,_connection,o)}}var encode_1$3=encode$n,MSB$6=128,REST$6=127,MSBALL$3=~REST$6,INT$3=Math.pow(2,31);function encode$n(_,o,$){o=o||[],$=$||0;for(var j=$;_>=INT$3;)o[$++]=_&255|MSB$6,_/=128;for(;_&MSBALL$3;)o[$++]=_&255|MSB$6,_>>>=7;return o[$]=_|0,encode$n.bytes=$-j+1,o}var decode$l=read$5,MSB$1$2=128,REST$1$2=127;function read$5(_,j){var $=0,j=j||0,et=0,tt=j,rt,nt=_.length;do{if(tt>=nt)throw read$5.bytes=0,new RangeError("Could not decode varint");rt=_[tt++],$+=et<28?(rt&REST$1$2)<<et:(rt&REST$1$2)*Math.pow(2,et),et+=7}while(rt>=MSB$1$2);return read$5.bytes=tt-j,$}var N1$4=Math.pow(2,7),N2$4=Math.pow(2,14),N3$4=Math.pow(2,21),N4$4=Math.pow(2,28),N5$4=Math.pow(2,35),N6$4=Math.pow(2,42),N7$4=Math.pow(2,49),N8$4=Math.pow(2,56),N9$4=Math.pow(2,63),length$5=function(_){return _<N1$4?1:_<N2$4?2:_<N3$4?3:_<N4$4?4:_<N5$4?5:_<N6$4?6:_<N7$4?7:_<N8$4?8:_<N9$4?9:10},varint$4={encode:encode_1$3,decode:decode$l,encodingLength:length$5},_brrp_varint$1=varint$4;const decode$k=(_,o=0)=>[_brrp_varint$1.decode(_,o),_brrp_varint$1.decode.bytes],encodeTo$1=(_,o,$=0)=>(_brrp_varint$1.encode(_,o,$),o),encodingLength$1=_=>_brrp_varint$1.encodingLength(_),equals$3=(_,o)=>{if(_===o)return!0;if(_.byteLength!==o.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==o[$])return!1;return!0},coerce$1=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},fromString$5=_=>new TextEncoder().encode(_),toString$7=_=>new TextDecoder().decode(_),create$7=(_,o)=>{const $=o.byteLength,j=encodingLength$1(_),et=j+encodingLength$1($),tt=new Uint8Array(et+$);return encodeTo$1(_,tt,0),encodeTo$1($,tt,j),tt.set(o,et),new Digest$1(_,$,o,tt)},decode$j=_=>{const o=coerce$1(_),[$,j]=decode$k(o),[et,tt]=decode$k(o.subarray(j)),rt=o.subarray(j+tt);if(rt.byteLength!==et)throw new Error("Incorrect length");return new Digest$1($,et,rt,o)},equals$2=(_,o)=>_===o?!0:_.code===o.code&&_.size===o.size&&equals$3(_.bytes,o.bytes);let Digest$1=class{constructor(o,$,j,et){this.code=o,this.size=$,this.digest=j,this.bytes=et}};function base$3(_,o){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var et=0;et<_.length;et++){var tt=_.charAt(et),rt=tt.charCodeAt(0);if($[rt]!==255)throw new TypeError(tt+" is ambiguous");$[rt]=et}var nt=_.length,it=_.charAt(0),st=Math.log(nt)/Math.log(256),ot=Math.log(256)/Math.log(nt);function at(ft){if(ft instanceof Uint8Array||(ArrayBuffer.isView(ft)?ft=new Uint8Array(ft.buffer,ft.byteOffset,ft.byteLength):Array.isArray(ft)&&(ft=Uint8Array.from(ft))),!(ft instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ft.length===0)return"";for(var ht=0,mt=0,gt=0,Et=ft.length;gt!==Et&&ft[gt]===0;)gt++,ht++;for(var St=(Et-gt)*ot+1>>>0,At=new Uint8Array(St);gt!==Et;){for(var kt=ft[gt],Rt=0,Tt=St-1;(kt!==0||Rt<mt)&&Tt!==-1;Tt--,Rt++)kt+=256*At[Tt]>>>0,At[Tt]=kt%nt>>>0,kt=kt/nt>>>0;if(kt!==0)throw new Error("Non-zero carry");mt=Rt,gt++}for(var Dt=St-mt;Dt!==St&&At[Dt]===0;)Dt++;for(var Ot=it.repeat(ht);Dt<St;++Dt)Ot+=_.charAt(At[Dt]);return Ot}function ct(ft){if(typeof ft!="string")throw new TypeError("Expected String");if(ft.length===0)return new Uint8Array;var ht=0;if(ft[ht]!==" "){for(var mt=0,gt=0;ft[ht]===it;)mt++,ht++;for(var Et=(ft.length-ht)*st+1>>>0,St=new Uint8Array(Et);ft[ht];){var At=$[ft.charCodeAt(ht)];if(At===255)return;for(var kt=0,Rt=Et-1;(At!==0||kt<gt)&&Rt!==-1;Rt--,kt++)At+=nt*St[Rt]>>>0,St[Rt]=At%256>>>0,At=At/256>>>0;if(At!==0)throw new Error("Non-zero carry");gt=kt,ht++}if(ft[ht]!==" "){for(var Tt=Et-gt;Tt!==Et&&St[Tt]===0;)Tt++;for(var Dt=new Uint8Array(mt+(Et-Tt)),Ot=mt;Tt!==Et;)Dt[Ot++]=St[Tt++];return Dt}}}function ut(ft){var ht=ct(ft);if(ht)return ht;throw new Error(`Non-${o} character`)}return{encode:at,decodeUnsafe:ct,decode:ut}}var src$5=base$3,_brrp__multiformats_scope_baseX$1=src$5;let Encoder$3=class{constructor(o,$,j){this.name=o,this.prefix=$,this.baseEncode=j}encode(o){if(o instanceof Uint8Array)return`${this.prefix}${this.baseEncode(o)}`;throw Error("Unknown type, must be binary type")}},Decoder$3=class{constructor(o,$,j){if(this.name=o,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(o){if(typeof o=="string"){if(o.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(o)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(o.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(o){return or$2(this,o)}},ComposedDecoder$1=class{constructor(o){this.decoders=o}or(o){return or$2(this,o)}decode(o){const $=o[0],j=this.decoders[$];if(j)return j.decode(o);throw RangeError(`Unable to decode multibase string ${JSON.stringify(o)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$2=(_,o)=>new ComposedDecoder$1({..._.decoders||{[_.prefix]:_},...o.decoders||{[o.prefix]:o}});let Codec$1=class{constructor(o,$,j,et){this.name=o,this.prefix=$,this.baseEncode=j,this.baseDecode=et,this.encoder=new Encoder$3(o,$,j),this.decoder=new Decoder$3(o,$,et)}encode(o){return this.encoder.encode(o)}decode(o){return this.decoder.decode(o)}};const from$2=({name:_,prefix:o,encode:$,decode:j})=>new Codec$1(_,o,$,j),baseX$1=({prefix:_,name:o,alphabet:$})=>{const{encode:j,decode:et}=_brrp__multiformats_scope_baseX$1($,o);return from$2({prefix:_,name:o,encode:j,decode:tt=>coerce$1(et(tt))})},decode$i=(_,o,$,j)=>{const et={};for(let ot=0;ot<o.length;++ot)et[o[ot]]=ot;let tt=_.length;for(;_[tt-1]==="=";)--tt;const rt=new Uint8Array(tt*$/8|0);let nt=0,it=0,st=0;for(let ot=0;ot<tt;++ot){const at=et[_[ot]];if(at===void 0)throw new SyntaxError(`Non-${j} character`);it=it<<$|at,nt+=$,nt>=8&&(nt-=8,rt[st++]=255&it>>nt)}if(nt>=$||255&it<<8-nt)throw new SyntaxError("Unexpected end of data");return rt},encode$m=(_,o,$)=>{const j=o[o.length-1]==="=",et=(1<<$)-1;let tt="",rt=0,nt=0;for(let it=0;it<_.length;++it)for(nt=nt<<8|_[it],rt+=8;rt>$;)rt-=$,tt+=o[et&nt>>rt];if(rt&&(tt+=o[et&nt<<$-rt]),j)for(;tt.length*$&7;)tt+="=";return tt},rfc4648$1=({name:_,prefix:o,bitsPerChar:$,alphabet:j})=>from$2({prefix:o,name:_,encode(et){return encode$m(et,j,$)},decode(et){return decode$i(et,j,$,_)}}),base58btc$1=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$1,base58flickr},Symbol.toStringTag,{value:"Module"})),base32$1=rfc4648$1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648$1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648$1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648$1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648$1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648$1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648$1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648$1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648$1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$2=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$1,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper,base32z},Symbol.toStringTag,{value:"Module"}));let CID$1=class Nn{constructor(o,$,j,et){this.code=$,this.version=o,this.multihash=j,this.bytes=et,this.byteOffset=et.byteOffset,this.byteLength=et.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:hidden$1,byteLength:hidden$1,code:readonly$2,version:readonly$2,multihash:readonly$2,bytes:readonly$2,_baseCache:hidden$1,asCID:hidden$1})}toV0(){switch(this.version){case 0:return this;default:{const{code:o,multihash:$}=this;if(o!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if($.code!==SHA_256_CODE$1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Nn.createV0($)}}}toV1(){switch(this.version){case 0:{const{code:o,digest:$}=this.multihash,j=create$7(o,$);return Nn.createV1(this.code,j)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(o){return o&&this.code===o.code&&this.version===o.version&&equals$2(this.multihash,o.multihash)}toString(o){const{bytes:$,version:j,_baseCache:et}=this;switch(j){case 0:return toStringV0$1($,et,o||base58btc$1.encoder);default:return toStringV1$1($,et,o||base32$1.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(o){return deprecate$1(/^0\.0/,IS_CID_DEPRECATION$1),!!(o&&(o[cidSymbol$1]||o.asCID===o))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(o){if(o instanceof Nn)return o;if(o!=null&&o.asCID===o){const{version:$,code:j,multihash:et,bytes:tt}=o;return new Nn($,j,et,tt||encodeCID$2($,j,et.bytes))}else if(o!=null&&o[cidSymbol$1]===!0){const{version:$,multihash:j,code:et}=o,tt=decode$j(j);return Nn.create($,et,tt)}else return null}static create(o,$,j){if(typeof $!="number")throw new Error("String codecs are no longer supported");switch(o){case 0:{if($!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new Nn(o,$,j,j.bytes)}case 1:{const et=encodeCID$2(o,$,j.bytes);return new Nn(o,$,j,et)}default:throw new Error("Invalid version")}}static createV0(o){return Nn.create(0,DAG_PB_CODE$1,o)}static createV1(o,$){return Nn.create(1,o,$)}static decode(o){const[$,j]=Nn.decodeFirst(o);if(j.length)throw new Error("Incorrect length");return $}static decodeFirst(o){const $=Nn.inspectBytes(o),j=$.size-$.multihashSize,et=coerce$1(o.subarray(j,j+$.multihashSize));if(et.byteLength!==$.multihashSize)throw new Error("Incorrect length");const tt=et.subarray($.multihashSize-$.digestSize),rt=new Digest$1($.multihashCode,$.digestSize,tt,et);return[$.version===0?Nn.createV0(rt):Nn.createV1($.codec,rt),o.subarray($.size)]}static inspectBytes(o){let $=0;const j=()=>{const[at,ct]=decode$k(o.subarray($));return $+=ct,at};let et=j(),tt=DAG_PB_CODE$1;if(et===18?(et=0,$=0):et===1&&(tt=j()),et!==0&&et!==1)throw new RangeError(`Invalid CID version ${et}`);const rt=$,nt=j(),it=j(),st=$+it,ot=st-rt;return{version:et,codec:tt,multihashCode:nt,digestSize:it,multihashSize:ot,size:st}}static parse(o,$){const[j,et]=parseCIDtoBytes$1(o,$),tt=Nn.decode(et);return tt._baseCache.set(j,o),tt}};const parseCIDtoBytes$1=(_,o)=>{switch(_[0]){case"Q":{const $=o||base58btc$1;return[base58btc$1.prefix,$.decode(`${base58btc$1.prefix}${_}`)]}case base58btc$1.prefix:{const $=o||base58btc$1;return[base58btc$1.prefix,$.decode(_)]}case base32$1.prefix:{const $=o||base32$1;return[base32$1.prefix,$.decode(_)]}default:{if(o==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[_[0],o.decode(_)]}}},toStringV0$1=(_,o,$)=>{const{prefix:j}=$;if(j!==base58btc$1.prefix)throw Error(`Cannot string encode V0 in ${$.name} encoding`);const et=o.get(j);if(et==null){const tt=$.encode(_).slice(1);return o.set(j,tt),tt}else return et},toStringV1$1=(_,o,$)=>{const{prefix:j}=$,et=o.get(j);if(et==null){const tt=$.encode(_);return o.set(j,tt),tt}else return et},DAG_PB_CODE$1=112,SHA_256_CODE$1=18,encodeCID$2=(_,o,$)=>{const j=encodingLength$1(_),et=j+encodingLength$1(o),tt=new Uint8Array(et+$.byteLength);return encodeTo$1(_,tt,0),encodeTo$1(o,tt,j),tt.set($,et),tt},cidSymbol$1=Symbol.for("@ipld/js-cid/CID"),readonly$2={writable:!1,configurable:!1,enumerable:!0},hidden$1={writable:!1,enumerable:!1,configurable:!1},version$l="0.0.0-dev",deprecate$1=(_,o)=>{if(_.test(version$l))console.warn(o);else throw new Error(o)},IS_CID_DEPRECATION$1=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var identifiers={ALT:1,CAT:2,REP:3,RNM:4,TRG:5,TBS:6,TLS:7,UDT:11,AND:12,NOT:13,BKR:14,BKA:15,BKN:16,ABG:17,AEN:18,ACTIVE:100,MATCH:101,EMPTY:102,NOMATCH:103,SEM_PRE:200,SEM_POST:201,SEM_OK:300,SEM_SKIP:301,ATTR_N:400,ATTR_R:401,ATTR_MR:402,LOOKAROUND_NONE:500,LOOKAROUND_AHEAD:501,LOOKAROUND_BEHIND:502,BKR_MODE_UM:601,BKR_MODE_PM:602,BKR_MODE_CS:603,BKR_MODE_CI:604},utilities={},style$1={CLASS_MONOSPACE:"apg-mono",CLASS_ACTIVE:"apg-active",CLASS_EMPTY:"apg-empty",CLASS_MATCH:"apg-match",CLASS_NOMATCH:"apg-nomatch",CLASS_LOOKAHEAD:"apg-lh-match",CLASS_LOOKBEHIND:"apg-lb-match",CLASS_REMAINDER:"apg-remainder",CLASS_CTRLCHAR:"apg-ctrl-char",CLASS_LINEEND:"apg-line-end",CLASS_ERROR:"apg-error",CLASS_PHRASE:"apg-phrase",CLASS_EMPTYPHRASE:"apg-empty-phrase",CLASS_STATE:"apg-state",CLASS_STATS:"apg-stats",CLASS_TRACE:"apg-trace",CLASS_GRAMMAR:"apg-grammar",CLASS_RULES:"apg-rules",CLASS_RULESLINK:"apg-rules-link",CLASS_ATTRIBUTES:"apg-attrs"},converter$1={},transformers={};const thisThis$2=commonjsGlobal,NON_SHORTEST=4294967292,TRAILING=4294967293,RANGE=4294967294,ILL_FORMED=4294967295,mask=[0,1,3,7,15,31,63,127,255,511,1023],ascii$1=["00","01","02","03","04","05","06","07","08","09","0A","0B","0C","0D","0E","0F","10","11","12","13","14","15","16","17","18","19","1A","1B","1C","1D","1E","1F","20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E","7F","80","81","82","83","84","85","86","87","88","89","8A","8B","8C","8D","8E","8F","90","91","92","93","94","95","96","97","98","99","9A","9B","9C","9D","9E","9F","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","AA","AB","AC","AD","AE","AF","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","BA","BB","BC","BD","BE","BF","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","CA","CB","CC","CD","CE","CF","D0","D1","D2","D3","D4","D5","D6","D7","D8","D9","DA","DB","DC","DD","DE","DF","E0","E1","E2","E3","E4","E5","E6","E7","E8","E9","EA","EB","EC","ED","EE","EF","F0","F1","F2","F3","F4","F5","F6","F7","F8","F9","FA","FB","FC","FD","FE","FF"],base64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),base64codes=[];base64chars.forEach(_=>{base64codes.push(_.charCodeAt(0))});transformers.utf8={encode(_){const o=[];return _.forEach($=>{if($>=0&&$<=127)o.push($);else if($<=2047)o.push(192+($>>6&mask[5])),o.push(128+($&mask[6]));else if($<55296||$>57343&&$<=65535)o.push(224+($>>12&mask[4])),o.push(128+($>>6&mask[6])),o.push(128+($&mask[6]));else if($>=65536&&$<=1114111){const j=$>>16&mask[5];o.push(240+(j>>2)),o.push(128+((j&mask[2])<<4)+($>>12&mask[4])),o.push(128+($>>6&mask[6])),o.push(128+($&mask[6]))}else throw new RangeError(`utf8.encode: character out of range: char: ${$}`)}),buffer$2.Buffer.from(o)},decode(_,o){function $(ft,ht){if((ht&192)!==128)return TRAILING;const mt=((ft&mask[5])<<6)+(ht&mask[6]);return mt<128?NON_SHORTEST:mt}function j(ft,ht,mt){if((mt&192)!==128||(ht&192)!==128)return TRAILING;const gt=((ft&mask[4])<<12)+((ht&mask[6])<<6)+(mt&mask[6]);return gt<2048?NON_SHORTEST:gt>=55296&&gt<=57343?RANGE:gt}function et(ft,ht,mt,gt){if((gt&192)!==128||(mt&192)!==128||(ht&192)!==128)return TRAILING;const Et=(((ft&mask[3])<<2)+(ht>>4&mask[2])<<16)+((ht&mask[4])<<12)+((mt&mask[6])<<6)+(gt&mask[6]);return Et<65536?NON_SHORTEST:Et>1114111?RANGE:Et}let tt,rt,nt,it,st,ot;const at=_.length;let ct=o?3:0;const ut=[];for(;ct<at;){rt=_[ct],tt=ILL_FORMED;const ft=!0;for(;ft;){if(rt>=0&&rt<=127){tt=rt,ot=1;break}if(nt=ct+1,nt<at&&rt>=194&&rt<=223){tt=$(rt,_[nt]),ot=2;break}if(it=ct+2,it<at&&rt>=224&&rt<=239){tt=j(rt,_[nt],_[it]),ot=3;break}if(st=ct+3,st<at&&rt>=240&&rt<=244){tt=et(rt,_[nt],_[it],_[st]),ot=4;break}break}if(tt>1114111){const ht=`byte[${ct}]`;throw tt===ILL_FORMED?new RangeError(`utf8.decode: ill-formed UTF8 byte sequence found at: ${ht}`):tt===TRAILING?new RangeError(`utf8.decode: illegal trailing byte found at: ${ht}`):tt===RANGE?new RangeError(`utf8.decode: code point out of range found at: ${ht}`):tt===NON_SHORTEST?new RangeError(`utf8.decode: non-shortest form found at: ${ht}`):new RangeError(`utf8.decode: unrecognized error found at: ${ht}`)}ut.push(tt),ct+=ot}return ut}};transformers.utf16be={encode(_){const o=[];let $,j,et;for(let tt=0;tt<_.length;tt+=1)if($=_[tt],$>=0&&$<=55295||$>=57344&&$<=65535)o.push($>>8&mask[8]),o.push($&mask[8]);else if($>=65536&&$<=1114111)et=$-65536,j=55296+(et>>10),et=56320+(et&mask[10]),o.push(j>>8&mask[8]),o.push(j&mask[8]),o.push(et>>8&mask[8]),o.push(et&mask[8]);else throw new RangeError(`utf16be.encode: UTF16BE value out of range: char[${tt}]: ${$}`);return buffer$2.Buffer.from(o)},decode(_,o){if(_.length%2>0)throw new RangeError(`utf16be.decode: data length must be even multiple of 2: length: ${_.length}`);const $=[],j=_.length;let et=o?2:0,tt=0,rt,nt,it,st,ot,at;for(;et<j;){for(;;){if(it=et+1,it<j){if(ot=(_[et]<<8)+_[it],ot<55296||ot>57343){rt=ot,nt=2;break}if(st=et+3,st<j&&(at=(_[et+2]<<8)+_[st],ot<=56319&&at>=56320&&at<=57343)){rt=65536+(ot-55296<<10)+(at-56320),nt=4;break}}throw new RangeError(`utf16be.decode: ill-formed UTF16BE byte sequence found: byte[${et}]`)}$[tt++]=rt,et+=nt}return $}};transformers.utf16le={encode(_){const o=[];let $,j,et;for(let tt=0;tt<_.length;tt+=1)if($=_[tt],$>=0&&$<=55295||$>=57344&&$<=65535)o.push($&mask[8]),o.push($>>8&mask[8]);else if($>=65536&&$<=1114111)et=$-65536,j=55296+(et>>10),et=56320+(et&mask[10]),o.push(j&mask[8]),o.push(j>>8&mask[8]),o.push(et&mask[8]),o.push(et>>8&mask[8]);else throw new RangeError(`utf16le.encode: UTF16LE value out of range: char[${tt}]: ${$}`);return buffer$2.Buffer.from(o)},decode(_,o){if(_.length%2>0)throw new RangeError(`utf16le.decode: data length must be even multiple of 2: length: ${_.length}`);const $=[],j=_.length;let et=o?2:0,tt=0,rt,nt,it,st,ot,at;for(;et<j;){for(;;){if(it=et+1,it<j){if(ot=(_[it]<<8)+_[et],ot<55296||ot>57343){rt=ot,nt=2;break}if(st=et+3,st<j&&(at=(_[st]<<8)+_[et+2],ot<=56319&&at>=56320&&at<=57343)){rt=65536+(ot-55296<<10)+(at-56320),nt=4;break}}throw new RangeError(`utf16le.decode: ill-formed UTF16LE byte sequence found: byte[${et}]`)}$[tt++]=rt,et+=nt}return $}};transformers.utf32be={encode(_){const o=buffer$2.Buffer.alloc(_.length*4);let $=0;return _.forEach(j=>{if(j>=55296&&j<=57343||j>1114111)throw new RangeError(`utf32be.encode: UTF32BE character code out of range: char[${$/4}]: ${j}`);o[$++]=j>>24&mask[8],o[$++]=j>>16&mask[8],o[$++]=j>>8&mask[8],o[$++]=j&mask[8]}),o},decode(_,o){if(_.length%4>0)throw new RangeError(`utf32be.decode: UTF32BE byte length must be even multiple of 4: length: ${_.length}`);const $=[];let j=o?4:0;for(;j<_.length;j+=4){const et=(_[j]<<24)+(_[j+1]<<16)+(_[j+2]<<8)+_[j+3];if(et>=55296&&et<=57343||et>1114111)throw new RangeError(`utf32be.decode: UTF32BE character code out of range: char[${j/4}]: ${et}`);$.push(et)}return $}};transformers.utf32le={encode(_){const o=buffer$2.Buffer.alloc(_.length*4);let $=0;return _.forEach(j=>{if(j>=55296&&j<=57343||j>1114111)throw new RangeError(`utf32le.encode: UTF32LE character code out of range: char[${$/4}]: ${j}`);o[$++]=j&mask[8],o[$++]=j>>8&mask[8],o[$++]=j>>16&mask[8],o[$++]=j>>24&mask[8]}),o},decode(_,o){if(_.length%4>0)throw new RangeError(`utf32be.decode: UTF32LE byte length must be even multiple of 4: length: ${_.length}`);const $=[];let j=o?4:0;for(;j<_.length;j+=4){const et=(_[j+3]<<24)+(_[j+2]<<16)+(_[j+1]<<8)+_[j];if(et>=55296&&et<=57343||et>1114111)throw new RangeError(`utf32le.encode: UTF32LE character code out of range: char[${j/4}]: ${et}`);$.push(et)}return $}};transformers.uint7={encode(_){const o=buffer$2.Buffer.alloc(_.length);for(let $=0;$<_.length;$+=1){if(_[$]>127)throw new RangeError(`uint7.encode: UINT7 character code out of range: char[${$}]: ${_[$]}`);o[$]=_[$]}return o},decode(_){const o=[];for(let $=0;$<_.length;$+=1){if(_[$]>127)throw new RangeError(`uint7.decode: UINT7 character code out of range: byte[${$}]: ${_[$]}`);o[$]=_[$]}return o}};transformers.uint8={encode(_){const o=buffer$2.Buffer.alloc(_.length);for(let $=0;$<_.length;$+=1){if(_[$]>255)throw new RangeError(`uint8.encode: UINT8 character code out of range: char[${$}]: ${_[$]}`);o[$]=_[$]}return o},decode(_){const o=[];for(let $=0;$<_.length;$+=1)o[$]=_[$];return o}};transformers.uint16be={encode(_){const o=buffer$2.Buffer.alloc(_.length*2);let $=0;return _.forEach(j=>{if(j>65535)throw new RangeError(`uint16be.encode: UINT16BE character code out of range: char[${$/2}]: ${j}`);o[$++]=j>>8&mask[8],o[$++]=j&mask[8]}),o},decode(_){if(_.length%2>0)throw new RangeError(`uint16be.decode: UINT16BE byte length must be even multiple of 2: length: ${_.length}`);const o=[];for(let $=0;$<_.length;$+=2)o.push((_[$]<<8)+_[$+1]);return o}};transformers.uint16le={encode(_){const o=buffer$2.Buffer.alloc(_.length*2);let $=0;return _.forEach(j=>{if(j>65535)throw new RangeError(`uint16le.encode: UINT16LE character code out of range: char[${$/2}]: ${j}`);o[$++]=j&mask[8],o[$++]=j>>8&mask[8]}),o},decode(_){if(_.length%2>0)throw new RangeError(`uint16le.decode: UINT16LE byte length must be even multiple of 2: length: ${_.length}`);const o=[];for(let $=0;$<_.length;$+=2)o.push((_[$+1]<<8)+_[$]);return o}};transformers.uint32be={encode(_){const o=buffer$2.Buffer.alloc(_.length*4);let $=0;return _.forEach(j=>{o[$++]=j>>24&mask[8],o[$++]=j>>16&mask[8],o[$++]=j>>8&mask[8],o[$++]=j&mask[8]}),o},decode(_){if(_.length%4>0)throw new RangeError(`uint32be.decode: UINT32BE byte length must be even multiple of 4: length: ${_.length}`);const o=[];for(let $=0;$<_.length;$+=4)o.push((_[$]<<24)+(_[$+1]<<16)+(_[$+2]<<8)+_[$+3]);return o}};transformers.uint32le={encode(_){const o=buffer$2.Buffer.alloc(_.length*4);let $=0;return _.forEach(j=>{o[$++]=j&mask[8],o[$++]=j>>8&mask[8],o[$++]=j>>16&mask[8],o[$++]=j>>24&mask[8]}),o},decode(_){if(_.length%4>0)throw new RangeError(`uint32le.decode: UINT32LE byte length must be even multiple of 4: length: ${_.length}`);const o=[];for(let $=0;$<_.length;$+=4)o.push((_[$+3]<<24)+(_[$+2]<<16)+(_[$+1]<<8)+_[$]);return o}};transformers.string={encode(_){return thisThis$2.utf16le.encode(_).toString("utf16le")},decode(_){return thisThis$2.utf16le.decode(buffer$2.Buffer.from(_,"utf16le"),0)}};transformers.escaped={encode(_){const o=[];for(let $=0;$<_.length;$+=1){const j=_[$];if(j===96)o.push(j),o.push(j);else if(j===10)o.push(j);else if(j>=32&&j<=126)o.push(j);else{let et="";if(j>=0&&j<=31)et+=`\`x${ascii$1[j]}`;else if(j>=127&&j<=255)et+=`\`x${ascii$1[j]}`;else if(j>=256&&j<=65535)et+=`\`u${ascii$1[j>>8&mask[8]]}${ascii$1[j&mask[8]]}`;else if(j>=65536&&j<=4294967295){et+="`u{";const rt=j>>24&mask[8];rt>0&&(et+=ascii$1[rt]),et+=`${ascii$1[j>>16&mask[8]]+ascii$1[j>>8&mask[8]]+ascii$1[j&mask[8]]}}`}else throw new Error("escape.encode(char): char > 0xffffffff not allowed");buffer$2.Buffer.from(et).forEach(rt=>{o.push(rt)})}}return buffer$2.Buffer.from(o)},decode(_){function o(at){return at>=48&&at<=57||at>=65&&at<=70||at>=97&&at<=102}function $(at,ct,ut){const ft={char:null,nexti:at+2,error:!0};if(at+1<ct&&o(ut[at])&&o(ut[at+1])){const ht=String.fromCodePoint(ut[at],ut[at+1]);ft.char=parseInt(ht,16),Number.isNaN(ft.char)||(ft.error=!1)}return ft}function j(at,ct,ut){const ft={char:null,nexti:at+4,error:!0};if(at+3<ct&&o(ut[at])&&o(ut[at+1])&&o(ut[at+2])&&o(ut[at+3])){const ht=String.fromCodePoint(ut[at],ut[at+1],ut[at+2],ut[at+3]);ft.char=parseInt(ht,16),Number.isNaN(ft.char)||(ft.error=!1)}return ft}function et(at,ct,ut){const ft={char:null,nexti:at+4,error:!0};let ht="";for(;at<ct&&o(ut[at]);)ht+=String.fromCodePoint(ut[at]),at+=1;return ft.char=parseInt(ht,16),ut[at]===125&&!Number.isNaN(ft.char)&&(ft.error=!1),ft.nexti=at+1,ft}const tt=[],rt=_.length;let nt,it,st,ot=0;for(;ot<rt;){for(;;){if(st=!0,_[ot]!==96){tt.push(_[ot]),ot+=1,st=!1;break}if(nt=ot+1,nt>=rt)break;if(_[nt]===96){tt.push(96),ot+=2,st=!1;break}if(_[nt]===120){if(it=$(nt+1,rt,_),it.error)break;tt.push(it.char),ot=it.nexti,st=!1;break}if(_[nt]===117){if(_[nt+1]===123){if(it=et(nt+2,rt,_),it.error)break;tt.push(it.char),ot=it.nexti,st=!1;break}if(it=j(nt+1,rt,_),it.error)break;tt.push(it.char),ot=it.nexti,st=!1;break}break}if(st)throw new Error(`escaped.decode: ill-formed escape sequence at buf[${ot}]`)}return tt}};const CR=13,LF=10;transformers.lineEnds={crlf(_){const o=[];let $=0;for(;$<_.length;)switch(_[$]){case CR:$+1<_.length&&_[$+1]===LF?$+=2:$+=1,o.push(CR),o.push(LF);break;case LF:o.push(CR),o.push(LF),$+=1;break;default:o.push(_[$]),$+=1;break}return o.length>0&&o[o.length-1]!==LF&&(o.push(CR),o.push(LF)),o},lf(_){const o=[];let $=0;for(;$<_.length;)switch(_[$]){case CR:$+1<_.length&&_[$+1]===LF?$+=2:$+=1,o.push(LF);break;case LF:o.push(LF),$+=1;break;default:o.push(_[$]),$+=1;break}return o.length>0&&o[o.length-1]!==LF&&o.push(LF),o}};transformers.base64={encode(_){if(_.length===0)return buffer$2.Buffer.alloc(0);let o,$,j,et=_.length%3;et=et>0?3-et:0;let tt=(_.length+et)/3;const rt=buffer$2.Buffer.alloc(tt*4);et>0&&(tt-=1),o=0,$=0;for(let nt=0;nt<tt;nt+=1)j=_[o++]<<16,j+=_[o++]<<8,j+=_[o++],rt[$++]=base64codes[j>>18&mask[6]],rt[$++]=base64codes[j>>12&mask[6]],rt[$++]=base64codes[j>>6&mask[6]],rt[$++]=base64codes[j&mask[6]];if(et===0)return rt;if(et===1)return j=_[o++]<<16,j+=_[o]<<8,rt[$++]=base64codes[j>>18&mask[6]],rt[$++]=base64codes[j>>12&mask[6]],rt[$++]=base64codes[j>>6&mask[6]],rt[$]=base64codes[64],rt;if(et===2)return j=_[o]<<16,rt[$++]=base64codes[j>>18&mask[6]],rt[$++]=base64codes[j>>12&mask[6]],rt[$++]=base64codes[64],rt[$]=base64codes[64],rt},decode(_){function o(ot){const at=[];let ct=0;for(let ut=0;ut<ot.length;ut+=1){const ft=ot[ut],ht=!0;for(;ht&&!(ft===32||ft===9||ft===10||ft===13);){if(ft>=65&&ft<=90){at.push(ft-65);break}if(ft>=97&&ft<=122){at.push(ft-71);break}if(ft>=48&&ft<=57){at.push(ft+4);break}if(ft===43){at.push(62);break}if(ft===47){at.push(63);break}if(ft===61){at.push(64),ct+=1;break}throw new RangeError(`base64.decode: invalid character buf[${ut}]: ${ft}`)}}if(at.length%4>0)throw new RangeError(`base64.decode: string length not integral multiple of 4: ${at.length}`);switch(ct){case 0:break;case 1:if(at[at.length-1]!==64)throw new RangeError("base64.decode: one tail character found: not last character");break;case 2:if(at[at.length-1]!==64||at[at.length-2]!==64)throw new RangeError("base64.decode: two tail characters found: not last characters");break;default:throw new RangeError(`base64.decode: more than two tail characters found: ${ct}`)}return{tail:ct,buf:buffer$2.Buffer.from(at)}}if(_.length===0)return buffer$2.Buffer.alloc(0);const $=o(_),{tail:j}=$,et=$.buf;let tt,rt,nt,it=et.length/4;const st=buffer$2.Buffer.alloc(it*3-j);j>0&&(it-=1),rt=0,tt=0;for(let ot=0;ot<it;ot+=1)nt=et[tt++]<<18,nt+=et[tt++]<<12,nt+=et[tt++]<<6,nt+=et[tt++],st[rt++]=nt>>16&mask[8],st[rt++]=nt>>8&mask[8],st[rt++]=nt&mask[8];return j===1&&(nt=et[tt++]<<18,nt+=et[tt++]<<12,nt+=et[tt]<<6,st[rt++]=nt>>16&mask[8],st[rt]=nt>>8&mask[8]),j===2&&(nt=et[tt++]<<18,nt+=et[tt++]<<12,st[rt]=nt>>16&mask[8]),st},toString(_){if(_.length%4>0)throw new RangeError(`base64.toString: input buffer length not multiple of 4: ${_.length}`);let o="",$=0;function j(tt,rt,nt,it){switch($){case 76:o+=`\r
${tt}${rt}${nt}${it}`,$=4;break;case 75:o+=`${tt}\r
${rt}${nt}${it}`,$=3;break;case 74:o+=`${tt+rt}\r
${nt}${it}`,$=2;break;case 73:o+=`${tt+rt+nt}\r
${it}`,$=1;break;default:o+=tt+rt+nt+it,$+=4;break}}function et(tt){return tt>=65&&tt<=90||tt>=97&&tt<=122||tt>=48&&tt<=57||tt===43||tt===47||tt===61}for(let tt=0;tt<_.length;tt+=4){for(let rt=tt;rt<tt+4;rt+=1)if(!et(_[rt]))throw new RangeError(`base64.toString: buf[${rt}]: ${_[rt]} : not valid base64 character code`);j(String.fromCharCode(_[tt]),String.fromCharCode(_[tt+1]),String.fromCharCode(_[tt+2]),String.fromCharCode(_[tt+3]))}return o}};const thisThis$1=commonjsGlobal,trans=transformers,UTF8="UTF8",UTF16="UTF16",UTF16BE="UTF16BE",UTF16LE="UTF16LE",UTF32="UTF32",UTF32BE="UTF32BE",UTF32LE="UTF32LE",UINT7="UINT7",ASCII="ASCII",BINARY="BINARY",UINT8="UINT8",UINT16="UINT16",UINT16LE="UINT16LE",UINT16BE="UINT16BE",UINT32="UINT32",UINT32LE="UINT32LE",UINT32BE="UINT32BE",ESCAPED="ESCAPED",STRING="STRING",bom8=function _(o){o.type=UTF8;const $=o.data;o.bom=0,$.length>=3&&$[0]===239&&$[1]===187&&$[2]===191&&(o.bom=3)},bom16=function _(o){const $=o.data;switch(o.bom=0,o.type){case UTF16:o.type=UTF16BE,$.length>=2&&($[0]===254&&$[1]===255?o.bom=2:$[0]===255&&$[1]===254&&(o.type=UTF16LE,o.bom=2));break;case UTF16BE:if(o.type=UTF16BE,$.length>=2){if($[0]===254&&$[1]===255)o.bom=2;else if($[0]===255&&$[1]===254)throw new TypeError(`src type: "${UTF16BE}" specified but BOM is for "${UTF16LE}"`)}break;case UTF16LE:if(o.type=UTF16LE,$.length>=0){if($[0]===254&&$[1]===255)throw new TypeError(`src type: "${UTF16LE}" specified but BOM is for "${UTF16BE}"`);$[0]===255&&$[1]===254&&(o.bom=2)}break;default:throw new TypeError(`UTF16 BOM: src type "${o.type}" unrecognized`)}},bom32=function _(o){const $=o.data;switch(o.bom=0,o.type){case UTF32:o.type=UTF32BE,$.length>=4&&($[0]===0&&$[1]===0&&$[2]===254&&$[3]===255&&(o.bom=4),$[0]===255&&$[1]===254&&$[2]===0&&$[3]===0&&(o.type=UTF32LE,o.bom=4));break;case UTF32BE:if(o.type=UTF32BE,$.length>=4&&($[0]===0&&$[1]===0&&$[2]===254&&$[3]===255&&(o.bom=4),$[0]===255&&$[1]===254&&$[2]===0&&$[3]===0))throw new TypeError(`src type: ${UTF32BE} specified but BOM is for ${UTF32LE}"`);break;case UTF32LE:if(o.type=UTF32LE,$.length>=4){if($[0]===0&&$[1]===0&&$[2]===254&&$[3]===255)throw new TypeError(`src type: "${UTF32LE}" specified but BOM is for "${UTF32BE}"`);$[0]===255&&$[1]===254&&$[2]===0&&$[3]===0&&(o.bom=4)}break;default:throw new TypeError(`UTF32 BOM: src type "${o.type}" unrecognized`)}},validateSrc=function _(o,$){function j(tt){const rt={type:"",base64:!1},it=/^(base64:)?([a-zA-Z0-9]+)$/i.exec(tt);return it&&(it[2]&&(rt.type=it[2].toUpperCase()),it[1]&&(rt.base64=!0)),rt}if(typeof o!="string"||o==="")throw new TypeError(`type: "${o}" not recognized`);const et=j(o.toUpperCase());if(et.base64){if(et.type===STRING)throw new TypeError(`type: "${o} "BASE64:" prefix not allowed with type ${STRING}`);if(buffer$2.Buffer.isBuffer($))et.data=trans.base64.decode($);else if(typeof $=="string"){const tt=buffer$2.Buffer.from($,"ascii");et.data=trans.base64.decode(tt)}else throw new TypeError(`type: "${o} unrecognized data type: typeof(data): ${typeof $}`)}else et.data=$;switch(et.type){case UTF8:bom8(et);break;case UTF16:case UTF16BE:case UTF16LE:bom16(et);break;case UTF32:case UTF32BE:case UTF32LE:bom32(et);break;case UINT16:et.type=UINT16BE;break;case UINT32:et.type=UINT32BE;break;case ASCII:et.type=UINT7;break;case BINARY:et.type=UINT8;break;case UINT7:case UINT8:case UINT16LE:case UINT16BE:case UINT32LE:case UINT32BE:case STRING:case ESCAPED:break;default:throw new TypeError(`type: "${o}" not recognized`)}if(et.type===STRING){if(typeof et.data!="string")throw new TypeError(`type: "${o}" but data is not a string`)}else if(!buffer$2.Buffer.isBuffer(et.data))throw new TypeError(`type: "${o}" but data is not a Buffer`);return et},validateDst=function _(o,$){function j(tt){let rt,nt;const it={crlf:!1,lf:!1,base64:!1,type:""},st=!0;for(;st;){if(nt=tt,rt=tt.slice(0,5),rt==="CRLF:"){it.crlf=!0,nt=tt.slice(5);break}if(rt=tt.slice(0,3),rt==="LF:"){it.lf=!0,nt=tt.slice(3);break}break}return rt=nt.split(":"),rt.length===1?it.type=rt[0]:rt.length===2&&rt[1]==="BASE64"&&(it.base64=!0,it.type=rt[0]),it}if(!Array.isArray($))throw new TypeError(`dst chars: not array: "${typeof $}`);if(typeof o!="string")throw new TypeError(`dst type: not string: "${typeof o}`);const et=j(o.toUpperCase());switch(et.type){case UTF8:case UTF16BE:case UTF16LE:case UTF32BE:case UTF32LE:case UINT7:case UINT8:case UINT16LE:case UINT16BE:case UINT32LE:case UINT32BE:case ESCAPED:break;case STRING:if(et.base64)throw new TypeError(`":BASE64" suffix not allowed with type ${STRING}`);break;case ASCII:et.type=UINT7;break;case BINARY:et.type=UINT8;break;case UTF16:et.type=UTF16BE;break;case UTF32:et.type=UTF32BE;break;case UINT16:et.type=UINT16BE;break;case UINT32:et.type=UINT32BE;break;default:throw new TypeError(`dst type unrecognized: "${o}" : must have form [crlf:|lf:]type[:base64]`)}return et},encode$l=function _(o,$){switch(o){case UTF8:return trans.utf8.encode($);case UTF16BE:return trans.utf16be.encode($);case UTF16LE:return trans.utf16le.encode($);case UTF32BE:return trans.utf32be.encode($);case UTF32LE:return trans.utf32le.encode($);case UINT7:return trans.uint7.encode($);case UINT8:return trans.uint8.encode($);case UINT16BE:return trans.uint16be.encode($);case UINT16LE:return trans.uint16le.encode($);case UINT32BE:return trans.uint32be.encode($);case UINT32LE:return trans.uint32le.encode($);case STRING:return trans.string.encode($);case ESCAPED:return trans.escaped.encode($);default:throw new TypeError(`encode type "${o}" not recognized`)}},decode$h=function _(o){switch(o.type){case UTF8:return trans.utf8.decode(o.data,o.bom);case UTF16LE:return trans.utf16le.decode(o.data,o.bom);case UTF16BE:return trans.utf16be.decode(o.data,o.bom);case UTF32BE:return trans.utf32be.decode(o.data,o.bom);case UTF32LE:return trans.utf32le.decode(o.data,o.bom);case UINT7:return trans.uint7.decode(o.data);case UINT8:return trans.uint8.decode(o.data);case UINT16BE:return trans.uint16be.decode(o.data);case UINT16LE:return trans.uint16le.decode(o.data);case UINT32BE:return trans.uint32be.decode(o.data);case UINT32LE:return trans.uint32le.decode(o.data);case STRING:return trans.string.decode(o.data);case ESCAPED:return trans.escaped.decode(o.data);default:throw new TypeError(`decode type "${o.type}" not recognized`)}};converter$1.decode=function _(o,$){const j=validateSrc(o,$);return decode$h(j)};converter$1.encode=function _(o,$){let j,et;const tt=validateDst(o,$);return tt.crlf?(j=trans.lineEnds.crlf($),et=encode$l(tt.type,j)):tt.lf?(j=trans.lineEnds.lf($),et=encode$l(tt.type,j)):et=encode$l(tt.type,$),tt.base64&&(et=trans.base64.encode(et)),et};converter$1.convert=function _(o,$,j){return thisThis$1.encode(j,thisThis$1.decode(o,$))};var emitcss=function _(){return`/* This file automatically generated by jsonToless() and LESS. */
.apg-mono {
  font-family: monospace;
}
.apg-active {
  font-weight: bold;
  color: #000000;
}
.apg-match {
  font-weight: bold;
  color: #264BFF;
}
.apg-empty {
  font-weight: bold;
  color: #0fbd0f;
}
.apg-nomatch {
  font-weight: bold;
  color: #FF4000;
}
.apg-lh-match {
  font-weight: bold;
  color: #1A97BA;
}
.apg-lb-match {
  font-weight: bold;
  color: #5F1687;
}
.apg-remainder {
  font-weight: bold;
  color: #999999;
}
.apg-ctrl-char {
  font-weight: bolder;
  font-style: italic;
  font-size: 0.6em;
}
.apg-line-end {
  font-weight: bold;
  color: #000000;
}
.apg-error {
  font-weight: bold;
  color: #FF4000;
}
.apg-phrase {
  color: #000000;
  background-color: #8caae6;
}
.apg-empty-phrase {
  color: #0fbd0f;
}
table.apg-state {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: left;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-state th,
table.apg-state td {
  text-align: left;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-state th:nth-last-child(2),
table.apg-state td:nth-last-child(2) {
  text-align: right;
}
table.apg-state caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-stats {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-stats th,
table.apg-stats td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-stats caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-trace {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-trace caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-trace th,
table.apg-trace td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-trace th:last-child,
table.apg-trace th:nth-last-child(2),
table.apg-trace td:last-child,
table.apg-trace td:nth-last-child(2) {
  text-align: left;
}
table.apg-grammar {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-grammar caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-grammar th,
table.apg-grammar td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-grammar th:last-child,
table.apg-grammar td:last-child {
  text-align: left;
}
table.apg-rules {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-rules caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-rules th,
table.apg-rules td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-rules a {
  color: #003399 !important;
}
table.apg-rules a:hover {
  color: #8caae6 !important;
}
table.apg-attrs {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: center;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-attrs caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-attrs th,
table.apg-attrs td {
  text-align: center;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-attrs th:nth-child(1),
table.apg-attrs th:nth-child(2),
table.apg-attrs th:nth-child(3) {
  text-align: right;
}
table.apg-attrs td:nth-child(1),
table.apg-attrs td:nth-child(2),
table.apg-attrs td:nth-child(3) {
  text-align: right;
}
table.apg-attrs a {
  color: #003399 !important;
}
table.apg-attrs a:hover {
  color: #8caae6 !important;
}
`};const style=style$1,converter=converter$1,emitCss=emitcss,id$1=identifiers,thisFileName="utilities.js: ",thisThis=commonjsGlobal,getBounds=function(_,o,$){let j,et=o;const tt=!0;for(;tt;){if(_<=0){et=0,j=0;break}if(typeof et!="number"){et=0,j=_;break}if(et>=_){et=_,j=_;break}if(typeof $!="number"){j=_;break}if(j=et+$,j>_){j=_;break}break}return{beg:et,end:j}};utilities.htmlToPage=function(_,o){let $;if(typeof _!="string")throw new Error(`${thisFileName}htmlToPage: input HTML is not a string`);typeof o!="string"?$="htmlToPage":$=o;let j="";return j+=`<!DOCTYPE html>
`,j+=`<html lang="en">
`,j+=`<head>
`,j+=`<meta charset="utf-8">
`,j+=`<title>${$}</title>
`,j+=`<style>
`,j+=emitCss(),j+=`</style>
`,j+=`</head>
<body>
`,j+=`<p>${new Date}</p>
`,j+=_,j+=`</body>
</html>
`,j};utilities.parserResultToHtml=function(_,o){let $=null;typeof o=="string"&&o!==""&&($=o);let j,et;_.success===!0?j=`<span class="${style.CLASS_MATCH}">true</span>`:j=`<span class="${style.CLASS_NOMATCH}">false</span>`,_.state===id$1.EMPTY?et=`<span class="${style.CLASS_EMPTY}">EMPTY</span>`:_.state===id$1.MATCH?et=`<span class="${style.CLASS_MATCH}">MATCH</span>`:_.state===id$1.NOMATCH?et=`<span class="${style.CLASS_NOMATCH}">NOMATCH</span>`:et=`<span class="${style.CLASS_NOMATCH}">unrecognized</span>`;let tt="";return tt+=`<table class="${style.CLASS_STATE}">
`,$&&(tt+=`<caption>${$}</caption>
`),tt+=`<tr><th>state item</th><th>value</th><th>description</th></tr>
`,tt+=`<tr><td>parser success</td><td>${j}</td>
`,tt+=`<td><span class="${style.CLASS_MATCH}">true</span> if the parse succeeded,
`,tt+=` <span class="${style.CLASS_NOMATCH}">false</span> otherwise`,tt+=`<br><i>NOTE: for success, entire string must be matched</i></td></tr>
`,tt+=`<tr><td>parser state</td><td>${et}</td>
`,tt+=`<td><span class="${style.CLASS_EMPTY}">EMPTY</span>, `,tt+=`<span class="${style.CLASS_MATCH}">MATCH</span> or 
`,tt+=`<span class="${style.CLASS_NOMATCH}">NOMATCH</span></td></tr>
`,tt+=`<tr><td>string length</td><td>${_.length}</td><td>length of the input (sub)string</td></tr>
`,tt+=`<tr><td>matched length</td><td>${_.matched}</td><td>number of input string characters matched</td></tr>
`,tt+=`<tr><td>max matched</td><td>${_.maxMatched}</td><td>maximum number of input string characters matched</td></tr>
`,tt+=`<tr><td>max tree depth</td><td>${_.maxTreeDepth}</td><td>maximum depth of the parse tree reached</td></tr>
`,tt+=`<tr><td>node hits</td><td>${_.nodeHits}</td><td>number of parse tree node hits (opcode function calls)</td></tr>
`,tt+=`<tr><td>input length</td><td>${_.inputLength}</td><td>length of full input string</td></tr>
`,tt+=`<tr><td>sub-string begin</td><td>${_.subBegin}</td><td>sub-string first character index</td></tr>
`,tt+=`<tr><td>sub-string end</td><td>${_.subEnd}</td><td>sub-string end-of-string index</td></tr>
`,tt+=`<tr><td>sub-string length</td><td>${_.subLength}</td><td>sub-string length</td></tr>
`,tt+=`</table>
`,tt};utilities.charsToString=function(_,o,$){let j,et;if(typeof o=="number"){if(o>=_.length)return"";j=o<0?0:o}else j=0;if(typeof $=="number"){if($<=0)return"";et=$>_.length-j?_.length:j+$}else et=_.length;return j<et?converter.encode("UTF16LE",_.slice(j,et)).toString("utf16le"):""};utilities.stringToChars=function(_){return converter.decode("STRING",_)};utilities.opcodeToString=function(_){let o="unknown";switch(_){case id$1.ALT:o="ALT";break;case id$1.CAT:o="CAT";break;case id$1.RNM:o="RNM";break;case id$1.UDT:o="UDT";break;case id$1.AND:o="AND";break;case id$1.NOT:o="NOT";break;case id$1.REP:o="REP";break;case id$1.TRG:o="TRG";break;case id$1.TBS:o="TBS";break;case id$1.TLS:o="TLS";break;case id$1.BKR:o="BKR";break;case id$1.BKA:o="BKA";break;case id$1.BKN:o="BKN";break;case id$1.ABG:o="ABG";break;case id$1.AEN:o="AEN";break;default:throw new Error("unrecognized opcode")}return o};utilities.stateToString=function(_){let o="unknown";switch(_){case id$1.ACTIVE:o="ACTIVE";break;case id$1.MATCH:o="MATCH";break;case id$1.EMPTY:o="EMPTY";break;case id$1.NOMATCH:o="NOMATCH";break;default:throw new Error("unrecognized state")}return o};utilities.asciiChars=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","TAB","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","&nbsp;","!","&#34;","#","$","%","&#38;","&#39;","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","&#60;","=","&#62;","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","&#92;","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL"];utilities.charToHex=function(_){let o=_.toString(16).toUpperCase();switch(o.length){case 1:case 3:case 7:o=`0${o}`;break;case 2:case 6:o=`00${o}`;break;case 4:break;case 5:o=`000${o}`;break;default:throw new Error("unrecognized option")}return o};utilities.charsToDec=function(_,o,$){let j="";if(!Array.isArray(_))throw new Error(`${thisFileName}charsToDec: input must be an array of integers`);const et=getBounds(_.length,o,$);if(et.end>et.beg){j+=_[et.beg];for(let tt=et.beg+1;tt<et.end;tt+=1)j+=`,${_[tt]}`}return j};utilities.charsToHex=function(_,o,$){let j="";if(!Array.isArray(_))throw new Error(`${thisFileName}charsToHex: input must be an array of integers`);const et=getBounds(_.length,o,$);if(et.end>et.beg){j+=`\\x${thisThis.charToHex(_[et.beg])}`;for(let tt=et.beg+1;tt<et.end;tt+=1)j+=`,\\x${thisThis.charToHex(_[tt])}`}return j};utilities.charsToHtmlEntities=function(_,o,$){let j="";if(!Array.isArray(_))throw new Error(`${thisFileName}charsToHex: input must be an array of integers`);const et=getBounds(_.length,o,$);if(et.end>et.beg)for(let tt=et.beg;tt<et.end;tt+=1)j+=`&#x${_[tt].toString(16)};`;return j};function isUnicode(_){return!(_>=55296&&_<=57343||_>1114111)}utilities.charsToUnicode=function(_,o,$){let j="";if(!Array.isArray(_))throw new Error(`${thisFileName}charsToUnicode: input must be an array of integers`);const et=getBounds(_.length,o,$);if(et.end>et.beg)for(let tt=et.beg;tt<et.end;tt+=1)isUnicode(_[tt])?j+=`&#${_[tt]};`:j+=` U+${thisThis.charToHex(_[tt])}`;return j};utilities.charsToJsUnicode=function(_,o,$){let j="";if(!Array.isArray(_))throw new Error(`${thisFileName}charsToJsUnicode: input must be an array of integers`);const et=getBounds(_.length,o,$);if(et.end>et.beg){j+=`\\u${thisThis.charToHex(_[et.beg])}`;for(let tt=et.beg+1;tt<et.end;tt+=1)j+=`,\\u${thisThis.charToHex(_[tt])}`}return j};utilities.charsToAscii=function(_,o,$){let j="";if(!Array.isArray(_))throw new Error(`${thisFileName}charsToAscii: input must be an array of integers`);const et=getBounds(_.length,o,$);for(let tt=et.beg;tt<et.end;tt+=1){const rt=_[tt];rt>=32&&rt<=126?j+=String.fromCharCode(rt):j+=`\\x${thisThis.charToHex(rt)}`}return j};utilities.charsToAsciiHtml=function(_,o,$){if(!Array.isArray(_))throw new Error(`${thisFileName}charsToAsciiHtml: input must be an array of integers`);let j="",et;const tt=getBounds(_.length,o,$);for(let rt=tt.beg;rt<tt.end;rt+=1)et=_[rt],et<32||et===127?j+=`<span class="${style.CLASS_CTRLCHAR}">${thisThis.asciiChars[et]}</span>`:et>127?j+=`<span class="${style.CLASS_CTRLCHAR}">U+${thisThis.charToHex(et)}</span>`:j+=thisThis.asciiChars[et];return j};utilities.stringToAsciiHtml=function(_){const o=converter.decode("STRING",_);return this.charsToAsciiHtml(o)};var ast=function _(){const o=identifiers,$=utilities,j="ast.js: ",et=this;let tt=null,rt=null,nt=null,it=0;const st=[],ot=[],at=[],ct=[];this.callbacks=[],this.astObject="astObject",this.init=function(ht,mt,gt){at.length=0,ct.length=0,st.length=0,it=0,tt=ht,rt=mt,nt=gt;let Et;const St=[];for(Et=0;Et<tt.length;Et+=1)St.push(tt[Et].lower);for(Et=0;Et<rt.length;Et+=1)St.push(rt[Et].lower);for(it=tt.length+rt.length,Et=0;Et<it;Et+=1)st[Et]=!1,ot[Et]=null;for(const At in et.callbacks){const kt=At.toLowerCase();if(Et=St.indexOf(kt),Et<0)throw new Error(`${j}init: node '${At}' not a rule or udt name`);typeof et.callbacks[At]=="function"&&(st[Et]=!0,ot[Et]=et.callbacks[At]),et.callbacks[At]===!0&&(st[Et]=!0)}},this.ruleDefined=function(ht){return st[ht]!==!1},this.udtDefined=function(ht){return st[tt.length+ht]!==!1},this.down=function(ht,mt){const gt=ct.length;return at.push(gt),ct.push({name:mt,thisIndex:gt,thatIndex:null,state:o.SEM_PRE,callbackIndex:ht,phraseIndex:null,phraseLength:null,stack:at.length}),gt},this.up=function(ht,mt,gt,Et){const St=ct.length,At=at.pop();return ct.push({name:mt,thisIndex:St,thatIndex:At,state:o.SEM_POST,callbackIndex:ht,phraseIndex:gt,phraseLength:Et,stack:at.length}),ct[At].thatIndex=St,ct[At].phraseIndex=gt,ct[At].phraseLength=Et,St},this.translate=function(ht){let mt,gt,Et;for(let St=0;St<ct.length;St+=1)Et=ct[St],gt=ot[Et.callbackIndex],Et.state===o.SEM_PRE?gt!==null&&(mt=gt(o.SEM_PRE,nt,Et.phraseIndex,Et.phraseLength,ht),mt===o.SEM_SKIP&&(St=Et.thatIndex)):gt!==null&&gt(o.SEM_POST,nt,Et.phraseIndex,Et.phraseLength,ht)},this.setLength=function(ht){ct.length=ht,ht>0?at.length=ct[ht-1].stack:at.length=0},this.getLength=function(){return ct.length};function ut(ft){let ht="";for(let mt=0;mt<ft;mt+=1)ht+=" ";return ht}this.toXml=function(ht){let mt=$.charsToDec,gt="decimal integer character codes";if(typeof ht=="string"&&ht.length>=3){const At=ht.slice(0,3).toLowerCase();At==="asc"?(mt=$.charsToAscii,gt="ASCII for printing characters, hex for non-printing"):At==="hex"?(mt=$.charsToHex,gt="hexadecimal integer character codes"):At==="uni"&&(mt=$.charsToUnicode,gt="Unicode UTF-32 integer character codes")}let Et="",St=0;return Et+=`<?xml version="1.0" encoding="utf-8"?>
`,Et+=`<root nodes="${ct.length/2}" characters="${nt.length}">
`,Et+=`<!-- input string, ${gt} -->
`,Et+=ut(St+2),Et+=mt(nt),Et+=`
`,ct.forEach(At=>{At.state===o.SEM_PRE?(St+=1,Et+=ut(St),Et+=`<node name="${At.name}" index="${At.phraseIndex}" length="${At.phraseLength}">
`,Et+=ut(St+2),Et+=mt(nt,At.phraseIndex,At.phraseLength),Et+=`
`):(Et+=ut(St),Et+=`</node><!-- name="${At.name}" -->
`,St-=1)}),Et+=`</root>
`,Et},this.phrases=function(){const ht={};let mt,gt;for(mt=0;mt<ct.length;mt+=1)gt=ct[mt],gt.state===o.SEM_PRE&&(Array.isArray(ht[gt.name])||(ht[gt.name]=[]),ht[gt.name].push({index:gt.phraseIndex,length:gt.phraseLength}));return ht}},circularBuffer=function _(){const o="circular-buffer.js: ";let $=-1,j=0;this.init=function(tt){if(typeof tt!="number"||tt<=0)throw new Error(`${o}init: circular buffer size must an integer > 0`);j=Math.ceil(tt),$=-1},this.increment=function(){return $+=1,($+j)%j},this.maxSize=function(){return j},this.items=function(){return $+1},this.getListIndex=function(tt){return $===-1||tt<0||tt>$||$-tt>=j?-1:(tt+j)%j},this.forEach=function(tt){if($!==-1){if($<j){for(let rt=0;rt<=$;rt+=1)tt(rt,rt);return}for(let rt=$-j+1;rt<=$;rt+=1){const nt=(rt+j)%j;tt(nt,rt)}}}},parser$3=function _(){const o=identifiers,$=utilities,j="parser.js: ",et=this;let tt;this.ast=null,this.stats=null,this.trace=null,this.callbacks=[];let rt=null,nt=null,it,st,ot,at,ct=0,ut=0,ft=0,ht=null,mt=null,gt=null,Et=null,St=null,At=0,kt=1/0,Rt=1/0;const Tt=function(er,Xt,tr){const ur=`${j}evaluateRule(): `;if(er>=gt.length)throw new Error(`${ur}rule index: ${er} out of range`);if(Xt>=ot)throw new Error(`${ur}phrase index: ${Xt} out of range`);const{length:pr}=rt;rt.push({type:o.RNM,index:er}),tt(pr,Xt,tr),rt.pop()},Dt=function(ar,er,Xt){const tr=`${j}evaluateUdt(): `;if(ar>=Et.length)throw new Error(`${tr}udt index: ${ar} out of range`);if(er>=ot)throw new Error(`${tr}phrase index: ${er} out of range`);const{length:ur}=rt;rt.push({type:o.UDT,empty:Et[ar].empty,index:ar}),tt(ur,er,Xt),rt.pop()},Ot=function(){ct=0,ut=0,ft=0,At=0,at=[{lookAround:o.LOOKAROUND_NONE,anchor:0,charsEnd:0,charsLength:0}],gt=null,Et=null,nt=null,it=0,st=0,ot=0,ht=null,mt=null,St=null,rt=null},jt=function(){const ar=[],er=function(){const tr={};gt.forEach(ur=>{ur.isBkr&&(tr[ur.lower]=null)}),Et.length>0&&Et.forEach(ur=>{ur.isBkr&&(tr[ur.lower]=null)}),ar.push(tr)},Xt=function(){const tr=ar[ar.length-1],ur={};for(const pr in tr)ur[pr]=tr[pr];return ur};this.push=function(){ar.push(Xt())},this.pop=function(ur){let pr=ur;if(pr||(pr=ar.length-1),pr<1||pr>ar.length)throw new Error(`${j}backRef.pop(): bad length: ${pr}`);return ar.length=pr,ar[ar.length-1]},this.length=function(){return ar.length},this.savePhrase=function(ur,pr,yr){ar[ar.length-1][ur]={phraseIndex:pr,phraseLength:yr}},this.getPhrase=function(tr){return ar[ar.length-1][tr]},er()},Nt=function(){const er=this;this.state=o.ACTIVE,this.phraseLength=0,this.ruleIndex=0,this.udtIndex=0,this.lookAround=at[at.length-1],this.uFrame=new jt,this.pFrame=new jt,this.evaluateRule=Tt,this.evaluateUdt=Dt,this.refresh=function(){er.state=o.ACTIVE,er.phraseLength=0,er.lookAround=at[at.length-1]}},It=function(){return at[at.length-1]},yt=function(){return at.length>1},lt=function(){return at[at.length-1].lookAround===o.LOOKAROUND_BEHIND},pt=function(){const ar=`${j}initializeAst(): `,er=!0;for(;er;){if(et.ast===void 0){et.ast=null;break}if(et.ast===null)break;if(et.ast.astObject!=="astObject")throw new Error(`${ar}ast object not recognized`);break}et.ast!==null&&et.ast.init(gt,Et,nt)},bt=function(){const ar=`${j}initializeTrace(): `,er=!0;for(;er;){if(et.trace===void 0){et.trace=null;break}if(et.trace===null)break;if(et.trace.traceObject!=="traceObject")throw new Error(`${ar}trace object not recognized`);break}et.trace!==null&&et.trace.init(gt,Et,nt)},_t=function(){const ar=`${j}initializeStats(): `,er=!0;for(;er;){if(et.stats===void 0){et.stats=null;break}if(et.stats===null)break;if(et.stats.statsObject!=="statsObject")throw new Error(`${ar}stats object not recognized`);break}et.stats!==null&&et.stats.init(gt,Et)},$t=function(ar){const er=`${j}initializeGrammar(): `;if(!ar)throw new Error(`${er}grammar object undefined`);if(ar.grammarObject!=="grammarObject")throw new Error(`${er}bad grammar object`);gt=ar.rules,Et=ar.udts},Ct=function(ar){const er=`${j}initializeStartRule(): `;let Xt=null;if(typeof ar=="number"){if(ar>=gt.length)throw new Error(`${er}start rule index too large: max: ${gt.length}: index: ${ar}`);Xt=ar}else if(typeof ar=="string"){const tr=ar.toLowerCase();for(let ur=0;ur<gt.length;ur+=1)if(tr===gt[ur].lower){Xt=gt[ur].index;break}if(Xt===null)throw new Error(`${er}start rule name '${ar}' not recognized`)}else throw new Error(`${er}type of start rule '${typeof ar}' not recognized`);return Xt},xt=function(er,Xt,tr){const ur=`${j}initializeInputChars(): `;let pr=er,yr=Xt,wr=tr;if(pr===void 0)throw new Error(`${ur}input string is undefined`);if(pr===null)throw new Error(`${ur}input string is null`);if(typeof pr=="string")pr=$.stringToChars(pr);else if(!Array.isArray(pr))throw new Error(`${ur}input string is not a string or array`);if(pr.length>0&&typeof pr[0]!="number")throw new Error(`${ur}input string not an array of integers`);if(typeof yr!="number")yr=0;else if(yr=Math.floor(yr),yr<0||yr>pr.length)throw new Error(`${ur}input beginning index out of range: ${yr}`);if(typeof wr!="number")wr=pr.length-yr;else if(wr=Math.floor(wr),wr<0||wr>pr.length-yr)throw new Error(`${ur}input length out of range: ${wr}`);nt=pr,it=yr,st=wr,ot=it+st},vt=function(){const ar=`${j}initializeCallbacks(): `;let er;for(ht=[],mt=[],er=0;er<gt.length;er+=1)ht[er]=null;for(er=0;er<Et.length;er+=1)mt[er]=null;let Xt;const tr=[];for(er=0;er<gt.length;er+=1)tr.push(gt[er].lower);for(er=0;er<Et.length;er+=1)tr.push(Et[er].lower);for(const ur in et.callbacks){if(er=tr.indexOf(ur.toLowerCase()),er<0)throw new Error(`${ar}syntax callback '${ur}' not a rule or udt name`);if(Xt=et.callbacks[ur],Xt||(Xt=null),typeof Xt=="function"||Xt===null)er<gt.length?ht[er]=Xt:mt[er-gt.length]=Xt;else throw new Error(`${ar}syntax callback[${ur}] must be function reference or 'false' (false/null/undefined/etc.)`)}for(er=0;er<Et.length;er+=1)if(mt[er]===null)throw new Error(`${ar}all UDT callbacks must be defined. UDT callback[${Et[er].lower}] not a function reference`)};this.setMaxTreeDepth=function(ar){if(typeof ar!="number")throw new Error(`parser: max tree depth must be integer > 0: ${ar}`);if(kt=Math.floor(ar),kt<=0)throw new Error(`parser: max tree depth must be integer > 0: ${ar}`)},this.setMaxNodeHits=function(ar){if(typeof ar!="number")throw new Error(`parser: max node hits must be integer > 0: ${ar}`);if(Rt=Math.floor(ar),Rt<=0)throw new Error(`parser: max node hits must be integer > 0: ${ar}`)};const dt=function(ar,er,Xt){let tr;const ur=`${j}parse(): `;$t(ar);const pr=Ct(er);vt(),bt(),_t(),pt();const yr=new Nt;switch(Xt!=null&&(St=Xt),rt=[{type:o.RNM,index:pr}],tt(0,it,yr),rt=null,yr.state){case o.ACTIVE:throw new Error(`${ur}final state should never be 'ACTIVE'`);case o.NOMATCH:tr=!1;break;case o.EMPTY:case o.MATCH:yr.phraseLength===st?tr=!0:tr=!1;break;default:throw new Error("unrecognized state")}return{success:tr,state:yr.state,length:st,matched:yr.phraseLength,maxMatched:At,maxTreeDepth:ut,nodeHits:ft,inputLength:nt.length,subBegin:it,subEnd:ot,subLength:st}};this.parseSubstring=function(er,Xt,tr,ur,pr,yr){return Ot(),xt(tr,ur,pr),dt(er,Xt,yr)},this.parse=function(er,Xt,tr,ur){return Ot(),xt(tr,0,tr.length),dt(er,Xt,ur)};const wt=function(ar,er,Xt){const tr=rt[ar];for(let ur=0;ur<tr.children.length&&(tt(tr.children[ur],er,Xt),Xt.state===o.NOMATCH);ur+=1);},qt=function(ar,er,Xt){let tr,ur,pr,yr;const wr=rt[ar],Gr=Xt.uFrame.length(),$r=Xt.pFrame.length();et.ast&&(ur=et.ast.getLength()),tr=!0,pr=er,yr=0;for(let Er=0;Er<wr.children.length;Er+=1)if(tt(wr.children[Er],pr,Xt),Xt.state===o.NOMATCH){tr=!1;break}else pr+=Xt.phraseLength,yr+=Xt.phraseLength;tr?(Xt.state=yr===0?o.EMPTY:o.MATCH,Xt.phraseLength=yr):(Xt.state=o.NOMATCH,Xt.phraseLength=0,Xt.uFrame.pop(Gr),Xt.pFrame.pop($r),et.ast&&et.ast.setLength(ur))},Pt=function(ar,er,Xt){let tr,ur,pr,yr;const wr=rt[ar];ur=er,pr=0,yr=0;const Gr=Xt.uFrame.length(),$r=Xt.pFrame.length();et.ast&&(tr=et.ast.getLength());const Er=!0;for(;Er&&!(ur>=ot||(tt(ar+1,ur,Xt),Xt.state===o.NOMATCH)||Xt.state===o.EMPTY||(yr+=1,pr+=Xt.phraseLength,ur+=Xt.phraseLength,yr===wr.max)););Xt.state===o.EMPTY||yr>=wr.min?(Xt.state=pr===0?o.EMPTY:o.MATCH,Xt.phraseLength=pr):(Xt.state=o.NOMATCH,Xt.phraseLength=0,Xt.uFrame.pop(Gr),Xt.pFrame.pop($r),et.ast&&et.ast.setLength(tr))},Gt=function(ar,er,Xt,tr){if(er.phraseLength>Xt){let ur=`${j}opRNM(${ar.name}): callback function error: `;throw ur+=`sysData.phraseLength: ${er.phraseLength}`,ur+=` must be <= remaining chars: ${Xt}`,new Error(ur)}switch(er.state){case o.ACTIVE:if(tr!==!0)throw new Error(`${j}opRNM(${ar.name}): callback function return error. ACTIVE state not allowed.`);break;case o.EMPTY:er.phraseLength=0;break;case o.MATCH:er.phraseLength===0&&(er.state=o.EMPTY);break;case o.NOMATCH:er.phraseLength=0;break;default:throw new Error(`${j}opRNM(${ar.name}): callback function return error. Unrecognized return state: ${er.state}`)}},Wt=function(ar,er,Xt){let tr,ur,pr,yr,wr,Gr;const $r=rt[ar],Er=gt[$r.index],Wr=ht[Er.index],Vr=!yt();if(Vr&&(ur=et.ast&&et.ast.ruleDefined($r.index),ur&&(tr=et.ast.getLength(),et.ast.down($r.index,gt[$r.index].name)),yr=Xt.uFrame.length(),wr=Xt.pFrame.length(),Xt.uFrame.push(),Xt.pFrame.push(),Gr=Xt.pFrame,Xt.pFrame=new jt),Wr===null)pr=rt,rt=Er.opcodes,tt(0,er,Xt),rt=pr;else{const Pr=ot-er;Xt.ruleIndex=Er.index,Wr(Xt,nt,er,St),Gt(Er,Xt,Pr,!0),Xt.state===o.ACTIVE&&(pr=rt,rt=Er.opcodes,tt(0,er,Xt),rt=pr,Xt.ruleIndex=Er.index,Wr(Xt,nt,er,St),Gt(Er,Xt,Pr,!1))}Vr&&(ur&&(Xt.state===o.NOMATCH?et.ast.setLength(tr):et.ast.up($r.index,Er.name,er,Xt.phraseLength)),Xt.pFrame=Gr,Xt.state===o.NOMATCH?(Xt.uFrame.pop(yr),Xt.pFrame.pop(wr)):Er.isBkr&&(Xt.pFrame.savePhrase(Er.lower,er,Xt.phraseLength),Xt.uFrame.savePhrase(Er.lower,er,Xt.phraseLength)))},Vt=function(ar,er,Xt){if(er.phraseLength>Xt){let tr=`${j}opUDT(${ar.name}): callback function error: `;throw tr+=`sysData.phraseLength: ${er.phraseLength}`,tr+=` must be <= remaining chars: ${Xt}`,new Error(tr)}switch(er.state){case o.ACTIVE:throw new Error(`${j}opUDT(${ar.name}): callback function return error. ACTIVE state not allowed.`);case o.EMPTY:if(ar.empty===!1)throw new Error(`${j}opUDT(${ar.name}): callback function return error. May not return EMPTY.`);er.phraseLength=0;break;case o.MATCH:if(er.phraseLength===0){if(ar.empty===!1)throw new Error(`${j}opUDT(${ar.name}): callback function return error. May not return EMPTY.`);er.state=o.EMPTY}break;case o.NOMATCH:er.phraseLength=0;break;default:throw new Error(`${j}opUDT(${ar.name}): callback function return error. Unrecognized return state: ${er.state}`)}},Ut=function(ar,er,Xt){let tr,ur,pr,yr,wr,Gr;const $r=rt[ar],Er=Et[$r.index];Xt.UdtIndex=Er.index;const Wr=!yt();Wr&&(pr=et.ast&&et.ast.udtDefined($r.index),pr&&(ur=gt.length+$r.index,tr=et.ast.getLength(),et.ast.down(ur,Er.name)),yr=Xt.uFrame.length(),wr=Xt.pFrame.length(),Xt.uFrame.push(),Xt.pFrame.push(),Gr=Xt.pFrame,Xt.pFrame=new jt);const Vr=ot-er;mt[$r.index](Xt,nt,er,St),Vt(Er,Xt,Vr),Wr&&(pr&&(Xt.state===o.NOMATCH?et.ast.setLength(tr):et.ast.up(ur,Er.name,er,Xt.phraseLength)),Xt.pFrame=Gr,Xt.state===o.NOMATCH?(Xt.uFrame.pop(yr),Xt.pFrame.pop(wr)):Er.isBkr&&(Xt.pFrame.savePhrase(Er.lower,er,Xt.phraseLength),Xt.uFrame.savePhrase(Er.lower,er,Xt.phraseLength)))},Mt=function(ar,er,Xt){at.push({lookAround:o.LOOKAROUND_AHEAD,anchor:er,charsEnd:ot,charsLength:st}),ot=nt.length,st=nt.length-it,tt(ar+1,er,Xt);const tr=at.pop();switch(ot=tr.charsEnd,st=tr.charsLength,Xt.phraseLength=0,Xt.state){case o.EMPTY:Xt.state=o.EMPTY;break;case o.MATCH:Xt.state=o.EMPTY;break;case o.NOMATCH:Xt.state=o.NOMATCH;break;default:throw new Error(`opAND: invalid state ${Xt.state}`)}},Lt=function(ar,er,Xt){at.push({lookAround:o.LOOKAROUND_AHEAD,anchor:er,charsEnd:ot,charsLength:st}),ot=nt.length,st=nt.length-it,tt(ar+1,er,Xt);const tr=at.pop();switch(ot=tr.charsEnd,st=tr.charsLength,Xt.phraseLength=0,Xt.state){case o.EMPTY:case o.MATCH:Xt.state=o.NOMATCH;break;case o.NOMATCH:Xt.state=o.EMPTY;break;default:throw new Error(`opNOT: invalid state ${Xt.state}`)}},Yt=function(ar,er,Xt){const tr=rt[ar];Xt.state=o.NOMATCH,er<ot&&tr.min<=nt[er]&&nt[er]<=tr.max&&(Xt.state=o.MATCH,Xt.phraseLength=1)},lr=function(ar,er,Xt){let tr;const ur=rt[ar],pr=ur.string.length;if(Xt.state=o.NOMATCH,er+pr<=ot){for(tr=0;tr<pr;tr+=1)if(nt[er+tr]!==ur.string[tr])return;Xt.state=o.MATCH,Xt.phraseLength=pr}},cr=function(ar,er,Xt){let tr,ur;const pr=rt[ar];Xt.state=o.NOMATCH;const yr=pr.string.length;if(yr===0){Xt.state=o.EMPTY;return}if(er+yr<=ot){for(tr=0;tr<yr;tr+=1)if(ur=nt[er+tr],ur>=65&&ur<=90&&(ur+=32),ur!==pr.string[tr])return;Xt.state=o.MATCH,Xt.phraseLength=yr}},ir=function(ar,er,Xt){Xt.state=o.NOMATCH,Xt.phraseLength=0,Xt.state=er===0?o.EMPTY:o.NOMATCH},Zt=function(ar,er,Xt){Xt.state=o.NOMATCH,Xt.phraseLength=0,Xt.state=er===nt.length?o.EMPTY:o.NOMATCH},Bt=function(ar,er,Xt){let tr,ur,pr,yr;const wr=rt[ar];Xt.state=o.NOMATCH,wr.index<gt.length?yr=gt[wr.index].lower:yr=Et[wr.index-gt.length].lower;const Gr=wr.bkrMode===o.BKR_MODE_PM?Xt.pFrame.getPhrase(yr):Xt.uFrame.getPhrase(yr),$r=wr.bkrCase===o.BKR_MODE_CI;if(Gr===null)return;const Er=Gr.phraseIndex,Wr=Gr.phraseLength;if(Wr===0){Xt.state=o.EMPTY;return}if(er+Wr<=ot){if($r){for(tr=0;tr<Wr;tr+=1)if(ur=nt[er+tr],pr=nt[Er+tr],ur>=65&&ur<=90&&(ur+=32),pr>=65&&pr<=90&&(pr+=32),ur!==pr)return;Xt.state=o.MATCH,Xt.phraseLength=Wr}else for(tr=0;tr<Wr;tr+=1)if(ur=nt[er+tr],pr=nt[Er+tr],ur!==pr)return;Xt.state=o.MATCH,Xt.phraseLength=Wr}},Ft=function(ar,er,Xt){switch(at.push({lookAround:o.LOOKAROUND_BEHIND,anchor:er}),tt(ar+1,er,Xt),at.pop(),Xt.phraseLength=0,Xt.state){case o.EMPTY:Xt.state=o.EMPTY;break;case o.MATCH:Xt.state=o.EMPTY;break;case o.NOMATCH:Xt.state=o.NOMATCH;break;default:throw new Error(`opBKA: invalid state ${Xt.state}`)}},zt=function(ar,er,Xt){switch(at.push({lookAround:o.LOOKAROUND_BEHIND,anchor:er}),tt(ar+1,er,Xt),at.pop(),Xt.phraseLength=0,Xt.state){case o.EMPTY:case o.MATCH:Xt.state=o.NOMATCH;break;case o.NOMATCH:Xt.state=o.EMPTY;break;default:throw new Error(`opBKN: invalid state ${Xt.state}`)}},Qt=function(ar,er,Xt){let tr,ur,pr,yr;const wr=rt[ar],Gr=Xt.uFrame.length(),$r=Xt.pFrame.length();et.ast&&(ur=et.ast.getLength()),tr=!0,pr=er,yr=0;for(let Er=wr.children.length-1;Er>=0;Er-=1)if(tt(wr.children[Er],pr,Xt),pr-=Xt.phraseLength,yr+=Xt.phraseLength,Xt.state===o.NOMATCH){tr=!1;break}tr?(Xt.state=yr===0?o.EMPTY:o.MATCH,Xt.phraseLength=yr):(Xt.state=o.NOMATCH,Xt.phraseLength=0,Xt.uFrame.pop(Gr),Xt.pFrame.pop($r),et.ast&&et.ast.setLength(ur))},nr=function(ar,er,Xt){let tr,ur,pr,yr;const wr=rt[ar];ur=er,pr=0,yr=0;const Gr=Xt.uFrame.length(),$r=Xt.pFrame.length();et.ast&&(tr=et.ast.getLength());const Er=!0;for(;Er&&!(ur<=0||(tt(ar+1,ur,Xt),Xt.state===o.NOMATCH)||Xt.state===o.EMPTY||(yr+=1,pr+=Xt.phraseLength,ur-=Xt.phraseLength,yr===wr.max)););Xt.state===o.EMPTY||yr>=wr.min?(Xt.state=pr===0?o.EMPTY:o.MATCH,Xt.phraseLength=pr):(Xt.state=o.NOMATCH,Xt.phraseLength=0,Xt.uFrame.pop(Gr),Xt.pFrame.pop($r),et.ast&&et.ast.setLength(tr))},gr=function(ar,er,Xt){const tr=rt[ar];if(Xt.state=o.NOMATCH,Xt.phraseLength=0,er>0){const ur=nt[er-1];tr.min<=ur&&ur<=tr.max&&(Xt.state=o.MATCH,Xt.phraseLength=1)}},br=function(ar,er,Xt){let tr;const ur=rt[ar];Xt.state=o.NOMATCH;const pr=ur.string.length,yr=er-pr;if(yr>=0){for(tr=0;tr<pr;tr+=1)if(nt[yr+tr]!==ur.string[tr])return;Xt.state=o.MATCH,Xt.phraseLength=pr}},vr=function(ar,er,Xt){let tr;const ur=rt[ar];Xt.state=o.NOMATCH;const pr=ur.string.length;if(pr===0){Xt.state=o.EMPTY;return}const yr=er-pr;if(yr>=0){for(let wr=0;wr<pr;wr+=1)if(tr=nt[yr+wr],tr>=65&&tr<=90&&(tr+=32),tr!==ur.string[wr])return;Xt.state=o.MATCH,Xt.phraseLength=pr}},Nr=function(ar,er,Xt){let tr,ur,pr,yr;const wr=rt[ar];Xt.state=o.NOMATCH,Xt.phraseLength=0,wr.index<gt.length?yr=gt[wr.index].lower:yr=Et[wr.index-gt.length].lower;const Gr=wr.bkrMode===o.BKR_MODE_PM?Xt.pFrame.getPhrase(yr):Xt.uFrame.getPhrase(yr),$r=wr.bkrCase===o.BKR_MODE_CI;if(Gr===null)return;const Er=Gr.phraseIndex,Wr=Gr.phraseLength;if(Wr===0){Xt.state=o.EMPTY,Xt.phraseLength=0;return}const Vr=er-Wr;if(Vr>=0){if($r){for(tr=0;tr<Wr;tr+=1)if(ur=nt[Vr+tr],pr=nt[Er+tr],ur>=65&&ur<=90&&(ur+=32),pr>=65&&pr<=90&&(pr+=32),ur!==pr)return;Xt.state=o.MATCH,Xt.phraseLength=Wr}else for(tr=0;tr<Wr;tr+=1)if(ur=nt[Vr+tr],pr=nt[Er+tr],ur!==pr)return;Xt.state=o.MATCH,Xt.phraseLength=Wr}};tt=function(er,Xt,tr){let ur=!0;const pr=rt[er];if(ft+=1,ft>Rt)throw new Error(`parser: maximum number of node hits exceeded: ${Rt}`);if(ct+=1,ct>ut&&(ut=ct,ut>kt))throw new Error(`parser: maximum parse tree depth exceeded: ${kt}`);if(tr.refresh(),et.trace!==null){const yr=It();et.trace.down(pr,tr.state,Xt,tr.phraseLength,yr.anchor,yr.lookAround)}if(lt())switch(pr.type){case o.ALT:wt(er,Xt,tr);break;case o.CAT:Qt(er,Xt,tr);break;case o.REP:nr(er,Xt,tr);break;case o.RNM:Wt(er,Xt,tr);break;case o.UDT:Ut(er,Xt,tr);break;case o.AND:Mt(er,Xt,tr);break;case o.NOT:Lt(er,Xt,tr);break;case o.TRG:gr(er,Xt,tr);break;case o.TBS:br(er,Xt,tr);break;case o.TLS:vr(er,Xt,tr);break;case o.BKR:Nr(er,Xt,tr);break;case o.BKA:Ft(er,Xt,tr);break;case o.BKN:zt(er,Xt,tr);break;case o.ABG:ir(er,Xt,tr);break;case o.AEN:Zt(er,Xt,tr);break;default:ur=!1;break}else switch(pr.type){case o.ALT:wt(er,Xt,tr);break;case o.CAT:qt(er,Xt,tr);break;case o.REP:Pt(er,Xt,tr);break;case o.RNM:Wt(er,Xt,tr);break;case o.UDT:Ut(er,Xt,tr);break;case o.AND:Mt(er,Xt,tr);break;case o.NOT:Lt(er,Xt,tr);break;case o.TRG:Yt(er,Xt,tr);break;case o.TBS:lr(er,Xt,tr);break;case o.TLS:cr(er,Xt,tr);break;case o.BKR:Bt(er,Xt,tr);break;case o.BKA:Ft(er,Xt,tr);break;case o.BKN:zt(er,Xt,tr);break;case o.ABG:ir(er,Xt,tr);break;case o.AEN:Zt(er,Xt,tr);break;default:ur=!1;break}if(!yt()&&Xt+tr.phraseLength>At&&(At=Xt+tr.phraseLength),et.stats!==null&&et.stats.collect(pr,tr),et.trace!==null){const yr=It();et.trace.up(pr,tr.state,Xt,tr.phraseLength,yr.anchor,yr.lookAround)}return ct-=1,ur}},stats=function _(){const o=identifiers,$=utilities,j=style$1,et="stats.js: ";let tt=[],rt=[];const nt=[];let it;const st=[],ot=[];this.statsObject="statsObject";const at="stats",ct=function(Rt,Tt){return Rt.lower<Tt.lower?-1:Rt.lower>Tt.lower?1:0},ut=function(Rt,Tt){return Rt.total<Tt.total?1:Rt.total>Tt.total?-1:ct(Rt,Tt)},ft=function(Rt,Tt){return Rt.index<Tt.index?-1:Rt.index>Tt.index?1:0},ht=function(){this.empty=0,this.match=0,this.nomatch=0,this.total=0},mt=function(){nt.length=0,it=new ht,nt[o.ALT]=new ht,nt[o.CAT]=new ht,nt[o.REP]=new ht,nt[o.RNM]=new ht,nt[o.TRG]=new ht,nt[o.TBS]=new ht,nt[o.TLS]=new ht,nt[o.UDT]=new ht,nt[o.AND]=new ht,nt[o.NOT]=new ht,nt[o.BKR]=new ht,nt[o.BKA]=new ht,nt[o.BKN]=new ht,nt[o.ABG]=new ht,nt[o.AEN]=new ht,st.length=0;for(let Rt=0;Rt<tt.length;Rt+=1)st.push({empty:0,match:0,nomatch:0,total:0,name:tt[Rt].name,lower:tt[Rt].lower,index:tt[Rt].index});if(rt.length>0){ot.length=0;for(let Rt=0;Rt<rt.length;Rt+=1)ot.push({empty:0,match:0,nomatch:0,total:0,name:rt[Rt].name,lower:rt[Rt].lower,index:rt[Rt].index})}},gt=function(Rt,Tt){switch(Rt.total+=1,Tt){case o.EMPTY:Rt.empty+=1;break;case o.MATCH:Rt.match+=1;break;case o.NOMATCH:Rt.nomatch+=1;break;default:throw new Error(`${et}collect(): incStat(): unrecognized state: ${Tt}`)}},Et=function(Rt,Tt){let Dt="";return Dt+="<tr>",Dt+=`<td class="${j.CLASS_ACTIVE}">${Rt}</td>`,Dt+=`<td class="${j.CLASS_EMPTY}">${Tt.empty}</td>`,Dt+=`<td class="${j.CLASS_MATCH}">${Tt.match}</td>`,Dt+=`<td class="${j.CLASS_NOMATCH}">${Tt.nomatch}</td>`,Dt+=`<td class="${j.CLASS_ACTIVE}">${Tt.total}</td>`,Dt+=`</tr>
`,Dt},St=function(){let Rt="";return Rt+=Et("ALT",nt[o.ALT]),Rt+=Et("CAT",nt[o.CAT]),Rt+=Et("REP",nt[o.REP]),Rt+=Et("RNM",nt[o.RNM]),Rt+=Et("TRG",nt[o.TRG]),Rt+=Et("TBS",nt[o.TBS]),Rt+=Et("TLS",nt[o.TLS]),Rt+=Et("UDT",nt[o.UDT]),Rt+=Et("AND",nt[o.AND]),Rt+=Et("NOT",nt[o.NOT]),Rt+=Et("BKR",nt[o.BKR]),Rt+=Et("BKA",nt[o.BKA]),Rt+=Et("BKN",nt[o.BKN]),Rt+=Et("ABG",nt[o.ABG]),Rt+=Et("AEN",nt[o.AEN]),Rt+=Et("totals",it),Rt},At=function(){let Rt="";Rt+=`<tr><th></th><th></th><th></th><th></th><th></th></tr>
`,Rt+=`<tr><th>rules</th><th></th><th></th><th></th><th></th></tr>
`;for(let Tt=0;Tt<tt.length;Tt+=1)st[Tt].total>0&&(Rt+="<tr>",Rt+=`<td class="${j.CLASS_ACTIVE}">${st[Tt].name}</td>`,Rt+=`<td class="${j.CLASS_EMPTY}">${st[Tt].empty}</td>`,Rt+=`<td class="${j.CLASS_MATCH}">${st[Tt].match}</td>`,Rt+=`<td class="${j.CLASS_NOMATCH}">${st[Tt].nomatch}</td>`,Rt+=`<td class="${j.CLASS_ACTIVE}">${st[Tt].total}</td>`,Rt+=`</tr>
`);if(rt.length>0){Rt+=`<tr><th></th><th></th><th></th><th></th><th></th></tr>
`,Rt+=`<tr><th>udts</th><th></th><th></th><th></th><th></th></tr>
`;for(let Tt=0;Tt<rt.length;Tt+=1)ot[Tt].total>0&&(Rt+="<tr>",Rt+=`<td class="${j.CLASS_ACTIVE}">${ot[Tt].name}</td>`,Rt+=`<td class="${j.CLASS_EMPTY}">${ot[Tt].empty}</td>`,Rt+=`<td class="${j.CLASS_MATCH}">${ot[Tt].match}</td>`,Rt+=`<td class="${j.CLASS_NOMATCH}">${ot[Tt].nomatch}</td>`,Rt+=`<td class="${j.CLASS_ACTIVE}">${ot[Tt].total}</td>`,Rt+=`</tr>
`)}return Rt};this.validate=function(Rt){let Tt=!1;return typeof Rt=="string"&&at===Rt&&(Tt=!0),Tt},this.init=function(Rt,Tt){tt=Rt,rt=Tt,mt()},this.collect=function(Rt,Tt){gt(it,Tt.state,Tt.phraseLength),gt(nt[Rt.type],Tt.state,Tt.phraseLength),Rt.type===o.RNM&&gt(st[Rt.index],Tt.state,Tt.phraseLength),Rt.type===o.UDT&&gt(ot[Rt.index],Tt.state,Tt.phraseLength)},this.toHtml=function(Rt,Tt){let Dt="";Dt+=`<table class="${j.CLASS_STATS}">
`,typeof Tt=="string"&&(Dt+=`<caption>${Tt}</caption>
`),Dt+=`<tr><th class="${j.CLASS_ACTIVE}">ops</th>
`,Dt+=`<th class="${j.CLASS_EMPTY}">EMPTY</th>
`,Dt+=`<th class="${j.CLASS_MATCH}">MATCH</th>
`,Dt+=`<th class="${j.CLASS_NOMATCH}">NOMATCH</th>
`,Dt+=`<th class="${j.CLASS_ACTIVE}">totals</th></tr>
`;const Ot=!0;for(;Ot;){if(Rt===void 0){Dt+=St();break}if(Rt===null){Dt+=St();break}if(Rt==="ops"){Dt+=St();break}if(Rt==="index"){st.sort(ft),ot.length>0&&ot.sort(ft),Dt+=St(),Dt+=At();break}if(Rt==="hits"){st.sort(ut),ot.length>0&&ot.sort(ft),Dt+=St(),Dt+=At();break}if(Rt==="alpha"){st.sort(ct),ot.length>0&&ot.sort(ct),Dt+=St(),Dt+=At();break}break}return Dt+=`</table>
`,Dt},this.toHtmlPage=function(Rt,Tt,Dt){return $.htmlToPage(this.toHtml(Rt,Tt),Dt)}},trace=function _(){const o=utilities,$=style$1,j=new circularBuffer,et=identifiers,tt="trace.js: ",rt=this,nt=16,it=10,st=8,ot=32,at=80,ct=5,ut=[];let ft=5e3,ht=-1,mt=0,gt=0;const Et=[];let St=null,At=null,kt=null;const Rt=[],Tt=[],Dt=`<span class="${$.CLASS_LINEEND}">&bull;</span>`,Ot=`<span class="${$.CLASS_LINEEND}">&hellip;</span>`,jt=`<span class="${$.CLASS_EMPTY}">&#120634;</span>`,Nt=function(){const Vt=function(Mt){Rt[et.ALT]=Mt,Rt[et.CAT]=Mt,Rt[et.REP]=Mt,Rt[et.TLS]=Mt,Rt[et.TBS]=Mt,Rt[et.TRG]=Mt,Rt[et.AND]=Mt,Rt[et.NOT]=Mt,Rt[et.BKR]=Mt,Rt[et.BKA]=Mt,Rt[et.BKN]=Mt,Rt[et.ABG]=Mt,Rt[et.AEN]=Mt};let Ut=0;for(const Mt in rt.filter.operators)Ut+=1;if(Ut===0){Vt(!1);return}for(const Mt in rt.filter.operators){const Lt=Mt.toUpperCase();if(Lt==="<ALL>"){Vt(!0);return}if(Lt==="<NONE>"){Vt(!1);return}}Vt(!1);for(const Mt in rt.filter.operators){const Lt=Mt.toUpperCase();if(Lt==="ALT")Rt[et.ALT]=rt.filter.operators[Mt]===!0;else if(Lt==="CAT")Rt[et.CAT]=rt.filter.operators[Mt]===!0;else if(Lt==="REP")Rt[et.REP]=rt.filter.operators[Mt]===!0;else if(Lt==="AND")Rt[et.AND]=rt.filter.operators[Mt]===!0;else if(Lt==="NOT")Rt[et.NOT]=rt.filter.operators[Mt]===!0;else if(Lt==="TLS")Rt[et.TLS]=rt.filter.operators[Mt]===!0;else if(Lt==="TBS")Rt[et.TBS]=rt.filter.operators[Mt]===!0;else if(Lt==="TRG")Rt[et.TRG]=rt.filter.operators[Mt]===!0;else if(Lt==="BKR")Rt[et.BKR]=rt.filter.operators[Mt]===!0;else if(Lt==="BKA")Rt[et.BKA]=rt.filter.operators[Mt]===!0;else if(Lt==="BKN")Rt[et.BKN]=rt.filter.operators[Mt]===!0;else if(Lt==="ABG")Rt[et.ABG]=rt.filter.operators[Mt]===!0;else if(Lt==="AEN")Rt[et.AEN]=rt.filter.operators[Mt]===!0;else throw new Error(`${tt}initOpratorFilter: '${Mt}' not a valid operator name. Must be <all>, <none>, alt, cat, rep, tls, tbs, trg, and, not, bkr, bka or bkn`)}},It=function(){const Vt=function(Yt){Rt[et.RNM]=Yt,Rt[et.UDT]=Yt;const lr=At.length+kt.length;Tt.length=0;for(let cr=0;cr<lr;cr+=1)Tt.push(Yt)};let Ut,Mt;const Lt=[];for(Mt=0;Mt<At.length;Mt+=1)Lt.push(At[Mt].lower);for(Mt=0;Mt<kt.length;Mt+=1)Lt.push(kt[Mt].lower);Tt.length=0,Ut=0;for(const Yt in rt.filter.rules)Ut+=1;if(Ut===0){Vt(!0);return}for(const Yt in rt.filter.rules){const lr=Yt.toLowerCase();if(lr==="<all>"){Vt(!0);return}if(lr==="<none>"){Vt(!1);return}}Vt(!1),Rt[et.RNM]=!0,Rt[et.UDT]=!0;for(const Yt in rt.filter.rules){const lr=Yt.toLowerCase();if(Mt=Lt.indexOf(lr),Mt<0)throw new Error(`${tt}initRuleFilter: '${Yt}' not a valid rule or udt name`);Tt[Mt]=rt.filter.rules[Yt]===!0}};this.traceObject="traceObject",this.filter={operators:[],rules:[]},this.setMaxRecords=function(Vt,Ut){if(ht=-1,typeof Vt=="number"&&Vt>0)ft=Math.ceil(Vt);else{ft=0;return}typeof Ut=="number"&&(ht=Math.floor(Ut),ht<0&&(ht=-1))},this.getMaxRecords=function(){return ft},this.getLastRecord=function(){return ht},this.init=function(Vt,Ut,Mt){ut.length=0,Et.length=0,mt=0,gt=0,St=Mt,At=Vt,kt=Ut,Nt(),It(),j.init(ft)};const yt=function(Vt){let Ut=!1;return Vt.type===et.RNM?Rt[Vt.type]&&Tt[Vt.index]?Ut=!0:Ut=!1:Vt.type===et.UDT?Rt[Vt.type]&&Tt[At.length+Vt.index]?Ut=!0:Ut=!1:Ut=Rt[Vt.type],Ut},lt=function(Vt){return ht===-1||Vt<=ht};this.down=function(Vt,Ut,Mt,Lt,Yt,lr){lt(mt)&&yt(Vt)&&(Et.push(mt),ut[j.increment()]={dirUp:!1,depth:gt,thisLine:mt,thatLine:void 0,opcode:Vt,state:Ut,phraseIndex:Mt,phraseLength:Lt,lookAnchor:Yt,lookAround:lr},mt+=1,gt+=1)},this.up=function(Vt,Ut,Mt,Lt,Yt,lr){if(lt(mt)&&yt(Vt)){const cr=mt,ir=Et.pop(),Zt=j.getListIndex(ir);Zt!==-1&&(ut[Zt].thatLine=cr),gt-=1,ut[j.increment()]={dirUp:!0,depth:gt,thisLine:cr,thatLine:ir,opcode:Vt,state:Ut,phraseIndex:Mt,phraseLength:Lt,lookAnchor:Yt,lookAround:lr},mt+=1}};const pt=function(){function Vt(Xt,tr){let ur,pr,yr;if(tr)switch(Xt.op={id:tr.type,name:o.opcodeToString(tr.type)},Xt.opData=void 0,tr.type){case et.RNM:Xt.opData=At[tr.index].name;break;case et.UDT:Xt.opData=kt[tr.index].name;break;case et.BKR:tr.index<At.length?ur=At[tr.index].name:ur=kt[tr.index-At.length].name,pr=tr.bkrCase===et.BKR_MODE_CI?"%i":"%s",yr=tr.bkrMode===et.BKR_MODE_UM?"%u":"%p",Xt.opData=`\\\\${pr}${yr}${ur}`;break;case et.TLS:Xt.opData=[];for(let wr=0;wr<tr.string.length;wr+=1)Xt.opData.push(tr.string[wr]);break;case et.TBS:Xt.opData=[];for(let wr=0;wr<tr.string.length;wr+=1)Xt.opData.push(tr.string[wr]);break;case et.TRG:Xt.opData=[tr.min,tr.max];break;case et.REP:Xt.opData=[tr.min,tr.max];break;default:throw new Error("unrecognized opcode")}else Xt.op={id:void 0,name:void 0},Xt.opData=void 0}function Ut(Xt,tr,ur){return Xt===et.MATCH?{index:tr,length:ur}:Xt===et.NOMATCH?{index:tr,length:0}:Xt===et.EMPTY?{index:tr,length:0}:null}let Mt=-1;function Lt(Xt,tr,ur){const pr={id:Mt++,branch:-1,parent:Xt,up:!1,down:!1,depth:ur,children:[]};return tr?(pr.down=!0,pr.state={id:tr.state,name:o.stateToString(tr.state)},pr.phrase=null,Vt(pr,tr.opcode)):(pr.state={id:void 0,name:void 0},pr.phrase=Ut(),Vt(pr,void 0)),pr}function Yt(Xt,tr){tr&&(Xt.up=!0,Xt.state={id:tr.state,name:o.stateToString(tr.state)},Xt.phrase=Ut(tr.state,tr.phraseIndex,tr.phraseLength),Xt.down||Vt(Xt,tr.opcode))}let lr=0,cr=-1,ir=1;function Zt(Xt){if(cr+=1,Xt.branch=ir,cr>gt&&(gt=cr),Xt.children.length===0)lr+=1;else for(let tr=0;tr<Xt.children.length;tr+=1)tr>0&&(ir+=1),Xt.children[tr].leftMost=!1,Xt.children[tr].rightMost=!1,Xt.leftMost&&(Xt.children[tr].leftMost=tr===0),Xt.rightMost&&(Xt.children[tr].rightMost=tr===Xt.children.length-1),Zt(Xt.children[tr]);cr-=1}function Bt(Xt,tr){let ur;const pr={};if(pr.id=Xt.id,pr.branch=Xt.branch,pr.leftMost=Xt.leftMost,pr.rightMost=Xt.rightMost,ur=Xt.state.name?Xt.state.name:"ACTIVE",pr.state={id:Xt.state.id,name:ur},ur=Xt.op.name?Xt.op.name:"?",pr.op={id:Xt.op.id,name:ur},typeof Xt.opData=="string")pr.opData=Xt.opData;else if(Array.isArray(Xt.opData)){pr.opData=[];for(let yr=0;yr<Xt.opData.length;yr+=1)pr.opData[yr]=Xt.opData[yr]}else pr.opData=void 0;Xt.phrase?pr.phrase={index:Xt.phrase.index,length:Xt.phrase.length}:pr.phrase=null,pr.depth=Xt.depth,pr.children=[];for(let yr=0;yr<Xt.children.length;yr+=1)Xt.children.length-1,pr.children[yr]=Bt(Xt.children[yr]);return pr}const Ft=[];let zt,Qt,nr,gr,br=!0;const vr=Lt(null,null,-1);for(Ft.push(vr),Qt=vr,j.forEach(Xt=>{if(gr=ut[Xt],br&&(br=!1,gr.depth>0)){const tr=gr.dirUp?gr.depth+1:gr.depth;for(let ur=0;ur<tr;ur+=1)nr=Qt,Qt=Lt(Qt,null,ur),Ft.push(Qt),nr.children.push(Qt)}gr.dirUp?(Qt=Ft.pop(),Yt(Qt,gr),Qt=Ft[Ft.length-1]):(nr=Qt,Qt=Lt(Qt,gr,gr.depth),Ft.push(Qt),nr.children.push(Qt))});Ft.length>1;)Qt=Ft.pop(),Yt(Qt,null);if(vr.children.length===0)throw new Error("trace.toTree(): parse tree has no nodes");if(Ft.length===0)throw new Error("trace.toTree(): integrity check: dummy root node disappeared?");zt=vr.children[0];let Nr=zt;for(;zt&&!zt.down&&!zt.up;)Nr=zt,zt=zt.children[0];zt=Nr,zt.leftMost=!0,zt.rightMost=!0,Zt(zt),zt.branch=0;const ar={};ar.string=[];for(let Xt=0;Xt<St.length;Xt+=1)ar.string[Xt]=St[Xt];ar.rules=[];for(let Xt=0;Xt<At.length;Xt+=1)ar.rules[Xt]=At[Xt].name;ar.udts=[];for(let Xt=0;Xt<kt.length;Xt+=1)ar.udts[Xt]=kt[Xt].name;ar.id={},ar.id.ALT={id:et.ALT,name:"ALT"},ar.id.CAT={id:et.CAT,name:"CAT"},ar.id.REP={id:et.REP,name:"REP"},ar.id.RNM={id:et.RNM,name:"RNM"},ar.id.TLS={id:et.TLS,name:"TLS"},ar.id.TBS={id:et.TBS,name:"TBS"},ar.id.TRG={id:et.TRG,name:"TRG"},ar.id.UDT={id:et.UDT,name:"UDT"},ar.id.AND={id:et.AND,name:"AND"},ar.id.NOT={id:et.NOT,name:"NOT"},ar.id.BKR={id:et.BKR,name:"BKR"},ar.id.BKA={id:et.BKA,name:"BKA"},ar.id.BKN={id:et.BKN,name:"BKN"},ar.id.ABG={id:et.ABG,name:"ABG"},ar.id.AEN={id:et.AEN,name:"AEN"},ar.id.ACTIVE={id:et.ACTIVE,name:"ACTIVE"},ar.id.MATCH={id:et.MATCH,name:"MATCH"},ar.id.EMPTY={id:et.EMPTY,name:"EMPTY"},ar.id.NOMATCH={id:et.NOMATCH,name:"NOMATCH"},ar.treeDepth=gt,ar.leafNodes=lr;let er;return zt.down?zt.up?er="none":er="right":zt.up?er="left":er="both",ar.branchesIncomplete=er,ar.tree=Bt(zt,zt.depth),ar};this.toTree=function(Vt){const Ut=pt();return Vt?JSON.stringify(Ut):Ut},this.toHtmlPage=function(Vt,Ut,Mt){return o.htmlToPage(this.toHtml(Vt,Ut),Mt)};const bt=function(Vt,Ut){let Mt;switch(Vt){case nt:Mt="hexadecimal";break;case it:Mt="decimal";break;case st:Mt="ASCII";break;case ot:Mt="UNICODE";break;default:throw new Error(`${tt}htmlHeader: unrecognized mode: ${Vt}`)}let Lt="";return Lt+=`<p>display mode: ${Mt}</p>
`,Lt+=`<table class="${$.CLASS_TRACE}">
`,typeof Ut=="string"&&(Lt+=`<caption>${Ut}</caption>`),Lt},_t=function(){let Vt="";return Vt+=`</table>
`,Vt+=`<p class="${$.CLASS_MONOSPACE}">legend:<br>
`,Vt+=`(a)&nbsp;-&nbsp;line number<br>
`,Vt+=`(b)&nbsp;-&nbsp;matching line number<br>
`,Vt+=`(c)&nbsp;-&nbsp;phrase offset<br>
`,Vt+=`(d)&nbsp;-&nbsp;phrase length<br>
`,Vt+=`(e)&nbsp;-&nbsp;tree depth<br>
`,Vt+=`(f)&nbsp;-&nbsp;operator state<br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_ACTIVE}">&darr;</span>&nbsp;&nbsp;phrase opened<br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_MATCH}">&uarr;M</span> phrase matched<br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_EMPTY}">&uarr;E</span> empty phrase matched<br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_NOMATCH}">&uarr;N</span> phrase not matched<br>
`,Vt+=`operator&nbsp;-&nbsp;ALT, CAT, REP, RNM, TRG, TLS, TBS<sup>&dagger;</sup>, UDT, AND, NOT, BKA, BKN, BKR, ABG, AEN<sup>&Dagger;</sup><br>
`,Vt+=`phrase&nbsp;&nbsp;&nbsp;-&nbsp;up to ${at} characters of the phrase being matched<br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_MATCH}">matched characters</span><br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_LOOKAHEAD}">matched characters in look ahead mode</span><br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_LOOKBEHIND}">matched characters in look behind mode</span><br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_REMAINDER}">remainder characters(not yet examined by parser)</span><br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${$.CLASS_CTRLCHAR}">control characters, TAB, LF, CR, etc. (ASCII mode only)</span><br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${jt} empty string<br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${Dt} end of input string<br>
`,Vt+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${Ot} input string display truncated<br>
`,Vt+=`</p>
`,Vt+=`<p class="${$.CLASS_MONOSPACE}">
`,Vt+=`<sup>&dagger;</sup>original ABNF operators:<br>
`,Vt+=`ALT - alternation<br>
`,Vt+=`CAT - concatenation<br>
`,Vt+=`REP - repetition<br>
`,Vt+=`RNM - rule name<br>
`,Vt+=`TRG - terminal range<br>
`,Vt+=`TLS - terminal literal string (case insensitive)<br>
`,Vt+=`TBS - terminal binary string (case sensitive)<br>
`,Vt+=`<br>
`,Vt+=`<sup>&Dagger;</sup>super set SABNF operators:<br>
`,Vt+=`UDT - user-defined terminal<br>
`,Vt+=`AND - positive look ahead<br>
`,Vt+=`NOT - negative look ahead<br>
`,Vt+=`BKA - positive look behind<br>
`,Vt+=`BKN - negative look behind<br>
`,Vt+=`BKR - back reference<br>
`,Vt+=`ABG - anchor - begin of input string<br>
`,Vt+=`AEN - anchor - end of input string<br>
`,Vt+=`</p>
`,Vt};this.indent=function(Vt){let Ut="";for(let Mt=0;Mt<Vt;Mt+=1)Ut+=".";return Ut};const $t=function(Vt,Ut){let Mt="";if(Ut.type===et.TRG)if(Vt===nt||Vt===ot){let Lt=Ut.min.toString(16).toUpperCase();Lt.length%2!==0&&(Lt=`0${Lt}`),Mt+=Vt===nt?"%x":"U+",Mt+=Lt,Lt=Ut.max.toString(16).toUpperCase(),Lt.length%2!==0&&(Lt=`0${Lt}`),Mt+=`&ndash;${Lt}`}else Mt=`%d${Ut.min.toString(10)}&ndash;${Ut.max.toString(10)}`;return Mt},Ct=function(Vt,Ut){let Mt="";if(Ut.type===et.REP)if(Vt===nt){let Lt=Ut.min.toString(16).toUpperCase();Lt.length%2!==0&&(Lt=`0${Lt}`),Mt=`x${Lt}`,Ut.max<1/0?(Lt=Ut.max.toString(16).toUpperCase(),Lt.length%2!==0&&(Lt=`0${Lt}`)):Lt="inf",Mt+=`&ndash;${Lt}`}else Ut.max<1/0?Mt=`${Ut.min.toString(10)}&ndash;${Ut.max.toString(10)}`:Mt=`${Ut.min.toString(10)}&ndash;inf`;return Mt},xt=function(Vt,Ut){let Mt="";if(Ut.type===et.TBS){const Lt=Math.min(Ut.string.length,ct*2);if(Vt===nt||Vt===ot){Mt+=Vt===nt?"%x":"U+";for(let Yt=0;Yt<Lt;Yt+=1){let lr;Yt>0&&(Mt+="."),lr=Ut.string[Yt].toString(16).toUpperCase(),lr.length%2!==0&&(lr=`0${lr}`),Mt+=lr}}else{Mt="%d";for(let Yt=0;Yt<Lt;Yt+=1)Yt>0&&(Mt+="."),Mt+=Ut.string[Yt].toString(10)}Lt<Ut.string.length&&(Mt+=Ot)}return Mt},vt=function(Vt,Ut){let Mt="";if(Ut.type===et.TLS){const Lt=Math.min(Ut.string.length,ct);if(Vt===nt||Vt===it){let Yt,lr,cr;Vt===nt?(Mt="%x",cr=16):(Mt="%d",cr=10);for(let ir=0;ir<Lt;ir+=1)ir>0&&(Mt+="."),lr=Ut.string[ir],lr>=97&&lr<=122?(Yt=lr-32,Mt+=`${Yt.toString(cr)}/${lr.toString(cr)}`.toUpperCase()):lr>=65&&lr<=90?(Yt=lr,lr+=32,Mt+=`${Yt.toString(cr)}/${lr.toString(cr)}`.toUpperCase()):Mt+=lr.toString(cr).toUpperCase();Lt<Ut.string.length&&(Mt+=Ot)}else{Mt='"';for(let Yt=0;Yt<Lt;Yt+=1)Mt+=o.asciiChars[Ut.string[Yt]];Lt<Ut.string.length&&(Mt+=Ot),Mt+='"'}}return Mt},dt=function(Vt,Ut,Mt,Lt,Yt){if(Lt===0)return"";let lr="";const cr=Yt?",":"";switch(Vt){case nt:lr=cr+o.charsToHex(Ut,Mt,Lt);break;case it:if(Yt)return`,${o.charsToDec(Ut,Mt,Lt)}`;lr=cr+o.charsToDec(Ut,Mt,Lt);break;case ot:lr=o.charsToUnicode(Ut,Mt,Lt);break;case st:default:lr=o.charsToAsciiHtml(Ut,Mt,Lt);break}return lr},wt=function(Vt,Ut,Mt,Lt,Yt,lr){let cr="",ir,Zt,Bt,Ft,zt=Dt;const Qt=`<span class="${$.CLASS_LOOKBEHIND}">`,nr=`<span class="${$.CLASS_REMAINDER}">`,gr="</span>";let br=!1;switch(Mt){case et.EMPTY:cr+=jt;case et.NOMATCH:case et.MATCH:case et.ACTIVE:ir=Lt-Yt,Zt=lr-ir,Bt=lr,Ft=Ut.length-Bt;break;default:throw new Error("unrecognized state")}return zt=Dt,Zt>at?(Zt=at,zt=Ot,Ft=0):Zt+Ft>at&&(zt=Ot,Ft=at-Zt),Zt>0&&(cr+=Qt,cr+=dt(Vt,Ut,ir,Zt,br),cr+=gr,br=!0),Ft>0&&(cr+=nr,cr+=dt(Vt,Ut,Bt,Ft,br),cr+=gr),cr+zt},qt=function(Vt,Ut,Mt,Lt,Yt,lr){let cr="",ir,Zt,Bt,Ft,zt=Dt;const Qt=`<span class="${$.CLASS_REMAINDER}">`,nr="</span>";let gr=!1;switch(Mt){case et.EMPTY:cr+=jt;case et.NOMATCH:case et.ACTIVE:ir=Lt,Zt=0,Bt=Lt,Ft=Ut.length-Bt;break;case et.MATCH:ir=Lt,Zt=Yt,Bt=Lt+Zt,Ft=Ut.length-Bt;break;default:throw new Error("unrecognized state")}return zt=Dt,Zt>at?(Zt=at,zt=Ot,Ft=0):Zt+Ft>at&&(zt=Ot,Ft=at-Zt),Zt>0&&(cr+=lr,cr+=dt(Vt,Ut,ir,Zt,gr),cr+=nr,gr=!0),Ft>0&&(cr+=Qt,cr+=dt(Vt,Ut,Bt,Ft,gr),cr+=nr),cr+zt},Pt=function(Vt,Ut,Mt,Lt,Yt){const lr=`<span class="${$.CLASS_LOOKAHEAD}">`;return qt(Vt,Ut,Mt,Lt,Yt,lr)},Gt=function(Vt,Ut,Mt,Lt,Yt){const lr=`<span class="${$.CLASS_MATCH}">`;return qt(Vt,Ut,Mt,Lt,Yt,lr)},Wt=function(Vt){if(At===null)return"";let Ut="",Mt,Lt,Yt,lr,cr,ir;return Ut+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",Ut+=`<th>operator</th><th>phrase</th></tr>
`,j.forEach(Zt=>{const Bt=ut[Zt];switch(Mt=Bt.thisLine,Lt=Bt.thatLine!==void 0?Bt.thatLine:"--",Yt=!1,lr=!1,cr=!1,Bt.lookAround===et.LOOKAROUND_AHEAD&&(Yt=!0,cr=!0,ir=Bt.lookAnchor),(Bt.opcode.type===et.AND||Bt.opcode.type===et.NOT)&&(Yt=!0,cr=!0,ir=Bt.phraseIndex),Bt.lookAround===et.LOOKAROUND_BEHIND&&(lr=!0,cr=!0,ir=Bt.lookAnchor),(Bt.opcode.type===et.BKA||Bt.opcode.type===et.BKN)&&(lr=!0,cr=!0,ir=Bt.phraseIndex),Ut+="<tr>",Ut+=`<td>${Mt}</td><td>${Lt}</td>`,Ut+=`<td>${Bt.phraseIndex}</td>`,Ut+=`<td>${Bt.phraseLength}</td>`,Ut+=`<td>${Bt.depth}</td>`,Ut+="<td>",Bt.state){case et.ACTIVE:Ut+=`<span class="${$.CLASS_ACTIVE}">&darr;&nbsp;</span>`;break;case et.MATCH:Ut+=`<span class="${$.CLASS_MATCH}">&uarr;M</span>`;break;case et.NOMATCH:Ut+=`<span class="${$.CLASS_NOMATCH}">&uarr;N</span>`;break;case et.EMPTY:Ut+=`<span class="${$.CLASS_EMPTY}">&uarr;E</span>`;break;default:Ut+=`<span class="${$.CLASS_ACTIVE}">--</span>`;break}if(Ut+="</td>",Ut+="<td>",Ut+=rt.indent(Bt.depth),Yt?Ut+=`<span class="${$.CLASS_LOOKAHEAD}">`:lr&&(Ut+=`<span class="${$.CLASS_LOOKBEHIND}">`),Ut+=o.opcodeToString(Bt.opcode.type),Bt.opcode.type===et.RNM&&(Ut+=`(${At[Bt.opcode.index].name}) `),Bt.opcode.type===et.BKR){const Ft=Bt.opcode.bkrCase===et.BKR_MODE_CI?"%i":"%s",zt=Bt.opcode.bkrMode===et.BKR_MODE_UM?"%u":"%p";Ut+=`(\\${Ft}${zt}${At[Bt.opcode.index].name}) `}Bt.opcode.type===et.UDT&&(Ut+=`(${kt[Bt.opcode.index].name}) `),Bt.opcode.type===et.TRG&&(Ut+=`(${$t(Vt,Bt.opcode)}) `),Bt.opcode.type===et.TBS&&(Ut+=`(${xt(Vt,Bt.opcode)}) `),Bt.opcode.type===et.TLS&&(Ut+=`(${vt(Vt,Bt.opcode)}) `),Bt.opcode.type===et.REP&&(Ut+=`(${Ct(Vt,Bt.opcode)}) `),cr&&(Ut+="</span>"),Ut+="</td>",Ut+="<td>",lr?Ut+=wt(Vt,St,Bt.state,Bt.phraseIndex,Bt.phraseLength,ir):Yt?Ut+=Pt(Vt,St,Bt.state,Bt.phraseIndex,Bt.phraseLength):Ut+=Gt(Vt,St,Bt.state,Bt.phraseIndex,Bt.phraseLength),Ut+=`</td></tr>
`}),Ut+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",Ut+=`<th>operator</th><th>phrase</th></tr>
`,Ut+=`</table>
`,Ut};this.toHtml=function(Vt,Ut){let Mt=st;if(typeof Vt=="string"&&Vt.length>=3){const Yt=Vt.toLowerCase().slice(0,3);Yt==="hex"?Mt=nt:Yt==="dec"?Mt=it:Yt==="uni"&&(Mt=ot)}let Lt="";return Lt+=bt(Mt,Ut),Lt+=Wt(Mt),Lt+=_t(),Lt}},nodeExports={ast,circular:circularBuffer,ids:identifiers,parser:parser$3,stats,trace,utils:utilities,emitcss,style:style$1},scannerGrammar,hasRequiredScannerGrammar;function requireScannerGrammar(){return hasRequiredScannerGrammar||(hasRequiredScannerGrammar=1,scannerGrammar=function(){this.grammarObject="grammarObject",this.rules=[],this.rules[0]={name:"file",lower:"file",index:0,isBkr:!1},this.rules[1]={name:"line",lower:"line",index:1,isBkr:!1},this.rules[2]={name:"line-text",lower:"line-text",index:2,isBkr:!1},this.rules[3]={name:"last-line",lower:"last-line",index:3,isBkr:!1},this.rules[4]={name:"valid",lower:"valid",index:4,isBkr:!1},this.rules[5]={name:"invalid",lower:"invalid",index:5,isBkr:!1},this.rules[6]={name:"end",lower:"end",index:6,isBkr:!1},this.rules[7]={name:"CRLF",lower:"crlf",index:7,isBkr:!1},this.rules[8]={name:"LF",lower:"lf",index:8,isBkr:!1},this.rules[9]={name:"CR",lower:"cr",index:9,isBkr:!1},this.udts=[],this.rules[0].opcodes=[],this.rules[0].opcodes[0]={type:2,children:[1,3]},this.rules[0].opcodes[1]={type:3,min:0,max:1/0},this.rules[0].opcodes[2]={type:4,index:1},this.rules[0].opcodes[3]={type:3,min:0,max:1},this.rules[0].opcodes[4]={type:4,index:3},this.rules[1].opcodes=[],this.rules[1].opcodes[0]={type:2,children:[1,2]},this.rules[1].opcodes[1]={type:4,index:2},this.rules[1].opcodes[2]={type:4,index:6},this.rules[2].opcodes=[],this.rules[2].opcodes[0]={type:3,min:0,max:1/0},this.rules[2].opcodes[1]={type:1,children:[2,3]},this.rules[2].opcodes[2]={type:4,index:4},this.rules[2].opcodes[3]={type:4,index:5},this.rules[3].opcodes=[],this.rules[3].opcodes[0]={type:3,min:1,max:1/0},this.rules[3].opcodes[1]={type:1,children:[2,3]},this.rules[3].opcodes[2]={type:4,index:4},this.rules[3].opcodes[3]={type:4,index:5},this.rules[4].opcodes=[],this.rules[4].opcodes[0]={type:1,children:[1,2]},this.rules[4].opcodes[1]={type:5,min:32,max:126},this.rules[4].opcodes[2]={type:6,string:[9]},this.rules[5].opcodes=[],this.rules[5].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[5].opcodes[1]={type:5,min:0,max:8},this.rules[5].opcodes[2]={type:5,min:11,max:12},this.rules[5].opcodes[3]={type:5,min:14,max:31},this.rules[5].opcodes[4]={type:5,min:127,max:4294967295},this.rules[6].opcodes=[],this.rules[6].opcodes[0]={type:1,children:[1,2,3]},this.rules[6].opcodes[1]={type:4,index:7},this.rules[6].opcodes[2]={type:4,index:8},this.rules[6].opcodes[3]={type:4,index:9},this.rules[7].opcodes=[],this.rules[7].opcodes[0]={type:6,string:[13,10]},this.rules[8].opcodes=[],this.rules[8].opcodes[0]={type:6,string:[10]},this.rules[9].opcodes=[],this.rules[9].opcodes[0]={type:6,string:[13]},this.toString=function(){let $="";return $+=`file = *line [last-line]
`,$+=`line = line-text end
`,$+=`line-text = *(valid/invalid)
`,$+=`last-line = 1*(valid/invalid)
`,$+=`valid = %d32-126 / %d9
`,$+=`invalid = %d0-8 / %d11-12 /%d14-31 / %x7f-ffffffff
`,$+=`end = CRLF / LF / CR
`,$+=`CRLF = %d13.10
`,$+=`LF = %d10
`,$+=`CR = %d13
`,$}}),scannerGrammar}var scannerCallbacks={},hasRequiredScannerCallbacks;function requireScannerCallbacks(){if(hasRequiredScannerCallbacks)return scannerCallbacks;hasRequiredScannerCallbacks=1;const _=identifiers,o=utilities;function $(at,ct,ut,ft,ht){return at===_.SEM_PRE?(ht.endLength=0,ht.textLength=0,ht.invalidCount=0):ht.lines.push({lineNo:ht.lines.length,beginChar:ut,length:ft,textLength:ht.textLength,endType:ht.endType,invalidChars:ht.invalidCount}),_.SEM_OK}function j(at,ct,ut,ft,ht){return at===_.SEM_PRE&&(ht.textLength=ft),_.SEM_OK}function et(at,ct,ut,ft,ht){return at===_.SEM_PRE?(ht.endLength=0,ht.textLength=0,ht.invalidCount=0):ht.strict?(ht.lines.push({lineNo:ht.lines.length,beginChar:ut,length:ft,textLength:ft,endType:"none",invalidChars:ht.invalidCount}),ht.errors.push({line:ht.lineNo,char:ut+ft,msg:"no line end on last line - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})):(ct.push(10),ht.lines.push({lineNo:ht.lines.length,beginChar:ut,length:ft+1,textLength:ft,endType:"LF",invalidChars:ht.invalidCount})),_.SEM_OK}function tt(at,ct,ut,ft,ht){return at===_.SEM_PRE&&ht.errors.push({line:ht.lineNo,char:ut,msg:`invalid character found '\\x${o.charToHex(ct[ut])}'`}),_.SEM_OK}function rt(at,ct,ut,ft,ht){return at===_.SEM_POST&&(ht.lineNo+=1),_.SEM_OK}function nt(at,ct,ut,ft,ht){return at===_.SEM_PRE&&(ht.endType="LF",ht.strict&&ht.errors.push({line:ht.lineNo,char:ut,msg:"line end character LF(\\n, \\x0A) - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})),_.SEM_OK}function it(at,ct,ut,ft,ht){return at===_.SEM_PRE&&(ht.endType="CR",ht.strict&&ht.errors.push({line:ht.lineNo,char:ut,msg:"line end character CR(\\r, \\x0D) - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})),_.SEM_OK}function st(at,ct,ut,ft,ht){return at===_.SEM_PRE&&(ht.endType="CRLF"),_.SEM_OK}const ot=[];return ot.line=$,ot["line-text"]=j,ot["last-line"]=et,ot.invalid=tt,ot.end=rt,ot.lf=nt,ot.cr=it,ot.crlf=st,scannerCallbacks.callbacks=ot,scannerCallbacks}var scanner,hasRequiredScanner;function requireScanner(){return hasRequiredScanner||(hasRequiredScanner=1,scanner=function(o,$,j,et){const tt="scanner.js: ",rt=nodeExports,nt=new(requireScannerGrammar()),{callbacks:it}=requireScannerCallbacks(),st=[],ot=new rt.parser;if(ot.ast=new rt.ast,ot.ast.callbacks=it,et){if(et.traceObject!=="traceObject")throw new TypeError(`${tt}trace argument is not a trace object`);ot.trace=et}if(ot.parse(nt,"file",o).success!==!0){$.push({line:0,char:0,msg:"syntax analysis error analyzing input SABNF grammar"});return}const ct={lines:st,lineNo:0,errors:$,strict:!!j};return ot.ast.translate(ct),st}),scanner}var syntaxCallbacks,hasRequiredSyntaxCallbacks;function requireSyntaxCallbacks(){return hasRequiredSyntaxCallbacks||(hasRequiredSyntaxCallbacks=1,syntaxCallbacks=function(){const o="syntax-callbacks.js: ",$=nodeExports,j=$.ids;let et;const tt=function(vt,dt,wt,qt){switch(vt.state){case j.ACTIVE:qt.altStack=[],qt.repCount=0;break;case j.EMPTY:qt.errors.push({line:0,char:0,msg:"grammar file is empty"});break;case j.MATCH:qt.ruleCount===0&&qt.errors.push({line:0,char:0,msg:"no rules defined"});break;case j.NOMATCH:throw new Error(`${o}synFile: grammar file NOMATCH: design error: should never happen.`);default:throw new Error(`${o}synFile: unrecognized case.`)}},rt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:wt.altStack.length=0,et={groupOpen:null,groupError:!1,optionOpen:null,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},wt.altStack.push(et);break;case j.EMPTY:throw new Error(`${o}synRule: EMPTY: rule cannot be empty`);case j.NOMATCH:break;case j.MATCH:wt.ruleCount+=1;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},nt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Unrecognized SABNF line. Invalid rule, comment or blank line."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},it=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Rule names must be alphanum and begin with alphabetic character."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},st=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Expected '=' or '=/'. Not found."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},ot=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.strict&&wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"AND operator(&) found - strict ABNF specified."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},at=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.strict&&wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"NOT operator(!) found - strict ABNF specified."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},ct=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.strict&&wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Positive look-behind operator(&&) found - strict ABNF specified."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},ut=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.strict&&wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Negative look-behind operator(!!) found - strict ABNF specified."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},ft=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.strict&&wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Beginning of string anchor(%^) found - strict ABNF specified."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},ht=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.strict&&wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"End of string anchor(%$) found - strict ABNF specified."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},mt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:if(wt.strict){const qt=$.utils.charsToString(vt,dt,xt.phraseLength);wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:`Back reference operator(${qt}) found - strict ABNF specified.`})}break;default:throw new Error(`${o}synFile: unrecognized case.`)}},gt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:if(wt.strict){const qt=$.utils.charsToString(vt,dt,xt.phraseLength);wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:`UDT operator found(${qt}) - strict ABNF specified.`})}break;default:throw new Error(`${o}synFile: unrecognized case.`)}},Et=function(xt,vt,dt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:et.tlsOpen=dt;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},St=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:wt.stringTabChar=!1;break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.stringTabChar!==!1&&wt.errors.push({line:wt.findLine(wt.lines,wt.stringTabChar),char:wt.stringTabChar,msg:"Tab character (\\t, x09) not allowed in literal string (see 'quoted-string' definition, RFC 7405.)"});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},At=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.stringTabChar=dt;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},kt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:wt.errors.push({line:wt.findLine(wt.lines,et.tlsOpen),char:et.tlsOpen,msg:'Case-insensitive literal string("...") opened but not closed.'}),et.basicError=!0,et.tlsOpen=null;break;case j.MATCH:et.tlsOpen=null;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},Rt=function(xt,vt,dt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:et.clsOpen=dt;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},Tt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:wt.stringTabChar=!1;break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.stringTabChar!==!1&&wt.errors.push({line:wt.findLine(wt.lines,wt.stringTabChar),char:wt.stringTabChar,msg:"Tab character (\\t, x09) not allowed in literal string."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},Dt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:wt.errors.push({line:wt.findLine(wt.lines,et.clsOpen),char:et.clsOpen,msg:"Case-sensitive literal string('...') opened but not closed."}),et.clsOpen=null,et.basicError=!0;break;case j.MATCH:wt.strict&&wt.errors.push({line:wt.findLine(wt.lines,et.clsOpen),char:et.clsOpen,msg:"Case-sensitive string operator('...') found - strict ABNF specified."}),et.clsOpen=null;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},Ot=function(xt,vt,dt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:et.prosValOpen=dt;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},jt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:wt.stringTabChar=!1;break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.stringTabChar!==!1&&wt.errors.push({line:wt.findLine(wt.lines,wt.stringTabChar),char:wt.stringTabChar,msg:"Tab character (\\t, x09) not allowed in prose value string."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},Nt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:wt.errors.push({line:wt.findLine(wt.lines,et.prosValOpen),char:et.prosValOpen,msg:"Prose value operator(<...>) opened but not closed."}),et.basicError=!0,et.prosValOpen=null;break;case j.MATCH:wt.errors.push({line:wt.findLine(wt.lines,et.prosValOpen),char:et.prosValOpen,msg:"Prose value operator(<...>) found. The ABNF syntax is valid, but a parser cannot be generated from this grammar."}),et.prosValOpen=null;break;default:throw new Error(`${o}synFile: unrecognized case.`)}},It=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:et={groupOpen:dt,groupError:!1,optionOpen:null,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},wt.altStack.push(et);break;default:throw new Error(`${o}synFile: unrecognized case.`)}},yt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:wt.errors.push({line:wt.findLine(wt.lines,et.groupOpen),char:et.groupOpen,msg:'Group "(...)" opened but not closed.'}),et=wt.altStack.pop(),et.groupError=!0;break;case j.MATCH:et=wt.altStack.pop();break;default:throw new Error(`${o}synFile: unrecognized case.`)}},lt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:et={groupOpen:null,groupError:!1,optionOpen:dt,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},wt.altStack.push(et);break;default:throw new Error(`${o}synFile: unrecognized case.`)}},pt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:wt.errors.push({line:wt.findLine(wt.lines,et.optionOpen),char:et.optionOpen,msg:'Option "[...]" opened but not closed.'}),et=wt.altStack.pop(),et.optionError=!0;break;case j.MATCH:et=wt.altStack.pop();break;default:throw new Error(`${o}synFile: unrecognized case.`)}},bt=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:et.basicError===!1&&wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Unrecognized SABNF element."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},_t=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:if(xt.phraseLength===1&&wt.strict){const qt=vt[dt]===13?"CR":"LF";wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:`Line end '${qt}' found - strict ABNF specified, only CRLF allowed.`})}break;default:throw new Error(`${o}synFile: unrecognized case.`)}},$t=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:break;case j.MATCH:wt.errors.push({line:wt.findLine(wt.lines,dt,wt.charsLength),char:dt,msg:"Unrecognized grammar element or characters."});break;default:throw new Error(`${o}synFile: unrecognized case.`)}},Ct=function(xt,vt,dt,wt){switch(xt.state){case j.ACTIVE:break;case j.EMPTY:break;case j.NOMATCH:wt.repCount+=1;break;case j.MATCH:wt.repCount+=1;break;default:throw new Error(`${o}synFile: unrecognized case.`)}};this.callbacks=[],this.callbacks.andop=ot,this.callbacks.basicelementerr=bt,this.callbacks.clsclose=Dt,this.callbacks.clsopen=Rt,this.callbacks.clsstring=Tt,this.callbacks.definedaserror=st,this.callbacks.file=tt,this.callbacks.groupclose=yt,this.callbacks.groupopen=It,this.callbacks.lineenderror=$t,this.callbacks.lineend=_t,this.callbacks.notop=at,this.callbacks.optionclose=pt,this.callbacks.optionopen=lt,this.callbacks.prosvalclose=Nt,this.callbacks.prosvalopen=Ot,this.callbacks.prosvalstring=jt,this.callbacks.repetition=Ct,this.callbacks.rule=rt,this.callbacks.ruleerror=nt,this.callbacks.rulenameerror=it,this.callbacks.stringtab=At,this.callbacks.tlsclose=kt,this.callbacks.tlsopen=Et,this.callbacks.tlsstring=St,this.callbacks.udtop=gt,this.callbacks.bkaop=ct,this.callbacks.bknop=ut,this.callbacks.bkrop=mt,this.callbacks.abgop=ft,this.callbacks.aenop=ht}),syntaxCallbacks}var semanticCallbacks,hasRequiredSemanticCallbacks;function requireSemanticCallbacks(){return hasRequiredSemanticCallbacks||(hasRequiredSemanticCallbacks=1,semanticCallbacks=function(){const o=nodeExports,$=o.ids,j=function(){this.names=[],this.add=function(Bt){let Ft=-1;return this.get(Bt)===-1&&(Ft={name:Bt,lower:Bt.toLowerCase(),index:this.names.length},this.names.push(Ft)),Ft},this.get=function(Bt){let Ft=-1;const zt=Bt.toLowerCase();for(let Qt=0;Qt<this.names.length;Qt+=1)if(this.names[Qt].lower===zt){Ft=this.names[Qt];break}return Ft}},et=function(Zt,Bt,Ft){let zt=0;for(let Qt=Bt;Qt<Bt+Ft;Qt+=1)zt=10*zt+Zt[Qt]-48;return zt},tt=function(Zt,Bt,Ft){let zt=0;for(let Qt=Bt;Qt<Bt+Ft;Qt+=1)zt=2*zt+Zt[Qt]-48;return zt},rt=function(Zt,Bt,Ft){let zt=0;for(let Qt=Bt;Qt<Bt+Ft;Qt+=1){let nr=Zt[Qt];if(nr>=48&&nr<=57)nr-=48;else if(nr>=65&&nr<=70)nr-=55;else if(nr>=97&&nr<=102)nr-=87;else throw new Error("hexnum out of range");zt=16*zt+nr}return zt};function nt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;if(ir===$.SEM_PRE)zt.ruleNames=new j,zt.udtNames=new j,zt.rules=[],zt.udts=[],zt.rulesLineMap=[],zt.opcodes=[],zt.altStack=[],zt.topStack=null,zt.topRule=null;else if(ir===$.SEM_POST){let nr;zt.rules.forEach(gr=>{gr.isBkr=!1,gr.opcodes.forEach(br=>{br.type===$.RNM&&(nr=zt.ruleNames.get(br.index.name),nr===-1?(zt.errors.push({line:zt.findLine(zt.lines,br.index.phraseIndex,zt.charsLength),char:br.index.phraseIndex,msg:`Rule name '${br.index.name}' used but not defined.`}),br.index=-1):br.index=nr.index)})}),zt.udts.forEach(gr=>{gr.isBkr=!1}),zt.rules.forEach(gr=>{gr.opcodes.forEach(br=>{br.type===$.BKR&&(gr.hasBkr=!0,nr=zt.ruleNames.get(br.index.name),nr!==-1?(zt.rules[nr.index].isBkr=!0,br.index=nr.index):(nr=zt.udtNames.get(br.index.name),nr!==-1?(zt.udts[nr.index].isBkr=!0,br.index=zt.rules.length+nr.index):(zt.errors.push({line:zt.findLine(zt.lines,br.index.phraseIndex,zt.charsLength),char:br.index.phraseIndex,msg:`Back reference name '${br.index.name}' refers to undefined rule or unamed UDT.`}),br.index=-1)))})})}return Qt}function it(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE&&(zt.altStack.length=0,zt.topStack=null,zt.rulesLineMap.push({line:zt.findLine(zt.lines,Bt,zt.charsLength),char:Bt})),Qt}function st(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;if(ir===$.SEM_PRE)zt.ruleName="",zt.definedas="";else if(ir===$.SEM_POST){let nr;zt.definedas==="="?(nr=zt.ruleNames.add(zt.ruleName),nr===-1?(zt.definedas=null,zt.errors.push({line:zt.findLine(zt.lines,Bt,zt.charsLength),char:Bt,msg:`Rule name '${zt.ruleName}' previously defined.`})):(zt.topRule={name:nr.name,lower:nr.lower,opcodes:[],index:nr.index},zt.rules.push(zt.topRule),zt.opcodes=zt.topRule.opcodes)):(nr=zt.ruleNames.get(zt.ruleName),nr===-1?(zt.definedas=null,zt.errors.push({line:zt.findLine(zt.lines,Bt,zt.charsLength),char:Bt,msg:`Rule name '${zt.ruleName}' for incremental alternate not previously defined.`})):(zt.topRule=zt.rules[nr.index],zt.opcodes=zt.topRule.opcodes))}return Qt}function ot(ir,Zt,Bt,Ft,zt){let Qt=$.SEM_OK;if(ir===$.SEM_PRE)for(;;){if(zt.definedas===null){Qt=$.SEM_SKIP;break}if(zt.topStack===null){if(zt.definedas==="="){zt.topStack={alt:{type:$.ALT,children:[]},cat:null},zt.altStack.push(zt.topStack),zt.opcodes.push(zt.topStack.alt);break}zt.topStack={alt:zt.opcodes[0],cat:null},zt.altStack.push(zt.topStack);break}zt.topStack={alt:{type:$.ALT,children:[]},cat:null},zt.altStack.push(zt.topStack),zt.opcodes.push(zt.topStack.alt);break}else ir===$.SEM_POST&&(zt.altStack.pop(),zt.altStack.length>0?zt.topStack=zt.altStack[zt.altStack.length-1]:zt.topStack=null);return Qt}function at(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE?(zt.topStack.alt.children.push(zt.opcodes.length),zt.topStack.cat={type:$.CAT,children:[]},zt.opcodes.push(zt.topStack.cat)):ir===$.SEM_POST&&(zt.topStack.cat=null),Qt}function ct(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE&&zt.topStack.cat.children.push(zt.opcodes.length),Qt}function ut(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.REP,min:0,max:1,char:Bt}),Qt}function ft(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE&&(zt.ruleName=o.utils.charsToString(Zt,Bt,Ft)),Qt}function ht(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.definedas="="),Qt}function mt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.definedas="=/"),Qt}function gt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE?(zt.min=0,zt.max=1/0,zt.topRep={type:$.REP,min:0,max:1/0},zt.opcodes.push(zt.topRep)):ir===$.SEM_POST&&(zt.min>zt.max&&zt.errors.push({line:zt.findLine(zt.lines,Bt,zt.charsLength),char:Bt,msg:`repetition min cannot be greater than max: min: ${zt.min}: max: ${zt.max}`}),zt.topRep.min=zt.min,zt.topRep.max=zt.max),Qt}function Et(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.min=et(Zt,Bt,Ft)),Qt}function St(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.max=et(Zt,Bt,Ft)),Qt}function At(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.max=et(Zt,Bt,Ft),zt.min=zt.max),Qt}function kt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.AND}),Qt}function Rt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.NOT}),Qt}function Tt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.RNM,index:{phraseIndex:Bt,name:o.utils.charsToString(Zt,Bt,Ft)}}),Qt}function Dt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.ABG}),Qt}function Ot(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.AEN}),Qt}function jt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.BKA}),Qt}function Nt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.opcodes.push({type:$.BKN}),Qt}function It(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE?(zt.ci=!0,zt.cs=!1,zt.um=!0,zt.pm=!1):ir===$.SEM_POST&&zt.opcodes.push({type:$.BKR,bkrCase:zt.cs===!0?$.BKR_MODE_CS:$.BKR_MODE_CI,bkrMode:zt.pm===!0?$.BKR_MODE_PM:$.BKR_MODE_UM,index:{phraseIndex:zt.bkrname.phraseIndex,name:o.utils.charsToString(Zt,zt.bkrname.phraseIndex,zt.bkrname.phraseLength)}}),Qt}function yt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.ci=!0),Qt}function lt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.cs=!0),Qt}function pt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.um=!0),Qt}function bt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.pm=!0),Qt}function _t(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.bkrname={phraseIndex:Bt,phraseLength:Ft}),Qt}function $t(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;if(ir===$.SEM_POST){const nr=o.utils.charsToString(Zt,Bt,Ft);let gr=zt.udtNames.add(nr);if(gr===-1){if(gr=zt.udtNames.get(nr),gr===-1)throw new Error("semUdtEmpty: name look up error")}else zt.udts.push({name:gr.name,lower:gr.lower,index:gr.index,empty:!0});zt.opcodes.push({type:$.UDT,empty:!0,index:gr.index})}return Qt}function Ct(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;if(ir===$.SEM_POST){const nr=o.utils.charsToString(Zt,Bt,Ft);let gr=zt.udtNames.add(nr);if(gr===-1){if(gr=zt.udtNames.get(nr),gr===-1)throw new Error("semUdtNonEmpty: name look up error")}else zt.udts.push({name:gr.name,lower:gr.lower,index:gr.index,empty:!1});zt.opcodes.push({type:$.UDT,empty:!1,index:gr.index,syntax:null,semantic:null})}return Qt}function xt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE&&(zt.tlscase=!0),Qt}function vt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&Ft>0&&(Zt[Bt+1]===83||Zt[Bt+1]===115)&&(zt.tlscase=!1),Qt}function dt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;if(ir===$.SEM_POST)if(zt.tlscase){const nr=Zt.slice(Bt,Bt+Ft);for(let gr=0;gr<nr.length;gr+=1)nr[gr]>=65&&nr[gr]<=90&&(nr[gr]+=32);zt.opcodes.push({type:$.TLS,string:nr})}else zt.opcodes.push({type:$.TBS,string:Zt.slice(Bt,Bt+Ft)});return Qt}function wt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(Ft<=2?zt.opcodes.push({type:$.TLS,string:[]}):zt.opcodes.push({type:$.TBS,string:Zt.slice(Bt+1,Bt+Ft-1)})),Qt}function qt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE?zt.tbsstr=[]:ir===$.SEM_POST&&zt.opcodes.push({type:$.TBS,string:zt.tbsstr}),Qt}function Pt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_PRE?(zt.min=0,zt.max=0):ir===$.SEM_POST&&(zt.min>zt.max&&zt.errors.push({line:zt.findLine(zt.lines,Bt,zt.charsLength),char:Bt,msg:`TRG, (%dmin-max), min cannot be greater than max: min: ${zt.min}: max: ${zt.max}`}),zt.opcodes.push({type:$.TRG,min:zt.min,max:zt.max})),Qt}function Gt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.min=et(Zt,Bt,Ft)),Qt}function Wt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.max=et(Zt,Bt,Ft)),Qt}function Vt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.min=tt(Zt,Bt,Ft)),Qt}function Ut(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.max=tt(Zt,Bt,Ft)),Qt}function Mt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.min=rt(Zt,Bt,Ft)),Qt}function Lt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&(zt.max=rt(Zt,Bt,Ft)),Qt}function Yt(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.tbsstr.push(et(Zt,Bt,Ft)),Qt}function lr(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.tbsstr.push(tt(Zt,Bt,Ft)),Qt}function cr(ir,Zt,Bt,Ft,zt){const Qt=$.SEM_OK;return ir===$.SEM_POST&&zt.tbsstr.push(rt(Zt,Bt,Ft)),Qt}this.callbacks=[],this.callbacks.abgop=Dt,this.callbacks.aenop=Ot,this.callbacks.alternation=ot,this.callbacks.andop=kt,this.callbacks.bmax=Ut,this.callbacks.bmin=Vt,this.callbacks.bkaop=jt,this.callbacks.bknop=Nt,this.callbacks.bkrop=It,this.callbacks["bkr-name"]=_t,this.callbacks.bstring=lr,this.callbacks.clsop=wt,this.callbacks.ci=yt,this.callbacks.cs=lt,this.callbacks.um=pt,this.callbacks.pm=bt,this.callbacks.concatenation=at,this.callbacks.defined=ht,this.callbacks.dmax=Wt,this.callbacks.dmin=Gt,this.callbacks.dstring=Yt,this.callbacks.file=nt,this.callbacks.incalt=mt,this.callbacks.notop=Rt,this.callbacks.optionopen=ut,this.callbacks["rep-max"]=St,this.callbacks["rep-min"]=Et,this.callbacks["rep-min-max"]=At,this.callbacks.repetition=ct,this.callbacks.repop=gt,this.callbacks.rnmop=Tt,this.callbacks.rule=it,this.callbacks.rulelookup=st,this.callbacks.rulename=ft,this.callbacks.tbsop=qt,this.callbacks.tlscase=vt,this.callbacks.tlsstring=dt,this.callbacks.tlsop=xt,this.callbacks.trgop=Pt,this.callbacks["udt-empty"]=$t,this.callbacks["udt-non-empty"]=Ct,this.callbacks.xmax=Lt,this.callbacks.xmin=Mt,this.callbacks.xstring=cr}),semanticCallbacks}var sabnfGrammar,hasRequiredSabnfGrammar;function requireSabnfGrammar(){return hasRequiredSabnfGrammar||(hasRequiredSabnfGrammar=1,sabnfGrammar=function(){this.grammarObject="grammarObject",this.rules=[],this.rules[0]={name:"File",lower:"file",index:0,isBkr:!1},this.rules[1]={name:"BlankLine",lower:"blankline",index:1,isBkr:!1},this.rules[2]={name:"Rule",lower:"rule",index:2,isBkr:!1},this.rules[3]={name:"RuleLookup",lower:"rulelookup",index:3,isBkr:!1},this.rules[4]={name:"RuleNameTest",lower:"rulenametest",index:4,isBkr:!1},this.rules[5]={name:"RuleName",lower:"rulename",index:5,isBkr:!1},this.rules[6]={name:"RuleNameError",lower:"rulenameerror",index:6,isBkr:!1},this.rules[7]={name:"DefinedAsTest",lower:"definedastest",index:7,isBkr:!1},this.rules[8]={name:"DefinedAsError",lower:"definedaserror",index:8,isBkr:!1},this.rules[9]={name:"DefinedAs",lower:"definedas",index:9,isBkr:!1},this.rules[10]={name:"Defined",lower:"defined",index:10,isBkr:!1},this.rules[11]={name:"IncAlt",lower:"incalt",index:11,isBkr:!1},this.rules[12]={name:"RuleError",lower:"ruleerror",index:12,isBkr:!1},this.rules[13]={name:"LineEndError",lower:"lineenderror",index:13,isBkr:!1},this.rules[14]={name:"Alternation",lower:"alternation",index:14,isBkr:!1},this.rules[15]={name:"Concatenation",lower:"concatenation",index:15,isBkr:!1},this.rules[16]={name:"Repetition",lower:"repetition",index:16,isBkr:!1},this.rules[17]={name:"Modifier",lower:"modifier",index:17,isBkr:!1},this.rules[18]={name:"Predicate",lower:"predicate",index:18,isBkr:!1},this.rules[19]={name:"BasicElement",lower:"basicelement",index:19,isBkr:!1},this.rules[20]={name:"BasicElementErr",lower:"basicelementerr",index:20,isBkr:!1},this.rules[21]={name:"Group",lower:"group",index:21,isBkr:!1},this.rules[22]={name:"GroupError",lower:"grouperror",index:22,isBkr:!1},this.rules[23]={name:"GroupOpen",lower:"groupopen",index:23,isBkr:!1},this.rules[24]={name:"GroupClose",lower:"groupclose",index:24,isBkr:!1},this.rules[25]={name:"Option",lower:"option",index:25,isBkr:!1},this.rules[26]={name:"OptionError",lower:"optionerror",index:26,isBkr:!1},this.rules[27]={name:"OptionOpen",lower:"optionopen",index:27,isBkr:!1},this.rules[28]={name:"OptionClose",lower:"optionclose",index:28,isBkr:!1},this.rules[29]={name:"RnmOp",lower:"rnmop",index:29,isBkr:!1},this.rules[30]={name:"BkrOp",lower:"bkrop",index:30,isBkr:!1},this.rules[31]={name:"bkrModifier",lower:"bkrmodifier",index:31,isBkr:!1},this.rules[32]={name:"cs",lower:"cs",index:32,isBkr:!1},this.rules[33]={name:"ci",lower:"ci",index:33,isBkr:!1},this.rules[34]={name:"um",lower:"um",index:34,isBkr:!1},this.rules[35]={name:"pm",lower:"pm",index:35,isBkr:!1},this.rules[36]={name:"bkr-name",lower:"bkr-name",index:36,isBkr:!1},this.rules[37]={name:"rname",lower:"rname",index:37,isBkr:!1},this.rules[38]={name:"uname",lower:"uname",index:38,isBkr:!1},this.rules[39]={name:"ename",lower:"ename",index:39,isBkr:!1},this.rules[40]={name:"UdtOp",lower:"udtop",index:40,isBkr:!1},this.rules[41]={name:"udt-non-empty",lower:"udt-non-empty",index:41,isBkr:!1},this.rules[42]={name:"udt-empty",lower:"udt-empty",index:42,isBkr:!1},this.rules[43]={name:"RepOp",lower:"repop",index:43,isBkr:!1},this.rules[44]={name:"AltOp",lower:"altop",index:44,isBkr:!1},this.rules[45]={name:"CatOp",lower:"catop",index:45,isBkr:!1},this.rules[46]={name:"StarOp",lower:"starop",index:46,isBkr:!1},this.rules[47]={name:"AndOp",lower:"andop",index:47,isBkr:!1},this.rules[48]={name:"NotOp",lower:"notop",index:48,isBkr:!1},this.rules[49]={name:"BkaOp",lower:"bkaop",index:49,isBkr:!1},this.rules[50]={name:"BknOp",lower:"bknop",index:50,isBkr:!1},this.rules[51]={name:"AbgOp",lower:"abgop",index:51,isBkr:!1},this.rules[52]={name:"AenOp",lower:"aenop",index:52,isBkr:!1},this.rules[53]={name:"TrgOp",lower:"trgop",index:53,isBkr:!1},this.rules[54]={name:"TbsOp",lower:"tbsop",index:54,isBkr:!1},this.rules[55]={name:"TlsOp",lower:"tlsop",index:55,isBkr:!1},this.rules[56]={name:"TlsCase",lower:"tlscase",index:56,isBkr:!1},this.rules[57]={name:"TlsOpen",lower:"tlsopen",index:57,isBkr:!1},this.rules[58]={name:"TlsClose",lower:"tlsclose",index:58,isBkr:!1},this.rules[59]={name:"TlsString",lower:"tlsstring",index:59,isBkr:!1},this.rules[60]={name:"StringTab",lower:"stringtab",index:60,isBkr:!1},this.rules[61]={name:"ClsOp",lower:"clsop",index:61,isBkr:!1},this.rules[62]={name:"ClsOpen",lower:"clsopen",index:62,isBkr:!1},this.rules[63]={name:"ClsClose",lower:"clsclose",index:63,isBkr:!1},this.rules[64]={name:"ClsString",lower:"clsstring",index:64,isBkr:!1},this.rules[65]={name:"ProsVal",lower:"prosval",index:65,isBkr:!1},this.rules[66]={name:"ProsValOpen",lower:"prosvalopen",index:66,isBkr:!1},this.rules[67]={name:"ProsValString",lower:"prosvalstring",index:67,isBkr:!1},this.rules[68]={name:"ProsValClose",lower:"prosvalclose",index:68,isBkr:!1},this.rules[69]={name:"rep-min",lower:"rep-min",index:69,isBkr:!1},this.rules[70]={name:"rep-min-max",lower:"rep-min-max",index:70,isBkr:!1},this.rules[71]={name:"rep-max",lower:"rep-max",index:71,isBkr:!1},this.rules[72]={name:"rep-num",lower:"rep-num",index:72,isBkr:!1},this.rules[73]={name:"dString",lower:"dstring",index:73,isBkr:!1},this.rules[74]={name:"xString",lower:"xstring",index:74,isBkr:!1},this.rules[75]={name:"bString",lower:"bstring",index:75,isBkr:!1},this.rules[76]={name:"Dec",lower:"dec",index:76,isBkr:!1},this.rules[77]={name:"Hex",lower:"hex",index:77,isBkr:!1},this.rules[78]={name:"Bin",lower:"bin",index:78,isBkr:!1},this.rules[79]={name:"dmin",lower:"dmin",index:79,isBkr:!1},this.rules[80]={name:"dmax",lower:"dmax",index:80,isBkr:!1},this.rules[81]={name:"bmin",lower:"bmin",index:81,isBkr:!1},this.rules[82]={name:"bmax",lower:"bmax",index:82,isBkr:!1},this.rules[83]={name:"xmin",lower:"xmin",index:83,isBkr:!1},this.rules[84]={name:"xmax",lower:"xmax",index:84,isBkr:!1},this.rules[85]={name:"dnum",lower:"dnum",index:85,isBkr:!1},this.rules[86]={name:"bnum",lower:"bnum",index:86,isBkr:!1},this.rules[87]={name:"xnum",lower:"xnum",index:87,isBkr:!1},this.rules[88]={name:"alphanum",lower:"alphanum",index:88,isBkr:!1},this.rules[89]={name:"owsp",lower:"owsp",index:89,isBkr:!1},this.rules[90]={name:"wsp",lower:"wsp",index:90,isBkr:!1},this.rules[91]={name:"space",lower:"space",index:91,isBkr:!1},this.rules[92]={name:"comment",lower:"comment",index:92,isBkr:!1},this.rules[93]={name:"LineEnd",lower:"lineend",index:93,isBkr:!1},this.rules[94]={name:"LineContinue",lower:"linecontinue",index:94,isBkr:!1},this.udts=[],this.rules[0].opcodes=[],this.rules[0].opcodes[0]={type:3,min:0,max:1/0},this.rules[0].opcodes[1]={type:1,children:[2,3,4]},this.rules[0].opcodes[2]={type:4,index:1},this.rules[0].opcodes[3]={type:4,index:2},this.rules[0].opcodes[4]={type:4,index:12},this.rules[1].opcodes=[],this.rules[1].opcodes[0]={type:2,children:[1,5,7]},this.rules[1].opcodes[1]={type:3,min:0,max:1/0},this.rules[1].opcodes[2]={type:1,children:[3,4]},this.rules[1].opcodes[3]={type:6,string:[32]},this.rules[1].opcodes[4]={type:6,string:[9]},this.rules[1].opcodes[5]={type:3,min:0,max:1},this.rules[1].opcodes[6]={type:4,index:92},this.rules[1].opcodes[7]={type:4,index:93},this.rules[2].opcodes=[],this.rules[2].opcodes[0]={type:2,children:[1,2,3,4]},this.rules[2].opcodes[1]={type:4,index:3},this.rules[2].opcodes[2]={type:4,index:89},this.rules[2].opcodes[3]={type:4,index:14},this.rules[2].opcodes[4]={type:1,children:[5,8]},this.rules[2].opcodes[5]={type:2,children:[6,7]},this.rules[2].opcodes[6]={type:4,index:89},this.rules[2].opcodes[7]={type:4,index:93},this.rules[2].opcodes[8]={type:2,children:[9,10]},this.rules[2].opcodes[9]={type:4,index:13},this.rules[2].opcodes[10]={type:4,index:93},this.rules[3].opcodes=[],this.rules[3].opcodes[0]={type:2,children:[1,2,3]},this.rules[3].opcodes[1]={type:4,index:4},this.rules[3].opcodes[2]={type:4,index:89},this.rules[3].opcodes[3]={type:4,index:7},this.rules[4].opcodes=[],this.rules[4].opcodes[0]={type:1,children:[1,2]},this.rules[4].opcodes[1]={type:4,index:5},this.rules[4].opcodes[2]={type:4,index:6},this.rules[5].opcodes=[],this.rules[5].opcodes[0]={type:4,index:88},this.rules[6].opcodes=[],this.rules[6].opcodes[0]={type:3,min:1,max:1/0},this.rules[6].opcodes[1]={type:1,children:[2,3]},this.rules[6].opcodes[2]={type:5,min:33,max:60},this.rules[6].opcodes[3]={type:5,min:62,max:126},this.rules[7].opcodes=[],this.rules[7].opcodes[0]={type:1,children:[1,2]},this.rules[7].opcodes[1]={type:4,index:9},this.rules[7].opcodes[2]={type:4,index:8},this.rules[8].opcodes=[],this.rules[8].opcodes[0]={type:3,min:1,max:2},this.rules[8].opcodes[1]={type:5,min:33,max:126},this.rules[9].opcodes=[],this.rules[9].opcodes[0]={type:1,children:[1,2]},this.rules[9].opcodes[1]={type:4,index:11},this.rules[9].opcodes[2]={type:4,index:10},this.rules[10].opcodes=[],this.rules[10].opcodes[0]={type:6,string:[61]},this.rules[11].opcodes=[],this.rules[11].opcodes[0]={type:6,string:[61,47]},this.rules[12].opcodes=[],this.rules[12].opcodes[0]={type:2,children:[1,6]},this.rules[12].opcodes[1]={type:3,min:1,max:1/0},this.rules[12].opcodes[2]={type:1,children:[3,4,5]},this.rules[12].opcodes[3]={type:5,min:32,max:126},this.rules[12].opcodes[4]={type:6,string:[9]},this.rules[12].opcodes[5]={type:4,index:94},this.rules[12].opcodes[6]={type:4,index:93},this.rules[13].opcodes=[],this.rules[13].opcodes[0]={type:3,min:1,max:1/0},this.rules[13].opcodes[1]={type:1,children:[2,3,4]},this.rules[13].opcodes[2]={type:5,min:32,max:126},this.rules[13].opcodes[3]={type:6,string:[9]},this.rules[13].opcodes[4]={type:4,index:94},this.rules[14].opcodes=[],this.rules[14].opcodes[0]={type:2,children:[1,2]},this.rules[14].opcodes[1]={type:4,index:15},this.rules[14].opcodes[2]={type:3,min:0,max:1/0},this.rules[14].opcodes[3]={type:2,children:[4,5,6]},this.rules[14].opcodes[4]={type:4,index:89},this.rules[14].opcodes[5]={type:4,index:44},this.rules[14].opcodes[6]={type:4,index:15},this.rules[15].opcodes=[],this.rules[15].opcodes[0]={type:2,children:[1,2]},this.rules[15].opcodes[1]={type:4,index:16},this.rules[15].opcodes[2]={type:3,min:0,max:1/0},this.rules[15].opcodes[3]={type:2,children:[4,5]},this.rules[15].opcodes[4]={type:4,index:45},this.rules[15].opcodes[5]={type:4,index:16},this.rules[16].opcodes=[],this.rules[16].opcodes[0]={type:2,children:[1,3]},this.rules[16].opcodes[1]={type:3,min:0,max:1},this.rules[16].opcodes[2]={type:4,index:17},this.rules[16].opcodes[3]={type:1,children:[4,5,6,7]},this.rules[16].opcodes[4]={type:4,index:21},this.rules[16].opcodes[5]={type:4,index:25},this.rules[16].opcodes[6]={type:4,index:19},this.rules[16].opcodes[7]={type:4,index:20},this.rules[17].opcodes=[],this.rules[17].opcodes[0]={type:1,children:[1,5]},this.rules[17].opcodes[1]={type:2,children:[2,3]},this.rules[17].opcodes[2]={type:4,index:18},this.rules[17].opcodes[3]={type:3,min:0,max:1},this.rules[17].opcodes[4]={type:4,index:43},this.rules[17].opcodes[5]={type:4,index:43},this.rules[18].opcodes=[],this.rules[18].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[18].opcodes[1]={type:4,index:49},this.rules[18].opcodes[2]={type:4,index:50},this.rules[18].opcodes[3]={type:4,index:47},this.rules[18].opcodes[4]={type:4,index:48},this.rules[19].opcodes=[],this.rules[19].opcodes[0]={type:1,children:[1,2,3,4,5,6,7,8,9,10]},this.rules[19].opcodes[1]={type:4,index:40},this.rules[19].opcodes[2]={type:4,index:29},this.rules[19].opcodes[3]={type:4,index:53},this.rules[19].opcodes[4]={type:4,index:54},this.rules[19].opcodes[5]={type:4,index:55},this.rules[19].opcodes[6]={type:4,index:61},this.rules[19].opcodes[7]={type:4,index:30},this.rules[19].opcodes[8]={type:4,index:51},this.rules[19].opcodes[9]={type:4,index:52},this.rules[19].opcodes[10]={type:4,index:65},this.rules[20].opcodes=[],this.rules[20].opcodes[0]={type:3,min:1,max:1/0},this.rules[20].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[20].opcodes[2]={type:5,min:33,max:40},this.rules[20].opcodes[3]={type:5,min:42,max:46},this.rules[20].opcodes[4]={type:5,min:48,max:92},this.rules[20].opcodes[5]={type:5,min:94,max:126},this.rules[21].opcodes=[],this.rules[21].opcodes[0]={type:2,children:[1,2,3]},this.rules[21].opcodes[1]={type:4,index:23},this.rules[21].opcodes[2]={type:4,index:14},this.rules[21].opcodes[3]={type:1,children:[4,5]},this.rules[21].opcodes[4]={type:4,index:24},this.rules[21].opcodes[5]={type:4,index:22},this.rules[22].opcodes=[],this.rules[22].opcodes[0]={type:3,min:1,max:1/0},this.rules[22].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[22].opcodes[2]={type:5,min:33,max:40},this.rules[22].opcodes[3]={type:5,min:42,max:46},this.rules[22].opcodes[4]={type:5,min:48,max:92},this.rules[22].opcodes[5]={type:5,min:94,max:126},this.rules[23].opcodes=[],this.rules[23].opcodes[0]={type:2,children:[1,2]},this.rules[23].opcodes[1]={type:6,string:[40]},this.rules[23].opcodes[2]={type:4,index:89},this.rules[24].opcodes=[],this.rules[24].opcodes[0]={type:2,children:[1,2]},this.rules[24].opcodes[1]={type:4,index:89},this.rules[24].opcodes[2]={type:6,string:[41]},this.rules[25].opcodes=[],this.rules[25].opcodes[0]={type:2,children:[1,2,3]},this.rules[25].opcodes[1]={type:4,index:27},this.rules[25].opcodes[2]={type:4,index:14},this.rules[25].opcodes[3]={type:1,children:[4,5]},this.rules[25].opcodes[4]={type:4,index:28},this.rules[25].opcodes[5]={type:4,index:26},this.rules[26].opcodes=[],this.rules[26].opcodes[0]={type:3,min:1,max:1/0},this.rules[26].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[26].opcodes[2]={type:5,min:33,max:40},this.rules[26].opcodes[3]={type:5,min:42,max:46},this.rules[26].opcodes[4]={type:5,min:48,max:92},this.rules[26].opcodes[5]={type:5,min:94,max:126},this.rules[27].opcodes=[],this.rules[27].opcodes[0]={type:2,children:[1,2]},this.rules[27].opcodes[1]={type:6,string:[91]},this.rules[27].opcodes[2]={type:4,index:89},this.rules[28].opcodes=[],this.rules[28].opcodes[0]={type:2,children:[1,2]},this.rules[28].opcodes[1]={type:4,index:89},this.rules[28].opcodes[2]={type:6,string:[93]},this.rules[29].opcodes=[],this.rules[29].opcodes[0]={type:4,index:88},this.rules[30].opcodes=[],this.rules[30].opcodes[0]={type:2,children:[1,2,4]},this.rules[30].opcodes[1]={type:6,string:[92]},this.rules[30].opcodes[2]={type:3,min:0,max:1},this.rules[30].opcodes[3]={type:4,index:31},this.rules[30].opcodes[4]={type:4,index:36},this.rules[31].opcodes=[],this.rules[31].opcodes[0]={type:1,children:[1,7,13,19]},this.rules[31].opcodes[1]={type:2,children:[2,3]},this.rules[31].opcodes[2]={type:4,index:32},this.rules[31].opcodes[3]={type:3,min:0,max:1},this.rules[31].opcodes[4]={type:1,children:[5,6]},this.rules[31].opcodes[5]={type:4,index:34},this.rules[31].opcodes[6]={type:4,index:35},this.rules[31].opcodes[7]={type:2,children:[8,9]},this.rules[31].opcodes[8]={type:4,index:33},this.rules[31].opcodes[9]={type:3,min:0,max:1},this.rules[31].opcodes[10]={type:1,children:[11,12]},this.rules[31].opcodes[11]={type:4,index:34},this.rules[31].opcodes[12]={type:4,index:35},this.rules[31].opcodes[13]={type:2,children:[14,15]},this.rules[31].opcodes[14]={type:4,index:34},this.rules[31].opcodes[15]={type:3,min:0,max:1},this.rules[31].opcodes[16]={type:1,children:[17,18]},this.rules[31].opcodes[17]={type:4,index:32},this.rules[31].opcodes[18]={type:4,index:33},this.rules[31].opcodes[19]={type:2,children:[20,21]},this.rules[31].opcodes[20]={type:4,index:35},this.rules[31].opcodes[21]={type:3,min:0,max:1},this.rules[31].opcodes[22]={type:1,children:[23,24]},this.rules[31].opcodes[23]={type:4,index:32},this.rules[31].opcodes[24]={type:4,index:33},this.rules[32].opcodes=[],this.rules[32].opcodes[0]={type:6,string:[37,115]},this.rules[33].opcodes=[],this.rules[33].opcodes[0]={type:6,string:[37,105]},this.rules[34].opcodes=[],this.rules[34].opcodes[0]={type:6,string:[37,117]},this.rules[35].opcodes=[],this.rules[35].opcodes[0]={type:6,string:[37,112]},this.rules[36].opcodes=[],this.rules[36].opcodes[0]={type:1,children:[1,2,3]},this.rules[36].opcodes[1]={type:4,index:38},this.rules[36].opcodes[2]={type:4,index:39},this.rules[36].opcodes[3]={type:4,index:37},this.rules[37].opcodes=[],this.rules[37].opcodes[0]={type:4,index:88},this.rules[38].opcodes=[],this.rules[38].opcodes[0]={type:2,children:[1,2]},this.rules[38].opcodes[1]={type:6,string:[117,95]},this.rules[38].opcodes[2]={type:4,index:88},this.rules[39].opcodes=[],this.rules[39].opcodes[0]={type:2,children:[1,2]},this.rules[39].opcodes[1]={type:6,string:[101,95]},this.rules[39].opcodes[2]={type:4,index:88},this.rules[40].opcodes=[],this.rules[40].opcodes[0]={type:1,children:[1,2]},this.rules[40].opcodes[1]={type:4,index:42},this.rules[40].opcodes[2]={type:4,index:41},this.rules[41].opcodes=[],this.rules[41].opcodes[0]={type:2,children:[1,2]},this.rules[41].opcodes[1]={type:6,string:[117,95]},this.rules[41].opcodes[2]={type:4,index:88},this.rules[42].opcodes=[],this.rules[42].opcodes[0]={type:2,children:[1,2]},this.rules[42].opcodes[1]={type:6,string:[101,95]},this.rules[42].opcodes[2]={type:4,index:88},this.rules[43].opcodes=[],this.rules[43].opcodes[0]={type:1,children:[1,5,8,11,12]},this.rules[43].opcodes[1]={type:2,children:[2,3,4]},this.rules[43].opcodes[2]={type:4,index:69},this.rules[43].opcodes[3]={type:4,index:46},this.rules[43].opcodes[4]={type:4,index:71},this.rules[43].opcodes[5]={type:2,children:[6,7]},this.rules[43].opcodes[6]={type:4,index:69},this.rules[43].opcodes[7]={type:4,index:46},this.rules[43].opcodes[8]={type:2,children:[9,10]},this.rules[43].opcodes[9]={type:4,index:46},this.rules[43].opcodes[10]={type:4,index:71},this.rules[43].opcodes[11]={type:4,index:46},this.rules[43].opcodes[12]={type:4,index:70},this.rules[44].opcodes=[],this.rules[44].opcodes[0]={type:2,children:[1,2]},this.rules[44].opcodes[1]={type:6,string:[47]},this.rules[44].opcodes[2]={type:4,index:89},this.rules[45].opcodes=[],this.rules[45].opcodes[0]={type:4,index:90},this.rules[46].opcodes=[],this.rules[46].opcodes[0]={type:6,string:[42]},this.rules[47].opcodes=[],this.rules[47].opcodes[0]={type:6,string:[38]},this.rules[48].opcodes=[],this.rules[48].opcodes[0]={type:6,string:[33]},this.rules[49].opcodes=[],this.rules[49].opcodes[0]={type:6,string:[38,38]},this.rules[50].opcodes=[],this.rules[50].opcodes[0]={type:6,string:[33,33]},this.rules[51].opcodes=[],this.rules[51].opcodes[0]={type:6,string:[37,94]},this.rules[52].opcodes=[],this.rules[52].opcodes[0]={type:6,string:[37,36]},this.rules[53].opcodes=[],this.rules[53].opcodes[0]={type:2,children:[1,2]},this.rules[53].opcodes[1]={type:6,string:[37]},this.rules[53].opcodes[2]={type:1,children:[3,8,13]},this.rules[53].opcodes[3]={type:2,children:[4,5,6,7]},this.rules[53].opcodes[4]={type:4,index:76},this.rules[53].opcodes[5]={type:4,index:79},this.rules[53].opcodes[6]={type:6,string:[45]},this.rules[53].opcodes[7]={type:4,index:80},this.rules[53].opcodes[8]={type:2,children:[9,10,11,12]},this.rules[53].opcodes[9]={type:4,index:77},this.rules[53].opcodes[10]={type:4,index:83},this.rules[53].opcodes[11]={type:6,string:[45]},this.rules[53].opcodes[12]={type:4,index:84},this.rules[53].opcodes[13]={type:2,children:[14,15,16,17]},this.rules[53].opcodes[14]={type:4,index:78},this.rules[53].opcodes[15]={type:4,index:81},this.rules[53].opcodes[16]={type:6,string:[45]},this.rules[53].opcodes[17]={type:4,index:82},this.rules[54].opcodes=[],this.rules[54].opcodes[0]={type:2,children:[1,2]},this.rules[54].opcodes[1]={type:6,string:[37]},this.rules[54].opcodes[2]={type:1,children:[3,10,17]},this.rules[54].opcodes[3]={type:2,children:[4,5,6]},this.rules[54].opcodes[4]={type:4,index:76},this.rules[54].opcodes[5]={type:4,index:73},this.rules[54].opcodes[6]={type:3,min:0,max:1/0},this.rules[54].opcodes[7]={type:2,children:[8,9]},this.rules[54].opcodes[8]={type:6,string:[46]},this.rules[54].opcodes[9]={type:4,index:73},this.rules[54].opcodes[10]={type:2,children:[11,12,13]},this.rules[54].opcodes[11]={type:4,index:77},this.rules[54].opcodes[12]={type:4,index:74},this.rules[54].opcodes[13]={type:3,min:0,max:1/0},this.rules[54].opcodes[14]={type:2,children:[15,16]},this.rules[54].opcodes[15]={type:6,string:[46]},this.rules[54].opcodes[16]={type:4,index:74},this.rules[54].opcodes[17]={type:2,children:[18,19,20]},this.rules[54].opcodes[18]={type:4,index:78},this.rules[54].opcodes[19]={type:4,index:75},this.rules[54].opcodes[20]={type:3,min:0,max:1/0},this.rules[54].opcodes[21]={type:2,children:[22,23]},this.rules[54].opcodes[22]={type:6,string:[46]},this.rules[54].opcodes[23]={type:4,index:75},this.rules[55].opcodes=[],this.rules[55].opcodes[0]={type:2,children:[1,2,3,4]},this.rules[55].opcodes[1]={type:4,index:56},this.rules[55].opcodes[2]={type:4,index:57},this.rules[55].opcodes[3]={type:4,index:59},this.rules[55].opcodes[4]={type:4,index:58},this.rules[56].opcodes=[],this.rules[56].opcodes[0]={type:3,min:0,max:1},this.rules[56].opcodes[1]={type:1,children:[2,3]},this.rules[56].opcodes[2]={type:7,string:[37,105]},this.rules[56].opcodes[3]={type:7,string:[37,115]},this.rules[57].opcodes=[],this.rules[57].opcodes[0]={type:6,string:[34]},this.rules[58].opcodes=[],this.rules[58].opcodes[0]={type:6,string:[34]},this.rules[59].opcodes=[],this.rules[59].opcodes[0]={type:3,min:0,max:1/0},this.rules[59].opcodes[1]={type:1,children:[2,3,4]},this.rules[59].opcodes[2]={type:5,min:32,max:33},this.rules[59].opcodes[3]={type:5,min:35,max:126},this.rules[59].opcodes[4]={type:4,index:60},this.rules[60].opcodes=[],this.rules[60].opcodes[0]={type:6,string:[9]},this.rules[61].opcodes=[],this.rules[61].opcodes[0]={type:2,children:[1,2,3]},this.rules[61].opcodes[1]={type:4,index:62},this.rules[61].opcodes[2]={type:4,index:64},this.rules[61].opcodes[3]={type:4,index:63},this.rules[62].opcodes=[],this.rules[62].opcodes[0]={type:6,string:[39]},this.rules[63].opcodes=[],this.rules[63].opcodes[0]={type:6,string:[39]},this.rules[64].opcodes=[],this.rules[64].opcodes[0]={type:3,min:0,max:1/0},this.rules[64].opcodes[1]={type:1,children:[2,3,4]},this.rules[64].opcodes[2]={type:5,min:32,max:38},this.rules[64].opcodes[3]={type:5,min:40,max:126},this.rules[64].opcodes[4]={type:4,index:60},this.rules[65].opcodes=[],this.rules[65].opcodes[0]={type:2,children:[1,2,3]},this.rules[65].opcodes[1]={type:4,index:66},this.rules[65].opcodes[2]={type:4,index:67},this.rules[65].opcodes[3]={type:4,index:68},this.rules[66].opcodes=[],this.rules[66].opcodes[0]={type:6,string:[60]},this.rules[67].opcodes=[],this.rules[67].opcodes[0]={type:3,min:0,max:1/0},this.rules[67].opcodes[1]={type:1,children:[2,3,4]},this.rules[67].opcodes[2]={type:5,min:32,max:61},this.rules[67].opcodes[3]={type:5,min:63,max:126},this.rules[67].opcodes[4]={type:4,index:60},this.rules[68].opcodes=[],this.rules[68].opcodes[0]={type:6,string:[62]},this.rules[69].opcodes=[],this.rules[69].opcodes[0]={type:4,index:72},this.rules[70].opcodes=[],this.rules[70].opcodes[0]={type:4,index:72},this.rules[71].opcodes=[],this.rules[71].opcodes[0]={type:4,index:72},this.rules[72].opcodes=[],this.rules[72].opcodes[0]={type:3,min:1,max:1/0},this.rules[72].opcodes[1]={type:5,min:48,max:57},this.rules[73].opcodes=[],this.rules[73].opcodes[0]={type:4,index:85},this.rules[74].opcodes=[],this.rules[74].opcodes[0]={type:4,index:87},this.rules[75].opcodes=[],this.rules[75].opcodes[0]={type:4,index:86},this.rules[76].opcodes=[],this.rules[76].opcodes[0]={type:1,children:[1,2]},this.rules[76].opcodes[1]={type:6,string:[68]},this.rules[76].opcodes[2]={type:6,string:[100]},this.rules[77].opcodes=[],this.rules[77].opcodes[0]={type:1,children:[1,2]},this.rules[77].opcodes[1]={type:6,string:[88]},this.rules[77].opcodes[2]={type:6,string:[120]},this.rules[78].opcodes=[],this.rules[78].opcodes[0]={type:1,children:[1,2]},this.rules[78].opcodes[1]={type:6,string:[66]},this.rules[78].opcodes[2]={type:6,string:[98]},this.rules[79].opcodes=[],this.rules[79].opcodes[0]={type:4,index:85},this.rules[80].opcodes=[],this.rules[80].opcodes[0]={type:4,index:85},this.rules[81].opcodes=[],this.rules[81].opcodes[0]={type:4,index:86},this.rules[82].opcodes=[],this.rules[82].opcodes[0]={type:4,index:86},this.rules[83].opcodes=[],this.rules[83].opcodes[0]={type:4,index:87},this.rules[84].opcodes=[],this.rules[84].opcodes[0]={type:4,index:87},this.rules[85].opcodes=[],this.rules[85].opcodes[0]={type:3,min:1,max:1/0},this.rules[85].opcodes[1]={type:5,min:48,max:57},this.rules[86].opcodes=[],this.rules[86].opcodes[0]={type:3,min:1,max:1/0},this.rules[86].opcodes[1]={type:5,min:48,max:49},this.rules[87].opcodes=[],this.rules[87].opcodes[0]={type:3,min:1,max:1/0},this.rules[87].opcodes[1]={type:1,children:[2,3,4]},this.rules[87].opcodes[2]={type:5,min:48,max:57},this.rules[87].opcodes[3]={type:5,min:65,max:70},this.rules[87].opcodes[4]={type:5,min:97,max:102},this.rules[88].opcodes=[],this.rules[88].opcodes[0]={type:2,children:[1,4]},this.rules[88].opcodes[1]={type:1,children:[2,3]},this.rules[88].opcodes[2]={type:5,min:97,max:122},this.rules[88].opcodes[3]={type:5,min:65,max:90},this.rules[88].opcodes[4]={type:3,min:0,max:1/0},this.rules[88].opcodes[5]={type:1,children:[6,7,8,9]},this.rules[88].opcodes[6]={type:5,min:97,max:122},this.rules[88].opcodes[7]={type:5,min:65,max:90},this.rules[88].opcodes[8]={type:5,min:48,max:57},this.rules[88].opcodes[9]={type:6,string:[45]},this.rules[89].opcodes=[],this.rules[89].opcodes[0]={type:3,min:0,max:1/0},this.rules[89].opcodes[1]={type:4,index:91},this.rules[90].opcodes=[],this.rules[90].opcodes[0]={type:3,min:1,max:1/0},this.rules[90].opcodes[1]={type:4,index:91},this.rules[91].opcodes=[],this.rules[91].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[91].opcodes[1]={type:6,string:[32]},this.rules[91].opcodes[2]={type:6,string:[9]},this.rules[91].opcodes[3]={type:4,index:92},this.rules[91].opcodes[4]={type:4,index:94},this.rules[92].opcodes=[],this.rules[92].opcodes[0]={type:2,children:[1,2]},this.rules[92].opcodes[1]={type:6,string:[59]},this.rules[92].opcodes[2]={type:3,min:0,max:1/0},this.rules[92].opcodes[3]={type:1,children:[4,5]},this.rules[92].opcodes[4]={type:5,min:32,max:126},this.rules[92].opcodes[5]={type:6,string:[9]},this.rules[93].opcodes=[],this.rules[93].opcodes[0]={type:1,children:[1,2,3]},this.rules[93].opcodes[1]={type:6,string:[13,10]},this.rules[93].opcodes[2]={type:6,string:[10]},this.rules[93].opcodes[3]={type:6,string:[13]},this.rules[94].opcodes=[],this.rules[94].opcodes[0]={type:2,children:[1,5]},this.rules[94].opcodes[1]={type:1,children:[2,3,4]},this.rules[94].opcodes[2]={type:6,string:[13,10]},this.rules[94].opcodes[3]={type:6,string:[10]},this.rules[94].opcodes[4]={type:6,string:[13]},this.rules[94].opcodes[5]={type:1,children:[6,7]},this.rules[94].opcodes[6]={type:6,string:[32]},this.rules[94].opcodes[7]={type:6,string:[9]},this.toString=function(){let $="";return $+=`;
`,$+=`; ABNF for JavaScript APG 2.0 SABNF
`,$+=`; RFC 5234 with some restrictions and additions.
`,$+=`; Updated 11/24/2015 for RFC 7405 case-sensitive literal string notation
`,$+=`;  - accepts %s"string" as a case-sensitive string
`,$+=`;  - accepts %i"string" as a case-insensitive string
`,$+=`;  - accepts "string" as a case-insensitive string
`,$+=`;
`,$+=`; Some restrictions:
`,$+=`;   1. Rules must begin at first character of each line.
`,$+=`;      Indentations on first rule and rules thereafter are not allowed.
`,$+=`;   2. Relaxed line endings. CRLF, LF or CR are accepted as valid line ending.
`,$+=`;   3. Prose values, i.e. <prose value>, are accepted as valid grammar syntax.
`,$+=`;      However, a working parser cannot be generated from them.
`,$+=`;
`,$+=`; Super set (SABNF) additions:
`,$+=`;   1. Look-ahead (syntactic predicate) operators are accepted as element prefixes.
`,$+=`;      & is the positive look-ahead operator, succeeds and backtracks if the look-ahead phrase is found
`,$+=`;      ! is the negative look-ahead operator, succeeds and backtracks if the look-ahead phrase is NOT found
`,$+=`;      e.g. &%d13 or &rule or !(A / B)
`,$+=`;   2. User-Defined Terminals (UDT) of the form, u_name and e_name are accepted.
`,$+=`;      'name' is alpha followed by alpha/num/hyphen just like a rule name.
`,$+=`;      u_name may be used as an element but no rule definition is given.
`,$+=`;      e.g. rule = A / u_myUdt
`,$+=`;           A = "a"
`,$+=`;      would be a valid grammar.
`,$+=`;   3. Case-sensitive, single-quoted strings are accepted.
`,$+=`;      e.g. 'abc' would be equivalent to %d97.98.99
`,$+=`;      (kept for backward compatibility, but superseded by %s"abc")  
`,$+=`; New 12/26/2015
`,$+=`;   4. Look-behind operators are accepted as element prefixes.
`,$+=`;      && is the positive look-behind operator, succeeds and backtracks if the look-behind phrase is found
`,$+=`;      !! is the negative look-behind operator, succeeds and backtracks if the look-behind phrase is NOT found
`,$+=`;      e.g. &&%d13 or &&rule or !!(A / B)
`,$+=`;   5. Back reference operators, i.e. \\rulename, are accepted.
`,$+=`;      A back reference operator acts like a TLS or TBS terminal except that the phrase it attempts
`,$+=`;      to match is a phrase previously matched by the rule 'rulename'.
`,$+=`;      There are two modes of previous phrase matching - the parent-frame mode and the universal mode.
`,$+=`;      In universal mode, \\rulename matches the last match to 'rulename' regardless of where it was found.
`,$+=`;      In parent-frame mode, \\rulename matches only the last match found on the parent's frame or parse tree level.
`,$+=`;      Back reference modifiers can be used to specify case and mode.
`,$+=`;      \\A defaults to case-insensitive and universal mode, e.g. \\A === \\%i%uA
`,$+=`;      Modifiers %i and %s determine case-insensitive and case-sensitive mode, respectively.
`,$+=`;      Modifiers %u and %p determine universal mode and parent frame mode, respectively.
`,$+=`;      Case and mode modifiers can appear in any order, e.g. \\%s%pA === \\%p%sA. 
`,$+=`;   7. String begin anchor, ABG(%^) matches the beginning of the input string location.
`,$+=`;      Returns EMPTY or NOMATCH. Never consumes any characters.
`,$+=`;   8. String end anchor, AEN(%$) matches the end of the input string location.
`,$+=`;      Returns EMPTY or NOMATCH. Never consumes any characters.
`,$+=`;
`,$+=`File            = *(BlankLine / Rule / RuleError)
`,$+=`BlankLine       = *(%d32/%d9) [comment] LineEnd
`,$+=`Rule            = RuleLookup owsp Alternation ((owsp LineEnd)
`,$+=`                / (LineEndError LineEnd))
`,$+=`RuleLookup      = RuleNameTest owsp DefinedAsTest
`,$+=`RuleNameTest    = RuleName/RuleNameError
`,$+=`RuleName        = alphanum
`,$+=`RuleNameError   = 1*(%d33-60/%d62-126)
`,$+=`DefinedAsTest   = DefinedAs / DefinedAsError
`,$+=`DefinedAsError  = 1*2%d33-126
`,$+=`DefinedAs       = IncAlt / Defined
`,$+=`Defined         = %d61
`,$+=`IncAlt          = %d61.47
`,$+=`RuleError       = 1*(%d32-126 / %d9  / LineContinue) LineEnd
`,$+=`LineEndError    = 1*(%d32-126 / %d9  / LineContinue)
`,$+=`Alternation     = Concatenation *(owsp AltOp Concatenation)
`,$+=`Concatenation   = Repetition *(CatOp Repetition)
`,$+=`Repetition      = [Modifier] (Group / Option / BasicElement / BasicElementErr)
`,$+=`Modifier        = (Predicate [RepOp])
`,$+=`                / RepOp
`,$+=`Predicate       = BkaOp
`,$+=`                / BknOp
`,$+=`                / AndOp
`,$+=`                / NotOp
`,$+=`BasicElement    = UdtOp
`,$+=`                / RnmOp
`,$+=`                / TrgOp
`,$+=`                / TbsOp
`,$+=`                / TlsOp
`,$+=`                / ClsOp
`,$+=`                / BkrOp
`,$+=`                / AbgOp
`,$+=`                / AenOp
`,$+=`                / ProsVal
`,$+=`BasicElementErr = 1*(%d33-40/%d42-46/%d48-92/%d94-126)
`,$+=`Group           = GroupOpen  Alternation (GroupClose / GroupError)
`,$+=`GroupError      = 1*(%d33-40/%d42-46/%d48-92/%d94-126) ; same as BasicElementErr
`,$+=`GroupOpen       = %d40 owsp
`,$+=`GroupClose      = owsp %d41
`,$+=`Option          = OptionOpen Alternation (OptionClose / OptionError)
`,$+=`OptionError     = 1*(%d33-40/%d42-46/%d48-92/%d94-126) ; same as BasicElementErr
`,$+=`OptionOpen      = %d91 owsp
`,$+=`OptionClose     = owsp %d93
`,$+=`RnmOp           = alphanum
`,$+=`BkrOp           = %d92 [bkrModifier] bkr-name
`,$+=`bkrModifier     = (cs [um / pm]) / (ci [um / pm]) / (um [cs /ci]) / (pm [cs / ci])
`,$+=`cs              = '%s'
`,$+=`ci              = '%i'
`,$+=`um              = '%u'
`,$+=`pm              = '%p'
`,$+=`bkr-name        = uname / ename / rname
`,$+=`rname           = alphanum
`,$+=`uname           = %d117.95 alphanum
`,$+=`ename           = %d101.95 alphanum
`,$+=`UdtOp           = udt-empty
`,$+=`                / udt-non-empty
`,$+=`udt-non-empty   = %d117.95 alphanum
`,$+=`udt-empty       = %d101.95 alphanum
`,$+=`RepOp           = (rep-min StarOp rep-max)
`,$+=`                / (rep-min StarOp)
`,$+=`                / (StarOp rep-max)
`,$+=`                / StarOp
`,$+=`                / rep-min-max
`,$+=`AltOp           = %d47 owsp
`,$+=`CatOp           = wsp
`,$+=`StarOp          = %d42
`,$+=`AndOp           = %d38
`,$+=`NotOp           = %d33
`,$+=`BkaOp           = %d38.38
`,$+=`BknOp           = %d33.33
`,$+=`AbgOp           = %d37.94
`,$+=`AenOp           = %d37.36
`,$+=`TrgOp           = %d37 ((Dec dmin %d45 dmax) / (Hex xmin %d45 xmax) / (Bin bmin %d45 bmax))
`,$+=`TbsOp           = %d37 ((Dec dString *(%d46 dString)) / (Hex xString *(%d46 xString)) / (Bin bString *(%d46 bString)))
`,$+=`TlsOp           = TlsCase TlsOpen TlsString TlsClose
`,$+=`TlsCase         = ["%i" / "%s"]
`,$+=`TlsOpen         = %d34
`,$+=`TlsClose        = %d34
`,$+=`TlsString       = *(%d32-33/%d35-126/StringTab)
`,$+=`StringTab       = %d9
`,$+=`ClsOp           = ClsOpen ClsString ClsClose
`,$+=`ClsOpen         = %d39
`,$+=`ClsClose        = %d39
`,$+=`ClsString       = *(%d32-38/%d40-126/StringTab)
`,$+=`ProsVal         = ProsValOpen ProsValString ProsValClose
`,$+=`ProsValOpen     = %d60
`,$+=`ProsValString   = *(%d32-61/%d63-126/StringTab)
`,$+=`ProsValClose    = %d62
`,$+=`rep-min         = rep-num
`,$+=`rep-min-max     = rep-num
`,$+=`rep-max         = rep-num
`,$+=`rep-num         = 1*(%d48-57)
`,$+=`dString         = dnum
`,$+=`xString         = xnum
`,$+=`bString         = bnum
`,$+=`Dec             = (%d68/%d100)
`,$+=`Hex             = (%d88/%d120)
`,$+=`Bin             = (%d66/%d98)
`,$+=`dmin            = dnum
`,$+=`dmax            = dnum
`,$+=`bmin            = bnum
`,$+=`bmax            = bnum
`,$+=`xmin            = xnum
`,$+=`xmax            = xnum
`,$+=`dnum            = 1*(%d48-57)
`,$+=`bnum            = 1*%d48-49
`,$+=`xnum            = 1*(%d48-57 / %d65-70 / %d97-102)
`,$+=`;
`,$+=`; Basics
`,$+=`alphanum        = (%d97-122/%d65-90) *(%d97-122/%d65-90/%d48-57/%d45)
`,$+=`owsp            = *space
`,$+=`wsp             = 1*space
`,$+=`space           = %d32
`,$+=`                / %d9
`,$+=`                / comment
`,$+=`                / LineContinue
`,$+=`comment         = %d59 *(%d32-126 / %d9)
`,$+=`LineEnd         = %d13.10
`,$+=`                / %d10
`,$+=`                / %d13
`,$+=`LineContinue    = (%d13.10 / %d10 / %d13) (%d32 / %d9)
`,$}}),sabnfGrammar}var parser$2,hasRequiredParser;function requireParser(){return hasRequiredParser||(hasRequiredParser=1,parser$2=function(){const o="parser: ",$=nodeExports,j=$.ids,et=new(requireSyntaxCallbacks()),tt=new(requireSemanticCallbacks()),rt=new(requireSabnfGrammar()),nt=new $.parser;nt.ast=new $.ast,nt.callbacks=et.callbacks,nt.ast.callbacks=tt.callbacks;const it=function(ct,ut,ft){if(ut<0||ut>=ft)return-1;for(let ht=0;ht<ct.length;ht+=1)if(ut>=ct[ht].beginChar&&ut<ct[ht].beginChar+ct[ht].length)return ht;return-1},st=function(ct,ut){let ft=-1;if(ut<ct.length){for(let ht=ut;ht<ct.length;ht+=1)if(ct[ht]!==null){ft=ct[ht];break}}return ft},ot=function(ct){ct.forEach(ut=>{const ft=[],ht=[];let mt=0;ut.opcodes.forEach(gt=>{gt.type===j.ALT&&gt.children.length===1||gt.type===j.CAT&&gt.children.length===1||gt.type===j.REP&&gt.min===1&&gt.max===1?ht.push(null):(ht.push(mt),ft.push(gt),mt+=1)}),ht.push(mt),ft.forEach(gt=>{if(gt.type===j.ALT||gt.type===j.CAT)for(let Et=0;Et<gt.children.length;Et+=1)gt.children[Et]=st(ht,gt.children[Et])}),ut.opcodes=ft})};this.syntax=function(ct,ut,ft,ht,mt){if(mt){if(mt.traceObject!=="traceObject")throw new TypeError(`${o}trace argument is not a trace object`);nt.trace=mt}const gt={};gt.errors=ft,gt.strict=!!ht,gt.lines=ut,gt.findLine=it,gt.charsLength=ct.length,gt.ruleCount=0,nt.parse(rt,"file",ct,gt).success||ft.push({line:0,char:0,msg:"syntax analysis of input grammar failed"})},this.semantic=function(ct,ut,ft){const ht={};return ht.errors=ft,ht.lines=ut,ht.findLine=it,ht.charsLength=ct.length,nt.ast.translate(ht),ft.length?null:(ot(ht.rules),{rules:ht.rules,udts:ht.udts,lineMap:ht.rulesLineMap})},this.generateSource=function(ct,ut,ft,ht,mt){let gt="",Et,St,At,kt=0,Rt=1/0,Tt=0;const Dt=[],Ot=[];let jt=0,Nt=0,It=0,yt=0,lt=0,pt=0,bt=0,_t=0,$t=0,Ct=0,xt=0,vt=0,dt=0,wt=0,qt=0;ft.forEach(Wt=>{Dt.push(Wt.lower),kt+=Wt.opcodes.length,Wt.opcodes.forEach(Vt=>{switch(Vt.type){case j.ALT:jt+=1;break;case j.CAT:Nt+=1;break;case j.RNM:It+=1;break;case j.UDT:yt+=1;break;case j.REP:lt+=1;break;case j.AND:pt+=1;break;case j.NOT:bt+=1;break;case j.BKA:vt+=1;break;case j.BKN:dt+=1;break;case j.BKR:xt+=1;break;case j.ABG:wt+=1;break;case j.AEN:qt+=1;break;case j.TLS:for(_t+=1,Et=0;Et<Vt.string.length;Et+=1)Vt.string[Et]<Rt&&(Rt=Vt.string[Et]),Vt.string[Et]>Tt&&(Tt=Vt.string[Et]);break;case j.TBS:for($t+=1,Et=0;Et<Vt.string.length;Et+=1)Vt.string[Et]<Rt&&(Rt=Vt.string[Et]),Vt.string[Et]>Tt&&(Tt=Vt.string[Et]);break;case j.TRG:Ct+=1,Vt.min<Rt&&(Rt=Vt.min),Vt.max>Tt&&(Tt=Vt.max);break;default:throw new Error("generateSource: unrecognized opcode")}})}),Dt.sort(),ht.length>0&&(ht.forEach(Wt=>{Ot.push(Wt.lower)}),Ot.sort());let Pt="module.exports";mt&&typeof mt=="string"&&(Pt=`let ${mt}`),gt+=`// copyright: Copyright (c) 2021 Lowell D. Thomas, all rights reserved<br>
`,gt+=`//   license: BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)<br>
`,gt+=`//
`,gt+=`// Generated by apg-js, Version 4.0.0 [apg-js](https://github.com/ldthomas/apg-js)
`,gt+=`${Pt} = function grammar(){
`,gt+="  // ```\n",gt+=`  // SUMMARY
`,gt+=`  //      rules = ${ft.length}
`,gt+=`  //       udts = ${ht.length}
`,gt+=`  //    opcodes = ${kt}
`,gt+=`  //        ---   ABNF original opcodes
`,gt+=`  //        ALT = ${jt}
`,gt+=`  //        CAT = ${Nt}
`,gt+=`  //        REP = ${lt}
`,gt+=`  //        RNM = ${It}
`,gt+=`  //        TLS = ${_t}
`,gt+=`  //        TBS = ${$t}
`,gt+=`  //        TRG = ${Ct}
`,gt+=`  //        ---   SABNF superset opcodes
`,gt+=`  //        UDT = ${yt}
`,gt+=`  //        AND = ${pt}
`,gt+=`  //        NOT = ${bt}
`,gt+=`  //        BKA = ${vt}
`,gt+=`  //        BKN = ${dt}
`,gt+=`  //        BKR = ${xt}
`,gt+=`  //        ABG = ${wt}
`,gt+=`  //        AEN = ${qt}
`,gt+="  // characters = [",_t+$t+Ct===0?gt+=" none defined ]":gt+=`${Rt} - ${Tt}]`,yt>0&&(gt+=" + user defined"),gt+=`
`,gt+="  // ```\n",gt+=`  /* OBJECT IDENTIFIER (for internal parser use) */
`,gt+=`  this.grammarObject = 'grammarObject';
`,gt+=`
`,gt+=`  /* RULES */
`,gt+=`  this.rules = [];
`,ft.forEach((Wt,Vt)=>{let Ut="  this.rules[";Ut+=Vt,Ut+="] = {name: '",Ut+=Wt.name,Ut+="', lower: '",Ut+=Wt.lower,Ut+="', index: ",Ut+=Wt.index,Ut+=", isBkr: ",Ut+=Wt.isBkr,Ut+=`};
`,gt+=Ut}),gt+=`
`,gt+=`  /* UDTS */
`,gt+=`  this.udts = [];
`,ht.length>0&&ht.forEach((Wt,Vt)=>{let Ut="  this.udts[";Ut+=Vt,Ut+="] = {name: '",Ut+=Wt.name,Ut+="', lower: '",Ut+=Wt.lower,Ut+="', index: ",Ut+=Wt.index,Ut+=", empty: ",Ut+=Wt.empty,Ut+=", isBkr: ",Ut+=Wt.isBkr,Ut+=`};
`,gt+=Ut}),gt+=`
`,gt+=`  /* OPCODES */
`,ft.forEach((Wt,Vt)=>{Vt>0&&(gt+=`
`),gt+=`  /* ${Wt.name} */
`,gt+=`  this.rules[${Vt}].opcodes = [];
`,Wt.opcodes.forEach((Ut,Mt)=>{let Lt;switch(Ut.type){case j.ALT:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, children: [${Ut.children.toString()}]};// ALT
`;break;case j.CAT:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, children: [${Ut.children.toString()}]};// CAT
`;break;case j.RNM:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, index: ${Ut.index}};// RNM(${ft[Ut.index].name})
`;break;case j.BKR:Ut.index>=ft.length?(St=ht[Ut.index-ft.length].name,At=ht[Ut.index-ft.length].lower):(St=ft[Ut.index].name,At=ft[Ut.index].lower),Lt="%i",Ut.bkrCase===j.BKR_MODE_CS&&(Lt="%s"),Ut.bkrMode===j.BKR_MODE_UM?Lt+="%u":Lt+="%p",St=Lt+St,gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, index: ${Ut.index}, lower: '${At}', bkrCase: ${Ut.bkrCase}, bkrMode: ${Ut.bkrMode}};// BKR(\\${St})
`;break;case j.UDT:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, empty: ${Ut.empty}, index: ${Ut.index}};// UDT(${ht[Ut.index].name})
`;break;case j.REP:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, min: ${Ut.min}, max: ${Ut.max}};// REP
`;break;case j.AND:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}};// AND
`;break;case j.NOT:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}};// NOT
`;break;case j.ABG:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}};// ABG(%^)
`;break;case j.AEN:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}};// AEN(%$)
`;break;case j.BKA:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}};// BKA
`;break;case j.BKN:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}};// BKN
`;break;case j.TLS:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, string: [${Ut.string.toString()}]};// TLS
`;break;case j.TBS:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, string: [${Ut.string.toString()}]};// TBS
`;break;case j.TRG:gt+=`  this.rules[${Vt}].opcodes[${Mt}] = {type: ${Ut.type}, min: ${Ut.min}, max: ${Ut.max}};// TRG
`;break;default:throw new Error("parser.js: ~143: unrecognized opcode")}})}),gt+=`
`,gt+="  // The `toString()` function will display the original grammar file(s) that produced these opcodes.\n",gt+=`  this.toString = function toString(){
`,gt+=`    let str = "";
`;let Gt;return ut.forEach(Wt=>{const Vt=Wt.beginChar+Wt.length;Gt="",gt+='    str += "';for(let Ut=Wt.beginChar;Ut<Vt;Ut+=1){switch(ct[Ut]){case 9:Gt=" ";break;case 10:Gt="\\n";break;case 13:Gt="\\r";break;case 34:Gt='\\"';break;case 92:Gt="\\\\";break;default:Gt=String.fromCharCode(ct[Ut]);break}gt+=Gt}gt+=`";
`}),gt+=`    return str;
`,gt+=`  }
`,gt+=`}
`,gt},this.generateObject=function(ct,ut,ft){const ht={},mt=[],gt=[],Et=ct.slice(0);return ht.grammarObject="grammarObject",ut.forEach(St=>{mt.push(St.lower)}),mt.sort(),ft.length>0&&(ft.forEach(St=>{gt.push(St.lower)}),gt.sort()),ht.callbacks=[],mt.forEach(St=>{ht.callbacks[St]=!1}),ft.length>0&&gt.forEach(St=>{ht.callbacks[St]=!1}),ht.rules=ut,ht.udts=ft,ht.toString=function(){return Et},ht}}),parser$2}var ruleAttributes,hasRequiredRuleAttributes;function requireRuleAttributes(){return hasRequiredRuleAttributes||(hasRequiredRuleAttributes=1,ruleAttributes=function(){const o=identifiers,$="rule-attributes.js";let j=null;function et(jt){return jt.left||jt.nested||jt.right||jt.cyclic?!1:jt.empty}function tt(jt){return!!(jt.left||jt.nested||jt.right||jt.cyclic)}function rt(jt,Nt){let It=0,yt=0,lt=0;for(It=0;It<Nt;It+=1)if(jt[It].nested)return!0;for(It=0;It<Nt;It+=1)if(jt[It].right&&!jt[It].leaf){for(yt=It+1;yt<Nt;yt+=1)if(!et(jt[yt]))return!0}for(It=Nt-1;It>=0;It-=1)if(jt[It].left&&!jt[It].leaf){for(yt=It-1;yt>=0;yt-=1)if(!et(jt[yt]))return!0}for(It=0;It<Nt;It+=1)if(!jt[It].empty&&!tt(jt[It])){for(yt=It+1;yt<Nt;yt+=1)if(tt(jt[yt])){for(lt=yt+1;lt<Nt;lt+=1)if(!jt[lt].empty&&!tt(jt[lt]))return!0}}return!1}function nt(jt,Nt){for(let It=0;It<Nt;It+=1)if(!jt[It].cyclic)return!1;return!0}function it(jt,Nt){for(let It=0;It<Nt;It+=1){if(jt[It].left)return!0;if(!jt[It].empty)return!1}return!1}function st(jt,Nt){for(let It=Nt-1;It>=0;It-=1){if(jt[It].right)return!0;if(!jt[It].empty)return!1}return!1}function ot(jt,Nt){for(let It=0;It<Nt;It+=1)if(!jt[It].empty)return!1;return!0}function at(jt,Nt){for(let It=0;It<Nt;It+=1)if(!jt[It].finite)return!1;return!0}function ct(jt,Nt,It,yt){let lt=0;const pt=Nt[It],bt=pt.children.length,_t=[];for(lt=0;lt<bt;lt+=1)_t.push(jt.attrGen());for(lt=0;lt<bt;lt+=1)ht(jt,Nt,pt.children[lt],_t[lt]);yt.left=it(_t,bt),yt.right=st(_t,bt),yt.nested=rt(_t,bt),yt.empty=ot(_t,bt),yt.finite=at(_t,bt),yt.cyclic=nt(_t,bt)}function ut(jt,Nt,It,yt){let lt=0;const pt=Nt[It],bt=pt.children.length,_t=[];for(lt=0;lt<bt;lt+=1)_t.push(jt.attrGen());for(lt=0;lt<bt;lt+=1)ht(jt,Nt,pt.children[lt],_t[lt]);for(yt.left=!1,yt.right=!1,yt.nested=!1,yt.empty=!1,yt.finite=!1,yt.cyclic=!1,lt=0;lt<bt;lt+=1)_t[lt].left&&(yt.left=!0),_t[lt].nested&&(yt.nested=!0),_t[lt].right&&(yt.right=!0),_t[lt].empty&&(yt.empty=!0),_t[lt].finite&&(yt.finite=!0),_t[lt].cyclic&&(yt.cyclic=!0)}function ft(jt,Nt,It,yt){const lt=Nt[It];lt.index>=jt.ruleCount?(yt.empty=jt.udts[lt.index-jt.ruleCount].empty,yt.finite=!0):(mt(jt,lt.index,yt),yt.left=!1,yt.nested=!1,yt.right=!1,yt.cyclic=!1)}function ht(jt,Nt,It,yt){jt.attrInit(yt);const lt=Nt[It];switch(lt.type){case o.ALT:ut(jt,Nt,It,yt);break;case o.CAT:ct(jt,Nt,It,yt);break;case o.REP:ht(jt,Nt,It+1,yt),lt.min===0&&(yt.empty=!0,yt.finite=!0);break;case o.RNM:mt(jt,Nt[It].index,yt);break;case o.BKR:ft(jt,Nt,It,yt);break;case o.AND:case o.NOT:case o.BKA:case o.BKN:ht(jt,Nt,It+1,yt),yt.empty=!0;break;case o.TLS:yt.empty=!Nt[It].string.length,yt.finite=!0,yt.cyclic=!1;break;case o.TBS:case o.TRG:yt.empty=!1,yt.finite=!0,yt.cyclic=!1;break;case o.UDT:yt.empty=lt.empty,yt.finite=!0,yt.cyclic=!1;break;case o.ABG:case o.AEN:yt.empty=!0,yt.finite=!0,yt.cyclic=!1;break;default:throw new Error(`unknown opcode type: ${lt}`)}}function mt(jt,Nt,It){const yt=jt.attrsWorking[Nt];yt.isComplete?jt.attrCopy(It,yt):yt.isOpen?Nt===jt.startRule?Nt===jt.startRule&&(It.left=!0,It.right=!0,It.cyclic=!0,It.leaf=!0):It.finite=!0:(yt.isOpen=!0,ht(jt,yt.rule.opcodes,0,It),yt.left=It.left,yt.right=It.right,yt.nested=It.nested,yt.empty=It.empty,yt.finite=It.finite,yt.cyclic=It.cyclic,yt.leaf=!1,yt.isOpen=!1,yt.isComplete=!0)}const gt=jt=>{j=jt;let Nt=0,It=0;const yt=j.attrGen();for(Nt=0;Nt<j.ruleCount;Nt+=1){for(It=0;It<j.ruleCount;It+=1)j.attrInit(j.attrsWorking[It]);j.startRule=Nt,mt(j,Nt,yt),j.attrCopy(j.attrs[Nt],j.attrsWorking[Nt])}j.attributesComplete=!0;let lt=null;for(Nt=0;Nt<j.ruleCount;Nt+=1)if(lt=j.attrs[Nt],lt.left||!lt.finite||lt.cyclic){const pt=j.attrGen(lt.rule);j.attrCopy(pt,lt),j.attrsErrors.push(pt),j.attrsErrorCount+=1}},Et=jt=>jt?"t":"f",St=jt=>jt?"e":"f",At=jt=>jt?"t":"e",kt=(jt,Nt,It,yt)=>{let lt=`${jt}:${Nt}:`;return lt+=`${St(It.left)} `,lt+=`${Et(It.nested)} `,lt+=`${Et(It.right)} `,lt+=`${St(It.cyclic)} `,lt+=`${At(It.finite)} `,lt+=`${Et(It.empty)}:`,lt+=`${j.typeToString(yt.recursiveType)}:`,lt+=yt.recursiveType===o.ATTR_MR?yt.groupNumber:"-",lt+=`:${It.rule.name}
`,lt},Rt=()=>{let jt=`LEGEND - t=true, f=false, e=error
`;return jt+=`sequence:rule index:left nested right cyclic finite empty:type:group number:rule name
`,jt},Tt=()=>{let jt=null,Nt=null,It="";if(It+=`RULE ATTRIBUTES WITH ERRORS
`,It+=Rt(),j.attrsErrorCount)for(let yt=0;yt<j.attrsErrorCount;yt+=1)jt=j.attrsErrors[yt],Nt=j.ruleDeps[jt.rule.index],It+=kt(yt,jt.rule.index,jt,Nt);else It+=`<none>
`;return It},Dt=jt=>{let Nt=0,It=0,yt=null,lt=null,pt="",{ruleIndexes:bt}=j;for(jt===97?bt=j.ruleAlphaIndexes:jt===116&&(bt=j.ruleTypeIndexes),Nt=0;Nt<j.ruleCount;Nt+=1)It=bt[Nt],yt=j.attrs[It],lt=j.ruleDeps[It],pt+=kt(Nt,It,yt,lt);return pt};return{ruleAttributes:gt,showAttributes:(jt="index")=>{if(!j.attributesComplete)throw new Error(`${$}:showAttributes: attributes not available`);let Nt="";const It=`RULE ATTRIBUTES
`;return jt.charCodeAt(0)===97?(Nt+=`alphabetical by rule name
`,Nt+=It,Nt+=Rt(),Nt+=Dt(97)):jt.charCodeAt(0)===116?(Nt+=`ordered by rule type
`,Nt+=It,Nt+=Rt(),Nt+=Dt(116)):(Nt+=`ordered by rule index
`,Nt+=It,Nt+=Rt(),Nt+=Dt()),Nt},showAttributeErrors:Tt}}()),ruleAttributes}var ruleDependencies,hasRequiredRuleDependencies;function requireRuleDependencies(){return hasRequiredRuleDependencies||(hasRequiredRuleDependencies=1,ruleDependencies=(()=>{const _=identifiers;let o=null;const $=(rt,nt,it,st)=>{let ot=0,at=0;const ct=nt[it];st[it]=!0;const ut=ct.rule.opcodes;for(ot=0;ot<ut.length;ot+=1){const ft=ut[ot];if(ft.type===_.RNM)for(ct.refersTo[ft.index]=!0,st[ft.index]||$(rt,nt,ft.index,st),at=0;at<rt;at+=1)nt[ft.index].refersTo[at]&&(ct.refersTo[at]=!0);else ft.type===_.UDT?ct.refersToUdt[ft.index]=!0:ft.type===_.BKR&&(ft.index<rt?(ct.refersTo[ft.index]=!0,st[ft.index]||$(rt,nt,ft.index,st)):ct.refersToUdt[rt-ft.index]=!0)}},j=rt=>{o=rt;let nt=0,it=0,st=0,ot=null,at=null,ct=!1;o.dependenciesComplete=!1;const ut=o.falseArray(o.ruleCount);for(nt=0;nt<o.ruleCount;nt+=1)o.falsifyArray(ut),$(o.ruleCount,o.ruleDeps,nt,ut);for(nt=0;nt<o.ruleCount;nt+=1)for(it=0;it<o.ruleCount;it+=1)nt!==it&&o.ruleDeps[it].refersTo[nt]&&(o.ruleDeps[nt].referencedBy[it]=!0);for(nt=0;nt<o.ruleCount;nt+=1)o.ruleDeps[nt].recursiveType=_.ATTR_N,o.ruleDeps[nt].refersTo[nt]&&(o.ruleDeps[nt].recursiveType=_.ATTR_R);for(st=-1,nt=0;nt<o.ruleCount;nt+=1)if(ot=o.ruleDeps[nt],ot.recursiveType===_.ATTR_R)for(ct=!0,it=0;it<o.ruleCount;it+=1)nt!==it&&(at=o.ruleDeps[it],at.recursiveType===_.ATTR_R&&ot.refersTo[it]&&at.refersTo[nt]&&(ct&&(st+=1,ot.recursiveType=_.ATTR_MR,ot.groupNumber=st,ct=!1),at.recursiveType=_.ATTR_MR,at.groupNumber=st));o.isMutuallyRecursive=st>-1,o.ruleAlphaIndexes.sort(o.compRulesAlpha),o.ruleTypeIndexes.sort(o.compRulesAlpha),o.ruleTypeIndexes.sort(o.compRulesType),o.isMutuallyRecursive&&o.ruleTypeIndexes.sort(o.compRulesGroup),o.udtCount&&o.udtAlphaIndexes.sort(o.compUdtsAlpha),o.dependenciesComplete=!0},et=(rt=null)=>{let nt=0,it=0,st=0,ot=0;const at=o.ruleCount-1,ct=o.udtCount-1,ut=100;let ft="",ht="";const mt="=> ",gt="<= ";let Et=!1,St=null,{ruleIndexes:At}=o,{udtIndexes:kt}=o;for(rt===97?(At=o.ruleAlphaIndexes,kt=o.udtAlphaIndexes):rt===116&&(At=o.ruleTypeIndexes,kt=o.udtAlphaIndexes),nt=0;nt<o.ruleCount;nt+=1){for(St=o.ruleDeps[At[nt]],ht=`${At[nt]}:${o.typeToString(St.recursiveType)}:`,o.isMutuallyRecursive&&(ht+=St.groupNumber>-1?St.groupNumber:"-",ht+=":"),ht+=" ",ft+=`${ht+o.rules[At[nt]].name}
`,Et=!0,st=0,ot=ft.length,ft+=ht,it=0;it<o.ruleCount;it+=1)St.refersTo[At[it]]&&(Et?(ft+=mt,Et=!1,ft+=o.ruleDeps[At[it]].rule.name):ft+=`, ${o.ruleDeps[At[it]].rule.name}`,st+=1),ft.length-ot>ut&&it!==at&&(ft+=`
${ht}${mt}`,ot=ft.length);if(o.udtCount)for(it=0;it<o.udtCount;it+=1)St.refersToUdt[kt[it]]&&(Et?(ft+=mt,Et=!1,ft+=o.udts[kt[it]].name):ft+=`, ${o.udts[kt[it]].name}`,st+=1),ft.length-ot>ut&&it!==ct&&(ft+=`
${ht}${mt}`,ot=ft.length);for(st===0&&(ft+=`=> <none>
`),Et===!1&&(ft+=`
`),Et=!0,st=0,ot=ft.length,ft+=ht,it=0;it<o.ruleCount;it+=1)St.referencedBy[At[it]]&&(Et?(ft+=gt,Et=!1,ft+=o.ruleDeps[At[it]].rule.name):ft+=`, ${o.ruleDeps[At[it]].rule.name}`,st+=1),ft.length-ot>ut&&it!==at&&(ft+=`
${ht}${mt}`,ot=ft.length);st===0&&(ft+=`<= <none>
`),Et===!1&&(ft+=`
`),ft+=`
`}return ft};return{ruleDependencies:j,showRuleDependencies:(rt="index")=>{let nt=`RULE DEPENDENCIES(index:type:[group number:])
`;return nt+=`=> refers to rule names
`,nt+=`<= referenced by rule names
`,o.dependenciesComplete&&(rt.charCodeAt(0)===97?(nt+=`alphabetical by rule name
`,nt+=et(97)):rt.charCodeAt(0)===116?(nt+=`ordered by rule type
`,nt+=et(116)):(nt+=`ordered by rule index
`,nt+=et(null))),nt}}})()),ruleDependencies}var attributes,hasRequiredAttributes;function requireAttributes(){return hasRequiredAttributes||(hasRequiredAttributes=1,attributes=function(){const o=identifiers,{ruleAttributes:$,showAttributes:j,showAttributeErrors:et}=requireRuleAttributes(),{ruleDependencies:tt,showRuleDependencies:rt}=requireRuleDependencies();class nt{constructor(ot,at){this.rules=ot,this.udts=at,this.ruleCount=ot.length,this.udtCount=at.length,this.startRule=0,this.dependenciesComplete=!1,this.attributesComplete=!1,this.isMutuallyRecursive=!1,this.ruleIndexes=this.indexArray(this.ruleCount),this.ruleAlphaIndexes=this.indexArray(this.ruleCount),this.ruleTypeIndexes=this.indexArray(this.ruleCount),this.udtIndexes=this.indexArray(this.udtCount),this.udtAlphaIndexes=this.indexArray(this.udtCount),this.attrsErrorCount=0,this.attrs=[],this.attrsErrors=[],this.attrsWorking=[],this.ruleDeps=[];for(let ct=0;ct<this.ruleCount;ct+=1)this.attrs.push(this.attrGen(this.rules[ct])),this.attrsWorking.push(this.attrGen(this.rules[ct])),this.ruleDeps.push(this.rdGen(ot[ct],this.ruleCount,this.udtCount));this.compRulesAlpha=this.compRulesAlpha.bind(this),this.compUdtsAlpha=this.compUdtsAlpha.bind(this),this.compRulesType=this.compRulesType.bind(this),this.compRulesGroup=this.compRulesGroup.bind(this)}attrGen(ot){return{left:!1,nested:!1,right:!1,empty:!1,finite:!1,cyclic:!1,leaf:!1,isOpen:!1,isComplete:!1,rule:ot}}attrInit(ot){ot.left=!1,ot.nested=!1,ot.right=!1,ot.empty=!1,ot.finite=!1,ot.cyclic=!1,ot.leaf=!1,ot.isOpen=!1,ot.isComplete=!1}attrCopy(ot,at){ot.left=at.left,ot.nested=at.nested,ot.right=at.right,ot.empty=at.empty,ot.finite=at.finite,ot.cyclic=at.cyclic,ot.leaf=at.leaf,ot.isOpen=at.isOpen,ot.isComplete=at.isComplete,ot.rule=at.rule}rdGen(ot,at,ct){return{rule:ot,recursiveType:o.ATTR_N,groupNumber:-1,refersTo:this.falseArray(at),refersToUdt:this.falseArray(ct),referencedBy:this.falseArray(at)}}typeToString(ot){switch(ot){case o.ATTR_N:return" N";case o.ATTR_R:return" R";case o.ATTR_MR:return"MR";default:return"UNKNOWN"}}falseArray(ot){const at=[];if(ot>0)for(let ct=0;ct<ot;ct+=1)at.push(!1);return at}falsifyArray(ot){for(let at=0;at<ot.length;at+=1)ot[at]=!1}indexArray(ot){const at=[];if(ot>0)for(let ct=0;ct<ot;ct+=1)at.push(ct);return at}compRulesAlpha(ot,at){return this.rules[ot].lower<this.rules[at].lower?-1:this.rules[ot].lower>this.rules[at].lower?1:0}compUdtsAlpha(ot,at){return this.udts[ot].lower<this.udts[at].lower?-1:this.udts[ot].lower>this.udts[at].lower?1:0}compRulesType(ot,at){return this.ruleDeps[ot].recursiveType<this.ruleDeps[at].recursiveType?-1:this.ruleDeps[ot].recursiveType>this.ruleDeps[at].recursiveType?1:0}compRulesGroup(ot,at){if(this.ruleDeps[ot].recursiveType===o.ATTR_MR&&this.ruleDeps[at].recursiveType===o.ATTR_MR){if(this.ruleDeps[ot].groupNumber<this.ruleDeps[at].groupNumber)return-1;if(this.ruleDeps[ot].groupNumber>this.ruleDeps[at].groupNumber)return 1}return 0}}return{attributes:function(ot=[],at=[],ct=[],ut=[]){const ft=new nt(ot,at);return tt(ft),$(ft),ft.attrsErrorCount&&ut.push({line:0,char:0,msg:`${ft.attrsErrorCount} attribute errors`}),ft.attrsErrorCount},showAttributes:j,showAttributeErrors:et,showRuleDependencies:rt}}()),attributes}var showRules,hasRequiredShowRules;function requireShowRules(){return hasRequiredShowRules||(hasRequiredShowRules=1,showRules=function(){const o="show-rules.js";return function(et=[],tt=[],rt="index"){const nt="showRules";let it=[],st=[];const ot=[],at=[],ct=et,ut=tt,ft=et.length,ht=tt.length;let mt="RULE/UDT NAMES",gt;function Et(At,kt){return ct[At].lower<ct[kt].lower?-1:ct[At].lower>ct[kt].lower?1:0}function St(At,kt){return ut[At].lower<ut[kt].lower?-1:ut[At].lower>ut[kt].lower?1:0}if(!(Array.isArray(et)&&et.length))throw new Error(`${o}:${nt}: rules arg must be array with length > 0`);if(!Array.isArray(tt))throw new Error(`${o}:${nt}: udts arg must be array`);for(gt=0;gt<ft;gt+=1)ot.push(gt);if(it=ot.slice(0),it.sort(Et),ht){for(gt=0;gt<ht;gt+=1)at.push(gt);st=at.slice(0),st.sort(St)}if(rt.charCodeAt(0)===97){for(mt+=` - alphabetical by rule/UDT name
`,gt=0;gt<ft;gt+=1)mt+=`${gt}: ${it[gt]}: ${ct[it[gt]].name}
`;if(ht)for(gt=0;gt<ht;gt+=1)mt+=`${gt}: ${st[gt]}: ${ut[st[gt]].name}
`}else{for(mt+=` - ordered by rule/UDT index
`,gt=0;gt<ft;gt+=1)mt+=`${gt}: ${ct[gt].name}
`;if(ht)for(gt=0;gt<ht;gt+=1)mt+=`${gt}: ${ut[gt].name}
`}return mt}}()),showRules}var api=function _(o){const $="api.js: ",j=this,et=nodeExports,tt=converter$1,rt=requireScanner(),nt=new(requireParser()),{attributes:it,showAttributes:st,showAttributeErrors:ot,showRuleDependencies:at}=requireAttributes(),ct=requireShowRules(),ut=function(jt,Nt,It){const bt=`<span class="${et.style.CLASS_CTRLCHAR}">`,_t="</span>",$t=`<span class="${et.style.CLASS_NOMATCH}">`,Ct="</span>";let xt,vt="";const dt=!0;for(;dt&&!(!Array.isArray(jt)||jt.length===0);){if(typeof Nt!="number")throw new Error("abnfToHtml: beg must be type number");if(Nt>=jt.length)break;typeof It!="number"||Nt+It>=jt.length?xt=jt.length:xt=Nt+It;let wt=0;for(let qt=Nt;qt<xt;qt+=1){const Pt=jt[qt];if(Pt>=32&&Pt<=126)switch(wt===1?(vt+=_t,wt=0):wt===2&&(vt+=Ct,wt=0),Pt){case 32:vt+="&nbsp;";break;case 60:vt+="&lt;";break;case 62:vt+="&gt;";break;case 38:vt+="&amp;";break;case 34:vt+="&quot;";break;case 39:vt+="&#039;";break;case 92:vt+="&#092;";break;default:vt+=String.fromCharCode(Pt);break}else Pt===9||Pt===10||Pt===13?(wt===0?(vt+=bt,wt=1):wt===2&&(vt+=Ct+bt,wt=1),Pt===9&&(vt+="TAB"),Pt===10&&(vt+="LF"),Pt===13&&(vt+="CR")):(wt===0?(vt+=$t,wt=2):wt===1&&(vt+=_t+$t,wt=2),vt+=`\\x${et.utils.charToHex(Pt)}`)}wt===2&&(vt+=Ct),wt===1&&(vt+=_t);break}return vt},ft=function(jt,Nt,It){let yt="";for(let lt=Nt;lt<Nt+It;lt+=1){const pt=jt[lt];if(pt>=32&&pt<=126)yt+=String.fromCharCode(pt);else switch(pt){case 9:yt+="\\t";break;case 10:yt+="\\n";break;case 13:yt+="\\r";break;default:yt+="\\unknown";break}}return yt},ht=function(jt){let Nt="Annotated Input Grammar";return jt.forEach(It=>{Nt+=`
`,Nt+=`line no: ${It.lineNo}`,Nt+=` : char index: ${It.beginChar}`,Nt+=` : length: ${It.length}`,Nt+=` : abnf: ${ft(j.chars,It.beginChar,It.length)}`}),Nt+=`
`,Nt},mt=function(jt){let Nt="";return Nt+=`<table class="${et.style.CLASS_GRAMMAR}">
`,Nt+=`<caption>Annotated Input Grammar</caption>
`,Nt+="<tr>",Nt+="<th>line<br>no.</th><th>first<br>char</th><th><br>length</th><th><br>text</th>",Nt+=`</tr>
`,jt.forEach(yt=>{Nt+="<tr>",Nt+=`<td>${yt.lineNo}`,Nt+=`</td><td>${yt.beginChar}`,Nt+=`</td><td>${yt.length}`,Nt+=`</td><td>${ut(j.chars,yt.beginChar,yt.length)}`,Nt+="</td>",Nt+=`</tr>
`}),Nt+=`</table>
`,Nt},gt=function(jt,Nt,It,yt){const[lt]=et;let pt="";const bt=`<span class="${lt.CLASS_NOMATCH}">&raquo;</span>`;return pt+=`<p><table class="${lt.CLASS_GRAMMAR}">
`,yt&&typeof yt=="string"&&(pt+=`<caption>${yt}</caption>
`),pt+=`<tr><th>line<br>no.</th><th>line<br>offset</th><th>error<br>offset</th><th><br>text</th></tr>
`,jt.forEach(_t=>{let $t,Ct,xt,vt,dt,wt="",qt="";Nt.length===0?(dt=bt,Ct=0):($t=Nt[_t.line],xt=$t.beginChar,_t.char>xt&&(wt=ut(It,xt,_t.char-xt)),xt=_t.char,vt=$t.beginChar+$t.length,xt<vt&&(qt=ut(It,xt,vt-xt)),dt=wt+bt+qt,Ct=_t.char-$t.beginChar,pt+="<tr>",pt+=`<td>${_t.line}</td><td>${$t.beginChar}</td><td>${Ct}</td><td>${dt}</td>`,pt+=`</tr>
`,pt+="<tr>",pt+=`<td colspan="3"></td><td>&uarr;:&nbsp;${et.utils.stringToAsciiHtml(_t.msg)}</td>`,pt+=`</tr>
`)}),pt+=`</table></p>
`,pt},Et=function(jt,Nt,It){let yt,lt,pt,bt;return yt="",jt.forEach(_t=>{lt=Nt[_t.line],yt+=`${lt.lineNo}: `,yt+=`${lt.beginChar}: `,yt+=`${_t.char-lt.beginChar}: `,pt=lt.beginChar,bt=_t.char-lt.beginChar,yt+=ft(It,pt,bt),yt+=" >> ",pt=_t.char,bt=lt.beginChar+lt.length-_t.char,yt+=ft(It,pt,bt),yt+=`
`,yt+=`${lt.lineNo}: `,yt+=`${lt.beginChar}: `,yt+=`${_t.char-lt.beginChar}: `,yt+="error: ",yt+=_t.msg,yt+=`
`}),yt};let St=!1,At=!1,kt=!1,Rt=!1,Tt=0,Dt;if(this.errors=[],buffer$2.Buffer.isBuffer(o))this.chars=tt.decode("BINARY",o);else if(Array.isArray(o))this.chars=o.slice();else if(typeof o=="string")this.chars=tt.decode("STRING",o);else throw new Error(`${$}input source is not a string, byte Buffer or character array`);this.sabnf=tt.encode("STRING",this.chars),this.scan=function(jt,Nt){this.lines=rt(this.chars,this.errors,jt,Nt),St=!0},this.parse=function(jt,Nt){if(!St)throw new Error(`${$}grammar not scanned`);nt.syntax(this.chars,this.lines,this.errors,jt,Nt),At=!0},this.translate=function(){if(!At)throw new Error(`${$}grammar not scanned and parsed`);const jt=nt.semantic(this.chars,this.lines,this.errors);this.errors.length===0&&(this.rules=jt.rules,this.udts=jt.udts,Dt=jt.lineMap,kt=!0)},this.attributes=function(){if(!kt)throw new Error(`${$}grammar not scanned, parsed and translated`);return Tt=it(this.rules,this.udts,Dt,this.errors),Rt=!0,Tt},this.generate=function(jt){if(this.lines=rt(this.chars,this.errors,jt),this.errors.length||(nt.syntax(this.chars,this.lines,this.errors,jt),this.errors.length))return;const Nt=nt.semantic(this.chars,this.lines,this.errors);this.errors.length||(this.rules=Nt.rules,this.udts=Nt.udts,Dt=Nt.lineMap,Tt=it(this.rules,this.udts,Dt,this.errors),Rt=!0)},this.displayRules=function(jt="index"){if(!kt)throw new Error(`${$}grammar not scanned, parsed and translated`);return ct(this.rules,this.udts,jt)},this.displayRuleDependencies=function(jt="index"){if(!Rt)throw new Error(`${$}no attributes - must be preceeded by call to attributes()`);return at(jt)},this.displayAttributes=function(jt="index"){if(!Rt)throw new Error(`${$}no attributes - must be preceeded by call to attributes()`);return Tt&&ot(jt),st(jt)},this.displayAttributeErrors=function(){if(!Rt)throw new Error(`${$}no attributes - must be preceeded by call to attributes()`);return ot()},this.toSource=function(jt){if(!Rt)throw new Error(`${$}can't generate parser source - must be preceeded by call to attributes()`);if(Tt)throw new Error(`${$}can't generate parser source - attributes have ${Tt} errors`);return nt.generateSource(this.chars,this.lines,this.rules,this.udts,jt)},this.toObject=function(){if(!Rt)throw new Error(`${$}can't generate parser source - must be preceeded by call to attributes()`);if(Tt)throw new Error(`${$}can't generate parser source - attributes have ${Tt} errors`);return nt.generateObject(this.sabnf,this.rules,this.udts)},this.errorsToAscii=function(){return Et(this.errors,this.lines,this.chars)},this.errorsToHtml=function(jt){return gt(this.errors,this.lines,this.chars,jt)},this.linesToAscii=function(){return ht(this.lines)},this.linesToHtml=function(){return mt(this.lines)}};const GRAMMAR=`
sign-in-with-ethereum =
    domain %s" wants you to sign in with your Ethereum account:" LF
    address LF
    LF
    [ statement LF ]
    LF
    %s"URI: " URI LF
    %s"Version: " version LF
    %s"Chain ID: " chain-id LF
    %s"Nonce: " nonce LF
    %s"Issued At: " issued-at
    [ LF %s"Expiration Time: " expiration-time ]
    [ LF %s"Not Before: " not-before ]
    [ LF %s"Request ID: " request-id ]
    [ LF %s"Resources:"
    resources ]

domain = dnsauthority

address = "0x" 40*40HEXDIG
    ; Must also conform to captilization
    ; checksum encoding specified in EIP-55
    ; where applicable (EOAs).

statement = *( reserved / unreserved / " " )
    ; The purpose is to exclude LF (line breaks).

version = "1"

nonce = 8*( ALPHA / DIGIT )

issued-at = date-time
expiration-time = date-time
not-before = date-time

request-id = *pchar

chain-id = 1*DIGIT
    ; See EIP-155 for valid CHAIN_IDs.

resources = *( LF resource )

resource = "- " URI

; ------------------------------------------------------------------------------
; RFC 3986

URI           = scheme ":" hier-part [ "?" query ] [ "#" fragment ]

hier-part     = "//" authority path-abempty
              / path-absolute
              / path-rootless
              / path-empty

scheme        = ALPHA *( ALPHA / DIGIT / "+" / "-" / "." )

authority     = [ userinfo "@" ] host [ ":" port ]
userinfo      = *( unreserved / pct-encoded / sub-delims / ":" )
host          = IP-literal / IPv4address / reg-name
port          = *DIGIT

IP-literal    = "[" ( IPv6address / IPvFuture  ) "]"

IPvFuture     = "v" 1*HEXDIG "." 1*( unreserved / sub-delims / ":" )

IPv6address   =                            6( h16 ":" ) ls32
              /                       "::" 5( h16 ":" ) ls32
              / [               h16 ] "::" 4( h16 ":" ) ls32
              / [ *1( h16 ":" ) h16 ] "::" 3( h16 ":" ) ls32
              / [ *2( h16 ":" ) h16 ] "::" 2( h16 ":" ) ls32
              / [ *3( h16 ":" ) h16 ] "::"    h16 ":"   ls32
              / [ *4( h16 ":" ) h16 ] "::"              ls32
              / [ *5( h16 ":" ) h16 ] "::"              h16
              / [ *6( h16 ":" ) h16 ] "::"

h16           = 1*4HEXDIG
ls32          = ( h16 ":" h16 ) / IPv4address
IPv4address   = dec-octet "." dec-octet "." dec-octet "." dec-octet
dec-octet     = DIGIT                 ; 0-9
                 / %x31-39 DIGIT         ; 10-99
                 / "1" 2DIGIT            ; 100-199
                 / "2" %x30-34 DIGIT     ; 200-249
                 / "25" %x30-35          ; 250-255

reg-name      = *( unreserved / pct-encoded / sub-delims )

path-abempty  = *( "/" segment )
path-absolute = "/" [ segment-nz *( "/" segment ) ]
path-rootless = segment-nz *( "/" segment )
path-empty    = 0pchar

segment       = *pchar
segment-nz    = 1*pchar

pchar         = unreserved / pct-encoded / sub-delims / ":" / "@"

query         = *( pchar / "/" / "?" )

fragment      = *( pchar / "/" / "?" )

pct-encoded   = "%" HEXDIG HEXDIG

unreserved    = ALPHA / DIGIT / "-" / "." / "_" / "~"
reserved      = gen-delims / sub-delims
gen-delims    = ":" / "/" / "?" / "#" / "[" / "]" / "@"
sub-delims    = "!" / "$" / "&" / "'" / "(" / ")"
              / "*" / "+" / "," / ";" / "="

; ------------------------------------------------------------------------------
; RFC 4501

dnsauthority    = host [ ":" port ]
                             ; See RFC 3986 for the
                             ; definition of "host" and "port".

; ------------------------------------------------------------------------------
; RFC 3339

date-fullyear   = 4DIGIT
date-month      = 2DIGIT  ; 01-12
date-mday       = 2DIGIT  ; 01-28, 01-29, 01-30, 01-31 based on
                          ; month/year
time-hour       = 2DIGIT  ; 00-23
time-minute     = 2DIGIT  ; 00-59
time-second     = 2DIGIT  ; 00-58, 00-59, 00-60 based on leap second
                          ; rules
time-secfrac    = "." 1*DIGIT
time-numoffset  = ("+" / "-") time-hour ":" time-minute
time-offset     = "Z" / time-numoffset

partial-time    = time-hour ":" time-minute ":" time-second
                  [time-secfrac]
full-date       = date-fullyear "-" date-month "-" date-mday
full-time       = partial-time time-offset

date-time       = full-date "T" full-time

; ------------------------------------------------------------------------------
; RFC 5234

ALPHA          =  %x41-5A / %x61-7A   ; A-Z / a-z
LF             =  %x0A
                  ; linefeed
DIGIT          =  %x30-39
                  ; 0-9
HEXDIG         =  DIGIT / "A" / "B" / "C" / "D" / "E" / "F"
`;class ParsedMessage{constructor(o){const $=new api(GRAMMAR);if($.generate(),$.errors.length)throw console.error($.errorsToAscii()),console.error($.linesToAscii()),console.log($.displayAttributeErrors()),new Error("ABNF grammar has errors");const j=$.toObject(),et=new nodeExports.parser;et.ast=new nodeExports.ast;const tt=nodeExports.ids,rt=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.domain=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks.domain=rt;const nt=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.address=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks.address=nt;const it=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.statement=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks.statement=it;const st=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.uri||(Dt.uri=nodeExports.utils.charsToString(kt,Rt,Tt))),Ot};et.ast.callbacks.uri=st;const ot=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.version=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks.version=ot;const at=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.chainId=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks["chain-id"]=at;const ct=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.nonce=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks.nonce=ct;const ut=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.issuedAt=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks["issued-at"]=ut;const ft=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.expirationTime=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks["expiration-time"]=ft;const ht=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.notBefore=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks["not-before"]=ht;const mt=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.requestId=nodeExports.utils.charsToString(kt,Rt,Tt)),Ot};et.ast.callbacks["request-id"]=mt;const gt=function(At,kt,Rt,Tt,Dt){const Ot=tt.SEM_OK;return At===tt.SEM_PRE&&(Dt.resources=nodeExports.utils.charsToString(kt,Rt,Tt).slice(3).split(`
- `)),Ot};et.ast.callbacks.resources=gt;const Et=et.parse(j,"sign-in-with-ethereum",o);if(!Et.success)throw new Error(`Invalid message: ${JSON.stringify(Et)}`);const St={};et.ast.translate(St);for(const[At,kt]of Object.entries(St))this[At]=kt}}function _extends(){return _extends=Object.assign||function(_){for(var o=1;o<arguments.length;o++){var $=arguments[o];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends.apply(this,arguments)}var CAIP2={name:"chainId",regex:"[-:a-zA-Z0-9]{5,41}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"}}}},CAIP10={name:"accountId",regex:"[-:a-zA-Z0-9]{7,106}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"},2:{name:"address",regex:"[a-zA-Z0-9]{1,64}"}}}},AssetName$1={name:"assetName",regex:"[-:a-zA-Z0-9]{5,73}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,64}"}}}},CAIP19AssetType={name:"assetType",regex:"[-:a-zA-Z0-9]{11,115}",parameters:{delimiter:"/",values:{0:CAIP2,1:AssetName$1}}},CAIP19AssetId={name:"assetId",regex:"[-:a-zA-Z0-9]{13,148}",parameters:{delimiter:"/",values:{0:CAIP2,1:AssetName$1,2:{name:"tokenId",regex:"[-a-zA-Z0-9]{1,32}"}}}},CAIP={2:CAIP2,10:CAIP10,19:{assetName:AssetName$1,assetType:CAIP19AssetType,assetId:CAIP19AssetId}};function splitParams(_,o){return _.split(o.parameters.delimiter)}function getParams(_,o){var $=splitParams(_,o),j={};return $.forEach(function(et,tt){j[o.parameters.values[tt].name]=et}),j}function joinParams(_,o){return Object.values(o.parameters.values).map(function($){var j=_[$.name];return typeof j=="string"?j:joinParams(j,$)}).join(o.parameters.delimiter)}function isValidId(_,o){if(!new RegExp(o.regex).test(_))return!1;var $=splitParams(_,o);if($.length!==Object.keys(o.parameters.values).length)return!1;var j=$.map(function(et,tt){return new RegExp(o.parameters.values[tt].regex).test(et)}).filter(function(et){return!!et});return j.length===$.length}var ChainId=function(){function _($){typeof $=="string"&&($=_.parse($)),this.namespace=$.namespace,this.reference=$.reference}_.parse=function(j){if(!isValidId(j,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+j);return new _(getParams(j,this.spec)).toJSON()},_.format=function(j){return joinParams(j,this.spec)};var o=_.prototype;return o.toString=function(){return _.format(this.toJSON())},o.toJSON=function(){return{namespace:this.namespace,reference:this.reference}},_}();ChainId.spec=CAIP[2];var AccountId=function(){function _($){typeof $=="string"&&($=_.parse($)),this.chainId=new ChainId($.chainId),this.address=$.address}_.parse=function(j){if(!isValidId(j,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+j);var et=getParams(j,this.spec),tt=et.namespace,rt=et.reference,nt=et.address,it=new ChainId({namespace:tt,reference:rt});return new _({chainId:it,address:nt}).toJSON()},_.format=function(j){var et=new ChainId(j.chainId),tt=_extends({},et.toJSON(),{address:j.address});return joinParams(tt,this.spec)};var o=_.prototype;return o.toString=function(){return _.format(this.toJSON())},o.toJSON=function(){return{chainId:this.chainId.toJSON(),address:this.address}},_}();AccountId.spec=CAIP[10];var ErrorTypes;(function(_){_.INVALID_SIGNATURE="Invalid signature.",_.EXPIRED_MESSAGE="Expired message.",_.MALFORMED_SESSION="Malformed session."})(ErrorTypes||(ErrorTypes={}));var SignatureType;(function(_){_.PERSONAL_SIGNATURE="Personal signature"})(SignatureType||(SignatureType={}));class SiwxMessage{static fromCacao(o){const $=AccountId.parse(o.p.iss.replace("did:pkh:","")),j=new this({domain:o.p.domain,address:$.address,uri:o.p.aud,version:o.p.version,chainId:new ChainId($.chainId).reference});return o.p.statement&&(j.statement=o.p.statement),o.p.nonce&&(j.nonce=o.p.nonce),o.p.iat&&(j.issuedAt=o.p.iat),o.p.exp&&(j.expirationTime=o.p.exp),o.p.nbf&&(j.notBefore=o.p.nbf),o.p.requestId&&(j.requestId=o.p.requestId),o.p.resources&&(j.resources=o.p.resources),o.s&&(o.s.s&&(j.signature=o.s.s),o.s.t==="eip191"&&(j.type=SignatureType.PERSONAL_SIGNATURE)),j}toMessage(o){return asString(this,o)}constructor(o){if(this.statement=void 0,this.nonce=void 0,this.issuedAt=void 0,this.expirationTime=void 0,this.notBefore=void 0,this.requestId=void 0,this.resources=void 0,this.signature=void 0,typeof o=="string"){const $=new ParsedMessage(o);this.domain=$.domain,this.address=$.address,this.statement=$.statement,this.uri=$.uri,this.version=$.version,this.nonce=$.nonce,this.issuedAt=$.issuedAt,this.expirationTime=$.expirationTime,this.notBefore=$.notBefore,this.requestId=$.requestId,this.chainId=$.chainId,this.resources=$.resources}else Object.assign(this,o)}}function asLegacyChainIdString(_,o){const $=`${_.domain} wants you to sign in with your ${o} account:`,j=`URI: ${_.uri}`;let et=[$,_.address].join(`
`);const tt=`Version: ${_.version}`;_.nonce||(_.nonce=(Math.random()+1).toString(36).substring(4));const rt=`Nonce: ${_.nonce}`,nt=[j,tt,rt];if(_.issuedAt&&Date.parse(_.issuedAt),_.issuedAt=_.issuedAt?_.issuedAt:new Date().toISOString(),nt.push(`Issued At: ${_.issuedAt}`),_.expirationTime){const st=`Expiration Time: ${_.expirationTime}`;nt.push(st)}_.notBefore&&nt.push(`Not Before: ${_.notBefore}`),_.requestId&&nt.push(`Request ID: ${_.requestId}`),_.chainId&&nt.push(`Chain ID: ${_.chainId}`),_.resources&&nt.push(["Resources:",..._.resources.map(st=>`- ${st}`)].join(`
`));const it=nt.join(`
`);return _.statement&&(et=[et,_.statement].join(`

`)),[et,it].join(`

`)}function asString(_,o){const $=`${_.domain} wants you to sign in with your ${o} account:`,j=`URI: ${_.uri}`;let et=[$,_.address].join(`
`);const tt=`Version: ${_.version}`;_.nonce||(_.nonce=(Math.random()+1).toString(36).substring(4));const rt=`Nonce: ${_.nonce}`,nt=`Chain ID: ${_.chainId}`,it=[j,tt,nt,rt];if(_.issuedAt&&Date.parse(_.issuedAt),_.issuedAt=_.issuedAt?_.issuedAt:new Date().toISOString(),it.push(`Issued At: ${_.issuedAt}`),_.expirationTime){const ot=`Expiration Time: ${_.expirationTime}`;it.push(ot)}_.notBefore&&it.push(`Not Before: ${_.notBefore}`),_.requestId&&it.push(`Request ID: ${_.requestId}`),_.resources&&_.resources.length>=1&&it.push(["Resources:",..._.resources.map(ot=>`- ${ot}`)].join(`
`));const st=it.join(`
`);return _.statement&&(et=[et,_.statement].join(`

`)),[et,st].join(`

`)}class SiweMessage extends SiwxMessage{toMessage(){return super.toMessage("Ethereum")}signMessage(){let o;switch(this.type){case SignatureType.PERSONAL_SIGNATURE:{o=this.toMessage();break}default:{o=this.toMessage();break}}return o}}var encode_1$2=encode$k,MSB$5=128,REST$5=127,MSBALL$2=~REST$5,INT$2=Math.pow(2,31);function encode$k(_,o,$){o=o||[],$=$||0;for(var j=$;_>=INT$2;)o[$++]=_&255|MSB$5,_/=128;for(;_&MSBALL$2;)o[$++]=_&255|MSB$5,_>>>=7;return o[$]=_|0,encode$k.bytes=$-j+1,o}var decode$g=read$4,MSB$1$1=128,REST$1$1=127;function read$4(_,j){var $=0,j=j||0,et=0,tt=j,rt,nt=_.length;do{if(tt>=nt)throw read$4.bytes=0,new RangeError("Could not decode varint");rt=_[tt++],$+=et<28?(rt&REST$1$1)<<et:(rt&REST$1$1)*Math.pow(2,et),et+=7}while(rt>=MSB$1$1);return read$4.bytes=tt-j,$}var N1$3=Math.pow(2,7),N2$3=Math.pow(2,14),N3$3=Math.pow(2,21),N4$3=Math.pow(2,28),N5$3=Math.pow(2,35),N6$3=Math.pow(2,42),N7$3=Math.pow(2,49),N8$3=Math.pow(2,56),N9$3=Math.pow(2,63),length$4=function(_){return _<N1$3?1:_<N2$3?2:_<N3$3?3:_<N4$3?4:_<N5$3?5:_<N6$3?6:_<N7$3?7:_<N8$3?8:_<N9$3?9:10},varint$3={encode:encode_1$2,decode:decode$g,encodingLength:length$4},_brrp_varint=varint$3;const decode$f=(_,o=0)=>[_brrp_varint.decode(_,o),_brrp_varint.decode.bytes],encodeTo=(_,o,$=0)=>(_brrp_varint.encode(_,o,$),o),encodingLength=_=>_brrp_varint.encodingLength(_),equals$1=(_,o)=>{if(_===o)return!0;if(_.byteLength!==o.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==o[$])return!1;return!0},coerce=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},create$6=(_,o)=>{const $=o.byteLength,j=encodingLength(_),et=j+encodingLength($),tt=new Uint8Array(et+$);return encodeTo(_,tt,0),encodeTo($,tt,j),tt.set(o,et),new Digest(_,$,o,tt)},decode$e=_=>{const o=coerce(_),[$,j]=decode$f(o),[et,tt]=decode$f(o.subarray(j)),rt=o.subarray(j+tt);if(rt.byteLength!==et)throw new Error("Incorrect length");return new Digest($,et,rt,o)},equals=(_,o)=>_===o?!0:_.code===o.code&&_.size===o.size&&equals$1(_.bytes,o.bytes);class Digest{constructor(o,$,j,et){this.code=o,this.size=$,this.digest=j,this.bytes=et}}function base$2(_,o){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var et=0;et<_.length;et++){var tt=_.charAt(et),rt=tt.charCodeAt(0);if($[rt]!==255)throw new TypeError(tt+" is ambiguous");$[rt]=et}var nt=_.length,it=_.charAt(0),st=Math.log(nt)/Math.log(256),ot=Math.log(256)/Math.log(nt);function at(ft){if(ft instanceof Uint8Array||(ArrayBuffer.isView(ft)?ft=new Uint8Array(ft.buffer,ft.byteOffset,ft.byteLength):Array.isArray(ft)&&(ft=Uint8Array.from(ft))),!(ft instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ft.length===0)return"";for(var ht=0,mt=0,gt=0,Et=ft.length;gt!==Et&&ft[gt]===0;)gt++,ht++;for(var St=(Et-gt)*ot+1>>>0,At=new Uint8Array(St);gt!==Et;){for(var kt=ft[gt],Rt=0,Tt=St-1;(kt!==0||Rt<mt)&&Tt!==-1;Tt--,Rt++)kt+=256*At[Tt]>>>0,At[Tt]=kt%nt>>>0,kt=kt/nt>>>0;if(kt!==0)throw new Error("Non-zero carry");mt=Rt,gt++}for(var Dt=St-mt;Dt!==St&&At[Dt]===0;)Dt++;for(var Ot=it.repeat(ht);Dt<St;++Dt)Ot+=_.charAt(At[Dt]);return Ot}function ct(ft){if(typeof ft!="string")throw new TypeError("Expected String");if(ft.length===0)return new Uint8Array;var ht=0;if(ft[ht]!==" "){for(var mt=0,gt=0;ft[ht]===it;)mt++,ht++;for(var Et=(ft.length-ht)*st+1>>>0,St=new Uint8Array(Et);ft[ht];){var At=$[ft.charCodeAt(ht)];if(At===255)return;for(var kt=0,Rt=Et-1;(At!==0||kt<gt)&&Rt!==-1;Rt--,kt++)At+=nt*St[Rt]>>>0,St[Rt]=At%256>>>0,At=At/256>>>0;if(At!==0)throw new Error("Non-zero carry");gt=kt,ht++}if(ft[ht]!==" "){for(var Tt=Et-gt;Tt!==Et&&St[Tt]===0;)Tt++;for(var Dt=new Uint8Array(mt+(Et-Tt)),Ot=mt;Tt!==Et;)Dt[Ot++]=St[Tt++];return Dt}}}function ut(ft){var ht=ct(ft);if(ht)return ht;throw new Error(`Non-${o} character`)}return{encode:at,decodeUnsafe:ct,decode:ut}}var src$4=base$2,_brrp__multiformats_scope_baseX=src$4;let Encoder$2=class{constructor(o,$,j){this.name=o,this.prefix=$,this.baseEncode=j}encode(o){if(o instanceof Uint8Array)return`${this.prefix}${this.baseEncode(o)}`;throw Error("Unknown type, must be binary type")}},Decoder$2=class{constructor(o,$,j){if(this.name=o,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(o){if(typeof o=="string"){if(o.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(o)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(o.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(o){return or$1(this,o)}};class ComposedDecoder{constructor(o){this.decoders=o}or(o){return or$1(this,o)}decode(o){const $=o[0],j=this.decoders[$];if(j)return j.decode(o);throw RangeError(`Unable to decode multibase string ${JSON.stringify(o)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or$1=(_,o)=>new ComposedDecoder({..._.decoders||{[_.prefix]:_},...o.decoders||{[o.prefix]:o}});class Codec{constructor(o,$,j,et){this.name=o,this.prefix=$,this.baseEncode=j,this.baseDecode=et,this.encoder=new Encoder$2(o,$,j),this.decoder=new Decoder$2(o,$,et)}encode(o){return this.encoder.encode(o)}decode(o){return this.decoder.decode(o)}}const from$1=({name:_,prefix:o,encode:$,decode:j})=>new Codec(_,o,$,j),baseX=({prefix:_,name:o,alphabet:$})=>{const{encode:j,decode:et}=_brrp__multiformats_scope_baseX($,o);return from$1({prefix:_,name:o,encode:j,decode:tt=>coerce(et(tt))})},decode$d=(_,o,$,j)=>{const et={};for(let ot=0;ot<o.length;++ot)et[o[ot]]=ot;let tt=_.length;for(;_[tt-1]==="=";)--tt;const rt=new Uint8Array(tt*$/8|0);let nt=0,it=0,st=0;for(let ot=0;ot<tt;++ot){const at=et[_[ot]];if(at===void 0)throw new SyntaxError(`Non-${j} character`);it=it<<$|at,nt+=$,nt>=8&&(nt-=8,rt[st++]=255&it>>nt)}if(nt>=$||255&it<<8-nt)throw new SyntaxError("Unexpected end of data");return rt},encode$j=(_,o,$)=>{const j=o[o.length-1]==="=",et=(1<<$)-1;let tt="",rt=0,nt=0;for(let it=0;it<_.length;++it)for(nt=nt<<8|_[it],rt+=8;rt>$;)rt-=$,tt+=o[et&nt>>rt];if(rt&&(tt+=o[et&nt<<$-rt]),j)for(;tt.length*$&7;)tt+="=";return tt},rfc4648=({name:_,prefix:o,bitsPerChar:$,alphabet:j})=>from$1({prefix:o,name:_,encode(et){return encode$j(et,j,$)},decode(et){return decode$d(et,j,$,_)}}),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});const base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});class CID{constructor(o,$,j,et){this.code=$,this.version=o,this.multihash=j,this.bytes=et,this.byteOffset=et.byteOffset,this.byteLength=et.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:hidden,byteLength:hidden,code:readonly$1,version:readonly$1,multihash:readonly$1,bytes:readonly$1,_baseCache:hidden,asCID:hidden})}toV0(){switch(this.version){case 0:return this;default:{const{code:o,multihash:$}=this;if(o!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if($.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0($)}}}toV1(){switch(this.version){case 0:{const{code:o,digest:$}=this.multihash,j=create$6(o,$);return CID.createV1(this.code,j)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(o){return o&&this.code===o.code&&this.version===o.version&&equals(this.multihash,o.multihash)}toString(o){const{bytes:$,version:j,_baseCache:et}=this;switch(j){case 0:return toStringV0($,et,o||base58btc.encoder);default:return toStringV1($,et,o||base32.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(o){return deprecate(/^0\.0/,IS_CID_DEPRECATION),!!(o&&(o[cidSymbol]||o.asCID===o))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(o){if(o instanceof CID)return o;if(o!=null&&o.asCID===o){const{version:$,code:j,multihash:et,bytes:tt}=o;return new CID($,j,et,tt||encodeCID$1($,j,et.bytes))}else if(o!=null&&o[cidSymbol]===!0){const{version:$,multihash:j,code:et}=o,tt=decode$e(j);return CID.create($,et,tt)}else return null}static create(o,$,j){if(typeof $!="number")throw new Error("String codecs are no longer supported");switch(o){case 0:{if($!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(o,$,j,j.bytes)}case 1:{const et=encodeCID$1(o,$,j.bytes);return new CID(o,$,j,et)}default:throw new Error("Invalid version")}}static createV0(o){return CID.create(0,DAG_PB_CODE,o)}static createV1(o,$){return CID.create(1,o,$)}static decode(o){const[$,j]=CID.decodeFirst(o);if(j.length)throw new Error("Incorrect length");return $}static decodeFirst(o){const $=CID.inspectBytes(o),j=$.size-$.multihashSize,et=coerce(o.subarray(j,j+$.multihashSize));if(et.byteLength!==$.multihashSize)throw new Error("Incorrect length");const tt=et.subarray($.multihashSize-$.digestSize),rt=new Digest($.multihashCode,$.digestSize,tt,et);return[$.version===0?CID.createV0(rt):CID.createV1($.codec,rt),o.subarray($.size)]}static inspectBytes(o){let $=0;const j=()=>{const[at,ct]=decode$f(o.subarray($));return $+=ct,at};let et=j(),tt=DAG_PB_CODE;if(et===18?(et=0,$=0):et===1&&(tt=j()),et!==0&&et!==1)throw new RangeError(`Invalid CID version ${et}`);const rt=$,nt=j(),it=j(),st=$+it,ot=st-rt;return{version:et,codec:tt,multihashCode:nt,digestSize:it,multihashSize:ot,size:st}}static parse(o,$){const[j,et]=parseCIDtoBytes(o,$),tt=CID.decode(et);return tt._baseCache.set(j,o),tt}}const parseCIDtoBytes=(_,o)=>{switch(_[0]){case"Q":{const $=o||base58btc;return[base58btc.prefix,$.decode(`${base58btc.prefix}${_}`)]}case base58btc.prefix:{const $=o||base58btc;return[base58btc.prefix,$.decode(_)]}case base32.prefix:{const $=o||base32;return[base32.prefix,$.decode(_)]}default:{if(o==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[_[0],o.decode(_)]}}},toStringV0=(_,o,$)=>{const{prefix:j}=$;if(j!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${$.name} encoding`);const et=o.get(j);if(et==null){const tt=$.encode(_).slice(1);return o.set(j,tt),tt}else return et},toStringV1=(_,o,$)=>{const{prefix:j}=$,et=o.get(j);if(et==null){const tt=$.encode(_);return o.set(j,tt),tt}else return et},DAG_PB_CODE=112,SHA_256_CODE=18,encodeCID$1=(_,o,$)=>{const j=encodingLength(_),et=j+encodingLength(o),tt=new Uint8Array(et+$.byteLength);return encodeTo(_,tt,0),encodeTo(o,tt,j),tt.set($,et),tt},cidSymbol=Symbol.for("@ipld/js-cid/CID"),readonly$1={writable:!1,configurable:!1,enumerable:!0},hidden={writable:!1,enumerable:!1,configurable:!1},version$k="0.0.0-dev",deprecate=(_,o)=>{if(_.test(version$k))console.warn(o);else throw new Error(o)},IS_CID_DEPRECATION=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,CID_CBOR_TAG=42;function cidEncoder$1(_){if(_.asCID!==_)return null;const o=CID.asCID(_);if(!o)return null;const $=new Uint8Array(o.bytes.byteLength+1);return $.set(o.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,$)]}function undefinedEncoder$1(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$1(_){if(Number.isNaN(_))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(_===1/0||_===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions$1={float64:!0,typeEncoders:{Object:cidEncoder$1,undefined:undefinedEncoder$1,number:numberEncoder$1}};function cidDecoder(_){if(_[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID.decode(_.subarray(1))}const decodeOptions$1={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};decodeOptions$1.tags[CID_CBOR_TAG]=cidDecoder;const name$3="dag-cbor",code$2=113,encode$i=_=>encode$A(_,encodeOptions$1),decode$c=_=>decode$x(_,decodeOptions$1),dagCbor=Object.freeze(Object.defineProperty({__proto__:null,code:code$2,decode:decode$c,encode:encode$i,name:name$3},Symbol.toStringTag,{value:"Module"})),from=({name:_,code:o,encode:$})=>new Hasher(_,o,$);class Hasher{constructor(o,$,j){this.name=o,this.code=$,this.encode=j}digest(o){if(o instanceof Uint8Array){const $=this.encode(o);return $ instanceof Uint8Array?create$6(this.code,$):$.then(j=>create$6(this.code,j))}else throw Error("Unknown type, must be binary type")}}const readonly=({enumerable:_=!0,configurable:o=!1}={})=>({enumerable:_,configurable:o,writable:!1}),links$1=function*(_,o){if(_!=null&&!(_ instanceof Uint8Array))for(const[$,j]of Object.entries(_)){const et=[...o,$];if(j!=null&&typeof j=="object")if(Array.isArray(j))for(const[tt,rt]of j.entries()){const nt=[...et,tt],it=CID.asCID(rt);it?yield[nt.join("/"),it]:typeof rt=="object"&&(yield*links$1(rt,nt))}else{const tt=CID.asCID(j);tt?yield[et.join("/"),tt]:yield*links$1(j,et)}}},tree=function*(_,o){if(_!=null)for(const[$,j]of Object.entries(_)){const et=[...o,$];if(yield et.join("/"),j!=null&&!(j instanceof Uint8Array)&&typeof j=="object"&&!CID.asCID(j))if(Array.isArray(j))for(const[tt,rt]of j.entries()){const nt=[...et,tt];yield nt.join("/"),typeof rt=="object"&&!CID.asCID(rt)&&(yield*tree(rt,nt))}else yield*tree(j,et)}},get$2=(_,o)=>{let $=_;for(const[j,et]of o.entries()){if($=$[et],$==null)throw new Error(`Object has no property at ${o.slice(0,j+1).map(rt=>`[${JSON.stringify(rt)}]`).join("")}`);const tt=CID.asCID($);if(tt)return{value:tt,remaining:o.slice(j+1).join("/")}}return{value:$}};class Block{constructor({cid:o,bytes:$,value:j}){if(!o||!$||typeof j>"u")throw new Error("Missing required argument");this.cid=o,this.bytes=$,this.value=j,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links$1(this.value,[])}tree(){return tree(this.value,[])}get(o="/"){return get$2(this.value,o.split("/").filter(Boolean))}}const encode$h=async({value:_,codec:o,hasher:$})=>{if(typeof _>"u")throw new Error('Missing required argument "value"');if(!o||!$)throw new Error("Missing required argument: codec or hasher");const j=o.encode(_),et=await $.digest(j),tt=CID.create(1,o.code,et);return new Block({value:_,bytes:j,cid:tt})},decode$b=async({bytes:_,codec:o,hasher:$})=>{if(!_)throw new Error('Missing required argument "bytes"');if(!o||!$)throw new Error("Missing required argument: codec or hasher");const j=o.decode(_),et=await $.digest(_),tt=CID.create(1,o.code,et);return new Block({value:j,bytes:_,cid:tt})},sha=_=>async o=>new Uint8Array(await crypto.subtle.digest(_,o)),sha256$1=from({name:"sha2-256",code:18,encode:sha("SHA-256")}),CLOCK_SKEW_DEFAULT_SEC=5*60;new Date("2022-09-20").valueOf();var Cacao;(function(_){function o(nt){const it={h:{t:"eip4361"},p:{domain:nt.domain,iat:nt.issuedAt,iss:`did:pkh:eip155:${nt.chainId}:${nt.address}`,aud:nt.uri,version:nt.version,nonce:nt.nonce}};return nt.signature&&(it.s={t:"eip191",s:nt.signature}),nt.notBefore&&(it.p.nbf=nt.notBefore),nt.expirationTime&&(it.p.exp=nt.expirationTime),nt.statement&&(it.p.statement=nt.statement),nt.requestId&&(it.p.requestId=nt.requestId),nt.resources&&(it.p.resources=nt.resources),it}_.fromSiweMessage=o;function $(nt){const it={h:{t:"caip122"},p:{domain:nt.domain,iat:nt.issuedAt,iss:`did:pkh:solana:${nt.chainId}:${nt.address}`,aud:nt.uri,version:nt.version,nonce:nt.nonce}};return nt.signature&&(it.s={t:"solana:ed25519",s:nt.signature}),nt.notBefore&&(it.p.nbf=nt.notBefore),nt.expirationTime&&(it.p.exp=nt.expirationTime),nt.statement&&(it.p.statement=nt.statement),nt.requestId&&(it.p.requestId=nt.requestId),nt.resources&&(it.p.resources=nt.resources),it}_.fromSiwsMessage=$;function j(nt){const it={h:{t:"caip122"},p:{domain:nt.domain,iat:nt.issuedAt,iss:`did:pkh:tezos:${nt.chainId}:${nt.address}`,aud:nt.uri,version:nt.version,nonce:nt.nonce}};return nt.signature&&(it.s={t:"tezos:ed25519",s:nt.signature}),nt.notBefore&&(it.p.nbf=nt.notBefore),nt.expirationTime&&(it.p.exp=nt.expirationTime),nt.statement&&(it.p.statement=nt.statement),nt.requestId&&(it.p.requestId=nt.requestId),nt.resources&&(it.p.resources=nt.resources),it}_.fromSiwTezosMessage=j;function et(nt){const it={h:{t:"caip122"},p:{domain:nt.domain,iat:nt.issuedAt,iss:`did:pkh:stacks:${nt.chainId}:${nt.address}`,aud:nt.uri,version:nt.version,nonce:nt.nonce}};return nt.signature&&(it.s={t:"stacks:secp256k1",s:nt.signature}),nt.notBefore&&(it.p.nbf=nt.notBefore),nt.expirationTime&&(it.p.exp=nt.expirationTime),nt.statement&&(it.p.statement=nt.statement),nt.requestId&&(it.p.requestId=nt.requestId),nt.resources&&(it.p.resources=nt.resources),it}_.fromSiwStacksMessage=et;async function tt(nt){return(await decode$b({bytes:nt,codec:dagCbor,hasher:sha256$1})).value}_.fromBlockBytes=tt;async function rt(nt,it={}){assertSigned(nt);const st=it.verifiers[nt.s.t];if(!st)throw new Error("Unsupported CACAO signature type, register the needed verifier");return st(nt,it)}_.verify=rt})(Cacao||(Cacao={}));var CacaoBlock;(function(_){function o($){return encode$h({value:$,codec:dagCbor,hasher:sha256$1})}_.fromCacao=o})(CacaoBlock||(CacaoBlock={}));function assertSigned(_){if(_.s===null||_.s===void 0)throw new Error("CACAO does not have a signature")}function verifyTimeChecks(_,o){const $=o.atTime?o.atTime.getTime():Date.now(),j=(o.clockSkewSecs??CLOCK_SKEW_DEFAULT_SEC)*1e3;if(Date.parse(_.p.iat)>$+j||Date.parse(_.p.nbf)>$+j)throw new Error("CACAO is not valid yet");const et=o.revocationPhaseOutSecs?o.revocationPhaseOutSecs*1e3:0;if(!o.disableExpirationCheck&&Date.parse(_.p.exp)+et+j<$)throw new Error("CACAO has expired")}const version$j="logger/5.7.0";let _permanentCensorErrors=!1,_censorErrors=!1;const LogLevels={debug:1,default:2,info:2,warning:3,error:4,off:5};let _logLevel=LogLevels.default,_globalLogger=null;function _checkNormalize(){try{const _=[];if(["NFD","NFC","NFKD","NFKC"].forEach(o=>{try{if("test".normalize(o)!=="test")throw new Error("bad normalize")}catch{_.push(o)}}),_.length)throw new Error("missing "+_.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(_){return _.message}return null}const _normalizeError=_checkNormalize();var LogLevel;(function(_){_.DEBUG="DEBUG",_.INFO="INFO",_.WARNING="WARNING",_.ERROR="ERROR",_.OFF="OFF"})(LogLevel||(LogLevel={}));var ErrorCode;(function(_){_.UNKNOWN_ERROR="UNKNOWN_ERROR",_.NOT_IMPLEMENTED="NOT_IMPLEMENTED",_.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",_.NETWORK_ERROR="NETWORK_ERROR",_.SERVER_ERROR="SERVER_ERROR",_.TIMEOUT="TIMEOUT",_.BUFFER_OVERRUN="BUFFER_OVERRUN",_.NUMERIC_FAULT="NUMERIC_FAULT",_.MISSING_NEW="MISSING_NEW",_.INVALID_ARGUMENT="INVALID_ARGUMENT",_.MISSING_ARGUMENT="MISSING_ARGUMENT",_.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",_.CALL_EXCEPTION="CALL_EXCEPTION",_.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",_.NONCE_EXPIRED="NONCE_EXPIRED",_.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",_.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",_.TRANSACTION_REPLACED="TRANSACTION_REPLACED",_.ACTION_REJECTED="ACTION_REJECTED"})(ErrorCode||(ErrorCode={}));const HEX="0123456789abcdef";class Logger{constructor(o){Object.defineProperty(this,"version",{enumerable:!0,value:o,writable:!1})}_log(o,$){const j=o.toLowerCase();LogLevels[j]==null&&this.throwArgumentError("invalid log level name","logLevel",o),!(_logLevel>LogLevels[j])&&console.log.apply(console,$)}debug(...o){this._log(Logger.levels.DEBUG,o)}info(...o){this._log(Logger.levels.INFO,o)}warn(...o){this._log(Logger.levels.WARNING,o)}makeError(o,$,j){if(_censorErrors)return this.makeError("censored error",$,{});$||($=Logger.errors.UNKNOWN_ERROR),j||(j={});const et=[];Object.keys(j).forEach(it=>{const st=j[it];try{if(st instanceof Uint8Array){let ot="";for(let at=0;at<st.length;at++)ot+=HEX[st[at]>>4],ot+=HEX[st[at]&15];et.push(it+"=Uint8Array(0x"+ot+")")}else et.push(it+"="+JSON.stringify(st))}catch{et.push(it+"="+JSON.stringify(j[it].toString()))}}),et.push(`code=${$}`),et.push(`version=${this.version}`);const tt=o;let rt="";switch($){case ErrorCode.NUMERIC_FAULT:{rt="NUMERIC_FAULT";const it=o;switch(it){case"overflow":case"underflow":case"division-by-zero":rt+="-"+it;break;case"negative-power":case"negative-width":rt+="-unsupported";break;case"unbound-bitwise-result":rt+="-unbound-result";break}break}case ErrorCode.CALL_EXCEPTION:case ErrorCode.INSUFFICIENT_FUNDS:case ErrorCode.MISSING_NEW:case ErrorCode.NONCE_EXPIRED:case ErrorCode.REPLACEMENT_UNDERPRICED:case ErrorCode.TRANSACTION_REPLACED:case ErrorCode.UNPREDICTABLE_GAS_LIMIT:rt=$;break}rt&&(o+=" [ See: https://links.ethers.org/v5-errors-"+rt+" ]"),et.length&&(o+=" ("+et.join(", ")+")");const nt=new Error(o);return nt.reason=tt,nt.code=$,Object.keys(j).forEach(function(it){nt[it]=j[it]}),nt}throwError(o,$,j){throw this.makeError(o,$,j)}throwArgumentError(o,$,j){return this.throwError(o,Logger.errors.INVALID_ARGUMENT,{argument:$,value:j})}assert(o,$,j,et){o||this.throwError($,j,et)}assertArgument(o,$,j,et){o||this.throwArgumentError($,j,et)}checkNormalize(o){_normalizeError&&this.throwError("platform missing String.prototype.normalize",Logger.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:_normalizeError})}checkSafeUint53(o,$){typeof o=="number"&&($==null&&($="value not safe"),(o<0||o>=9007199254740991)&&this.throwError($,Logger.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:o}),o%1&&this.throwError($,Logger.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:o}))}checkArgumentCount(o,$,j){j?j=": "+j:j="",o<$&&this.throwError("missing argument"+j,Logger.errors.MISSING_ARGUMENT,{count:o,expectedCount:$}),o>$&&this.throwError("too many arguments"+j,Logger.errors.UNEXPECTED_ARGUMENT,{count:o,expectedCount:$})}checkNew(o,$){(o===Object||o==null)&&this.throwError("missing new",Logger.errors.MISSING_NEW,{name:$.name})}checkAbstract(o,$){o===$?this.throwError("cannot instantiate abstract class "+JSON.stringify($.name)+" directly; use a sub-class",Logger.errors.UNSUPPORTED_OPERATION,{name:o.name,operation:"new"}):(o===Object||o==null)&&this.throwError("missing new",Logger.errors.MISSING_NEW,{name:$.name})}static globalLogger(){return _globalLogger||(_globalLogger=new Logger(version$j)),_globalLogger}static setCensorship(o,$){if(!o&&$&&this.globalLogger().throwError("cannot permanently disable censorship",Logger.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),_permanentCensorErrors){if(!o)return;this.globalLogger().throwError("error censorship permanent",Logger.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}_censorErrors=!!o,_permanentCensorErrors=!!$}static setLogLevel(o){const $=LogLevels[o.toLowerCase()];if($==null){Logger.globalLogger().warn("invalid log level - "+o);return}_logLevel=$}static from(o){return new Logger(o)}}Logger.errors=ErrorCode;Logger.levels=LogLevel;const version$i="bytes/5.7.0",logger$m=new Logger(version$i);function isHexable(_){return!!_.toHexString}function addSlice(_){return _.slice||(_.slice=function(){const o=Array.prototype.slice.call(arguments);return addSlice(new Uint8Array(Array.prototype.slice.apply(_,o)))}),_}function isBytesLike(_){return isHexString(_)&&!(_.length%2)||isBytes$1(_)}function isInteger(_){return typeof _=="number"&&_==_&&_%1===0}function isBytes$1(_){if(_==null)return!1;if(_.constructor===Uint8Array)return!0;if(typeof _=="string"||!isInteger(_.length)||_.length<0)return!1;for(let o=0;o<_.length;o++){const $=_[o];if(!isInteger($)||$<0||$>=256)return!1}return!0}function arrayify(_,o){if(o||(o={}),typeof _=="number"){logger$m.checkSafeUint53(_,"invalid arrayify value");const $=[];for(;_;)$.unshift(_&255),_=parseInt(String(_/256));return $.length===0&&$.push(0),addSlice(new Uint8Array($))}if(o.allowMissingPrefix&&typeof _=="string"&&_.substring(0,2)!=="0x"&&(_="0x"+_),isHexable(_)&&(_=_.toHexString()),isHexString(_)){let $=_.substring(2);$.length%2&&(o.hexPad==="left"?$="0"+$:o.hexPad==="right"?$+="0":logger$m.throwArgumentError("hex data is odd-length","value",_));const j=[];for(let et=0;et<$.length;et+=2)j.push(parseInt($.substring(et,et+2),16));return addSlice(new Uint8Array(j))}return isBytes$1(_)?addSlice(new Uint8Array(_)):logger$m.throwArgumentError("invalid arrayify value","value",_)}function concat(_){const o=_.map(et=>arrayify(et)),$=o.reduce((et,tt)=>et+tt.length,0),j=new Uint8Array($);return o.reduce((et,tt)=>(j.set(tt,et),et+tt.length),0),addSlice(j)}function stripZeros(_){let o=arrayify(_);if(o.length===0)return o;let $=0;for(;$<o.length&&o[$]===0;)$++;return $&&(o=o.slice($)),o}function zeroPad(_,o){_=arrayify(_),_.length>o&&logger$m.throwArgumentError("value out of range","value",arguments[0]);const $=new Uint8Array(o);return $.set(_,o-_.length),addSlice($)}function isHexString(_,o){return!(typeof _!="string"||!_.match(/^0x[0-9A-Fa-f]*$/)||o&&_.length!==2+2*o)}const HexCharacters="0123456789abcdef";function hexlify(_,o){if(o||(o={}),typeof _=="number"){logger$m.checkSafeUint53(_,"invalid hexlify value");let $="";for(;_;)$=HexCharacters[_&15]+$,_=Math.floor(_/16);return $.length?($.length%2&&($="0"+$),"0x"+$):"0x00"}if(typeof _=="bigint")return _=_.toString(16),_.length%2?"0x0"+_:"0x"+_;if(o.allowMissingPrefix&&typeof _=="string"&&_.substring(0,2)!=="0x"&&(_="0x"+_),isHexable(_))return _.toHexString();if(isHexString(_))return _.length%2&&(o.hexPad==="left"?_="0x0"+_.substring(2):o.hexPad==="right"?_+="0":logger$m.throwArgumentError("hex data is odd-length","value",_)),_.toLowerCase();if(isBytes$1(_)){let $="0x";for(let j=0;j<_.length;j++){let et=_[j];$+=HexCharacters[(et&240)>>4]+HexCharacters[et&15]}return $}return logger$m.throwArgumentError("invalid hexlify value","value",_)}function hexDataLength(_){if(typeof _!="string")_=hexlify(_);else if(!isHexString(_)||_.length%2)return null;return(_.length-2)/2}function hexDataSlice(_,o,$){return typeof _!="string"?_=hexlify(_):(!isHexString(_)||_.length%2)&&logger$m.throwArgumentError("invalid hexData","value",_),o=2+2*o,$!=null?"0x"+_.substring(o,2+2*$):"0x"+_.substring(o)}function hexConcat(_){let o="0x";return _.forEach($=>{o+=hexlify($).substring(2)}),o}function hexZeroPad(_,o){for(typeof _!="string"?_=hexlify(_):isHexString(_)||logger$m.throwArgumentError("invalid hex string","value",_),_.length>2*o+2&&logger$m.throwArgumentError("value out of range","value",arguments[1]);_.length<2*o+2;)_="0x0"+_.substring(2);return _}function splitSignature(_){const o={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(isBytesLike(_)){let $=arrayify(_);$.length===64?(o.v=27+($[32]>>7),$[32]&=127,o.r=hexlify($.slice(0,32)),o.s=hexlify($.slice(32,64))):$.length===65?(o.r=hexlify($.slice(0,32)),o.s=hexlify($.slice(32,64)),o.v=$[64]):logger$m.throwArgumentError("invalid signature string","signature",_),o.v<27&&(o.v===0||o.v===1?o.v+=27:logger$m.throwArgumentError("signature invalid v byte","signature",_)),o.recoveryParam=1-o.v%2,o.recoveryParam&&($[32]|=128),o._vs=hexlify($.slice(32,64))}else{if(o.r=_.r,o.s=_.s,o.v=_.v,o.recoveryParam=_.recoveryParam,o._vs=_._vs,o._vs!=null){const et=zeroPad(arrayify(o._vs),32);o._vs=hexlify(et);const tt=et[0]>=128?1:0;o.recoveryParam==null?o.recoveryParam=tt:o.recoveryParam!==tt&&logger$m.throwArgumentError("signature recoveryParam mismatch _vs","signature",_),et[0]&=127;const rt=hexlify(et);o.s==null?o.s=rt:o.s!==rt&&logger$m.throwArgumentError("signature v mismatch _vs","signature",_)}if(o.recoveryParam==null)o.v==null?logger$m.throwArgumentError("signature missing v and recoveryParam","signature",_):o.v===0||o.v===1?o.recoveryParam=o.v:o.recoveryParam=1-o.v%2;else if(o.v==null)o.v=27+o.recoveryParam;else{const et=o.v===0||o.v===1?o.v:1-o.v%2;o.recoveryParam!==et&&logger$m.throwArgumentError("signature recoveryParam mismatch v","signature",_)}o.r==null||!isHexString(o.r)?logger$m.throwArgumentError("signature missing or invalid r","signature",_):o.r=hexZeroPad(o.r,32),o.s==null||!isHexString(o.s)?logger$m.throwArgumentError("signature missing or invalid s","signature",_):o.s=hexZeroPad(o.s,32);const $=arrayify(o.s);$[0]>=128&&logger$m.throwArgumentError("signature s out of range","signature",_),o.recoveryParam&&($[0]|=128);const j=hexlify($);o._vs&&(isHexString(o._vs)||logger$m.throwArgumentError("signature invalid _vs","signature",_),o._vs=hexZeroPad(o._vs,32)),o._vs==null?o._vs=j:o._vs!==j&&logger$m.throwArgumentError("signature _vs mismatch v and s","signature",_)}return o.yParityAndS=o._vs,o.compact=o.r+o.yParityAndS.substring(2),o}function joinSignature(_){return _=splitSignature(_),hexlify(concat([_.r,_.s,_.recoveryParam?"0x1c":"0x1b"]))}var bnExports$1={},bn$1={get exports(){return bnExports$1},set exports(_){bnExports$1=_}};(function(_){(function(o,$){function j(yt,lt){if(!yt)throw new Error(lt||"Assertion failed")}function et(yt,lt){yt.super_=lt;var pt=function(){};pt.prototype=lt.prototype,yt.prototype=new pt,yt.prototype.constructor=yt}function tt(yt,lt,pt){if(tt.isBN(yt))return yt;this.negative=0,this.words=null,this.length=0,this.red=null,yt!==null&&((lt==="le"||lt==="be")&&(pt=lt,lt=10),this._init(yt||0,lt||10,pt||"be"))}typeof o=="object"?o.exports=tt:$.BN=tt,tt.BN=tt,tt.wordSize=26;var rt;try{typeof window<"u"&&typeof window.Buffer<"u"?rt=window.Buffer:rt=buffer$2.Buffer}catch{}tt.isBN=function(lt){return lt instanceof tt?!0:lt!==null&&typeof lt=="object"&&lt.constructor.wordSize===tt.wordSize&&Array.isArray(lt.words)},tt.max=function(lt,pt){return lt.cmp(pt)>0?lt:pt},tt.min=function(lt,pt){return lt.cmp(pt)<0?lt:pt},tt.prototype._init=function(lt,pt,bt){if(typeof lt=="number")return this._initNumber(lt,pt,bt);if(typeof lt=="object")return this._initArray(lt,pt,bt);pt==="hex"&&(pt=16),j(pt===(pt|0)&&pt>=2&&pt<=36),lt=lt.toString().replace(/\s+/g,"");var _t=0;lt[0]==="-"&&(_t++,this.negative=1),_t<lt.length&&(pt===16?this._parseHex(lt,_t,bt):(this._parseBase(lt,pt,_t),bt==="le"&&this._initArray(this.toArray(),pt,bt)))},tt.prototype._initNumber=function(lt,pt,bt){lt<0&&(this.negative=1,lt=-lt),lt<67108864?(this.words=[lt&67108863],this.length=1):lt<4503599627370496?(this.words=[lt&67108863,lt/67108864&67108863],this.length=2):(j(lt<9007199254740992),this.words=[lt&67108863,lt/67108864&67108863,1],this.length=3),bt==="le"&&this._initArray(this.toArray(),pt,bt)},tt.prototype._initArray=function(lt,pt,bt){if(j(typeof lt.length=="number"),lt.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(lt.length/3),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t,Ct,xt=0;if(bt==="be")for(_t=lt.length-1,$t=0;_t>=0;_t-=3)Ct=lt[_t]|lt[_t-1]<<8|lt[_t-2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);else if(bt==="le")for(_t=0,$t=0;_t<lt.length;_t+=3)Ct=lt[_t]|lt[_t+1]<<8|lt[_t+2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);return this._strip()};function nt(yt,lt){var pt=yt.charCodeAt(lt);if(pt>=48&&pt<=57)return pt-48;if(pt>=65&&pt<=70)return pt-55;if(pt>=97&&pt<=102)return pt-87;j(!1,"Invalid character in "+yt)}function it(yt,lt,pt){var bt=nt(yt,pt);return pt-1>=lt&&(bt|=nt(yt,pt-1)<<4),bt}tt.prototype._parseHex=function(lt,pt,bt){this.length=Math.ceil((lt.length-pt)/6),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t=0,Ct=0,xt;if(bt==="be")for(_t=lt.length-1;_t>=pt;_t-=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8;else{var vt=lt.length-pt;for(_t=vt%2===0?pt+1:pt;_t<lt.length;_t+=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8}this._strip()};function st(yt,lt,pt,bt){for(var _t=0,$t=0,Ct=Math.min(yt.length,pt),xt=lt;xt<Ct;xt++){var vt=yt.charCodeAt(xt)-48;_t*=bt,vt>=49?$t=vt-49+10:vt>=17?$t=vt-17+10:$t=vt,j(vt>=0&&$t<bt,"Invalid character"),_t+=$t}return _t}tt.prototype._parseBase=function(lt,pt,bt){this.words=[0],this.length=1;for(var _t=0,$t=1;$t<=67108863;$t*=pt)_t++;_t--,$t=$t/pt|0;for(var Ct=lt.length-bt,xt=Ct%_t,vt=Math.min(Ct,Ct-xt)+bt,dt=0,wt=bt;wt<vt;wt+=_t)dt=st(lt,wt,wt+_t,pt),this.imuln($t),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt);if(xt!==0){var qt=1;for(dt=st(lt,wt,lt.length,pt),wt=0;wt<xt;wt++)qt*=pt;this.imuln(qt),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt)}this._strip()},tt.prototype.copy=function(lt){lt.words=new Array(this.length);for(var pt=0;pt<this.length;pt++)lt.words[pt]=this.words[pt];lt.length=this.length,lt.negative=this.negative,lt.red=this.red};function ot(yt,lt){yt.words=lt.words,yt.length=lt.length,yt.negative=lt.negative,yt.red=lt.red}if(tt.prototype._move=function(lt){ot(lt,this)},tt.prototype.clone=function(){var lt=new tt(null);return this.copy(lt),lt},tt.prototype._expand=function(lt){for(;this.length<lt;)this.words[this.length++]=0;return this},tt.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},tt.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{tt.prototype[Symbol.for("nodejs.util.inspect.custom")]=at}catch{tt.prototype.inspect=at}else tt.prototype.inspect=at;function at(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var ct=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],ut=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ft=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];tt.prototype.toString=function(lt,pt){lt=lt||10,pt=pt|0||1;var bt;if(lt===16||lt==="hex"){bt="";for(var _t=0,$t=0,Ct=0;Ct<this.length;Ct++){var xt=this.words[Ct],vt=((xt<<_t|$t)&16777215).toString(16);$t=xt>>>24-_t&16777215,_t+=2,_t>=26&&(_t-=26,Ct--),$t!==0||Ct!==this.length-1?bt=ct[6-vt.length]+vt+bt:bt=vt+bt}for($t!==0&&(bt=$t.toString(16)+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}if(lt===(lt|0)&&lt>=2&&lt<=36){var dt=ut[lt],wt=ft[lt];bt="";var qt=this.clone();for(qt.negative=0;!qt.isZero();){var Pt=qt.modrn(wt).toString(lt);qt=qt.idivn(wt),qt.isZero()?bt=Pt+bt:bt=ct[dt-Pt.length]+Pt+bt}for(this.isZero()&&(bt="0"+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}j(!1,"Base should be between 2 and 36")},tt.prototype.toNumber=function(){var lt=this.words[0];return this.length===2?lt+=this.words[1]*67108864:this.length===3&&this.words[2]===1?lt+=4503599627370496+this.words[1]*67108864:this.length>2&&j(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-lt:lt},tt.prototype.toJSON=function(){return this.toString(16,2)},rt&&(tt.prototype.toBuffer=function(lt,pt){return this.toArrayLike(rt,lt,pt)}),tt.prototype.toArray=function(lt,pt){return this.toArrayLike(Array,lt,pt)};var ht=function(lt,pt){return lt.allocUnsafe?lt.allocUnsafe(pt):new lt(pt)};tt.prototype.toArrayLike=function(lt,pt,bt){this._strip();var _t=this.byteLength(),$t=bt||Math.max(1,_t);j(_t<=$t,"byte array longer than desired length"),j($t>0,"Requested array length <= 0");var Ct=ht(lt,$t),xt=pt==="le"?"LE":"BE";return this["_toArrayLike"+xt](Ct,_t),Ct},tt.prototype._toArrayLikeLE=function(lt,pt){for(var bt=0,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt++]=xt&255,bt<lt.length&&(lt[bt++]=xt>>8&255),bt<lt.length&&(lt[bt++]=xt>>16&255),Ct===6?(bt<lt.length&&(lt[bt++]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt<lt.length)for(lt[bt++]=_t;bt<lt.length;)lt[bt++]=0},tt.prototype._toArrayLikeBE=function(lt,pt){for(var bt=lt.length-1,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt--]=xt&255,bt>=0&&(lt[bt--]=xt>>8&255),bt>=0&&(lt[bt--]=xt>>16&255),Ct===6?(bt>=0&&(lt[bt--]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt>=0)for(lt[bt--]=_t;bt>=0;)lt[bt--]=0},Math.clz32?tt.prototype._countBits=function(lt){return 32-Math.clz32(lt)}:tt.prototype._countBits=function(lt){var pt=lt,bt=0;return pt>=4096&&(bt+=13,pt>>>=13),pt>=64&&(bt+=7,pt>>>=7),pt>=8&&(bt+=4,pt>>>=4),pt>=2&&(bt+=2,pt>>>=2),bt+pt},tt.prototype._zeroBits=function(lt){if(lt===0)return 26;var pt=lt,bt=0;return pt&8191||(bt+=13,pt>>>=13),pt&127||(bt+=7,pt>>>=7),pt&15||(bt+=4,pt>>>=4),pt&3||(bt+=2,pt>>>=2),pt&1||bt++,bt},tt.prototype.bitLength=function(){var lt=this.words[this.length-1],pt=this._countBits(lt);return(this.length-1)*26+pt};function mt(yt){for(var lt=new Array(yt.bitLength()),pt=0;pt<lt.length;pt++){var bt=pt/26|0,_t=pt%26;lt[pt]=yt.words[bt]>>>_t&1}return lt}tt.prototype.zeroBits=function(){if(this.isZero())return 0;for(var lt=0,pt=0;pt<this.length;pt++){var bt=this._zeroBits(this.words[pt]);if(lt+=bt,bt!==26)break}return lt},tt.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},tt.prototype.toTwos=function(lt){return this.negative!==0?this.abs().inotn(lt).iaddn(1):this.clone()},tt.prototype.fromTwos=function(lt){return this.testn(lt-1)?this.notn(lt).iaddn(1).ineg():this.clone()},tt.prototype.isNeg=function(){return this.negative!==0},tt.prototype.neg=function(){return this.clone().ineg()},tt.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},tt.prototype.iuor=function(lt){for(;this.length<lt.length;)this.words[this.length++]=0;for(var pt=0;pt<lt.length;pt++)this.words[pt]=this.words[pt]|lt.words[pt];return this._strip()},tt.prototype.ior=function(lt){return j((this.negative|lt.negative)===0),this.iuor(lt)},tt.prototype.or=function(lt){return this.length>lt.length?this.clone().ior(lt):lt.clone().ior(this)},tt.prototype.uor=function(lt){return this.length>lt.length?this.clone().iuor(lt):lt.clone().iuor(this)},tt.prototype.iuand=function(lt){var pt;this.length>lt.length?pt=lt:pt=this;for(var bt=0;bt<pt.length;bt++)this.words[bt]=this.words[bt]&lt.words[bt];return this.length=pt.length,this._strip()},tt.prototype.iand=function(lt){return j((this.negative|lt.negative)===0),this.iuand(lt)},tt.prototype.and=function(lt){return this.length>lt.length?this.clone().iand(lt):lt.clone().iand(this)},tt.prototype.uand=function(lt){return this.length>lt.length?this.clone().iuand(lt):lt.clone().iuand(this)},tt.prototype.iuxor=function(lt){var pt,bt;this.length>lt.length?(pt=this,bt=lt):(pt=lt,bt=this);for(var _t=0;_t<bt.length;_t++)this.words[_t]=pt.words[_t]^bt.words[_t];if(this!==pt)for(;_t<pt.length;_t++)this.words[_t]=pt.words[_t];return this.length=pt.length,this._strip()},tt.prototype.ixor=function(lt){return j((this.negative|lt.negative)===0),this.iuxor(lt)},tt.prototype.xor=function(lt){return this.length>lt.length?this.clone().ixor(lt):lt.clone().ixor(this)},tt.prototype.uxor=function(lt){return this.length>lt.length?this.clone().iuxor(lt):lt.clone().iuxor(this)},tt.prototype.inotn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=Math.ceil(lt/26)|0,bt=lt%26;this._expand(pt),bt>0&&pt--;for(var _t=0;_t<pt;_t++)this.words[_t]=~this.words[_t]&67108863;return bt>0&&(this.words[_t]=~this.words[_t]&67108863>>26-bt),this._strip()},tt.prototype.notn=function(lt){return this.clone().inotn(lt)},tt.prototype.setn=function(lt,pt){j(typeof lt=="number"&&lt>=0);var bt=lt/26|0,_t=lt%26;return this._expand(bt+1),pt?this.words[bt]=this.words[bt]|1<<_t:this.words[bt]=this.words[bt]&~(1<<_t),this._strip()},tt.prototype.iadd=function(lt){var pt;if(this.negative!==0&&lt.negative===0)return this.negative=0,pt=this.isub(lt),this.negative^=1,this._normSign();if(this.negative===0&&lt.negative!==0)return lt.negative=0,pt=this.isub(lt),lt.negative=1,pt._normSign();var bt,_t;this.length>lt.length?(bt=this,_t=lt):(bt=lt,_t=this);for(var $t=0,Ct=0;Ct<_t.length;Ct++)pt=(bt.words[Ct]|0)+(_t.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;for(;$t!==0&&Ct<bt.length;Ct++)pt=(bt.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;if(this.length=bt.length,$t!==0)this.words[this.length]=$t,this.length++;else if(bt!==this)for(;Ct<bt.length;Ct++)this.words[Ct]=bt.words[Ct];return this},tt.prototype.add=function(lt){var pt;return lt.negative!==0&&this.negative===0?(lt.negative=0,pt=this.sub(lt),lt.negative^=1,pt):lt.negative===0&&this.negative!==0?(this.negative=0,pt=lt.sub(this),this.negative=1,pt):this.length>lt.length?this.clone().iadd(lt):lt.clone().iadd(this)},tt.prototype.isub=function(lt){if(lt.negative!==0){lt.negative=0;var pt=this.iadd(lt);return lt.negative=1,pt._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(lt),this.negative=1,this._normSign();var bt=this.cmp(lt);if(bt===0)return this.negative=0,this.length=1,this.words[0]=0,this;var _t,$t;bt>0?(_t=this,$t=lt):(_t=lt,$t=this);for(var Ct=0,xt=0;xt<$t.length;xt++)pt=(_t.words[xt]|0)-($t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;for(;Ct!==0&&xt<_t.length;xt++)pt=(_t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;if(Ct===0&&xt<_t.length&&_t!==this)for(;xt<_t.length;xt++)this.words[xt]=_t.words[xt];return this.length=Math.max(this.length,xt),_t!==this&&(this.negative=1),this._strip()},tt.prototype.sub=function(lt){return this.clone().isub(lt)};function gt(yt,lt,pt){pt.negative=lt.negative^yt.negative;var bt=yt.length+lt.length|0;pt.length=bt,bt=bt-1|0;var _t=yt.words[0]|0,$t=lt.words[0]|0,Ct=_t*$t,xt=Ct&67108863,vt=Ct/67108864|0;pt.words[0]=xt;for(var dt=1;dt<bt;dt++){for(var wt=vt>>>26,qt=vt&67108863,Pt=Math.min(dt,lt.length-1),Gt=Math.max(0,dt-yt.length+1);Gt<=Pt;Gt++){var Wt=dt-Gt|0;_t=yt.words[Wt]|0,$t=lt.words[Gt]|0,Ct=_t*$t+qt,wt+=Ct/67108864|0,qt=Ct&67108863}pt.words[dt]=qt|0,vt=wt|0}return vt!==0?pt.words[dt]=vt|0:pt.length--,pt._strip()}var Et=function(lt,pt,bt){var _t=lt.words,$t=pt.words,Ct=bt.words,xt=0,vt,dt,wt,qt=_t[0]|0,Pt=qt&8191,Gt=qt>>>13,Wt=_t[1]|0,Vt=Wt&8191,Ut=Wt>>>13,Mt=_t[2]|0,Lt=Mt&8191,Yt=Mt>>>13,lr=_t[3]|0,cr=lr&8191,ir=lr>>>13,Zt=_t[4]|0,Bt=Zt&8191,Ft=Zt>>>13,zt=_t[5]|0,Qt=zt&8191,nr=zt>>>13,gr=_t[6]|0,br=gr&8191,vr=gr>>>13,Nr=_t[7]|0,ar=Nr&8191,er=Nr>>>13,Xt=_t[8]|0,tr=Xt&8191,ur=Xt>>>13,pr=_t[9]|0,yr=pr&8191,wr=pr>>>13,Gr=$t[0]|0,$r=Gr&8191,Er=Gr>>>13,Wr=$t[1]|0,Vr=Wr&8191,Pr=Wr>>>13,nn=$t[2]|0,Kr=nn&8191,Dr=nn>>>13,Qr=$t[3]|0,Or=Qr&8191,Cr=Qr>>>13,Zr=$t[4]|0,Fr=Zr&8191,Ar=Zr>>>13,Xr=$t[5]|0,Mr=Xr&8191,Sr=Xr>>>13,Jr=$t[6]|0,Ur=Jr&8191,Rr=Jr>>>13,en=$t[7]|0,Br=en&8191,Ir=en>>>13,tn=$t[8]|0,qr=tn&8191,Lr=tn>>>13,sn=$t[9]|0,Hr=sn&8191,jr=sn>>>13;bt.negative=lt.negative^pt.negative,bt.length=19,vt=Math.imul(Pt,$r),dt=Math.imul(Pt,Er),dt=dt+Math.imul(Gt,$r)|0,wt=Math.imul(Gt,Er);var un=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(un>>>26)|0,un&=67108863,vt=Math.imul(Vt,$r),dt=Math.imul(Vt,Er),dt=dt+Math.imul(Ut,$r)|0,wt=Math.imul(Ut,Er),vt=vt+Math.imul(Pt,Vr)|0,dt=dt+Math.imul(Pt,Pr)|0,dt=dt+Math.imul(Gt,Vr)|0,wt=wt+Math.imul(Gt,Pr)|0;var dn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(dn>>>26)|0,dn&=67108863,vt=Math.imul(Lt,$r),dt=Math.imul(Lt,Er),dt=dt+Math.imul(Yt,$r)|0,wt=Math.imul(Yt,Er),vt=vt+Math.imul(Vt,Vr)|0,dt=dt+Math.imul(Vt,Pr)|0,dt=dt+Math.imul(Ut,Vr)|0,wt=wt+Math.imul(Ut,Pr)|0,vt=vt+Math.imul(Pt,Kr)|0,dt=dt+Math.imul(Pt,Dr)|0,dt=dt+Math.imul(Gt,Kr)|0,wt=wt+Math.imul(Gt,Dr)|0;var fn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(fn>>>26)|0,fn&=67108863,vt=Math.imul(cr,$r),dt=Math.imul(cr,Er),dt=dt+Math.imul(ir,$r)|0,wt=Math.imul(ir,Er),vt=vt+Math.imul(Lt,Vr)|0,dt=dt+Math.imul(Lt,Pr)|0,dt=dt+Math.imul(Yt,Vr)|0,wt=wt+Math.imul(Yt,Pr)|0,vt=vt+Math.imul(Vt,Kr)|0,dt=dt+Math.imul(Vt,Dr)|0,dt=dt+Math.imul(Ut,Kr)|0,wt=wt+Math.imul(Ut,Dr)|0,vt=vt+Math.imul(Pt,Or)|0,dt=dt+Math.imul(Pt,Cr)|0,dt=dt+Math.imul(Gt,Or)|0,wt=wt+Math.imul(Gt,Cr)|0;var an=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(an>>>26)|0,an&=67108863,vt=Math.imul(Bt,$r),dt=Math.imul(Bt,Er),dt=dt+Math.imul(Ft,$r)|0,wt=Math.imul(Ft,Er),vt=vt+Math.imul(cr,Vr)|0,dt=dt+Math.imul(cr,Pr)|0,dt=dt+Math.imul(ir,Vr)|0,wt=wt+Math.imul(ir,Pr)|0,vt=vt+Math.imul(Lt,Kr)|0,dt=dt+Math.imul(Lt,Dr)|0,dt=dt+Math.imul(Yt,Kr)|0,wt=wt+Math.imul(Yt,Dr)|0,vt=vt+Math.imul(Vt,Or)|0,dt=dt+Math.imul(Vt,Cr)|0,dt=dt+Math.imul(Ut,Or)|0,wt=wt+Math.imul(Ut,Cr)|0,vt=vt+Math.imul(Pt,Fr)|0,dt=dt+Math.imul(Pt,Ar)|0,dt=dt+Math.imul(Gt,Fr)|0,wt=wt+Math.imul(Gt,Ar)|0;var pn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(pn>>>26)|0,pn&=67108863,vt=Math.imul(Qt,$r),dt=Math.imul(Qt,Er),dt=dt+Math.imul(nr,$r)|0,wt=Math.imul(nr,Er),vt=vt+Math.imul(Bt,Vr)|0,dt=dt+Math.imul(Bt,Pr)|0,dt=dt+Math.imul(Ft,Vr)|0,wt=wt+Math.imul(Ft,Pr)|0,vt=vt+Math.imul(cr,Kr)|0,dt=dt+Math.imul(cr,Dr)|0,dt=dt+Math.imul(ir,Kr)|0,wt=wt+Math.imul(ir,Dr)|0,vt=vt+Math.imul(Lt,Or)|0,dt=dt+Math.imul(Lt,Cr)|0,dt=dt+Math.imul(Yt,Or)|0,wt=wt+Math.imul(Yt,Cr)|0,vt=vt+Math.imul(Vt,Fr)|0,dt=dt+Math.imul(Vt,Ar)|0,dt=dt+Math.imul(Ut,Fr)|0,wt=wt+Math.imul(Ut,Ar)|0,vt=vt+Math.imul(Pt,Mr)|0,dt=dt+Math.imul(Pt,Sr)|0,dt=dt+Math.imul(Gt,Mr)|0,wt=wt+Math.imul(Gt,Sr)|0;var _n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(_n>>>26)|0,_n&=67108863,vt=Math.imul(br,$r),dt=Math.imul(br,Er),dt=dt+Math.imul(vr,$r)|0,wt=Math.imul(vr,Er),vt=vt+Math.imul(Qt,Vr)|0,dt=dt+Math.imul(Qt,Pr)|0,dt=dt+Math.imul(nr,Vr)|0,wt=wt+Math.imul(nr,Pr)|0,vt=vt+Math.imul(Bt,Kr)|0,dt=dt+Math.imul(Bt,Dr)|0,dt=dt+Math.imul(Ft,Kr)|0,wt=wt+Math.imul(Ft,Dr)|0,vt=vt+Math.imul(cr,Or)|0,dt=dt+Math.imul(cr,Cr)|0,dt=dt+Math.imul(ir,Or)|0,wt=wt+Math.imul(ir,Cr)|0,vt=vt+Math.imul(Lt,Fr)|0,dt=dt+Math.imul(Lt,Ar)|0,dt=dt+Math.imul(Yt,Fr)|0,wt=wt+Math.imul(Yt,Ar)|0,vt=vt+Math.imul(Vt,Mr)|0,dt=dt+Math.imul(Vt,Sr)|0,dt=dt+Math.imul(Ut,Mr)|0,wt=wt+Math.imul(Ut,Sr)|0,vt=vt+Math.imul(Pt,Ur)|0,dt=dt+Math.imul(Pt,Rr)|0,dt=dt+Math.imul(Gt,Ur)|0,wt=wt+Math.imul(Gt,Rr)|0;var Tn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,vt=Math.imul(ar,$r),dt=Math.imul(ar,Er),dt=dt+Math.imul(er,$r)|0,wt=Math.imul(er,Er),vt=vt+Math.imul(br,Vr)|0,dt=dt+Math.imul(br,Pr)|0,dt=dt+Math.imul(vr,Vr)|0,wt=wt+Math.imul(vr,Pr)|0,vt=vt+Math.imul(Qt,Kr)|0,dt=dt+Math.imul(Qt,Dr)|0,dt=dt+Math.imul(nr,Kr)|0,wt=wt+Math.imul(nr,Dr)|0,vt=vt+Math.imul(Bt,Or)|0,dt=dt+Math.imul(Bt,Cr)|0,dt=dt+Math.imul(Ft,Or)|0,wt=wt+Math.imul(Ft,Cr)|0,vt=vt+Math.imul(cr,Fr)|0,dt=dt+Math.imul(cr,Ar)|0,dt=dt+Math.imul(ir,Fr)|0,wt=wt+Math.imul(ir,Ar)|0,vt=vt+Math.imul(Lt,Mr)|0,dt=dt+Math.imul(Lt,Sr)|0,dt=dt+Math.imul(Yt,Mr)|0,wt=wt+Math.imul(Yt,Sr)|0,vt=vt+Math.imul(Vt,Ur)|0,dt=dt+Math.imul(Vt,Rr)|0,dt=dt+Math.imul(Ut,Ur)|0,wt=wt+Math.imul(Ut,Rr)|0,vt=vt+Math.imul(Pt,Br)|0,dt=dt+Math.imul(Pt,Ir)|0,dt=dt+Math.imul(Gt,Br)|0,wt=wt+Math.imul(Gt,Ir)|0;var gn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(gn>>>26)|0,gn&=67108863,vt=Math.imul(tr,$r),dt=Math.imul(tr,Er),dt=dt+Math.imul(ur,$r)|0,wt=Math.imul(ur,Er),vt=vt+Math.imul(ar,Vr)|0,dt=dt+Math.imul(ar,Pr)|0,dt=dt+Math.imul(er,Vr)|0,wt=wt+Math.imul(er,Pr)|0,vt=vt+Math.imul(br,Kr)|0,dt=dt+Math.imul(br,Dr)|0,dt=dt+Math.imul(vr,Kr)|0,wt=wt+Math.imul(vr,Dr)|0,vt=vt+Math.imul(Qt,Or)|0,dt=dt+Math.imul(Qt,Cr)|0,dt=dt+Math.imul(nr,Or)|0,wt=wt+Math.imul(nr,Cr)|0,vt=vt+Math.imul(Bt,Fr)|0,dt=dt+Math.imul(Bt,Ar)|0,dt=dt+Math.imul(Ft,Fr)|0,wt=wt+Math.imul(Ft,Ar)|0,vt=vt+Math.imul(cr,Mr)|0,dt=dt+Math.imul(cr,Sr)|0,dt=dt+Math.imul(ir,Mr)|0,wt=wt+Math.imul(ir,Sr)|0,vt=vt+Math.imul(Lt,Ur)|0,dt=dt+Math.imul(Lt,Rr)|0,dt=dt+Math.imul(Yt,Ur)|0,wt=wt+Math.imul(Yt,Rr)|0,vt=vt+Math.imul(Vt,Br)|0,dt=dt+Math.imul(Vt,Ir)|0,dt=dt+Math.imul(Ut,Br)|0,wt=wt+Math.imul(Ut,Ir)|0,vt=vt+Math.imul(Pt,qr)|0,dt=dt+Math.imul(Pt,Lr)|0,dt=dt+Math.imul(Gt,qr)|0,wt=wt+Math.imul(Gt,Lr)|0;var En=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(En>>>26)|0,En&=67108863,vt=Math.imul(yr,$r),dt=Math.imul(yr,Er),dt=dt+Math.imul(wr,$r)|0,wt=Math.imul(wr,Er),vt=vt+Math.imul(tr,Vr)|0,dt=dt+Math.imul(tr,Pr)|0,dt=dt+Math.imul(ur,Vr)|0,wt=wt+Math.imul(ur,Pr)|0,vt=vt+Math.imul(ar,Kr)|0,dt=dt+Math.imul(ar,Dr)|0,dt=dt+Math.imul(er,Kr)|0,wt=wt+Math.imul(er,Dr)|0,vt=vt+Math.imul(br,Or)|0,dt=dt+Math.imul(br,Cr)|0,dt=dt+Math.imul(vr,Or)|0,wt=wt+Math.imul(vr,Cr)|0,vt=vt+Math.imul(Qt,Fr)|0,dt=dt+Math.imul(Qt,Ar)|0,dt=dt+Math.imul(nr,Fr)|0,wt=wt+Math.imul(nr,Ar)|0,vt=vt+Math.imul(Bt,Mr)|0,dt=dt+Math.imul(Bt,Sr)|0,dt=dt+Math.imul(Ft,Mr)|0,wt=wt+Math.imul(Ft,Sr)|0,vt=vt+Math.imul(cr,Ur)|0,dt=dt+Math.imul(cr,Rr)|0,dt=dt+Math.imul(ir,Ur)|0,wt=wt+Math.imul(ir,Rr)|0,vt=vt+Math.imul(Lt,Br)|0,dt=dt+Math.imul(Lt,Ir)|0,dt=dt+Math.imul(Yt,Br)|0,wt=wt+Math.imul(Yt,Ir)|0,vt=vt+Math.imul(Vt,qr)|0,dt=dt+Math.imul(Vt,Lr)|0,dt=dt+Math.imul(Ut,qr)|0,wt=wt+Math.imul(Ut,Lr)|0,vt=vt+Math.imul(Pt,Hr)|0,dt=dt+Math.imul(Pt,jr)|0,dt=dt+Math.imul(Gt,Hr)|0,wt=wt+Math.imul(Gt,jr)|0;var Cn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,vt=Math.imul(yr,Vr),dt=Math.imul(yr,Pr),dt=dt+Math.imul(wr,Vr)|0,wt=Math.imul(wr,Pr),vt=vt+Math.imul(tr,Kr)|0,dt=dt+Math.imul(tr,Dr)|0,dt=dt+Math.imul(ur,Kr)|0,wt=wt+Math.imul(ur,Dr)|0,vt=vt+Math.imul(ar,Or)|0,dt=dt+Math.imul(ar,Cr)|0,dt=dt+Math.imul(er,Or)|0,wt=wt+Math.imul(er,Cr)|0,vt=vt+Math.imul(br,Fr)|0,dt=dt+Math.imul(br,Ar)|0,dt=dt+Math.imul(vr,Fr)|0,wt=wt+Math.imul(vr,Ar)|0,vt=vt+Math.imul(Qt,Mr)|0,dt=dt+Math.imul(Qt,Sr)|0,dt=dt+Math.imul(nr,Mr)|0,wt=wt+Math.imul(nr,Sr)|0,vt=vt+Math.imul(Bt,Ur)|0,dt=dt+Math.imul(Bt,Rr)|0,dt=dt+Math.imul(Ft,Ur)|0,wt=wt+Math.imul(Ft,Rr)|0,vt=vt+Math.imul(cr,Br)|0,dt=dt+Math.imul(cr,Ir)|0,dt=dt+Math.imul(ir,Br)|0,wt=wt+Math.imul(ir,Ir)|0,vt=vt+Math.imul(Lt,qr)|0,dt=dt+Math.imul(Lt,Lr)|0,dt=dt+Math.imul(Yt,qr)|0,wt=wt+Math.imul(Yt,Lr)|0,vt=vt+Math.imul(Vt,Hr)|0,dt=dt+Math.imul(Vt,jr)|0,dt=dt+Math.imul(Ut,Hr)|0,wt=wt+Math.imul(Ut,jr)|0;var mn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(mn>>>26)|0,mn&=67108863,vt=Math.imul(yr,Kr),dt=Math.imul(yr,Dr),dt=dt+Math.imul(wr,Kr)|0,wt=Math.imul(wr,Dr),vt=vt+Math.imul(tr,Or)|0,dt=dt+Math.imul(tr,Cr)|0,dt=dt+Math.imul(ur,Or)|0,wt=wt+Math.imul(ur,Cr)|0,vt=vt+Math.imul(ar,Fr)|0,dt=dt+Math.imul(ar,Ar)|0,dt=dt+Math.imul(er,Fr)|0,wt=wt+Math.imul(er,Ar)|0,vt=vt+Math.imul(br,Mr)|0,dt=dt+Math.imul(br,Sr)|0,dt=dt+Math.imul(vr,Mr)|0,wt=wt+Math.imul(vr,Sr)|0,vt=vt+Math.imul(Qt,Ur)|0,dt=dt+Math.imul(Qt,Rr)|0,dt=dt+Math.imul(nr,Ur)|0,wt=wt+Math.imul(nr,Rr)|0,vt=vt+Math.imul(Bt,Br)|0,dt=dt+Math.imul(Bt,Ir)|0,dt=dt+Math.imul(Ft,Br)|0,wt=wt+Math.imul(Ft,Ir)|0,vt=vt+Math.imul(cr,qr)|0,dt=dt+Math.imul(cr,Lr)|0,dt=dt+Math.imul(ir,qr)|0,wt=wt+Math.imul(ir,Lr)|0,vt=vt+Math.imul(Lt,Hr)|0,dt=dt+Math.imul(Lt,jr)|0,dt=dt+Math.imul(Yt,Hr)|0,wt=wt+Math.imul(Yt,jr)|0;var xn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(xn>>>26)|0,xn&=67108863,vt=Math.imul(yr,Or),dt=Math.imul(yr,Cr),dt=dt+Math.imul(wr,Or)|0,wt=Math.imul(wr,Cr),vt=vt+Math.imul(tr,Fr)|0,dt=dt+Math.imul(tr,Ar)|0,dt=dt+Math.imul(ur,Fr)|0,wt=wt+Math.imul(ur,Ar)|0,vt=vt+Math.imul(ar,Mr)|0,dt=dt+Math.imul(ar,Sr)|0,dt=dt+Math.imul(er,Mr)|0,wt=wt+Math.imul(er,Sr)|0,vt=vt+Math.imul(br,Ur)|0,dt=dt+Math.imul(br,Rr)|0,dt=dt+Math.imul(vr,Ur)|0,wt=wt+Math.imul(vr,Rr)|0,vt=vt+Math.imul(Qt,Br)|0,dt=dt+Math.imul(Qt,Ir)|0,dt=dt+Math.imul(nr,Br)|0,wt=wt+Math.imul(nr,Ir)|0,vt=vt+Math.imul(Bt,qr)|0,dt=dt+Math.imul(Bt,Lr)|0,dt=dt+Math.imul(Ft,qr)|0,wt=wt+Math.imul(Ft,Lr)|0,vt=vt+Math.imul(cr,Hr)|0,dt=dt+Math.imul(cr,jr)|0,dt=dt+Math.imul(ir,Hr)|0,wt=wt+Math.imul(ir,jr)|0;var An=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(An>>>26)|0,An&=67108863,vt=Math.imul(yr,Fr),dt=Math.imul(yr,Ar),dt=dt+Math.imul(wr,Fr)|0,wt=Math.imul(wr,Ar),vt=vt+Math.imul(tr,Mr)|0,dt=dt+Math.imul(tr,Sr)|0,dt=dt+Math.imul(ur,Mr)|0,wt=wt+Math.imul(ur,Sr)|0,vt=vt+Math.imul(ar,Ur)|0,dt=dt+Math.imul(ar,Rr)|0,dt=dt+Math.imul(er,Ur)|0,wt=wt+Math.imul(er,Rr)|0,vt=vt+Math.imul(br,Br)|0,dt=dt+Math.imul(br,Ir)|0,dt=dt+Math.imul(vr,Br)|0,wt=wt+Math.imul(vr,Ir)|0,vt=vt+Math.imul(Qt,qr)|0,dt=dt+Math.imul(Qt,Lr)|0,dt=dt+Math.imul(nr,qr)|0,wt=wt+Math.imul(nr,Lr)|0,vt=vt+Math.imul(Bt,Hr)|0,dt=dt+Math.imul(Bt,jr)|0,dt=dt+Math.imul(Ft,Hr)|0,wt=wt+Math.imul(Ft,jr)|0;var $n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+($n>>>26)|0,$n&=67108863,vt=Math.imul(yr,Mr),dt=Math.imul(yr,Sr),dt=dt+Math.imul(wr,Mr)|0,wt=Math.imul(wr,Sr),vt=vt+Math.imul(tr,Ur)|0,dt=dt+Math.imul(tr,Rr)|0,dt=dt+Math.imul(ur,Ur)|0,wt=wt+Math.imul(ur,Rr)|0,vt=vt+Math.imul(ar,Br)|0,dt=dt+Math.imul(ar,Ir)|0,dt=dt+Math.imul(er,Br)|0,wt=wt+Math.imul(er,Ir)|0,vt=vt+Math.imul(br,qr)|0,dt=dt+Math.imul(br,Lr)|0,dt=dt+Math.imul(vr,qr)|0,wt=wt+Math.imul(vr,Lr)|0,vt=vt+Math.imul(Qt,Hr)|0,dt=dt+Math.imul(Qt,jr)|0,dt=dt+Math.imul(nr,Hr)|0,wt=wt+Math.imul(nr,jr)|0;var Rn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,vt=Math.imul(yr,Ur),dt=Math.imul(yr,Rr),dt=dt+Math.imul(wr,Ur)|0,wt=Math.imul(wr,Rr),vt=vt+Math.imul(tr,Br)|0,dt=dt+Math.imul(tr,Ir)|0,dt=dt+Math.imul(ur,Br)|0,wt=wt+Math.imul(ur,Ir)|0,vt=vt+Math.imul(ar,qr)|0,dt=dt+Math.imul(ar,Lr)|0,dt=dt+Math.imul(er,qr)|0,wt=wt+Math.imul(er,Lr)|0,vt=vt+Math.imul(br,Hr)|0,dt=dt+Math.imul(br,jr)|0,dt=dt+Math.imul(vr,Hr)|0,wt=wt+Math.imul(vr,jr)|0;var Sn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Sn>>>26)|0,Sn&=67108863,vt=Math.imul(yr,Br),dt=Math.imul(yr,Ir),dt=dt+Math.imul(wr,Br)|0,wt=Math.imul(wr,Ir),vt=vt+Math.imul(tr,qr)|0,dt=dt+Math.imul(tr,Lr)|0,dt=dt+Math.imul(ur,qr)|0,wt=wt+Math.imul(ur,Lr)|0,vt=vt+Math.imul(ar,Hr)|0,dt=dt+Math.imul(ar,jr)|0,dt=dt+Math.imul(er,Hr)|0,wt=wt+Math.imul(er,jr)|0;var In=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(In>>>26)|0,In&=67108863,vt=Math.imul(yr,qr),dt=Math.imul(yr,Lr),dt=dt+Math.imul(wr,qr)|0,wt=Math.imul(wr,Lr),vt=vt+Math.imul(tr,Hr)|0,dt=dt+Math.imul(tr,jr)|0,dt=dt+Math.imul(ur,Hr)|0,wt=wt+Math.imul(ur,jr)|0;var kn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(kn>>>26)|0,kn&=67108863,vt=Math.imul(yr,Hr),dt=Math.imul(yr,jr),dt=dt+Math.imul(wr,Hr)|0,wt=Math.imul(wr,jr);var Pn=(xt+vt|0)+((dt&8191)<<13)|0;return xt=(wt+(dt>>>13)|0)+(Pn>>>26)|0,Pn&=67108863,Ct[0]=un,Ct[1]=dn,Ct[2]=fn,Ct[3]=an,Ct[4]=pn,Ct[5]=_n,Ct[6]=Tn,Ct[7]=gn,Ct[8]=En,Ct[9]=Cn,Ct[10]=mn,Ct[11]=xn,Ct[12]=An,Ct[13]=$n,Ct[14]=Rn,Ct[15]=Sn,Ct[16]=In,Ct[17]=kn,Ct[18]=Pn,xt!==0&&(Ct[19]=xt,bt.length++),bt};Math.imul||(Et=gt);function St(yt,lt,pt){pt.negative=lt.negative^yt.negative,pt.length=yt.length+lt.length;for(var bt=0,_t=0,$t=0;$t<pt.length-1;$t++){var Ct=_t;_t=0;for(var xt=bt&67108863,vt=Math.min($t,lt.length-1),dt=Math.max(0,$t-yt.length+1);dt<=vt;dt++){var wt=$t-dt,qt=yt.words[wt]|0,Pt=lt.words[dt]|0,Gt=qt*Pt,Wt=Gt&67108863;Ct=Ct+(Gt/67108864|0)|0,Wt=Wt+xt|0,xt=Wt&67108863,Ct=Ct+(Wt>>>26)|0,_t+=Ct>>>26,Ct&=67108863}pt.words[$t]=xt,bt=Ct,Ct=_t}return bt!==0?pt.words[$t]=bt:pt.length--,pt._strip()}function At(yt,lt,pt){return St(yt,lt,pt)}tt.prototype.mulTo=function(lt,pt){var bt,_t=this.length+lt.length;return this.length===10&&lt.length===10?bt=Et(this,lt,pt):_t<63?bt=gt(this,lt,pt):_t<1024?bt=St(this,lt,pt):bt=At(this,lt,pt),bt},tt.prototype.mul=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),this.mulTo(lt,pt)},tt.prototype.mulf=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),At(this,lt,pt)},tt.prototype.imul=function(lt){return this.clone().mulTo(lt,this)},tt.prototype.imuln=function(lt){var pt=lt<0;pt&&(lt=-lt),j(typeof lt=="number"),j(lt<67108864);for(var bt=0,_t=0;_t<this.length;_t++){var $t=(this.words[_t]|0)*lt,Ct=($t&67108863)+(bt&67108863);bt>>=26,bt+=$t/67108864|0,bt+=Ct>>>26,this.words[_t]=Ct&67108863}return bt!==0&&(this.words[_t]=bt,this.length++),pt?this.ineg():this},tt.prototype.muln=function(lt){return this.clone().imuln(lt)},tt.prototype.sqr=function(){return this.mul(this)},tt.prototype.isqr=function(){return this.imul(this.clone())},tt.prototype.pow=function(lt){var pt=mt(lt);if(pt.length===0)return new tt(1);for(var bt=this,_t=0;_t<pt.length&&pt[_t]===0;_t++,bt=bt.sqr());if(++_t<pt.length)for(var $t=bt.sqr();_t<pt.length;_t++,$t=$t.sqr())pt[_t]!==0&&(bt=bt.mul($t));return bt},tt.prototype.iushln=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=67108863>>>26-pt<<26-pt,$t;if(pt!==0){var Ct=0;for($t=0;$t<this.length;$t++){var xt=this.words[$t]&_t,vt=(this.words[$t]|0)-xt<<pt;this.words[$t]=vt|Ct,Ct=xt>>>26-pt}Ct&&(this.words[$t]=Ct,this.length++)}if(bt!==0){for($t=this.length-1;$t>=0;$t--)this.words[$t+bt]=this.words[$t];for($t=0;$t<bt;$t++)this.words[$t]=0;this.length+=bt}return this._strip()},tt.prototype.ishln=function(lt){return j(this.negative===0),this.iushln(lt)},tt.prototype.iushrn=function(lt,pt,bt){j(typeof lt=="number"&&lt>=0);var _t;pt?_t=(pt-pt%26)/26:_t=0;var $t=lt%26,Ct=Math.min((lt-$t)/26,this.length),xt=67108863^67108863>>>$t<<$t,vt=bt;if(_t-=Ct,_t=Math.max(0,_t),vt){for(var dt=0;dt<Ct;dt++)vt.words[dt]=this.words[dt];vt.length=Ct}if(Ct!==0)if(this.length>Ct)for(this.length-=Ct,dt=0;dt<this.length;dt++)this.words[dt]=this.words[dt+Ct];else this.words[0]=0,this.length=1;var wt=0;for(dt=this.length-1;dt>=0&&(wt!==0||dt>=_t);dt--){var qt=this.words[dt]|0;this.words[dt]=wt<<26-$t|qt>>>$t,wt=qt&xt}return vt&&wt!==0&&(vt.words[vt.length++]=wt),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},tt.prototype.ishrn=function(lt,pt,bt){return j(this.negative===0),this.iushrn(lt,pt,bt)},tt.prototype.shln=function(lt){return this.clone().ishln(lt)},tt.prototype.ushln=function(lt){return this.clone().iushln(lt)},tt.prototype.shrn=function(lt){return this.clone().ishrn(lt)},tt.prototype.ushrn=function(lt){return this.clone().iushrn(lt)},tt.prototype.testn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return!1;var $t=this.words[bt];return!!($t&_t)},tt.prototype.imaskn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26;if(j(this.negative===0,"imaskn works only with positive numbers"),this.length<=bt)return this;if(pt!==0&&bt++,this.length=Math.min(bt,this.length),pt!==0){var _t=67108863^67108863>>>pt<<pt;this.words[this.length-1]&=_t}return this._strip()},tt.prototype.maskn=function(lt){return this.clone().imaskn(lt)},tt.prototype.iaddn=function(lt){return j(typeof lt=="number"),j(lt<67108864),lt<0?this.isubn(-lt):this.negative!==0?this.length===1&&(this.words[0]|0)<=lt?(this.words[0]=lt-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(lt),this.negative=1,this):this._iaddn(lt)},tt.prototype._iaddn=function(lt){this.words[0]+=lt;for(var pt=0;pt<this.length&&this.words[pt]>=67108864;pt++)this.words[pt]-=67108864,pt===this.length-1?this.words[pt+1]=1:this.words[pt+1]++;return this.length=Math.max(this.length,pt+1),this},tt.prototype.isubn=function(lt){if(j(typeof lt=="number"),j(lt<67108864),lt<0)return this.iaddn(-lt);if(this.negative!==0)return this.negative=0,this.iaddn(lt),this.negative=1,this;if(this.words[0]-=lt,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var pt=0;pt<this.length&&this.words[pt]<0;pt++)this.words[pt]+=67108864,this.words[pt+1]-=1;return this._strip()},tt.prototype.addn=function(lt){return this.clone().iaddn(lt)},tt.prototype.subn=function(lt){return this.clone().isubn(lt)},tt.prototype.iabs=function(){return this.negative=0,this},tt.prototype.abs=function(){return this.clone().iabs()},tt.prototype._ishlnsubmul=function(lt,pt,bt){var _t=lt.length+bt,$t;this._expand(_t);var Ct,xt=0;for($t=0;$t<lt.length;$t++){Ct=(this.words[$t+bt]|0)+xt;var vt=(lt.words[$t]|0)*pt;Ct-=vt&67108863,xt=(Ct>>26)-(vt/67108864|0),this.words[$t+bt]=Ct&67108863}for(;$t<this.length-bt;$t++)Ct=(this.words[$t+bt]|0)+xt,xt=Ct>>26,this.words[$t+bt]=Ct&67108863;if(xt===0)return this._strip();for(j(xt===-1),xt=0,$t=0;$t<this.length;$t++)Ct=-(this.words[$t]|0)+xt,xt=Ct>>26,this.words[$t]=Ct&67108863;return this.negative=1,this._strip()},tt.prototype._wordDiv=function(lt,pt){var bt=this.length-lt.length,_t=this.clone(),$t=lt,Ct=$t.words[$t.length-1]|0,xt=this._countBits(Ct);bt=26-xt,bt!==0&&($t=$t.ushln(bt),_t.iushln(bt),Ct=$t.words[$t.length-1]|0);var vt=_t.length-$t.length,dt;if(pt!=="mod"){dt=new tt(null),dt.length=vt+1,dt.words=new Array(dt.length);for(var wt=0;wt<dt.length;wt++)dt.words[wt]=0}var qt=_t.clone()._ishlnsubmul($t,1,vt);qt.negative===0&&(_t=qt,dt&&(dt.words[vt]=1));for(var Pt=vt-1;Pt>=0;Pt--){var Gt=(_t.words[$t.length+Pt]|0)*67108864+(_t.words[$t.length+Pt-1]|0);for(Gt=Math.min(Gt/Ct|0,67108863),_t._ishlnsubmul($t,Gt,Pt);_t.negative!==0;)Gt--,_t.negative=0,_t._ishlnsubmul($t,1,Pt),_t.isZero()||(_t.negative^=1);dt&&(dt.words[Pt]=Gt)}return dt&&dt._strip(),_t._strip(),pt!=="div"&&bt!==0&&_t.iushrn(bt),{div:dt||null,mod:_t}},tt.prototype.divmod=function(lt,pt,bt){if(j(!lt.isZero()),this.isZero())return{div:new tt(0),mod:new tt(0)};var _t,$t,Ct;return this.negative!==0&&lt.negative===0?(Ct=this.neg().divmod(lt,pt),pt!=="mod"&&(_t=Ct.div.neg()),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.iadd(lt)),{div:_t,mod:$t}):this.negative===0&&lt.negative!==0?(Ct=this.divmod(lt.neg(),pt),pt!=="mod"&&(_t=Ct.div.neg()),{div:_t,mod:Ct.mod}):this.negative&lt.negative?(Ct=this.neg().divmod(lt.neg(),pt),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.isub(lt)),{div:Ct.div,mod:$t}):lt.length>this.length||this.cmp(lt)<0?{div:new tt(0),mod:this}:lt.length===1?pt==="div"?{div:this.divn(lt.words[0]),mod:null}:pt==="mod"?{div:null,mod:new tt(this.modrn(lt.words[0]))}:{div:this.divn(lt.words[0]),mod:new tt(this.modrn(lt.words[0]))}:this._wordDiv(lt,pt)},tt.prototype.div=function(lt){return this.divmod(lt,"div",!1).div},tt.prototype.mod=function(lt){return this.divmod(lt,"mod",!1).mod},tt.prototype.umod=function(lt){return this.divmod(lt,"mod",!0).mod},tt.prototype.divRound=function(lt){var pt=this.divmod(lt);if(pt.mod.isZero())return pt.div;var bt=pt.div.negative!==0?pt.mod.isub(lt):pt.mod,_t=lt.ushrn(1),$t=lt.andln(1),Ct=bt.cmp(_t);return Ct<0||$t===1&&Ct===0?pt.div:pt.div.negative!==0?pt.div.isubn(1):pt.div.iaddn(1)},tt.prototype.modrn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=(1<<26)%lt,_t=0,$t=this.length-1;$t>=0;$t--)_t=(bt*_t+(this.words[$t]|0))%lt;return pt?-_t:_t},tt.prototype.modn=function(lt){return this.modrn(lt)},tt.prototype.idivn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=0,_t=this.length-1;_t>=0;_t--){var $t=(this.words[_t]|0)+bt*67108864;this.words[_t]=$t/lt|0,bt=$t%lt}return this._strip(),pt?this.ineg():this},tt.prototype.divn=function(lt){return this.clone().idivn(lt)},tt.prototype.egcd=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=new tt(0),xt=new tt(1),vt=0;pt.isEven()&&bt.isEven();)pt.iushrn(1),bt.iushrn(1),++vt;for(var dt=bt.clone(),wt=pt.clone();!pt.isZero();){for(var qt=0,Pt=1;!(pt.words[0]&Pt)&&qt<26;++qt,Pt<<=1);if(qt>0)for(pt.iushrn(qt);qt-- >0;)(_t.isOdd()||$t.isOdd())&&(_t.iadd(dt),$t.isub(wt)),_t.iushrn(1),$t.iushrn(1);for(var Gt=0,Wt=1;!(bt.words[0]&Wt)&&Gt<26;++Gt,Wt<<=1);if(Gt>0)for(bt.iushrn(Gt);Gt-- >0;)(Ct.isOdd()||xt.isOdd())&&(Ct.iadd(dt),xt.isub(wt)),Ct.iushrn(1),xt.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub(Ct),$t.isub(xt)):(bt.isub(pt),Ct.isub(_t),xt.isub($t))}return{a:Ct,b:xt,gcd:bt.iushln(vt)}},tt.prototype._invmp=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=bt.clone();pt.cmpn(1)>0&&bt.cmpn(1)>0;){for(var xt=0,vt=1;!(pt.words[0]&vt)&&xt<26;++xt,vt<<=1);if(xt>0)for(pt.iushrn(xt);xt-- >0;)_t.isOdd()&&_t.iadd(Ct),_t.iushrn(1);for(var dt=0,wt=1;!(bt.words[0]&wt)&&dt<26;++dt,wt<<=1);if(dt>0)for(bt.iushrn(dt);dt-- >0;)$t.isOdd()&&$t.iadd(Ct),$t.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub($t)):(bt.isub(pt),$t.isub(_t))}var qt;return pt.cmpn(1)===0?qt=_t:qt=$t,qt.cmpn(0)<0&&qt.iadd(lt),qt},tt.prototype.gcd=function(lt){if(this.isZero())return lt.abs();if(lt.isZero())return this.abs();var pt=this.clone(),bt=lt.clone();pt.negative=0,bt.negative=0;for(var _t=0;pt.isEven()&&bt.isEven();_t++)pt.iushrn(1),bt.iushrn(1);do{for(;pt.isEven();)pt.iushrn(1);for(;bt.isEven();)bt.iushrn(1);var $t=pt.cmp(bt);if($t<0){var Ct=pt;pt=bt,bt=Ct}else if($t===0||bt.cmpn(1)===0)break;pt.isub(bt)}while(!0);return bt.iushln(_t)},tt.prototype.invm=function(lt){return this.egcd(lt).a.umod(lt)},tt.prototype.isEven=function(){return(this.words[0]&1)===0},tt.prototype.isOdd=function(){return(this.words[0]&1)===1},tt.prototype.andln=function(lt){return this.words[0]&lt},tt.prototype.bincn=function(lt){j(typeof lt=="number");var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return this._expand(bt+1),this.words[bt]|=_t,this;for(var $t=_t,Ct=bt;$t!==0&&Ct<this.length;Ct++){var xt=this.words[Ct]|0;xt+=$t,$t=xt>>>26,xt&=67108863,this.words[Ct]=xt}return $t!==0&&(this.words[Ct]=$t,this.length++),this},tt.prototype.isZero=function(){return this.length===1&&this.words[0]===0},tt.prototype.cmpn=function(lt){var pt=lt<0;if(this.negative!==0&&!pt)return-1;if(this.negative===0&&pt)return 1;this._strip();var bt;if(this.length>1)bt=1;else{pt&&(lt=-lt),j(lt<=67108863,"Number is too big");var _t=this.words[0]|0;bt=_t===lt?0:_t<lt?-1:1}return this.negative!==0?-bt|0:bt},tt.prototype.cmp=function(lt){if(this.negative!==0&&lt.negative===0)return-1;if(this.negative===0&&lt.negative!==0)return 1;var pt=this.ucmp(lt);return this.negative!==0?-pt|0:pt},tt.prototype.ucmp=function(lt){if(this.length>lt.length)return 1;if(this.length<lt.length)return-1;for(var pt=0,bt=this.length-1;bt>=0;bt--){var _t=this.words[bt]|0,$t=lt.words[bt]|0;if(_t!==$t){_t<$t?pt=-1:_t>$t&&(pt=1);break}}return pt},tt.prototype.gtn=function(lt){return this.cmpn(lt)===1},tt.prototype.gt=function(lt){return this.cmp(lt)===1},tt.prototype.gten=function(lt){return this.cmpn(lt)>=0},tt.prototype.gte=function(lt){return this.cmp(lt)>=0},tt.prototype.ltn=function(lt){return this.cmpn(lt)===-1},tt.prototype.lt=function(lt){return this.cmp(lt)===-1},tt.prototype.lten=function(lt){return this.cmpn(lt)<=0},tt.prototype.lte=function(lt){return this.cmp(lt)<=0},tt.prototype.eqn=function(lt){return this.cmpn(lt)===0},tt.prototype.eq=function(lt){return this.cmp(lt)===0},tt.red=function(lt){return new Nt(lt)},tt.prototype.toRed=function(lt){return j(!this.red,"Already a number in reduction context"),j(this.negative===0,"red works only with positives"),lt.convertTo(this)._forceRed(lt)},tt.prototype.fromRed=function(){return j(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},tt.prototype._forceRed=function(lt){return this.red=lt,this},tt.prototype.forceRed=function(lt){return j(!this.red,"Already a number in reduction context"),this._forceRed(lt)},tt.prototype.redAdd=function(lt){return j(this.red,"redAdd works only with red numbers"),this.red.add(this,lt)},tt.prototype.redIAdd=function(lt){return j(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,lt)},tt.prototype.redSub=function(lt){return j(this.red,"redSub works only with red numbers"),this.red.sub(this,lt)},tt.prototype.redISub=function(lt){return j(this.red,"redISub works only with red numbers"),this.red.isub(this,lt)},tt.prototype.redShl=function(lt){return j(this.red,"redShl works only with red numbers"),this.red.shl(this,lt)},tt.prototype.redMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.mul(this,lt)},tt.prototype.redIMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.imul(this,lt)},tt.prototype.redSqr=function(){return j(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},tt.prototype.redISqr=function(){return j(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},tt.prototype.redSqrt=function(){return j(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},tt.prototype.redInvm=function(){return j(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},tt.prototype.redNeg=function(){return j(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},tt.prototype.redPow=function(lt){return j(this.red&&!lt.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,lt)};var kt={k256:null,p224:null,p192:null,p25519:null};function Rt(yt,lt){this.name=yt,this.p=new tt(lt,16),this.n=this.p.bitLength(),this.k=new tt(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Rt.prototype._tmp=function(){var lt=new tt(null);return lt.words=new Array(Math.ceil(this.n/13)),lt},Rt.prototype.ireduce=function(lt){var pt=lt,bt;do this.split(pt,this.tmp),pt=this.imulK(pt),pt=pt.iadd(this.tmp),bt=pt.bitLength();while(bt>this.n);var _t=bt<this.n?-1:pt.ucmp(this.p);return _t===0?(pt.words[0]=0,pt.length=1):_t>0?pt.isub(this.p):pt.strip!==void 0?pt.strip():pt._strip(),pt},Rt.prototype.split=function(lt,pt){lt.iushrn(this.n,0,pt)},Rt.prototype.imulK=function(lt){return lt.imul(this.k)};function Tt(){Rt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}et(Tt,Rt),Tt.prototype.split=function(lt,pt){for(var bt=4194303,_t=Math.min(lt.length,9),$t=0;$t<_t;$t++)pt.words[$t]=lt.words[$t];if(pt.length=_t,lt.length<=9){lt.words[0]=0,lt.length=1;return}var Ct=lt.words[9];for(pt.words[pt.length++]=Ct&bt,$t=10;$t<lt.length;$t++){var xt=lt.words[$t]|0;lt.words[$t-10]=(xt&bt)<<4|Ct>>>22,Ct=xt}Ct>>>=22,lt.words[$t-10]=Ct,Ct===0&&lt.length>10?lt.length-=10:lt.length-=9},Tt.prototype.imulK=function(lt){lt.words[lt.length]=0,lt.words[lt.length+1]=0,lt.length+=2;for(var pt=0,bt=0;bt<lt.length;bt++){var _t=lt.words[bt]|0;pt+=_t*977,lt.words[bt]=pt&67108863,pt=_t*64+(pt/67108864|0)}return lt.words[lt.length-1]===0&&(lt.length--,lt.words[lt.length-1]===0&&lt.length--),lt};function Dt(){Rt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}et(Dt,Rt);function Ot(){Rt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}et(Ot,Rt);function jt(){Rt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}et(jt,Rt),jt.prototype.imulK=function(lt){for(var pt=0,bt=0;bt<lt.length;bt++){var _t=(lt.words[bt]|0)*19+pt,$t=_t&67108863;_t>>>=26,lt.words[bt]=$t,pt=_t}return pt!==0&&(lt.words[lt.length++]=pt),lt},tt._prime=function(lt){if(kt[lt])return kt[lt];var pt;if(lt==="k256")pt=new Tt;else if(lt==="p224")pt=new Dt;else if(lt==="p192")pt=new Ot;else if(lt==="p25519")pt=new jt;else throw new Error("Unknown prime "+lt);return kt[lt]=pt,pt};function Nt(yt){if(typeof yt=="string"){var lt=tt._prime(yt);this.m=lt.p,this.prime=lt}else j(yt.gtn(1),"modulus must be greater than 1"),this.m=yt,this.prime=null}Nt.prototype._verify1=function(lt){j(lt.negative===0,"red works only with positives"),j(lt.red,"red works only with red numbers")},Nt.prototype._verify2=function(lt,pt){j((lt.negative|pt.negative)===0,"red works only with positives"),j(lt.red&&lt.red===pt.red,"red works only with red numbers")},Nt.prototype.imod=function(lt){return this.prime?this.prime.ireduce(lt)._forceRed(this):(ot(lt,lt.umod(this.m)._forceRed(this)),lt)},Nt.prototype.neg=function(lt){return lt.isZero()?lt.clone():this.m.sub(lt)._forceRed(this)},Nt.prototype.add=function(lt,pt){this._verify2(lt,pt);var bt=lt.add(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt._forceRed(this)},Nt.prototype.iadd=function(lt,pt){this._verify2(lt,pt);var bt=lt.iadd(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt},Nt.prototype.sub=function(lt,pt){this._verify2(lt,pt);var bt=lt.sub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt._forceRed(this)},Nt.prototype.isub=function(lt,pt){this._verify2(lt,pt);var bt=lt.isub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt},Nt.prototype.shl=function(lt,pt){return this._verify1(lt),this.imod(lt.ushln(pt))},Nt.prototype.imul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.imul(pt))},Nt.prototype.mul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.mul(pt))},Nt.prototype.isqr=function(lt){return this.imul(lt,lt.clone())},Nt.prototype.sqr=function(lt){return this.mul(lt,lt)},Nt.prototype.sqrt=function(lt){if(lt.isZero())return lt.clone();var pt=this.m.andln(3);if(j(pt%2===1),pt===3){var bt=this.m.add(new tt(1)).iushrn(2);return this.pow(lt,bt)}for(var _t=this.m.subn(1),$t=0;!_t.isZero()&&_t.andln(1)===0;)$t++,_t.iushrn(1);j(!_t.isZero());var Ct=new tt(1).toRed(this),xt=Ct.redNeg(),vt=this.m.subn(1).iushrn(1),dt=this.m.bitLength();for(dt=new tt(2*dt*dt).toRed(this);this.pow(dt,vt).cmp(xt)!==0;)dt.redIAdd(xt);for(var wt=this.pow(dt,_t),qt=this.pow(lt,_t.addn(1).iushrn(1)),Pt=this.pow(lt,_t),Gt=$t;Pt.cmp(Ct)!==0;){for(var Wt=Pt,Vt=0;Wt.cmp(Ct)!==0;Vt++)Wt=Wt.redSqr();j(Vt<Gt);var Ut=this.pow(wt,new tt(1).iushln(Gt-Vt-1));qt=qt.redMul(Ut),wt=Ut.redSqr(),Pt=Pt.redMul(wt),Gt=Vt}return qt},Nt.prototype.invm=function(lt){var pt=lt._invmp(this.m);return pt.negative!==0?(pt.negative=0,this.imod(pt).redNeg()):this.imod(pt)},Nt.prototype.pow=function(lt,pt){if(pt.isZero())return new tt(1).toRed(this);if(pt.cmpn(1)===0)return lt.clone();var bt=4,_t=new Array(1<<bt);_t[0]=new tt(1).toRed(this),_t[1]=lt;for(var $t=2;$t<_t.length;$t++)_t[$t]=this.mul(_t[$t-1],lt);var Ct=_t[0],xt=0,vt=0,dt=pt.bitLength()%26;for(dt===0&&(dt=26),$t=pt.length-1;$t>=0;$t--){for(var wt=pt.words[$t],qt=dt-1;qt>=0;qt--){var Pt=wt>>qt&1;if(Ct!==_t[0]&&(Ct=this.sqr(Ct)),Pt===0&&xt===0){vt=0;continue}xt<<=1,xt|=Pt,vt++,!(vt!==bt&&($t!==0||qt!==0))&&(Ct=this.mul(Ct,_t[xt]),vt=0,xt=0)}dt=26}return Ct},Nt.prototype.convertTo=function(lt){var pt=lt.umod(this.m);return pt===lt?pt.clone():pt},Nt.prototype.convertFrom=function(lt){var pt=lt.clone();return pt.red=null,pt},tt.mont=function(lt){return new It(lt)};function It(yt){Nt.call(this,yt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new tt(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}et(It,Nt),It.prototype.convertTo=function(lt){return this.imod(lt.ushln(this.shift))},It.prototype.convertFrom=function(lt){var pt=this.imod(lt.mul(this.rinv));return pt.red=null,pt},It.prototype.imul=function(lt,pt){if(lt.isZero()||pt.isZero())return lt.words[0]=0,lt.length=1,lt;var bt=lt.imul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.mul=function(lt,pt){if(lt.isZero()||pt.isZero())return new tt(0)._forceRed(this);var bt=lt.mul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.invm=function(lt){var pt=this.imod(lt._invmp(this.m).mul(this.r2));return pt._forceRed(this)}})(_,commonjsGlobal)})(bn$1);const _BN=bnExports$1,version$h="bignumber/5.7.0";var BN$1=_BN.BN;const logger$l=new Logger(version$h),_constructorGuard$1={},MAX_SAFE=9007199254740991;let _warnedToStringRadix=!1;class BigNumber{constructor(o,$){o!==_constructorGuard$1&&logger$l.throwError("cannot call constructor directly; use BigNumber.from",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=$,this._isBigNumber=!0,Object.freeze(this)}fromTwos(o){return toBigNumber(toBN(this).fromTwos(o))}toTwos(o){return toBigNumber(toBN(this).toTwos(o))}abs(){return this._hex[0]==="-"?BigNumber.from(this._hex.substring(1)):this}add(o){return toBigNumber(toBN(this).add(toBN(o)))}sub(o){return toBigNumber(toBN(this).sub(toBN(o)))}div(o){return BigNumber.from(o).isZero()&&throwFault("division-by-zero","div"),toBigNumber(toBN(this).div(toBN(o)))}mul(o){return toBigNumber(toBN(this).mul(toBN(o)))}mod(o){const $=toBN(o);return $.isNeg()&&throwFault("division-by-zero","mod"),toBigNumber(toBN(this).umod($))}pow(o){const $=toBN(o);return $.isNeg()&&throwFault("negative-power","pow"),toBigNumber(toBN(this).pow($))}and(o){const $=toBN(o);return(this.isNegative()||$.isNeg())&&throwFault("unbound-bitwise-result","and"),toBigNumber(toBN(this).and($))}or(o){const $=toBN(o);return(this.isNegative()||$.isNeg())&&throwFault("unbound-bitwise-result","or"),toBigNumber(toBN(this).or($))}xor(o){const $=toBN(o);return(this.isNegative()||$.isNeg())&&throwFault("unbound-bitwise-result","xor"),toBigNumber(toBN(this).xor($))}mask(o){return(this.isNegative()||o<0)&&throwFault("negative-width","mask"),toBigNumber(toBN(this).maskn(o))}shl(o){return(this.isNegative()||o<0)&&throwFault("negative-width","shl"),toBigNumber(toBN(this).shln(o))}shr(o){return(this.isNegative()||o<0)&&throwFault("negative-width","shr"),toBigNumber(toBN(this).shrn(o))}eq(o){return toBN(this).eq(toBN(o))}lt(o){return toBN(this).lt(toBN(o))}lte(o){return toBN(this).lte(toBN(o))}gt(o){return toBN(this).gt(toBN(o))}gte(o){return toBN(this).gte(toBN(o))}isNegative(){return this._hex[0]==="-"}isZero(){return toBN(this).isZero()}toNumber(){try{return toBN(this).toNumber()}catch{throwFault("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return logger$l.throwError("this platform does not support BigInt",Logger.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?_warnedToStringRadix||(_warnedToStringRadix=!0,logger$l.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?logger$l.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Logger.errors.UNEXPECTED_ARGUMENT,{}):logger$l.throwError("BigNumber.toString does not accept parameters",Logger.errors.UNEXPECTED_ARGUMENT,{})),toBN(this).toString(10)}toHexString(){return this._hex}toJSON(o){return{type:"BigNumber",hex:this.toHexString()}}static from(o){if(o instanceof BigNumber)return o;if(typeof o=="string")return o.match(/^-?0x[0-9a-f]+$/i)?new BigNumber(_constructorGuard$1,toHex(o)):o.match(/^-?[0-9]+$/)?new BigNumber(_constructorGuard$1,toHex(new BN$1(o))):logger$l.throwArgumentError("invalid BigNumber string","value",o);if(typeof o=="number")return o%1&&throwFault("underflow","BigNumber.from",o),(o>=MAX_SAFE||o<=-MAX_SAFE)&&throwFault("overflow","BigNumber.from",o),BigNumber.from(String(o));const $=o;if(typeof $=="bigint")return BigNumber.from($.toString());if(isBytes$1($))return BigNumber.from(hexlify($));if($)if($.toHexString){const j=$.toHexString();if(typeof j=="string")return BigNumber.from(j)}else{let j=$._hex;if(j==null&&$.type==="BigNumber"&&(j=$.hex),typeof j=="string"&&(isHexString(j)||j[0]==="-"&&isHexString(j.substring(1))))return BigNumber.from(j)}return logger$l.throwArgumentError("invalid BigNumber value","value",o)}static isBigNumber(o){return!!(o&&o._isBigNumber)}}function toHex(_){if(typeof _!="string")return toHex(_.toString(16));if(_[0]==="-")return _=_.substring(1),_[0]==="-"&&logger$l.throwArgumentError("invalid hex","value",_),_=toHex(_),_==="0x00"?_:"-"+_;if(_.substring(0,2)!=="0x"&&(_="0x"+_),_==="0x")return"0x00";for(_.length%2&&(_="0x0"+_.substring(2));_.length>4&&_.substring(0,4)==="0x00";)_="0x"+_.substring(4);return _}function toBigNumber(_){return BigNumber.from(toHex(_))}function toBN(_){const o=BigNumber.from(_).toHexString();return o[0]==="-"?new BN$1("-"+o.substring(3),16):new BN$1(o.substring(2),16)}function throwFault(_,o,$){const j={fault:_,operation:o};return $!=null&&(j.value=$),logger$l.throwError(_,Logger.errors.NUMERIC_FAULT,j)}function _base36To16(_){return new BN$1(_,36).toString(16)}function keccak256(_){return"0x"+sha3.keccak_256(arrayify(_))}const version$g="rlp/5.7.0",logger$k=new Logger(version$g);function arrayifyInteger(_){const o=[];for(;_;)o.unshift(_&255),_>>=8;return o}function _encode(_){if(Array.isArray(_)){let j=[];if(_.forEach(function(tt){j=j.concat(_encode(tt))}),j.length<=55)return j.unshift(192+j.length),j;const et=arrayifyInteger(j.length);return et.unshift(247+et.length),et.concat(j)}isBytesLike(_)||logger$k.throwArgumentError("RLP object must be BytesLike","object",_);const o=Array.prototype.slice.call(arrayify(_));if(o.length===1&&o[0]<=127)return o;if(o.length<=55)return o.unshift(128+o.length),o;const $=arrayifyInteger(o.length);return $.unshift(183+$.length),$.concat(o)}function encode$g(_){return hexlify(_encode(_))}const version$f="address/5.7.0",logger$j=new Logger(version$f);function getChecksumAddress(_){isHexString(_,20)||logger$j.throwArgumentError("invalid address","address",_),_=_.toLowerCase();const o=_.substring(2).split(""),$=new Uint8Array(40);for(let et=0;et<40;et++)$[et]=o[et].charCodeAt(0);const j=arrayify(keccak256($));for(let et=0;et<40;et+=2)j[et>>1]>>4>=8&&(o[et]=o[et].toUpperCase()),(j[et>>1]&15)>=8&&(o[et+1]=o[et+1].toUpperCase());return"0x"+o.join("")}const MAX_SAFE_INTEGER=9007199254740991;function log10(_){return Math.log10?Math.log10(_):Math.log(_)/Math.LN10}const ibanLookup={};for(let _=0;_<10;_++)ibanLookup[String(_)]=String(_);for(let _=0;_<26;_++)ibanLookup[String.fromCharCode(65+_)]=String(10+_);const safeDigits=Math.floor(log10(MAX_SAFE_INTEGER));function ibanChecksum(_){_=_.toUpperCase(),_=_.substring(4)+_.substring(0,2)+"00";let o=_.split("").map(j=>ibanLookup[j]).join("");for(;o.length>=safeDigits;){let j=o.substring(0,safeDigits);o=parseInt(j,10)%97+o.substring(j.length)}let $=String(98-parseInt(o,10)%97);for(;$.length<2;)$="0"+$;return $}function getAddress(_){let o=null;if(typeof _!="string"&&logger$j.throwArgumentError("invalid address","address",_),_.match(/^(0x)?[0-9a-fA-F]{40}$/))_.substring(0,2)!=="0x"&&(_="0x"+_),o=getChecksumAddress(_),_.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&o!==_&&logger$j.throwArgumentError("bad address checksum","address",_);else if(_.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(_.substring(2,4)!==ibanChecksum(_)&&logger$j.throwArgumentError("bad icap checksum","address",_),o=_base36To16(_.substring(4));o.length<40;)o="0"+o;o=getChecksumAddress("0x"+o)}else logger$j.throwArgumentError("invalid address","address",_);return o}const version$e="properties/5.7.0";var __awaiter$5=globalThis&&globalThis.__awaiter||function(_,o,$,j){function et(tt){return tt instanceof $?tt:new $(function(rt){rt(tt)})}return new($||($=Promise))(function(tt,rt){function nt(ot){try{st(j.next(ot))}catch(at){rt(at)}}function it(ot){try{st(j.throw(ot))}catch(at){rt(at)}}function st(ot){ot.done?tt(ot.value):et(ot.value).then(nt,it)}st((j=j.apply(_,o||[])).next())})};const logger$i=new Logger(version$e);function defineReadOnly(_,o,$){Object.defineProperty(_,o,{enumerable:!0,value:$,writable:!1})}function resolveProperties(_){return __awaiter$5(this,void 0,void 0,function*(){const o=Object.keys(_).map(j=>{const et=_[j];return Promise.resolve(et).then(tt=>({key:j,value:tt}))});return(yield Promise.all(o)).reduce((j,et)=>(j[et.key]=et.value,j),{})})}function checkProperties(_,o){(!_||typeof _!="object")&&logger$i.throwArgumentError("invalid object","object",_),Object.keys(_).forEach($=>{o[$]||logger$i.throwArgumentError("invalid object key - "+$,"transaction:"+$,_)})}function shallowCopy(_){const o={};for(const $ in _)o[$]=_[$];return o}const opaque={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function _isFrozen(_){if(_==null||opaque[typeof _])return!0;if(Array.isArray(_)||typeof _=="object"){if(!Object.isFrozen(_))return!1;const o=Object.keys(_);for(let $=0;$<o.length;$++){let j=null;try{j=_[o[$]]}catch{continue}if(!_isFrozen(j))return!1}return!0}return logger$i.throwArgumentError(`Cannot deepCopy ${typeof _}`,"object",_)}function _deepCopy(_){if(_isFrozen(_))return _;if(Array.isArray(_))return Object.freeze(_.map(o=>deepCopy(o)));if(typeof _=="object"){const o={};for(const $ in _){const j=_[$];j!==void 0&&defineReadOnly(o,$,deepCopy(j))}return o}return logger$i.throwArgumentError(`Cannot deepCopy ${typeof _}`,"object",_)}function deepCopy(_){return _deepCopy(_)}class Description{constructor(o){for(const $ in o)this[$]=deepCopy(o[$])}}const version$d="abstract-provider/5.7.0";var __awaiter$4=globalThis&&globalThis.__awaiter||function(_,o,$,j){function et(tt){return tt instanceof $?tt:new $(function(rt){rt(tt)})}return new($||($=Promise))(function(tt,rt){function nt(ot){try{st(j.next(ot))}catch(at){rt(at)}}function it(ot){try{st(j.throw(ot))}catch(at){rt(at)}}function st(ot){ot.done?tt(ot.value):et(ot.value).then(nt,it)}st((j=j.apply(_,o||[])).next())})};const logger$h=new Logger(version$d);let Provider$1=class Po{constructor(){logger$h.checkAbstract(new.target,Po),defineReadOnly(this,"_isProvider",!0)}getFeeData(){return __awaiter$4(this,void 0,void 0,function*(){const{block:o,gasPrice:$}=yield resolveProperties({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch(rt=>null)});let j=null,et=null,tt=null;return o&&o.baseFeePerGas&&(j=o.baseFeePerGas,tt=BigNumber.from("1500000000"),et=o.baseFeePerGas.mul(2).add(tt)),{lastBaseFeePerGas:j,maxFeePerGas:et,maxPriorityFeePerGas:tt,gasPrice:$}})}addListener(o,$){return this.on(o,$)}removeListener(o,$){return this.off(o,$)}static isProvider(o){return!!(o&&o._isProvider)}};const version$c="abstract-signer/5.7.0";var __awaiter$3=globalThis&&globalThis.__awaiter||function(_,o,$,j){function et(tt){return tt instanceof $?tt:new $(function(rt){rt(tt)})}return new($||($=Promise))(function(tt,rt){function nt(ot){try{st(j.next(ot))}catch(at){rt(at)}}function it(ot){try{st(j.throw(ot))}catch(at){rt(at)}}function st(ot){ot.done?tt(ot.value):et(ot.value).then(nt,it)}st((j=j.apply(_,o||[])).next())})};const logger$g=new Logger(version$c),allowedTransactionKeys$1=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],forwardErrors=[Logger.errors.INSUFFICIENT_FUNDS,Logger.errors.NONCE_EXPIRED,Logger.errors.REPLACEMENT_UNDERPRICED];class Signer{constructor(){logger$g.checkAbstract(new.target,Signer),defineReadOnly(this,"_isSigner",!0)}getBalance(o){return __awaiter$3(this,void 0,void 0,function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),o)})}getTransactionCount(o){return __awaiter$3(this,void 0,void 0,function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),o)})}estimateGas(o){return __awaiter$3(this,void 0,void 0,function*(){this._checkProvider("estimateGas");const $=yield resolveProperties(this.checkTransaction(o));return yield this.provider.estimateGas($)})}call(o,$){return __awaiter$3(this,void 0,void 0,function*(){this._checkProvider("call");const j=yield resolveProperties(this.checkTransaction(o));return yield this.provider.call(j,$)})}sendTransaction(o){return __awaiter$3(this,void 0,void 0,function*(){this._checkProvider("sendTransaction");const $=yield this.populateTransaction(o),j=yield this.signTransaction($);return yield this.provider.sendTransaction(j)})}getChainId(){return __awaiter$3(this,void 0,void 0,function*(){return this._checkProvider("getChainId"),(yield this.provider.getNetwork()).chainId})}getGasPrice(){return __awaiter$3(this,void 0,void 0,function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()})}getFeeData(){return __awaiter$3(this,void 0,void 0,function*(){return this._checkProvider("getFeeData"),yield this.provider.getFeeData()})}resolveName(o){return __awaiter$3(this,void 0,void 0,function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(o)})}checkTransaction(o){for(const j in o)allowedTransactionKeys$1.indexOf(j)===-1&&logger$g.throwArgumentError("invalid transaction key: "+j,"transaction",o);const $=shallowCopy(o);return $.from==null?$.from=this.getAddress():$.from=Promise.all([Promise.resolve($.from),this.getAddress()]).then(j=>(j[0].toLowerCase()!==j[1].toLowerCase()&&logger$g.throwArgumentError("from address mismatch","transaction",o),j[0])),$}populateTransaction(o){return __awaiter$3(this,void 0,void 0,function*(){const $=yield resolveProperties(this.checkTransaction(o));$.to!=null&&($.to=Promise.resolve($.to).then(et=>__awaiter$3(this,void 0,void 0,function*(){if(et==null)return null;const tt=yield this.resolveName(et);return tt==null&&logger$g.throwArgumentError("provided ENS name resolves to null","tx.to",et),tt})),$.to.catch(et=>{}));const j=$.maxFeePerGas!=null||$.maxPriorityFeePerGas!=null;if($.gasPrice!=null&&($.type===2||j)?logger$g.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",o):($.type===0||$.type===1)&&j&&logger$g.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",o),($.type===2||$.type==null)&&$.maxFeePerGas!=null&&$.maxPriorityFeePerGas!=null)$.type=2;else if($.type===0||$.type===1)$.gasPrice==null&&($.gasPrice=this.getGasPrice());else{const et=yield this.getFeeData();if($.type==null)if(et.maxFeePerGas!=null&&et.maxPriorityFeePerGas!=null)if($.type=2,$.gasPrice!=null){const tt=$.gasPrice;delete $.gasPrice,$.maxFeePerGas=tt,$.maxPriorityFeePerGas=tt}else $.maxFeePerGas==null&&($.maxFeePerGas=et.maxFeePerGas),$.maxPriorityFeePerGas==null&&($.maxPriorityFeePerGas=et.maxPriorityFeePerGas);else et.gasPrice!=null?(j&&logger$g.throwError("network does not support EIP-1559",Logger.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),$.gasPrice==null&&($.gasPrice=et.gasPrice),$.type=0):logger$g.throwError("failed to get consistent fee data",Logger.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"});else $.type===2&&($.maxFeePerGas==null&&($.maxFeePerGas=et.maxFeePerGas),$.maxPriorityFeePerGas==null&&($.maxPriorityFeePerGas=et.maxPriorityFeePerGas))}return $.nonce==null&&($.nonce=this.getTransactionCount("pending")),$.gasLimit==null&&($.gasLimit=this.estimateGas($).catch(et=>{if(forwardErrors.indexOf(et.code)>=0)throw et;return logger$g.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error:et,tx:$})})),$.chainId==null?$.chainId=this.getChainId():$.chainId=Promise.all([Promise.resolve($.chainId),this.getChainId()]).then(et=>(et[1]!==0&&et[0]!==et[1]&&logger$g.throwArgumentError("chainId address mismatch","transaction",o),et[0])),yield resolveProperties($)})}_checkProvider(o){this.provider||logger$g.throwError("missing provider",Logger.errors.UNSUPPORTED_OPERATION,{operation:o||"_checkProvider"})}static isSigner(o){return!!(o&&o._isSigner)}}const version$b="strings/5.7.0",logger$f=new Logger(version$b);var UnicodeNormalizationForm;(function(_){_.current="",_.NFC="NFC",_.NFD="NFD",_.NFKC="NFKC",_.NFKD="NFKD"})(UnicodeNormalizationForm||(UnicodeNormalizationForm={}));var Utf8ErrorReason;(function(_){_.UNEXPECTED_CONTINUE="unexpected continuation byte",_.BAD_PREFIX="bad codepoint prefix",_.OVERRUN="string overrun",_.MISSING_CONTINUE="missing continuation byte",_.OUT_OF_RANGE="out of UTF-8 range",_.UTF16_SURROGATE="UTF-16 surrogate",_.OVERLONG="overlong representation"})(Utf8ErrorReason||(Utf8ErrorReason={}));function toUtf8Bytes(_,o=UnicodeNormalizationForm.current){o!=UnicodeNormalizationForm.current&&(logger$f.checkNormalize(),_=_.normalize(o));let $=[];for(let j=0;j<_.length;j++){const et=_.charCodeAt(j);if(et<128)$.push(et);else if(et<2048)$.push(et>>6|192),$.push(et&63|128);else if((et&64512)==55296){j++;const tt=_.charCodeAt(j);if(j>=_.length||(tt&64512)!==56320)throw new Error("invalid utf-8 string");const rt=65536+((et&1023)<<10)+(tt&1023);$.push(rt>>18|240),$.push(rt>>12&63|128),$.push(rt>>6&63|128),$.push(rt&63|128)}else $.push(et>>12|224),$.push(et>>6&63|128),$.push(et&63|128)}return arrayify($)}function id(_){return keccak256(toUtf8Bytes(_))}const version$a="hash/5.7.0",messagePrefix=`Ethereum Signed Message:
`;function hashMessage(_){return typeof _=="string"&&(_=toUtf8Bytes(_)),keccak256(concat([toUtf8Bytes(messagePrefix),toUtf8Bytes(String(_.length)),_]))}var __awaiter$2=globalThis&&globalThis.__awaiter||function(_,o,$,j){function et(tt){return tt instanceof $?tt:new $(function(rt){rt(tt)})}return new($||($=Promise))(function(tt,rt){function nt(ot){try{st(j.next(ot))}catch(at){rt(at)}}function it(ot){try{st(j.throw(ot))}catch(at){rt(at)}}function st(ot){ot.done?tt(ot.value):et(ot.value).then(nt,it)}st((j=j.apply(_,o||[])).next())})};const logger$e=new Logger(version$a),padding=new Uint8Array(32);padding.fill(0);const NegativeOne=BigNumber.from(-1),Zero=BigNumber.from(0),One=BigNumber.from(1),MaxUint256=BigNumber.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function hexPadRight(_){const o=arrayify(_),$=o.length%32;return $?hexConcat([o,padding.slice($)]):hexlify(o)}const hexTrue=hexZeroPad(One.toHexString(),32),hexFalse=hexZeroPad(Zero.toHexString(),32),domainFieldTypes={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},domainFieldNames=["name","version","chainId","verifyingContract","salt"];function checkString(_){return function(o){return typeof o!="string"&&logger$e.throwArgumentError(`invalid domain value for ${JSON.stringify(_)}`,`domain.${_}`,o),o}}const domainChecks={name:checkString("name"),version:checkString("version"),chainId:function(_){try{return BigNumber.from(_).toString()}catch{}return logger$e.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",_)},verifyingContract:function(_){try{return getAddress(_).toLowerCase()}catch{}return logger$e.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",_)},salt:function(_){try{const o=arrayify(_);if(o.length!==32)throw new Error("bad length");return hexlify(o)}catch{}return logger$e.throwArgumentError('invalid domain value "salt"',"domain.salt",_)}};function getBaseEncoder(_){{const o=_.match(/^(u?)int(\d*)$/);if(o){const $=o[1]==="",j=parseInt(o[2]||"256");(j%8!==0||j>256||o[2]&&o[2]!==String(j))&&logger$e.throwArgumentError("invalid numeric width","type",_);const et=MaxUint256.mask($?j-1:j),tt=$?et.add(One).mul(NegativeOne):Zero;return function(rt){const nt=BigNumber.from(rt);return(nt.lt(tt)||nt.gt(et))&&logger$e.throwArgumentError(`value out-of-bounds for ${_}`,"value",rt),hexZeroPad(nt.toTwos(256).toHexString(),32)}}}{const o=_.match(/^bytes(\d+)$/);if(o){const $=parseInt(o[1]);return($===0||$>32||o[1]!==String($))&&logger$e.throwArgumentError("invalid bytes width","type",_),function(j){return arrayify(j).length!==$&&logger$e.throwArgumentError(`invalid length for ${_}`,"value",j),hexPadRight(j)}}}switch(_){case"address":return function(o){return hexZeroPad(getAddress(o),32)};case"bool":return function(o){return o?hexTrue:hexFalse};case"bytes":return function(o){return keccak256(o)};case"string":return function(o){return id(o)}}return null}function encodeType(_,o){return`${_}(${o.map(({name:$,type:j})=>j+" "+$).join(",")})`}class TypedDataEncoder{constructor(o){defineReadOnly(this,"types",Object.freeze(deepCopy(o))),defineReadOnly(this,"_encoderCache",{}),defineReadOnly(this,"_types",{});const $={},j={},et={};Object.keys(o).forEach(nt=>{$[nt]={},j[nt]=[],et[nt]={}});for(const nt in o){const it={};o[nt].forEach(st=>{it[st.name]&&logger$e.throwArgumentError(`duplicate variable name ${JSON.stringify(st.name)} in ${JSON.stringify(nt)}`,"types",o),it[st.name]=!0;const ot=st.type.match(/^([^\x5b]*)(\x5b|$)/)[1];ot===nt&&logger$e.throwArgumentError(`circular type reference to ${JSON.stringify(ot)}`,"types",o),!getBaseEncoder(ot)&&(j[ot]||logger$e.throwArgumentError(`unknown type ${JSON.stringify(ot)}`,"types",o),j[ot].push(nt),$[nt][ot]=!0)})}const tt=Object.keys(j).filter(nt=>j[nt].length===0);tt.length===0?logger$e.throwArgumentError("missing primary type","types",o):tt.length>1&&logger$e.throwArgumentError(`ambiguous primary types or unused types: ${tt.map(nt=>JSON.stringify(nt)).join(", ")}`,"types",o),defineReadOnly(this,"primaryType",tt[0]);function rt(nt,it){it[nt]&&logger$e.throwArgumentError(`circular type reference to ${JSON.stringify(nt)}`,"types",o),it[nt]=!0,Object.keys($[nt]).forEach(st=>{j[st]&&(rt(st,it),Object.keys(it).forEach(ot=>{et[ot][st]=!0}))}),delete it[nt]}rt(this.primaryType,{});for(const nt in et){const it=Object.keys(et[nt]);it.sort(),this._types[nt]=encodeType(nt,o[nt])+it.map(st=>encodeType(st,o[st])).join("")}}getEncoder(o){let $=this._encoderCache[o];return $||($=this._encoderCache[o]=this._getEncoder(o)),$}_getEncoder(o){{const et=getBaseEncoder(o);if(et)return et}const $=o.match(/^(.*)(\x5b(\d*)\x5d)$/);if($){const et=$[1],tt=this.getEncoder(et),rt=parseInt($[3]);return nt=>{rt>=0&&nt.length!==rt&&logger$e.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",nt);let it=nt.map(tt);return this._types[et]&&(it=it.map(keccak256)),keccak256(hexConcat(it))}}const j=this.types[o];if(j){const et=id(this._types[o]);return tt=>{const rt=j.map(({name:nt,type:it})=>{const st=this.getEncoder(it)(tt[nt]);return this._types[it]?keccak256(st):st});return rt.unshift(et),hexConcat(rt)}}return logger$e.throwArgumentError(`unknown type: ${o}`,"type",o)}encodeType(o){const $=this._types[o];return $||logger$e.throwArgumentError(`unknown type: ${JSON.stringify(o)}`,"name",o),$}encodeData(o,$){return this.getEncoder(o)($)}hashStruct(o,$){return keccak256(this.encodeData(o,$))}encode(o){return this.encodeData(this.primaryType,o)}hash(o){return this.hashStruct(this.primaryType,o)}_visit(o,$,j){if(getBaseEncoder(o))return j(o,$);const et=o.match(/^(.*)(\x5b(\d*)\x5d)$/);if(et){const rt=et[1],nt=parseInt(et[3]);return nt>=0&&$.length!==nt&&logger$e.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",$),$.map(it=>this._visit(rt,it,j))}const tt=this.types[o];return tt?tt.reduce((rt,{name:nt,type:it})=>(rt[nt]=this._visit(it,$[nt],j),rt),{}):logger$e.throwArgumentError(`unknown type: ${o}`,"type",o)}visit(o,$){return this._visit(this.primaryType,o,$)}static from(o){return new TypedDataEncoder(o)}static getPrimaryType(o){return TypedDataEncoder.from(o).primaryType}static hashStruct(o,$,j){return TypedDataEncoder.from($).hashStruct(o,j)}static hashDomain(o){const $=[];for(const j in o){const et=domainFieldTypes[j];et||logger$e.throwArgumentError(`invalid typed-data domain key: ${JSON.stringify(j)}`,"domain",o),$.push({name:j,type:et})}return $.sort((j,et)=>domainFieldNames.indexOf(j.name)-domainFieldNames.indexOf(et.name)),TypedDataEncoder.hashStruct("EIP712Domain",{EIP712Domain:$},o)}static encode(o,$,j){return hexConcat(["0x1901",TypedDataEncoder.hashDomain(o),TypedDataEncoder.from($).hash(j)])}static hash(o,$,j){return keccak256(TypedDataEncoder.encode(o,$,j))}static resolveNames(o,$,j,et){return __awaiter$2(this,void 0,void 0,function*(){o=shallowCopy(o);const tt={};o.verifyingContract&&!isHexString(o.verifyingContract,20)&&(tt[o.verifyingContract]="0x");const rt=TypedDataEncoder.from($);rt.visit(j,(nt,it)=>(nt==="address"&&!isHexString(it,20)&&(tt[it]="0x"),it));for(const nt in tt)tt[nt]=yield et(nt);return o.verifyingContract&&tt[o.verifyingContract]&&(o.verifyingContract=tt[o.verifyingContract]),j=rt.visit(j,(nt,it)=>nt==="address"&&tt[it]?tt[it]:it),{domain:o,value:j}})}static getPayload(o,$,j){TypedDataEncoder.hashDomain(o);const et={},tt=[];domainFieldNames.forEach(it=>{const st=o[it];st!=null&&(et[it]=domainChecks[it](st),tt.push({name:it,type:domainFieldTypes[it]}))});const rt=TypedDataEncoder.from($),nt=shallowCopy($);return nt.EIP712Domain?logger$e.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",$):nt.EIP712Domain=tt,rt.encode(j),{types:nt,domain:et,primaryType:rt.primaryType,message:rt.visit(j,(it,st)=>{if(it.match(/^bytes(\d*)/))return hexlify(arrayify(st));if(it.match(/^u?int/))return BigNumber.from(st).toString();switch(it){case"address":return st.toLowerCase();case"bool":return!!st;case"string":return typeof st!="string"&&logger$e.throwArgumentError("invalid string","value",st),st}return logger$e.throwArgumentError("unsupported type","type",it)})}}}class BaseX{constructor(o){defineReadOnly(this,"alphabet",o),defineReadOnly(this,"base",o.length),defineReadOnly(this,"_alphabetMap",{}),defineReadOnly(this,"_leader",o.charAt(0));for(let $=0;$<o.length;$++)this._alphabetMap[o.charAt($)]=$}encode(o){let $=arrayify(o);if($.length===0)return"";let j=[0];for(let tt=0;tt<$.length;++tt){let rt=$[tt];for(let nt=0;nt<j.length;++nt)rt+=j[nt]<<8,j[nt]=rt%this.base,rt=rt/this.base|0;for(;rt>0;)j.push(rt%this.base),rt=rt/this.base|0}let et="";for(let tt=0;$[tt]===0&&tt<$.length-1;++tt)et+=this._leader;for(let tt=j.length-1;tt>=0;--tt)et+=this.alphabet[j[tt]];return et}decode(o){if(typeof o!="string")throw new TypeError("Expected String");let $=[];if(o.length===0)return new Uint8Array($);$.push(0);for(let j=0;j<o.length;j++){let et=this._alphabetMap[o[j]];if(et===void 0)throw new Error("Non-base"+this.base+" character");let tt=et;for(let rt=0;rt<$.length;++rt)tt+=$[rt]*this.base,$[rt]=tt&255,tt>>=8;for(;tt>0;)$.push(tt&255),tt>>=8}for(let j=0;o[j]===this._leader&&j<o.length-1;++j)$.push(0);return arrayify(new Uint8Array($.reverse()))}}new BaseX("abcdefghijklmnopqrstuvwxyz234567");const Base58=new BaseX("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");var SupportedAlgorithm;(function(_){_.sha256="sha256",_.sha512="sha512"})(SupportedAlgorithm||(SupportedAlgorithm={}));const version$9="sha2/5.7.0",logger$d=new Logger(version$9);function ripemd160(_){return"0x"+hash$5.ripemd160().update(arrayify(_)).digest("hex")}function sha256(_){return"0x"+hash$5.sha256().update(arrayify(_)).digest("hex")}function computeHmac(_,o,$){return SupportedAlgorithm[_]||logger$d.throwError("unsupported algorithm "+_,Logger.errors.UNSUPPORTED_OPERATION,{operation:"hmac",algorithm:_}),"0x"+hash$5.hmac(hash$5[_],arrayify(o)).update(arrayify($)).digest("hex")}function pbkdf2$1(_,o,$,j,et){_=arrayify(_),o=arrayify(o);let tt,rt=1;const nt=new Uint8Array(j),it=new Uint8Array(o.length+4);it.set(o);let st,ot;for(let at=1;at<=rt;at++){it[o.length]=at>>24&255,it[o.length+1]=at>>16&255,it[o.length+2]=at>>8&255,it[o.length+3]=at&255;let ct=arrayify(computeHmac(et,_,it));tt||(tt=ct.length,ot=new Uint8Array(tt),rt=Math.ceil(j/tt),st=j-(rt-1)*tt),ot.set(ct);for(let ht=1;ht<$;ht++){ct=arrayify(computeHmac(et,_,ct));for(let mt=0;mt<tt;mt++)ot[mt]^=ct[mt]}const ut=(at-1)*tt,ft=at===rt?st:tt;nt.set(arrayify(ot).slice(0,ft),ut)}return hexlify(nt)}var bnExports={},bn={get exports(){return bnExports},set exports(_){bnExports=_}};(function(_){(function(o,$){function j(yt,lt){if(!yt)throw new Error(lt||"Assertion failed")}function et(yt,lt){yt.super_=lt;var pt=function(){};pt.prototype=lt.prototype,yt.prototype=new pt,yt.prototype.constructor=yt}function tt(yt,lt,pt){if(tt.isBN(yt))return yt;this.negative=0,this.words=null,this.length=0,this.red=null,yt!==null&&((lt==="le"||lt==="be")&&(pt=lt,lt=10),this._init(yt||0,lt||10,pt||"be"))}typeof o=="object"?o.exports=tt:$.BN=tt,tt.BN=tt,tt.wordSize=26;var rt;try{typeof window<"u"&&typeof window.Buffer<"u"?rt=window.Buffer:rt=buffer$2.Buffer}catch{}tt.isBN=function(lt){return lt instanceof tt?!0:lt!==null&&typeof lt=="object"&&lt.constructor.wordSize===tt.wordSize&&Array.isArray(lt.words)},tt.max=function(lt,pt){return lt.cmp(pt)>0?lt:pt},tt.min=function(lt,pt){return lt.cmp(pt)<0?lt:pt},tt.prototype._init=function(lt,pt,bt){if(typeof lt=="number")return this._initNumber(lt,pt,bt);if(typeof lt=="object")return this._initArray(lt,pt,bt);pt==="hex"&&(pt=16),j(pt===(pt|0)&&pt>=2&&pt<=36),lt=lt.toString().replace(/\s+/g,"");var _t=0;lt[0]==="-"&&(_t++,this.negative=1),_t<lt.length&&(pt===16?this._parseHex(lt,_t,bt):(this._parseBase(lt,pt,_t),bt==="le"&&this._initArray(this.toArray(),pt,bt)))},tt.prototype._initNumber=function(lt,pt,bt){lt<0&&(this.negative=1,lt=-lt),lt<67108864?(this.words=[lt&67108863],this.length=1):lt<4503599627370496?(this.words=[lt&67108863,lt/67108864&67108863],this.length=2):(j(lt<9007199254740992),this.words=[lt&67108863,lt/67108864&67108863,1],this.length=3),bt==="le"&&this._initArray(this.toArray(),pt,bt)},tt.prototype._initArray=function(lt,pt,bt){if(j(typeof lt.length=="number"),lt.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(lt.length/3),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t,Ct,xt=0;if(bt==="be")for(_t=lt.length-1,$t=0;_t>=0;_t-=3)Ct=lt[_t]|lt[_t-1]<<8|lt[_t-2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);else if(bt==="le")for(_t=0,$t=0;_t<lt.length;_t+=3)Ct=lt[_t]|lt[_t+1]<<8|lt[_t+2]<<16,this.words[$t]|=Ct<<xt&67108863,this.words[$t+1]=Ct>>>26-xt&67108863,xt+=24,xt>=26&&(xt-=26,$t++);return this._strip()};function nt(yt,lt){var pt=yt.charCodeAt(lt);if(pt>=48&&pt<=57)return pt-48;if(pt>=65&&pt<=70)return pt-55;if(pt>=97&&pt<=102)return pt-87;j(!1,"Invalid character in "+yt)}function it(yt,lt,pt){var bt=nt(yt,pt);return pt-1>=lt&&(bt|=nt(yt,pt-1)<<4),bt}tt.prototype._parseHex=function(lt,pt,bt){this.length=Math.ceil((lt.length-pt)/6),this.words=new Array(this.length);for(var _t=0;_t<this.length;_t++)this.words[_t]=0;var $t=0,Ct=0,xt;if(bt==="be")for(_t=lt.length-1;_t>=pt;_t-=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8;else{var vt=lt.length-pt;for(_t=vt%2===0?pt+1:pt;_t<lt.length;_t+=2)xt=it(lt,pt,_t)<<$t,this.words[Ct]|=xt&67108863,$t>=18?($t-=18,Ct+=1,this.words[Ct]|=xt>>>26):$t+=8}this._strip()};function st(yt,lt,pt,bt){for(var _t=0,$t=0,Ct=Math.min(yt.length,pt),xt=lt;xt<Ct;xt++){var vt=yt.charCodeAt(xt)-48;_t*=bt,vt>=49?$t=vt-49+10:vt>=17?$t=vt-17+10:$t=vt,j(vt>=0&&$t<bt,"Invalid character"),_t+=$t}return _t}tt.prototype._parseBase=function(lt,pt,bt){this.words=[0],this.length=1;for(var _t=0,$t=1;$t<=67108863;$t*=pt)_t++;_t--,$t=$t/pt|0;for(var Ct=lt.length-bt,xt=Ct%_t,vt=Math.min(Ct,Ct-xt)+bt,dt=0,wt=bt;wt<vt;wt+=_t)dt=st(lt,wt,wt+_t,pt),this.imuln($t),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt);if(xt!==0){var qt=1;for(dt=st(lt,wt,lt.length,pt),wt=0;wt<xt;wt++)qt*=pt;this.imuln(qt),this.words[0]+dt<67108864?this.words[0]+=dt:this._iaddn(dt)}this._strip()},tt.prototype.copy=function(lt){lt.words=new Array(this.length);for(var pt=0;pt<this.length;pt++)lt.words[pt]=this.words[pt];lt.length=this.length,lt.negative=this.negative,lt.red=this.red};function ot(yt,lt){yt.words=lt.words,yt.length=lt.length,yt.negative=lt.negative,yt.red=lt.red}if(tt.prototype._move=function(lt){ot(lt,this)},tt.prototype.clone=function(){var lt=new tt(null);return this.copy(lt),lt},tt.prototype._expand=function(lt){for(;this.length<lt;)this.words[this.length++]=0;return this},tt.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},tt.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{tt.prototype[Symbol.for("nodejs.util.inspect.custom")]=at}catch{tt.prototype.inspect=at}else tt.prototype.inspect=at;function at(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var ct=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],ut=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ft=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];tt.prototype.toString=function(lt,pt){lt=lt||10,pt=pt|0||1;var bt;if(lt===16||lt==="hex"){bt="";for(var _t=0,$t=0,Ct=0;Ct<this.length;Ct++){var xt=this.words[Ct],vt=((xt<<_t|$t)&16777215).toString(16);$t=xt>>>24-_t&16777215,_t+=2,_t>=26&&(_t-=26,Ct--),$t!==0||Ct!==this.length-1?bt=ct[6-vt.length]+vt+bt:bt=vt+bt}for($t!==0&&(bt=$t.toString(16)+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}if(lt===(lt|0)&&lt>=2&&lt<=36){var dt=ut[lt],wt=ft[lt];bt="";var qt=this.clone();for(qt.negative=0;!qt.isZero();){var Pt=qt.modrn(wt).toString(lt);qt=qt.idivn(wt),qt.isZero()?bt=Pt+bt:bt=ct[dt-Pt.length]+Pt+bt}for(this.isZero()&&(bt="0"+bt);bt.length%pt!==0;)bt="0"+bt;return this.negative!==0&&(bt="-"+bt),bt}j(!1,"Base should be between 2 and 36")},tt.prototype.toNumber=function(){var lt=this.words[0];return this.length===2?lt+=this.words[1]*67108864:this.length===3&&this.words[2]===1?lt+=4503599627370496+this.words[1]*67108864:this.length>2&&j(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-lt:lt},tt.prototype.toJSON=function(){return this.toString(16,2)},rt&&(tt.prototype.toBuffer=function(lt,pt){return this.toArrayLike(rt,lt,pt)}),tt.prototype.toArray=function(lt,pt){return this.toArrayLike(Array,lt,pt)};var ht=function(lt,pt){return lt.allocUnsafe?lt.allocUnsafe(pt):new lt(pt)};tt.prototype.toArrayLike=function(lt,pt,bt){this._strip();var _t=this.byteLength(),$t=bt||Math.max(1,_t);j(_t<=$t,"byte array longer than desired length"),j($t>0,"Requested array length <= 0");var Ct=ht(lt,$t),xt=pt==="le"?"LE":"BE";return this["_toArrayLike"+xt](Ct,_t),Ct},tt.prototype._toArrayLikeLE=function(lt,pt){for(var bt=0,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt++]=xt&255,bt<lt.length&&(lt[bt++]=xt>>8&255),bt<lt.length&&(lt[bt++]=xt>>16&255),Ct===6?(bt<lt.length&&(lt[bt++]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt<lt.length)for(lt[bt++]=_t;bt<lt.length;)lt[bt++]=0},tt.prototype._toArrayLikeBE=function(lt,pt){for(var bt=lt.length-1,_t=0,$t=0,Ct=0;$t<this.length;$t++){var xt=this.words[$t]<<Ct|_t;lt[bt--]=xt&255,bt>=0&&(lt[bt--]=xt>>8&255),bt>=0&&(lt[bt--]=xt>>16&255),Ct===6?(bt>=0&&(lt[bt--]=xt>>24&255),_t=0,Ct=0):(_t=xt>>>24,Ct+=2)}if(bt>=0)for(lt[bt--]=_t;bt>=0;)lt[bt--]=0},Math.clz32?tt.prototype._countBits=function(lt){return 32-Math.clz32(lt)}:tt.prototype._countBits=function(lt){var pt=lt,bt=0;return pt>=4096&&(bt+=13,pt>>>=13),pt>=64&&(bt+=7,pt>>>=7),pt>=8&&(bt+=4,pt>>>=4),pt>=2&&(bt+=2,pt>>>=2),bt+pt},tt.prototype._zeroBits=function(lt){if(lt===0)return 26;var pt=lt,bt=0;return pt&8191||(bt+=13,pt>>>=13),pt&127||(bt+=7,pt>>>=7),pt&15||(bt+=4,pt>>>=4),pt&3||(bt+=2,pt>>>=2),pt&1||bt++,bt},tt.prototype.bitLength=function(){var lt=this.words[this.length-1],pt=this._countBits(lt);return(this.length-1)*26+pt};function mt(yt){for(var lt=new Array(yt.bitLength()),pt=0;pt<lt.length;pt++){var bt=pt/26|0,_t=pt%26;lt[pt]=yt.words[bt]>>>_t&1}return lt}tt.prototype.zeroBits=function(){if(this.isZero())return 0;for(var lt=0,pt=0;pt<this.length;pt++){var bt=this._zeroBits(this.words[pt]);if(lt+=bt,bt!==26)break}return lt},tt.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},tt.prototype.toTwos=function(lt){return this.negative!==0?this.abs().inotn(lt).iaddn(1):this.clone()},tt.prototype.fromTwos=function(lt){return this.testn(lt-1)?this.notn(lt).iaddn(1).ineg():this.clone()},tt.prototype.isNeg=function(){return this.negative!==0},tt.prototype.neg=function(){return this.clone().ineg()},tt.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},tt.prototype.iuor=function(lt){for(;this.length<lt.length;)this.words[this.length++]=0;for(var pt=0;pt<lt.length;pt++)this.words[pt]=this.words[pt]|lt.words[pt];return this._strip()},tt.prototype.ior=function(lt){return j((this.negative|lt.negative)===0),this.iuor(lt)},tt.prototype.or=function(lt){return this.length>lt.length?this.clone().ior(lt):lt.clone().ior(this)},tt.prototype.uor=function(lt){return this.length>lt.length?this.clone().iuor(lt):lt.clone().iuor(this)},tt.prototype.iuand=function(lt){var pt;this.length>lt.length?pt=lt:pt=this;for(var bt=0;bt<pt.length;bt++)this.words[bt]=this.words[bt]&lt.words[bt];return this.length=pt.length,this._strip()},tt.prototype.iand=function(lt){return j((this.negative|lt.negative)===0),this.iuand(lt)},tt.prototype.and=function(lt){return this.length>lt.length?this.clone().iand(lt):lt.clone().iand(this)},tt.prototype.uand=function(lt){return this.length>lt.length?this.clone().iuand(lt):lt.clone().iuand(this)},tt.prototype.iuxor=function(lt){var pt,bt;this.length>lt.length?(pt=this,bt=lt):(pt=lt,bt=this);for(var _t=0;_t<bt.length;_t++)this.words[_t]=pt.words[_t]^bt.words[_t];if(this!==pt)for(;_t<pt.length;_t++)this.words[_t]=pt.words[_t];return this.length=pt.length,this._strip()},tt.prototype.ixor=function(lt){return j((this.negative|lt.negative)===0),this.iuxor(lt)},tt.prototype.xor=function(lt){return this.length>lt.length?this.clone().ixor(lt):lt.clone().ixor(this)},tt.prototype.uxor=function(lt){return this.length>lt.length?this.clone().iuxor(lt):lt.clone().iuxor(this)},tt.prototype.inotn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=Math.ceil(lt/26)|0,bt=lt%26;this._expand(pt),bt>0&&pt--;for(var _t=0;_t<pt;_t++)this.words[_t]=~this.words[_t]&67108863;return bt>0&&(this.words[_t]=~this.words[_t]&67108863>>26-bt),this._strip()},tt.prototype.notn=function(lt){return this.clone().inotn(lt)},tt.prototype.setn=function(lt,pt){j(typeof lt=="number"&&lt>=0);var bt=lt/26|0,_t=lt%26;return this._expand(bt+1),pt?this.words[bt]=this.words[bt]|1<<_t:this.words[bt]=this.words[bt]&~(1<<_t),this._strip()},tt.prototype.iadd=function(lt){var pt;if(this.negative!==0&&lt.negative===0)return this.negative=0,pt=this.isub(lt),this.negative^=1,this._normSign();if(this.negative===0&&lt.negative!==0)return lt.negative=0,pt=this.isub(lt),lt.negative=1,pt._normSign();var bt,_t;this.length>lt.length?(bt=this,_t=lt):(bt=lt,_t=this);for(var $t=0,Ct=0;Ct<_t.length;Ct++)pt=(bt.words[Ct]|0)+(_t.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;for(;$t!==0&&Ct<bt.length;Ct++)pt=(bt.words[Ct]|0)+$t,this.words[Ct]=pt&67108863,$t=pt>>>26;if(this.length=bt.length,$t!==0)this.words[this.length]=$t,this.length++;else if(bt!==this)for(;Ct<bt.length;Ct++)this.words[Ct]=bt.words[Ct];return this},tt.prototype.add=function(lt){var pt;return lt.negative!==0&&this.negative===0?(lt.negative=0,pt=this.sub(lt),lt.negative^=1,pt):lt.negative===0&&this.negative!==0?(this.negative=0,pt=lt.sub(this),this.negative=1,pt):this.length>lt.length?this.clone().iadd(lt):lt.clone().iadd(this)},tt.prototype.isub=function(lt){if(lt.negative!==0){lt.negative=0;var pt=this.iadd(lt);return lt.negative=1,pt._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(lt),this.negative=1,this._normSign();var bt=this.cmp(lt);if(bt===0)return this.negative=0,this.length=1,this.words[0]=0,this;var _t,$t;bt>0?(_t=this,$t=lt):(_t=lt,$t=this);for(var Ct=0,xt=0;xt<$t.length;xt++)pt=(_t.words[xt]|0)-($t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;for(;Ct!==0&&xt<_t.length;xt++)pt=(_t.words[xt]|0)+Ct,Ct=pt>>26,this.words[xt]=pt&67108863;if(Ct===0&&xt<_t.length&&_t!==this)for(;xt<_t.length;xt++)this.words[xt]=_t.words[xt];return this.length=Math.max(this.length,xt),_t!==this&&(this.negative=1),this._strip()},tt.prototype.sub=function(lt){return this.clone().isub(lt)};function gt(yt,lt,pt){pt.negative=lt.negative^yt.negative;var bt=yt.length+lt.length|0;pt.length=bt,bt=bt-1|0;var _t=yt.words[0]|0,$t=lt.words[0]|0,Ct=_t*$t,xt=Ct&67108863,vt=Ct/67108864|0;pt.words[0]=xt;for(var dt=1;dt<bt;dt++){for(var wt=vt>>>26,qt=vt&67108863,Pt=Math.min(dt,lt.length-1),Gt=Math.max(0,dt-yt.length+1);Gt<=Pt;Gt++){var Wt=dt-Gt|0;_t=yt.words[Wt]|0,$t=lt.words[Gt]|0,Ct=_t*$t+qt,wt+=Ct/67108864|0,qt=Ct&67108863}pt.words[dt]=qt|0,vt=wt|0}return vt!==0?pt.words[dt]=vt|0:pt.length--,pt._strip()}var Et=function(lt,pt,bt){var _t=lt.words,$t=pt.words,Ct=bt.words,xt=0,vt,dt,wt,qt=_t[0]|0,Pt=qt&8191,Gt=qt>>>13,Wt=_t[1]|0,Vt=Wt&8191,Ut=Wt>>>13,Mt=_t[2]|0,Lt=Mt&8191,Yt=Mt>>>13,lr=_t[3]|0,cr=lr&8191,ir=lr>>>13,Zt=_t[4]|0,Bt=Zt&8191,Ft=Zt>>>13,zt=_t[5]|0,Qt=zt&8191,nr=zt>>>13,gr=_t[6]|0,br=gr&8191,vr=gr>>>13,Nr=_t[7]|0,ar=Nr&8191,er=Nr>>>13,Xt=_t[8]|0,tr=Xt&8191,ur=Xt>>>13,pr=_t[9]|0,yr=pr&8191,wr=pr>>>13,Gr=$t[0]|0,$r=Gr&8191,Er=Gr>>>13,Wr=$t[1]|0,Vr=Wr&8191,Pr=Wr>>>13,nn=$t[2]|0,Kr=nn&8191,Dr=nn>>>13,Qr=$t[3]|0,Or=Qr&8191,Cr=Qr>>>13,Zr=$t[4]|0,Fr=Zr&8191,Ar=Zr>>>13,Xr=$t[5]|0,Mr=Xr&8191,Sr=Xr>>>13,Jr=$t[6]|0,Ur=Jr&8191,Rr=Jr>>>13,en=$t[7]|0,Br=en&8191,Ir=en>>>13,tn=$t[8]|0,qr=tn&8191,Lr=tn>>>13,sn=$t[9]|0,Hr=sn&8191,jr=sn>>>13;bt.negative=lt.negative^pt.negative,bt.length=19,vt=Math.imul(Pt,$r),dt=Math.imul(Pt,Er),dt=dt+Math.imul(Gt,$r)|0,wt=Math.imul(Gt,Er);var un=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(un>>>26)|0,un&=67108863,vt=Math.imul(Vt,$r),dt=Math.imul(Vt,Er),dt=dt+Math.imul(Ut,$r)|0,wt=Math.imul(Ut,Er),vt=vt+Math.imul(Pt,Vr)|0,dt=dt+Math.imul(Pt,Pr)|0,dt=dt+Math.imul(Gt,Vr)|0,wt=wt+Math.imul(Gt,Pr)|0;var dn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(dn>>>26)|0,dn&=67108863,vt=Math.imul(Lt,$r),dt=Math.imul(Lt,Er),dt=dt+Math.imul(Yt,$r)|0,wt=Math.imul(Yt,Er),vt=vt+Math.imul(Vt,Vr)|0,dt=dt+Math.imul(Vt,Pr)|0,dt=dt+Math.imul(Ut,Vr)|0,wt=wt+Math.imul(Ut,Pr)|0,vt=vt+Math.imul(Pt,Kr)|0,dt=dt+Math.imul(Pt,Dr)|0,dt=dt+Math.imul(Gt,Kr)|0,wt=wt+Math.imul(Gt,Dr)|0;var fn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(fn>>>26)|0,fn&=67108863,vt=Math.imul(cr,$r),dt=Math.imul(cr,Er),dt=dt+Math.imul(ir,$r)|0,wt=Math.imul(ir,Er),vt=vt+Math.imul(Lt,Vr)|0,dt=dt+Math.imul(Lt,Pr)|0,dt=dt+Math.imul(Yt,Vr)|0,wt=wt+Math.imul(Yt,Pr)|0,vt=vt+Math.imul(Vt,Kr)|0,dt=dt+Math.imul(Vt,Dr)|0,dt=dt+Math.imul(Ut,Kr)|0,wt=wt+Math.imul(Ut,Dr)|0,vt=vt+Math.imul(Pt,Or)|0,dt=dt+Math.imul(Pt,Cr)|0,dt=dt+Math.imul(Gt,Or)|0,wt=wt+Math.imul(Gt,Cr)|0;var an=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(an>>>26)|0,an&=67108863,vt=Math.imul(Bt,$r),dt=Math.imul(Bt,Er),dt=dt+Math.imul(Ft,$r)|0,wt=Math.imul(Ft,Er),vt=vt+Math.imul(cr,Vr)|0,dt=dt+Math.imul(cr,Pr)|0,dt=dt+Math.imul(ir,Vr)|0,wt=wt+Math.imul(ir,Pr)|0,vt=vt+Math.imul(Lt,Kr)|0,dt=dt+Math.imul(Lt,Dr)|0,dt=dt+Math.imul(Yt,Kr)|0,wt=wt+Math.imul(Yt,Dr)|0,vt=vt+Math.imul(Vt,Or)|0,dt=dt+Math.imul(Vt,Cr)|0,dt=dt+Math.imul(Ut,Or)|0,wt=wt+Math.imul(Ut,Cr)|0,vt=vt+Math.imul(Pt,Fr)|0,dt=dt+Math.imul(Pt,Ar)|0,dt=dt+Math.imul(Gt,Fr)|0,wt=wt+Math.imul(Gt,Ar)|0;var pn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(pn>>>26)|0,pn&=67108863,vt=Math.imul(Qt,$r),dt=Math.imul(Qt,Er),dt=dt+Math.imul(nr,$r)|0,wt=Math.imul(nr,Er),vt=vt+Math.imul(Bt,Vr)|0,dt=dt+Math.imul(Bt,Pr)|0,dt=dt+Math.imul(Ft,Vr)|0,wt=wt+Math.imul(Ft,Pr)|0,vt=vt+Math.imul(cr,Kr)|0,dt=dt+Math.imul(cr,Dr)|0,dt=dt+Math.imul(ir,Kr)|0,wt=wt+Math.imul(ir,Dr)|0,vt=vt+Math.imul(Lt,Or)|0,dt=dt+Math.imul(Lt,Cr)|0,dt=dt+Math.imul(Yt,Or)|0,wt=wt+Math.imul(Yt,Cr)|0,vt=vt+Math.imul(Vt,Fr)|0,dt=dt+Math.imul(Vt,Ar)|0,dt=dt+Math.imul(Ut,Fr)|0,wt=wt+Math.imul(Ut,Ar)|0,vt=vt+Math.imul(Pt,Mr)|0,dt=dt+Math.imul(Pt,Sr)|0,dt=dt+Math.imul(Gt,Mr)|0,wt=wt+Math.imul(Gt,Sr)|0;var _n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(_n>>>26)|0,_n&=67108863,vt=Math.imul(br,$r),dt=Math.imul(br,Er),dt=dt+Math.imul(vr,$r)|0,wt=Math.imul(vr,Er),vt=vt+Math.imul(Qt,Vr)|0,dt=dt+Math.imul(Qt,Pr)|0,dt=dt+Math.imul(nr,Vr)|0,wt=wt+Math.imul(nr,Pr)|0,vt=vt+Math.imul(Bt,Kr)|0,dt=dt+Math.imul(Bt,Dr)|0,dt=dt+Math.imul(Ft,Kr)|0,wt=wt+Math.imul(Ft,Dr)|0,vt=vt+Math.imul(cr,Or)|0,dt=dt+Math.imul(cr,Cr)|0,dt=dt+Math.imul(ir,Or)|0,wt=wt+Math.imul(ir,Cr)|0,vt=vt+Math.imul(Lt,Fr)|0,dt=dt+Math.imul(Lt,Ar)|0,dt=dt+Math.imul(Yt,Fr)|0,wt=wt+Math.imul(Yt,Ar)|0,vt=vt+Math.imul(Vt,Mr)|0,dt=dt+Math.imul(Vt,Sr)|0,dt=dt+Math.imul(Ut,Mr)|0,wt=wt+Math.imul(Ut,Sr)|0,vt=vt+Math.imul(Pt,Ur)|0,dt=dt+Math.imul(Pt,Rr)|0,dt=dt+Math.imul(Gt,Ur)|0,wt=wt+Math.imul(Gt,Rr)|0;var Tn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,vt=Math.imul(ar,$r),dt=Math.imul(ar,Er),dt=dt+Math.imul(er,$r)|0,wt=Math.imul(er,Er),vt=vt+Math.imul(br,Vr)|0,dt=dt+Math.imul(br,Pr)|0,dt=dt+Math.imul(vr,Vr)|0,wt=wt+Math.imul(vr,Pr)|0,vt=vt+Math.imul(Qt,Kr)|0,dt=dt+Math.imul(Qt,Dr)|0,dt=dt+Math.imul(nr,Kr)|0,wt=wt+Math.imul(nr,Dr)|0,vt=vt+Math.imul(Bt,Or)|0,dt=dt+Math.imul(Bt,Cr)|0,dt=dt+Math.imul(Ft,Or)|0,wt=wt+Math.imul(Ft,Cr)|0,vt=vt+Math.imul(cr,Fr)|0,dt=dt+Math.imul(cr,Ar)|0,dt=dt+Math.imul(ir,Fr)|0,wt=wt+Math.imul(ir,Ar)|0,vt=vt+Math.imul(Lt,Mr)|0,dt=dt+Math.imul(Lt,Sr)|0,dt=dt+Math.imul(Yt,Mr)|0,wt=wt+Math.imul(Yt,Sr)|0,vt=vt+Math.imul(Vt,Ur)|0,dt=dt+Math.imul(Vt,Rr)|0,dt=dt+Math.imul(Ut,Ur)|0,wt=wt+Math.imul(Ut,Rr)|0,vt=vt+Math.imul(Pt,Br)|0,dt=dt+Math.imul(Pt,Ir)|0,dt=dt+Math.imul(Gt,Br)|0,wt=wt+Math.imul(Gt,Ir)|0;var gn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(gn>>>26)|0,gn&=67108863,vt=Math.imul(tr,$r),dt=Math.imul(tr,Er),dt=dt+Math.imul(ur,$r)|0,wt=Math.imul(ur,Er),vt=vt+Math.imul(ar,Vr)|0,dt=dt+Math.imul(ar,Pr)|0,dt=dt+Math.imul(er,Vr)|0,wt=wt+Math.imul(er,Pr)|0,vt=vt+Math.imul(br,Kr)|0,dt=dt+Math.imul(br,Dr)|0,dt=dt+Math.imul(vr,Kr)|0,wt=wt+Math.imul(vr,Dr)|0,vt=vt+Math.imul(Qt,Or)|0,dt=dt+Math.imul(Qt,Cr)|0,dt=dt+Math.imul(nr,Or)|0,wt=wt+Math.imul(nr,Cr)|0,vt=vt+Math.imul(Bt,Fr)|0,dt=dt+Math.imul(Bt,Ar)|0,dt=dt+Math.imul(Ft,Fr)|0,wt=wt+Math.imul(Ft,Ar)|0,vt=vt+Math.imul(cr,Mr)|0,dt=dt+Math.imul(cr,Sr)|0,dt=dt+Math.imul(ir,Mr)|0,wt=wt+Math.imul(ir,Sr)|0,vt=vt+Math.imul(Lt,Ur)|0,dt=dt+Math.imul(Lt,Rr)|0,dt=dt+Math.imul(Yt,Ur)|0,wt=wt+Math.imul(Yt,Rr)|0,vt=vt+Math.imul(Vt,Br)|0,dt=dt+Math.imul(Vt,Ir)|0,dt=dt+Math.imul(Ut,Br)|0,wt=wt+Math.imul(Ut,Ir)|0,vt=vt+Math.imul(Pt,qr)|0,dt=dt+Math.imul(Pt,Lr)|0,dt=dt+Math.imul(Gt,qr)|0,wt=wt+Math.imul(Gt,Lr)|0;var En=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(En>>>26)|0,En&=67108863,vt=Math.imul(yr,$r),dt=Math.imul(yr,Er),dt=dt+Math.imul(wr,$r)|0,wt=Math.imul(wr,Er),vt=vt+Math.imul(tr,Vr)|0,dt=dt+Math.imul(tr,Pr)|0,dt=dt+Math.imul(ur,Vr)|0,wt=wt+Math.imul(ur,Pr)|0,vt=vt+Math.imul(ar,Kr)|0,dt=dt+Math.imul(ar,Dr)|0,dt=dt+Math.imul(er,Kr)|0,wt=wt+Math.imul(er,Dr)|0,vt=vt+Math.imul(br,Or)|0,dt=dt+Math.imul(br,Cr)|0,dt=dt+Math.imul(vr,Or)|0,wt=wt+Math.imul(vr,Cr)|0,vt=vt+Math.imul(Qt,Fr)|0,dt=dt+Math.imul(Qt,Ar)|0,dt=dt+Math.imul(nr,Fr)|0,wt=wt+Math.imul(nr,Ar)|0,vt=vt+Math.imul(Bt,Mr)|0,dt=dt+Math.imul(Bt,Sr)|0,dt=dt+Math.imul(Ft,Mr)|0,wt=wt+Math.imul(Ft,Sr)|0,vt=vt+Math.imul(cr,Ur)|0,dt=dt+Math.imul(cr,Rr)|0,dt=dt+Math.imul(ir,Ur)|0,wt=wt+Math.imul(ir,Rr)|0,vt=vt+Math.imul(Lt,Br)|0,dt=dt+Math.imul(Lt,Ir)|0,dt=dt+Math.imul(Yt,Br)|0,wt=wt+Math.imul(Yt,Ir)|0,vt=vt+Math.imul(Vt,qr)|0,dt=dt+Math.imul(Vt,Lr)|0,dt=dt+Math.imul(Ut,qr)|0,wt=wt+Math.imul(Ut,Lr)|0,vt=vt+Math.imul(Pt,Hr)|0,dt=dt+Math.imul(Pt,jr)|0,dt=dt+Math.imul(Gt,Hr)|0,wt=wt+Math.imul(Gt,jr)|0;var Cn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,vt=Math.imul(yr,Vr),dt=Math.imul(yr,Pr),dt=dt+Math.imul(wr,Vr)|0,wt=Math.imul(wr,Pr),vt=vt+Math.imul(tr,Kr)|0,dt=dt+Math.imul(tr,Dr)|0,dt=dt+Math.imul(ur,Kr)|0,wt=wt+Math.imul(ur,Dr)|0,vt=vt+Math.imul(ar,Or)|0,dt=dt+Math.imul(ar,Cr)|0,dt=dt+Math.imul(er,Or)|0,wt=wt+Math.imul(er,Cr)|0,vt=vt+Math.imul(br,Fr)|0,dt=dt+Math.imul(br,Ar)|0,dt=dt+Math.imul(vr,Fr)|0,wt=wt+Math.imul(vr,Ar)|0,vt=vt+Math.imul(Qt,Mr)|0,dt=dt+Math.imul(Qt,Sr)|0,dt=dt+Math.imul(nr,Mr)|0,wt=wt+Math.imul(nr,Sr)|0,vt=vt+Math.imul(Bt,Ur)|0,dt=dt+Math.imul(Bt,Rr)|0,dt=dt+Math.imul(Ft,Ur)|0,wt=wt+Math.imul(Ft,Rr)|0,vt=vt+Math.imul(cr,Br)|0,dt=dt+Math.imul(cr,Ir)|0,dt=dt+Math.imul(ir,Br)|0,wt=wt+Math.imul(ir,Ir)|0,vt=vt+Math.imul(Lt,qr)|0,dt=dt+Math.imul(Lt,Lr)|0,dt=dt+Math.imul(Yt,qr)|0,wt=wt+Math.imul(Yt,Lr)|0,vt=vt+Math.imul(Vt,Hr)|0,dt=dt+Math.imul(Vt,jr)|0,dt=dt+Math.imul(Ut,Hr)|0,wt=wt+Math.imul(Ut,jr)|0;var mn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(mn>>>26)|0,mn&=67108863,vt=Math.imul(yr,Kr),dt=Math.imul(yr,Dr),dt=dt+Math.imul(wr,Kr)|0,wt=Math.imul(wr,Dr),vt=vt+Math.imul(tr,Or)|0,dt=dt+Math.imul(tr,Cr)|0,dt=dt+Math.imul(ur,Or)|0,wt=wt+Math.imul(ur,Cr)|0,vt=vt+Math.imul(ar,Fr)|0,dt=dt+Math.imul(ar,Ar)|0,dt=dt+Math.imul(er,Fr)|0,wt=wt+Math.imul(er,Ar)|0,vt=vt+Math.imul(br,Mr)|0,dt=dt+Math.imul(br,Sr)|0,dt=dt+Math.imul(vr,Mr)|0,wt=wt+Math.imul(vr,Sr)|0,vt=vt+Math.imul(Qt,Ur)|0,dt=dt+Math.imul(Qt,Rr)|0,dt=dt+Math.imul(nr,Ur)|0,wt=wt+Math.imul(nr,Rr)|0,vt=vt+Math.imul(Bt,Br)|0,dt=dt+Math.imul(Bt,Ir)|0,dt=dt+Math.imul(Ft,Br)|0,wt=wt+Math.imul(Ft,Ir)|0,vt=vt+Math.imul(cr,qr)|0,dt=dt+Math.imul(cr,Lr)|0,dt=dt+Math.imul(ir,qr)|0,wt=wt+Math.imul(ir,Lr)|0,vt=vt+Math.imul(Lt,Hr)|0,dt=dt+Math.imul(Lt,jr)|0,dt=dt+Math.imul(Yt,Hr)|0,wt=wt+Math.imul(Yt,jr)|0;var xn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(xn>>>26)|0,xn&=67108863,vt=Math.imul(yr,Or),dt=Math.imul(yr,Cr),dt=dt+Math.imul(wr,Or)|0,wt=Math.imul(wr,Cr),vt=vt+Math.imul(tr,Fr)|0,dt=dt+Math.imul(tr,Ar)|0,dt=dt+Math.imul(ur,Fr)|0,wt=wt+Math.imul(ur,Ar)|0,vt=vt+Math.imul(ar,Mr)|0,dt=dt+Math.imul(ar,Sr)|0,dt=dt+Math.imul(er,Mr)|0,wt=wt+Math.imul(er,Sr)|0,vt=vt+Math.imul(br,Ur)|0,dt=dt+Math.imul(br,Rr)|0,dt=dt+Math.imul(vr,Ur)|0,wt=wt+Math.imul(vr,Rr)|0,vt=vt+Math.imul(Qt,Br)|0,dt=dt+Math.imul(Qt,Ir)|0,dt=dt+Math.imul(nr,Br)|0,wt=wt+Math.imul(nr,Ir)|0,vt=vt+Math.imul(Bt,qr)|0,dt=dt+Math.imul(Bt,Lr)|0,dt=dt+Math.imul(Ft,qr)|0,wt=wt+Math.imul(Ft,Lr)|0,vt=vt+Math.imul(cr,Hr)|0,dt=dt+Math.imul(cr,jr)|0,dt=dt+Math.imul(ir,Hr)|0,wt=wt+Math.imul(ir,jr)|0;var An=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(An>>>26)|0,An&=67108863,vt=Math.imul(yr,Fr),dt=Math.imul(yr,Ar),dt=dt+Math.imul(wr,Fr)|0,wt=Math.imul(wr,Ar),vt=vt+Math.imul(tr,Mr)|0,dt=dt+Math.imul(tr,Sr)|0,dt=dt+Math.imul(ur,Mr)|0,wt=wt+Math.imul(ur,Sr)|0,vt=vt+Math.imul(ar,Ur)|0,dt=dt+Math.imul(ar,Rr)|0,dt=dt+Math.imul(er,Ur)|0,wt=wt+Math.imul(er,Rr)|0,vt=vt+Math.imul(br,Br)|0,dt=dt+Math.imul(br,Ir)|0,dt=dt+Math.imul(vr,Br)|0,wt=wt+Math.imul(vr,Ir)|0,vt=vt+Math.imul(Qt,qr)|0,dt=dt+Math.imul(Qt,Lr)|0,dt=dt+Math.imul(nr,qr)|0,wt=wt+Math.imul(nr,Lr)|0,vt=vt+Math.imul(Bt,Hr)|0,dt=dt+Math.imul(Bt,jr)|0,dt=dt+Math.imul(Ft,Hr)|0,wt=wt+Math.imul(Ft,jr)|0;var $n=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+($n>>>26)|0,$n&=67108863,vt=Math.imul(yr,Mr),dt=Math.imul(yr,Sr),dt=dt+Math.imul(wr,Mr)|0,wt=Math.imul(wr,Sr),vt=vt+Math.imul(tr,Ur)|0,dt=dt+Math.imul(tr,Rr)|0,dt=dt+Math.imul(ur,Ur)|0,wt=wt+Math.imul(ur,Rr)|0,vt=vt+Math.imul(ar,Br)|0,dt=dt+Math.imul(ar,Ir)|0,dt=dt+Math.imul(er,Br)|0,wt=wt+Math.imul(er,Ir)|0,vt=vt+Math.imul(br,qr)|0,dt=dt+Math.imul(br,Lr)|0,dt=dt+Math.imul(vr,qr)|0,wt=wt+Math.imul(vr,Lr)|0,vt=vt+Math.imul(Qt,Hr)|0,dt=dt+Math.imul(Qt,jr)|0,dt=dt+Math.imul(nr,Hr)|0,wt=wt+Math.imul(nr,jr)|0;var Rn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,vt=Math.imul(yr,Ur),dt=Math.imul(yr,Rr),dt=dt+Math.imul(wr,Ur)|0,wt=Math.imul(wr,Rr),vt=vt+Math.imul(tr,Br)|0,dt=dt+Math.imul(tr,Ir)|0,dt=dt+Math.imul(ur,Br)|0,wt=wt+Math.imul(ur,Ir)|0,vt=vt+Math.imul(ar,qr)|0,dt=dt+Math.imul(ar,Lr)|0,dt=dt+Math.imul(er,qr)|0,wt=wt+Math.imul(er,Lr)|0,vt=vt+Math.imul(br,Hr)|0,dt=dt+Math.imul(br,jr)|0,dt=dt+Math.imul(vr,Hr)|0,wt=wt+Math.imul(vr,jr)|0;var Sn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(Sn>>>26)|0,Sn&=67108863,vt=Math.imul(yr,Br),dt=Math.imul(yr,Ir),dt=dt+Math.imul(wr,Br)|0,wt=Math.imul(wr,Ir),vt=vt+Math.imul(tr,qr)|0,dt=dt+Math.imul(tr,Lr)|0,dt=dt+Math.imul(ur,qr)|0,wt=wt+Math.imul(ur,Lr)|0,vt=vt+Math.imul(ar,Hr)|0,dt=dt+Math.imul(ar,jr)|0,dt=dt+Math.imul(er,Hr)|0,wt=wt+Math.imul(er,jr)|0;var In=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(In>>>26)|0,In&=67108863,vt=Math.imul(yr,qr),dt=Math.imul(yr,Lr),dt=dt+Math.imul(wr,qr)|0,wt=Math.imul(wr,Lr),vt=vt+Math.imul(tr,Hr)|0,dt=dt+Math.imul(tr,jr)|0,dt=dt+Math.imul(ur,Hr)|0,wt=wt+Math.imul(ur,jr)|0;var kn=(xt+vt|0)+((dt&8191)<<13)|0;xt=(wt+(dt>>>13)|0)+(kn>>>26)|0,kn&=67108863,vt=Math.imul(yr,Hr),dt=Math.imul(yr,jr),dt=dt+Math.imul(wr,Hr)|0,wt=Math.imul(wr,jr);var Pn=(xt+vt|0)+((dt&8191)<<13)|0;return xt=(wt+(dt>>>13)|0)+(Pn>>>26)|0,Pn&=67108863,Ct[0]=un,Ct[1]=dn,Ct[2]=fn,Ct[3]=an,Ct[4]=pn,Ct[5]=_n,Ct[6]=Tn,Ct[7]=gn,Ct[8]=En,Ct[9]=Cn,Ct[10]=mn,Ct[11]=xn,Ct[12]=An,Ct[13]=$n,Ct[14]=Rn,Ct[15]=Sn,Ct[16]=In,Ct[17]=kn,Ct[18]=Pn,xt!==0&&(Ct[19]=xt,bt.length++),bt};Math.imul||(Et=gt);function St(yt,lt,pt){pt.negative=lt.negative^yt.negative,pt.length=yt.length+lt.length;for(var bt=0,_t=0,$t=0;$t<pt.length-1;$t++){var Ct=_t;_t=0;for(var xt=bt&67108863,vt=Math.min($t,lt.length-1),dt=Math.max(0,$t-yt.length+1);dt<=vt;dt++){var wt=$t-dt,qt=yt.words[wt]|0,Pt=lt.words[dt]|0,Gt=qt*Pt,Wt=Gt&67108863;Ct=Ct+(Gt/67108864|0)|0,Wt=Wt+xt|0,xt=Wt&67108863,Ct=Ct+(Wt>>>26)|0,_t+=Ct>>>26,Ct&=67108863}pt.words[$t]=xt,bt=Ct,Ct=_t}return bt!==0?pt.words[$t]=bt:pt.length--,pt._strip()}function At(yt,lt,pt){return St(yt,lt,pt)}tt.prototype.mulTo=function(lt,pt){var bt,_t=this.length+lt.length;return this.length===10&&lt.length===10?bt=Et(this,lt,pt):_t<63?bt=gt(this,lt,pt):_t<1024?bt=St(this,lt,pt):bt=At(this,lt,pt),bt},tt.prototype.mul=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),this.mulTo(lt,pt)},tt.prototype.mulf=function(lt){var pt=new tt(null);return pt.words=new Array(this.length+lt.length),At(this,lt,pt)},tt.prototype.imul=function(lt){return this.clone().mulTo(lt,this)},tt.prototype.imuln=function(lt){var pt=lt<0;pt&&(lt=-lt),j(typeof lt=="number"),j(lt<67108864);for(var bt=0,_t=0;_t<this.length;_t++){var $t=(this.words[_t]|0)*lt,Ct=($t&67108863)+(bt&67108863);bt>>=26,bt+=$t/67108864|0,bt+=Ct>>>26,this.words[_t]=Ct&67108863}return bt!==0&&(this.words[_t]=bt,this.length++),pt?this.ineg():this},tt.prototype.muln=function(lt){return this.clone().imuln(lt)},tt.prototype.sqr=function(){return this.mul(this)},tt.prototype.isqr=function(){return this.imul(this.clone())},tt.prototype.pow=function(lt){var pt=mt(lt);if(pt.length===0)return new tt(1);for(var bt=this,_t=0;_t<pt.length&&pt[_t]===0;_t++,bt=bt.sqr());if(++_t<pt.length)for(var $t=bt.sqr();_t<pt.length;_t++,$t=$t.sqr())pt[_t]!==0&&(bt=bt.mul($t));return bt},tt.prototype.iushln=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=67108863>>>26-pt<<26-pt,$t;if(pt!==0){var Ct=0;for($t=0;$t<this.length;$t++){var xt=this.words[$t]&_t,vt=(this.words[$t]|0)-xt<<pt;this.words[$t]=vt|Ct,Ct=xt>>>26-pt}Ct&&(this.words[$t]=Ct,this.length++)}if(bt!==0){for($t=this.length-1;$t>=0;$t--)this.words[$t+bt]=this.words[$t];for($t=0;$t<bt;$t++)this.words[$t]=0;this.length+=bt}return this._strip()},tt.prototype.ishln=function(lt){return j(this.negative===0),this.iushln(lt)},tt.prototype.iushrn=function(lt,pt,bt){j(typeof lt=="number"&&lt>=0);var _t;pt?_t=(pt-pt%26)/26:_t=0;var $t=lt%26,Ct=Math.min((lt-$t)/26,this.length),xt=67108863^67108863>>>$t<<$t,vt=bt;if(_t-=Ct,_t=Math.max(0,_t),vt){for(var dt=0;dt<Ct;dt++)vt.words[dt]=this.words[dt];vt.length=Ct}if(Ct!==0)if(this.length>Ct)for(this.length-=Ct,dt=0;dt<this.length;dt++)this.words[dt]=this.words[dt+Ct];else this.words[0]=0,this.length=1;var wt=0;for(dt=this.length-1;dt>=0&&(wt!==0||dt>=_t);dt--){var qt=this.words[dt]|0;this.words[dt]=wt<<26-$t|qt>>>$t,wt=qt&xt}return vt&&wt!==0&&(vt.words[vt.length++]=wt),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},tt.prototype.ishrn=function(lt,pt,bt){return j(this.negative===0),this.iushrn(lt,pt,bt)},tt.prototype.shln=function(lt){return this.clone().ishln(lt)},tt.prototype.ushln=function(lt){return this.clone().iushln(lt)},tt.prototype.shrn=function(lt){return this.clone().ishrn(lt)},tt.prototype.ushrn=function(lt){return this.clone().iushrn(lt)},tt.prototype.testn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return!1;var $t=this.words[bt];return!!($t&_t)},tt.prototype.imaskn=function(lt){j(typeof lt=="number"&&lt>=0);var pt=lt%26,bt=(lt-pt)/26;if(j(this.negative===0,"imaskn works only with positive numbers"),this.length<=bt)return this;if(pt!==0&&bt++,this.length=Math.min(bt,this.length),pt!==0){var _t=67108863^67108863>>>pt<<pt;this.words[this.length-1]&=_t}return this._strip()},tt.prototype.maskn=function(lt){return this.clone().imaskn(lt)},tt.prototype.iaddn=function(lt){return j(typeof lt=="number"),j(lt<67108864),lt<0?this.isubn(-lt):this.negative!==0?this.length===1&&(this.words[0]|0)<=lt?(this.words[0]=lt-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(lt),this.negative=1,this):this._iaddn(lt)},tt.prototype._iaddn=function(lt){this.words[0]+=lt;for(var pt=0;pt<this.length&&this.words[pt]>=67108864;pt++)this.words[pt]-=67108864,pt===this.length-1?this.words[pt+1]=1:this.words[pt+1]++;return this.length=Math.max(this.length,pt+1),this},tt.prototype.isubn=function(lt){if(j(typeof lt=="number"),j(lt<67108864),lt<0)return this.iaddn(-lt);if(this.negative!==0)return this.negative=0,this.iaddn(lt),this.negative=1,this;if(this.words[0]-=lt,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var pt=0;pt<this.length&&this.words[pt]<0;pt++)this.words[pt]+=67108864,this.words[pt+1]-=1;return this._strip()},tt.prototype.addn=function(lt){return this.clone().iaddn(lt)},tt.prototype.subn=function(lt){return this.clone().isubn(lt)},tt.prototype.iabs=function(){return this.negative=0,this},tt.prototype.abs=function(){return this.clone().iabs()},tt.prototype._ishlnsubmul=function(lt,pt,bt){var _t=lt.length+bt,$t;this._expand(_t);var Ct,xt=0;for($t=0;$t<lt.length;$t++){Ct=(this.words[$t+bt]|0)+xt;var vt=(lt.words[$t]|0)*pt;Ct-=vt&67108863,xt=(Ct>>26)-(vt/67108864|0),this.words[$t+bt]=Ct&67108863}for(;$t<this.length-bt;$t++)Ct=(this.words[$t+bt]|0)+xt,xt=Ct>>26,this.words[$t+bt]=Ct&67108863;if(xt===0)return this._strip();for(j(xt===-1),xt=0,$t=0;$t<this.length;$t++)Ct=-(this.words[$t]|0)+xt,xt=Ct>>26,this.words[$t]=Ct&67108863;return this.negative=1,this._strip()},tt.prototype._wordDiv=function(lt,pt){var bt=this.length-lt.length,_t=this.clone(),$t=lt,Ct=$t.words[$t.length-1]|0,xt=this._countBits(Ct);bt=26-xt,bt!==0&&($t=$t.ushln(bt),_t.iushln(bt),Ct=$t.words[$t.length-1]|0);var vt=_t.length-$t.length,dt;if(pt!=="mod"){dt=new tt(null),dt.length=vt+1,dt.words=new Array(dt.length);for(var wt=0;wt<dt.length;wt++)dt.words[wt]=0}var qt=_t.clone()._ishlnsubmul($t,1,vt);qt.negative===0&&(_t=qt,dt&&(dt.words[vt]=1));for(var Pt=vt-1;Pt>=0;Pt--){var Gt=(_t.words[$t.length+Pt]|0)*67108864+(_t.words[$t.length+Pt-1]|0);for(Gt=Math.min(Gt/Ct|0,67108863),_t._ishlnsubmul($t,Gt,Pt);_t.negative!==0;)Gt--,_t.negative=0,_t._ishlnsubmul($t,1,Pt),_t.isZero()||(_t.negative^=1);dt&&(dt.words[Pt]=Gt)}return dt&&dt._strip(),_t._strip(),pt!=="div"&&bt!==0&&_t.iushrn(bt),{div:dt||null,mod:_t}},tt.prototype.divmod=function(lt,pt,bt){if(j(!lt.isZero()),this.isZero())return{div:new tt(0),mod:new tt(0)};var _t,$t,Ct;return this.negative!==0&&lt.negative===0?(Ct=this.neg().divmod(lt,pt),pt!=="mod"&&(_t=Ct.div.neg()),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.iadd(lt)),{div:_t,mod:$t}):this.negative===0&&lt.negative!==0?(Ct=this.divmod(lt.neg(),pt),pt!=="mod"&&(_t=Ct.div.neg()),{div:_t,mod:Ct.mod}):this.negative&lt.negative?(Ct=this.neg().divmod(lt.neg(),pt),pt!=="div"&&($t=Ct.mod.neg(),bt&&$t.negative!==0&&$t.isub(lt)),{div:Ct.div,mod:$t}):lt.length>this.length||this.cmp(lt)<0?{div:new tt(0),mod:this}:lt.length===1?pt==="div"?{div:this.divn(lt.words[0]),mod:null}:pt==="mod"?{div:null,mod:new tt(this.modrn(lt.words[0]))}:{div:this.divn(lt.words[0]),mod:new tt(this.modrn(lt.words[0]))}:this._wordDiv(lt,pt)},tt.prototype.div=function(lt){return this.divmod(lt,"div",!1).div},tt.prototype.mod=function(lt){return this.divmod(lt,"mod",!1).mod},tt.prototype.umod=function(lt){return this.divmod(lt,"mod",!0).mod},tt.prototype.divRound=function(lt){var pt=this.divmod(lt);if(pt.mod.isZero())return pt.div;var bt=pt.div.negative!==0?pt.mod.isub(lt):pt.mod,_t=lt.ushrn(1),$t=lt.andln(1),Ct=bt.cmp(_t);return Ct<0||$t===1&&Ct===0?pt.div:pt.div.negative!==0?pt.div.isubn(1):pt.div.iaddn(1)},tt.prototype.modrn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=(1<<26)%lt,_t=0,$t=this.length-1;$t>=0;$t--)_t=(bt*_t+(this.words[$t]|0))%lt;return pt?-_t:_t},tt.prototype.modn=function(lt){return this.modrn(lt)},tt.prototype.idivn=function(lt){var pt=lt<0;pt&&(lt=-lt),j(lt<=67108863);for(var bt=0,_t=this.length-1;_t>=0;_t--){var $t=(this.words[_t]|0)+bt*67108864;this.words[_t]=$t/lt|0,bt=$t%lt}return this._strip(),pt?this.ineg():this},tt.prototype.divn=function(lt){return this.clone().idivn(lt)},tt.prototype.egcd=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=new tt(0),xt=new tt(1),vt=0;pt.isEven()&&bt.isEven();)pt.iushrn(1),bt.iushrn(1),++vt;for(var dt=bt.clone(),wt=pt.clone();!pt.isZero();){for(var qt=0,Pt=1;!(pt.words[0]&Pt)&&qt<26;++qt,Pt<<=1);if(qt>0)for(pt.iushrn(qt);qt-- >0;)(_t.isOdd()||$t.isOdd())&&(_t.iadd(dt),$t.isub(wt)),_t.iushrn(1),$t.iushrn(1);for(var Gt=0,Wt=1;!(bt.words[0]&Wt)&&Gt<26;++Gt,Wt<<=1);if(Gt>0)for(bt.iushrn(Gt);Gt-- >0;)(Ct.isOdd()||xt.isOdd())&&(Ct.iadd(dt),xt.isub(wt)),Ct.iushrn(1),xt.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub(Ct),$t.isub(xt)):(bt.isub(pt),Ct.isub(_t),xt.isub($t))}return{a:Ct,b:xt,gcd:bt.iushln(vt)}},tt.prototype._invmp=function(lt){j(lt.negative===0),j(!lt.isZero());var pt=this,bt=lt.clone();pt.negative!==0?pt=pt.umod(lt):pt=pt.clone();for(var _t=new tt(1),$t=new tt(0),Ct=bt.clone();pt.cmpn(1)>0&&bt.cmpn(1)>0;){for(var xt=0,vt=1;!(pt.words[0]&vt)&&xt<26;++xt,vt<<=1);if(xt>0)for(pt.iushrn(xt);xt-- >0;)_t.isOdd()&&_t.iadd(Ct),_t.iushrn(1);for(var dt=0,wt=1;!(bt.words[0]&wt)&&dt<26;++dt,wt<<=1);if(dt>0)for(bt.iushrn(dt);dt-- >0;)$t.isOdd()&&$t.iadd(Ct),$t.iushrn(1);pt.cmp(bt)>=0?(pt.isub(bt),_t.isub($t)):(bt.isub(pt),$t.isub(_t))}var qt;return pt.cmpn(1)===0?qt=_t:qt=$t,qt.cmpn(0)<0&&qt.iadd(lt),qt},tt.prototype.gcd=function(lt){if(this.isZero())return lt.abs();if(lt.isZero())return this.abs();var pt=this.clone(),bt=lt.clone();pt.negative=0,bt.negative=0;for(var _t=0;pt.isEven()&&bt.isEven();_t++)pt.iushrn(1),bt.iushrn(1);do{for(;pt.isEven();)pt.iushrn(1);for(;bt.isEven();)bt.iushrn(1);var $t=pt.cmp(bt);if($t<0){var Ct=pt;pt=bt,bt=Ct}else if($t===0||bt.cmpn(1)===0)break;pt.isub(bt)}while(!0);return bt.iushln(_t)},tt.prototype.invm=function(lt){return this.egcd(lt).a.umod(lt)},tt.prototype.isEven=function(){return(this.words[0]&1)===0},tt.prototype.isOdd=function(){return(this.words[0]&1)===1},tt.prototype.andln=function(lt){return this.words[0]&lt},tt.prototype.bincn=function(lt){j(typeof lt=="number");var pt=lt%26,bt=(lt-pt)/26,_t=1<<pt;if(this.length<=bt)return this._expand(bt+1),this.words[bt]|=_t,this;for(var $t=_t,Ct=bt;$t!==0&&Ct<this.length;Ct++){var xt=this.words[Ct]|0;xt+=$t,$t=xt>>>26,xt&=67108863,this.words[Ct]=xt}return $t!==0&&(this.words[Ct]=$t,this.length++),this},tt.prototype.isZero=function(){return this.length===1&&this.words[0]===0},tt.prototype.cmpn=function(lt){var pt=lt<0;if(this.negative!==0&&!pt)return-1;if(this.negative===0&&pt)return 1;this._strip();var bt;if(this.length>1)bt=1;else{pt&&(lt=-lt),j(lt<=67108863,"Number is too big");var _t=this.words[0]|0;bt=_t===lt?0:_t<lt?-1:1}return this.negative!==0?-bt|0:bt},tt.prototype.cmp=function(lt){if(this.negative!==0&&lt.negative===0)return-1;if(this.negative===0&&lt.negative!==0)return 1;var pt=this.ucmp(lt);return this.negative!==0?-pt|0:pt},tt.prototype.ucmp=function(lt){if(this.length>lt.length)return 1;if(this.length<lt.length)return-1;for(var pt=0,bt=this.length-1;bt>=0;bt--){var _t=this.words[bt]|0,$t=lt.words[bt]|0;if(_t!==$t){_t<$t?pt=-1:_t>$t&&(pt=1);break}}return pt},tt.prototype.gtn=function(lt){return this.cmpn(lt)===1},tt.prototype.gt=function(lt){return this.cmp(lt)===1},tt.prototype.gten=function(lt){return this.cmpn(lt)>=0},tt.prototype.gte=function(lt){return this.cmp(lt)>=0},tt.prototype.ltn=function(lt){return this.cmpn(lt)===-1},tt.prototype.lt=function(lt){return this.cmp(lt)===-1},tt.prototype.lten=function(lt){return this.cmpn(lt)<=0},tt.prototype.lte=function(lt){return this.cmp(lt)<=0},tt.prototype.eqn=function(lt){return this.cmpn(lt)===0},tt.prototype.eq=function(lt){return this.cmp(lt)===0},tt.red=function(lt){return new Nt(lt)},tt.prototype.toRed=function(lt){return j(!this.red,"Already a number in reduction context"),j(this.negative===0,"red works only with positives"),lt.convertTo(this)._forceRed(lt)},tt.prototype.fromRed=function(){return j(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},tt.prototype._forceRed=function(lt){return this.red=lt,this},tt.prototype.forceRed=function(lt){return j(!this.red,"Already a number in reduction context"),this._forceRed(lt)},tt.prototype.redAdd=function(lt){return j(this.red,"redAdd works only with red numbers"),this.red.add(this,lt)},tt.prototype.redIAdd=function(lt){return j(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,lt)},tt.prototype.redSub=function(lt){return j(this.red,"redSub works only with red numbers"),this.red.sub(this,lt)},tt.prototype.redISub=function(lt){return j(this.red,"redISub works only with red numbers"),this.red.isub(this,lt)},tt.prototype.redShl=function(lt){return j(this.red,"redShl works only with red numbers"),this.red.shl(this,lt)},tt.prototype.redMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.mul(this,lt)},tt.prototype.redIMul=function(lt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,lt),this.red.imul(this,lt)},tt.prototype.redSqr=function(){return j(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},tt.prototype.redISqr=function(){return j(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},tt.prototype.redSqrt=function(){return j(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},tt.prototype.redInvm=function(){return j(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},tt.prototype.redNeg=function(){return j(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},tt.prototype.redPow=function(lt){return j(this.red&&!lt.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,lt)};var kt={k256:null,p224:null,p192:null,p25519:null};function Rt(yt,lt){this.name=yt,this.p=new tt(lt,16),this.n=this.p.bitLength(),this.k=new tt(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Rt.prototype._tmp=function(){var lt=new tt(null);return lt.words=new Array(Math.ceil(this.n/13)),lt},Rt.prototype.ireduce=function(lt){var pt=lt,bt;do this.split(pt,this.tmp),pt=this.imulK(pt),pt=pt.iadd(this.tmp),bt=pt.bitLength();while(bt>this.n);var _t=bt<this.n?-1:pt.ucmp(this.p);return _t===0?(pt.words[0]=0,pt.length=1):_t>0?pt.isub(this.p):pt.strip!==void 0?pt.strip():pt._strip(),pt},Rt.prototype.split=function(lt,pt){lt.iushrn(this.n,0,pt)},Rt.prototype.imulK=function(lt){return lt.imul(this.k)};function Tt(){Rt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}et(Tt,Rt),Tt.prototype.split=function(lt,pt){for(var bt=4194303,_t=Math.min(lt.length,9),$t=0;$t<_t;$t++)pt.words[$t]=lt.words[$t];if(pt.length=_t,lt.length<=9){lt.words[0]=0,lt.length=1;return}var Ct=lt.words[9];for(pt.words[pt.length++]=Ct&bt,$t=10;$t<lt.length;$t++){var xt=lt.words[$t]|0;lt.words[$t-10]=(xt&bt)<<4|Ct>>>22,Ct=xt}Ct>>>=22,lt.words[$t-10]=Ct,Ct===0&&lt.length>10?lt.length-=10:lt.length-=9},Tt.prototype.imulK=function(lt){lt.words[lt.length]=0,lt.words[lt.length+1]=0,lt.length+=2;for(var pt=0,bt=0;bt<lt.length;bt++){var _t=lt.words[bt]|0;pt+=_t*977,lt.words[bt]=pt&67108863,pt=_t*64+(pt/67108864|0)}return lt.words[lt.length-1]===0&&(lt.length--,lt.words[lt.length-1]===0&&lt.length--),lt};function Dt(){Rt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}et(Dt,Rt);function Ot(){Rt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}et(Ot,Rt);function jt(){Rt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}et(jt,Rt),jt.prototype.imulK=function(lt){for(var pt=0,bt=0;bt<lt.length;bt++){var _t=(lt.words[bt]|0)*19+pt,$t=_t&67108863;_t>>>=26,lt.words[bt]=$t,pt=_t}return pt!==0&&(lt.words[lt.length++]=pt),lt},tt._prime=function(lt){if(kt[lt])return kt[lt];var pt;if(lt==="k256")pt=new Tt;else if(lt==="p224")pt=new Dt;else if(lt==="p192")pt=new Ot;else if(lt==="p25519")pt=new jt;else throw new Error("Unknown prime "+lt);return kt[lt]=pt,pt};function Nt(yt){if(typeof yt=="string"){var lt=tt._prime(yt);this.m=lt.p,this.prime=lt}else j(yt.gtn(1),"modulus must be greater than 1"),this.m=yt,this.prime=null}Nt.prototype._verify1=function(lt){j(lt.negative===0,"red works only with positives"),j(lt.red,"red works only with red numbers")},Nt.prototype._verify2=function(lt,pt){j((lt.negative|pt.negative)===0,"red works only with positives"),j(lt.red&&lt.red===pt.red,"red works only with red numbers")},Nt.prototype.imod=function(lt){return this.prime?this.prime.ireduce(lt)._forceRed(this):(ot(lt,lt.umod(this.m)._forceRed(this)),lt)},Nt.prototype.neg=function(lt){return lt.isZero()?lt.clone():this.m.sub(lt)._forceRed(this)},Nt.prototype.add=function(lt,pt){this._verify2(lt,pt);var bt=lt.add(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt._forceRed(this)},Nt.prototype.iadd=function(lt,pt){this._verify2(lt,pt);var bt=lt.iadd(pt);return bt.cmp(this.m)>=0&&bt.isub(this.m),bt},Nt.prototype.sub=function(lt,pt){this._verify2(lt,pt);var bt=lt.sub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt._forceRed(this)},Nt.prototype.isub=function(lt,pt){this._verify2(lt,pt);var bt=lt.isub(pt);return bt.cmpn(0)<0&&bt.iadd(this.m),bt},Nt.prototype.shl=function(lt,pt){return this._verify1(lt),this.imod(lt.ushln(pt))},Nt.prototype.imul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.imul(pt))},Nt.prototype.mul=function(lt,pt){return this._verify2(lt,pt),this.imod(lt.mul(pt))},Nt.prototype.isqr=function(lt){return this.imul(lt,lt.clone())},Nt.prototype.sqr=function(lt){return this.mul(lt,lt)},Nt.prototype.sqrt=function(lt){if(lt.isZero())return lt.clone();var pt=this.m.andln(3);if(j(pt%2===1),pt===3){var bt=this.m.add(new tt(1)).iushrn(2);return this.pow(lt,bt)}for(var _t=this.m.subn(1),$t=0;!_t.isZero()&&_t.andln(1)===0;)$t++,_t.iushrn(1);j(!_t.isZero());var Ct=new tt(1).toRed(this),xt=Ct.redNeg(),vt=this.m.subn(1).iushrn(1),dt=this.m.bitLength();for(dt=new tt(2*dt*dt).toRed(this);this.pow(dt,vt).cmp(xt)!==0;)dt.redIAdd(xt);for(var wt=this.pow(dt,_t),qt=this.pow(lt,_t.addn(1).iushrn(1)),Pt=this.pow(lt,_t),Gt=$t;Pt.cmp(Ct)!==0;){for(var Wt=Pt,Vt=0;Wt.cmp(Ct)!==0;Vt++)Wt=Wt.redSqr();j(Vt<Gt);var Ut=this.pow(wt,new tt(1).iushln(Gt-Vt-1));qt=qt.redMul(Ut),wt=Ut.redSqr(),Pt=Pt.redMul(wt),Gt=Vt}return qt},Nt.prototype.invm=function(lt){var pt=lt._invmp(this.m);return pt.negative!==0?(pt.negative=0,this.imod(pt).redNeg()):this.imod(pt)},Nt.prototype.pow=function(lt,pt){if(pt.isZero())return new tt(1).toRed(this);if(pt.cmpn(1)===0)return lt.clone();var bt=4,_t=new Array(1<<bt);_t[0]=new tt(1).toRed(this),_t[1]=lt;for(var $t=2;$t<_t.length;$t++)_t[$t]=this.mul(_t[$t-1],lt);var Ct=_t[0],xt=0,vt=0,dt=pt.bitLength()%26;for(dt===0&&(dt=26),$t=pt.length-1;$t>=0;$t--){for(var wt=pt.words[$t],qt=dt-1;qt>=0;qt--){var Pt=wt>>qt&1;if(Ct!==_t[0]&&(Ct=this.sqr(Ct)),Pt===0&&xt===0){vt=0;continue}xt<<=1,xt|=Pt,vt++,!(vt!==bt&&($t!==0||qt!==0))&&(Ct=this.mul(Ct,_t[xt]),vt=0,xt=0)}dt=26}return Ct},Nt.prototype.convertTo=function(lt){var pt=lt.umod(this.m);return pt===lt?pt.clone():pt},Nt.prototype.convertFrom=function(lt){var pt=lt.clone();return pt.red=null,pt},tt.mont=function(lt){return new It(lt)};function It(yt){Nt.call(this,yt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new tt(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}et(It,Nt),It.prototype.convertTo=function(lt){return this.imod(lt.ushln(this.shift))},It.prototype.convertFrom=function(lt){var pt=this.imod(lt.mul(this.rinv));return pt.red=null,pt},It.prototype.imul=function(lt,pt){if(lt.isZero()||pt.isZero())return lt.words[0]=0,lt.length=1,lt;var bt=lt.imul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.mul=function(lt,pt){if(lt.isZero()||pt.isZero())return new tt(0)._forceRed(this);var bt=lt.mul(pt),_t=bt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$t=bt.isub(_t).iushrn(this.shift),Ct=$t;return $t.cmp(this.m)>=0?Ct=$t.isub(this.m):$t.cmpn(0)<0&&(Ct=$t.iadd(this.m)),Ct._forceRed(this)},It.prototype.invm=function(lt){var pt=this.imod(lt._invmp(this.m).mul(this.r2));return pt._forceRed(this)}})(_,commonjsGlobal)})(bn);const BN=bnExports;function createCommonjsModule(_,o,$){return $={path:o,exports:{},require:function(j,et){return commonjsRequire(j,et??$.path)}},_($,$.exports),$.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var minimalisticAssert=assert;function assert(_,o){if(!_)throw new Error(o||"Assertion failed")}assert.equal=function _(o,$,j){if(o!=$)throw new Error(j||"Assertion failed: "+o+" != "+$)};var utils_1=createCommonjsModule(function(_,o){var $=o;function j(rt,nt){if(Array.isArray(rt))return rt.slice();if(!rt)return[];var it=[];if(typeof rt!="string"){for(var st=0;st<rt.length;st++)it[st]=rt[st]|0;return it}if(nt==="hex"){rt=rt.replace(/[^a-z0-9]+/ig,""),rt.length%2!==0&&(rt="0"+rt);for(var st=0;st<rt.length;st+=2)it.push(parseInt(rt[st]+rt[st+1],16))}else for(var st=0;st<rt.length;st++){var ot=rt.charCodeAt(st),at=ot>>8,ct=ot&255;at?it.push(at,ct):it.push(ct)}return it}$.toArray=j;function et(rt){return rt.length===1?"0"+rt:rt}$.zero2=et;function tt(rt){for(var nt="",it=0;it<rt.length;it++)nt+=et(rt[it].toString(16));return nt}$.toHex=tt,$.encode=function(nt,it){return it==="hex"?tt(nt):nt}}),utils_1$1=createCommonjsModule(function(_,o){var $=o;$.assert=minimalisticAssert,$.toArray=utils_1.toArray,$.zero2=utils_1.zero2,$.toHex=utils_1.toHex,$.encode=utils_1.encode;function j(it,st,ot){var at=new Array(Math.max(it.bitLength(),ot)+1);at.fill(0);for(var ct=1<<st+1,ut=it.clone(),ft=0;ft<at.length;ft++){var ht,mt=ut.andln(ct-1);ut.isOdd()?(mt>(ct>>1)-1?ht=(ct>>1)-mt:ht=mt,ut.isubn(ht)):ht=0,at[ft]=ht,ut.iushrn(1)}return at}$.getNAF=j;function et(it,st){var ot=[[],[]];it=it.clone(),st=st.clone();for(var at=0,ct=0,ut;it.cmpn(-at)>0||st.cmpn(-ct)>0;){var ft=it.andln(3)+at&3,ht=st.andln(3)+ct&3;ft===3&&(ft=-1),ht===3&&(ht=-1);var mt;ft&1?(ut=it.andln(7)+at&7,(ut===3||ut===5)&&ht===2?mt=-ft:mt=ft):mt=0,ot[0].push(mt);var gt;ht&1?(ut=st.andln(7)+ct&7,(ut===3||ut===5)&&ft===2?gt=-ht:gt=ht):gt=0,ot[1].push(gt),2*at===mt+1&&(at=1-at),2*ct===gt+1&&(ct=1-ct),it.iushrn(1),st.iushrn(1)}return ot}$.getJSF=et;function tt(it,st,ot){var at="_"+st;it.prototype[st]=function(){return this[at]!==void 0?this[at]:this[at]=ot.call(this)}}$.cachedProperty=tt;function rt(it){return typeof it=="string"?$.toArray(it,"hex"):it}$.parseBytes=rt;function nt(it){return new BN(it,"hex","le")}$.intFromLE=nt}),getNAF=utils_1$1.getNAF,getJSF=utils_1$1.getJSF,assert$1=utils_1$1.assert;function BaseCurve(_,o){this.type=_,this.p=new BN(o.p,16),this.red=o.prime?BN.red(o.prime):BN.mont(this.p),this.zero=new BN(0).toRed(this.red),this.one=new BN(1).toRed(this.red),this.two=new BN(2).toRed(this.red),this.n=o.n&&new BN(o.n,16),this.g=o.g&&this.pointFromJSON(o.g,o.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var $=this.n&&this.p.div(this.n);!$||$.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var base$1=BaseCurve;BaseCurve.prototype.point=function _(){throw new Error("Not implemented")};BaseCurve.prototype.validate=function _(){throw new Error("Not implemented")};BaseCurve.prototype._fixedNafMul=function _(o,$){assert$1(o.precomputed);var j=o._getDoubles(),et=getNAF($,1,this._bitLength),tt=(1<<j.step+1)-(j.step%2===0?2:1);tt/=3;var rt=[],nt,it;for(nt=0;nt<et.length;nt+=j.step){it=0;for(var st=nt+j.step-1;st>=nt;st--)it=(it<<1)+et[st];rt.push(it)}for(var ot=this.jpoint(null,null,null),at=this.jpoint(null,null,null),ct=tt;ct>0;ct--){for(nt=0;nt<rt.length;nt++)it=rt[nt],it===ct?at=at.mixedAdd(j.points[nt]):it===-ct&&(at=at.mixedAdd(j.points[nt].neg()));ot=ot.add(at)}return ot.toP()};BaseCurve.prototype._wnafMul=function _(o,$){var j=4,et=o._getNAFPoints(j);j=et.wnd;for(var tt=et.points,rt=getNAF($,j,this._bitLength),nt=this.jpoint(null,null,null),it=rt.length-1;it>=0;it--){for(var st=0;it>=0&&rt[it]===0;it--)st++;if(it>=0&&st++,nt=nt.dblp(st),it<0)break;var ot=rt[it];assert$1(ot!==0),o.type==="affine"?ot>0?nt=nt.mixedAdd(tt[ot-1>>1]):nt=nt.mixedAdd(tt[-ot-1>>1].neg()):ot>0?nt=nt.add(tt[ot-1>>1]):nt=nt.add(tt[-ot-1>>1].neg())}return o.type==="affine"?nt.toP():nt};BaseCurve.prototype._wnafMulAdd=function _(o,$,j,et,tt){var rt=this._wnafT1,nt=this._wnafT2,it=this._wnafT3,st=0,ot,at,ct;for(ot=0;ot<et;ot++){ct=$[ot];var ut=ct._getNAFPoints(o);rt[ot]=ut.wnd,nt[ot]=ut.points}for(ot=et-1;ot>=1;ot-=2){var ft=ot-1,ht=ot;if(rt[ft]!==1||rt[ht]!==1){it[ft]=getNAF(j[ft],rt[ft],this._bitLength),it[ht]=getNAF(j[ht],rt[ht],this._bitLength),st=Math.max(it[ft].length,st),st=Math.max(it[ht].length,st);continue}var mt=[$[ft],null,null,$[ht]];$[ft].y.cmp($[ht].y)===0?(mt[1]=$[ft].add($[ht]),mt[2]=$[ft].toJ().mixedAdd($[ht].neg())):$[ft].y.cmp($[ht].y.redNeg())===0?(mt[1]=$[ft].toJ().mixedAdd($[ht]),mt[2]=$[ft].add($[ht].neg())):(mt[1]=$[ft].toJ().mixedAdd($[ht]),mt[2]=$[ft].toJ().mixedAdd($[ht].neg()));var gt=[-3,-1,-5,-7,0,7,5,1,3],Et=getJSF(j[ft],j[ht]);for(st=Math.max(Et[0].length,st),it[ft]=new Array(st),it[ht]=new Array(st),at=0;at<st;at++){var St=Et[0][at]|0,At=Et[1][at]|0;it[ft][at]=gt[(St+1)*3+(At+1)],it[ht][at]=0,nt[ft]=mt}}var kt=this.jpoint(null,null,null),Rt=this._wnafT4;for(ot=st;ot>=0;ot--){for(var Tt=0;ot>=0;){var Dt=!0;for(at=0;at<et;at++)Rt[at]=it[at][ot]|0,Rt[at]!==0&&(Dt=!1);if(!Dt)break;Tt++,ot--}if(ot>=0&&Tt++,kt=kt.dblp(Tt),ot<0)break;for(at=0;at<et;at++){var Ot=Rt[at];Ot!==0&&(Ot>0?ct=nt[at][Ot-1>>1]:Ot<0&&(ct=nt[at][-Ot-1>>1].neg()),ct.type==="affine"?kt=kt.mixedAdd(ct):kt=kt.add(ct))}}for(ot=0;ot<et;ot++)nt[ot]=null;return tt?kt:kt.toP()};function BasePoint(_,o){this.curve=_,this.type=o,this.precomputed=null}BaseCurve.BasePoint=BasePoint;BasePoint.prototype.eq=function _(){throw new Error("Not implemented")};BasePoint.prototype.validate=function _(){return this.curve.validate(this)};BaseCurve.prototype.decodePoint=function _(o,$){o=utils_1$1.toArray(o,$);var j=this.p.byteLength();if((o[0]===4||o[0]===6||o[0]===7)&&o.length-1===2*j){o[0]===6?assert$1(o[o.length-1]%2===0):o[0]===7&&assert$1(o[o.length-1]%2===1);var et=this.point(o.slice(1,1+j),o.slice(1+j,1+2*j));return et}else if((o[0]===2||o[0]===3)&&o.length-1===j)return this.pointFromX(o.slice(1,1+j),o[0]===3);throw new Error("Unknown point format")};BasePoint.prototype.encodeCompressed=function _(o){return this.encode(o,!0)};BasePoint.prototype._encode=function _(o){var $=this.curve.p.byteLength(),j=this.getX().toArray("be",$);return o?[this.getY().isEven()?2:3].concat(j):[4].concat(j,this.getY().toArray("be",$))};BasePoint.prototype.encode=function _(o,$){return utils_1$1.encode(this._encode($),o)};BasePoint.prototype.precompute=function _(o){if(this.precomputed)return this;var $={doubles:null,naf:null,beta:null};return $.naf=this._getNAFPoints(8),$.doubles=this._getDoubles(4,o),$.beta=this._getBeta(),this.precomputed=$,this};BasePoint.prototype._hasDoubles=function _(o){if(!this.precomputed)return!1;var $=this.precomputed.doubles;return $?$.points.length>=Math.ceil((o.bitLength()+1)/$.step):!1};BasePoint.prototype._getDoubles=function _(o,$){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var j=[this],et=this,tt=0;tt<$;tt+=o){for(var rt=0;rt<o;rt++)et=et.dbl();j.push(et)}return{step:o,points:j}};BasePoint.prototype._getNAFPoints=function _(o){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var $=[this],j=(1<<o)-1,et=j===1?null:this.dbl(),tt=1;tt<j;tt++)$[tt]=$[tt-1].add(et);return{wnd:o,points:$}};BasePoint.prototype._getBeta=function _(){return null};BasePoint.prototype.dblp=function _(o){for(var $=this,j=0;j<o;j++)$=$.dbl();return $};var inherits_browser=createCommonjsModule(function(_){typeof Object.create=="function"?_.exports=function($,j){j&&($.super_=j,$.prototype=Object.create(j.prototype,{constructor:{value:$,enumerable:!1,writable:!0,configurable:!0}}))}:_.exports=function($,j){if(j){$.super_=j;var et=function(){};et.prototype=j.prototype,$.prototype=new et,$.prototype.constructor=$}}}),assert$2=utils_1$1.assert;function ShortCurve(_){base$1.call(this,"short",_),this.a=new BN(_.a,16).toRed(this.red),this.b=new BN(_.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(_),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}inherits_browser(ShortCurve,base$1);var short_1=ShortCurve;ShortCurve.prototype._getEndomorphism=function _(o){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var $,j;if(o.beta)$=new BN(o.beta,16).toRed(this.red);else{var et=this._getEndoRoots(this.p);$=et[0].cmp(et[1])<0?et[0]:et[1],$=$.toRed(this.red)}if(o.lambda)j=new BN(o.lambda,16);else{var tt=this._getEndoRoots(this.n);this.g.mul(tt[0]).x.cmp(this.g.x.redMul($))===0?j=tt[0]:(j=tt[1],assert$2(this.g.mul(j).x.cmp(this.g.x.redMul($))===0))}var rt;return o.basis?rt=o.basis.map(function(nt){return{a:new BN(nt.a,16),b:new BN(nt.b,16)}}):rt=this._getEndoBasis(j),{beta:$,lambda:j,basis:rt}}};ShortCurve.prototype._getEndoRoots=function _(o){var $=o===this.p?this.red:BN.mont(o),j=new BN(2).toRed($).redInvm(),et=j.redNeg(),tt=new BN(3).toRed($).redNeg().redSqrt().redMul(j),rt=et.redAdd(tt).fromRed(),nt=et.redSub(tt).fromRed();return[rt,nt]};ShortCurve.prototype._getEndoBasis=function _(o){for(var $=this.n.ushrn(Math.floor(this.n.bitLength()/2)),j=o,et=this.n.clone(),tt=new BN(1),rt=new BN(0),nt=new BN(0),it=new BN(1),st,ot,at,ct,ut,ft,ht,mt=0,gt,Et;j.cmpn(0)!==0;){var St=et.div(j);gt=et.sub(St.mul(j)),Et=nt.sub(St.mul(tt));var At=it.sub(St.mul(rt));if(!at&&gt.cmp($)<0)st=ht.neg(),ot=tt,at=gt.neg(),ct=Et;else if(at&&++mt===2)break;ht=gt,et=j,j=gt,nt=tt,tt=Et,it=rt,rt=At}ut=gt.neg(),ft=Et;var kt=at.sqr().add(ct.sqr()),Rt=ut.sqr().add(ft.sqr());return Rt.cmp(kt)>=0&&(ut=st,ft=ot),at.negative&&(at=at.neg(),ct=ct.neg()),ut.negative&&(ut=ut.neg(),ft=ft.neg()),[{a:at,b:ct},{a:ut,b:ft}]};ShortCurve.prototype._endoSplit=function _(o){var $=this.endo.basis,j=$[0],et=$[1],tt=et.b.mul(o).divRound(this.n),rt=j.b.neg().mul(o).divRound(this.n),nt=tt.mul(j.a),it=rt.mul(et.a),st=tt.mul(j.b),ot=rt.mul(et.b),at=o.sub(nt).sub(it),ct=st.add(ot).neg();return{k1:at,k2:ct}};ShortCurve.prototype.pointFromX=function _(o,$){o=new BN(o,16),o.red||(o=o.toRed(this.red));var j=o.redSqr().redMul(o).redIAdd(o.redMul(this.a)).redIAdd(this.b),et=j.redSqrt();if(et.redSqr().redSub(j).cmp(this.zero)!==0)throw new Error("invalid point");var tt=et.fromRed().isOdd();return($&&!tt||!$&&tt)&&(et=et.redNeg()),this.point(o,et)};ShortCurve.prototype.validate=function _(o){if(o.inf)return!0;var $=o.x,j=o.y,et=this.a.redMul($),tt=$.redSqr().redMul($).redIAdd(et).redIAdd(this.b);return j.redSqr().redISub(tt).cmpn(0)===0};ShortCurve.prototype._endoWnafMulAdd=function _(o,$,j){for(var et=this._endoWnafT1,tt=this._endoWnafT2,rt=0;rt<o.length;rt++){var nt=this._endoSplit($[rt]),it=o[rt],st=it._getBeta();nt.k1.negative&&(nt.k1.ineg(),it=it.neg(!0)),nt.k2.negative&&(nt.k2.ineg(),st=st.neg(!0)),et[rt*2]=it,et[rt*2+1]=st,tt[rt*2]=nt.k1,tt[rt*2+1]=nt.k2}for(var ot=this._wnafMulAdd(1,et,tt,rt*2,j),at=0;at<rt*2;at++)et[at]=null,tt[at]=null;return ot};function Point(_,o,$,j){base$1.BasePoint.call(this,_,"affine"),o===null&&$===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN(o,16),this.y=new BN($,16),j&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}inherits_browser(Point,base$1.BasePoint);ShortCurve.prototype.point=function _(o,$,j){return new Point(this,o,$,j)};ShortCurve.prototype.pointFromJSON=function _(o,$){return Point.fromJSON(this,o,$)};Point.prototype._getBeta=function _(){if(this.curve.endo){var o=this.precomputed;if(o&&o.beta)return o.beta;var $=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(o){var j=this.curve,et=function(tt){return j.point(tt.x.redMul(j.endo.beta),tt.y)};o.beta=$,$.precomputed={beta:null,naf:o.naf&&{wnd:o.naf.wnd,points:o.naf.points.map(et)},doubles:o.doubles&&{step:o.doubles.step,points:o.doubles.points.map(et)}}}return $}};Point.prototype.toJSON=function _(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Point.fromJSON=function _(o,$,j){typeof $=="string"&&($=JSON.parse($));var et=o.point($[0],$[1],j);if(!$[2])return et;function tt(nt){return o.point(nt[0],nt[1],j)}var rt=$[2];return et.precomputed={beta:null,doubles:rt.doubles&&{step:rt.doubles.step,points:[et].concat(rt.doubles.points.map(tt))},naf:rt.naf&&{wnd:rt.naf.wnd,points:[et].concat(rt.naf.points.map(tt))}},et};Point.prototype.inspect=function _(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Point.prototype.isInfinity=function _(){return this.inf};Point.prototype.add=function _(o){if(this.inf)return o;if(o.inf)return this;if(this.eq(o))return this.dbl();if(this.neg().eq(o))return this.curve.point(null,null);if(this.x.cmp(o.x)===0)return this.curve.point(null,null);var $=this.y.redSub(o.y);$.cmpn(0)!==0&&($=$.redMul(this.x.redSub(o.x).redInvm()));var j=$.redSqr().redISub(this.x).redISub(o.x),et=$.redMul(this.x.redSub(j)).redISub(this.y);return this.curve.point(j,et)};Point.prototype.dbl=function _(){if(this.inf)return this;var o=this.y.redAdd(this.y);if(o.cmpn(0)===0)return this.curve.point(null,null);var $=this.curve.a,j=this.x.redSqr(),et=o.redInvm(),tt=j.redAdd(j).redIAdd(j).redIAdd($).redMul(et),rt=tt.redSqr().redISub(this.x.redAdd(this.x)),nt=tt.redMul(this.x.redSub(rt)).redISub(this.y);return this.curve.point(rt,nt)};Point.prototype.getX=function _(){return this.x.fromRed()};Point.prototype.getY=function _(){return this.y.fromRed()};Point.prototype.mul=function _(o){return o=new BN(o,16),this.isInfinity()?this:this._hasDoubles(o)?this.curve._fixedNafMul(this,o):this.curve.endo?this.curve._endoWnafMulAdd([this],[o]):this.curve._wnafMul(this,o)};Point.prototype.mulAdd=function _(o,$,j){var et=[this,$],tt=[o,j];return this.curve.endo?this.curve._endoWnafMulAdd(et,tt):this.curve._wnafMulAdd(1,et,tt,2)};Point.prototype.jmulAdd=function _(o,$,j){var et=[this,$],tt=[o,j];return this.curve.endo?this.curve._endoWnafMulAdd(et,tt,!0):this.curve._wnafMulAdd(1,et,tt,2,!0)};Point.prototype.eq=function _(o){return this===o||this.inf===o.inf&&(this.inf||this.x.cmp(o.x)===0&&this.y.cmp(o.y)===0)};Point.prototype.neg=function _(o){if(this.inf)return this;var $=this.curve.point(this.x,this.y.redNeg());if(o&&this.precomputed){var j=this.precomputed,et=function(tt){return tt.neg()};$.precomputed={naf:j.naf&&{wnd:j.naf.wnd,points:j.naf.points.map(et)},doubles:j.doubles&&{step:j.doubles.step,points:j.doubles.points.map(et)}}}return $};Point.prototype.toJ=function _(){if(this.inf)return this.curve.jpoint(null,null,null);var o=this.curve.jpoint(this.x,this.y,this.curve.one);return o};function JPoint(_,o,$,j){base$1.BasePoint.call(this,_,"jacobian"),o===null&&$===null&&j===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN(0)):(this.x=new BN(o,16),this.y=new BN($,16),this.z=new BN(j,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}inherits_browser(JPoint,base$1.BasePoint);ShortCurve.prototype.jpoint=function _(o,$,j){return new JPoint(this,o,$,j)};JPoint.prototype.toP=function _(){if(this.isInfinity())return this.curve.point(null,null);var o=this.z.redInvm(),$=o.redSqr(),j=this.x.redMul($),et=this.y.redMul($).redMul(o);return this.curve.point(j,et)};JPoint.prototype.neg=function _(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};JPoint.prototype.add=function _(o){if(this.isInfinity())return o;if(o.isInfinity())return this;var $=o.z.redSqr(),j=this.z.redSqr(),et=this.x.redMul($),tt=o.x.redMul(j),rt=this.y.redMul($.redMul(o.z)),nt=o.y.redMul(j.redMul(this.z)),it=et.redSub(tt),st=rt.redSub(nt);if(it.cmpn(0)===0)return st.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var ot=it.redSqr(),at=ot.redMul(it),ct=et.redMul(ot),ut=st.redSqr().redIAdd(at).redISub(ct).redISub(ct),ft=st.redMul(ct.redISub(ut)).redISub(rt.redMul(at)),ht=this.z.redMul(o.z).redMul(it);return this.curve.jpoint(ut,ft,ht)};JPoint.prototype.mixedAdd=function _(o){if(this.isInfinity())return o.toJ();if(o.isInfinity())return this;var $=this.z.redSqr(),j=this.x,et=o.x.redMul($),tt=this.y,rt=o.y.redMul($).redMul(this.z),nt=j.redSub(et),it=tt.redSub(rt);if(nt.cmpn(0)===0)return it.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var st=nt.redSqr(),ot=st.redMul(nt),at=j.redMul(st),ct=it.redSqr().redIAdd(ot).redISub(at).redISub(at),ut=it.redMul(at.redISub(ct)).redISub(tt.redMul(ot)),ft=this.z.redMul(nt);return this.curve.jpoint(ct,ut,ft)};JPoint.prototype.dblp=function _(o){if(o===0)return this;if(this.isInfinity())return this;if(!o)return this.dbl();var $;if(this.curve.zeroA||this.curve.threeA){var j=this;for($=0;$<o;$++)j=j.dbl();return j}var et=this.curve.a,tt=this.curve.tinv,rt=this.x,nt=this.y,it=this.z,st=it.redSqr().redSqr(),ot=nt.redAdd(nt);for($=0;$<o;$++){var at=rt.redSqr(),ct=ot.redSqr(),ut=ct.redSqr(),ft=at.redAdd(at).redIAdd(at).redIAdd(et.redMul(st)),ht=rt.redMul(ct),mt=ft.redSqr().redISub(ht.redAdd(ht)),gt=ht.redISub(mt),Et=ft.redMul(gt);Et=Et.redIAdd(Et).redISub(ut);var St=ot.redMul(it);$+1<o&&(st=st.redMul(ut)),rt=mt,it=St,ot=Et}return this.curve.jpoint(rt,ot.redMul(tt),it)};JPoint.prototype.dbl=function _(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};JPoint.prototype._zeroDbl=function _(){var o,$,j;if(this.zOne){var et=this.x.redSqr(),tt=this.y.redSqr(),rt=tt.redSqr(),nt=this.x.redAdd(tt).redSqr().redISub(et).redISub(rt);nt=nt.redIAdd(nt);var it=et.redAdd(et).redIAdd(et),st=it.redSqr().redISub(nt).redISub(nt),ot=rt.redIAdd(rt);ot=ot.redIAdd(ot),ot=ot.redIAdd(ot),o=st,$=it.redMul(nt.redISub(st)).redISub(ot),j=this.y.redAdd(this.y)}else{var at=this.x.redSqr(),ct=this.y.redSqr(),ut=ct.redSqr(),ft=this.x.redAdd(ct).redSqr().redISub(at).redISub(ut);ft=ft.redIAdd(ft);var ht=at.redAdd(at).redIAdd(at),mt=ht.redSqr(),gt=ut.redIAdd(ut);gt=gt.redIAdd(gt),gt=gt.redIAdd(gt),o=mt.redISub(ft).redISub(ft),$=ht.redMul(ft.redISub(o)).redISub(gt),j=this.y.redMul(this.z),j=j.redIAdd(j)}return this.curve.jpoint(o,$,j)};JPoint.prototype._threeDbl=function _(){var o,$,j;if(this.zOne){var et=this.x.redSqr(),tt=this.y.redSqr(),rt=tt.redSqr(),nt=this.x.redAdd(tt).redSqr().redISub(et).redISub(rt);nt=nt.redIAdd(nt);var it=et.redAdd(et).redIAdd(et).redIAdd(this.curve.a),st=it.redSqr().redISub(nt).redISub(nt);o=st;var ot=rt.redIAdd(rt);ot=ot.redIAdd(ot),ot=ot.redIAdd(ot),$=it.redMul(nt.redISub(st)).redISub(ot),j=this.y.redAdd(this.y)}else{var at=this.z.redSqr(),ct=this.y.redSqr(),ut=this.x.redMul(ct),ft=this.x.redSub(at).redMul(this.x.redAdd(at));ft=ft.redAdd(ft).redIAdd(ft);var ht=ut.redIAdd(ut);ht=ht.redIAdd(ht);var mt=ht.redAdd(ht);o=ft.redSqr().redISub(mt),j=this.y.redAdd(this.z).redSqr().redISub(ct).redISub(at);var gt=ct.redSqr();gt=gt.redIAdd(gt),gt=gt.redIAdd(gt),gt=gt.redIAdd(gt),$=ft.redMul(ht.redISub(o)).redISub(gt)}return this.curve.jpoint(o,$,j)};JPoint.prototype._dbl=function _(){var o=this.curve.a,$=this.x,j=this.y,et=this.z,tt=et.redSqr().redSqr(),rt=$.redSqr(),nt=j.redSqr(),it=rt.redAdd(rt).redIAdd(rt).redIAdd(o.redMul(tt)),st=$.redAdd($);st=st.redIAdd(st);var ot=st.redMul(nt),at=it.redSqr().redISub(ot.redAdd(ot)),ct=ot.redISub(at),ut=nt.redSqr();ut=ut.redIAdd(ut),ut=ut.redIAdd(ut),ut=ut.redIAdd(ut);var ft=it.redMul(ct).redISub(ut),ht=j.redAdd(j).redMul(et);return this.curve.jpoint(at,ft,ht)};JPoint.prototype.trpl=function _(){if(!this.curve.zeroA)return this.dbl().add(this);var o=this.x.redSqr(),$=this.y.redSqr(),j=this.z.redSqr(),et=$.redSqr(),tt=o.redAdd(o).redIAdd(o),rt=tt.redSqr(),nt=this.x.redAdd($).redSqr().redISub(o).redISub(et);nt=nt.redIAdd(nt),nt=nt.redAdd(nt).redIAdd(nt),nt=nt.redISub(rt);var it=nt.redSqr(),st=et.redIAdd(et);st=st.redIAdd(st),st=st.redIAdd(st),st=st.redIAdd(st);var ot=tt.redIAdd(nt).redSqr().redISub(rt).redISub(it).redISub(st),at=$.redMul(ot);at=at.redIAdd(at),at=at.redIAdd(at);var ct=this.x.redMul(it).redISub(at);ct=ct.redIAdd(ct),ct=ct.redIAdd(ct);var ut=this.y.redMul(ot.redMul(st.redISub(ot)).redISub(nt.redMul(it)));ut=ut.redIAdd(ut),ut=ut.redIAdd(ut),ut=ut.redIAdd(ut);var ft=this.z.redAdd(nt).redSqr().redISub(j).redISub(it);return this.curve.jpoint(ct,ut,ft)};JPoint.prototype.mul=function _(o,$){return o=new BN(o,$),this.curve._wnafMul(this,o)};JPoint.prototype.eq=function _(o){if(o.type==="affine")return this.eq(o.toJ());if(this===o)return!0;var $=this.z.redSqr(),j=o.z.redSqr();if(this.x.redMul(j).redISub(o.x.redMul($)).cmpn(0)!==0)return!1;var et=$.redMul(this.z),tt=j.redMul(o.z);return this.y.redMul(tt).redISub(o.y.redMul(et)).cmpn(0)===0};JPoint.prototype.eqXToP=function _(o){var $=this.z.redSqr(),j=o.toRed(this.curve.red).redMul($);if(this.x.cmp(j)===0)return!0;for(var et=o.clone(),tt=this.curve.redN.redMul($);;){if(et.iadd(this.curve.n),et.cmp(this.curve.p)>=0)return!1;if(j.redIAdd(tt),this.x.cmp(j)===0)return!0}};JPoint.prototype.inspect=function _(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};JPoint.prototype.isInfinity=function _(){return this.z.cmpn(0)===0};var curve_1=createCommonjsModule(function(_,o){var $=o;$.base=base$1,$.short=short_1,$.mont=null,$.edwards=null}),curves_1=createCommonjsModule(function(_,o){var $=o,j=utils_1$1.assert;function et(nt){nt.type==="short"?this.curve=new curve_1.short(nt):nt.type==="edwards"?this.curve=new curve_1.edwards(nt):this.curve=new curve_1.mont(nt),this.g=this.curve.g,this.n=this.curve.n,this.hash=nt.hash,j(this.g.validate(),"Invalid curve"),j(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}$.PresetCurve=et;function tt(nt,it){Object.defineProperty($,nt,{configurable:!0,enumerable:!0,get:function(){var st=new et(it);return Object.defineProperty($,nt,{configurable:!0,enumerable:!0,value:st}),st}})}tt("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:hash$5.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),tt("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:hash$5.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),tt("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:hash$5.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),tt("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:hash$5.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),tt("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:hash$5.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),tt("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash$5.sha256,gRed:!1,g:["9"]}),tt("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash$5.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var rt;try{rt=null.crash()}catch{rt=void 0}tt("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:hash$5.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",rt]})});function HmacDRBG(_){if(!(this instanceof HmacDRBG))return new HmacDRBG(_);this.hash=_.hash,this.predResist=!!_.predResist,this.outLen=this.hash.outSize,this.minEntropy=_.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var o=utils_1.toArray(_.entropy,_.entropyEnc||"hex"),$=utils_1.toArray(_.nonce,_.nonceEnc||"hex"),j=utils_1.toArray(_.pers,_.persEnc||"hex");minimalisticAssert(o.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(o,$,j)}var hmacDrbg=HmacDRBG;HmacDRBG.prototype._init=function _(o,$,j){var et=o.concat($).concat(j);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var tt=0;tt<this.V.length;tt++)this.K[tt]=0,this.V[tt]=1;this._update(et),this._reseed=1,this.reseedInterval=281474976710656};HmacDRBG.prototype._hmac=function _(){return new hash$5.hmac(this.hash,this.K)};HmacDRBG.prototype._update=function _(o){var $=this._hmac().update(this.V).update([0]);o&&($=$.update(o)),this.K=$.digest(),this.V=this._hmac().update(this.V).digest(),o&&(this.K=this._hmac().update(this.V).update([1]).update(o).digest(),this.V=this._hmac().update(this.V).digest())};HmacDRBG.prototype.reseed=function _(o,$,j,et){typeof $!="string"&&(et=j,j=$,$=null),o=utils_1.toArray(o,$),j=utils_1.toArray(j,et),minimalisticAssert(o.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(o.concat(j||[])),this._reseed=1};HmacDRBG.prototype.generate=function _(o,$,j,et){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof $!="string"&&(et=j,j=$,$=null),j&&(j=utils_1.toArray(j,et||"hex"),this._update(j));for(var tt=[];tt.length<o;)this.V=this._hmac().update(this.V).digest(),tt=tt.concat(this.V);var rt=tt.slice(0,o);return this._update(j),this._reseed++,utils_1.encode(rt,$)};var assert$3=utils_1$1.assert;function KeyPair(_,o){this.ec=_,this.priv=null,this.pub=null,o.priv&&this._importPrivate(o.priv,o.privEnc),o.pub&&this._importPublic(o.pub,o.pubEnc)}var key=KeyPair;KeyPair.fromPublic=function _(o,$,j){return $ instanceof KeyPair?$:new KeyPair(o,{pub:$,pubEnc:j})};KeyPair.fromPrivate=function _(o,$,j){return $ instanceof KeyPair?$:new KeyPair(o,{priv:$,privEnc:j})};KeyPair.prototype.validate=function _(){var o=this.getPublic();return o.isInfinity()?{result:!1,reason:"Invalid public key"}:o.validate()?o.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};KeyPair.prototype.getPublic=function _(o,$){return typeof o=="string"&&($=o,o=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),$?this.pub.encode($,o):this.pub};KeyPair.prototype.getPrivate=function _(o){return o==="hex"?this.priv.toString(16,2):this.priv};KeyPair.prototype._importPrivate=function _(o,$){this.priv=new BN(o,$||16),this.priv=this.priv.umod(this.ec.curve.n)};KeyPair.prototype._importPublic=function _(o,$){if(o.x||o.y){this.ec.curve.type==="mont"?assert$3(o.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&assert$3(o.x&&o.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(o.x,o.y);return}this.pub=this.ec.curve.decodePoint(o,$)};KeyPair.prototype.derive=function _(o){return o.validate()||assert$3(o.validate(),"public point not validated"),o.mul(this.priv).getX()};KeyPair.prototype.sign=function _(o,$,j){return this.ec.sign(o,this,$,j)};KeyPair.prototype.verify=function _(o,$){return this.ec.verify(o,$,this)};KeyPair.prototype.inspect=function _(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var assert$4=utils_1$1.assert;function Signature(_,o){if(_ instanceof Signature)return _;this._importDER(_,o)||(assert$4(_.r&&_.s,"Signature without r or s"),this.r=new BN(_.r,16),this.s=new BN(_.s,16),_.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=_.recoveryParam)}var signature=Signature;function Position(){this.place=0}function getLength$1(_,o){var $=_[o.place++];if(!($&128))return $;var j=$&15;if(j===0||j>4)return!1;for(var et=0,tt=0,rt=o.place;tt<j;tt++,rt++)et<<=8,et|=_[rt],et>>>=0;return et<=127?!1:(o.place=rt,et)}function rmPadding(_){for(var o=0,$=_.length-1;!_[o]&&!(_[o+1]&128)&&o<$;)o++;return o===0?_:_.slice(o)}Signature.prototype._importDER=function _(o,$){o=utils_1$1.toArray(o,$);var j=new Position;if(o[j.place++]!==48)return!1;var et=getLength$1(o,j);if(et===!1||et+j.place!==o.length||o[j.place++]!==2)return!1;var tt=getLength$1(o,j);if(tt===!1)return!1;var rt=o.slice(j.place,tt+j.place);if(j.place+=tt,o[j.place++]!==2)return!1;var nt=getLength$1(o,j);if(nt===!1||o.length!==nt+j.place)return!1;var it=o.slice(j.place,nt+j.place);if(rt[0]===0)if(rt[1]&128)rt=rt.slice(1);else return!1;if(it[0]===0)if(it[1]&128)it=it.slice(1);else return!1;return this.r=new BN(rt),this.s=new BN(it),this.recoveryParam=null,!0};function constructLength(_,o){if(o<128){_.push(o);return}var $=1+(Math.log(o)/Math.LN2>>>3);for(_.push($|128);--$;)_.push(o>>>($<<3)&255);_.push(o)}Signature.prototype.toDER=function _(o){var $=this.r.toArray(),j=this.s.toArray();for($[0]&128&&($=[0].concat($)),j[0]&128&&(j=[0].concat(j)),$=rmPadding($),j=rmPadding(j);!j[0]&&!(j[1]&128);)j=j.slice(1);var et=[2];constructLength(et,$.length),et=et.concat($),et.push(2),constructLength(et,j.length);var tt=et.concat(j),rt=[48];return constructLength(rt,tt.length),rt=rt.concat(tt),utils_1$1.encode(rt,o)};var rand=function(){throw new Error("unsupported")},assert$5=utils_1$1.assert;function EC(_){if(!(this instanceof EC))return new EC(_);typeof _=="string"&&(assert$5(Object.prototype.hasOwnProperty.call(curves_1,_),"Unknown curve "+_),_=curves_1[_]),_ instanceof curves_1.PresetCurve&&(_={curve:_}),this.curve=_.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=_.curve.g,this.g.precompute(_.curve.n.bitLength()+1),this.hash=_.hash||_.curve.hash}var ec=EC;EC.prototype.keyPair=function _(o){return new key(this,o)};EC.prototype.keyFromPrivate=function _(o,$){return key.fromPrivate(this,o,$)};EC.prototype.keyFromPublic=function _(o,$){return key.fromPublic(this,o,$)};EC.prototype.genKeyPair=function _(o){o||(o={});for(var $=new hmacDrbg({hash:this.hash,pers:o.pers,persEnc:o.persEnc||"utf8",entropy:o.entropy||rand(this.hash.hmacStrength),entropyEnc:o.entropy&&o.entropyEnc||"utf8",nonce:this.n.toArray()}),j=this.n.byteLength(),et=this.n.sub(new BN(2));;){var tt=new BN($.generate(j));if(!(tt.cmp(et)>0))return tt.iaddn(1),this.keyFromPrivate(tt)}};EC.prototype._truncateToN=function _(o,$){var j=o.byteLength()*8-this.n.bitLength();return j>0&&(o=o.ushrn(j)),!$&&o.cmp(this.n)>=0?o.sub(this.n):o};EC.prototype.sign=function _(o,$,j,et){typeof j=="object"&&(et=j,j=null),et||(et={}),$=this.keyFromPrivate($,j),o=this._truncateToN(new BN(o,16));for(var tt=this.n.byteLength(),rt=$.getPrivate().toArray("be",tt),nt=o.toArray("be",tt),it=new hmacDrbg({hash:this.hash,entropy:rt,nonce:nt,pers:et.pers,persEnc:et.persEnc||"utf8"}),st=this.n.sub(new BN(1)),ot=0;;ot++){var at=et.k?et.k(ot):new BN(it.generate(this.n.byteLength()));if(at=this._truncateToN(at,!0),!(at.cmpn(1)<=0||at.cmp(st)>=0)){var ct=this.g.mul(at);if(!ct.isInfinity()){var ut=ct.getX(),ft=ut.umod(this.n);if(ft.cmpn(0)!==0){var ht=at.invm(this.n).mul(ft.mul($.getPrivate()).iadd(o));if(ht=ht.umod(this.n),ht.cmpn(0)!==0){var mt=(ct.getY().isOdd()?1:0)|(ut.cmp(ft)!==0?2:0);return et.canonical&&ht.cmp(this.nh)>0&&(ht=this.n.sub(ht),mt^=1),new signature({r:ft,s:ht,recoveryParam:mt})}}}}}};EC.prototype.verify=function _(o,$,j,et){o=this._truncateToN(new BN(o,16)),j=this.keyFromPublic(j,et),$=new signature($,"hex");var tt=$.r,rt=$.s;if(tt.cmpn(1)<0||tt.cmp(this.n)>=0||rt.cmpn(1)<0||rt.cmp(this.n)>=0)return!1;var nt=rt.invm(this.n),it=nt.mul(o).umod(this.n),st=nt.mul(tt).umod(this.n),ot;return this.curve._maxwellTrick?(ot=this.g.jmulAdd(it,j.getPublic(),st),ot.isInfinity()?!1:ot.eqXToP(tt)):(ot=this.g.mulAdd(it,j.getPublic(),st),ot.isInfinity()?!1:ot.getX().umod(this.n).cmp(tt)===0)};EC.prototype.recoverPubKey=function(_,o,$,j){assert$5((3&$)===$,"The recovery param is more than two bits"),o=new signature(o,j);var et=this.n,tt=new BN(_),rt=o.r,nt=o.s,it=$&1,st=$>>1;if(rt.cmp(this.curve.p.umod(this.curve.n))>=0&&st)throw new Error("Unable to find sencond key candinate");st?rt=this.curve.pointFromX(rt.add(this.curve.n),it):rt=this.curve.pointFromX(rt,it);var ot=o.r.invm(et),at=et.sub(tt).mul(ot).umod(et),ct=nt.mul(ot).umod(et);return this.g.mulAdd(at,rt,ct)};EC.prototype.getKeyRecoveryParam=function(_,o,$,j){if(o=new signature(o,j),o.recoveryParam!==null)return o.recoveryParam;for(var et=0;et<4;et++){var tt;try{tt=this.recoverPubKey(_,o,et)}catch{continue}if(tt.eq($))return et}throw new Error("Unable to find valid recovery factor")};var elliptic_1=createCommonjsModule(function(_,o){var $=o;$.version="6.5.4",$.utils=utils_1$1,$.rand=function(){throw new Error("unsupported")},$.curve=curve_1,$.curves=curves_1,$.ec=ec,$.eddsa=null}),EC$1=elliptic_1.ec;const version$8="signing-key/5.7.0",logger$c=new Logger(version$8);let _curve=null;function getCurve(){return _curve||(_curve=new EC$1("secp256k1")),_curve}class SigningKey{constructor(o){defineReadOnly(this,"curve","secp256k1"),defineReadOnly(this,"privateKey",hexlify(o)),hexDataLength(this.privateKey)!==32&&logger$c.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const $=getCurve().keyFromPrivate(arrayify(this.privateKey));defineReadOnly(this,"publicKey","0x"+$.getPublic(!1,"hex")),defineReadOnly(this,"compressedPublicKey","0x"+$.getPublic(!0,"hex")),defineReadOnly(this,"_isSigningKey",!0)}_addPoint(o){const $=getCurve().keyFromPublic(arrayify(this.publicKey)),j=getCurve().keyFromPublic(arrayify(o));return"0x"+$.pub.add(j.pub).encodeCompressed("hex")}signDigest(o){const $=getCurve().keyFromPrivate(arrayify(this.privateKey)),j=arrayify(o);j.length!==32&&logger$c.throwArgumentError("bad digest length","digest",o);const et=$.sign(j,{canonical:!0});return splitSignature({recoveryParam:et.recoveryParam,r:hexZeroPad("0x"+et.r.toString(16),32),s:hexZeroPad("0x"+et.s.toString(16),32)})}computeSharedSecret(o){const $=getCurve().keyFromPrivate(arrayify(this.privateKey)),j=getCurve().keyFromPublic(arrayify(computePublicKey(o)));return hexZeroPad("0x"+$.derive(j.getPublic()).toString(16),32)}static isSigningKey(o){return!!(o&&o._isSigningKey)}}function recoverPublicKey(_,o){const $=splitSignature(o),j={r:arrayify($.r),s:arrayify($.s)};return"0x"+getCurve().recoverPubKey(arrayify(_),j,$.recoveryParam).encode("hex",!1)}function computePublicKey(_,o){const $=arrayify(_);if($.length===32){const j=new SigningKey($);return o?"0x"+getCurve().keyFromPrivate($).getPublic(!0,"hex"):j.publicKey}else{if($.length===33)return o?hexlify($):"0x"+getCurve().keyFromPublic($).getPublic(!1,"hex");if($.length===65)return o?"0x"+getCurve().keyFromPublic($).getPublic(!0,"hex"):hexlify($)}return logger$c.throwArgumentError("invalid public or private key","key","[REDACTED]")}const version$7="transactions/5.7.0",logger$b=new Logger(version$7);var TransactionTypes;(function(_){_[_.legacy=0]="legacy",_[_.eip2930=1]="eip2930",_[_.eip1559=2]="eip1559"})(TransactionTypes||(TransactionTypes={}));const transactionFields=[{name:"nonce",maxLength:32,numeric:!0},{name:"gasPrice",maxLength:32,numeric:!0},{name:"gasLimit",maxLength:32,numeric:!0},{name:"to",length:20},{name:"value",maxLength:32,numeric:!0},{name:"data"}],allowedTransactionKeys={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,type:!0,value:!0};function computeAddress(_){const o=computePublicKey(_);return getAddress(hexDataSlice(keccak256(hexDataSlice(o,1)),12))}function recoverAddress(_,o){return computeAddress(recoverPublicKey(arrayify(_),o))}function formatNumber(_,o){const $=stripZeros(BigNumber.from(_).toHexString());return $.length>32&&logger$b.throwArgumentError("invalid length for "+o,"transaction:"+o,_),$}function accessSetify(_,o){return{address:getAddress(_),storageKeys:(o||[]).map(($,j)=>(hexDataLength($)!==32&&logger$b.throwArgumentError("invalid access list storageKey",`accessList[${_}:${j}]`,$),$.toLowerCase()))}}function accessListify(_){if(Array.isArray(_))return _.map(($,j)=>Array.isArray($)?($.length>2&&logger$b.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${j}]`,$),accessSetify($[0],$[1])):accessSetify($.address,$.storageKeys));const o=Object.keys(_).map($=>{const j=_[$].reduce((et,tt)=>(et[tt]=!0,et),{});return accessSetify($,Object.keys(j).sort())});return o.sort(($,j)=>$.address.localeCompare(j.address)),o}function formatAccessList(_){return accessListify(_).map(o=>[o.address,o.storageKeys])}function _serializeEip1559(_,o){if(_.gasPrice!=null){const j=BigNumber.from(_.gasPrice),et=BigNumber.from(_.maxFeePerGas||0);j.eq(et)||logger$b.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:j,maxFeePerGas:et})}const $=[formatNumber(_.chainId||0,"chainId"),formatNumber(_.nonce||0,"nonce"),formatNumber(_.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),formatNumber(_.maxFeePerGas||0,"maxFeePerGas"),formatNumber(_.gasLimit||0,"gasLimit"),_.to!=null?getAddress(_.to):"0x",formatNumber(_.value||0,"value"),_.data||"0x",formatAccessList(_.accessList||[])];if(o){const j=splitSignature(o);$.push(formatNumber(j.recoveryParam,"recoveryParam")),$.push(stripZeros(j.r)),$.push(stripZeros(j.s))}return hexConcat(["0x02",encode$g($)])}function _serializeEip2930(_,o){const $=[formatNumber(_.chainId||0,"chainId"),formatNumber(_.nonce||0,"nonce"),formatNumber(_.gasPrice||0,"gasPrice"),formatNumber(_.gasLimit||0,"gasLimit"),_.to!=null?getAddress(_.to):"0x",formatNumber(_.value||0,"value"),_.data||"0x",formatAccessList(_.accessList||[])];if(o){const j=splitSignature(o);$.push(formatNumber(j.recoveryParam,"recoveryParam")),$.push(stripZeros(j.r)),$.push(stripZeros(j.s))}return hexConcat(["0x01",encode$g($)])}function _serialize(_,o){checkProperties(_,allowedTransactionKeys);const $=[];transactionFields.forEach(function(rt){let nt=_[rt.name]||[];const it={};rt.numeric&&(it.hexPad="left"),nt=arrayify(hexlify(nt,it)),rt.length&&nt.length!==rt.length&&nt.length>0&&logger$b.throwArgumentError("invalid length for "+rt.name,"transaction:"+rt.name,nt),rt.maxLength&&(nt=stripZeros(nt),nt.length>rt.maxLength&&logger$b.throwArgumentError("invalid length for "+rt.name,"transaction:"+rt.name,nt)),$.push(hexlify(nt))});let j=0;if(_.chainId!=null?(j=_.chainId,typeof j!="number"&&logger$b.throwArgumentError("invalid transaction.chainId","transaction",_)):o&&!isBytesLike(o)&&o.v>28&&(j=Math.floor((o.v-35)/2)),j!==0&&($.push(hexlify(j)),$.push("0x"),$.push("0x")),!o)return encode$g($);const et=splitSignature(o);let tt=27+et.recoveryParam;return j!==0?($.pop(),$.pop(),$.pop(),tt+=j*2+8,et.v>28&&et.v!==tt&&logger$b.throwArgumentError("transaction.chainId/signature.v mismatch","signature",o)):et.v!==tt&&logger$b.throwArgumentError("transaction.chainId/signature.v mismatch","signature",o),$.push(hexlify(tt)),$.push(stripZeros(arrayify(et.r))),$.push(stripZeros(arrayify(et.s))),encode$g($)}function serialize(_,o){if(_.type==null||_.type===0)return _.accessList!=null&&logger$b.throwArgumentError("untyped transactions do not support accessList; include type: 1","transaction",_),_serialize(_,o);switch(_.type){case 1:return _serializeEip2930(_,o);case 2:return _serializeEip1559(_,o)}return logger$b.throwError(`unsupported transaction type: ${_.type}`,Logger.errors.UNSUPPORTED_OPERATION,{operation:"serializeTransaction",transactionType:_.type})}const version$6="wordlists/5.7.0",logger$a=new Logger(version$6);class Wordlist{constructor(o){logger$a.checkAbstract(new.target,Wordlist),defineReadOnly(this,"locale",o)}split(o){return o.toLowerCase().split(/ +/g)}join(o){return o.join(" ")}static check(o){const $=[];for(let j=0;j<2048;j++){const et=o.getWord(j);if(j!==o.getWordIndex(et))return"0x";$.push(et)}return id($.join(`
`)+`
`)}static register(o,$){$||($=o.locale)}}const words="AbandonAbilityAbleAboutAboveAbsentAbsorbAbstractAbsurdAbuseAccessAccidentAccountAccuseAchieveAcidAcousticAcquireAcrossActActionActorActressActualAdaptAddAddictAddressAdjustAdmitAdultAdvanceAdviceAerobicAffairAffordAfraidAgainAgeAgentAgreeAheadAimAirAirportAisleAlarmAlbumAlcoholAlertAlienAllAlleyAllowAlmostAloneAlphaAlreadyAlsoAlterAlwaysAmateurAmazingAmongAmountAmusedAnalystAnchorAncientAngerAngleAngryAnimalAnkleAnnounceAnnualAnotherAnswerAntennaAntiqueAnxietyAnyApartApologyAppearAppleApproveAprilArchArcticAreaArenaArgueArmArmedArmorArmyAroundArrangeArrestArriveArrowArtArtefactArtistArtworkAskAspectAssaultAssetAssistAssumeAsthmaAthleteAtomAttackAttendAttitudeAttractAuctionAuditAugustAuntAuthorAutoAutumnAverageAvocadoAvoidAwakeAwareAwayAwesomeAwfulAwkwardAxisBabyBachelorBaconBadgeBagBalanceBalconyBallBambooBananaBannerBarBarelyBargainBarrelBaseBasicBasketBattleBeachBeanBeautyBecauseBecomeBeefBeforeBeginBehaveBehindBelieveBelowBeltBenchBenefitBestBetrayBetterBetweenBeyondBicycleBidBikeBindBiologyBirdBirthBitterBlackBladeBlameBlanketBlastBleakBlessBlindBloodBlossomBlouseBlueBlurBlushBoardBoatBodyBoilBombBoneBonusBookBoostBorderBoringBorrowBossBottomBounceBoxBoyBracketBrainBrandBrassBraveBreadBreezeBrickBridgeBriefBrightBringBriskBroccoliBrokenBronzeBroomBrotherBrownBrushBubbleBuddyBudgetBuffaloBuildBulbBulkBulletBundleBunkerBurdenBurgerBurstBusBusinessBusyButterBuyerBuzzCabbageCabinCableCactusCageCakeCallCalmCameraCampCanCanalCancelCandyCannonCanoeCanvasCanyonCapableCapitalCaptainCarCarbonCardCargoCarpetCarryCartCaseCashCasinoCastleCasualCatCatalogCatchCategoryCattleCaughtCauseCautionCaveCeilingCeleryCementCensusCenturyCerealCertainChairChalkChampionChangeChaosChapterChargeChaseChatCheapCheckCheeseChefCherryChestChickenChiefChildChimneyChoiceChooseChronicChuckleChunkChurnCigarCinnamonCircleCitizenCityCivilClaimClapClarifyClawClayCleanClerkCleverClickClientCliffClimbClinicClipClockClogCloseClothCloudClownClubClumpClusterClutchCoachCoastCoconutCodeCoffeeCoilCoinCollectColorColumnCombineComeComfortComicCommonCompanyConcertConductConfirmCongressConnectConsiderControlConvinceCookCoolCopperCopyCoralCoreCornCorrectCostCottonCouchCountryCoupleCourseCousinCoverCoyoteCrackCradleCraftCramCraneCrashCraterCrawlCrazyCreamCreditCreekCrewCricketCrimeCrispCriticCropCrossCrouchCrowdCrucialCruelCruiseCrumbleCrunchCrushCryCrystalCubeCultureCupCupboardCuriousCurrentCurtainCurveCushionCustomCuteCycleDadDamageDampDanceDangerDaringDashDaughterDawnDayDealDebateDebrisDecadeDecemberDecideDeclineDecorateDecreaseDeerDefenseDefineDefyDegreeDelayDeliverDemandDemiseDenialDentistDenyDepartDependDepositDepthDeputyDeriveDescribeDesertDesignDeskDespairDestroyDetailDetectDevelopDeviceDevoteDiagramDialDiamondDiaryDiceDieselDietDifferDigitalDignityDilemmaDinnerDinosaurDirectDirtDisagreeDiscoverDiseaseDishDismissDisorderDisplayDistanceDivertDivideDivorceDizzyDoctorDocumentDogDollDolphinDomainDonateDonkeyDonorDoorDoseDoubleDoveDraftDragonDramaDrasticDrawDreamDressDriftDrillDrinkDripDriveDropDrumDryDuckDumbDuneDuringDustDutchDutyDwarfDynamicEagerEagleEarlyEarnEarthEasilyEastEasyEchoEcologyEconomyEdgeEditEducateEffortEggEightEitherElbowElderElectricElegantElementElephantElevatorEliteElseEmbarkEmbodyEmbraceEmergeEmotionEmployEmpowerEmptyEnableEnactEndEndlessEndorseEnemyEnergyEnforceEngageEngineEnhanceEnjoyEnlistEnoughEnrichEnrollEnsureEnterEntireEntryEnvelopeEpisodeEqualEquipEraEraseErodeErosionErrorEruptEscapeEssayEssenceEstateEternalEthicsEvidenceEvilEvokeEvolveExactExampleExcessExchangeExciteExcludeExcuseExecuteExerciseExhaustExhibitExileExistExitExoticExpandExpectExpireExplainExposeExpressExtendExtraEyeEyebrowFabricFaceFacultyFadeFaintFaithFallFalseFameFamilyFamousFanFancyFantasyFarmFashionFatFatalFatherFatigueFaultFavoriteFeatureFebruaryFederalFeeFeedFeelFemaleFenceFestivalFetchFeverFewFiberFictionFieldFigureFileFilmFilterFinalFindFineFingerFinishFireFirmFirstFiscalFishFitFitnessFixFlagFlameFlashFlatFlavorFleeFlightFlipFloatFlockFloorFlowerFluidFlushFlyFoamFocusFogFoilFoldFollowFoodFootForceForestForgetForkFortuneForumForwardFossilFosterFoundFoxFragileFrameFrequentFreshFriendFringeFrogFrontFrostFrownFrozenFruitFuelFunFunnyFurnaceFuryFutureGadgetGainGalaxyGalleryGameGapGarageGarbageGardenGarlicGarmentGasGaspGateGatherGaugeGazeGeneralGeniusGenreGentleGenuineGestureGhostGiantGiftGiggleGingerGiraffeGirlGiveGladGlanceGlareGlassGlideGlimpseGlobeGloomGloryGloveGlowGlueGoatGoddessGoldGoodGooseGorillaGospelGossipGovernGownGrabGraceGrainGrantGrapeGrassGravityGreatGreenGridGriefGritGroceryGroupGrowGruntGuardGuessGuideGuiltGuitarGunGymHabitHairHalfHammerHamsterHandHappyHarborHardHarshHarvestHatHaveHawkHazardHeadHealthHeartHeavyHedgehogHeightHelloHelmetHelpHenHeroHiddenHighHillHintHipHireHistoryHobbyHockeyHoldHoleHolidayHollowHomeHoneyHoodHopeHornHorrorHorseHospitalHostHotelHourHoverHubHugeHumanHumbleHumorHundredHungryHuntHurdleHurryHurtHusbandHybridIceIconIdeaIdentifyIdleIgnoreIllIllegalIllnessImageImitateImmenseImmuneImpactImposeImproveImpulseInchIncludeIncomeIncreaseIndexIndicateIndoorIndustryInfantInflictInformInhaleInheritInitialInjectInjuryInmateInnerInnocentInputInquiryInsaneInsectInsideInspireInstallIntactInterestIntoInvestInviteInvolveIronIslandIsolateIssueItemIvoryJacketJaguarJarJazzJealousJeansJellyJewelJobJoinJokeJourneyJoyJudgeJuiceJumpJungleJuniorJunkJustKangarooKeenKeepKetchupKeyKickKidKidneyKindKingdomKissKitKitchenKiteKittenKiwiKneeKnifeKnockKnowLabLabelLaborLadderLadyLakeLampLanguageLaptopLargeLaterLatinLaughLaundryLavaLawLawnLawsuitLayerLazyLeaderLeafLearnLeaveLectureLeftLegLegalLegendLeisureLemonLendLengthLensLeopardLessonLetterLevelLiarLibertyLibraryLicenseLifeLiftLightLikeLimbLimitLinkLionLiquidListLittleLiveLizardLoadLoanLobsterLocalLockLogicLonelyLongLoopLotteryLoudLoungeLoveLoyalLuckyLuggageLumberLunarLunchLuxuryLyricsMachineMadMagicMagnetMaidMailMainMajorMakeMammalManManageMandateMangoMansionManualMapleMarbleMarchMarginMarineMarketMarriageMaskMassMasterMatchMaterialMathMatrixMatterMaximumMazeMeadowMeanMeasureMeatMechanicMedalMediaMelodyMeltMemberMemoryMentionMenuMercyMergeMeritMerryMeshMessageMetalMethodMiddleMidnightMilkMillionMimicMindMinimumMinorMinuteMiracleMirrorMiseryMissMistakeMixMixedMixtureMobileModelModifyMomMomentMonitorMonkeyMonsterMonthMoonMoralMoreMorningMosquitoMotherMotionMotorMountainMouseMoveMovieMuchMuffinMuleMultiplyMuscleMuseumMushroomMusicMustMutualMyselfMysteryMythNaiveNameNapkinNarrowNastyNationNatureNearNeckNeedNegativeNeglectNeitherNephewNerveNestNetNetworkNeutralNeverNewsNextNiceNightNobleNoiseNomineeNoodleNormalNorthNoseNotableNoteNothingNoticeNovelNowNuclearNumberNurseNutOakObeyObjectObligeObscureObserveObtainObviousOccurOceanOctoberOdorOffOfferOfficeOftenOilOkayOldOliveOlympicOmitOnceOneOnionOnlineOnlyOpenOperaOpinionOpposeOptionOrangeOrbitOrchardOrderOrdinaryOrganOrientOriginalOrphanOstrichOtherOutdoorOuterOutputOutsideOvalOvenOverOwnOwnerOxygenOysterOzonePactPaddlePagePairPalacePalmPandaPanelPanicPantherPaperParadeParentParkParrotPartyPassPatchPathPatientPatrolPatternPausePavePaymentPeacePeanutPearPeasantPelicanPenPenaltyPencilPeoplePepperPerfectPermitPersonPetPhonePhotoPhrasePhysicalPianoPicnicPicturePiecePigPigeonPillPilotPinkPioneerPipePistolPitchPizzaPlacePlanetPlasticPlatePlayPleasePledgePluckPlugPlungePoemPoetPointPolarPolePolicePondPonyPoolPopularPortionPositionPossiblePostPotatoPotteryPovertyPowderPowerPracticePraisePredictPreferPreparePresentPrettyPreventPricePridePrimaryPrintPriorityPrisonPrivatePrizeProblemProcessProduceProfitProgramProjectPromoteProofPropertyProsperProtectProudProvidePublicPuddingPullPulpPulsePumpkinPunchPupilPuppyPurchasePurityPurposePursePushPutPuzzlePyramidQualityQuantumQuarterQuestionQuickQuitQuizQuoteRabbitRaccoonRaceRackRadarRadioRailRainRaiseRallyRampRanchRandomRangeRapidRareRateRatherRavenRawRazorReadyRealReasonRebelRebuildRecallReceiveRecipeRecordRecycleReduceReflectReformRefuseRegionRegretRegularRejectRelaxReleaseReliefRelyRemainRememberRemindRemoveRenderRenewRentReopenRepairRepeatReplaceReportRequireRescueResembleResistResourceResponseResultRetireRetreatReturnReunionRevealReviewRewardRhythmRibRibbonRiceRichRideRidgeRifleRightRigidRingRiotRippleRiskRitualRivalRiverRoadRoastRobotRobustRocketRomanceRoofRookieRoomRoseRotateRoughRoundRouteRoyalRubberRudeRugRuleRunRunwayRuralSadSaddleSadnessSafeSailSaladSalmonSalonSaltSaluteSameSampleSandSatisfySatoshiSauceSausageSaveSayScaleScanScareScatterSceneSchemeSchoolScienceScissorsScorpionScoutScrapScreenScriptScrubSeaSearchSeasonSeatSecondSecretSectionSecuritySeedSeekSegmentSelectSellSeminarSeniorSenseSentenceSeriesServiceSessionSettleSetupSevenShadowShaftShallowShareShedShellSheriffShieldShiftShineShipShiverShockShoeShootShopShortShoulderShoveShrimpShrugShuffleShySiblingSickSideSiegeSightSignSilentSilkSillySilverSimilarSimpleSinceSingSirenSisterSituateSixSizeSkateSketchSkiSkillSkinSkirtSkullSlabSlamSleepSlenderSliceSlideSlightSlimSloganSlotSlowSlushSmallSmartSmileSmokeSmoothSnackSnakeSnapSniffSnowSoapSoccerSocialSockSodaSoftSolarSoldierSolidSolutionSolveSomeoneSongSoonSorrySortSoulSoundSoupSourceSouthSpaceSpareSpatialSpawnSpeakSpecialSpeedSpellSpendSphereSpiceSpiderSpikeSpinSpiritSplitSpoilSponsorSpoonSportSpotSpraySpreadSpringSpySquareSqueezeSquirrelStableStadiumStaffStageStairsStampStandStartStateStaySteakSteelStemStepStereoStickStillStingStockStomachStoneStoolStoryStoveStrategyStreetStrikeStrongStruggleStudentStuffStumbleStyleSubjectSubmitSubwaySuccessSuchSuddenSufferSugarSuggestSuitSummerSunSunnySunsetSuperSupplySupremeSureSurfaceSurgeSurpriseSurroundSurveySuspectSustainSwallowSwampSwapSwarmSwearSweetSwiftSwimSwingSwitchSwordSymbolSymptomSyrupSystemTableTackleTagTailTalentTalkTankTapeTargetTaskTasteTattooTaxiTeachTeamTellTenTenantTennisTentTermTestTextThankThatThemeThenTheoryThereTheyThingThisThoughtThreeThriveThrowThumbThunderTicketTideTigerTiltTimberTimeTinyTipTiredTissueTitleToastTobaccoTodayToddlerToeTogetherToiletTokenTomatoTomorrowToneTongueTonightToolToothTopTopicToppleTorchTornadoTortoiseTossTotalTouristTowardTowerTownToyTrackTradeTrafficTragicTrainTransferTrapTrashTravelTrayTreatTreeTrendTrialTribeTrickTriggerTrimTripTrophyTroubleTruckTrueTrulyTrumpetTrustTruthTryTubeTuitionTumbleTunaTunnelTurkeyTurnTurtleTwelveTwentyTwiceTwinTwistTwoTypeTypicalUglyUmbrellaUnableUnawareUncleUncoverUnderUndoUnfairUnfoldUnhappyUniformUniqueUnitUniverseUnknownUnlockUntilUnusualUnveilUpdateUpgradeUpholdUponUpperUpsetUrbanUrgeUsageUseUsedUsefulUselessUsualUtilityVacantVacuumVagueValidValleyValveVanVanishVaporVariousVastVaultVehicleVelvetVendorVentureVenueVerbVerifyVersionVeryVesselVeteranViableVibrantViciousVictoryVideoViewVillageVintageViolinVirtualVirusVisaVisitVisualVitalVividVocalVoiceVoidVolcanoVolumeVoteVoyageWageWagonWaitWalkWallWalnutWantWarfareWarmWarriorWashWaspWasteWaterWaveWayWealthWeaponWearWeaselWeatherWebWeddingWeekendWeirdWelcomeWestWetWhaleWhatWheatWheelWhenWhereWhipWhisperWideWidthWifeWildWillWinWindowWineWingWinkWinnerWinterWireWisdomWiseWishWitnessWolfWomanWonderWoodWoolWordWorkWorldWorryWorthWrapWreckWrestleWristWriteWrongYardYearYellowYouYoungYouthZebraZeroZoneZoo";let wordlist=null;function loadWords(_){if(wordlist==null&&(wordlist=words.replace(/([A-Z])/g," $1").toLowerCase().substring(1).split(" "),Wordlist.check(_)!=="0x3c8acc1e7b08d8e76f9fda015ef48dc8c710a73cb7e0f77b2c18a9b5a7adde60"))throw wordlist=null,new Error("BIP39 Wordlist for en (English) FAILED")}class LangEn extends Wordlist{constructor(){super("en")}getWord(o){return loadWords(this),wordlist[o]}getWordIndex(o){return loadWords(this),wordlist.indexOf(o)}}const langEn=new LangEn;Wordlist.register(langEn);const wordlists={en:langEn},version$5="hdnode/5.7.0",logger$9=new Logger(version$5),N=BigNumber.from("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),MasterSecret=toUtf8Bytes("Bitcoin seed"),HardenedBit=2147483648;function getUpperMask(_){return(1<<_)-1<<8-_}function getLowerMask(_){return(1<<_)-1}function bytes32(_){return hexZeroPad(hexlify(_),32)}function base58check(_){return Base58.encode(concat([_,hexDataSlice(sha256(sha256(_)),0,4)]))}function getWordlist(_){if(_==null)return wordlists.en;if(typeof _=="string"){const o=wordlists[_];return o==null&&logger$9.throwArgumentError("unknown locale","wordlist",_),o}return _}const _constructorGuard={},defaultPath="m/44'/60'/0'/0/0";class HDNode{constructor(o,$,j,et,tt,rt,nt,it){if(o!==_constructorGuard)throw new Error("HDNode constructor cannot be called directly");if($){const st=new SigningKey($);defineReadOnly(this,"privateKey",st.privateKey),defineReadOnly(this,"publicKey",st.compressedPublicKey)}else defineReadOnly(this,"privateKey",null),defineReadOnly(this,"publicKey",hexlify(j));defineReadOnly(this,"parentFingerprint",et),defineReadOnly(this,"fingerprint",hexDataSlice(ripemd160(sha256(this.publicKey)),0,4)),defineReadOnly(this,"address",computeAddress(this.publicKey)),defineReadOnly(this,"chainCode",tt),defineReadOnly(this,"index",rt),defineReadOnly(this,"depth",nt),it==null?(defineReadOnly(this,"mnemonic",null),defineReadOnly(this,"path",null)):typeof it=="string"?(defineReadOnly(this,"mnemonic",null),defineReadOnly(this,"path",it)):(defineReadOnly(this,"mnemonic",it),defineReadOnly(this,"path",it.path))}get extendedKey(){if(this.depth>=256)throw new Error("Depth too large!");return base58check(concat([this.privateKey!=null?"0x0488ADE4":"0x0488B21E",hexlify(this.depth),this.parentFingerprint,hexZeroPad(hexlify(this.index),4),this.chainCode,this.privateKey!=null?concat(["0x00",this.privateKey]):this.publicKey]))}neuter(){return new HDNode(_constructorGuard,null,this.publicKey,this.parentFingerprint,this.chainCode,this.index,this.depth,this.path)}_derive(o){if(o>4294967295)throw new Error("invalid index - "+String(o));let $=this.path;$&&($+="/"+(o&~HardenedBit));const j=new Uint8Array(37);if(o&HardenedBit){if(!this.privateKey)throw new Error("cannot derive child of neutered node");j.set(arrayify(this.privateKey),1),$&&($+="'")}else j.set(arrayify(this.publicKey));for(let at=24;at>=0;at-=8)j[33+(at>>3)]=o>>24-at&255;const et=arrayify(computeHmac(SupportedAlgorithm.sha512,this.chainCode,j)),tt=et.slice(0,32),rt=et.slice(32);let nt=null,it=null;this.privateKey?nt=bytes32(BigNumber.from(tt).add(this.privateKey).mod(N)):it=new SigningKey(hexlify(tt))._addPoint(this.publicKey);let st=$;const ot=this.mnemonic;return ot&&(st=Object.freeze({phrase:ot.phrase,path:$,locale:ot.locale||"en"})),new HDNode(_constructorGuard,nt,it,this.fingerprint,bytes32(rt),o,this.depth+1,st)}derivePath(o){const $=o.split("/");if($.length===0||$[0]==="m"&&this.depth!==0)throw new Error("invalid path - "+o);$[0]==="m"&&$.shift();let j=this;for(let et=0;et<$.length;et++){const tt=$[et];if(tt.match(/^[0-9]+'$/)){const rt=parseInt(tt.substring(0,tt.length-1));if(rt>=HardenedBit)throw new Error("invalid path index - "+tt);j=j._derive(HardenedBit+rt)}else if(tt.match(/^[0-9]+$/)){const rt=parseInt(tt);if(rt>=HardenedBit)throw new Error("invalid path index - "+tt);j=j._derive(rt)}else throw new Error("invalid path component - "+tt)}return j}static _fromSeed(o,$){const j=arrayify(o);if(j.length<16||j.length>64)throw new Error("invalid seed");const et=arrayify(computeHmac(SupportedAlgorithm.sha512,MasterSecret,j));return new HDNode(_constructorGuard,bytes32(et.slice(0,32)),null,"0x00000000",bytes32(et.slice(32)),0,0,$)}static fromMnemonic(o,$,j){return j=getWordlist(j),o=entropyToMnemonic(mnemonicToEntropy(o,j),j),HDNode._fromSeed(mnemonicToSeed(o,$),{phrase:o,path:"m",locale:j.locale})}static fromSeed(o){return HDNode._fromSeed(o,null)}static fromExtendedKey(o){const $=Base58.decode(o);($.length!==82||base58check($.slice(0,78))!==o)&&logger$9.throwArgumentError("invalid extended key","extendedKey","[REDACTED]");const j=$[4],et=hexlify($.slice(5,9)),tt=parseInt(hexlify($.slice(9,13)).substring(2),16),rt=hexlify($.slice(13,45)),nt=$.slice(45,78);switch(hexlify($.slice(0,4))){case"0x0488b21e":case"0x043587cf":return new HDNode(_constructorGuard,null,hexlify(nt),et,rt,tt,j,null);case"0x0488ade4":case"0x04358394 ":if(nt[0]!==0)break;return new HDNode(_constructorGuard,hexlify(nt.slice(1)),null,et,rt,tt,j,null)}return logger$9.throwArgumentError("invalid extended key","extendedKey","[REDACTED]")}}function mnemonicToSeed(_,o){o||(o="");const $=toUtf8Bytes("mnemonic"+o,UnicodeNormalizationForm.NFKD);return pbkdf2$1(toUtf8Bytes(_,UnicodeNormalizationForm.NFKD),$,2048,64,"sha512")}function mnemonicToEntropy(_,o){o=getWordlist(o),logger$9.checkNormalize();const $=o.split(_);if($.length%3!==0)throw new Error("invalid mnemonic");const j=arrayify(new Uint8Array(Math.ceil(11*$.length/8)));let et=0;for(let st=0;st<$.length;st++){let ot=o.getWordIndex($[st].normalize("NFKD"));if(ot===-1)throw new Error("invalid mnemonic");for(let at=0;at<11;at++)ot&1<<10-at&&(j[et>>3]|=1<<7-et%8),et++}const tt=32*$.length/3,rt=$.length/3,nt=getUpperMask(rt);if((arrayify(sha256(j.slice(0,tt/8)))[0]&nt)!==(j[j.length-1]&nt))throw new Error("invalid checksum");return hexlify(j.slice(0,tt/8))}function entropyToMnemonic(_,o){if(o=getWordlist(o),_=arrayify(_),_.length%4!==0||_.length<16||_.length>32)throw new Error("invalid entropy");const $=[0];let j=11;for(let rt=0;rt<_.length;rt++)j>8?($[$.length-1]<<=8,$[$.length-1]|=_[rt],j-=8):($[$.length-1]<<=j,$[$.length-1]|=_[rt]>>8-j,$.push(_[rt]&getLowerMask(8-j)),j+=3);const et=_.length/4,tt=arrayify(sha256(_))[0]&getUpperMask(et);return $[$.length-1]<<=et,$[$.length-1]|=tt>>8-et,o.join($.map(rt=>o.getWord(rt)))}const version$4="random/5.7.0",logger$8=new Logger(version$4);function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof _global<"u")return _global;throw new Error("unable to locate global object")}const anyGlobal=getGlobal();let crypto$2=anyGlobal.crypto||anyGlobal.msCrypto;(!crypto$2||!crypto$2.getRandomValues)&&(logger$8.warn("WARNING: Missing strong random number source"),crypto$2={getRandomValues:function(_){return logger$8.throwError("no secure random source avaialble",Logger.errors.UNSUPPORTED_OPERATION,{operation:"crypto.getRandomValues"})}});function randomBytes$2(_){(_<=0||_>1024||_%1||_!=_)&&logger$8.throwArgumentError("invalid length","length",_);const o=new Uint8Array(_);return crypto$2.getRandomValues(o),arrayify(o)}var aesJsExports={},aesJs={get exports(){return aesJsExports},set exports(_){aesJsExports=_}};(function(_,o){(function($){function j(vt){return parseInt(vt)===vt}function et(vt){if(!j(vt.length))return!1;for(var dt=0;dt<vt.length;dt++)if(!j(vt[dt])||vt[dt]<0||vt[dt]>255)return!1;return!0}function tt(vt,dt){if(vt.buffer&&ArrayBuffer.isView(vt)&&vt.name==="Uint8Array")return dt&&(vt.slice?vt=vt.slice():vt=Array.prototype.slice.call(vt)),vt;if(Array.isArray(vt)){if(!et(vt))throw new Error("Array contains invalid value: "+vt);return new Uint8Array(vt)}if(j(vt.length)&&et(vt))return new Uint8Array(vt);throw new Error("unsupported array-like object")}function rt(vt){return new Uint8Array(vt)}function nt(vt,dt,wt,qt,Pt){(qt!=null||Pt!=null)&&(vt.slice?vt=vt.slice(qt,Pt):vt=Array.prototype.slice.call(vt,qt,Pt)),dt.set(vt,wt)}var it=function(){function vt(wt){var qt=[],Pt=0;for(wt=encodeURI(wt);Pt<wt.length;){var Gt=wt.charCodeAt(Pt++);Gt===37?(qt.push(parseInt(wt.substr(Pt,2),16)),Pt+=2):qt.push(Gt)}return tt(qt)}function dt(wt){for(var qt=[],Pt=0;Pt<wt.length;){var Gt=wt[Pt];Gt<128?(qt.push(String.fromCharCode(Gt)),Pt++):Gt>191&&Gt<224?(qt.push(String.fromCharCode((Gt&31)<<6|wt[Pt+1]&63)),Pt+=2):(qt.push(String.fromCharCode((Gt&15)<<12|(wt[Pt+1]&63)<<6|wt[Pt+2]&63)),Pt+=3)}return qt.join("")}return{toBytes:vt,fromBytes:dt}}(),st=function(){function vt(qt){for(var Pt=[],Gt=0;Gt<qt.length;Gt+=2)Pt.push(parseInt(qt.substr(Gt,2),16));return Pt}var dt="0123456789abcdef";function wt(qt){for(var Pt=[],Gt=0;Gt<qt.length;Gt++){var Wt=qt[Gt];Pt.push(dt[(Wt&240)>>4]+dt[Wt&15])}return Pt.join("")}return{toBytes:vt,fromBytes:wt}}(),ot={16:10,24:12,32:14},at=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],ct=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],ut=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],ft=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],ht=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],mt=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],gt=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],Et=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],St=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],At=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],kt=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],Rt=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],Tt=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],Dt=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],Ot=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function jt(vt){for(var dt=[],wt=0;wt<vt.length;wt+=4)dt.push(vt[wt]<<24|vt[wt+1]<<16|vt[wt+2]<<8|vt[wt+3]);return dt}var Nt=function(vt){if(!(this instanceof Nt))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:tt(vt,!0)}),this._prepare()};Nt.prototype._prepare=function(){var vt=ot[this.key.length];if(vt==null)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var dt=0;dt<=vt;dt++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);for(var wt=(vt+1)*4,qt=this.key.length/4,Pt=jt(this.key),Gt,dt=0;dt<qt;dt++)Gt=dt>>2,this._Ke[Gt][dt%4]=Pt[dt],this._Kd[vt-Gt][dt%4]=Pt[dt];for(var Wt=0,Vt=qt,Ut;Vt<wt;){if(Ut=Pt[qt-1],Pt[0]^=ct[Ut>>16&255]<<24^ct[Ut>>8&255]<<16^ct[Ut&255]<<8^ct[Ut>>24&255]^at[Wt]<<24,Wt+=1,qt!=8)for(var dt=1;dt<qt;dt++)Pt[dt]^=Pt[dt-1];else{for(var dt=1;dt<qt/2;dt++)Pt[dt]^=Pt[dt-1];Ut=Pt[qt/2-1],Pt[qt/2]^=ct[Ut&255]^ct[Ut>>8&255]<<8^ct[Ut>>16&255]<<16^ct[Ut>>24&255]<<24;for(var dt=qt/2+1;dt<qt;dt++)Pt[dt]^=Pt[dt-1]}for(var dt=0,Mt,Lt;dt<qt&&Vt<wt;)Mt=Vt>>2,Lt=Vt%4,this._Ke[Mt][Lt]=Pt[dt],this._Kd[vt-Mt][Lt]=Pt[dt++],Vt++}for(var Mt=1;Mt<vt;Mt++)for(var Lt=0;Lt<4;Lt++)Ut=this._Kd[Mt][Lt],this._Kd[Mt][Lt]=Rt[Ut>>24&255]^Tt[Ut>>16&255]^Dt[Ut>>8&255]^Ot[Ut&255]},Nt.prototype.encrypt=function(vt){if(vt.length!=16)throw new Error("invalid plaintext size (must be 16 bytes)");for(var dt=this._Ke.length-1,wt=[0,0,0,0],qt=jt(vt),Pt=0;Pt<4;Pt++)qt[Pt]^=this._Ke[0][Pt];for(var Gt=1;Gt<dt;Gt++){for(var Pt=0;Pt<4;Pt++)wt[Pt]=ft[qt[Pt]>>24&255]^ht[qt[(Pt+1)%4]>>16&255]^mt[qt[(Pt+2)%4]>>8&255]^gt[qt[(Pt+3)%4]&255]^this._Ke[Gt][Pt];qt=wt.slice()}for(var Wt=rt(16),Vt,Pt=0;Pt<4;Pt++)Vt=this._Ke[dt][Pt],Wt[4*Pt]=(ct[qt[Pt]>>24&255]^Vt>>24)&255,Wt[4*Pt+1]=(ct[qt[(Pt+1)%4]>>16&255]^Vt>>16)&255,Wt[4*Pt+2]=(ct[qt[(Pt+2)%4]>>8&255]^Vt>>8)&255,Wt[4*Pt+3]=(ct[qt[(Pt+3)%4]&255]^Vt)&255;return Wt},Nt.prototype.decrypt=function(vt){if(vt.length!=16)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var dt=this._Kd.length-1,wt=[0,0,0,0],qt=jt(vt),Pt=0;Pt<4;Pt++)qt[Pt]^=this._Kd[0][Pt];for(var Gt=1;Gt<dt;Gt++){for(var Pt=0;Pt<4;Pt++)wt[Pt]=Et[qt[Pt]>>24&255]^St[qt[(Pt+3)%4]>>16&255]^At[qt[(Pt+2)%4]>>8&255]^kt[qt[(Pt+1)%4]&255]^this._Kd[Gt][Pt];qt=wt.slice()}for(var Wt=rt(16),Vt,Pt=0;Pt<4;Pt++)Vt=this._Kd[dt][Pt],Wt[4*Pt]=(ut[qt[Pt]>>24&255]^Vt>>24)&255,Wt[4*Pt+1]=(ut[qt[(Pt+3)%4]>>16&255]^Vt>>16)&255,Wt[4*Pt+2]=(ut[qt[(Pt+2)%4]>>8&255]^Vt>>8)&255,Wt[4*Pt+3]=(ut[qt[(Pt+1)%4]&255]^Vt)&255;return Wt};var It=function(vt){if(!(this instanceof It))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this._aes=new Nt(vt)};It.prototype.encrypt=function(vt){if(vt=tt(vt),vt.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var dt=rt(vt.length),wt=rt(16),qt=0;qt<vt.length;qt+=16)nt(vt,wt,0,qt,qt+16),wt=this._aes.encrypt(wt),nt(wt,dt,qt);return dt},It.prototype.decrypt=function(vt){if(vt=tt(vt),vt.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var dt=rt(vt.length),wt=rt(16),qt=0;qt<vt.length;qt+=16)nt(vt,wt,0,qt,qt+16),wt=this._aes.decrypt(wt),nt(wt,dt,qt);return dt};var yt=function(vt,dt){if(!(this instanceof yt))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",!dt)dt=rt(16);else if(dt.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastCipherblock=tt(dt,!0),this._aes=new Nt(vt)};yt.prototype.encrypt=function(vt){if(vt=tt(vt),vt.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var dt=rt(vt.length),wt=rt(16),qt=0;qt<vt.length;qt+=16){nt(vt,wt,0,qt,qt+16);for(var Pt=0;Pt<16;Pt++)wt[Pt]^=this._lastCipherblock[Pt];this._lastCipherblock=this._aes.encrypt(wt),nt(this._lastCipherblock,dt,qt)}return dt},yt.prototype.decrypt=function(vt){if(vt=tt(vt),vt.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var dt=rt(vt.length),wt=rt(16),qt=0;qt<vt.length;qt+=16){nt(vt,wt,0,qt,qt+16),wt=this._aes.decrypt(wt);for(var Pt=0;Pt<16;Pt++)dt[qt+Pt]=wt[Pt]^this._lastCipherblock[Pt];nt(vt,this._lastCipherblock,0,qt,qt+16)}return dt};var lt=function(vt,dt,wt){if(!(this instanceof lt))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Feedback",this.name="cfb",!dt)dt=rt(16);else if(dt.length!=16)throw new Error("invalid initialation vector size (must be 16 size)");wt||(wt=1),this.segmentSize=wt,this._shiftRegister=tt(dt,!0),this._aes=new Nt(vt)};lt.prototype.encrypt=function(vt){if(vt.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");for(var dt=tt(vt,!0),wt,qt=0;qt<dt.length;qt+=this.segmentSize){wt=this._aes.encrypt(this._shiftRegister);for(var Pt=0;Pt<this.segmentSize;Pt++)dt[qt+Pt]^=wt[Pt];nt(this._shiftRegister,this._shiftRegister,0,this.segmentSize),nt(dt,this._shiftRegister,16-this.segmentSize,qt,qt+this.segmentSize)}return dt},lt.prototype.decrypt=function(vt){if(vt.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");for(var dt=tt(vt,!0),wt,qt=0;qt<dt.length;qt+=this.segmentSize){wt=this._aes.encrypt(this._shiftRegister);for(var Pt=0;Pt<this.segmentSize;Pt++)dt[qt+Pt]^=wt[Pt];nt(this._shiftRegister,this._shiftRegister,0,this.segmentSize),nt(vt,this._shiftRegister,16-this.segmentSize,qt,qt+this.segmentSize)}return dt};var pt=function(vt,dt){if(!(this instanceof pt))throw Error("AES must be instanitated with `new`");if(this.description="Output Feedback",this.name="ofb",!dt)dt=rt(16);else if(dt.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastPrecipher=tt(dt,!0),this._lastPrecipherIndex=16,this._aes=new Nt(vt)};pt.prototype.encrypt=function(vt){for(var dt=tt(vt,!0),wt=0;wt<dt.length;wt++)this._lastPrecipherIndex===16&&(this._lastPrecipher=this._aes.encrypt(this._lastPrecipher),this._lastPrecipherIndex=0),dt[wt]^=this._lastPrecipher[this._lastPrecipherIndex++];return dt},pt.prototype.decrypt=pt.prototype.encrypt;var bt=function(vt){if(!(this instanceof bt))throw Error("Counter must be instanitated with `new`");vt!==0&&!vt&&(vt=1),typeof vt=="number"?(this._counter=rt(16),this.setValue(vt)):this.setBytes(vt)};bt.prototype.setValue=function(vt){if(typeof vt!="number"||parseInt(vt)!=vt)throw new Error("invalid counter value (must be an integer)");for(var dt=15;dt>=0;--dt)this._counter[dt]=vt%256,vt=vt>>8},bt.prototype.setBytes=function(vt){if(vt=tt(vt,!0),vt.length!=16)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=vt},bt.prototype.increment=function(){for(var vt=15;vt>=0;vt--)if(this._counter[vt]===255)this._counter[vt]=0;else{this._counter[vt]++;break}};var _t=function(vt,dt){if(!(this instanceof _t))throw Error("AES must be instanitated with `new`");this.description="Counter",this.name="ctr",dt instanceof bt||(dt=new bt(dt)),this._counter=dt,this._remainingCounter=null,this._remainingCounterIndex=16,this._aes=new Nt(vt)};_t.prototype.encrypt=function(vt){for(var dt=tt(vt,!0),wt=0;wt<dt.length;wt++)this._remainingCounterIndex===16&&(this._remainingCounter=this._aes.encrypt(this._counter._counter),this._remainingCounterIndex=0,this._counter.increment()),dt[wt]^=this._remainingCounter[this._remainingCounterIndex++];return dt},_t.prototype.decrypt=_t.prototype.encrypt;function $t(vt){vt=tt(vt,!0);var dt=16-vt.length%16,wt=rt(vt.length+dt);nt(vt,wt);for(var qt=vt.length;qt<wt.length;qt++)wt[qt]=dt;return wt}function Ct(vt){if(vt=tt(vt,!0),vt.length<16)throw new Error("PKCS#7 invalid length");var dt=vt[vt.length-1];if(dt>16)throw new Error("PKCS#7 padding byte out of range");for(var wt=vt.length-dt,qt=0;qt<dt;qt++)if(vt[wt+qt]!==dt)throw new Error("PKCS#7 invalid padding byte");var Pt=rt(wt);return nt(vt,Pt,0,0,wt),Pt}var xt={AES:Nt,Counter:bt,ModeOfOperation:{ecb:It,cbc:yt,cfb:lt,ofb:pt,ctr:_t},utils:{hex:st,utf8:it},padding:{pkcs7:{pad:$t,strip:Ct}},_arrayTest:{coerceArray:tt,createArray:rt,copyArray:nt}};_.exports=xt})()})(aesJs);const aes=aesJsExports,version$3="json-wallets/5.7.0";function looseArrayify(_){return typeof _=="string"&&_.substring(0,2)!=="0x"&&(_="0x"+_),arrayify(_)}function zpad(_,o){for(_=String(_);_.length<o;)_="0"+_;return _}function getPassword(_){return typeof _=="string"?toUtf8Bytes(_,UnicodeNormalizationForm.NFKC):arrayify(_)}function searchPath(_,o){let $=_;const j=o.toLowerCase().split("/");for(let et=0;et<j.length;et++){let tt=null;for(const rt in $)if(rt.toLowerCase()===j[et]){tt=$[rt];break}if(tt===null)return null;$=tt}return $}function uuidV4(_){const o=arrayify(_);o[6]=o[6]&15|64,o[8]=o[8]&63|128;const $=hexlify(o);return[$.substring(2,10),$.substring(10,14),$.substring(14,18),$.substring(18,22),$.substring(22,34)].join("-")}const logger$7=new Logger(version$3);class CrowdsaleAccount extends Description{isCrowdsaleAccount(o){return!!(o&&o._isCrowdsaleAccount)}}function decrypt$1(_,o){const $=JSON.parse(_);o=getPassword(o);const j=getAddress(searchPath($,"ethaddr")),et=looseArrayify(searchPath($,"encseed"));(!et||et.length%16!==0)&&logger$7.throwArgumentError("invalid encseed","json",_);const tt=arrayify(pbkdf2$1(o,o,2e3,32,"sha256")).slice(0,16),rt=et.slice(0,16),nt=et.slice(16),it=new aes.ModeOfOperation.cbc(tt,rt),st=aes.padding.pkcs7.strip(arrayify(it.decrypt(nt)));let ot="";for(let ut=0;ut<st.length;ut++)ot+=String.fromCharCode(st[ut]);const at=toUtf8Bytes(ot),ct=keccak256(at);return new CrowdsaleAccount({_isCrowdsaleAccount:!0,address:j,privateKey:ct})}function isCrowdsaleWallet(_){let o=null;try{o=JSON.parse(_)}catch{return!1}return o.encseed&&o.ethaddr}function isKeystoreWallet(_){let o=null;try{o=JSON.parse(_)}catch{return!1}return!(!o.version||parseInt(o.version)!==o.version||parseInt(o.version)!==3)}var scryptExports={},scrypt$1={get exports(){return scryptExports},set exports(_){scryptExports=_}};(function(_,o){(function($){function et(ht){const mt=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let gt=1779033703,Et=3144134277,St=1013904242,At=2773480762,kt=1359893119,Rt=2600822924,Tt=528734635,Dt=1541459225;const Ot=new Uint32Array(64);function jt(_t){let $t=0,Ct=_t.length;for(;Ct>=64;){let xt=gt,vt=Et,dt=St,wt=At,qt=kt,Pt=Rt,Gt=Tt,Wt=Dt,Vt,Ut,Mt,Lt,Yt;for(Ut=0;Ut<16;Ut++)Mt=$t+Ut*4,Ot[Ut]=(_t[Mt]&255)<<24|(_t[Mt+1]&255)<<16|(_t[Mt+2]&255)<<8|_t[Mt+3]&255;for(Ut=16;Ut<64;Ut++)Vt=Ot[Ut-2],Lt=(Vt>>>17|Vt<<32-17)^(Vt>>>19|Vt<<32-19)^Vt>>>10,Vt=Ot[Ut-15],Yt=(Vt>>>7|Vt<<32-7)^(Vt>>>18|Vt<<32-18)^Vt>>>3,Ot[Ut]=(Lt+Ot[Ut-7]|0)+(Yt+Ot[Ut-16]|0)|0;for(Ut=0;Ut<64;Ut++)Lt=(((qt>>>6|qt<<32-6)^(qt>>>11|qt<<32-11)^(qt>>>25|qt<<32-25))+(qt&Pt^~qt&Gt)|0)+(Wt+(mt[Ut]+Ot[Ut]|0)|0)|0,Yt=((xt>>>2|xt<<32-2)^(xt>>>13|xt<<32-13)^(xt>>>22|xt<<32-22))+(xt&vt^xt&dt^vt&dt)|0,Wt=Gt,Gt=Pt,Pt=qt,qt=wt+Lt|0,wt=dt,dt=vt,vt=xt,xt=Lt+Yt|0;gt=gt+xt|0,Et=Et+vt|0,St=St+dt|0,At=At+wt|0,kt=kt+qt|0,Rt=Rt+Pt|0,Tt=Tt+Gt|0,Dt=Dt+Wt|0,$t+=64,Ct-=64}}jt(ht);let Nt,It=ht.length%64,yt=ht.length/536870912|0,lt=ht.length<<3,pt=It<56?56:120,bt=ht.slice(ht.length-It,ht.length);for(bt.push(128),Nt=It+1;Nt<pt;Nt++)bt.push(0);return bt.push(yt>>>24&255),bt.push(yt>>>16&255),bt.push(yt>>>8&255),bt.push(yt>>>0&255),bt.push(lt>>>24&255),bt.push(lt>>>16&255),bt.push(lt>>>8&255),bt.push(lt>>>0&255),jt(bt),[gt>>>24&255,gt>>>16&255,gt>>>8&255,gt>>>0&255,Et>>>24&255,Et>>>16&255,Et>>>8&255,Et>>>0&255,St>>>24&255,St>>>16&255,St>>>8&255,St>>>0&255,At>>>24&255,At>>>16&255,At>>>8&255,At>>>0&255,kt>>>24&255,kt>>>16&255,kt>>>8&255,kt>>>0&255,Rt>>>24&255,Rt>>>16&255,Rt>>>8&255,Rt>>>0&255,Tt>>>24&255,Tt>>>16&255,Tt>>>8&255,Tt>>>0&255,Dt>>>24&255,Dt>>>16&255,Dt>>>8&255,Dt>>>0&255]}function tt(ht,mt,gt){ht=ht.length<=64?ht:et(ht);const Et=64+mt.length+4,St=new Array(Et),At=new Array(64);let kt,Rt=[];for(kt=0;kt<64;kt++)St[kt]=54;for(kt=0;kt<ht.length;kt++)St[kt]^=ht[kt];for(kt=0;kt<mt.length;kt++)St[64+kt]=mt[kt];for(kt=Et-4;kt<Et;kt++)St[kt]=0;for(kt=0;kt<64;kt++)At[kt]=92;for(kt=0;kt<ht.length;kt++)At[kt]^=ht[kt];function Tt(){for(let Dt=Et-1;Dt>=Et-4;Dt--){if(St[Dt]++,St[Dt]<=255)return;St[Dt]=0}}for(;gt>=32;)Tt(),Rt=Rt.concat(et(At.concat(et(St)))),gt-=32;return gt>0&&(Tt(),Rt=Rt.concat(et(At.concat(et(St))).slice(0,gt))),Rt}function rt(ht,mt,gt,Et,St){let At;for(ot(ht,(2*gt-1)*16,St,0,16),At=0;At<2*gt;At++)st(ht,At*16,St,16),it(St,Et),ot(St,0,ht,mt+At*16,16);for(At=0;At<gt;At++)ot(ht,mt+At*2*16,ht,At*16,16);for(At=0;At<gt;At++)ot(ht,mt+(At*2+1)*16,ht,(At+gt)*16,16)}function nt(ht,mt){return ht<<mt|ht>>>32-mt}function it(ht,mt){ot(ht,0,mt,0,16);for(let gt=8;gt>0;gt-=2)mt[4]^=nt(mt[0]+mt[12],7),mt[8]^=nt(mt[4]+mt[0],9),mt[12]^=nt(mt[8]+mt[4],13),mt[0]^=nt(mt[12]+mt[8],18),mt[9]^=nt(mt[5]+mt[1],7),mt[13]^=nt(mt[9]+mt[5],9),mt[1]^=nt(mt[13]+mt[9],13),mt[5]^=nt(mt[1]+mt[13],18),mt[14]^=nt(mt[10]+mt[6],7),mt[2]^=nt(mt[14]+mt[10],9),mt[6]^=nt(mt[2]+mt[14],13),mt[10]^=nt(mt[6]+mt[2],18),mt[3]^=nt(mt[15]+mt[11],7),mt[7]^=nt(mt[3]+mt[15],9),mt[11]^=nt(mt[7]+mt[3],13),mt[15]^=nt(mt[11]+mt[7],18),mt[1]^=nt(mt[0]+mt[3],7),mt[2]^=nt(mt[1]+mt[0],9),mt[3]^=nt(mt[2]+mt[1],13),mt[0]^=nt(mt[3]+mt[2],18),mt[6]^=nt(mt[5]+mt[4],7),mt[7]^=nt(mt[6]+mt[5],9),mt[4]^=nt(mt[7]+mt[6],13),mt[5]^=nt(mt[4]+mt[7],18),mt[11]^=nt(mt[10]+mt[9],7),mt[8]^=nt(mt[11]+mt[10],9),mt[9]^=nt(mt[8]+mt[11],13),mt[10]^=nt(mt[9]+mt[8],18),mt[12]^=nt(mt[15]+mt[14],7),mt[13]^=nt(mt[12]+mt[15],9),mt[14]^=nt(mt[13]+mt[12],13),mt[15]^=nt(mt[14]+mt[13],18);for(let gt=0;gt<16;++gt)ht[gt]+=mt[gt]}function st(ht,mt,gt,Et){for(let St=0;St<Et;St++)gt[St]^=ht[mt+St]}function ot(ht,mt,gt,Et,St){for(;St--;)gt[Et++]=ht[mt++]}function at(ht){if(!ht||typeof ht.length!="number")return!1;for(let mt=0;mt<ht.length;mt++){const gt=ht[mt];if(typeof gt!="number"||gt%1||gt<0||gt>=256)return!1}return!0}function ct(ht,mt){if(typeof ht!="number"||ht%1)throw new Error("invalid "+mt);return ht}function ut(ht,mt,gt,Et,St,At,kt){if(gt=ct(gt,"N"),Et=ct(Et,"r"),St=ct(St,"p"),At=ct(At,"dkLen"),gt===0||gt&gt-1)throw new Error("N must be power of 2");if(gt>2147483647/128/Et)throw new Error("N too large");if(Et>2147483647/128/St)throw new Error("r too large");if(!at(ht))throw new Error("password must be an array or buffer");if(ht=Array.prototype.slice.call(ht),!at(mt))throw new Error("salt must be an array or buffer");mt=Array.prototype.slice.call(mt);let Rt=tt(ht,mt,St*128*Et);const Tt=new Uint32Array(St*32*Et);for(let qt=0;qt<Tt.length;qt++){const Pt=qt*4;Tt[qt]=(Rt[Pt+3]&255)<<24|(Rt[Pt+2]&255)<<16|(Rt[Pt+1]&255)<<8|(Rt[Pt+0]&255)<<0}const Dt=new Uint32Array(64*Et),Ot=new Uint32Array(32*Et*gt),jt=32*Et,Nt=new Uint32Array(16),It=new Uint32Array(16),yt=St*gt*2;let lt=0,pt=null,bt=!1,_t=0,$t=0,Ct,xt;const vt=kt?parseInt(1e3/Et):4294967295,dt=typeof setImmediate<"u"?setImmediate:setTimeout,wt=function(){if(bt)return kt(new Error("cancelled"),lt/yt);let qt;switch(_t){case 0:xt=$t*32*Et,ot(Tt,xt,Dt,0,jt),_t=1,Ct=0;case 1:qt=gt-Ct,qt>vt&&(qt=vt);for(let Gt=0;Gt<qt;Gt++)ot(Dt,0,Ot,(Ct+Gt)*jt,jt),rt(Dt,jt,Et,Nt,It);if(Ct+=qt,lt+=qt,kt){const Gt=parseInt(1e3*lt/yt);if(Gt!==pt){if(bt=kt(null,lt/yt),bt)break;pt=Gt}}if(Ct<gt)break;Ct=0,_t=2;case 2:qt=gt-Ct,qt>vt&&(qt=vt);for(let Gt=0;Gt<qt;Gt++){const Wt=(2*Et-1)*16,Vt=Dt[Wt]&gt-1;st(Ot,Vt*jt,Dt,jt),rt(Dt,jt,Et,Nt,It)}if(Ct+=qt,lt+=qt,kt){const Gt=parseInt(1e3*lt/yt);if(Gt!==pt){if(bt=kt(null,lt/yt),bt)break;pt=Gt}}if(Ct<gt)break;if(ot(Dt,0,Tt,xt,jt),$t++,$t<St){_t=0;break}Rt=[];for(let Gt=0;Gt<Tt.length;Gt++)Rt.push(Tt[Gt]>>0&255),Rt.push(Tt[Gt]>>8&255),Rt.push(Tt[Gt]>>16&255),Rt.push(Tt[Gt]>>24&255);const Pt=tt(ht,Rt,At);return kt&&kt(null,1,Pt),Pt}kt&&dt(wt)};if(!kt)for(;;){const qt=wt();if(qt!=null)return qt}wt()}const ft={scrypt:function(ht,mt,gt,Et,St,At,kt){return new Promise(function(Rt,Tt){let Dt=0;kt&&kt(0),ut(ht,mt,gt,Et,St,At,function(Ot,jt,Nt){if(Ot)Tt(Ot);else if(Nt)kt&&Dt!==1&&kt(1),Rt(new Uint8Array(Nt));else if(kt&&jt!==Dt)return Dt=jt,kt(jt)})})},syncScrypt:function(ht,mt,gt,Et,St,At){return new Uint8Array(ut(ht,mt,gt,Et,St,At))}};_.exports=ft})()})(scrypt$1);const scrypt=scryptExports;var __awaiter$1=globalThis&&globalThis.__awaiter||function(_,o,$,j){function et(tt){return tt instanceof $?tt:new $(function(rt){rt(tt)})}return new($||($=Promise))(function(tt,rt){function nt(ot){try{st(j.next(ot))}catch(at){rt(at)}}function it(ot){try{st(j.throw(ot))}catch(at){rt(at)}}function st(ot){ot.done?tt(ot.value):et(ot.value).then(nt,it)}st((j=j.apply(_,o||[])).next())})};const logger$6=new Logger(version$3);function hasMnemonic$1(_){return _!=null&&_.mnemonic&&_.mnemonic.phrase}class KeystoreAccount extends Description{isKeystoreAccount(o){return!!(o&&o._isKeystoreAccount)}}function _decrypt(_,o,$){if(searchPath(_,"crypto/cipher")==="aes-128-ctr"){const et=looseArrayify(searchPath(_,"crypto/cipherparams/iv")),tt=new aes.Counter(et),rt=new aes.ModeOfOperation.ctr(o,tt);return arrayify(rt.decrypt($))}return null}function _getAccount(_,o){const $=looseArrayify(searchPath(_,"crypto/ciphertext"));if(hexlify(keccak256(concat([o.slice(16,32),$]))).substring(2)!==searchPath(_,"crypto/mac").toLowerCase())throw new Error("invalid password");const et=_decrypt(_,o.slice(0,16),$);et||logger$6.throwError("unsupported cipher",Logger.errors.UNSUPPORTED_OPERATION,{operation:"decrypt"});const tt=o.slice(32,64),rt=computeAddress(et);if(_.address){let it=_.address.toLowerCase();if(it.substring(0,2)!=="0x"&&(it="0x"+it),getAddress(it)!==rt)throw new Error("address mismatch")}const nt={_isKeystoreAccount:!0,address:rt,privateKey:hexlify(et)};if(searchPath(_,"x-ethers/version")==="0.1"){const it=looseArrayify(searchPath(_,"x-ethers/mnemonicCiphertext")),st=looseArrayify(searchPath(_,"x-ethers/mnemonicCounter")),ot=new aes.Counter(st),at=new aes.ModeOfOperation.ctr(tt,ot),ct=searchPath(_,"x-ethers/path")||defaultPath,ut=searchPath(_,"x-ethers/locale")||"en",ft=arrayify(at.decrypt(it));try{const ht=entropyToMnemonic(ft,ut),mt=HDNode.fromMnemonic(ht,null,ut).derivePath(ct);if(mt.privateKey!=nt.privateKey)throw new Error("mnemonic mismatch");nt.mnemonic=mt.mnemonic}catch(ht){if(ht.code!==Logger.errors.INVALID_ARGUMENT||ht.argument!=="wordlist")throw ht}}return new KeystoreAccount(nt)}function pbkdf2Sync(_,o,$,j,et){return arrayify(pbkdf2$1(_,o,$,j,et))}function pbkdf2(_,o,$,j,et){return Promise.resolve(pbkdf2Sync(_,o,$,j,et))}function _computeKdfKey(_,o,$,j,et){const tt=getPassword(o),rt=searchPath(_,"crypto/kdf");if(rt&&typeof rt=="string"){const nt=function(it,st){return logger$6.throwArgumentError("invalid key-derivation function parameters",it,st)};if(rt.toLowerCase()==="scrypt"){const it=looseArrayify(searchPath(_,"crypto/kdfparams/salt")),st=parseInt(searchPath(_,"crypto/kdfparams/n")),ot=parseInt(searchPath(_,"crypto/kdfparams/r")),at=parseInt(searchPath(_,"crypto/kdfparams/p"));(!st||!ot||!at)&&nt("kdf",rt),st&st-1&&nt("N",st);const ct=parseInt(searchPath(_,"crypto/kdfparams/dklen"));return ct!==32&&nt("dklen",ct),j(tt,it,st,ot,at,64,et)}else if(rt.toLowerCase()==="pbkdf2"){const it=looseArrayify(searchPath(_,"crypto/kdfparams/salt"));let st=null;const ot=searchPath(_,"crypto/kdfparams/prf");ot==="hmac-sha256"?st="sha256":ot==="hmac-sha512"?st="sha512":nt("prf",ot);const at=parseInt(searchPath(_,"crypto/kdfparams/c")),ct=parseInt(searchPath(_,"crypto/kdfparams/dklen"));return ct!==32&&nt("dklen",ct),$(tt,it,at,ct,st)}}return logger$6.throwArgumentError("unsupported key-derivation function","kdf",rt)}function decryptSync(_,o){const $=JSON.parse(_),j=_computeKdfKey($,o,pbkdf2Sync,scrypt.syncScrypt);return _getAccount($,j)}function decrypt(_,o,$){return __awaiter$1(this,void 0,void 0,function*(){const j=JSON.parse(_),et=yield _computeKdfKey(j,o,pbkdf2,scrypt.scrypt,$);return _getAccount(j,et)})}function encrypt(_,o,$,j){try{if(getAddress(_.address)!==computeAddress(_.privateKey))throw new Error("address/privateKey mismatch");if(hasMnemonic$1(_)){const mt=_.mnemonic;if(HDNode.fromMnemonic(mt.phrase,null,mt.locale).derivePath(mt.path||defaultPath).privateKey!=_.privateKey)throw new Error("mnemonic mismatch")}}catch(mt){return Promise.reject(mt)}typeof $=="function"&&!j&&(j=$,$={}),$||($={});const et=arrayify(_.privateKey),tt=getPassword(o);let rt=null,nt=null,it=null;if(hasMnemonic$1(_)){const mt=_.mnemonic;rt=arrayify(mnemonicToEntropy(mt.phrase,mt.locale||"en")),nt=mt.path||defaultPath,it=mt.locale||"en"}let st=$.client;st||(st="ethers.js");let ot=null;$.salt?ot=arrayify($.salt):ot=randomBytes$2(32);let at=null;if($.iv){if(at=arrayify($.iv),at.length!==16)throw new Error("invalid iv")}else at=randomBytes$2(16);let ct=null;if($.uuid){if(ct=arrayify($.uuid),ct.length!==16)throw new Error("invalid uuid")}else ct=randomBytes$2(16);let ut=1<<17,ft=8,ht=1;return $.scrypt&&($.scrypt.N&&(ut=$.scrypt.N),$.scrypt.r&&(ft=$.scrypt.r),$.scrypt.p&&(ht=$.scrypt.p)),scrypt.scrypt(tt,ot,ut,ft,ht,64,j).then(mt=>{mt=arrayify(mt);const gt=mt.slice(0,16),Et=mt.slice(16,32),St=mt.slice(32,64),At=new aes.Counter(at),kt=new aes.ModeOfOperation.ctr(gt,At),Rt=arrayify(kt.encrypt(et)),Tt=keccak256(concat([Et,Rt])),Dt={address:_.address.substring(2).toLowerCase(),id:uuidV4(ct),version:3,crypto:{cipher:"aes-128-ctr",cipherparams:{iv:hexlify(at).substring(2)},ciphertext:hexlify(Rt).substring(2),kdf:"scrypt",kdfparams:{salt:hexlify(ot).substring(2),n:ut,dklen:32,p:ht,r:ft},mac:Tt.substring(2)}};if(rt){const Ot=randomBytes$2(16),jt=new aes.Counter(Ot),Nt=new aes.ModeOfOperation.ctr(St,jt),It=arrayify(Nt.encrypt(rt)),yt=new Date,lt=yt.getUTCFullYear()+"-"+zpad(yt.getUTCMonth()+1,2)+"-"+zpad(yt.getUTCDate(),2)+"T"+zpad(yt.getUTCHours(),2)+"-"+zpad(yt.getUTCMinutes(),2)+"-"+zpad(yt.getUTCSeconds(),2)+".0Z";Dt["x-ethers"]={client:st,gethFilename:"UTC--"+lt+"--"+Dt.address,mnemonicCounter:hexlify(Ot).substring(2),mnemonicCiphertext:hexlify(It).substring(2),path:nt,locale:it,version:"0.1"}}return JSON.stringify(Dt)})}function decryptJsonWallet(_,o,$){if(isCrowdsaleWallet(_)){$&&$(0);const j=decrypt$1(_,o);return $&&$(1),Promise.resolve(j)}return isKeystoreWallet(_)?decrypt(_,o,$):Promise.reject(new Error("invalid JSON wallet"))}function decryptJsonWalletSync(_,o){if(isCrowdsaleWallet(_))return decrypt$1(_,o);if(isKeystoreWallet(_))return decryptSync(_,o);throw new Error("invalid JSON wallet")}const version$2="wallet/5.7.0";var __awaiter=globalThis&&globalThis.__awaiter||function(_,o,$,j){function et(tt){return tt instanceof $?tt:new $(function(rt){rt(tt)})}return new($||($=Promise))(function(tt,rt){function nt(ot){try{st(j.next(ot))}catch(at){rt(at)}}function it(ot){try{st(j.throw(ot))}catch(at){rt(at)}}function st(ot){ot.done?tt(ot.value):et(ot.value).then(nt,it)}st((j=j.apply(_,o||[])).next())})};const logger$5=new Logger(version$2);function isAccount(_){return _!=null&&isHexString(_.privateKey,32)&&_.address!=null}function hasMnemonic(_){const o=_.mnemonic;return o&&o.phrase}class Wallet extends Signer{constructor(o,$){if(super(),isAccount(o)){const j=new SigningKey(o.privateKey);if(defineReadOnly(this,"_signingKey",()=>j),defineReadOnly(this,"address",computeAddress(this.publicKey)),this.address!==getAddress(o.address)&&logger$5.throwArgumentError("privateKey/address mismatch","privateKey","[REDACTED]"),hasMnemonic(o)){const et=o.mnemonic;defineReadOnly(this,"_mnemonic",()=>({phrase:et.phrase,path:et.path||defaultPath,locale:et.locale||"en"}));const tt=this.mnemonic,rt=HDNode.fromMnemonic(tt.phrase,null,tt.locale).derivePath(tt.path);computeAddress(rt.privateKey)!==this.address&&logger$5.throwArgumentError("mnemonic/address mismatch","privateKey","[REDACTED]")}else defineReadOnly(this,"_mnemonic",()=>null)}else{if(SigningKey.isSigningKey(o))o.curve!=="secp256k1"&&logger$5.throwArgumentError("unsupported curve; must be secp256k1","privateKey","[REDACTED]"),defineReadOnly(this,"_signingKey",()=>o);else{typeof o=="string"&&o.match(/^[0-9a-f]*$/i)&&o.length===64&&(o="0x"+o);const j=new SigningKey(o);defineReadOnly(this,"_signingKey",()=>j)}defineReadOnly(this,"_mnemonic",()=>null),defineReadOnly(this,"address",computeAddress(this.publicKey))}$&&!Provider$1.isProvider($)&&logger$5.throwArgumentError("invalid provider","provider",$),defineReadOnly(this,"provider",$||null)}get mnemonic(){return this._mnemonic()}get privateKey(){return this._signingKey().privateKey}get publicKey(){return this._signingKey().publicKey}getAddress(){return Promise.resolve(this.address)}connect(o){return new Wallet(this,o)}signTransaction(o){return resolveProperties(o).then($=>{$.from!=null&&(getAddress($.from)!==this.address&&logger$5.throwArgumentError("transaction from address mismatch","transaction.from",o.from),delete $.from);const j=this._signingKey().signDigest(keccak256(serialize($)));return serialize($,j)})}signMessage(o){return __awaiter(this,void 0,void 0,function*(){return joinSignature(this._signingKey().signDigest(hashMessage(o)))})}_signTypedData(o,$,j){return __awaiter(this,void 0,void 0,function*(){const et=yield TypedDataEncoder.resolveNames(o,$,j,tt=>(this.provider==null&&logger$5.throwError("cannot resolve ENS names without a provider",Logger.errors.UNSUPPORTED_OPERATION,{operation:"resolveName",value:tt}),this.provider.resolveName(tt)));return joinSignature(this._signingKey().signDigest(TypedDataEncoder.hash(et.domain,$,et.value)))})}encrypt(o,$,j){if(typeof $=="function"&&!j&&(j=$,$={}),j&&typeof j!="function")throw new Error("invalid callback");return $||($={}),encrypt(this,o,$,j)}static createRandom(o){let $=randomBytes$2(16);o||(o={}),o.extraEntropy&&($=arrayify(hexDataSlice(keccak256(concat([$,o.extraEntropy])),0,16)));const j=entropyToMnemonic($,o.locale);return Wallet.fromMnemonic(j,o.path,o.locale)}static fromEncryptedJson(o,$,j){return decryptJsonWallet(o,$,j).then(et=>new Wallet(et))}static fromEncryptedJsonSync(o,$){return new Wallet(decryptJsonWalletSync(o,$))}static fromMnemonic(o,$,j){return $||($=defaultPath),new Wallet(HDNode.fromMnemonic(o,null,j).derivePath($))}}function verifyMessage(_,o){return recoverAddress(hashMessage(_),o)}function getEIP191Verifier(){return{eip191:async(_,o)=>{verifyEIP191Signature(_,o)}}}const LEGACY_CHAIN_ID_REORG_DATE=new Date("2022-09-20").valueOf();function verifyEIP191Signature(_,o){assertSigned(_),verifyTimeChecks(_,o);const j=[verifyMessage(SiweMessage.fromCacao(_).toMessage(),_.s.s).toLowerCase()];if(Date.parse(_.p.iat)<=LEGACY_CHAIN_ID_REORG_DATE){const tt=verifyMessage(asLegacyChainIdString(SiweMessage.fromCacao(_),"Ethereum"),_.s.s).toLowerCase();j.push(tt)}const et=AccountId.parse(_.p.iss.replace("did:pkh:","")).address.toLowerCase();if(!j.includes(et))throw new Error("Signature does not belong to issuer")}const identity=from$2({prefix:"\0",name:"identity",encode:_=>toString$7(_),decode:_=>fromString$5(_)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity},Symbol.toStringTag,{value:"Module"})),base2=rfc4648$1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),base8=rfc4648$1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),base10=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648$1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648$1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base36=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base64=rfc4648$1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648$1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648$1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648$1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$1=Object.freeze(Object.defineProperty({__proto__:null,base64,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),alphabet$1=Array.from(""),alphabetBytesToChars=alphabet$1.reduce((_,o,$)=>(_[$]=o,_),[]),alphabetCharsToBytes=alphabet$1.reduce((_,o,$)=>(_[o.codePointAt(0)]=$,_),[]);function encode$f(_){return _.reduce((o,$)=>(o+=alphabetBytesToChars[$],o),"")}function decode$a(_){const o=[];for(const $ of _){const j=alphabetCharsToBytes[$.codePointAt(0)];if(j===void 0)throw new Error(`Non-base256emoji character: ${$}`);o.push(j)}return new Uint8Array(o)}const base256emoji=from$2({prefix:"",name:"base256emoji",encode:encode$f,decode:decode$a}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$2,...base36$1,...base58,...base64$1,...base256emoji$1};function asUint8Array(_){return globalThis.Buffer!=null?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_}function allocUnsafe$3(_=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array(globalThis.Buffer.allocUnsafe(_)):new Uint8Array(_)}function createCodec$3(_,o,$,j){return{name:_,prefix:o,encoder:{name:_,prefix:o,encode:$},decoder:{decode:j}}}const string=createCodec$3("utf8","u",_=>"u"+new TextDecoder("utf8").decode(_),_=>new TextEncoder().encode(_.substring(1))),ascii=createCodec$3("ascii","a",_=>{let o="a";for(let $=0;$<_.length;$++)o+=String.fromCharCode(_[$]);return o},_=>{_=_.substring(1);const o=allocUnsafe$3(_.length);for(let $=0;$<_.length;$++)o[$]=_.charCodeAt($);return o}),BASES={utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii,binary:ascii,...bases};function toString$6(_,o="utf8"){const $=BASES[o];if(!$)throw new Error(`Unsupported encoding "${o}"`);return(o==="utf8"||o==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(_.buffer,_.byteOffset,_.byteLength).toString("utf8"):$.encoder.encode(_).substring(1)}function fromString$4(_,o="utf8"){const $=BASES[o];if(!$)throw new Error(`Unsupported encoding "${o}"`);return(o==="utf8"||o==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array(globalThis.Buffer.from(_,"utf-8")):$.decoder.decode(`${$.prefix}${_}`)}function randomString(){return toString$6(random.randomBytes(16),"base64")}const B64="base64pad",B64_URL="base64url";function encodeBase64(_){return toString$6(_,B64)}function encodeBase64Url(_){return toString$6(_,B64_URL)}function decodeBase64(_){return fromString$4(_,B64)}function base64urlToJSON(_){return JSON.parse(toString$6(fromString$4(_,B64_URL)))}function fromDagJWS(_){if(_.signatures.length>1)throw new Error("Cant convert to compact jws");return`${_.signatures[0].protected}.${_.payload}.${_.signatures[0].signature}`}function didWithTime(_,o){if(o){const $=o.toISOString().split(".")[0]+"Z";return`${_}?versionTime=${$}`}else return _}function extractControllers(_){return _?Array.isArray(_)?_:[_]:[]}const verifiers={...getEIP191Verifier()};function isResolver(_){return"registry"in _&&"cache"in _}class DID{get capability(){if(!this._capability)throw new Error("DID has no capability attached");return this._capability}get hasCapability(){return this._capability!=null}get parent(){if(!this._parentId)throw new Error("DID has no parent DID");return this._parentId}get hasParent(){return this._parentId!=null}get id(){if(this._id==null)throw new Error("DID is not authenticated");return this._id}get authenticated(){return this._id!=null}withCapability(o){var $;return new DID({provider:($=this._client)==null?void 0:$.connection,resolver:this._resolver,capability:o,parent:this._parentId})}setProvider(o){if(this._client==null)this._client=new RPCClient(o);else if(this._client.connection!==o)throw new Error("A different provider is already set, create a new DID instance to use another provider")}setResolver(o,$){this._resolver=isResolver(o)?o:new Resolver$1(o,$)}async authenticate({provider:o,paths:$=[],aud:j}={}){if(o!=null&&this.setProvider(o),this._client==null)throw new Error("No provider available");const et=randomString(),tt=await this._client.request("did_authenticate",{nonce:et,aud:j,paths:$}),{kid:rt}=await this.verifyJWS(tt),nt=base64urlToJSON(tt.payload);if(!rt.includes(nt.did))throw new Error("Invalid authencation response, kid mismatch");if(nt.nonce!==et)throw new Error("Invalid authencation response, wrong nonce");if(nt.aud!==j)throw new Error("Invalid authencation response, wrong aud");if(nt.exp<Date.now()/1e3)throw new Error("Invalid authencation response, expired");return this._id=nt.did,this._id}async createJWS(o,$={}){if(this._client==null)throw new Error("No provider available");if(this._id==null)throw new Error("DID is not authenticated");if(this._capability){const et=this._capability.p.exp;if(et&&Date.parse(et)<Date.now())throw new Error("Capability is expired, cannot create a valid signature");const tt=await CacaoBlock.fromCacao(this._capability),rt=CID$1.asCID(tt.cid);if(!rt)throw new Error("Capability CID of the JWS cannot be set to the capability payload cid as they are incompatible");$.protected=$.protected||{},$.protected.cap=`ipfs://${rt==null?void 0:rt.toString()}`}const{jws:j}=await this._client.request("did_createJWS",{did:this._id,...$,payload:o});return j}async createDagJWS(o,$={}){const{cid:j,linkedBlock:et}=await encodePayload$1(o),tt=encodeBase64Url(j.bytes);Object.assign($,{linkedBlock:encodeBase64(et)});const rt=await this.createJWS(tt,$),nt=CID$1.asCID(j);if(!nt)throw new Error("CID of the JWS cannot be set to the encoded payload cid as they are incompatible");if(rt.link=nt,this._capability){const it=await CacaoBlock.fromCacao(this._capability);return{jws:rt,linkedBlock:et,cacaoBlock:it.bytes}}return{jws:rt,linkedBlock:et}}async verifyJWS(o,$={}){var st,ot,at,ct,ut,ft,ht;$=Object.assign({verifiers},$),typeof o!="string"&&(o=fromDagJWS(o));const j=base64urlToJSON(o.split(".")[0]).kid;if(!j)throw new Error('No "kid" found in jws');const et=await this.resolve(j);if(!$.disableTimecheck){const mt=(st=et.didDocumentMetadata)==null?void 0:st.nextUpdate;if(mt){const Et=$.revocationPhaseOutSecs?$.revocationPhaseOutSecs*1e3:0,St=new Date(mt).valueOf()+Et;if(!($.atTime&&$.atTime.getTime()<St))throw new Error(`invalid_jws: signature authored with a revoked DID version: ${j}`)}const gt=(ot=et.didDocumentMetadata)==null?void 0:ot.updated;if(gt&&$.atTime&&$.atTime.getTime()<new Date(gt).valueOf())throw new Error(`invalid_jws: signature authored before creation of DID version: ${j}`)}const rt=(at=et.didDocument)==null?void 0:at.id;if($.issuer&&$.issuer===((ct=$.capability)==null?void 0:ct.p.iss)&&rt===$.capability.p.aud){if(!$.verifiers)throw new Error("Registered verifiers needed for CACAO");await Cacao.verify($.capability,{disableExpirationCheck:$.disableTimecheck,atTime:$.atTime?$.atTime:void 0,revocationPhaseOutSecs:$.revocationPhaseOutSecs,verifiers:$.verifiers??{}})}else if($.issuer&&$.issuer!==rt){const mt=didWithTime($.issuer,$.atTime),Et=(ut=(await this.resolve(mt)).didDocument)==null?void 0:ut.controller,St=extractControllers(Et);if((ft=$.capability)!=null&&ft.s&&$.capability.p.aud===rt&&St.includes($.capability.p.iss))await Cacao.verify($.capability,{atTime:$.atTime?$.atTime:void 0,revocationPhaseOutSecs:$.revocationPhaseOutSecs,verifiers:$.verifiers??{}});else if(!(rt?St.includes(rt):!1))throw new Error(`invalid_jws: not a valid verificationMethod for issuer: ${j}`)}const nt=((ht=et.didDocument)==null?void 0:ht.verificationMethod)||[];verifyJWS(o,nt);let it;try{it=base64urlToJSON(o.split(".")[1])}catch{}return{kid:j,payload:it,didResolutionResult:et}}async createJWE(o,$,j={}){const et=await resolveX25519Encrypters($,this._resolver);return createJWE(o,et,j.protectedHeader,j.aad)}async createDagJWE(o,$,j={}){const et=await prepareCleartext(o);return this.createJWE(et,$,j)}async decryptJWE(o,$={}){if(this._client==null)throw new Error("No provider available");if(this._id==null)throw new Error("DID is not authenticated");const{cleartext:j}=await this._client.request("did_decryptJWE",{did:this._id,...$,jwe:o});return decodeBase64(j)}async decryptDagJWE(o){const $=await this.decryptJWE(o);return decodeCleartext($)}async resolve(o){const $=await this._resolver.resolve(o);if($.didResolutionMetadata.error){const{error:j,message:et}=$.didResolutionMetadata,tt=et?`, ${et}`:"";throw new Error(`Failed to resolve ${o}: ${j}${tt}`)}return $}constructor({provider:o,resolver:$={},resolverOptions:j,capability:et,parent:tt}={}){if(o!=null&&(this._client=new RPCClient(o)),et){if(this._capability=et,this._parentId=this._capability.p.iss,tt&&this._parentId!==tt)throw new Error("Capability issuer and parent not equal")}else tt&&(this._parentId=tt);this.setResolver($,j)}}const TYPE$2="DID";class DIDIdentityProvider extends IdentityProvider{constructor({didProvider:o}){super(),this.did=new DID({resolver:DIDIdentityProvider.did._resolver,provider:o})}static get type(){return TYPE$2}async getId({space:o}){return this.did.authenticated||await this.did.authenticate(),this.did.id}async signIdentity(o,{space:$}){this.did.authenticated||await this.did.authenticate();const j=toString$a(fromString$8(o,"base16"),"base64url"),et=await this.did.createJWS(j);return`${et.signatures[0].protected}..${et.signatures[0].signature}`}static setDIDResolver(o){this.did?this.did.setResolver(o):this.did=new DID({resolver:o})}static async verifyIdentity(o){if(!this.did)throw new Error("The DID resolver must first be set with setDIDResolver()");const $=o.publicKey+o.signatures.id;try{const j=toString$a(fromString$8($,"base16"),"base64url"),[et,tt]=o.signatures.publicKey.split(".."),rt=[et,j,tt].join(".");await this.did.verifyJWS(rt)}catch{return!1}return!0}}const type$3="ethereum";class EthIdentityProvider extends IdentityProvider{constructor(o={}){super(),this.wallet=o.wallet}static get type(){return type$3}async getId(o={}){return this.wallet||(this.wallet=await this._createWallet(o)),this.wallet.getAddress()}async signIdentity(o,$={}){const j=this.wallet;if(!j)throw new Error("wallet is required");return j.signMessage(o)}static async verifyIdentity(o){return verifyMessage(o.publicKey+o.signatures.id,o.signatures.publicKey)===o.id}async _createWallet(o={}){if(o.mnemonicOpts){if(!o.mnemonicOpts.mnemonic)throw new Error("mnemonic is required");return Wallet.fromMnemonic(o.mnemonicOpts.mnemonic,o.mnemonicOpts.path,o.mnemonicOpts.wordlist)}if(o.encryptedJsonOpts){if(!o.encryptedJsonOpts.json)throw new Error("encrypted json is required");if(!o.encryptedJsonOpts.password)throw new Error("password for encrypted json is required");return Wallet.fromEncryptedJson(o.encryptedJsonOpts.json,o.encryptedJsonOpts.password,o.encryptedJsonOpts.progressCallback)}return Wallet.createRandom()}}const defaultType="orbitdb",identityKeysPath=pathBrowserify.join("./orbitdb","identity","identitykeys"),supportedTypes$1={orbitdb:OrbitDBIdentityProvider,[DIDIdentityProvider.type]:DIDIdentityProvider,[EthIdentityProvider.type]:EthIdentityProvider},getHandlerFor$1=_=>{if(!Identities.isSupported(_))throw new Error(`IdentityProvider type '${_}' is not supported`);return supportedTypes$1[_]};class Identities{constructor(o){this._keystore=o.keystore,this._signingKeystore=o.signingKeystore||this._keystore,this._knownIdentities=o.cache||new lru(o.cacheSize||100)}static get IdentityProvider(){return IdentityProvider}get keystore(){return this._keystore}get signingKeystore(){return this._signingKeystore}async sign(o,$){const j=await this.keystore.getKey(o.id);if(!j)throw new Error("Private signing key not found from Keystore");return await this.keystore.sign(j,$)}async verify(o,$,j,et="v1"){return this.keystore.verify(o,$,j,et)}async createIdentity(o={}){const $=o.keystore||this.keystore,j=o.type||defaultType,et=j===defaultType?new OrbitDBIdentityProvider(o.signingKeystore||$):new(getHandlerFor$1(j))(o),tt=await et.getId(o);o.migrate&&await o.migrate({targetStore:$._store,targetId:tt});const{publicKey:rt,idSignature:nt}=await this.signId(tt),it=await et.signIdentity(rt+nt,o);return new Identity(tt,rt,nt,it,j,this)}async signId(o){const $=this.keystore,j=await $.getKey(o)||await $.createKey(o),et=$.getPublic(j),tt=await $.sign(j,o);return{publicKey:et,idSignature:tt}}async verifyIdentity(o){if(!Identity.isIdentity(o))return!1;const $=this._knownIdentities.get(o.signatures.id);if($)return o.id===$.id&&o.publicKey===$.publicKey&&o.signatures.id===$.signatures.id&&o.signatures.publicKey===$.signatures.publicKey;if(!await this.keystore.verify(o.signatures.id,o.publicKey,o.id))return!1;const tt=await getHandlerFor$1(o.type).verifyIdentity(o);return tt&&this._knownIdentities.set(o.signatures.id,Identity.toJSON(o)),tt}static async verifyIdentity(o){return!Identity.isIdentity(o)||!await Keystore.verify(o.signatures.id,o.publicKey,o.id)?!1:getHandlerFor$1(o.type).verifyIdentity(o)}static async createIdentity(o={}){return o.keystore||(o.keystore=new Keystore(o.identityKeysPath||identityKeysPath)),o.signingKeystore||(o.signingKeysPath?o.signingKeystore=new Keystore(o.signingKeysPath):o.signingKeystore=o.keystore),await o.keystore.open(),await o.signingKeystore.open(),o=Object.assign({},{type:defaultType},o),new Identities(o).createIdentity(o)}static isSupported(o){return Object.keys(supportedTypes$1).includes(o)}static addIdentityProvider(o){if(!o)throw new Error("IdentityProvider class needs to be given as an option");if(!o.type||typeof o.type!="string")throw new Error("Given IdentityProvider class needs to implement: static get type() { /* return a string */ }.");supportedTypes$1[o.type]=o}static removeIdentityProvider(o){delete supportedTypes$1[o]}}class AccessController extends eventsExports.EventEmitter{static async create(o,$){}static get type(){throw new Error("'static get type ()' needs to be defined in the inheriting class")}get type(){return this.constructor.type}get address(){}async canAppend(o,$){}async grant(o,$){return!1}async revoke(o,$){return!1}async load(o){}async save(){}async close(){}}class AccessControllerManifest{constructor(o,$={}){this.type=o,this.params=$}static async resolve(o,$,j={}){if(j.skipManifest){if(!j.type)throw new Error("No manifest, access-controller type required");return new AccessControllerManifest(j.type,{address:$})}else{$.indexOf("/ipfs")===0&&($=$.split("/")[2]);const{type:et,params:tt}=await read$7(o,$);return new AccessControllerManifest(et,tt)}}static async create(o,$,j){return j.skipManifest?j.address:write$3(o,"dag-cbor",{type:$,params:j})}}const type$2="legacy-ipfs";class LegacyIPFSAccessController extends AccessController{constructor(o,$){super(),this._ipfs=o,this._write=Array.from($.write||[])}static get type(){return type$2}get write(){return this._write}async canAppend(o,$){const j=o.key;return!!(this.write.includes(j)||this.write.includes("*"))}async load(o){o.indexOf("/ipfs")===0&&(o=o.split("/")[2]);try{const $=await read$7(this._ipfs,o);this._write=$.write}catch($){console.log("LegacyIPFSAccessController.load ERROR:",$)}}async save(o){let $;const j={admin:[],write:this.write,read:[]};try{$=await write$3(this._ipfs,"raw",safeBufferExports.Buffer.from(JSON.stringify(j,null,2)),{format:"dag-pb"})}catch(et){console.log("LegacyIPFSAccessController.save ERROR:",et)}return{address:$,skipManifest:!0}}static async create(o,$={}){return $={...$,write:$.write||[o.identity.publicKey]},new LegacyIPFSAccessController(o._ipfs,$)}}const read$3=async(_,o,$={})=>{const j=await read$7(_,o,$);return typeof j.write=="string"?JSON.parse(j.write):j.write},write$2=write$3,type$1="ipfs";class IPFSAccessController extends AccessController{constructor(o,$){super(),this._ipfs=o,this._write=Array.from($.write||[])}static get type(){return type$1}get write(){return this._write}async canAppend(o,$){const j=o.identity.id;return this.write.includes(j)||this.write.includes("*")?$.verifyIdentity(o.identity):!1}async load(o){o.indexOf("/ipfs")===0&&(o=o.split("/")[2]);try{this._write=await read$3(this._ipfs,o)}catch($){console.log("IPFSAccessController.load ERROR:",$)}}async save(){let o;try{o=await write$2(this._ipfs,"dag-cbor",{write:JSON.stringify(this.write,null,2)})}catch($){console.log("IPFSAccessController.save ERROR:",$)}return{address:o}}static async create(o,$={}){return $={...$,write:$.write||[o.identity.id]},new IPFSAccessController(o._ipfs,$)}}async function pMapSeries(_,o){const $=[];let j=0;for(const et of _)$.push(await o(await et,j++));return $}const ensureAddress=_=>_.toString().split("/").pop()==="_access"?_:pathBrowserify.join(_,"/_access"),type="orbitdb";class OrbitDBAccessController extends AccessController{constructor(o,$){super(),this._orbitdb=o,this._db=null,this._options=$||{}}static get type(){return type}get address(){return this._db.address}async canAppend(o,$){const j=new Set([...this.get("write"),...this.get("admin")]);return j.has(o.identity.id)||j.has("*")?await $.verifyIdentity(o.identity):!1}get capabilities(){if(this._db){const o=this._db.index,$=j=>{const et=j[0];o[et]=new Set([...o[et]||[],...j[1]])};return Object.entries({...o,admin:new Set([...o.admin||[],...this._db.access.write])}).forEach($),o}return{}}get(o){return this.capabilities[o]||new Set([])}async close(){await this._db.close()}async load(o){this._db&&await this._db.close(),this._db=await this._orbitdb.keyvalue(ensureAddress(o),{accessController:{type:"ipfs",write:this._options.admin||[this._orbitdb.identity.id]},sync:!0}),this._db.events.on("ready",this._onUpdate.bind(this)),this._db.events.on("write",this._onUpdate.bind(this)),this._db.events.on("replicated",this._onUpdate.bind(this)),await this._db.load()}async save(){return{address:this._db.address.toString()}}async hasCapability(o,$){const j=new Set(this.get(o));return j.has($.id)||j.has("*")}async grant(o,$){const j=new Set([...this._db.get(o)||[],$]);await this._db.put(o,Array.from(j.values()))}async revoke(o,$){const j=new Set(this._db.get(o)||[]);j.delete($),j.size>0?await this._db.put(o,Array.from(j.values())):await this._db.del(o)}_onUpdate(){this.emit("updated")}static async create(o,$={}){const j=new OrbitDBAccessController(o,$);return await j.load($.address||$.name||"default-access-controller"),$.write&&!$.address&&await pMapSeries($.write,async et=>j.grant("write",et)),j}}const supportedTypes={"legacy-ipfs":LegacyIPFSAccessController,ipfs:IPFSAccessController,orbitdb:OrbitDBAccessController},getHandlerFor=_=>{if(!AccessControllers$1.isSupported(_))throw new Error(`AccessController type '${_}' is not supported`);return supportedTypes[_]};let AccessControllers$1=class Do{static get AccessController(){return AccessController}static isSupported(o){return Object.keys(supportedTypes).includes(o)}static addAccessController(o){if(!o.AccessController)throw new Error("AccessController class needs to be given as an option");if(!o.AccessController.type||typeof o.AccessController.type!="string")throw new Error("Given AccessController class needs to implement: static get type() { /* return a string */}.");supportedTypes[o.AccessController.type]=o.AccessController}static addAccessControllers(o){const $=o.AccessControllers;if(!$)throw new Error("AccessController classes need to be given as an option");$.forEach(j=>{Do.addAccessController({AccessController:j})})}static removeAccessController(o){delete supportedTypes[o]}static async resolve(o,$,j={}){const{type:et,params:tt}=await AccessControllerManifest.resolve(o._ipfs,$,j),nt=await getHandlerFor(et).create(o,Object.assign({},j,tt));return await nt.load(tt.address),nt}static async create(o,$,j={}){const rt=await(await getHandlerFor($).create(o,j)).save();return await AccessControllerManifest.create(o._ipfs,$,rt)}};const notEmpty=_=>_!==""&&_!==" ";class OrbitDBAddress{constructor(o,$){this.root=o,this.path=$}toString(){return OrbitDBAddress.join(this.root,this.path)}static isValid(o){o=o.toString().replace(/\\/g,"/");const $=(rt,nt)=>!((nt===0||nt===1)&&o.toString().indexOf("/orbit")===0&&rt==="orbitdb"),j=o.toString().split("/").filter($).filter(notEmpty);let et;const tt=rt=>{const nt=["zd","Qm","ba","k5"];for(const it of nt)if(rt.indexOf(it)>-1)return!0;return!1};try{et=tt(j[0])?CID$3.parse(j[0]).toString():null}catch{return!1}return et!==null}static parse(o){if(!o)throw new Error(`Not a valid OrbitDB address: ${o}`);if(!OrbitDBAddress.isValid(o))throw new Error(`Not a valid OrbitDB address: ${o}`);o=o.toString().replace(/\\/g,"/");const $=o.toString().split("/").filter((j,et)=>!((et===0||et===1)&&o.toString().indexOf("/orbit")===0&&j==="orbitdb")).filter(j=>j!==""&&j!==" ");return new OrbitDBAddress($[0],$.slice(1,$.length).join("/"))}static join(...o){return(pathBrowserify.posix||pathBrowserify).join("/orbitdb",...o)}}const createDBManifest=async(_,o,$,j,et)=>{const tt=Object.assign({name:o,type:$,accessController:(pathBrowserify.posix||pathBrowserify).join("/ipfs",j)},et.meta!==void 0?{meta:et.meta}:{});return write$3(_,et.format||"dag-cbor",tt,et)},PROTOCOL="ipfs-pubsub-direct-channel/v1",encode$e=_=>{let o=_;return safeBufferExports.Buffer.isBuffer(o)||(o=safeBufferExports.Buffer.from(o)),o},waitForPeers=async(_,o,$,j)=>{const et=async()=>{const tt=await _.pubsub.peers($),rt=o.map(st=>String(st)),nt=tt.map(st=>String(st));return rt.map(st=>nt.includes(st)).filter(st=>st===!1).length===0};return await et()?Promise.resolve():new Promise((tt,rt)=>{const nt=setInterval(async()=>{try{j()?clearInterval(nt):await et()&&(clearInterval(nt),tt())}catch(it){rt(it)}},100)})},getPeerID=async _=>(await _.id()).id;class DirectChannel extends eventsExports{constructor(o,$){if(super(),this._ipfs=o,!o.pubsub)throw new Error("This IPFS node does not support pubsub.");if(this._closed=!1,this._isClosed=()=>this._closed,this._receiverID=$,!this._receiverID)throw new Error("Receiver ID was undefined")}get id(){return this._id}get peers(){return this._peers}async connect(){await waitForPeers(this._ipfs,[this._receiverID],this._id,this._isClosed)}async send(o){if(this._closed)return;const $=encode$e(o);await this._ipfs.pubsub.publish(this._id,$)}close(){this._closed=!0,this.removeAllListeners("message"),this._ipfs.pubsub.unsubscribe(this._id,this._messageHandler)}async _setup(){this._senderID=await getPeerID(this._ipfs),this._peers=Array.from([this._senderID,this._receiverID]).sort(),this._id="/"+PROTOCOL+"/"+this._peers.join("/"),this._messageHandler=o=>{o&&String(o.from)===String(this._receiverID)&&this.emit("message",o)}}async _openChannel(){this._closed=!1,await this._setup(),await this._ipfs.pubsub.subscribe(this._id,this._messageHandler)}static async open(o,$){const j=new DirectChannel(o,$);return await j._openChannel(),j}}const logger$4=src$8.create("exchange-heads",{color:src$8.Colors.Yellow});src$8.setLogLevel("ERROR");const getHeadsForDatabase=async _=>{if(!(_&&_._cache))return[];const o=await _._cache.get(_.localHeadsPath)||[],$=await _._cache.get(_.remoteHeadsPath)||[];return[...o,...$]},exchangeHeads=async(_,o,$,j,et,tt,rt)=>{const nt=ot=>{const at=JSON.parse(buffer$2.Buffer.from(ot.data).toString()),{address:ct,heads:ut}=at;tt(ct,ut)};let it=et($);if(!it)try{logger$4.debug(`Create a channel to ${$}`),it=await DirectChannel.open(_,$),it.on("message",nt),logger$4.debug(`Channel created to ${$}`),rt(it)}catch(ot){logger$4.error(ot)}await it.connect(),logger$4.debug(`Connected to ${$}`);const st=await getHeadsForDatabase(j(o));return logger$4.debug(`Send latest heads of '${o}':
`,JSON.stringify(st.map(ot=>ot.hash),null,2)),st&&await it.send(JSON.stringify({address:o,heads:st})),it},isDefined=_=>_!=null;let Storage$1=class{constructor(o,$={}){const j={createIfMissing:!0,errorIfExists:!1,compression:!0,cacheSize:8388608};this.storage=o,this.preCreate=$.preCreate?$.preCreate:()=>{};const et=Object.assign({},$,j);delete et.preCreate,this.options={down:et}}async createStore(o="./orbitdb",$={}){this.options.up=$,await this.preCreate(o,this.options),this.storage;const j=new Level(o,$);return await j.open(),j}async destroy(o){!this.storage||!this.storage.destroy||await this.storage.destory(o._db.location)}async preCreate(o,$){}};const Storage$2=(_,o)=>new Storage$1(_,o);function isElectron$2(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof browserExports$3<"u"&&typeof browserExports$3.versions=="object"&&browserExports$3.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var isElectron_1=isElectron$2;const isEnvWithDom=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,isElectron$1=isElectron_1(),isBrowser$2=isEnvWithDom&&!isElectron$1,isElectronMain=isElectron$1&&!isEnvWithDom,isElectronRenderer=isElectron$1&&isEnvWithDom,isNode=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!isElectron$1,isWebWorker$1=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"];const isReactNative$2=typeof navigator<"u"&&navigator.product==="ReactNative",fs=!isElectronMain&&(typeof window=="object"||typeof self=="object")?null:fs_,logger$3=src$8.create("orbit-db");src$8.setLogLevel("ERROR");async function migrate$1(_,o,$){let j=o.cache||(_.caches[o.directory]?_.caches[o.directory].cache:null),et;if(!j){const it=(pathBrowserify.posix||pathBrowserify).join(_.directory,$.root,$.path);if(fs&&fs.existsSync&&!fs.existsSync(it))return;et=await _.storage.createStore(it),j=new Cache(et)}if(!await j.get("_localHeads"))return;const rt=$.toString();logger$3.debug("Attempting to migrate from old cache location");const nt=["_remoteHeads","_localHeads","snapshot","queue"];for(const it in nt)try{const st=pathBrowserify.join(rt,nt[it]),ot=await j.get(nt[it]);ot&&await o.cache.set(st,ot)}catch(st){logger$3.debug(st.message)}await o.cache.set(pathBrowserify.join(rt,"_manifest"),$.root),et&&await et.close()}const migrations=[migrate$1],run=async(_,o,$)=>{for(let j=0;j<migrations.length;j++)await migrations[j](_,o,$)},logger$2=src$8.create("orbit-db");src$8.setLogLevel("ERROR");const databaseTypes={counter:CounterStore,eventlog:EventStore,feed:FeedStore,docstore:DocumentStore,keyvalue:KeyValueStore},defaultTimeout=3e4;let AccessControllers=AccessControllers$1;class OrbitDB{constructor(o,$,j={}){if(!isDefined(o))throw new Error("IPFS is a required argument. See https://github.com/orbitdb/orbit-db/blob/master/API.md#createinstance");if(!isDefined($))throw new Error("identity is a required argument. See https://github.com/orbitdb/orbit-db/blob/master/API.md#createinstance");this._ipfs=o,this.identity=$,this.id=j.peerId,this._pubsub=j.offline?null:new(j.broker?j.broker:IPFSPubsub)(this._ipfs,this.id),this.directory=j.directory||"./orbitdb",this.storage=j.storage,this._directConnections={},this.caches={},this.caches[this.directory]={cache:j.cache,handlers:new Set},this.keystore=j.keystore,this.stores={},AccessControllers=j.AccessControllers||AccessControllers}static get Pubsub(){return IPFSPubsub}static get Cache(){return Cache}static get Keystore(){return Keystore}static get Identities(){return Identities}static get AccessControllers(){return AccessControllers}static get Storage(){return Storage$2}static get OrbitDBAddress(){return OrbitDBAddress}static get Store(){return Store}static get EventStore(){return EventStore}static get FeedStore(){return FeedStore}static get KeyValueStore(){return KeyValueStore}static get CounterStore(){return CounterStore}static get DocumentStore(){return DocumentStore}get cache(){return this.caches[this.directory].cache}static async createInstance(o,$={}){if(!isDefined(o))throw new Error("IPFS is a required argument. See https://github.com/orbitdb/orbit-db/blob/master/API.md#createinstance");if($.offline===void 0&&($.offline=!1),$.offline&&!$.id)throw new Error("Offline mode requires passing an `id` in the options");const{id:j}=$.id||$.offline?{id:$.id}:await o.id();if($.directory||($.directory="./orbitdb"),!$.storage){const tt={};$.storage=Storage$2(null,tt)}if($.identity&&$.identity.provider.keystore&&($.keystore=$.identity.provider.keystore),!$.keystore){const tt=pathBrowserify.join($.directory,typeof j!="object"?j:j.toString(),"/keystore"),rt=await $.storage.createStore(tt);$.keystore=new Keystore(rt)}if($.identity||($.identity=await Identities.createIdentity({id:j,keystore:$.keystore})),!$.cache){const tt=pathBrowserify.join($.directory,typeof j!="object"?j:j.toString(),"/cache"),rt=await $.storage.createStore(tt);$.cache=new Cache(rt)}const et=Object.assign({},$,{peerId:typeof j!="object"?j:j.toString()});return new OrbitDB(o,$.identity,et)}async feed(o,$={}){return $=Object.assign({create:!0,type:"feed"},$),this.open(o,$)}async log(o,$={}){return $=Object.assign({create:!0,type:"eventlog"},$),this.open(o,$)}async eventlog(o,$={}){return this.log(o,$)}async keyvalue(o,$={}){return $=Object.assign({create:!0,type:"keyvalue"},$),this.open(o,$)}async kvstore(o,$={}){return this.keyvalue(o,$)}async counter(o,$={}){return $=Object.assign({create:!0,type:"counter"},$),this.open(o,$)}async docs(o,$={}){return $=Object.assign({create:!0,type:"docstore"},$),this.open(o,$)}async docstore(o,$={}){return this.docs(o,$)}async disconnect(){for(const j of Object.values(this._directConnections))j.close();this._directConnections={},this._pubsub&&await this._pubsub.disconnect(),await this.keystore.close();const o=Object.values(this.stores);for(const j of o)await j.close();this.stores={};const $=Object.values(this.caches);for(const j of $)await j.cache.close();this.caches={},this.stores={}}async stop(){await this.disconnect()}async _createCache(o){const $=await this.storage.createStore(o);return new Cache($)}async _createStore(o,$,j){const et=databaseTypes[o];if(!et)throw new Error(`Invalid database type '${o}'`);let tt;j.accessControllerAddress&&(tt=await AccessControllers.resolve(this,j.accessControllerAddress,j.accessController));const rt=Object.assign({replicate:!0},j,{accessController:tt,cache:j.cache,onClose:this._onClose.bind(this),onDrop:this._onDrop.bind(this),onLoad:this._onLoad.bind(this)}),nt=j.identity||this.identity,it=new et(this._ipfs,nt,$,rt);it.events.on("write",this._onWrite.bind(this));const st=$.toString();return this.stores[st]=it,rt.replicate&&this._pubsub&&await this._pubsub.subscribe(st,this._onMessage.bind(this),this._onPeerConnected.bind(this)),it}_onWrite(o,$,j){if(!j)throw new Error("'heads' not defined");this._pubsub&&this._pubsub.publish(o,j)}async _onMessage(o,$,j){const et=this.stores[o];try{logger$2.debug(`Received ${$.length} heads for '${o}':
`,JSON.stringify($.map(tt=>tt.hash),null,2)),et&&$&&($.length>0&&await et.sync($),et.events.emit("peer.exchanged",j,o,$))}catch(tt){logger$2.error(tt)}}async _onPeerConnected(o,$){logger$2.debug(`New peer '${$}' connected to '${o}'`);const j=nt=>this.stores[nt],et=nt=>this._directConnections[nt],tt=nt=>{this._directConnections[nt._receiverID]=nt},rt=(nt,it)=>this._onMessage(nt,it,$);await exchangeHeads(this._ipfs,o,$,j,et,rt,tt),j(o)&&j(o).events.emit("peer",$)}async _onClose(o){const $=o.address.toString();logger$2.debug(`Close ${$}`),this._pubsub&&await this._pubsub.unsubscribe($);const j=o&&o.options.directory?o.options.directory:this.directory,et=this.caches[j];et&&et.handlers.has($)&&(et.handlers.delete($),et.handlers.size||await et.cache.close()),delete this.stores[$]}async _onDrop(o){const $=o.address.toString(),j=o&&o.options.directory?o.options.directory:this.directory;await this._requestCache($,j,o._cache)}async _onLoad(o){const $=o.address.toString(),j=o&&o.options.directory?o.options.directory:this.directory;await this._requestCache($,j,o._cache),this.stores[$]=o}async _determineAddress(o,$,j={}){if(!OrbitDB.isValidType($))throw new Error(`Invalid database type '${$}'`);if(OrbitDBAddress.isValid(o))throw new Error("Given database name is an address. Please give only the name of the database!");j.accessController=Object.assign({},{name:o,type:"ipfs"},j.accessController);const et=await AccessControllers.create(this,j.accessController.type,j.accessController||{}),tt=await createDBManifest(this._ipfs,o,$,et,j);return OrbitDBAddress.parse(OrbitDBAddress.join(tt,o))}async create(o,$,j={}){logger$2.debug("create()"),logger$2.debug(`Creating database '${o}' as ${$}`);const et=await this._determineAddress(o,$,j);if(j.cache=await this._requestCache(et.toString(),j.directory),await this._haveLocalData(j.cache,et)&&!j.overwrite)throw new Error(`Database '${et}' already exists!`);return await this._migrate({...j,directory:this.directory},et),await this._addManifestToCache(j.cache,et),logger$2.debug(`Created database '${et}'`),this.open(et,j)}async determineAddress(o,$,j={}){const et=Object.assign({},{onlyHash:!0},j);return this._determineAddress(o,$,et)}async _requestCache(o,$,j){const et=$||this.directory;if(!this.caches[et]){const rt=j||await this._createCache(et);this.caches[et]={cache:rt,handlers:new Set}}this.caches[et].handlers.add(o);const tt=this.caches[et].cache;return tt&&await tt.open(),tt}async open(o,$={}){if(logger$2.debug("open()"),$=Object.assign({localOnly:!1,create:!1},$),logger$2.debug(`Open database '${o}'`),!OrbitDBAddress.isValid(o))if($.create){if($.create&&!$.type)throw new Error(`Database type not provided! Provide a type with 'options.type' (${OrbitDB.databaseTypes.join("|")})`);return logger$2.warn(`Not a valid OrbitDB address '${o}', creating the database`),$.overwrite=$.overwrite?$.overwrite:!0,this.create(o,$.type,$)}else throw new Error("'options.create' set to 'false'. If you want to create a database, set 'options.create' to 'true'.");const j=OrbitDBAddress.parse(o);$.cache=await this._requestCache(j.toString(),$.directory);const et=await this._haveLocalData($.cache,j);if(logger$2.debug((et?"Found":"Didn't find")+` database '${j}'`),$.localOnly&&!et)throw logger$2.warn(`Database '${j}' doesn't exist!`),new Error(`Database '${j}' doesn't exist!`);logger$2.debug(`Loading Manifest for '${j}'`);let tt;try{tt=await read$7(this._ipfs,j.root,{timeout:$.timeout||defaultTimeout}),logger$2.debug(`Manifest for '${j}':
${JSON.stringify(tt,null,2)}`)}catch(rt){throw rt.name==="TimeoutError"&&rt.code==="ERR_TIMEOUT"?(console.error(rt),new Error("ipfs unable to find and fetch manifest for this address.")):rt}if(tt.name!==j.path&&logger$2.warn(`Manifest name '${tt.name}' and path name '${j.path}' do not match`),$.type&&tt.type!==$.type)throw new Error(`Database '${j}' is type '${tt.type}' but was opened as '${$.type}'`);return await this._addManifestToCache($.cache,j),$=Object.assign({},$,{accessControllerAddress:tt.accessController,meta:tt.meta}),this._createStore($.type||tt.type,j,$)}async _addManifestToCache(o,$){await o.set(pathBrowserify.join($.toString(),"_manifest"),$.root),logger$2.debug(`Saved manifest to IPFS as '${$.root}'`)}async _haveLocalData(o,$){if(!o)return!1;const j=$.toString(),et=await o.get(pathBrowserify.join(j,"_manifest"));return et!=null}async _migrate(o,$){await run(this,o,$)}static get databaseTypes(){return Object.keys(databaseTypes)}static isValidType(o){return Object.keys(databaseTypes).includes(o)}static addDatabaseType(o,$){if(databaseTypes[o])throw new Error(`Type already exists: ${o}`);databaseTypes[o]=$}static getDatabaseTypes(){return databaseTypes}static isValidAddress(o){return OrbitDBAddress.isValid(o)}static parseAddress(o){return OrbitDBAddress.parse(o)}}OrbitDB.prototype.AccessControllers=AccessControllers;OrbitDB.prototype.Identities=Identities;OrbitDB.prototype.Keystore=Keystore;var isPlainObj=_=>{if(Object.prototype.toString.call(_)!=="[object Object]")return!1;const o=Object.getPrototypeOf(_);return o===null||o===Object.prototype};const isOptionObject=isPlainObj,{hasOwnProperty}=Object.prototype,{propertyIsEnumerable}=Object,defineProperty=(_,o,$)=>Object.defineProperty(_,o,{value:$,writable:!0,enumerable:!0,configurable:!0}),globalThis$1=commonjsGlobal,defaultMergeOptions={concatArrays:!1,ignoreUndefined:!1},getEnumerableOwnPropertyKeys=_=>{const o=[];for(const $ in _)hasOwnProperty.call(_,$)&&o.push($);if(Object.getOwnPropertySymbols){const $=Object.getOwnPropertySymbols(_);for(const j of $)propertyIsEnumerable.call(_,j)&&o.push(j)}return o};function clone(_){return Array.isArray(_)?cloneArray(_):isOptionObject(_)?cloneOptionObject(_):_}function cloneArray(_){const o=_.slice(0,0);return getEnumerableOwnPropertyKeys(_).forEach($=>{defineProperty(o,$,clone(_[$]))}),o}function cloneOptionObject(_){const o=Object.getPrototypeOf(_)===null?Object.create(null):{};return getEnumerableOwnPropertyKeys(_).forEach($=>{defineProperty(o,$,clone(_[$]))}),o}const mergeKeys=(_,o,$,j)=>($.forEach(et=>{typeof o[et]>"u"&&j.ignoreUndefined||(et in _&&_[et]!==Object.getPrototypeOf(_)?defineProperty(_,et,merge$3(_[et],o[et],j)):defineProperty(_,et,clone(o[et])))}),_),concatArrays=(_,o,$)=>{let j=_.slice(0,0),et=0;return[_,o].forEach(tt=>{const rt=[];for(let nt=0;nt<tt.length;nt++)hasOwnProperty.call(tt,nt)&&(rt.push(String(nt)),tt===_?defineProperty(j,et++,tt[nt]):defineProperty(j,et++,clone(tt[nt])));j=mergeKeys(j,tt,getEnumerableOwnPropertyKeys(tt).filter(nt=>!rt.includes(nt)),$)}),j};function merge$3(_,o,$){return $.concatArrays&&Array.isArray(_)&&Array.isArray(o)?concatArrays(_,o,$):!isOptionObject(o)||!isOptionObject(_)?clone(o):mergeKeys(_,o,getEnumerableOwnPropertyKeys(o),$)}var mergeOptions$g=function(..._){const o=merge$3(clone(defaultMergeOptions),this!==globalThis$1&&this||{},defaultMergeOptions);let $={_:{}};for(const j of _)if(j!==void 0){if(!isOptionObject(j))throw new TypeError("`"+j+"` is not an Option Object");$=merge$3($,{_:j},o)}return $._};const mergeOptions$f=Object.freeze(Object.defineProperty({__proto__:null,default:mergeOptions$g},Symbol.toStringTag,{value:"Module"})),isElectron=isElectron_1,IS_ENV_WITH_DOM=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,IS_ELECTRON=isElectron(),IS_BROWSER=IS_ENV_WITH_DOM&&!IS_ELECTRON,IS_ELECTRON_MAIN=IS_ELECTRON&&!IS_ENV_WITH_DOM,IS_ELECTRON_RENDERER=IS_ELECTRON&&IS_ENV_WITH_DOM,IS_NODE=typeof commonjsRequire$1=="function"&&typeof browserExports$3<"u"&&typeof browserExports$3.release<"u"&&browserExports$3.release.name==="node"&&!IS_ELECTRON,IS_WEBWORKER=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,IS_TEST=typeof browserExports$3<"u"&&typeof browserExports$3.env<"u"&&!1,IS_REACT_NATIVE=typeof navigator<"u"&&navigator.product==="ReactNative";var env={isTest:IS_TEST,isElectron:IS_ELECTRON,isElectronMain:IS_ELECTRON_MAIN,isElectronRenderer:IS_ELECTRON_RENDERER,isNode:IS_NODE,isBrowser:IS_BROWSER,isWebWorker:IS_WEBWORKER,isEnvWithDom:IS_ENV_WITH_DOM,isReactNative:IS_REACT_NATIVE},browserExports$1={},browser$3={get exports(){return browserExports$1},set exports(_){browserExports$1=_}},ms$1,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms$1;hasRequiredMs=1;var _=1e3,o=_*60,$=o*60,j=$*24,et=j*7,tt=j*365.25;ms$1=function(ot,at){at=at||{};var ct=typeof ot;if(ct==="string"&&ot.length>0)return rt(ot);if(ct==="number"&&isFinite(ot))return at.long?it(ot):nt(ot);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ot))};function rt(ot){if(ot=String(ot),!(ot.length>100)){var at=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(ot);if(at){var ct=parseFloat(at[1]),ut=(at[2]||"ms").toLowerCase();switch(ut){case"years":case"year":case"yrs":case"yr":case"y":return ct*tt;case"weeks":case"week":case"w":return ct*et;case"days":case"day":case"d":return ct*j;case"hours":case"hour":case"hrs":case"hr":case"h":return ct*$;case"minutes":case"minute":case"mins":case"min":case"m":return ct*o;case"seconds":case"second":case"secs":case"sec":case"s":return ct*_;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return ct;default:return}}}}function nt(ot){var at=Math.abs(ot);return at>=j?Math.round(ot/j)+"d":at>=$?Math.round(ot/$)+"h":at>=o?Math.round(ot/o)+"m":at>=_?Math.round(ot/_)+"s":ot+"ms"}function it(ot){var at=Math.abs(ot);return at>=j?st(ot,at,j,"day"):at>=$?st(ot,at,$,"hour"):at>=o?st(ot,at,o,"minute"):at>=_?st(ot,at,_,"second"):ot+" ms"}function st(ot,at,ct,ut){var ft=at>=ct*1.5;return Math.round(ot/ct)+" "+ut+(ft?"s":"")}return ms$1}function setup(_){$.debug=$,$.default=$,$.coerce=it,$.disable=tt,$.enable=et,$.enabled=rt,$.humanize=requireMs(),$.destroy=st,Object.keys(_).forEach(ot=>{$[ot]=_[ot]}),$.names=[],$.skips=[],$.formatters={};function o(ot){let at=0;for(let ct=0;ct<ot.length;ct++)at=(at<<5)-at+ot.charCodeAt(ct),at|=0;return $.colors[Math.abs(at)%$.colors.length]}$.selectColor=o;function $(ot){let at,ct=null,ut,ft;function ht(...mt){if(!ht.enabled)return;const gt=ht,Et=Number(new Date),St=Et-(at||Et);gt.diff=St,gt.prev=at,gt.curr=Et,at=Et,mt[0]=$.coerce(mt[0]),typeof mt[0]!="string"&&mt.unshift("%O");let At=0;mt[0]=mt[0].replace(/%([a-zA-Z%])/g,(Rt,Tt)=>{if(Rt==="%%")return"%";At++;const Dt=$.formatters[Tt];if(typeof Dt=="function"){const Ot=mt[At];Rt=Dt.call(gt,Ot),mt.splice(At,1),At--}return Rt}),$.formatArgs.call(gt,mt),(gt.log||$.log).apply(gt,mt)}return ht.namespace=ot,ht.useColors=$.useColors(),ht.color=$.selectColor(ot),ht.extend=j,ht.destroy=$.destroy,Object.defineProperty(ht,"enabled",{enumerable:!0,configurable:!1,get:()=>ct!==null?ct:(ut!==$.namespaces&&(ut=$.namespaces,ft=$.enabled(ot)),ft),set:mt=>{ct=mt}}),typeof $.init=="function"&&$.init(ht),ht}function j(ot,at){const ct=$(this.namespace+(typeof at>"u"?":":at)+ot);return ct.log=this.log,ct}function et(ot){$.save(ot),$.namespaces=ot,$.names=[],$.skips=[];let at;const ct=(typeof ot=="string"?ot:"").split(/[\s,]+/),ut=ct.length;for(at=0;at<ut;at++)ct[at]&&(ot=ct[at].replace(/\*/g,".*?"),ot[0]==="-"?$.skips.push(new RegExp("^"+ot.slice(1)+"$")):$.names.push(new RegExp("^"+ot+"$")))}function tt(){const ot=[...$.names.map(nt),...$.skips.map(nt).map(at=>"-"+at)].join(",");return $.enable(""),ot}function rt(ot){if(ot[ot.length-1]==="*")return!0;let at,ct;for(at=0,ct=$.skips.length;at<ct;at++)if($.skips[at].test(ot))return!1;for(at=0,ct=$.names.length;at<ct;at++)if($.names[at].test(ot))return!0;return!1}function nt(ot){return ot.toString().substring(2,ot.toString().length-2).replace(/\.\*\?$/,"*")}function it(ot){return ot instanceof Error?ot.stack||ot.message:ot}function st(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return $.enable($.load()),$}var common$1=setup;(function(_,o){o.formatArgs=j,o.save=et,o.load=tt,o.useColors=$,o.storage=rt(),o.destroy=(()=>{let it=!1;return()=>{it||(it=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function $(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function j(it){if(it[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+it[0]+(this.useColors?"%c ":" ")+"+"+_.exports.humanize(this.diff),!this.useColors)return;const st="color: "+this.color;it.splice(1,0,st,"color: inherit");let ot=0,at=0;it[0].replace(/%[a-zA-Z%]/g,ct=>{ct!=="%%"&&(ot++,ct==="%c"&&(at=ot))}),it.splice(at,0,st)}o.log=console.debug||console.log||(()=>{});function et(it){try{it?o.storage.setItem("debug",it):o.storage.removeItem("debug")}catch{}}function tt(){let it;try{it=o.storage.getItem("debug")}catch{}return!it&&typeof browserExports$3<"u"&&"env"in browserExports$3&&(it={}.DEBUG),it}function rt(){try{return localStorage}catch{}}_.exports=common$1(o);const{formatters:nt}=_.exports;nt.j=function(it){try{return JSON.stringify(it)}catch(st){return"[UnexpectedJSONParseError]: "+st.message}}})(browser$3,browserExports$1);browserExports$1.formatters.b=_=>_==null?"undefined":base58btc$4.baseEncode(_);browserExports$1.formatters.t=_=>_==null?"undefined":base32$6.baseEncode(_);browserExports$1.formatters.m=_=>_==null?"undefined":base64$6.baseEncode(_);browserExports$1.formatters.p=_=>_==null?"undefined":_.toString();browserExports$1.formatters.c=_=>_==null?"undefined":_.toString();browserExports$1.formatters.k=_=>_==null?"undefined":_.toString();function logger$1(_){return Object.assign(browserExports$1(_),{error:browserExports$1(`${_}:error`),trace:browserExports$1(`${_}:trace`)})}function assign$1(_,o){for(const $ in o)Object.defineProperty(_,$,{value:o[$],enumerable:!0,configurable:!0});return _}function createError(_,o,$){if(!_||typeof _=="string")throw new TypeError("Please pass an Error to err-code");$||($={}),typeof o=="object"&&($=o,o=""),o&&($.code=o);try{return assign$1(_,$)}catch{$.message=_.message,$.stack=_.stack;const et=function(){};return et.prototype=Object.create(Object.getPrototypeOf(_)),assign$1(new et,$)}}var errCode=createError,minimalExports$2={},minimal$2={get exports(){return minimalExports$2},set exports(_){minimalExports$2=_}},indexMinimal$1={},rpc$2={},service$1=Service$1,util=requireMinimal$2();(Service$1.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service$1;function Service$1(_,o,$){if(typeof _!="function")throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=_,this.requestDelimited=!!o,this.responseDelimited=!!$}Service$1.prototype.rpcCall=function _(o,$,j,et,tt){if(!et)throw TypeError("request must be specified");var rt=this;if(!tt)return util.asPromise(_,rt,o,$,j,et);if(!rt.rpcImpl){setTimeout(function(){tt(Error("already ended"))},0);return}try{return rt.rpcImpl(o,$[rt.requestDelimited?"encodeDelimited":"encode"](et).finish(),function(it,st){if(it)return rt.emit("error",it,o),tt(it);if(st===null){rt.end(!0);return}if(!(st instanceof j))try{st=j[rt.responseDelimited?"decodeDelimited":"decode"](st)}catch(ot){return rt.emit("error",ot,o),tt(ot)}return rt.emit("data",st,o),tt(null,st)})}catch(nt){rt.emit("error",nt,o),setTimeout(function(){tt(nt)},0);return}};Service$1.prototype.end=function _(o){return this.rpcImpl&&(o||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(_){var o=_;o.Service=service$1})(rpc$2);var roots$1={};(function(_){var o=_;o.build="minimal",o.Writer=writer$5,o.BufferWriter=writer_buffer$1,o.Reader=reader$6,o.BufferReader=reader_buffer$1,o.util=requireMinimal$2(),o.rpc=rpc$2,o.roots=roots$1,o.configure=$;function $(){o.util._configure(),o.Writer._configure(o.BufferWriter),o.Reader._configure(o.BufferReader)}$()})(indexMinimal$1);(function(_){_.exports=indexMinimal$1})(minimal$2);const $protobuf=getDefaultExportFromCjs(minimalExports$2),$Reader$7=$protobuf.Reader,$Writer$7=$protobuf.Writer,$util$6=$protobuf.util,$root$7=$protobuf.roots["ipfs-unixfs"]||($protobuf.roots["ipfs-unixfs"]={}),Data=$root$7.Data=(()=>{function _(o){if(this.blocksizes=[],o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.Type=0,_.prototype.Data=$util$6.newBuffer([]),_.prototype.filesize=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,_.prototype.blocksizes=$util$6.emptyArray,_.prototype.hashType=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,_.prototype.fanout=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,_.prototype.mode=0,_.prototype.mtime=null,_.encode=function($,j){if(j||(j=$Writer$7.create()),j.uint32(8).int32($.Type),$.Data!=null&&Object.hasOwnProperty.call($,"Data")&&j.uint32(18).bytes($.Data),$.filesize!=null&&Object.hasOwnProperty.call($,"filesize")&&j.uint32(24).uint64($.filesize),$.blocksizes!=null&&$.blocksizes.length)for(var et=0;et<$.blocksizes.length;++et)j.uint32(32).uint64($.blocksizes[et]);return $.hashType!=null&&Object.hasOwnProperty.call($,"hashType")&&j.uint32(40).uint64($.hashType),$.fanout!=null&&Object.hasOwnProperty.call($,"fanout")&&j.uint32(48).uint64($.fanout),$.mode!=null&&Object.hasOwnProperty.call($,"mode")&&j.uint32(56).uint32($.mode),$.mtime!=null&&Object.hasOwnProperty.call($,"mtime")&&$root$7.UnixTime.encode($.mtime,j.uint32(66).fork()).ldelim(),j},_.decode=function($,j){$ instanceof $Reader$7||($=$Reader$7.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$7.Data;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.Type=$.int32();break;case 2:tt.Data=$.bytes();break;case 3:tt.filesize=$.uint64();break;case 4:if(tt.blocksizes&&tt.blocksizes.length||(tt.blocksizes=[]),(rt&7)===2)for(var nt=$.uint32()+$.pos;$.pos<nt;)tt.blocksizes.push($.uint64());else tt.blocksizes.push($.uint64());break;case 5:tt.hashType=$.uint64();break;case 6:tt.fanout=$.uint64();break;case 7:tt.mode=$.uint32();break;case 8:tt.mtime=$root$7.UnixTime.decode($,$.uint32());break;default:$.skipType(rt&7);break}}if(!tt.hasOwnProperty("Type"))throw $util$6.ProtocolError("missing required 'Type'",{instance:tt});return tt},_.fromObject=function($){if($ instanceof $root$7.Data)return $;var j=new $root$7.Data;switch($.Type){case"Raw":case 0:j.Type=0;break;case"Directory":case 1:j.Type=1;break;case"File":case 2:j.Type=2;break;case"Metadata":case 3:j.Type=3;break;case"Symlink":case 4:j.Type=4;break;case"HAMTShard":case 5:j.Type=5;break}if($.Data!=null&&(typeof $.Data=="string"?$util$6.base64.decode($.Data,j.Data=$util$6.newBuffer($util$6.base64.length($.Data)),0):$.Data.length&&(j.Data=$.Data)),$.filesize!=null&&($util$6.Long?(j.filesize=$util$6.Long.fromValue($.filesize)).unsigned=!0:typeof $.filesize=="string"?j.filesize=parseInt($.filesize,10):typeof $.filesize=="number"?j.filesize=$.filesize:typeof $.filesize=="object"&&(j.filesize=new $util$6.LongBits($.filesize.low>>>0,$.filesize.high>>>0).toNumber(!0))),$.blocksizes){if(!Array.isArray($.blocksizes))throw TypeError(".Data.blocksizes: array expected");j.blocksizes=[];for(var et=0;et<$.blocksizes.length;++et)$util$6.Long?(j.blocksizes[et]=$util$6.Long.fromValue($.blocksizes[et])).unsigned=!0:typeof $.blocksizes[et]=="string"?j.blocksizes[et]=parseInt($.blocksizes[et],10):typeof $.blocksizes[et]=="number"?j.blocksizes[et]=$.blocksizes[et]:typeof $.blocksizes[et]=="object"&&(j.blocksizes[et]=new $util$6.LongBits($.blocksizes[et].low>>>0,$.blocksizes[et].high>>>0).toNumber(!0))}if($.hashType!=null&&($util$6.Long?(j.hashType=$util$6.Long.fromValue($.hashType)).unsigned=!0:typeof $.hashType=="string"?j.hashType=parseInt($.hashType,10):typeof $.hashType=="number"?j.hashType=$.hashType:typeof $.hashType=="object"&&(j.hashType=new $util$6.LongBits($.hashType.low>>>0,$.hashType.high>>>0).toNumber(!0))),$.fanout!=null&&($util$6.Long?(j.fanout=$util$6.Long.fromValue($.fanout)).unsigned=!0:typeof $.fanout=="string"?j.fanout=parseInt($.fanout,10):typeof $.fanout=="number"?j.fanout=$.fanout:typeof $.fanout=="object"&&(j.fanout=new $util$6.LongBits($.fanout.low>>>0,$.fanout.high>>>0).toNumber(!0))),$.mode!=null&&(j.mode=$.mode>>>0),$.mtime!=null){if(typeof $.mtime!="object")throw TypeError(".Data.mtime: object expected");j.mtime=$root$7.UnixTime.fromObject($.mtime)}return j},_.toObject=function($,j){j||(j={});var et={};if((j.arrays||j.defaults)&&(et.blocksizes=[]),j.defaults){if(et.Type=j.enums===String?"Raw":0,j.bytes===String?et.Data="":(et.Data=[],j.bytes!==Array&&(et.Data=$util$6.newBuffer(et.Data))),$util$6.Long){var tt=new $util$6.Long(0,0,!0);et.filesize=j.longs===String?tt.toString():j.longs===Number?tt.toNumber():tt}else et.filesize=j.longs===String?"0":0;if($util$6.Long){var tt=new $util$6.Long(0,0,!0);et.hashType=j.longs===String?tt.toString():j.longs===Number?tt.toNumber():tt}else et.hashType=j.longs===String?"0":0;if($util$6.Long){var tt=new $util$6.Long(0,0,!0);et.fanout=j.longs===String?tt.toString():j.longs===Number?tt.toNumber():tt}else et.fanout=j.longs===String?"0":0;et.mode=0,et.mtime=null}if($.Type!=null&&$.hasOwnProperty("Type")&&(et.Type=j.enums===String?$root$7.Data.DataType[$.Type]:$.Type),$.Data!=null&&$.hasOwnProperty("Data")&&(et.Data=j.bytes===String?$util$6.base64.encode($.Data,0,$.Data.length):j.bytes===Array?Array.prototype.slice.call($.Data):$.Data),$.filesize!=null&&$.hasOwnProperty("filesize")&&(typeof $.filesize=="number"?et.filesize=j.longs===String?String($.filesize):$.filesize:et.filesize=j.longs===String?$util$6.Long.prototype.toString.call($.filesize):j.longs===Number?new $util$6.LongBits($.filesize.low>>>0,$.filesize.high>>>0).toNumber(!0):$.filesize),$.blocksizes&&$.blocksizes.length){et.blocksizes=[];for(var rt=0;rt<$.blocksizes.length;++rt)typeof $.blocksizes[rt]=="number"?et.blocksizes[rt]=j.longs===String?String($.blocksizes[rt]):$.blocksizes[rt]:et.blocksizes[rt]=j.longs===String?$util$6.Long.prototype.toString.call($.blocksizes[rt]):j.longs===Number?new $util$6.LongBits($.blocksizes[rt].low>>>0,$.blocksizes[rt].high>>>0).toNumber(!0):$.blocksizes[rt]}return $.hashType!=null&&$.hasOwnProperty("hashType")&&(typeof $.hashType=="number"?et.hashType=j.longs===String?String($.hashType):$.hashType:et.hashType=j.longs===String?$util$6.Long.prototype.toString.call($.hashType):j.longs===Number?new $util$6.LongBits($.hashType.low>>>0,$.hashType.high>>>0).toNumber(!0):$.hashType),$.fanout!=null&&$.hasOwnProperty("fanout")&&(typeof $.fanout=="number"?et.fanout=j.longs===String?String($.fanout):$.fanout:et.fanout=j.longs===String?$util$6.Long.prototype.toString.call($.fanout):j.longs===Number?new $util$6.LongBits($.fanout.low>>>0,$.fanout.high>>>0).toNumber(!0):$.fanout),$.mode!=null&&$.hasOwnProperty("mode")&&(et.mode=$.mode),$.mtime!=null&&$.hasOwnProperty("mtime")&&(et.mtime=$root$7.UnixTime.toObject($.mtime,j)),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.DataType=function(){const o={},$=Object.create(o);return $[o[0]="Raw"]=0,$[o[1]="Directory"]=1,$[o[2]="File"]=2,$[o[3]="Metadata"]=3,$[o[4]="Symlink"]=4,$[o[5]="HAMTShard"]=5,$}(),_})();$root$7.UnixTime=(()=>{function _(o){if(o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.Seconds=$util$6.Long?$util$6.Long.fromBits(0,0,!1):0,_.prototype.FractionalNanoseconds=0,_.encode=function($,j){return j||(j=$Writer$7.create()),j.uint32(8).int64($.Seconds),$.FractionalNanoseconds!=null&&Object.hasOwnProperty.call($,"FractionalNanoseconds")&&j.uint32(21).fixed32($.FractionalNanoseconds),j},_.decode=function($,j){$ instanceof $Reader$7||($=$Reader$7.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$7.UnixTime;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.Seconds=$.int64();break;case 2:tt.FractionalNanoseconds=$.fixed32();break;default:$.skipType(rt&7);break}}if(!tt.hasOwnProperty("Seconds"))throw $util$6.ProtocolError("missing required 'Seconds'",{instance:tt});return tt},_.fromObject=function($){if($ instanceof $root$7.UnixTime)return $;var j=new $root$7.UnixTime;return $.Seconds!=null&&($util$6.Long?(j.Seconds=$util$6.Long.fromValue($.Seconds)).unsigned=!1:typeof $.Seconds=="string"?j.Seconds=parseInt($.Seconds,10):typeof $.Seconds=="number"?j.Seconds=$.Seconds:typeof $.Seconds=="object"&&(j.Seconds=new $util$6.LongBits($.Seconds.low>>>0,$.Seconds.high>>>0).toNumber())),$.FractionalNanoseconds!=null&&(j.FractionalNanoseconds=$.FractionalNanoseconds>>>0),j},_.toObject=function($,j){j||(j={});var et={};if(j.defaults){if($util$6.Long){var tt=new $util$6.Long(0,0,!1);et.Seconds=j.longs===String?tt.toString():j.longs===Number?tt.toNumber():tt}else et.Seconds=j.longs===String?"0":0;et.FractionalNanoseconds=0}return $.Seconds!=null&&$.hasOwnProperty("Seconds")&&(typeof $.Seconds=="number"?et.Seconds=j.longs===String?String($.Seconds):$.Seconds:et.Seconds=j.longs===String?$util$6.Long.prototype.toString.call($.Seconds):j.longs===Number?new $util$6.LongBits($.Seconds.low>>>0,$.Seconds.high>>>0).toNumber():$.Seconds),$.FractionalNanoseconds!=null&&$.hasOwnProperty("FractionalNanoseconds")&&(et.FractionalNanoseconds=$.FractionalNanoseconds),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();$root$7.Metadata=(()=>{function _(o){if(o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.MimeType="",_.encode=function($,j){return j||(j=$Writer$7.create()),$.MimeType!=null&&Object.hasOwnProperty.call($,"MimeType")&&j.uint32(10).string($.MimeType),j},_.decode=function($,j){$ instanceof $Reader$7||($=$Reader$7.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$7.Metadata;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.MimeType=$.string();break;default:$.skipType(rt&7);break}}return tt},_.fromObject=function($){if($ instanceof $root$7.Metadata)return $;var j=new $root$7.Metadata;return $.MimeType!=null&&(j.MimeType=String($.MimeType)),j},_.toObject=function($,j){j||(j={});var et={};return j.defaults&&(et.MimeType=""),$.MimeType!=null&&$.hasOwnProperty("MimeType")&&(et.MimeType=$.MimeType),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();const PBData=Data,types=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],dirTypes=["directory","hamt-sharded-directory"],DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8);function parseMode(_){if(_!=null)return typeof _=="number"?_&4095:(_=_.toString(),_.substring(0,1)==="0"?parseInt(_,8)&4095:parseInt(_,10)&4095)}function parseMtime$1(_){if(_==null)return;let o;if(_.secs!=null&&(o={secs:_.secs,nsecs:_.nsecs}),_.Seconds!=null&&(o={secs:_.Seconds,nsecs:_.FractionalNanoseconds}),Array.isArray(_)&&(o={secs:_[0],nsecs:_[1]}),_ instanceof Date){const $=_.getTime(),j=Math.floor($/1e3);o={secs:j,nsecs:($-j*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(o,"secs")){if(o!=null&&o.nsecs!=null&&(o.nsecs<0||o.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return o}}class UnixFS{static unmarshal(o){const $=PBData.decode(o),j=PBData.toObject($,{defaults:!1,arrays:!0,longs:Number,objects:!1}),et=new UnixFS({type:types[j.Type],data:j.Data,blockSizes:j.blocksizes,mode:j.mode,mtime:j.mtime?{secs:j.mtime.Seconds,nsecs:j.mtime.FractionalNanoseconds}:void 0});return et._originalMode=j.mode||0,et}constructor(o={type:"file"}){const{type:$,data:j,blockSizes:et,hashType:tt,fanout:rt,mtime:nt,mode:it}=o;if($&&!types.includes($))throw errCode(new Error("Type: "+$+" is not valid"),"ERR_INVALID_TYPE");this.type=$||"file",this.data=j,this.hashType=tt,this.fanout=rt,this.blockSizes=et||[],this._originalMode=0,this.mode=parseMode(it),nt&&(this.mtime=parseMtime$1(nt),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(o){this._mode=this.isDirectory()?DEFAULT_DIRECTORY_MODE:DEFAULT_FILE_MODE;const $=parseMode(o);$!==void 0&&(this._mode=$)}get mode(){return this._mode}isDirectory(){return!!(this.type&&dirTypes.includes(this.type))}addBlockSize(o){this.blockSizes.push(o)}removeBlockSize(o){this.blockSizes.splice(o,1)}fileSize(){if(this.isDirectory())return 0;let o=0;return this.blockSizes.forEach($=>{o+=$}),this.data&&(o+=this.data.length),o}marshal(){let o;switch(this.type){case"raw":o=PBData.DataType.Raw;break;case"directory":o=PBData.DataType.Directory;break;case"file":o=PBData.DataType.File;break;case"metadata":o=PBData.DataType.Metadata;break;case"symlink":o=PBData.DataType.Symlink;break;case"hamt-sharded-directory":o=PBData.DataType.HAMTShard;break;default:throw errCode(new Error("Type: "+o+" is not valid"),"ERR_INVALID_TYPE")}let $=this.data;(!this.data||!this.data.length)&&($=void 0);let j;this.mode!=null&&(j=this._originalMode&4294963200|(parseMode(this.mode)||0),j===DEFAULT_FILE_MODE&&!this.isDirectory()&&(j=void 0),j===DEFAULT_DIRECTORY_MODE&&this.isDirectory()&&(j=void 0));let et;if(this.mtime!=null){const rt=parseMtime$1(this.mtime);rt&&(et={Seconds:rt.secs,FractionalNanoseconds:rt.nsecs},et.FractionalNanoseconds===0&&delete et.FractionalNanoseconds)}const tt={Type:o,Data:$,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:j,mtime:et};return PBData.encode(tt).finish()}}class JSONEncoder extends Array{constructor(){super(),this.inRecursive=[]}prefix(o){const $=this.inRecursive[this.inRecursive.length-1];$&&($.type===Type.array&&($.elements++,$.elements!==1&&o.push([44])),$.type===Type.map&&($.elements++,$.elements!==1&&($.elements%2===1?o.push([44]):o.push([58]))))}[Type.uint.major](o,$){this.prefix(o);const j=String($.value),et=[];for(let tt=0;tt<j.length;tt++)et[tt]=j.charCodeAt(tt);o.push(et)}[Type.negint.major](o,$){this[Type.uint.major](o,$)}[Type.bytes.major](o,$){throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)}[Type.string.major](o,$){this.prefix(o);const j=fromString$9(JSON.stringify($.value));o.push(j.length>32?asU8A(j):j)}[Type.array.major](o,$){this.prefix(o),this.inRecursive.push({type:Type.array,elements:0}),o.push([91])}[Type.map.major](o,$){this.prefix(o),this.inRecursive.push({type:Type.map,elements:0}),o.push([123])}[Type.tag.major](o,$){}[Type.float.major](o,$){if($.type.name==="break"){const rt=this.inRecursive.pop();if(rt){if(rt.type===Type.array)o.push([93]);else if(rt.type===Type.map)o.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if($.value===void 0)throw new Error(`${encodeErrPrefix} unsupported type: undefined`);if(this.prefix(o),$.type.name==="true"){o.push([116,114,117,101]);return}else if($.type.name==="false"){o.push([102,97,108,115,101]);return}else if($.type.name==="null"){o.push([110,117,108,108]);return}const j=String($.value),et=[];let tt=!1;for(let rt=0;rt<j.length;rt++)et[rt]=j.charCodeAt(rt),!tt&&(et[rt]===46||et[rt]===101||et[rt]===69)&&(tt=!0);tt||(et.push(46),et.push(48)),o.push(et)}}function mapSorter(_,o){if(Array.isArray(_[0])||Array.isArray(o[0]))throw new Error(`${encodeErrPrefix} complex map keys are not supported`);const $=_[0],j=o[0];if($.type!==Type.string||j.type!==Type.string)throw new Error(`${encodeErrPrefix} non-string map keys are not supported`);if($<j)return-1;if($>j)return 1;throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)}const defaultEncodeOptions={addBreakTokens:!0,mapSorter};function encode$d(_,o){return o=Object.assign({},defaultEncodeOptions,o),encodeCustom(_,new JSONEncoder,o)}class Tokenizer{constructor(o,$={}){this.pos=0,this.data=o,this.options=$,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let o=this.ch();for(;o===32||o===9||o===13||o===10;)o=this.data[++this.pos]}expect(o){if(this.data.length-this.pos<o.length)throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this.pos}`);for(let $=0;$<o.length;$++)if(this.data[this.pos++]!==o[$])throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...o)}'`)}parseNumber(){const o=this.pos;let $=!1,j=!1;const et=nt=>{for(;!this.done();){const it=this.ch();if(nt.includes(it))this.pos++;else break}};if(this.ch()===45&&($=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,j=!0;else return new Token(Type.uint,0,this.pos-o);if(et([48,49,50,51,52,53,54,55,56,57]),$&&this.pos===o+1)throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(j)throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}`);j=!0,this.pos++,et([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(j=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,et([48,49,50,51,52,53,54,55,56,57]));const tt=String.fromCharCode.apply(null,this.data.subarray(o,this.pos)),rt=parseFloat(tt);return j?new Token(Type.float,rt,this.pos-o):this.options.allowBigInt!==!0||Number.isSafeInteger(rt)?new Token(rt>=0?Type.uint:Type.negint,rt,this.pos-o):new Token(rt>=0?Type.uint:Type.negint,BigInt(tt),this.pos-o)}parseString(){if(this.ch()!==34)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let tt=this.pos,rt=0;tt<this.data.length&&rt<65536;tt++,rt++){const nt=this.data[tt];if(nt===92||nt<32||nt>=128)break;if(nt===34){const it=String.fromCharCode.apply(null,this.data.subarray(this.pos,tt));return this.pos=tt+1,new Token(Type.string,it,rt)}}const o=this.pos,$=[],j=()=>{if(this.pos+4>=this.data.length)throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this.pos}`);let tt=0;for(let rt=0;rt<4;rt++){let nt=this.ch();if(nt>=48&&nt<=57)nt-=48;else if(nt>=97&&nt<=102)nt=nt-97+10;else if(nt>=65&&nt<=70)nt=nt-65+10;else throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this.pos}`);tt=tt*16+nt,this.pos++}return tt},et=()=>{const tt=this.ch();let rt=null,nt=tt>239?4:tt>223?3:tt>191?2:1;if(this.pos+nt>this.data.length)throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this.pos}`);let it,st,ot,at;switch(nt){case 1:tt<128&&(rt=tt);break;case 2:it=this.data[this.pos+1],(it&192)===128&&(at=(tt&31)<<6|it&63,at>127&&(rt=at));break;case 3:it=this.data[this.pos+1],st=this.data[this.pos+2],(it&192)===128&&(st&192)===128&&(at=(tt&15)<<12|(it&63)<<6|st&63,at>2047&&(at<55296||at>57343)&&(rt=at));break;case 4:it=this.data[this.pos+1],st=this.data[this.pos+2],ot=this.data[this.pos+3],(it&192)===128&&(st&192)===128&&(ot&192)===128&&(at=(tt&15)<<18|(it&63)<<12|(st&63)<<6|ot&63,at>65535&&at<1114112&&(rt=at))}rt===null?(rt=65533,nt=1):rt>65535&&(rt-=65536,$.push(rt>>>10&1023|55296),rt=56320|rt&1023),$.push(rt),this.pos+=nt};for(;!this.done();){const tt=this.ch();let rt;switch(tt){case 92:if(this.pos++,this.done())throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this.pos}`);switch(rt=this.ch(),this.pos++,rt){case 34:case 39:case 92:case 47:$.push(rt);break;case 98:$.push(8);break;case 116:$.push(9);break;case 110:$.push(10);break;case 102:$.push(12);break;case 114:$.push(13);break;case 117:$.push(j());break;default:throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Token(Type.string,decodeCodePointsArray($),this.pos-o);default:if(tt<32)throw new Error(`${decodeErrPrefix} invalid control character at position ${this.pos}`);tt<128?($.push(tt),this.pos++):et()}}throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const o=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),o}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function decode$9(_,o){return o=Object.assign({tokenizer:new Tokenizer(_,o)},o),decode$x(_,o)}function cidEncoder(_){if(_.asCID!==_&&_["/"]!==_.bytes)return null;const o=CID$3.asCID(_);if(!o)return null;const $=o.toString();return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.string,$,$.length),new Token(Type.break,void 0,1)]}function bytesEncoder(_){const o=base64$6.encode(_).slice(1);return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.map,1/0,1),new Token(Type.string,"bytes",5),new Token(Type.string,o,o.length),new Token(Type.break,void 0,1),new Token(Type.break,void 0,1)]}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(_){if(Number.isNaN(_))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(_===1/0||_===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={typeEncoders:{Object:cidEncoder,Uint8Array:bytesEncoder,Buffer:bytesEncoder,undefined:undefinedEncoder,number:numberEncoder}};class DagJsonTokenizer extends Tokenizer{constructor(o,$){super(o,$),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const o=this._next();if(o.type===Type.map){const $=this._next();if($.type===Type.string&&$.value==="/"){const j=this._next();if(j.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(j),new Token(Type.tag,42,0)}if(j.type===Type.map){const et=this._next();if(et.type===Type.string&&et.value==="bytes"){const tt=this._next();if(tt.type===Type.string){for(let nt=0;nt<2;nt++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const rt=base64$6.decode(`m${tt.value}`);return new Token(Type.bytes,rt,tt.value.length)}this.tokenBuffer.push(tt)}this.tokenBuffer.push(et)}this.tokenBuffer.push(j)}this.tokenBuffer.push($)}return o}}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[42]=CID$3.parse;const name$2="dag-json",code$1=297,encode$c=_=>encode$d(_,encodeOptions),decode$8=_=>{const o=Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer(_,decodeOptions)});return decode$9(_,o)},format$5=_=>utf8Decoder.decode(encode$c(_)),utf8Decoder=new TextDecoder,parse$5=_=>decode$8(utf8Encoder.encode(_)),utf8Encoder=new TextEncoder,dagJSON=Object.freeze(Object.defineProperty({__proto__:null,code:code$1,decode:decode$8,encode:encode$c,format:format$5,name:name$2,parse:parse$5,stringify:format$5},Symbol.toStringTag,{value:"Module"}));function toBase64url(_){return base64url$2.encode(_).slice(1)}function fromBase64url(_){return base64url$2.decode(`u${_}`)}function fromSplit$1(_){const[o,$,j]=_;return{payload:$,signatures:[{protected:o,signature:j}],link:CID$3.decode(fromBase64url($))}}function encodeSignature(_){const o={signature:fromBase64url(_.signature)};return _.header&&(o.header=_.header),_.protected&&(o.protected=fromBase64url(_.protected)),o}function encode$b(_){const o=fromBase64url(_.payload);try{CID$3.decode(o)}catch{throw new Error("Not a valid DagJWS")}return{payload:o,signatures:_.signatures.map(encodeSignature)}}function decodeSignature(_){const o={signature:toBase64url(_.signature)};return _.header&&(o.header=_.header),_.protected&&(o.protected=toBase64url(_.protected)),o}function decode$7(_){const o={payload:toBase64url(_.payload),signatures:_.signatures.map(decodeSignature)};return o.link=CID$3.decode(new Uint8Array(_.payload)),o}function fromSplit(_){const[o,$,j,et,tt]=_,rt={ciphertext:et,iv:j,protected:o,tag:tt};return $&&(rt.recipients=[{encrypted_key:$}]),rt}function encodeRecipient(_){const o={};return _.encrypted_key&&(o.encrypted_key=fromBase64url(_.encrypted_key)),_.header&&(o.header=_.header),o}function encode$a(_){const o={ciphertext:fromBase64url(_.ciphertext),protected:fromBase64url(_.protected),iv:fromBase64url(_.iv),tag:fromBase64url(_.tag)};return _.aad&&(o.aad=fromBase64url(_.aad)),_.recipients&&(o.recipients=_.recipients.map(encodeRecipient)),_.unprotected&&(o.unprotected=_.unprotected),o}function decodeRecipient(_){const o={};return _.encrypted_key&&(o.encrypted_key=toBase64url(_.encrypted_key)),_.header&&(o.header=_.header),o}function decode$6(_){const o={ciphertext:toBase64url(_.ciphertext),protected:toBase64url(_.protected),iv:toBase64url(_.iv),tag:toBase64url(_.tag)};return _.aad&&(o.aad=toBase64url(_.aad)),_.recipients&&(o.recipients=_.recipients.map(decodeRecipient)),_.unprotected&&(o.unprotected=_.unprotected),o}const name$1="dag-jose",code=133;function isDagJWS(_){return"payload"in _&&typeof _.payload=="string"&&"signatures"in _&&Array.isArray(_.signatures)}function isEncodedJWS(_){return"payload"in _&&_.payload instanceof Uint8Array&&"signatures"in _&&Array.isArray(_.signatures)}function isEncodedJWE(_){return"ciphertext"in _&&_.ciphertext instanceof Uint8Array&&"iv"in _&&_.iv instanceof Uint8Array&&"protected"in _&&_.protected instanceof Uint8Array&&"tag"in _&&_.tag instanceof Uint8Array}function isDagJWE(_){return"ciphertext"in _&&typeof _.ciphertext=="string"&&"iv"in _&&typeof _.iv=="string"&&"protected"in _&&typeof _.protected=="string"&&"tag"in _&&typeof _.tag=="string"}function toGeneral(_){if(typeof _=="string"){const o=_.split(".");if(o.length===3)return fromSplit$1(o);if(o.length===5)return fromSplit(o);throw new Error("Not a valid JOSE string")}if(isDagJWS(_)||isDagJWE(_))return _;throw new Error("Not a valid unencoded JOSE object")}function encode$9(_){typeof _=="string"&&(_=toGeneral(_));let o;if(isDagJWS(_))o=encode$b(_);else if(isDagJWE(_))o=encode$a(_);else throw new Error("Not a valid JOSE object");return new Uint8Array(encode$z(o))}function decode$5(_){let o;try{o=decode$w(_)}catch{throw new Error("Not a valid DAG-JOSE object")}if(isEncodedJWS(o))return decode$7(o);if(isEncodedJWE(o))return decode$6(o);throw new Error("Not a valid DAG-JOSE object")}const dagJOSE=Object.freeze(Object.defineProperty({__proto__:null,code,decode:decode$5,encode:encode$9,name:name$1,toGeneral},Symbol.toStringTag,{value:"Module"}));function initAssets(){}class NotInitializedError extends Error{constructor(o="not initialized"){super(o),this.name="NotInitializedError",this.code=NotInitializedError.code}}NotInitializedError.code="ERR_NOT_INITIALIZED";class AlreadyInitializingError extends Error{constructor(o="cannot initialize an initializing node"){super(o),this.name="AlreadyInitializingError",this.code=AlreadyInitializedError.code}}AlreadyInitializingError.code="ERR_ALREADY_INITIALIZING";class AlreadyInitializedError extends Error{constructor(o="cannot re-initialize an initialized node"){super(o),this.name="AlreadyInitializedError",this.code=AlreadyInitializedError.code}}AlreadyInitializedError.code="ERR_ALREADY_INITIALIZED";class NotStartedError extends Error{constructor(o="not started"){super(o),this.name="NotStartedError",this.code=NotStartedError.code}}NotStartedError.code="ERR_NOT_STARTED";class AlreadyStartingError extends Error{constructor(o="cannot start, already startin"){super(o),this.name="AlreadyStartingError",this.code=AlreadyStartingError.code}}AlreadyStartingError.code="ERR_ALREADY_STARTING";class AlreadyStartedError extends Error{constructor(o="cannot start, already started"){super(o),this.name="AlreadyStartedError",this.code=AlreadyStartedError.code}}AlreadyStartedError.code="ERR_ALREADY_STARTED";class NotEnabledError extends Error{constructor(o="not enabled"){super(o),this.name="NotEnabledError",this.code=NotEnabledError.code}}NotEnabledError.code="ERR_NOT_ENABLED";var timeBrowser=function _(){return Date.now()};const getTime=timeBrowser;class Retimer{constructor(o,$,j){const et=this;this._started=getTime(),this._rescheduled=0,this._scheduled=$,this._args=j,this._triggered=!1,this._timerWrapper=()=>{et._rescheduled>0?(et._scheduled=et._rescheduled-(getTime()-et._started),et._schedule(et._scheduled)):(et._triggered=!0,o.apply(null,et._args))},this._timer=setTimeout(this._timerWrapper,$)}reschedule(o){o||(o=this._scheduled);const $=getTime();$+o-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(o)):this._triggered?this._schedule(o):(this._started=$,this._rescheduled=o)}_schedule(o){this._triggered=!1,this._started=getTime(),this._rescheduled=0,this._scheduled=o,this._timer=setTimeout(this._timerWrapper,o)}clear(){clearTimeout(this._timer)}}function retimer$1(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let _;if(arguments.length>0){_=new Array(arguments.length-2);for(var o=0;o<_.length;o++)_[o]=arguments[o+2]}return new Retimer(arguments[0],arguments[1],_)}var retimer_1=retimer$1;const{AbortController:AbortController$1}=globalThis,retimer=retimer_1;class TimeoutController extends AbortController$1{constructor(o){super(),this._ms=o,this._timer=retimer(()=>this.abort(),o),Object.setPrototypeOf(this,TimeoutController.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=retimer(()=>this.abort(),this._ms)}}var timeoutAbortController={TimeoutController};class Parser{constructor(){os(this,"index",0);os(this,"input","")}new(o){return this.index=0,this.input=o,this}readAtomically(o){const $=this.index,j=o();return j===void 0&&(this.index=$),j}parseWith(o){const $=o();if(this.index===this.input.length)return $}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(o){return this.readAtomically(()=>{const $=this.readChar();if($===o)return $})}readSeparator(o,$,j){return this.readAtomically(()=>{if(!($>0&&this.readGivenChar(o)===void 0))return j()})}readNumber(o,$,j,et){return this.readAtomically(()=>{let tt=0,rt=0;const nt=this.peekChar();if(nt===void 0)return;const it=nt==="0",st=2**(8*et)-1;for(;;){const ot=this.readAtomically(()=>{const at=this.readChar();if(at===void 0)return;const ct=Number.parseInt(at,o);if(!Number.isNaN(ct))return ct});if(ot===void 0)break;if(tt*=o,tt+=ot,tt>st||(rt+=1,$!==void 0&&rt>$))return}if(rt!==0)return!j&&it&&rt>1?void 0:tt})}readIPv4Addr(){return this.readAtomically(()=>{const o=new Uint8Array(4);for(let $=0;$<o.length;$++){const j=this.readSeparator(".",$,()=>this.readNumber(10,3,!1,1));if(j===void 0)return;o[$]=j}return o})}readIPv6Addr(){const o=$=>{for(let j=0;j<$.length/2;j++){const et=j*2;if(j<$.length-3){const rt=this.readSeparator(":",j,()=>this.readIPv4Addr());if(rt!==void 0)return $[et]=rt[0],$[et+1]=rt[1],$[et+2]=rt[2],$[et+3]=rt[3],[et+4,!0]}const tt=this.readSeparator(":",j,()=>this.readNumber(16,4,!0,2));if(tt===void 0)return[et,!1];$[et]=tt>>8,$[et+1]=tt&255}return[$.length,!1]};return this.readAtomically(()=>{const $=new Uint8Array(16),[j,et]=o($);if(j===16)return $;if(et||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const tt=new Uint8Array(14),rt=16-(j+2),[nt]=o(tt.subarray(0,rt));return $.set(tt.subarray(0,nt),16-nt),$})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const MAX_IPV6_LENGTH=45,MAX_IPV4_LENGTH=15,parser$1=new Parser;function parseIPv4(_){if(!(_.length>MAX_IPV4_LENGTH))return parser$1.new(_).parseWith(()=>parser$1.readIPv4Addr())}function parseIPv6(_){if(!(_.length>MAX_IPV6_LENGTH))return parser$1.new(_).parseWith(()=>parser$1.readIPv6Addr())}function parseIP(_){if(!(_.length>MAX_IPV6_LENGTH))return parser$1.new(_).parseWith(()=>parser$1.readIPAddr())}function isIPv4(_){return!!parseIPv4(_)}function isIPv6(_){return!!parseIPv6(_)}function isIP(_){return!!parseIP(_)}const isV4$3=isIPv4,isV6$3=isIPv6,toBytes$4=function(_){let o=0;if(_=_.toString().trim(),isV4$3(_)){const $=new Uint8Array(o+4);return _.split(/\./g).forEach(j=>{$[o++]=parseInt(j,10)&255}),$}if(isV6$3(_)){const $=_.split(":",8);let j;for(j=0;j<$.length;j++){const tt=isV4$3($[j]);let rt;tt&&(rt=toBytes$4($[j]),$[j]=toString$a(rt.slice(0,2),"base16")),rt!=null&&++j<8&&$.splice(j,0,toString$a(rt.slice(2,4),"base16"))}if($[0]==="")for(;$.length<8;)$.unshift("0");else if($[$.length-1]==="")for(;$.length<8;)$.push("0");else if($.length<8){for(j=0;j<$.length&&$[j]!=="";j++);const tt=[j,1];for(j=9-$.length;j>0;j--)tt.push("0");$.splice.apply($,tt)}const et=new Uint8Array(o+16);for(j=0;j<$.length;j++){const tt=parseInt($[j],16);et[o++]=tt>>8&255,et[o++]=tt&255}return et}throw new Error("invalid ip address")},toString$5=function(_,o=0,$){o=~~o,$=$??_.length-o;const j=new DataView(_.buffer);if($===4){const et=[];for(let tt=0;tt<$;tt++)et.push(_[o+tt]);return et.join(".")}if($===16){const et=[];for(let tt=0;tt<$;tt+=2)et.push(j.getUint16(o+tt).toString(16));return et.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V$3=-1,names$3={},codes$6={},table$3=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$3,"ip6zone"],[43,8,"ipcidr"],[53,V$3,"dns",!0],[54,V$3,"dns4",!0],[55,V$3,"dns6",!0],[56,V$3,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$3,"unix",!1,!0],[421,V$3,"ipfs"],[421,V$3,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$3,"garlic64"],[448,0,"tls"],[449,V$3,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V$3,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$3,"memory"]];table$3.forEach(_=>{const o=createProtocol$3(..._);codes$6[o.code]=o,names$3[o.name]=o});function createProtocol$3(_,o,$,j,et){return{code:_,size:o,name:$,resolvable:!!j,path:!!et}}function getProtocol$3(_){if(typeof _=="number"){if(codes$6[_]!=null)return codes$6[_];throw new Error(`no protocol with code: ${_}`)}else if(typeof _=="string"){if(names$3[_]!=null)return names$3[_];throw new Error(`no protocol with name: ${_}`)}throw new Error(`invalid protocol id type: ${typeof _}`)}var encode_1$1=encode$8,MSB$4=128,REST$4=127,MSBALL$1=~REST$4,INT$1=Math.pow(2,31);function encode$8(_,o,$){if(Number.MAX_SAFE_INTEGER&&_>Number.MAX_SAFE_INTEGER)throw encode$8.bytes=0,new RangeError("Could not encode varint");o=o||[],$=$||0;for(var j=$;_>=INT$1;)o[$++]=_&255|MSB$4,_/=128;for(;_&MSBALL$1;)o[$++]=_&255|MSB$4,_>>>=7;return o[$]=_|0,encode$8.bytes=$-j+1,o}var decode$4=read$2,MSB$3=128,REST$3=127;function read$2(_,j){var $=0,j=j||0,et=0,tt=j,rt,nt=_.length;do{if(tt>=nt||et>49)throw read$2.bytes=0,new RangeError("Could not decode varint");rt=_[tt++],$+=et<28?(rt&REST$3)<<et:(rt&REST$3)*Math.pow(2,et),et+=7}while(rt>=MSB$3);return read$2.bytes=tt-j,$}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$3=function(_){return _<N1$2?1:_<N2$2?2:_<N3$2?3:_<N4$2?4:_<N5$2?5:_<N6$2?6:_<N7$2?7:_<N8$2?8:_<N9$2?9:10},varint$2={encode:encode_1$1,decode:decode$4,encodingLength:length$3};function convertToString$4(_,o){switch(getProtocol$3(_).code){case 4:case 41:return bytes2ip$3(o);case 42:return bytes2str$3(o);case 6:case 273:case 33:case 132:return bytes2port$3(o).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str$3(o);case 421:return bytes2mh$3(o);case 444:return bytes2onion$3(o);case 445:return bytes2onion$3(o);case 466:return bytes2mb$3(o);default:return toString$a(o,"base16")}}function convertToBytes$3(_,o){switch(getProtocol$3(_).code){case 4:return ip2bytes$3(o);case 41:return ip2bytes$3(o);case 42:return str2bytes$3(o);case 6:case 273:case 33:case 132:return port2bytes$3(parseInt(o,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes$3(o);case 421:return mh2bytes$3(o);case 444:return onion2bytes$3(o);case 445:return onion32bytes$3(o);case 466:return mb2bytes$3(o);default:return fromString$8(o,"base16")}}const decoders$3=Object.values(bases$2).map(_=>_.decoder),anybaseDecoder$3=function(){let _=decoders$3[0].or(decoders$3[1]);return decoders$3.slice(2).forEach(o=>_=_.or(o)),_}();function ip2bytes$3(_){if(!isIP(_))throw new Error("invalid ip address");return toBytes$4(_)}function bytes2ip$3(_){const o=toString$5(_,0,_.length);if(o==null)throw new Error("ipBuff is required");if(!isIP(o))throw new Error("invalid ip address");return o}function port2bytes$3(_){const o=new ArrayBuffer(2);return new DataView(o).setUint16(0,_),new Uint8Array(o)}function bytes2port$3(_){return new DataView(_.buffer).getUint16(_.byteOffset)}function str2bytes$3(_){const o=fromString$8(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2str$3(_){const o=varint$2.decode(_);if(_=_.slice(varint$2.decode.bytes),_.length!==o)throw new Error("inconsistent lengths");return toString$a(_)}function mh2bytes$3(_){let o;_[0]==="Q"||_[0]==="1"?o=decode$B(base58btc$4.decode(`z${_}`)).bytes:o=CID$3.parse(_).multihash.bytes;const $=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function mb2bytes$3(_){const o=anybaseDecoder$3.decode(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2mb$3(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return"u"+toString$a($,"base64url")}function bytes2mh$3(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return toString$a($,"base58btc")}function onion2bytes$3(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==16)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion address.`);const $=base32$6.decode("b"+o[0]),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes$3(j);return concat$2([$,et],$.length+et.length)}function onion32bytes$3(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==56)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion3 address.`);const $=base32$6.decode(`b${o[0]}`),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes$3(j);return concat$2([$,et],$.length+et.length)}function bytes2onion$3(_){const o=_.slice(0,_.length-2),$=_.slice(_.length-2),j=toString$a(o,"base32"),et=bytes2port$3($);return`${j}:${et}`}function stringToStringTuples$3(_){const o=[],$=_.split("/").slice(1);if($.length===1&&$[0]==="")return[];for(let j=0;j<$.length;j++){const et=$[j],tt=getProtocol$3(et);if(tt.size===0){o.push([et]);continue}if(j++,j>=$.length)throw ParseError$3("invalid address: "+_);if(tt.path===!0){o.push([et,cleanPath$3($.slice(j).join("/"))]);break}o.push([et,$[j]])}return o}function stringTuplesToString$3(_){const o=[];return _.map($=>{const j=protoFromTuple$3($);return o.push(j.name),$.length>1&&$[1]!=null&&o.push($[1]),null}),cleanPath$3(o.join("/"))}function stringTuplesToTuples$3(_){return _.map(o=>{Array.isArray(o)||(o=[o]);const $=protoFromTuple$3(o);return o.length>1?[$.code,convertToBytes$3($.code,o[1])]:[$.code]})}function tuplesToStringTuples$3(_){return _.map(o=>{const $=protoFromTuple$3(o);return o[1]!=null?[$.code,convertToString$4($.code,o[1])]:[$.code]})}function tuplesToBytes$3(_){return fromBytes$4(concat$2(_.map(o=>{const $=protoFromTuple$3(o);let j=Uint8Array.from(varint$2.encode($.code));return o.length>1&&o[1]!=null&&(j=concat$2([j,o[1]])),j})))}function sizeForAddr$3(_,o){return _.size>0?_.size/8:_.size===0?0:varint$2.decode(o)+(varint$2.decode.bytes??0)}function bytesToTuples$3(_){const o=[];let $=0;for(;$<_.length;){const j=varint$2.decode(_,$),et=varint$2.decode.bytes??0,tt=getProtocol$3(j),rt=sizeForAddr$3(tt,_.slice($+et));if(rt===0){o.push([j]),$+=et;continue}const nt=_.slice($+et,$+et+rt);if($+=rt+et,$>_.length)throw ParseError$3("Invalid address Uint8Array: "+toString$a(_,"base16"));o.push([j,nt])}return o}function bytesToString$3(_){const o=bytesToTuples$3(_),$=tuplesToStringTuples$3(o);return stringTuplesToString$3($)}function stringToBytes$3(_){_=cleanPath$3(_);const o=stringToStringTuples$3(_),$=stringTuplesToTuples$3(o);return tuplesToBytes$3($)}function fromString$3(_){return stringToBytes$3(_)}function fromBytes$4(_){const o=validateBytes$3(_);if(o!=null)throw o;return Uint8Array.from(_)}function validateBytes$3(_){try{bytesToTuples$3(_)}catch(o){return o}}function cleanPath$3(_){return"/"+_.trim().split("/").filter(o=>o).join("/")}function ParseError$3(_){return new Error("Error parsing address: "+_)}function protoFromTuple$3(_){return getProtocol$3(_[0])}var __classPrivateFieldGet$4=globalThis&&globalThis.__classPrivateFieldGet||function(_,o,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?_!==o||!j:!o.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:o.get(_)},__classPrivateFieldSet$3=globalThis&&globalThis.__classPrivateFieldSet||function(_,o,$,j,et){if(j==="m")throw new TypeError("Private method is not writable");if(j==="a"&&!et)throw new TypeError("Private accessor was defined without a setter");if(typeof o=="function"?_!==o||!et:!o.has(_))throw new TypeError("Cannot write private member to an object whose class did not declare it");return j==="a"?et.call(_,$):et?et.value=$:o.set(_,$),$},_DefaultMultiaddr_string$3,_DefaultMultiaddr_tuples$3,_DefaultMultiaddr_stringTuples$3,_a$3;const inspect$4=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES$3=[getProtocol$3("dns").code,getProtocol$3("dns4").code,getProtocol$3("dns6").code,getProtocol$3("dnsaddr").code],resolvers$4=new Map,symbol$8=Symbol.for("@multiformats/js-multiaddr/multiaddr");function fromNodeAddress(_,o){if(_==null)throw new Error("requires node address object");if(o==null)throw new Error("requires transport protocol");let $,j=_.address;switch(_.family){case 4:$="ip4";break;case 6:if($="ip6",j.includes("%")){const et=j.split("%");if(et.length!==2)throw Error("Multiple ip6 zones in multiaddr");j=et[0],$=`/ip6zone/${et[1]}/ip6`}break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new DefaultMultiaddr$3("/"+[$,j,o,_.port].join("/"))}function isName(_){return isMultiaddr$3(_)?_.protos().some(o=>o.resolvable):!1}function isMultiaddr$3(_){return!!(_!=null&&_[symbol$8])}let DefaultMultiaddr$3=class as{constructor(o){if(_DefaultMultiaddr_string$3.set(this,void 0),_DefaultMultiaddr_tuples$3.set(this,void 0),_DefaultMultiaddr_stringTuples$3.set(this,void 0),this[_a$3]=!0,o==null&&(o=""),o instanceof Uint8Array)this.bytes=fromBytes$4(o);else if(typeof o=="string"){if(o.length>0&&o.charAt(0)!=="/")throw new Error(`multiaddr "${o}" must start with a "/"`);this.bytes=fromString$3(o)}else if(isMultiaddr$3(o))this.bytes=fromBytes$4(o.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet$4(this,_DefaultMultiaddr_string$3,"f")==null&&__classPrivateFieldSet$3(this,_DefaultMultiaddr_string$3,bytesToString$3(this.bytes),"f"),__classPrivateFieldGet$4(this,_DefaultMultiaddr_string$3,"f")}toJSON(){return this.toString()}toOptions(){let o,$,j,et,tt="";const rt=getProtocol$3("tcp"),nt=getProtocol$3("udp"),it=getProtocol$3("ip4"),st=getProtocol$3("ip6"),ot=getProtocol$3("dns6"),at=getProtocol$3("ip6zone");for(const[ut,ft]of this.stringTuples())ut===at.code&&(tt=`%${ft??""}`),DNS_CODES$3.includes(ut)&&($=rt.name,et=443,j=`${ft??""}${tt}`,o=ut===ot.code?6:4),(ut===rt.code||ut===nt.code)&&($=getProtocol$3(ut).name,et=parseInt(ft??"")),(ut===it.code||ut===st.code)&&($=getProtocol$3(ut).name,j=`${ft??""}${tt}`,o=ut===st.code?6:4);if(o==null||$==null||j==null||et==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:o,host:j,transport:$,port:et}}protos(){return this.protoCodes().map(o=>Object.assign({},getProtocol$3(o)))}protoCodes(){const o=[],$=this.bytes;let j=0;for(;j<$.length;){const et=varint$2.decode($,j),tt=varint$2.decode.bytes??0,rt=getProtocol$3(et),nt=sizeForAddr$3(rt,$.slice(j+tt));j+=nt+tt,o.push(et)}return o}protoNames(){return this.protos().map(o=>o.name)}tuples(){return __classPrivateFieldGet$4(this,_DefaultMultiaddr_tuples$3,"f")==null&&__classPrivateFieldSet$3(this,_DefaultMultiaddr_tuples$3,bytesToTuples$3(this.bytes),"f"),__classPrivateFieldGet$4(this,_DefaultMultiaddr_tuples$3,"f")}stringTuples(){return __classPrivateFieldGet$4(this,_DefaultMultiaddr_stringTuples$3,"f")==null&&__classPrivateFieldSet$3(this,_DefaultMultiaddr_stringTuples$3,tuplesToStringTuples$3(this.tuples()),"f"),__classPrivateFieldGet$4(this,_DefaultMultiaddr_stringTuples$3,"f")}encapsulate(o){return o=new as(o),new as(this.toString()+o.toString())}decapsulate(o){const $=o.toString(),j=this.toString(),et=j.lastIndexOf($);if(et<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${o.toString()}`);return new as(j.slice(0,et))}decapsulateCode(o){const $=this.tuples();for(let j=$.length-1;j>=0;j--)if($[j][0]===o)return new as(tuplesToBytes$3($.slice(0,j)));return this}getPeerId(){try{const $=this.stringTuples().filter(j=>j[0]===names$3.ipfs.code).pop();if(($==null?void 0:$[1])!=null){const j=$[1];return j[0]==="Q"||j[0]==="1"?toString$a(base58btc$4.decode(`z${j}`),"base58btc"):toString$a(CID$3.parse(j).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let o=null;try{o=this.stringTuples().filter($=>getProtocol$3($[0]).path===!0)[0][1],o==null&&(o=null)}catch{o=null}return o}equals(o){return equals$6(this.bytes,o.bytes)}async resolve(o){const $=this.protos().find(tt=>tt.resolvable);if($==null)return[this];const j=resolvers$4.get($.name);if(j==null)throw errCode(new Error(`no available resolver for ${$.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await j(this,o)).map(tt=>new as(tt))}nodeAddress(){const o=this.toOptions();if(o.transport!=="tcp"&&o.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${o.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:o.family,address:o.host,port:o.port}}isThinWaistAddress(o){const $=(o??this).protos();return!($.length!==2||$[0].code!==4&&$[0].code!==41||$[1].code!==6&&$[1].code!==273)}[(_DefaultMultiaddr_string$3=new WeakMap,_DefaultMultiaddr_tuples$3=new WeakMap,_DefaultMultiaddr_stringTuples$3=new WeakMap,_a$3=symbol$8,inspect$4)](){return`Multiaddr(${bytesToString$3(this.bytes)})`}};function multiaddr$3(_){return new DefaultMultiaddr$3(_)}const isV4$2=isIPv4,isV6$2=isIPv6,toBytes$3=function(_){let o=0;if(_=_.toString().trim(),isV4$2(_)){const $=new Uint8Array(o+4);return _.split(/\./g).forEach(j=>{$[o++]=parseInt(j,10)&255}),$}if(isV6$2(_)){const $=_.split(":",8);let j;for(j=0;j<$.length;j++){const tt=isV4$2($[j]);let rt;tt&&(rt=toBytes$3($[j]),$[j]=toString$a(rt.slice(0,2),"base16")),rt!=null&&++j<8&&$.splice(j,0,toString$a(rt.slice(2,4),"base16"))}if($[0]==="")for(;$.length<8;)$.unshift("0");else if($[$.length-1]==="")for(;$.length<8;)$.push("0");else if($.length<8){for(j=0;j<$.length&&$[j]!=="";j++);const tt=[j,1];for(j=9-$.length;j>0;j--)tt.push("0");$.splice.apply($,tt)}const et=new Uint8Array(o+16);for(j=0;j<$.length;j++){const tt=parseInt($[j],16);et[o++]=tt>>8&255,et[o++]=tt&255}return et}throw new Error("invalid ip address")},toString$4=function(_,o=0,$){o=~~o,$=$??_.length-o;const j=new DataView(_.buffer);if($===4){const et=[];for(let tt=0;tt<$;tt++)et.push(_[o+tt]);return et.join(".")}if($===16){const et=[];for(let tt=0;tt<$;tt+=2)et.push(j.getUint16(o+tt).toString(16));return et.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V$2=-1,names$2={},codes$5={},table$2=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$2,"ip6zone"],[43,8,"ipcidr"],[53,V$2,"dns",!0],[54,V$2,"dns4",!0],[55,V$2,"dns6",!0],[56,V$2,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$2,"unix",!1,!0],[421,V$2,"ipfs"],[421,V$2,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$2,"garlic64"],[448,0,"tls"],[449,V$2,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V$2,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$2,"memory"]];table$2.forEach(_=>{const o=createProtocol$2(..._);codes$5[o.code]=o,names$2[o.name]=o});function createProtocol$2(_,o,$,j,et){return{code:_,size:o,name:$,resolvable:!!j,path:!!et}}function getProtocol$2(_){if(typeof _=="number"){if(codes$5[_]!=null)return codes$5[_];throw new Error(`no protocol with code: ${_}`)}else if(typeof _=="string"){if(names$2[_]!=null)return names$2[_];throw new Error(`no protocol with name: ${_}`)}throw new Error(`invalid protocol id type: ${typeof _}`)}function convertToString$3(_,o){switch(getProtocol$2(_).code){case 4:case 41:return bytes2ip$2(o);case 42:return bytes2str$2(o);case 6:case 273:case 33:case 132:return bytes2port$2(o).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str$2(o);case 421:return bytes2mh$2(o);case 444:return bytes2onion$2(o);case 445:return bytes2onion$2(o);case 466:return bytes2mb$2(o);default:return toString$a(o,"base16")}}function convertToBytes$2(_,o){switch(getProtocol$2(_).code){case 4:return ip2bytes$2(o);case 41:return ip2bytes$2(o);case 42:return str2bytes$2(o);case 6:case 273:case 33:case 132:return port2bytes$2(parseInt(o,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes$2(o);case 421:return mh2bytes$2(o);case 444:return onion2bytes$2(o);case 445:return onion32bytes$2(o);case 466:return mb2bytes$2(o);default:return fromString$8(o,"base16")}}const decoders$2=Object.values(bases$2).map(_=>_.decoder),anybaseDecoder$2=function(){let _=decoders$2[0].or(decoders$2[1]);return decoders$2.slice(2).forEach(o=>_=_.or(o)),_}();function ip2bytes$2(_){if(!isIP(_))throw new Error("invalid ip address");return toBytes$3(_)}function bytes2ip$2(_){const o=toString$4(_,0,_.length);if(o==null)throw new Error("ipBuff is required");if(!isIP(o))throw new Error("invalid ip address");return o}function port2bytes$2(_){const o=new ArrayBuffer(2);return new DataView(o).setUint16(0,_),new Uint8Array(o)}function bytes2port$2(_){return new DataView(_.buffer).getUint16(_.byteOffset)}function str2bytes$2(_){const o=fromString$8(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2str$2(_){const o=varint$2.decode(_);if(_=_.slice(varint$2.decode.bytes),_.length!==o)throw new Error("inconsistent lengths");return toString$a(_)}function mh2bytes$2(_){let o;_[0]==="Q"||_[0]==="1"?o=decode$B(base58btc$4.decode(`z${_}`)).bytes:o=CID$3.parse(_).multihash.bytes;const $=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function mb2bytes$2(_){const o=anybaseDecoder$2.decode(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2mb$2(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return"u"+toString$a($,"base64url")}function bytes2mh$2(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return toString$a($,"base58btc")}function onion2bytes$2(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==16)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion address.`);const $=base32$6.decode("b"+o[0]),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes$2(j);return concat$2([$,et],$.length+et.length)}function onion32bytes$2(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==56)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion3 address.`);const $=base32$6.decode(`b${o[0]}`),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes$2(j);return concat$2([$,et],$.length+et.length)}function bytes2onion$2(_){const o=_.slice(0,_.length-2),$=_.slice(_.length-2),j=toString$a(o,"base32"),et=bytes2port$2($);return`${j}:${et}`}function stringToStringTuples$2(_){const o=[],$=_.split("/").slice(1);if($.length===1&&$[0]==="")return[];for(let j=0;j<$.length;j++){const et=$[j],tt=getProtocol$2(et);if(tt.size===0){o.push([et]);continue}if(j++,j>=$.length)throw ParseError$2("invalid address: "+_);if(tt.path===!0){o.push([et,cleanPath$2($.slice(j).join("/"))]);break}o.push([et,$[j]])}return o}function stringTuplesToString$2(_){const o=[];return _.map($=>{const j=protoFromTuple$2($);return o.push(j.name),$.length>1&&$[1]!=null&&o.push($[1]),null}),cleanPath$2(o.join("/"))}function stringTuplesToTuples$2(_){return _.map(o=>{Array.isArray(o)||(o=[o]);const $=protoFromTuple$2(o);return o.length>1?[$.code,convertToBytes$2($.code,o[1])]:[$.code]})}function tuplesToStringTuples$2(_){return _.map(o=>{const $=protoFromTuple$2(o);return o[1]!=null?[$.code,convertToString$3($.code,o[1])]:[$.code]})}function tuplesToBytes$2(_){return fromBytes$3(concat$2(_.map(o=>{const $=protoFromTuple$2(o);let j=Uint8Array.from(varint$2.encode($.code));return o.length>1&&o[1]!=null&&(j=concat$2([j,o[1]])),j})))}function sizeForAddr$2(_,o){return _.size>0?_.size/8:_.size===0?0:varint$2.decode(o)+(varint$2.decode.bytes??0)}function bytesToTuples$2(_){const o=[];let $=0;for(;$<_.length;){const j=varint$2.decode(_,$),et=varint$2.decode.bytes??0,tt=getProtocol$2(j),rt=sizeForAddr$2(tt,_.slice($+et));if(rt===0){o.push([j]),$+=et;continue}const nt=_.slice($+et,$+et+rt);if($+=rt+et,$>_.length)throw ParseError$2("Invalid address Uint8Array: "+toString$a(_,"base16"));o.push([j,nt])}return o}function bytesToString$2(_){const o=bytesToTuples$2(_),$=tuplesToStringTuples$2(o);return stringTuplesToString$2($)}function stringToBytes$2(_){_=cleanPath$2(_);const o=stringToStringTuples$2(_),$=stringTuplesToTuples$2(o);return tuplesToBytes$2($)}function fromString$2(_){return stringToBytes$2(_)}function fromBytes$3(_){const o=validateBytes$2(_);if(o!=null)throw o;return Uint8Array.from(_)}function validateBytes$2(_){try{bytesToTuples$2(_)}catch(o){return o}}function cleanPath$2(_){return"/"+_.trim().split("/").filter(o=>o).join("/")}function ParseError$2(_){return new Error("Error parsing address: "+_)}function protoFromTuple$2(_){return getProtocol$2(_[0])}var __classPrivateFieldGet$3=globalThis&&globalThis.__classPrivateFieldGet||function(_,o,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?_!==o||!j:!o.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:o.get(_)},__classPrivateFieldSet$2=globalThis&&globalThis.__classPrivateFieldSet||function(_,o,$,j,et){if(j==="m")throw new TypeError("Private method is not writable");if(j==="a"&&!et)throw new TypeError("Private accessor was defined without a setter");if(typeof o=="function"?_!==o||!et:!o.has(_))throw new TypeError("Cannot write private member to an object whose class did not declare it");return j==="a"?et.call(_,$):et?et.value=$:o.set(_,$),$},_DefaultMultiaddr_string$2,_DefaultMultiaddr_tuples$2,_DefaultMultiaddr_stringTuples$2,_a$2;const inspect$3=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES$2=[getProtocol$2("dns").code,getProtocol$2("dns4").code,getProtocol$2("dns6").code,getProtocol$2("dnsaddr").code],resolvers$3=new Map,symbol$7=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr$2(_){return!!(_!=null&&_[symbol$7])}let DefaultMultiaddr$2=class cs{constructor(o){if(_DefaultMultiaddr_string$2.set(this,void 0),_DefaultMultiaddr_tuples$2.set(this,void 0),_DefaultMultiaddr_stringTuples$2.set(this,void 0),this[_a$2]=!0,o==null&&(o=""),o instanceof Uint8Array)this.bytes=fromBytes$3(o);else if(typeof o=="string"){if(o.length>0&&o.charAt(0)!=="/")throw new Error(`multiaddr "${o}" must start with a "/"`);this.bytes=fromString$2(o)}else if(isMultiaddr$2(o))this.bytes=fromBytes$3(o.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_string$2,"f")==null&&__classPrivateFieldSet$2(this,_DefaultMultiaddr_string$2,bytesToString$2(this.bytes),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_string$2,"f")}toJSON(){return this.toString()}toOptions(){let o,$,j,et,tt="";const rt=getProtocol$2("tcp"),nt=getProtocol$2("udp"),it=getProtocol$2("ip4"),st=getProtocol$2("ip6"),ot=getProtocol$2("dns6"),at=getProtocol$2("ip6zone");for(const[ut,ft]of this.stringTuples())ut===at.code&&(tt=`%${ft??""}`),DNS_CODES$2.includes(ut)&&($=rt.name,et=443,j=`${ft??""}${tt}`,o=ut===ot.code?6:4),(ut===rt.code||ut===nt.code)&&($=getProtocol$2(ut).name,et=parseInt(ft??"")),(ut===it.code||ut===st.code)&&($=getProtocol$2(ut).name,j=`${ft??""}${tt}`,o=ut===st.code?6:4);if(o==null||$==null||j==null||et==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:o,host:j,transport:$,port:et}}protos(){return this.protoCodes().map(o=>Object.assign({},getProtocol$2(o)))}protoCodes(){const o=[],$=this.bytes;let j=0;for(;j<$.length;){const et=varint$2.decode($,j),tt=varint$2.decode.bytes??0,rt=getProtocol$2(et),nt=sizeForAddr$2(rt,$.slice(j+tt));j+=nt+tt,o.push(et)}return o}protoNames(){return this.protos().map(o=>o.name)}tuples(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_tuples$2,"f")==null&&__classPrivateFieldSet$2(this,_DefaultMultiaddr_tuples$2,bytesToTuples$2(this.bytes),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_tuples$2,"f")}stringTuples(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_stringTuples$2,"f")==null&&__classPrivateFieldSet$2(this,_DefaultMultiaddr_stringTuples$2,tuplesToStringTuples$2(this.tuples()),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_stringTuples$2,"f")}encapsulate(o){return o=new cs(o),new cs(this.toString()+o.toString())}decapsulate(o){const $=o.toString(),j=this.toString(),et=j.lastIndexOf($);if(et<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${o.toString()}`);return new cs(j.slice(0,et))}decapsulateCode(o){const $=this.tuples();for(let j=$.length-1;j>=0;j--)if($[j][0]===o)return new cs(tuplesToBytes$2($.slice(0,j)));return this}getPeerId(){try{const $=this.stringTuples().filter(j=>j[0]===names$2.ipfs.code).pop();if(($==null?void 0:$[1])!=null){const j=$[1];return j[0]==="Q"||j[0]==="1"?toString$a(base58btc$4.decode(`z${j}`),"base58btc"):toString$a(CID$3.parse(j).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let o=null;try{o=this.stringTuples().filter($=>getProtocol$2($[0]).path===!0)[0][1],o==null&&(o=null)}catch{o=null}return o}equals(o){return equals$6(this.bytes,o.bytes)}async resolve(o){const $=this.protos().find(tt=>tt.resolvable);if($==null)return[this];const j=resolvers$3.get($.name);if(j==null)throw errCode(new Error(`no available resolver for ${$.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await j(this,o)).map(tt=>new cs(tt))}nodeAddress(){const o=this.toOptions();if(o.transport!=="tcp"&&o.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${o.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:o.family,address:o.host,port:o.port}}isThinWaistAddress(o){const $=(o??this).protos();return!($.length!==2||$[0].code!==4&&$[0].code!==41||$[1].code!==6&&$[1].code!==273)}[(_DefaultMultiaddr_string$2=new WeakMap,_DefaultMultiaddr_tuples$2=new WeakMap,_DefaultMultiaddr_stringTuples$2=new WeakMap,_a$2=symbol$7,inspect$3)](){return`Multiaddr(${bytesToString$2(this.bytes)})`}};function multiaddr$2(_){return new DefaultMultiaddr$2(_)}const DNS4=base("dns4"),DNS6=base("dns6"),DNSADDR=base("dnsaddr"),DNS=or(base("dns"),DNSADDR,DNS4,DNS6),IP=or(base("ip4"),base("ip6")),TCP=or(and(IP,base("tcp")),and(DNS,base("tcp"))),UDP=and(IP,base("udp")),UTP=and(UDP,base("utp")),QUIC=and(UDP,base("quic")),WebSockets$1=or(and(TCP,base("ws")),and(DNS,base("ws"))),WebSocketsSecure=or(and(TCP,base("wss")),and(DNS,base("wss")),and(TCP,base("tls"),base("ws")),and(DNS,base("tls"),base("ws"))),HTTP$1=or(and(TCP,base("http")),and(IP,base("http")),and(DNS,base("http"))),HTTPS=or(and(TCP,base("https")),and(IP,base("https")),and(DNS,base("https"))),_WebRTC=and(UDP,base("webrtc"),base("certhash")),WebRTC=or(and(_WebRTC,base("p2p")),_WebRTC),WebRTCStar$1=or(and(WebSockets$1,base("p2p-webrtc-star"),base("p2p")),and(WebSocketsSecure,base("p2p-webrtc-star"),base("p2p")),and(WebSockets$1,base("p2p-webrtc-star")),and(WebSocketsSecure,base("p2p-webrtc-star"))),WebRTCDirect=or(and(HTTP$1,base("p2p-webrtc-direct"),base("p2p")),and(HTTPS,base("p2p-webrtc-direct"),base("p2p")),and(HTTP$1,base("p2p-webrtc-direct")),and(HTTPS,base("p2p-webrtc-direct"))),Reliable=or(WebSockets$1,WebSocketsSecure,HTTP$1,HTTPS,WebRTCStar$1,WebRTCDirect,TCP,UTP,QUIC,DNS,WebRTC),_P2P=or(and(Reliable,base("p2p")),WebRTCStar$1,WebRTCDirect,WebRTC,base("p2p")),_Circuit=or(and(_P2P,base("p2p-circuit"),_P2P),and(_P2P,base("p2p-circuit")),and(base("p2p-circuit"),_P2P),and(Reliable,base("p2p-circuit")),and(base("p2p-circuit"),Reliable),base("p2p-circuit")),CircuitRecursive=()=>or(and(_Circuit,CircuitRecursive),_Circuit),Circuit$1=CircuitRecursive(),P2P=or(and(Circuit$1,_P2P,Circuit$1),and(_P2P,Circuit$1),and(Circuit$1,_P2P),Circuit$1,_P2P),IPFS$1=P2P;function makeMatchesFunction(_){function o($){let j;try{j=multiaddr$2($)}catch{return!1}const et=_(j.protoNames());return et===null?!1:et===!0||et===!1?et:et.length===0}return o}function and(..._){function o($){if($.length<_.length)return null;let j=$;return _.some(et=>(j=typeof et=="function"?et().partialMatch($):et.partialMatch($),Array.isArray(j)&&($=j),j===null)),j}return{toString:function(){return"{ "+_.join(" ")+" }"},input:_,matches:makeMatchesFunction(o),partialMatch:o}}function or(..._){function o(j){let et=null;return _.some(tt=>{const rt=typeof tt=="function"?tt().partialMatch(j):tt.partialMatch(j);return rt!=null?(et=rt,!0):!1}),et}return{toString:function(){return"{ "+_.join(" ")+" }"},input:_,matches:makeMatchesFunction(o),partialMatch:o}}function base(_){const o=_;function $(et){let tt;try{tt=multiaddr$2(et)}catch{return!1}const rt=tt.protoNames();return rt.length===1&&rt[0]===o}function j(et){return et.length===0?null:et[0]===o?et.slice(1):null}return{toString:function(){return o},matches:$,partialMatch:j}}const isReactNative$1=typeof navigator<"u"&&navigator.product==="ReactNative";function getDefaultBase(){return isReactNative$1?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const URL$2=self.URL,defaultBase$1=getDefaultBase();let URLWithLegacySupport$2=class{constructor(o="",$=defaultBase$1){this.super=new URL$2(o,$),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(o){this.super.hash=o}set host(o){this.super.host=o}set hostname(o){this.super.hostname=o}set href(o){this.super.href=o}set password(o){this.super.password=o}set pathname(o){this.super.pathname=o}set port(o){this.super.port=o}set protocol(o){this.super.protocol=o}set search(o){this.super.search=o}set username(o){this.super.username=o}static createObjectURL(o){return URL$2.createObjectURL(o)}static revokeObjectURL(o){URL$2.revokeObjectURL(o)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function format$4(_){if(typeof _=="string")return new URL$2(_).toString();if(!(_ instanceof URL$2)){const o=_.username&&_.password?`${_.username}:${_.password}@`:"",$=_.auth?_.auth+"@":"",j=_.port?":"+_.port:"",et=_.protocol?_.protocol+"//":"",tt=_.host||"",rt=_.hostname||"",nt=_.search||(_.query?"?"+_.query:""),it=_.hash||"",st=_.pathname||"",ot=_.path||st+nt;return`${et}${o||$}${tt||rt+j}${ot}${it}`}}var urlBrowser={URLWithLegacySupport:URLWithLegacySupport$2,URLSearchParams:self.URLSearchParams,defaultBase:defaultBase$1,format:format$4};const{URLWithLegacySupport:URLWithLegacySupport$1,format:format$3}=urlBrowser;var relative$1=(_,o={},$={},j)=>{let et=o.protocol?o.protocol.replace(":",""):"http";et=($[et]||j||et)+":";let tt;try{tt=new URLWithLegacySupport$1(_)}catch{tt={}}const rt=Object.assign({},o,{protocol:et||tt.protocol,host:o.host||tt.host});return new URLWithLegacySupport$1(_,format$3(rt)).toString()};const{URLWithLegacySupport,format:format$2,URLSearchParams:URLSearchParams$2,defaultBase}=urlBrowser,relative=relative$1;var isoUrl={URL:URLWithLegacySupport,URLSearchParams:URLSearchParams$2,format:format$2,relative,defaultBase};const pathPattern=/^\/(ip[fn]s)\/([^/?#]+)/,defaultProtocolMatch=1,defaultHashMath=2,subdomainGatewayPattern=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,fqdnWithTld=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function isCID$1(_){try{return isString(_)?!!CID$3.parse(_):_ instanceof Uint8Array?!!CID$3.decode(_):!!CID$3.asCID(_)}catch{return!1}}function isIpfs(_,o,$=defaultProtocolMatch,j=defaultHashMath){const et=convertToString$2(_);if(et===!1)return!1;const tt=et.match(o);if(tt==null||tt[$]!=="ipfs")return!1;let rt=tt[j];return rt!=null&&o===subdomainGatewayPattern&&(rt=rt.toLowerCase()),isCID$1(rt)}function isIpns(_,o,$=defaultProtocolMatch,j=defaultHashMath){const et=convertToString$2(_);if(et===!1)return!1;const tt=et.match(o);if(tt==null||tt[$]!=="ipns")return!1;let rt=tt[j];if(rt!=null&&o===subdomainGatewayPattern){if(rt=rt.toLowerCase(),isCID$1(rt))return!0;try{!rt.includes(".")&&rt.includes("-")&&(rt=rt.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:nt}=new isoUrl.URL(`http://${rt}`);return fqdnWithTld.test(nt)}catch{return!1}}return!0}function isString(_){return typeof _=="string"}function convertToString$2(_){return _ instanceof Uint8Array?toString$a(_,"base58btc"):isString(_)?_:!1}const path=_=>isIpfs(_,pathPattern)||isIpns(_,pathPattern),ipfsPath$1=_=>isIpfs(_,pathPattern),ipnsPath=_=>isIpns(_,pathPattern);let nanoid=(_=21)=>crypto.getRandomValues(new Uint8Array(_)).reduce((o,$)=>($&=63,$<36?o+=$.toString(36):$<62?o+=($-26).toString(36).toUpperCase():$>62?o+="-":o+="_",o),"");const pathSepS="/",pathSepB=new TextEncoder().encode(pathSepS),pathSep=pathSepB[0];class Key{constructor(o,$){if(typeof o=="string")this._buf=fromString$8(o);else if(o instanceof Uint8Array)this._buf=o;else throw new Error("Invalid key, should be String of Uint8Array");if($==null&&($=!0),$&&this.clean(),this._buf.byteLength===0||this._buf[0]!==pathSep)throw new Error("Invalid key")}toString(o="utf8"){return toString$a(this._buf,o)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(o){return new Key(o.join(pathSepS))}static random(){return new Key(nanoid().replace(/-/g,""))}static asKey(o){return o instanceof Uint8Array||typeof o=="string"?new Key(o):typeof o.uint8Array=="function"?new Key(o.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=pathSepB),this._buf[0]!==pathSep){const o=new Uint8Array(this._buf.byteLength+1);o.fill(pathSep,0,1),o.set(this._buf,1),this._buf=o}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===pathSep;)this._buf=this._buf.subarray(0,-1)}less(o){const $=this.list(),j=o.list();for(let et=0;et<$.length;et++){if(j.length<et+1)return!1;const tt=$[et],rt=j[et];if(tt<rt)return!0;if(tt>rt)return!1}return $.length<j.length}reverse(){return Key.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const o=this.namespaces();return o[o.length-1]}list(){return this.toString().split(pathSepS).slice(1)}type(){return namespaceType(this.baseNamespace())}name(){return namespaceValue(this.baseNamespace())}instance(o){return new Key(this.toString()+":"+o)}path(){let o=this.parent().toString();return o.endsWith(pathSepS)||(o+=pathSepS),o+=this.type(),new Key(o)}parent(){const o=this.list();return o.length===1?new Key(pathSepS):new Key(o.slice(0,-1).join(pathSepS))}child(o){return this.toString()===pathSepS?o:o.toString()===pathSepS?this:new Key(this.toString()+o.toString(),!1)}isAncestorOf(o){return o.toString()===this.toString()?!1:o.toString().startsWith(this.toString())}isDecendantOf(o){return o.toString()===this.toString()?!1:this.toString().startsWith(o.toString())}isTopLevel(){return this.list().length===1}concat(...o){return Key.withNamespaces([...this.namespaces(),...flatten(o.map($=>$.namespaces()))])}}function namespaceType(_){const o=_.split(":");return o.length<2?"":o.slice(0,-1).join(":")}function namespaceValue(_){const o=_.split(":");return o[o.length-1]}function flatten(_){return[].concat(..._)}var anySignalExports={},anySignal$2={get exports(){return anySignalExports},set exports(_){anySignalExports=_}};function anySignal$1(_){const o=new globalThis.AbortController;function $(){o.abort();for(const j of _)!j||!j.removeEventListener||j.removeEventListener("abort",$)}for(const j of _)if(!(!j||!j.addEventListener)){if(j.aborted){$();break}j.addEventListener("abort",$)}return o.signal}anySignal$2.exports=anySignal$1;var anySignal_2=anySignalExports.anySignal=anySignal$1;let durationRE=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;parse$4.nanosecond=parse$4.ns=1/1e6;parse$4.s=parse$4.s=parse$4.us=parse$4.microsecond=1/1e3;parse$4.millisecond=parse$4.ms=parse$4[""]=1;parse$4.second=parse$4.sec=parse$4.s=parse$4.ms*1e3;parse$4.minute=parse$4.min=parse$4.m=parse$4.s*60;parse$4.hour=parse$4.hr=parse$4.h=parse$4.m*60;parse$4.day=parse$4.d=parse$4.h*24;parse$4.week=parse$4.wk=parse$4.w=parse$4.d*7;parse$4.month=parse$4.b=parse$4.d*(365.25/12);parse$4.year=parse$4.yr=parse$4.y=parse$4.d*365.25;function parse$4(_="",o="ms"){var $=null;return _=(_+"").replace(/(\d)[,_](\d)/g,"$1$2"),_.replace(durationRE,function(j,et,tt){tt=unitRatio(tt),tt&&($=($||0)+parseFloat(et,10)*tt)}),$&&$/(unitRatio(o)||1)}function unitRatio(_){return parse$4[_]||parse$4[_.toLowerCase().replace(/s$/,"")]}let TimeoutError$5=class Mo extends Error{constructor(o="request timed out"){super(o),this.name="TimeoutError",this.code=Mo.code}};TimeoutError$5.code="ERR_TIMEOUT";function withTimeoutOption(_,o){return(...$)=>{const j=$[o??$.length-1];if(!j||!j.timeout)return _(...$);const et=typeof j.timeout=="string"?parse$4(j.timeout):j.timeout,tt=new timeoutAbortController.TimeoutController(et);j.signal=anySignal_2([j.signal,tt.signal]);const rt=_(...$),nt=new Promise((ot,at)=>{tt.signal.addEventListener("abort",()=>{at(new TimeoutError$5)})}),it=Date.now(),st=()=>{if(tt.signal.aborted)throw new TimeoutError$5;if(Date.now()-it>et)throw tt.abort(),new TimeoutError$5};return rt[Symbol.asyncIterator]?async function*(){const ot=rt[Symbol.asyncIterator]();try{for(;;){const{value:at,done:ct}=await Promise.race([ot.next(),nt]);if(ct)break;st(),yield at}}catch(at){throw st(),at}finally{tt.clear(),ot.return&&ot.return()}}():(async()=>{try{const ot=await Promise.race([rt,nt]);return st(),ot}catch(ot){throw st(),ot}finally{tt.clear()}})()}}const IPFS_PREFIX$1="/ipfs/";function toCidAndPath(_){if(_ instanceof Uint8Array)try{_=CID$3.decode(_)}catch(et){throw errCode(et,"ERR_INVALID_CID")}let o=CID$3.asCID(_);if(o)return{cid:o,path:void 0};_=_.toString(),_.startsWith(IPFS_PREFIX$1)&&(_=_.substring(IPFS_PREFIX$1.length));const $=_.split("/");let j;try{o=CID$3.parse($.shift()||"")}catch(et){throw errCode(et,"ERR_INVALID_CID")}return $.length&&(j=`/${$.join("/")}`),{cid:o,path:j}}const ERR_BAD_PATH="ERR_BAD_PATH",OFFLINE_ERROR="This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY$2=new Key("/local/filesroot"),MFS_MAX_CHUNK_SIZE=262144,normalizePath=_=>{if(CID$3.asCID(_))return`/ipfs/${_}`;const $=_.toString();try{return`/ipfs/${CID$3.parse($)}`}catch{}if(path($))return $;throw errCode(new Error(`invalid path: ${_}`),ERR_BAD_PATH)},normalizeCidPath=_=>_ instanceof Uint8Array?CID$3.decode(_).toString():(_=_.toString(),_.indexOf("/ipfs/")===0&&(_=_.substring(6)),_.charAt(_.length-1)==="/"&&(_=_.substring(0,_.length-1)),_),resolvePath$1=async function(_,o,$,j={}){const{cid:et,path:tt}=toCidAndPath($);tt&&(j.path=tt);let rt=et,nt=j.path||"";if(nt.startsWith("/")&&(nt=nt.substring(1)),j.path)try{for await(const{value:it,remainderPath:st}of resolve$5(et,j.path,o,_,{signal:j.signal})){if(!CID$3.asCID(it))break;nt=st,rt=it}}catch(it){throw it.message.startsWith("Object has no property")&&(it.message=`no link named "${nt.split("/")[0]}" under ${rt}`,it.code="ERR_NO_LINK"),it}return{cid:rt,remainderPath:nt||""}},mapFile=_=>{if(_.type!=="file"&&_.type!=="directory"&&_.type!=="raw")throw new Error(`Unknown node type '${_.type}'`);const o={cid:_.cid,path:_.path,name:_.name,size:_.size,type:"file"};return _.type==="directory"&&(o.type="dir"),_.type==="file"&&(o.size=_.unixfs.fileSize()),(_.type==="file"||_.type==="directory")&&(o.mode=_.unixfs.mode,_.unixfs.mtime!==void 0&&(o.mtime=_.unixfs.mtime)),o},withTimeout=withTimeoutOption(async(_,o)=>await _),resolve$5=async function*(_,o,$,j,et){const tt=async st=>{const ot=await $.getCodec(st.code),at=await j.blocks.get(st,et);return ot.decode(at)},rt=o.split("/").filter(Boolean);let nt=await tt(_),it=_;for(;rt.length;){const st=rt.shift();if(!st)throw errCode(new Error(`Could not resolve path "${o}"`),"ERR_INVALID_PATH");if(_.code===code$9&&Array.isArray(nt.Links)){const ot=nt.Links.find(at=>at.Name===st);if(ot){yield{value:ot.Hash,remainderPath:rt.join("/")},nt=await tt(ot.Hash),it=ot.Hash;continue}}if(Object.prototype.hasOwnProperty.call(nt,st))nt=nt[st],yield{value:nt,remainderPath:rt.join("/")};else throw errCode(new Error(`no link named "${st}" under ${it}`),"ERR_NO_LINK");CID$3.asCID(nt)&&(it=nt,nt=await tt(nt))}yield{value:nt,remainderPath:""}};class Service{static create({start:o,stop:$}){return new Service(o,$)}static async start(o,$){const{state:j,activate:et}=o;switch(j.status){case"stopped":try{const tt=et($);o.state={status:"starting",ready:tt};const rt=await tt;return o.state={status:"started",value:rt},rt}catch(tt){throw o.state={status:"stopped"},tt}case"starting":throw new AlreadyStartingError;case"started":throw new AlreadyStartedError;case"stopping":return await j.ready,await Service.start(o,$);default:return Service.panic(o)}}static async stop(o){const{state:$,deactivate:j}=o;switch($.status){case"stopped":break;case"starting":{try{await $.ready}catch{}return await Service.stop(o)}case"stopping":return await $.ready;case"started":{j&&await j($.value),o.state={status:"stopped"};break}default:Service.panic($)}}static try({state:o}){switch(o.status){case"started":return o.value;default:return null}}static async use({state:o},$){switch(o.status){case"started":return o.value;case"starting":return await withTimeout(o.ready,$);default:throw new NotStartedError}}static panic({state:o}){const $=JSON.stringify({status:o.status});throw RangeError(`Service in invalid state ${$}, should never happen if you see this please report a bug`)}constructor(o,$){this.activate=o,this.deactivate=$,this.state={status:"stopped"}}async use(o){return await Service.use(this,o)}try(){return Service.try(this)}}function createStart$1({network:_,preload:o,peerId:$,keychain:j,repo:et,ipns:tt,mfsPreload:rt,print:nt,hashers:it,options:st}){return async()=>{const{libp2p:at}=await Service.start(_,{peerId:$,repo:et,print:nt,hashers:it,options:st});await Promise.all([tt.startOnline({keychain:j,libp2p:at,peerId:$,repo:et}),o.start(),rt.start()])}}function createStop$1({network:_,preload:o,ipns:$,repo:j,mfsPreload:et}){return async()=>{await Promise.all([o.stop(),$.stop(),et.stop()]),await Service.stop(_),await j.close()}}var hashlru=function(_){if(!_)throw Error("hashlru must have a max value, of type number, greater than 0");var o=0,$=Object.create(null),j=Object.create(null);function et(tt,rt){$[tt]=rt,o++,o>=_&&(o=0,j=$,$=Object.create(null))}return{has:function(tt){return $[tt]!==void 0||j[tt]!==void 0},remove:function(tt){$[tt]!==void 0&&($[tt]=void 0),j[tt]!==void 0&&(j[tt]=void 0)},get:function(tt){var rt=$[tt];if(rt!==void 0)return rt;if((rt=j[tt])!==void 0)return et(tt,rt),rt},set:function(tt,rt){$[tt]!==void 0?$[tt]=rt:et(tt,rt)},clear:function(){$=Object.create(null),j=Object.create(null)}}};let TLRU$1=class{constructor(o){this.lru=hashlru(o)}get(o){const $=this.lru.get(o);if($){if($.expire&&$.expire<Date.now()){this.lru.remove(o);return}return $.value}}set(o,$,j){this.lru.set(o,{value:$,expire:Date.now()+j})}has(o){return!!this.get(o)}remove(o){this.lru.remove(o)}clear(){this.lru.clear()}};var error={};let TimeoutError$4=class extends Error{constructor(o="Request timed out"){super(o),this.name="TimeoutError"}};error.TimeoutError=TimeoutError$4;let AbortError$4=class extends Error{constructor(o="The operation was aborted."){super(o),this.name="AbortError"}};error.AbortError=AbortError$4;let HTTPError$1=class extends Error{constructor(o){super(o.statusText),this.name="HTTPError",this.response=o}};error.HTTPError=HTTPError$1;var fetch_browserExports={},fetch_browser$1={get exports(){return fetch_browserExports},set exports(_){fetch_browserExports=_}},srcExports={},src$3={get exports(){return srcExports},set exports(_){srcExports=_}},browserExports={},browser$2={get exports(){return browserExports},set exports(_){browserExports=_}},hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,function(_,o){var $=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof commonjsGlobal<"u")return commonjsGlobal;throw new Error("unable to locate global object")},j=$();_.exports=o=j.fetch,j.fetch&&(o.default=j.fetch.bind(j)),o.Headers=j.Headers,o.Request=j.Request,o.Response=j.Response}(browser$2,browserExports)),browserExports}globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?src$3.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:src$3.exports={default:requireBrowser().default,Headers:requireBrowser().Headers,Request:requireBrowser().Request,Response:requireBrowser().Response};(function(_){_.exports=srcExports})(fetch_browser$1);const{TimeoutError:TimeoutError$3,AbortError:AbortError$3}=error,{Response:Response$1,Request:Request$2,Headers:Headers$1,default:fetch$2}=fetch_browserExports,fetchWithProgress=(_,o={})=>{const $=new XMLHttpRequest;$.open(o.method||"GET",_.toString(),!0);const{timeout:j,headers:et}=o;if(j&&j>0&&j<1/0&&($.timeout=j),o.overrideMimeType!=null&&$.overrideMimeType(o.overrideMimeType),et)for(const[tt,rt]of new Headers$1(et))$.setRequestHeader(tt,rt);return o.signal&&(o.signal.onabort=()=>$.abort()),o.onUploadProgress&&($.upload.onprogress=o.onUploadProgress),$.responseType="arraybuffer",new Promise((tt,rt)=>{const nt=it=>{switch(it.type){case"error":{tt(Response$1.error());break}case"load":{tt(new ResponseWithURL($.responseURL,$.response,{status:$.status,statusText:$.statusText,headers:parseHeaders($.getAllResponseHeaders())}));break}case"timeout":{rt(new TimeoutError$3);break}case"abort":{rt(new AbortError$3);break}}};$.onerror=nt,$.onload=nt,$.ontimeout=nt,$.onabort=nt,$.send(o.body)})},fetchWithStreaming=fetch$2,fetchWith=(_,o={})=>o.onUploadProgress!=null?fetchWithProgress(_,o):fetchWithStreaming(_,o),parseHeaders=_=>{const o=new Headers$1;for(const $ of _.trim().split(/[\r\n]+/)){const j=$.indexOf(": ");j>0&&o.set($.slice(0,j),$.slice(j+1))}return o};class ResponseWithURL extends Response$1{constructor(o,$,j){super($,j),Object.defineProperty(this,"url",{value:o})}}var fetch_browser={fetch:fetchWith,Request:Request$2,Headers:Headers$1};const require$$2=getAugmentedNamespace(mergeOptions$f);async function*browserReadableStreamToIt$1(_,o={}){const $=_.getReader();try{for(;;){const j=await $.read();if(j.done)return;yield j.value}}finally{o.preventCancel!==!0&&$.cancel(),$.releaseLock()}}var browserReadablestreamToIt=browserReadableStreamToIt$1;const all$3=async _=>{const o=[];for await(const $ of _)o.push($);return o};var itAll=all$3;const{fetch:fetch$1,Request:Request$1,Headers}=fetch_browser,{TimeoutError:TimeoutError$2,HTTPError}=error,merge$2=require$$2.bind({ignoreUndefined:!0}),{URL:URL$1,URLSearchParams:URLSearchParams$1}=isoUrl,anySignal=anySignalExports,browserReableStreamToIt=browserReadablestreamToIt,{isBrowser:isBrowser$1,isWebWorker}=env,all$2=itAll,timeout=(_,o,$)=>{if(o===void 0)return _;const j=Date.now(),et=()=>Date.now()-j>=o;return new Promise((tt,rt)=>{const nt=setTimeout(()=>{et()&&(rt(new TimeoutError$2),$.abort())},o),it=st=>at=>{if(clearTimeout(nt),et()){rt(new TimeoutError$2);return}st(at)};_.then(it(tt),it(rt))})},defaults={throwHttpErrors:!0,credentials:"same-origin"};class HTTP{constructor(o={}){this.opts=merge$2(defaults,o)}async fetch(o,$={}){const j=merge$2(this.opts,$),et=new Headers(j.headers);if(typeof o!="string"&&!(o instanceof URL$1||o instanceof Request$1))throw new TypeError("`resource` must be a string, URL, or Request");const tt=new URL$1(o.toString(),j.base),{searchParams:rt,transformSearchParams:nt,json:it}=j;rt&&(typeof nt=="function"?tt.search=nt(new URLSearchParams$1(j.searchParams)):tt.search=new URLSearchParams$1(j.searchParams)),it&&(j.body=JSON.stringify(j.json),et.set("content-type","application/json"));const st=new AbortController,ot=anySignal([st.signal,j.signal]);globalThis.ReadableStream!=null&&j.body instanceof globalThis.ReadableStream&&(isBrowser$1||isWebWorker)&&(j.body=new Blob(await all$2(browserReableStreamToIt(j.body))));const at=await timeout(fetch$1(tt.toString(),{...j,signal:ot,timeout:void 0,headers:et,duplex:"half"}),j.timeout,st);if(!at.ok&&j.throwHttpErrors)throw j.handleError&&await j.handleError(at),new HTTPError(at);return at.iterator=async function*(){yield*fromStream(at.body)},at.ndjson=async function*(){for await(const ct of ndjson(at.iterator()))$.transform?yield $.transform(ct):yield ct},at}post(o,$={}){return this.fetch(o,{...$,method:"POST"})}get(o,$={}){return this.fetch(o,{...$,method:"GET"})}put(o,$={}){return this.fetch(o,{...$,method:"PUT"})}delete(o,$={}){return this.fetch(o,{...$,method:"DELETE"})}options(o,$={}){return this.fetch(o,{...$,method:"OPTIONS"})}}const ndjson=async function*(_){const o=new TextDecoder;let $="";for await(const j of _){$+=o.decode(j,{stream:!0});const et=$.split(/\r?\n/);for(let tt=0;tt<et.length-1;tt++){const rt=et[tt].trim();rt.length>0&&(yield JSON.parse(rt))}$=et[et.length-1]}$+=o.decode(),$=$.trim(),$.length!==0&&(yield JSON.parse($))},fromStream=_=>{if(isAsyncIterable$2(_))return _;if(isNodeReadableStream(_)){const o=_[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:o.next.bind(o),return($){return _.destroy(),typeof o.return=="function"?o.return():Promise.resolve({done:!0,value:$})}}}}}if(isWebReadableStream(_)){const o=_.getReader();return async function*(){try{for(;;){const{done:$,value:j}=await o.read();if($)return;j&&(yield j)}}finally{o.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},isAsyncIterable$2=_=>typeof _=="object"&&_!==null&&typeof _[Symbol.asyncIterator]=="function",isWebReadableStream=_=>_&&typeof _.getReader=="function",isNodeReadableStream=_=>Object.prototype.hasOwnProperty.call(_,"readable")&&Object.prototype.hasOwnProperty.call(_,"writable");HTTP.HTTPError=HTTPError;HTTP.TimeoutError=TimeoutError$2;HTTP.streamToAsyncIterator=fromStream;HTTP.post=(_,o)=>new HTTP(o).post(_,o);HTTP.get=(_,o)=>new HTTP(o).get(_,o);HTTP.put=(_,o)=>new HTTP(o).put(_,o);HTTP.delete=(_,o)=>new HTTP(o).delete(_,o);HTTP.options=(_,o)=>new HTTP(o).options(_,o);var http=HTTP;const cache$2=new TLRU$1(1e3),ttl=60*1e3,Queue$3=PQueue.default?PQueue.default:PQueue,httpQueue$1=new Queue$3({concurrency:4}),ipfsPath=_=>{if(_.Path)return _.Path;throw new Error(_.Message)};async function resolveDnslink(_,o){return(async(j,et={})=>{const tt=new URLSearchParams(et);tt.set("arg",j);const rt=tt.toString();if(!et.nocache&&cache$2.has(rt)){const it=cache$2.get(rt);return ipfsPath(it)}const nt=await httpQueue$1.add(async()=>{const it=await http.get("https://ipfs.io/api/v0/dns",{searchParams:tt}),st=new URL(it.url).search.slice(1),ot=await it.json();return cache$2.set(st,ot,ttl),ot});return ipfsPath(nt)})(_,o)}function fqdnFixups(_){return _.endsWith(".eth")&&(_=_.replace(/.eth$/,".eth.link")),_}function createDns$1(){return withTimeoutOption(async(o,$={recursive:!0})=>{if(typeof o!="string")throw new Error("Invalid arguments, domain must be a string");return o=fqdnFixups(o),resolveDnslink(o,$)})}function createIsOnline$1({network:_}){return()=>{const o=_.try();return o!=null&&!!o.libp2p.isStarted()}}const symbol$6=Symbol.for("@libp2p/peer-id");function isPeerId(_){return _!=null&&!!_[symbol$6]}const inspect$2=Symbol.for("nodejs.util.inspect.custom"),baseDecoder=Object.values(bases$2).map(_=>_.decoder).reduce((_,o)=>_.or(o),bases$2.identity.decoder),LIBP2P_KEY_CODE=114,MARSHALLED_ED225519_PUBLIC_KEY_LENGTH=36,MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH=37;class PeerIdImpl{constructor(o){this.type=o.type,this.multihash=o.multihash,this.privateKey=o.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[symbol$6](){return!0}toString(){return this.string==null&&(this.string=base58btc$4.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return CID$3.createV1(LIBP2P_KEY_CODE,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(o){var $;if(o instanceof Uint8Array)return equals$6(this.multihash.bytes,o);if(typeof o=="string")return peerIdFromString(o).equals(this);if((($=o==null?void 0:o.multihash)==null?void 0:$.bytes)!=null)return equals$6(this.multihash.bytes,o.multihash.bytes);throw new Error("not valid Id")}[inspect$2](){return`PeerId(${this.toString()})`}}class RSAPeerIdImpl extends PeerIdImpl{constructor(o){super({...o,type:"RSA"}),this.type="RSA",this.publicKey=o.publicKey}}class Ed25519PeerIdImpl extends PeerIdImpl{constructor(o){super({...o,type:"Ed25519"}),this.type="Ed25519",this.publicKey=o.multihash.digest}}class Secp256k1PeerIdImpl extends PeerIdImpl{constructor(o){super({...o,type:"secp256k1"}),this.type="secp256k1",this.publicKey=o.multihash.digest}}function peerIdFromPeerId(_){if(_.type==="RSA")return new RSAPeerIdImpl(_);if(_.type==="Ed25519")return new Ed25519PeerIdImpl(_);if(_.type==="secp256k1")return new Secp256k1PeerIdImpl(_);throw new CodeError("Not a PeerId","ERR_INVALID_PARAMETERS")}function peerIdFromString(_,o){if(_.charAt(0)==="1"||_.charAt(0)==="Q"){const $=decode$B(base58btc$4.decode(`z${_}`));return _.startsWith("12D")?new Ed25519PeerIdImpl({multihash:$}):_.startsWith("16U")?new Secp256k1PeerIdImpl({multihash:$}):new RSAPeerIdImpl({multihash:$})}return peerIdFromBytes(baseDecoder.decode(_))}function peerIdFromBytes(_){try{const o=decode$B(_);if(o.code===identity$3.code){if(o.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:o});if(o.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:o})}if(o.code===sha256$8.code)return new RSAPeerIdImpl({multihash:o})}catch{return peerIdFromCID(CID$3.decode(_))}throw new Error("Supplied PeerID CID is invalid")}function peerIdFromCID(_){if(_==null||_.multihash==null||_.version==null||_.version===1&&_.code!==LIBP2P_KEY_CODE)throw new Error("Supplied PeerID CID is invalid");const o=_.multihash;if(o.code===sha256$8.code)return new RSAPeerIdImpl({multihash:_.multihash});if(o.code===identity$3.code){if(o.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:_.multihash});if(o.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:_.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function peerIdFromKeys(_,o){return _.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH?new Ed25519PeerIdImpl({multihash:create$c(identity$3.code,_),privateKey:o}):_.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH?new Secp256k1PeerIdImpl({multihash:create$c(identity$3.code,_),privateKey:o}):new RSAPeerIdImpl({multihash:await sha256$8.digest(_),publicKey:_,privateKey:o})}function createResolve$5({repo:_,codecs:o,bases:$,name:j}){async function et(tt,rt={}){if(!path(tt))throw new Error("invalid argument "+tt);if(ipnsPath(tt))for await(const mt of j.resolve(tt,rt))tt=mt;const[,nt,it,...st]=tt.split("/"),ot=rt.cidBase?await $.getBase(rt.cidBase):void 0,at=parseBytes(it);if(st.length===0){const mt=ot?ot.encoder.encode(at):it;return`/${nt}/${mt}`}const ct=CID$3.decode(at);tt=st.join("/");const ut=resolve$5(ct,tt,o,_,rt);let ft=ct,ht=tt;for await(const mt of ut)CID$3.asCID(mt.value)&&(ft=mt.value,ht=mt.remainderPath);return`/ipfs/${ft.toString(ot&&ot.encoder)}${ht?"/"+ht:""}`}return withTimeoutOption(et)}function parseBytes(_){try{return peerIdFromString(_).toBytes()}catch{return CID$3.parse(_).bytes}}async function last(_){let o;for await(const $ of _)o=$;return o}function createAdd$7({addAll:_}){return(o,$={})=>{let j;const et=CID$3.asCID(o);return et?j=_([{cid:et,...$}],$):j=_([{path:o.toString(),...$}],$),last(j)}}function isIterable$2(_){return Symbol.iterator in _}function isAsyncIterable$1(_){return Symbol.asyncIterator in _}function isCID(_){return CID$3.asCID(_)!=null}async function*normaliseInput$3(_){if(_==null)throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT");const o=CID$3.asCID(_);if(o){yield toPin$2({cid:o});return}if(_ instanceof String||typeof _=="string"){yield toPin$2({path:_});return}if(_.cid!=null||_.path!=null)return yield toPin$2(_);if(isIterable$2(_)){const $=_[Symbol.iterator](),j=$.next();if(j.done)return $;if(isCID(j.value)){yield toPin$2({cid:j.value});for(const et of $)yield toPin$2({cid:et});return}if(j.value instanceof String||typeof j.value=="string"){yield toPin$2({path:j.value});for(const et of $)yield toPin$2({path:et});return}if(j.value.cid!=null||j.value.path!=null){yield toPin$2(j.value);for(const et of $)yield toPin$2(et);return}throw errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}if(isAsyncIterable$1(_)){const $=_[Symbol.asyncIterator](),j=await $.next();if(j.done)return $;if(isCID(j.value)){yield toPin$2({cid:j.value});for await(const et of $)yield toPin$2({cid:et});return}if(j.value instanceof String||typeof j.value=="string"){yield toPin$2({path:j.value});for await(const et of $)yield toPin$2({path:et});return}if(j.value.cid!=null||j.value.path!=null){yield toPin$2(j.value);for await(const et of $)yield toPin$2(et);return}throw errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}throw errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}function toPin$2(_){const o=_.cid||`${_.path}`;if(!o)throw errCode(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const $={path:o,recursive:_.recursive!==!1};return _.metadata!=null&&($.metadata=_.metadata),$}const PinTypes$1={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function createAddAll$3({repo:_,codecs:o}){async function*$(j,et={}){const tt=async function*(){for await(const{path:it,recursive:st,metadata:ot}of normaliseInput$3(j)){const{cid:at}=await resolvePath$1(_,o,it),{reason:ct}=await _.pins.isPinnedWithType(at,[PinTypes$1.recursive,PinTypes$1.direct]);if(ct==="recursive"&&!st)throw new Error(`${at} already pinned recursively`);st?await _.pins.pinRecursively(at,{metadata:ot}):await _.pins.pinDirectly(at,{metadata:ot}),yield at}};if(!!!et.lock){yield*tt();return}const nt=await _.gcLock.readLock();try{yield*tt()}finally{nt()}}return withTimeoutOption($)}function toPin$1(_,o,$){const j={type:_,cid:o};return $&&(j.metadata=$),j}function createLs$9({repo:_,codecs:o}){async function*$(j={}){let et=PinTypes$1.all;if(j.type&&(et=j.type,!Object.keys(PinTypes$1).includes(et)))throw errCode(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(j.paths){let tt=!1;for await(const{path:rt}of normaliseInput$3(j.paths)){const{cid:nt}=await resolvePath$1(_,o,rt),{reason:it,pinned:st,parent:ot,metadata:at}=await _.pins.isPinnedWithType(nt,et);if(!st)throw errCode(new Error(`path '${rt}' is not pinned`),"ERR_NOT_PINNED");switch(it){case PinTypes$1.direct:case PinTypes$1.recursive:tt=!0,yield toPin$1(it,nt,at);break;default:tt=!0,yield toPin$1(`${PinTypes$1.indirect} through ${ot}`,nt,at)}}if(!tt)throw new Error("No match found");return}if(et===PinTypes$1.recursive||et===PinTypes$1.all)for await(const{cid:tt,metadata:rt}of _.pins.recursiveKeys())yield toPin$1(PinTypes$1.recursive,tt,rt);if(et===PinTypes$1.indirect||et===PinTypes$1.all)for await(const tt of _.pins.indirectKeys(j))yield toPin$1(PinTypes$1.indirect,tt);if(et===PinTypes$1.direct||et===PinTypes$1.all)for await(const{cid:tt,metadata:rt}of _.pins.directKeys())yield toPin$1(PinTypes$1.direct,tt,rt)}return withTimeoutOption($)}function createRm$b({rmAll:_}){async function o($,j={}){const et=await last(_([{path:$,...j}],j));if(!et)throw new Error("CID expected");return et}return o}function createRmAll$2({repo:_,codecs:o}){async function*$(j,et={}){const tt=await _.gcLock.readLock();try{for await(const{path:rt,recursive:nt}of normaliseInput$3(j)){const{cid:it}=await resolvePath$1(_,o,rt),{pinned:st,reason:ot}=await _.pins.isPinnedWithType(it,PinTypes$1.all);if(!st)throw new Error(`${it} is not pinned`);switch(ot){case PinTypes$1.recursive:if(!nt)throw new Error(`${it} is pinned recursively`);await _.pins.unpin(it),yield it;break;case PinTypes$1.direct:await _.pins.unpin(it),yield it;break;default:throw new Error(`${it} is pinned indirectly under ${ot}`)}}}finally{tt()}}return withTimeoutOption($)}class PinAPI{constructor({codecs:o,repo:$}){const j=createAddAll$3({codecs:o,repo:$});this.addAll=j,this.add=createAdd$7({addAll:j});const et=createRmAll$2({codecs:o,repo:$});this.rmAll=et,this.rm=createRm$b({rmAll:et}),this.ls=createLs$9({codecs:o,repo:$}),this.remote={add:(tt,rt={})=>Promise.reject(new Error("Not implemented")),ls:async function*(tt,rt={}){return Promise.reject(new Error("Not implemented"))},rm:(tt,rt={})=>Promise.reject(new Error("Not implemented")),rmAll:(tt,rt={})=>Promise.reject(new Error("Not implemented")),service:{add:(tt,rt)=>Promise.reject(new Error("Not implemented")),rm:(tt,rt={})=>Promise.reject(new Error("Not implemented")),ls:(tt={})=>Promise.reject(new Error("Not implemented"))}}}}function dbOpenFailedError(_){return _=_||new Error("Cannot open database"),errCode(_,"ERR_DB_OPEN_FAILED")}function dbDeleteFailedError(_){return _=_||new Error("Delete failed"),errCode(_,"ERR_DB_DELETE_FAILED")}function dbWriteFailedError(_){return _=_||new Error("Write failed"),errCode(_,"ERR_DB_WRITE_FAILED")}function notFoundError(_){return _=_||new Error("Not Found"),errCode(_,"ERR_NOT_FOUND")}var timestamp_minExports={},timestamp_min={get exports(){return timestamp_minExports},set exports(_){timestamp_minExports=_}};(function(_){(function(){_.exports=mt;var o=86400,$=3200,j=146097*$/400,et=o*j,tt=1e3*et,rt=864e13,nt=4294967296,it=1e6,st="000000000",ot=Math.trunc||function(Ot){var jt=Ot-Ot%1;return jt==0&&(Ot<0||Ot===0&&1/Ot!=1/0)?-0:jt},at=mt.prototype,ct=(mt.fromDate=function(Ot){return new mt(+Ot)},mt.fromInt64BE=kt(0,1,2,3,0,4),mt.fromInt64LE=kt(3,2,1,0,4,0),mt.fromString=function(It){var jt,Nt=new mt,It=(It+="").replace(/^\s*[+\-]?\d+/,function(lt){var lt=+lt,pt=1970+(lt-1970)%400;return Nt.year=lt-pt,pt}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(yt,lt,pt){return lt<0&&(pt*=-1),jt=6e4*(60*+lt+ +pt),""}).replace(/\.\d+$/,function(yt){return Nt.nano=+(yt+st).substr(1,9),""}).split(/\D+/);if(1<It.length?It[1]--:It[1]=0,Nt.time=jt=Date.UTC.apply(Date,It)-(jt||0),isNaN(jt))throw new TypeError("Invalid Date");return gt(Nt)},mt.fromTimeT=function(Ot){return St(Ot,0)},at.year=0,at.time=0,at.nano=0,at.addNano=function(Ot){return this.nano+=+Ot||0,this},at.getNano=function(){var Ot=gt(this);return(Ot.time%1e3*it+ +Ot.nano+1e9)%1e9},at.getTimeT=function(){var jt=gt(this),Ot=Math.floor(jt.time/1e3),jt=jt.year;return jt&&(Ot+=jt*j*o/$),Ot},at.getYear=function(){return this.toDate().getUTCFullYear()+this.year},at.toDate=function(){return Et(gt(this).time)},at.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},at.toString=function(Ot){var jt=this,Nt=jt.toDate(),It={H:function(){return Tt(Nt.getUTCHours())},L:function(){return Dt(Nt.getUTCMilliseconds(),3)},M:function(){return Tt(Nt.getUTCMinutes())},N:function(){return Dt(jt.getNano(),9)},S:function(){return Tt(Nt.getUTCSeconds())},Y:function(){var yt=jt.getYear();return 999999<yt?"+"+yt:9999<yt?"+"+Dt(yt,6):0<=yt?Dt(yt,4):-999999<=yt?"-"+Dt(-yt,6):yt},a:function(){return ft[Nt.getUTCDay()]},b:function(){return ut[Nt.getUTCMonth()]},d:function(){return Tt(Nt.getUTCDate())},e:function(){return function(yt){return(9<yt?"":" ")+(0|yt)}(Nt.getUTCDate())},m:function(){return Tt(Nt.getUTCMonth()+1)}};return function yt(lt){return lt.replace(/%./g,function(pt){var _t=pt[1],bt=ht[_t],_t=It[_t];return bt?yt(bt):_t?_t():pt})}(Ot||ct)},at.writeInt64BE=At(0,1,2,3,0,4),at.writeInt64LE=At(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),ut=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ft=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ht={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return mt;function mt(Ot,jt,Nt){var It=this;if(!(It instanceof mt))return new mt(Ot,jt,Nt);It.time=+Ot||0,It.nano=+jt||0,It.year=+Nt||0,gt(It)}function gt(Ot){var jt,Nt,It,yt=Ot.year,lt=Ot.time,pt=Ot.nano,bt=((pt<0||it<=pt)&&(pt-=(Nt=Math.floor(pt/it))*it,lt+=Nt,Nt=1),yt%$);return(lt<-rt||rt<lt||bt)&&((jt=ot(lt/tt))&&(yt+=jt*$,lt-=jt*tt),(It=Et(lt)).setUTCFullYear(bt+It.getUTCFullYear()),It=(lt=+It)+(jt=ot((yt-=bt)/$))*tt,jt&&-rt<=It&&It<=rt&&(yt-=jt*$,lt=It),Nt=1),Nt&&(Ot.year=yt,Ot.time=lt,Ot.nano=pt),Ot}function Et(Ot){var jt=new Date(0);return jt.setTime(Ot),jt}function St(yt,It){yt=+yt||0;var Nt=ot((It=(It|0)*nt)/et)+ot(yt/et),It=It%et+yt%et,yt=ot(It/et);return yt&&(Nt+=yt,It-=yt*et),new mt(1e3*It,0,Nt*$)}function At(Ot,jt,Nt,It,yt,lt){return function(bt,_t){var Ct=gt(this);bt=bt||new Array(8),Rt(bt,_t|=0);var xt=Math.floor(Ct.time/1e3),Ct=Ct.year*(j*o/$),$t=ot(Ct/nt)+ot(xt/nt),Ct=Ct%nt+xt%nt,xt=Math.floor(Ct/nt);return xt&&($t+=xt,Ct-=xt*nt),pt(bt,_t+yt,$t),pt(bt,_t+lt,Ct),bt};function pt(bt,_t,$t){bt[_t+Ot]=$t>>24&255,bt[_t+jt]=$t>>16&255,bt[_t+Nt]=$t>>8&255,bt[_t+It]=255&$t}}function kt(Ot,jt,Nt,It,yt,lt){return function(bt,_t){Rt(bt,_t|=0);var $t=pt(bt,_t+yt);return St(pt(bt,_t+lt),$t)};function pt(bt,_t){return 16777216*bt[_t+Ot]+(bt[_t+jt]<<16|bt[_t+Nt]<<8|bt[_t+It])}}function Rt(Ot,jt){if(Ot=Ot&&Ot.length,Ot==null)throw new TypeError("Invalid Buffer");if(Ot<jt+8)throw new RangeError("Out of range")}function Tt(Ot){return(9<Ot?"":"0")+(0|Ot)}function Dt(Ot,jt){return(st+(0|Ot)).substr(-jt)}})()})(timestamp_min);const NanoDate=timestamp_minExports,ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD",ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY",ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION",ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION",ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT",ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER",ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA",ERR_INVALID_EMBEDDED_KEY="ERR_INVALID_EMBEDDED_KEY",ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY";function configure$3(){util$4._configure(),reader$6._configure(reader_buffer$1),writer$5._configure(writer_buffer$1)}configure$3();const methods$2=["uint64","int64","sint64","fixed64","sfixed64"];function patchReader$2(_){for(const o of methods$2){if(_[o]==null)continue;const $=_[o];_[o]=function(){return BigInt($.call(this).toString())}}return _}function reader$4(_){return patchReader$2(new reader$6(_))}function patchWriter$2(_){for(const o of methods$2){if(_[o]==null)continue;const $=_[o];_[o]=function(j){return $.call(this,j.toString())}}return _}function writer$3(){return patchWriter$2(writer$5.create())}function decodeMessage$3(_,o){const $=reader$4(_ instanceof Uint8Array?_:_.subarray());return o.decode($)}function encodeMessage$2(_,o){const $=writer$3();return o.encode(_,$,{lengthDelimited:!1}),$.finish()}var CODEC_TYPES$2;(function(_){_[_.VARINT=0]="VARINT",_[_.BIT64=1]="BIT64",_[_.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",_[_.START_GROUP=3]="START_GROUP",_[_.END_GROUP=4]="END_GROUP",_[_.BIT32=5]="BIT32"})(CODEC_TYPES$2||(CODEC_TYPES$2={}));function createCodec$2(_,o,$,j){return{name:_,type:o,encode:$,decode:j}}function enumeration$1(_){function o(et){if(_[et.toString()]==null)throw new Error("Invalid enum value");return _[et]}const $=function(tt,rt){const nt=o(tt);rt.int32(nt)},j=function(tt){const rt=tt.int32();return o(rt)};return createCodec$2("enum",CODEC_TYPES$2.VARINT,$,j)}function message$2(_,o){return createCodec$2("message",CODEC_TYPES$2.LENGTH_DELIMITED,_,o)}var IpnsEntry;(function(_){(function(j){j.EOL="EOL"})(_.ValidityType||(_.ValidityType={}));let o;(function(j){j[j.EOL=0]="EOL"})(o||(o={})),function(j){j.codec=()=>enumeration$1(o)}(_.ValidityType||(_.ValidityType={}));let $;_.codec=()=>($==null&&($=message$2((j,et,tt={})=>{tt.lengthDelimited!==!1&&et.fork(),j.value!=null&&(et.uint32(10),et.bytes(j.value)),j.signature!=null&&(et.uint32(18),et.bytes(j.signature)),j.validityType!=null&&(et.uint32(24),_.ValidityType.codec().encode(j.validityType,et)),j.validity!=null&&(et.uint32(34),et.bytes(j.validity)),j.sequence!=null&&(et.uint32(40),et.uint64(j.sequence)),j.ttl!=null&&(et.uint32(48),et.uint64(j.ttl)),j.pubKey!=null&&(et.uint32(58),et.bytes(j.pubKey)),j.signatureV2!=null&&(et.uint32(66),et.bytes(j.signatureV2)),j.data!=null&&(et.uint32(74),et.bytes(j.data)),tt.lengthDelimited!==!1&&et.ldelim()},(j,et)=>{const tt={},rt=et==null?j.len:j.pos+et;for(;j.pos<rt;){const nt=j.uint32();switch(nt>>>3){case 1:tt.value=j.bytes();break;case 2:tt.signature=j.bytes();break;case 3:tt.validityType=_.ValidityType.codec().decode(j);break;case 4:tt.validity=j.bytes();break;case 5:tt.sequence=j.uint64();break;case 6:tt.ttl=j.uint64();break;case 7:tt.pubKey=j.bytes();break;case 8:tt.signatureV2=j.bytes();break;case 9:tt.data=j.bytes();break;default:j.skipType(nt&7);break}}return tt})),$),_.encode=j=>encodeMessage$2(j,_.codec()),_.decode=j=>decodeMessage$3(j,_.codec())})(IpnsEntry||(IpnsEntry={}));const log$1F=logger$1("ipns:utils"),IPNS_PREFIX$1=fromString$8("/ipns/");function parseRFC3339$1(_){const o=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),$=String(_).trim().match(o);if($==null)throw new Error("Invalid format");const j=parseInt($[1],10),et=parseInt($[2],10)-1,tt=parseInt($[3],10),rt=parseInt($[4],10),nt=parseInt($[5],10),it=parseInt($[6],10),st=parseInt($[7].slice(0,-6),10);return new Date(Date.UTC(j,et,tt,rt,nt,it,st))}const extractPublicKey=async(_,o)=>{if(o==null||_==null){const j=new Error("one or more of the provided parameters are not defined");throw log$1F.error(j),errCode(j,ERR_UNDEFINED_PARAMETER)}let $;if(o.pubKey!=null){try{$=unmarshalPublicKey(o.pubKey)}catch(et){throw log$1F.error(et),et}if(!(await peerIdFromKeys(o.pubKey)).equals(_))throw errCode(new Error("Embedded public key did not match PeerID"),ERR_INVALID_EMBEDDED_KEY)}else _.publicKey!=null&&($=unmarshalPublicKey(_.publicKey));if($!=null)return $;throw errCode(new Error("no public key is available"),ERR_UNDEFINED_PARAMETER)},ipnsEntryDataForV1Sig=(_,o,$)=>{const j=fromString$8(o);return concat$2([_,$,j])},ipnsEntryDataForV2Sig=_=>{const o=fromString$8("ipns-signature:");return concat$2([o,_])},marshal=_=>IpnsEntry.encode(_),unmarshal=_=>{const o=IpnsEntry.decode(_);return o.sequence!=null&&(o.sequence=BigInt(o.sequence)),o.ttl!=null&&(o.ttl=BigInt(o.ttl)),{value:o.value??new Uint8Array(0),signature:o.signature??new Uint8Array(0),validityType:o.validityType??IpnsEntry.ValidityType.EOL,validity:o.validity??new Uint8Array(0),sequence:o.sequence??0n,pubKey:o.pubKey,ttl:o.ttl??void 0,signatureV2:o.signatureV2,data:o.data}},peerIdToRoutingKey=_=>concat$2([IPNS_PREFIX$1,_.toBytes()]),peerIdFromRoutingKey=_=>peerIdFromBytes(_.slice(IPNS_PREFIX$1.length)),createCborData=(_,o,$,j,et)=>{let tt;if($===IpnsEntry.ValidityType.EOL)tt=0;else throw errCode(new Error("Unknown validity type"),ERR_UNRECOGNIZED_VALIDITY);return encode$A({Value:_,Validity:o,ValidityType:tt,Sequence:j,TTL:et})},parseCborData=_=>{const o=decode$x(_);if(o.ValidityType===0)o.ValidityType=IpnsEntry.ValidityType.EOL;else throw errCode(new Error("Unknown validity type"),ERR_UNRECOGNIZED_VALIDITY);return Number.isInteger(o.Sequence)&&(o.Sequence=BigInt(o.Sequence)),Number.isInteger(o.TTL)&&(o.TTL=BigInt(o.TTL)),o},log$1E=logger$1("ipns"),ID_MULTIHASH_CODE=identity$3.code,namespace$1="/ipns/",namespaceLength=namespace$1.length,create$5=async(_,o,$,j)=>{const et=new NanoDate(Date.now()+Number(j)),tt=IpnsEntry.ValidityType.EOL,[rt,nt]=j.toString().split("."),it=BigInt(rt)*BigInt(1e5)+BigInt(nt??"0");return await _create(_,o,$,tt,et,it)},_create=async(_,o,$,j,et,tt)=>{$=BigInt($);const rt=fromString$8(et.toString());if(_.privateKey==null)throw errCode(new Error("Missing private key"),ERR_MISSING_PRIVATE_KEY);const nt=await unmarshalPrivateKey(_.privateKey),it=await signLegacyV1(nt,o,j,rt),st=createCborData(o,rt,j,$,tt),ot=ipnsEntryDataForV2Sig(st),at=await nt.sign(ot),ct={value:o,signature:it,validityType:j,validity:rt,sequence:$,ttl:tt,signatureV2:at,data:st};if(_.publicKey!=null){const ut=decode$B(_.toBytes());(ut.code!==ID_MULTIHASH_CODE||!equals$6(_.publicKey,ut.digest))&&(ct.pubKey=_.publicKey)}return log$1E("ipns entry for %b created",o),ct},rawStdEncoding=_=>base32upper$2.encode(_).slice(1),getLocalKey=_=>new Key(`/ipns/${rawStdEncoding(_)}`),signLegacyV1=async(_,o,$,j)=>{try{const et=ipnsEntryDataForV1Sig(o,$,j);return await _.sign(et)}catch(et){throw log$1E.error("record signature creation failed",et),errCode(new Error("record signature creation failed"),ERR_SIGNATURE_CREATION)}},log$1D=logger$1("ipfs:ipns:publisher"),ERR_NOT_FOUND$3=notFoundError().code,defaultRecordLifetime$1=60*60*1e3;class IpnsPublisher{constructor(o,$){this._routing=o,this._datastore=$}async publishWithEOL(o,$,j,et){const tt=await this._updateOrCreateRecord(o,$,j,et);return this._putRecordToRouting(tt,o,et)}publish(o,$,j){return this.publishWithEOL(o,$,defaultRecordLifetime$1,j)}async _putRecordToRouting(o,$,j){if(!isPeerId($)){const tt="peerId received is not valid";throw log$1D.error(tt),errCode(new Error(tt),"ERR_INVALID_PEER_ID")}if($.publicKey==null)throw errCode(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");const et=peerIdToRoutingKey($);return await this._publishEntry(et,o,j),o}async _publishEntry(o,$,j){try{const et=await this._routing.put(o,$,j);return log$1D(`ipns record for ${toString$a(o,"base32")} was stored in the routing`),et}catch(et){const tt=`ipns record for ${toString$a(o,"base32")} could not be stored in the routing - ${et.stack}`;throw log$1D.error(tt),log$1D.error(et),errCode(new Error(tt),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(o,$={}){if(!isPeerId(o)){const et="peerId received is not valid";throw log$1D.error(et),errCode(new Error(et),"ERR_INVALID_PEER_ID")}const j=$.checkRouting!==!1;try{const et=await this._datastore.get(getLocalKey(o.toBytes()));return this._unmarshalData(et)}catch(et){if(et.code!==ERR_NOT_FOUND$3){const tt=`unexpected error getting the ipns record ${o.toString()} from datastore`;throw log$1D.error(tt),errCode(new Error(tt),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!j)throw errCode(et,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const tt=peerIdToRoutingKey(o),rt=await this._routing.get(tt);return this._unmarshalData(rt)}catch(tt){throw log$1D.error(tt),tt}}}_unmarshalData(o){try{return unmarshal(o)}catch($){throw errCode($,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(o,$,j,et){if(!isPeerId(o)){const st="peerId received is not valid";throw log$1D.error(st),errCode(new Error(st),"ERR_INVALID_PEER_ID")}const tt={checkRouting:!0};let rt;try{rt=await this._getPublished(o,tt)}catch(st){if(st.code!==ERR_NOT_FOUND$3){const ot=`unexpected error when determining the last published IPNS record for ${o.toString()} ${st.stack}`;throw log$1D.error(ot),errCode(new Error(ot),"ERR_DETERMINING_PUBLISHED_RECORD")}}let nt=0n;rt&&rt.sequence!==void 0&&(nt=equals$6(rt.value,$)?rt.sequence:rt.sequence+BigInt(1));let it;try{it=await create$5(o,$,nt,j)}catch(st){const ot=`ipns record for ${$} could not be created`;throw log$1D.error(st),errCode(new Error(ot),"ERR_CREATING_IPNS_RECORD")}try{const st=marshal(it);return await this._datastore.put(getLocalKey(o.toBytes()),st,et),log$1D(`ipns record for ${toString$a($,"base32")} was stored in the datastore`),st}catch{const ot=`ipns record for ${$} could not be stored in the datastore`;throw log$1D.error(ot),errCode(new Error(ot),"ERR_STORING_IN_DATASTORE")}}}IpnsPublisher.defaultRecordLifetime=defaultRecordLifetime$1;const log$1C=logger$1("ipfs:ipns:republisher"),minute$3=60*1e3,hour$1=60*minute$3,defaultBroadcastInterval=4*hour$1,defaultRecordLifetime=24*hour$1;class IpnsRepublisher{constructor(o,$,j,et,tt={pass:""}){this._publisher=o,this._datastore=$,this._peerId=j,this._keychain=et,this._options=tt,this._republishHandle=null}async start(){if(this._republishHandle)throw errCode(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const o={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:et=>{o._timeoutId=setTimeout(async()=>{o._timeoutId=null;try{o._inflightTask=o._task(),await o._inflightTask,o._task&&o.runPeriodically(et)}catch(tt){log$1C.error(tt)}},et())},cancel:async()=>{o._timeoutId!=null&&clearTimeout(o._timeoutId),o._task=null,await o._inflightTask}},{pass:$}=this._options;let j=!0;o._task=async()=>{const et=new timeoutAbortController.TimeoutController(3e4);try{await this._republishEntries(this._peerId,$,{signal:et.signal})}finally{et.clear()}},o.runPeriodically(()=>j?(j=!1,this._options.initialBroadcastInterval||minute$3):this._options.broadcastInterval||defaultBroadcastInterval),this._republishHandle=o}async stop(){const o=this._republishHandle;if(!o)throw errCode(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await o.cancel()}async _republishEntries(o,$,j){try{await this._republishEntry(o,j)}catch{const tt="cannot republish entry for the node's private key";log$1C.error(tt);return}if($)try{const et=await this._keychain.listKeys();for(const tt of et){if(tt.name==="self")continue;const rt=await this._keychain.exportKey(tt.name,$),nt=await importKey(rt,$),it=await peerIdFromKeys(nt.public.bytes,nt.bytes);await this._republishEntry(it,j)}}catch(et){log$1C.error(et)}}async _republishEntry(o,$){try{const j=await this._getPreviousValue(o);await this._publisher.publishWithEOL(o,j,defaultRecordLifetime,$)}catch(j){if(j.code==="ERR_NO_ENTRY_FOUND")return;throw j}}async _getPreviousValue(o){if(!isPeerId(o))throw errCode(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const $=await this._datastore.get(getLocalKey(o.toBytes()));if(!($ instanceof Uint8Array))throw errCode(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return unmarshal($).value}catch(j){throw log$1C.error(j),errCode(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch($){throw $&&$.notFound?errCode(new Error(`no previous entry for record with id: ${o.toString()}`),"ERR_NO_ENTRY_FOUND"):$}}}const log$1B=logger$1("ipns:validator"),validate=async(_,o)=>{const{value:$,validityType:j,validity:et}=o;let tt,rt;if(o.signatureV2!=null&&o.data!=null)rt=o.signatureV2,tt=ipnsEntryDataForV2Sig(o.data),validateCborDataMatchesPbData(o);else throw errCode(new Error("missing data or signatureV2"),ERR_SIGNATURE_VERIFICATION);let nt;try{nt=await _.verify(tt,rt)}catch{nt=!1}if(!nt)throw log$1B.error("record signature verification failed"),errCode(new Error("record signature verification failed"),ERR_SIGNATURE_VERIFICATION);if(et!=null&&j===IpnsEntry.ValidityType.EOL){let it;try{it=parseRFC3339$1(toString$a(et))}catch{throw log$1B.error("unrecognized validity format (not an rfc3339 format)"),errCode(new Error("unrecognized validity format (not an rfc3339 format)"),ERR_UNRECOGNIZED_FORMAT)}if(it.getTime()<Date.now())throw log$1B.error("record has expired"),errCode(new Error("record has expired"),ERR_IPNS_EXPIRED_RECORD)}else if(j!=null)throw log$1B.error("unrecognized validity type"),errCode(new Error("unrecognized validity type"),ERR_UNRECOGNIZED_VALIDITY);log$1B("ipns entry for %b is valid",$)},validateCborDataMatchesPbData=_=>{if(_.data==null)throw errCode(new Error("Record data is missing"),ERR_INVALID_RECORD_DATA);const o=parseCborData(_.data);if(!equals$6(o.Value,_.value))throw errCode(new Error('Field "value" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(!equals$6(o.Validity,_.validity))throw errCode(new Error('Field "validity" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(o.ValidityType!==_.validityType)throw errCode(new Error('Field "validityType" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(o.Sequence!==_.sequence)throw errCode(new Error('Field "sequence" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(o.TTL!==_.ttl)throw errCode(new Error('Field "ttl" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION)},ipnsValidator=async(_,o)=>{const $=peerIdFromRoutingKey(_),j=unmarshal(o),et=await extractPublicKey($,j);await validate(et,j)},log$1A=logger$1("ipfs:ipns:resolver"),ERR_NOT_FOUND$2=notFoundError().code,defaultMaximumRecursiveDepth=32;class IpnsResolver{constructor(o){this._routing=o}async resolve(o,$={}){if(typeof o!="string")throw errCode(new Error("invalid name"),"ERR_INVALID_NAME");const j=$.recursive&&$.recursive.toString()==="true",et=o.split("/");if(et.length!==3||et[0]!=="")throw errCode(new Error("invalid name"),"ERR_INVALID_NAME");const tt=et[2];let rt=1/0;j&&(rt=defaultMaximumRecursiveDepth);const nt=await this.resolver(tt,rt,$);return log$1A(`${o} was locally resolved correctly`),nt}async resolver(o,$,j){if($===0){const rt=`could not resolve name (recursion limit of ${defaultMaximumRecursiveDepth} exceeded)`;throw log$1A.error(rt),errCode(new Error(rt),"ERR_RESOLVE_RECURSION_LIMIT")}const et=await this._resolveName(o,j),tt=et.split("/");return tt[1]==="ipfs"||!$?et:this.resolver(tt[2],$-1,j)}async _resolveName(o,$){const j=peerIdFromString(o),et=peerIdToRoutingKey(j);let tt;try{tt=await this._routing.get(et,$)}catch(rt){throw log$1A.error("could not get record from routing",rt),rt.code===ERR_NOT_FOUND$2?errCode(new Error(`record requested for ${o} was not found in the network`),"ERR_NO_RECORD_FOUND"):errCode(new Error(`unexpected error getting the ipns record ${j.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(j,tt)}async _validateRecord(o,$){await ipnsValidator(concat$2([fromString$8("/ipns/"),o.toBytes()]),$);const j=unmarshal($);return toString$a(j.value)}}class TLRU{constructor(o){this.lru=hashlru(o)}get(o){const $=this.lru.get(o);if($){if($.expire&&$.expire<Date.now()){this.lru.remove(o);return}return $.value}}set(o,$,j){this.lru.set(o,{value:$,expire:Date.now()+j})}has(o){return!!this.get(o)}remove(o){this.lru.remove(o)}clear(){this.lru.clear()}}const log$1z=logger$1("ipfs:ipns"),defaultRecordTtl=60*1e3;class IPNS{constructor(o,$,j,et,tt){this.publisher=new IpnsPublisher(o,$),this.republisher=new IpnsRepublisher(this.publisher,$,j,et,tt),this.resolver=new IpnsResolver(o),this.cache=new TLRU(1e3),this.routing=o}async publish(o,$,j=IpnsPublisher.defaultRecordLifetime,et){try{await this.publisher.publishWithEOL(o,$,j,et),log$1z(`IPNS value ${toString$a($,"base32")} was published correctly`);const tt=o.toString(),rt=parseFloat(j),nt=rt<defaultRecordTtl?rt:defaultRecordTtl;return this.cache.set(tt,$,nt),log$1z(`IPNS value ${toString$a($,"base32")} was cached correctly`),{name:tt,value:$}}catch(tt){throw log$1z.error(tt),tt}}async resolve(o,$={}){if(typeof o!="string")throw errCode(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!$.nocache&&!$.recursive){const j=o.split("/")[2],et=this.cache.get(j);if(et)return et}try{const j=await this.resolver.resolve(o,$);return log$1z(`IPNS record from ${o} was resolved correctly`),j}catch(j){throw log$1z.error(j),j}}async initializeKeyspace(o,$,j){return this.publish(o,$,IpnsPublisher.defaultRecordLifetime,j)}}async function all$1(_){const o=[];for await(const $ of _)o.push($);return o}const sortAll$1=(_,o)=>async function*(){yield*(await all$1(_)).sort(o)}();async function drain(_){for await(const o of _);}async function*filter$1(_,o){for await(const $ of _)await o($)&&(yield $)}async function*take(_,o){let $=0;if(!(o<1)){for await(const j of _)if(yield j,$++,$===o)return}}class BaseDatastore{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(o,$,j){return Promise.reject(new Error(".put is not implemented"))}get(o,$){return Promise.reject(new Error(".get is not implemented"))}has(o,$){return Promise.reject(new Error(".has is not implemented"))}delete(o,$){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(o,$={}){for await(const{key:j,value:et}of o)await this.put(j,et,$),yield{key:j,value:et}}async*getMany(o,$={}){for await(const j of o)yield this.get(j,$)}async*deleteMany(o,$={}){for await(const j of o)await this.delete(j,$),yield j}batch(){let o=[],$=[];return{put(j,et){o.push({key:j,value:et})},delete(j){$.push(j)},commit:async j=>{await drain(this.putMany(o,j)),o=[],await drain(this.deleteMany($,j)),$=[]}}}async*_all(o,$){throw new Error("._all is not implemented")}async*_allKeys(o,$){throw new Error("._allKeys is not implemented")}query(o,$){let j=this._all(o,$);if(o.prefix!=null&&(j=filter$1(j,et=>et.key.toString().startsWith(o.prefix))),Array.isArray(o.filters)&&(j=o.filters.reduce((et,tt)=>filter$1(et,tt),j)),Array.isArray(o.orders)&&(j=o.orders.reduce((et,tt)=>sortAll$1(et,tt),j)),o.offset!=null){let et=0;j=filter$1(j,()=>et++>=o.offset)}return o.limit!=null&&(j=take(j,o.limit)),j}queryKeys(o,$){let j=this._allKeys(o,$);if(o.prefix!=null&&(j=filter$1(j,et=>et.toString().startsWith(o.prefix))),Array.isArray(o.filters)&&(j=o.filters.reduce((et,tt)=>filter$1(et,tt),j)),Array.isArray(o.orders)&&(j=o.orders.reduce((et,tt)=>sortAll$1(et,tt),j)),o.offset!=null){let et=0;j=filter$1(j,()=>et++>=o.offset)}return o.limit!=null&&(j=take(j,o.limit)),j}}let FixedFIFO$1=class{constructor(o){if(!(o>0)||o-1&o)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(o),this.mask=o-1,this.top=0,this.btm=0,this.next=null}push(o){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=o,this.top=this.top+1&this.mask,!0)}shift(){const o=this.buffer[this.btm];if(o!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,o}isEmpty(){return this.buffer[this.btm]===void 0}};class FIFO{constructor(o={}){this.hwm=o.splitLimit??16,this.head=new FixedFIFO$1(this.hwm),this.tail=this.head,this.size=0}calculateSize(o){return(o==null?void 0:o.byteLength)!=null?o.byteLength:1}push(o){if((o==null?void 0:o.value)!=null&&(this.size+=this.calculateSize(o.value)),!this.head.push(o)){const $=this.head;this.head=$.next=new FixedFIFO$1(2*this.head.buffer.length),this.head.push(o)}}shift(){let o=this.tail.shift();if(o===void 0&&this.tail.next!=null){const $=this.tail.next;this.tail.next=null,this.tail=$,o=this.tail.shift()}return(o==null?void 0:o.value)!=null&&(this.size-=this.calculateSize(o.value)),o}isEmpty(){return this.head.isEmpty()}}function pushable(_={}){return _pushable($=>{const j=$.shift();if(j==null)return{done:!0};if(j.error!=null)throw j.error;return{done:j.done===!0,value:j.value}},_)}function pushableV(_={}){return _pushable($=>{let j;const et=[];for(;!$.isEmpty()&&(j=$.shift(),j!=null);){if(j.error!=null)throw j.error;j.done===!1&&et.push(j.value)}return j==null?{done:!0}:{done:j.done===!0,value:et}},_)}function _pushable(_,o){o=o??{};let $=o.onEnd,j=new FIFO,et,tt,rt;const nt=async()=>j.isEmpty()?rt?{done:!0}:await new Promise((ht,mt)=>{tt=gt=>{tt=null,j.push(gt);try{ht(_(j))}catch(Et){mt(Et)}return et}}):_(j),it=ht=>tt!=null?tt(ht):(j.push(ht),et),st=ht=>(j=new FIFO,tt!=null?tt({error:ht}):(j.push({error:ht}),et)),ot=ht=>{if(rt)return et;if((o==null?void 0:o.objectMode)!==!0&&(ht==null?void 0:ht.byteLength)==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return it({done:!1,value:ht})},at=ht=>rt?et:(rt=!0,ht!=null?st(ht):it({done:!0})),ct=()=>(j=new FIFO,at(),{done:!0}),ut=ht=>(at(ht),{done:!0});if(et={[Symbol.asyncIterator](){return this},next:nt,return:ct,throw:ut,push:ot,end:at,get readableLength(){return j.size}},$==null)return et;const ft=et;return et={[Symbol.asyncIterator](){return this},next(){return ft.next()},throw(ht){return ft.throw(ht),$!=null&&($(ht),$=void 0),{done:!0}},return(){return ft.return(),$!=null&&($(),$=void 0),{done:!0}},push:ot,end(ht){return ft.end(ht),$!=null&&($(ht),$=void 0),et},get readableLength(){return ft.readableLength}},et}const log$1y=logger$1("datastore:core:tiered");class TieredDatastore extends BaseDatastore{constructor(o){super(),this.stores=o.slice()}async open(){try{await Promise.all(this.stores.map(o=>o.open()))}catch(o){throw dbOpenFailedError(o)}}async put(o,$,j){try{await Promise.all(this.stores.map(et=>et.put(o,$,j)))}catch(et){throw dbWriteFailedError(et)}}async get(o,$){for(const j of this.stores)try{const et=await j.get(o,$);if(et)return et}catch(et){log$1y.error(et)}throw notFoundError()}async has(o,$){for(const j of this.stores)if(await j.has(o,$))return!0;return!1}async delete(o,$){try{await Promise.all(this.stores.map(j=>j.delete(o,$)))}catch(j){throw dbDeleteFailedError(j)}}async*putMany(o,$={}){let j;const et=this.stores.map(tt=>{const rt=pushable({objectMode:!0});return drain(tt.putMany(rt,$)).catch(nt=>{j=nt}),rt});try{for await(const tt of o){if(j)throw j;et.forEach(rt=>rt.push(tt)),yield tt}}finally{et.forEach(tt=>tt.end())}}async*deleteMany(o,$={}){let j;const et=this.stores.map(tt=>{const rt=pushable({objectMode:!0});return drain(tt.deleteMany(rt,$)).catch(nt=>{j=nt}),rt});try{for await(const tt of o){if(j)throw j;et.forEach(rt=>rt.push(tt)),yield tt}}finally{et.forEach(tt=>tt.end())}}async close(){await Promise.all(this.stores.map(o=>o.close()))}batch(){const o=this.stores.map($=>$.batch());return{put:($,j)=>{o.forEach(et=>et.put($,j))},delete:$=>{o.forEach(j=>j.delete($))},commit:async $=>{for(const j of o)await j.commit($)}}}query(o,$){return this.stores[this.stores.length-1].query(o,$)}queryKeys(o,$){return this.stores[this.stores.length-1].queryKeys(o,$)}}function get$1(_,o,$,j,et){for(o=o.split?o.split("."):o,j=0;j<o.length;j++)_=_?_[o[j]]:et;return _===et?$:_}const ipnsSelector=(_,o)=>{const $=o.map((j,et)=>({entry:IpnsEntry.decode(j),index:et}));return $.sort((j,et)=>{if(j.entry.signatureV2!=null&&et.entry.signatureV2==null)return-1;if(j.entry.signatureV2==null&&et.entry.signatureV2!=null)return 1;const tt=j.entry.sequence??0n,rt=et.entry.sequence??0n;if(tt>rt)return-1;if(tt<rt)return 1;const nt=j.entry.validity??new Uint8Array(0),it=et.entry.validity??new Uint8Array(0),st=parseRFC3339$1(toString$a(nt)),ot=parseRFC3339$1(toString$a(it));return st.getTime()>ot.getTime()?-1:st.getTime()<ot.getTime()?1:0}),$[0].index},SHARDING_FN="SHARDING",README_FN="_README";class MemoryDatastore extends BaseDatastore{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(o,$){this.data[o.toString()]=$}async get(o){if(!await this.has(o))throw notFoundError();return this.data[o.toString()]}async has(o){return this.data[o.toString()]!==void 0}async delete(o){delete this.data[o.toString()]}async*_all(){yield*Object.entries(this.data).map(([o,$])=>({key:new Key(o),value:$}))}async*_allKeys(){yield*Object.entries(this.data).map(([o])=>new Key(o))}}async function*map$3(_,o){for await(const $ of _)yield o($)}async function*merge$1(..._){const o=pushable({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(_.map(async $=>{for await(const j of $)o.push(j)})),o.end()}catch($){o.end($)}}),yield*o}const rawPipe=(..._)=>{let o;for(;_.length>0;)o=_.shift()(o);return o},isIterable$1=_=>_!=null&&(typeof _[Symbol.asyncIterator]=="function"||typeof _[Symbol.iterator]=="function"||typeof _.next=="function"),isDuplex=_=>_!=null&&typeof _.sink=="function"&&isIterable$1(_.source),duplexPipelineFn=_=>o=>{const $=_.sink(o);if($.then!=null){const j=pushable({objectMode:!0});return $.then(()=>{j.end()},tt=>{j.end(tt)}),merge$1(j,async function*(){yield*_.source,j.end()}())}return _.source};function pipe(_,...o){if(isDuplex(_)){const j=_;_=()=>j.source}else if(isIterable$1(_)){const j=_;_=()=>j}const $=[_,...o];if($.length>1&&isDuplex($[$.length-1])&&($[$.length-1]=$[$.length-1].sink),$.length>2)for(let j=1;j<$.length-1;j++)isDuplex($[j])&&($[j]=duplexPipelineFn($[j]));return rawPipe(...$)}new Key(SHARDING_FN);new Key(README_FN);const namespace="/record/";function encodeBase32(_){return toString$a(_,"base32")}function keyToTopic(_){(typeof _=="string"||_ instanceof String)&&(_=fromString$8(_.toString()));const o=toString$a(_,"base64url");return`${namespace}${o}`}function topicToKey(_){if(_.substring(0,namespace.length)!==namespace)throw new CodeError("topic received is not from a record","ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const o=_.substring(namespace.length);return fromString$8(o,"base64url")}const log$1x=logger$1("datastore-pubsub:publisher");class PubSubDatastore extends BaseDatastore{constructor(o,$,j,et,tt,rt){if(super(),!et)throw new CodeError("missing validator","ERR_INVALID_PARAMETERS");if(typeof et!="function")throw new CodeError("missing validate function","ERR_INVALID_PARAMETERS");if(typeof tt!="function")throw new CodeError("missing select function","ERR_INVALID_PARAMETERS");if(rt&&typeof rt!="function")throw new CodeError("invalid subscriptionKeyFn received","ERR_INVALID_PARAMETERS");this._pubsub=o,this._datastore=$,this._peerId=j,this._validator=et,this._selector=tt,this._handleSubscriptionKeyFn=rt,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(o,$,j){if(!(o instanceof Uint8Array)){const tt="datastore key does not have a valid format";throw log$1x.error(tt),new CodeError(tt,"ERR_INVALID_DATASTORE_KEY")}if(!($ instanceof Uint8Array)){const tt="received value is not a Uint8Array";throw log$1x.error(tt),new CodeError(tt,"ERR_INVALID_VALUE_RECEIVED")}const et=keyToTopic(o);log$1x(`publish value for topic ${et}`),await this._pubsub.publish(et,$)}async get(o,$){if(!(o instanceof Uint8Array)){const tt="datastore key does not have a valid format";throw log$1x.error(tt),new CodeError(tt,"ERR_INVALID_DATASTORE_KEY")}const j=keyToTopic(o),et=await this._pubsub.getTopics();if(et&&Array.isArray(et)&&et.indexOf(j)>-1)return this._getLocal(o,$);try{await this._pubsub.subscribe(j)}catch{const rt=`cannot subscribe topic ${j}`;throw log$1x.error(rt),new CodeError(rt,"ERR_SUBSCRIBING_TOPIC")}return log$1x(`subscribed values for key ${j}`),this._getLocal(o)}unsubscribe(o){const $=keyToTopic(o);return this._pubsub.unsubscribe($)}async _getLocal(o,$){const j=new Key("/"+encodeBase32(o),!1);let et;try{et=await this._datastore.get(j,$)}catch(tt){if(tt.code!=="ERR_NOT_FOUND"){const nt=`unexpected error getting the ipns record for ${j.toString()}`;throw log$1x.error(nt),new CodeError(nt,"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const rt=`local record requested was not found for ${j.toString()}`;throw log$1x.error(rt),new CodeError(rt,"ERR_NOT_FOUND")}if(!(et instanceof Uint8Array)){const tt="found record that we couldn't convert to a value";throw log$1x.error(tt),new CodeError(tt,"ERR_INVALID_RECORD_RECEIVED")}return et}async _onMessage(o){const $=o.detail;if($.type!=="signed"){log$1x.error("unsigned message received, this module can only work with signed messages");return}const{data:j,from:et,topic:tt}=$;let rt;try{rt=topicToKey(tt)}catch(nt){log$1x.error(nt);return}if(log$1x(`message received for topic ${tt}`),this._peerId.equals(et)){log$1x("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let nt;try{nt=await this._handleSubscriptionKeyFn(rt)}catch{log$1x.error("message discarded by the subscriptionKeyFn");return}rt=nt}try{await this._storeIfSubscriptionIsBetter(rt,j)}catch(nt){log$1x.error(nt)}}async _storeIfSubscriptionIsBetter(o,$,j){let et=!1;try{et=await this._isBetter(o,$)}catch(tt){if(tt.code!=="ERR_NOT_VALID_RECORD")throw tt}et&&await this._storeRecord(o,$,j)}async _validateRecord(o,$){return this._validator(o,$)}async _selectRecord(o,$){return await this._selector(o,$)===0}async _isBetter(o,$){try{await this._validateRecord(o,$)}catch{const rt="record received through pubsub is not valid";throw log$1x.error(rt),new CodeError(rt,"ERR_NOT_VALID_RECORD")}const j=new Key(o);let et;try{et=await this._getLocal(j.uint8Array())}catch{return!0}return equals$6(et,$)?!1:this._selectRecord(o,[et,$])}async _storeRecord(o,$,j){const et=new Key("/"+encodeBase32(o),!1);await this._datastore.put(et,$,j),log$1x(`record for ${keyToTopic(o)} was stored in the datastore`)}}const log$1w=logger$1("ipfs:ipns:pubsub");class IpnsPubsubDatastore{constructor(o,$,j){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new PubSubDatastore(o,$,j,ipnsValidator,ipnsSelector,this._handleSubscriptionKey)}async put(o,$,j){try{await this._pubsubDs.put(o,$,j)}catch(et){throw log$1w.error(et),et}}async get(o,$){let j,et;try{j=await this._pubsubDs.get(o,$)}catch(rt){et=rt}const tt=o.slice(0,namespaceLength);if(toString$a(tt)===namespace$1){const rt=base58btc$4.encode(o).substring(1),nt=base58btc$4.encode(o.slice(namespaceLength)).substring(1);this._subscriptions[rt]=nt,log$1w(`subscribed to pubsub topic ${rt}, id ${nt}`)}if(et)throw et;return j}_handleSubscriptionKey(o){o instanceof Uint8Array&&(o=toString$a(o,"base58btc"));const $=this._subscriptions[o];if(!$)throw errCode(new Error(`key ${o} does not correspond to a subscription`),"ERR_INVALID_KEY");try{return peerIdToRoutingKey(peerIdFromString($))}catch(j){throw log$1w.error(j),j}}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map($=>`${namespace$1}${$}`)}async cancel(o){if(typeof o!="string")throw errCode(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");o.startsWith(namespace$1)&&(o=o.substring(namespaceLength));const $=Object.keys(this._subscriptions).find(et=>this._subscriptions[et]===o);if(!$)return{canceled:!1};const j=fromString$8($);return this._pubsubDs.unsubscribe(j),delete this._subscriptions[$],log$1w(`unsubscribed pubsub ${$}: ${o}`),{canceled:!0}}}var Record$2;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.key!=null&&$.key.byteLength>0&&(j.uint32(10),j.bytes($.key)),$.value!=null&&$.value.byteLength>0&&(j.uint32(18),j.bytes($.value)),$.timeReceived!=null&&$.timeReceived!==""&&(j.uint32(42),j.string($.timeReceived)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.key=$.bytes();break;case 2:et.value=$.bytes();break;case 5:et.timeReceived=$.string();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Record$2||(Record$2={}));function toRFC3339(_){const o=_.getUTCFullYear(),$=String(_.getUTCMonth()+1).padStart(2,"0"),j=String(_.getUTCDate()).padStart(2,"0"),et=String(_.getUTCHours()).padStart(2,"0"),tt=String(_.getUTCMinutes()).padStart(2,"0"),rt=String(_.getUTCSeconds()).padStart(2,"0"),nt=_.getUTCMilliseconds(),it=String(nt*1e3*1e3).padStart(9,"0");return`${o}-${$}-${j}T${et}:${tt}:${rt}.${it}Z`}function parseRFC3339(_){const o=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),$=String(_).trim().match(o);if($==null)throw new Error("Invalid format");const j=parseInt($[1],10),et=parseInt($[2],10)-1,tt=parseInt($[3],10),rt=parseInt($[4],10),nt=parseInt($[5],10),it=parseInt($[6],10),st=parseInt($[7].slice(0,-6),10);return new Date(Date.UTC(j,et,tt,rt,nt,it,st))}class Libp2pRecord{constructor(o,$,j){if(!(o instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!($ instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=o,this.value=$,this.timeReceived=j}serialize(){return Record$2.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:toRFC3339(this.timeReceived)}}static deserialize(o){const $=Record$2.decode(o);return new Libp2pRecord($.key,$.value,new Date($.timeReceived))}static fromDeserialized(o){const $=parseRFC3339(o.timeReceived);if(o.key==null)throw new Error("key missing from deserialized object");if(o.value==null)throw new Error("value missing from deserialized object");return new Libp2pRecord(o.key,o.value,$)}}const log$1v=logger$1("ipfs:ipns:offline-datastore");class OfflineDatastore{constructor(o){this._datastore=o,this.stores=[]}async put(o,$,j){if(!(o instanceof Uint8Array))throw errCode(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!($ instanceof Uint8Array))throw errCode(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let et;try{et=this._routingKey(o)}catch(rt){throw log$1v.error(rt),errCode(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const tt=new Libp2pRecord(o,$,new Date);await this._datastore.put(et,tt.serialize(),j)}async get(o,$){if(!(o instanceof Uint8Array))throw errCode(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let j;try{j=this._routingKey(o)}catch(rt){throw log$1v.error(rt),errCode(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const et=await this._datastore.get(j,$);let tt;try{tt=Libp2pRecord.deserialize(et)}catch(rt){throw log$1v.error(rt),rt}return tt.value}_routingKey(o){return new Key("/dht/record/"+toString$a(o,"base32"),!1)}}const log$1u=logger$1("ipfs:ipns:dht-datastore");class DHTDatastore{constructor(o){this._dht=o}async put(o,$,j){try{await drain(this._dht.put(o,$,j))}catch(et){throw log$1u.error(et),et}}async get(o,$){for await(const j of this._dht.get(o,$))if(j.name==="VALUE")return j.value;throw notFoundError()}}function createRouting({libp2p:_,repo:o,peerId:$,options:j}){const et=[];let tt;if(get$1(j,"EXPERIMENTAL.ipnsPubsub",!1)&&(tt=new IpnsPubsubDatastore(_.pubsub,o.datastore,$),et.push(tt)),get$1(j,"offline",!1)!==!0&&["dht","dhtclient","dhtserver"].includes(get$1(j,"config.Routing.Type","none"))&&et.push(new DHTDatastore(_.dht)),get$1(j,"offline",!1)||et.length===0){const rt=new OfflineDatastore(o.datastore);et.push(rt)}return new TieredDatastore(et)}const log$1t=logger$1("ipfs:components:ipns");class IPNSAPI{constructor(o={pass:""}){this.options=o,this.offline=null,this.online=null}getIPNS(){const o=this.online||this.offline;if(o)return o;throw new NotInitializedError}get routing(){return this.getIPNS().routing}startOffline({repo:o,peerId:$,keychain:j}){if(this.offline!=null)throw new AlreadyInitializedError;log$1t("initializing IPNS keyspace (offline)");const et=new OfflineDatastore(o.datastore),tt=new IPNS(et,o.datastore,$,j,this.options);this.offline=tt}async startOnline({libp2p:o,repo:$,peerId:j,keychain:et}){if(this.online!=null)throw new AlreadyInitializedError;const tt=createRouting({libp2p:o,repo:$,peerId:j,options:this.options}),rt=new IPNS(tt,$.datastore,j,et,this.options);await rt.republisher.start(),this.online=rt}async stop(){const o=this.online;o&&(await o.republisher.stop(),this.online=null)}publish(o,$,j,et){return this.getIPNS().publish(o,$,j,et)}resolve(o,$){return this.getIPNS().resolve(o,$)}initializeKeyspace(o,$,j){return this.getIPNS().initializeKeyspace(o,$,j)}}async function resolvePath({ipns:_,repo:o,codecs:$},j,et){if(ipnsPath(j))return _.resolve(j);const{cid:tt,path:rt}=toCidAndPath(j);await drain(resolve$5(tt,rt||"",$,o,et))}const log$1s=logger$1("ipfs:name:publish");function createPublish$2({ipns:_,repo:o,codecs:$,peerId:j,isOnline:et,keychain:tt}){const rt=async it=>{let st;if(it==="self"&&j.privateKey!=null)st=await unmarshalPrivateKey(j.privateKey);else try{const ot=await tt.exportKey(it,"temp");st=await importKey(ot,"temp")}catch(ot){throw log$1s.error(ot),errCode(ot,"ERR_CANNOT_GET_KEY")}return peerIdFromKeys(st.public.bytes,st.bytes)};async function nt(it,st={}){const ot=st.resolve!==!1,at=st.lifetime||"24h",ct=st.key||"self";if(!et())throw errCode(new Error(OFFLINE_ERROR),"OFFLINE_ERROR");try{it=normalizePath(it)}catch(gt){throw log$1s.error(gt),gt}let ut=0;try{ut=parse$4(at)||0,ut=parseFloat(ut.toFixed(6))}catch(gt){throw log$1s.error(gt),gt}const ft=await Promise.all([rt(ct),ot?resolvePath({ipns:_,repo:o,codecs:$},it):Promise.resolve()]),ht=fromString$8(it),mt=await _.publish(ft[0],ht,ut,st);return{name:mt.name,value:toString$a(mt.value)}}return withTimeoutOption(nt)}var domainNameRegex=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i,isDomainName=function _(o,$){if($==null&&($=!1),o.length<2||o.length>255)return!1;var j=o[o.length-1];if($){if(j!==".")return!1}else if(j===".")return!1;return domainNameRegex.test(o)};const mergeOptions$e=mergeOptions$g.bind({ignoreUndefined:!0}),log$1r=logger$1("ipfs:name:resolve"),appendRemainder=(_,o)=>o.length>0?_+"/"+o.join("/"):_;function createResolve$4({dns:_,ipns:o,isOnline:$,options:{offline:j}}){async function*et(tt,rt={}){if(rt=mergeOptions$e({nocache:!1,recursive:!0},rt),j&&rt&&rt.nocache)throw errCode(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!$()&&!j)throw errCode(new Error(OFFLINE_ERROR),"OFFLINE_ERROR");let nt=tt.toString();nt.startsWith("/ipns/")||(nt=`/ipns/${nt}`);let[it,st,...ot]=nt.slice(1).split("/");try{if(st.substring(0,1)==="1"){const ct=peerIdFromString(st),ut=decode$B(ct.toBytes());st=CID$3.createV1(114,ut).toString(base36$4)}else{const ct=CID$3.parse(st);ct.version===1&&(st=ct.toString(base36$4))}}catch(ct){if(isDomainName(st)){yield appendRemainder(await _(st,rt),ot);return}throw log$1r.error(ct),errCode(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}const at=await o.resolve(`/${it}/${st}`,rt);yield appendRemainder(at instanceof Uint8Array?toString$a(at):at,ot)}return withTimeoutOption(et)}function getPubsubRouting(_,o){if(!_||!(o&&o.ipnsPubsub))throw errCode(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(_.routing instanceof IpnsPubsubDatastore)return _.routing;const $=(_.routing.stores||[]).find(j=>j instanceof IpnsPubsubDatastore);if(!$)throw errCode(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return $}function createCancel$1({ipns:_,options:o}){const $=o.EXPERIMENTAL;async function j(et,tt={}){return getPubsubRouting(_,$).cancel(et,tt)}return withTimeoutOption(j)}function createState$1({ipns:_,options:o}){const $=o.EXPERIMENTAL;async function j(et={}){try{return{enabled:!!getPubsubRouting(_,$)}}catch{return{enabled:!1}}}return withTimeoutOption(j)}function createSubs$1({ipns:_,options:o}){const $=o.EXPERIMENTAL;async function j(et={}){return getPubsubRouting(_,$).getSubscriptions(et)}return withTimeoutOption(j)}class PubSubAPI{constructor({ipns:o,options:$}){this.cancel=createCancel$1({ipns:o,options:$}),this.state=createState$1({ipns:o,options:$}),this.subs=createSubs$1({ipns:o,options:$})}}class NameAPI{constructor({dns:o,ipns:$,repo:j,codecs:et,peerId:tt,isOnline:rt,keychain:nt,options:it}){this.publish=createPublish$2({ipns:$,repo:j,codecs:et,peerId:tt,isOnline:rt,keychain:nt}),this.resolve=createResolve$4({dns:o,ipns:$,isOnline:rt,options:it}),this.pubsub=new PubSubAPI({ipns:$,options:it})}}const ERR_NOT_FOUND$1=notFoundError().code,Format={default:"<dst>",edges:"<src> -> <dst>"};function createRefs$1({repo:_,codecs:o,resolve:$,preload:j}){async function*et(tt,rt={}){if(rt.maxDepth===0)return;if(rt.edges&&rt.format&&rt.format!==Format.default)throw new Error("Cannot set edges to true and also specify format");if(rt.format=rt.edges?Format.edges:rt.format,typeof rt.maxDepth!="number"&&(rt.maxDepth=rt.recursive?1/0:1),rt.timeout){const ot=[new timeoutAbortController.TimeoutController(rt.timeout).signal];rt.signal&&ot.push(rt.signal),rt.signal=anySignal_2(ot)}const it=(Array.isArray(tt)?tt:[tt]).map(st=>getFullPath(j,st,rt));for(const st of it)try{yield*refsStream($,_,o,st,rt)}catch(ot){yield{ref:"",err:ot.message}}}return et}function getFullPath(_,o,$){const{cid:j,path:et}=toCidAndPath(o);return $.preload!==!1&&_(j),`/ipfs/${j}${et||""}`}async function*refsStream(_,o,$,j,et){const tt=await _(j,et),{cid:rt}=toCidAndPath(tt),nt=et.maxDepth!=null?et.maxDepth:1/0,it=et.unique||!1;for await(const st of objectStream(o,$,rt,nt,it,et))st.parent&&(st.isDuplicate||(yield{ref:formatLink(st.parent.cid,st.node.cid,st.node.name,et.format)}))}function formatLink(_,o,$="",j=Format.default){let et=j.replace(/<src>/g,_.toString());return et=et.replace(/<dst>/g,o.toString()),et=et.replace(/<linkname>/g,$),et}async function*objectStream(_,o,$,j,et,tt){const rt=new Set;async function*nt(it,st){const ot=st+1;if(!(ot>j))try{for await(const at of getLinks(_,o,it.cid,tt))yield{parent:it,node:at,isDuplicate:et&&rt.has(at.cid.toString())},et&&rt.add(at.cid.toString()),yield*nt(at,ot)}catch(at){throw at.code===ERR_NOT_FOUND$1&&(at.message=`Could not find object with CID: ${it.cid}`),at}}yield*nt({cid:$},0)}async function*getLinks(_,o,$,j){const et=await _.blocks.get($,j),rt=(await o.getCodec($.code)).decode(et),nt=$.code===code$9,it=[];for(const[st,ot]of links(rt,it)){if(nt){const at=st.match(/^Links\/(\d+)\/Hash$/);if(at){const ct=Number(at[1]);if(ct<rt.Links.length){yield{name:rt.Links[ct].Name,cid:ot};continue}}}yield{name:st,cid:ot}}}const links=function*(_,o){if(_!=null&&!(_ instanceof Uint8Array)){for(const[$,j]of Object.entries(_)){const et=[...o,$];if(j!=null&&typeof j=="object")if(Array.isArray(j))for(const[tt,rt]of j.entries()){const nt=[...et,tt],it=CID$3.asCID(rt);it?yield[nt.join("/"),it]:typeof rt=="object"&&(yield*links(rt,nt))}else{const tt=CID$3.asCID(j);tt?yield[et.join("/"),tt]:yield*links(j,et)}}return[]}};function createLocal$1({repo:_}){async function*o($={}){for await(const j of _.blocks.queryKeys({},{signal:$.signal}))yield{ref:j.toString()}}return withTimeoutOption(o)}function createWantlist$1({network:_}){async function o($={}){const{bitswap:j}=await _.use($),et=j.getWantlist();return Array.from(et).map(tt=>tt[1].cid)}return withTimeoutOption(o)}function createWantlistForPeer$1({network:_}){async function o($,j={}){const{bitswap:et}=await _.use(j),tt=et.wantlistForPeer($);return Array.from(tt).map(rt=>rt[1].cid)}return withTimeoutOption(o)}function createUnwant$1({network:_}){async function o($,j={}){const{bitswap:et}=await _.use(j);return Array.isArray($)||($=[$]),et.unwant($)}return withTimeoutOption(o)}function createStat$9({network:_}){async function o($={}){const j=(await _.use($)).bitswap,et=j.stat().snapshot;return{provideBufLen:parseInt(et.providesBufferLength.toString()),blocksReceived:BigInt(et.blocksReceived.toString()),wantlist:Array.from(j.getWantlist()).map(tt=>tt[1].cid),peers:j.peers(),dupBlksReceived:BigInt(et.dupBlksReceived.toString()),dupDataReceived:BigInt(et.dupDataReceived.toString()),dataReceived:BigInt(et.dataReceived.toString()),blocksSent:BigInt(et.blocksSent.toString()),dataSent:BigInt(et.dataSent.toString())}}return withTimeoutOption(o)}class BitswapAPI{constructor({network:o}){this.wantlist=createWantlist$1({network:o}),this.wantlistForPeer=createWantlistForPeer$1({network:o}),this.unwant=createUnwant$1({network:o}),this.stat=createStat$9({network:o})}}function isValidMultiaddr(_){try{return IPFS$1.matches(_)}catch{return!1}}function createAdd$6({repo:_}){async function o($,j={}){if(!isValidMultiaddr($))throw new Error(`${$} is not a valid Multiaddr`);const et=await _.config.getAll(j),tt=et.Bootstrap||[];return tt.push($.toString()),et.Bootstrap=Array.from(new Set(tt)).sort((rt,nt)=>rt.localeCompare(nt)),await _.config.replace(et),{Peers:[$]}}return withTimeoutOption(o)}function createClear$1({repo:_}){async function o($={}){const j=await _.config.getAll($),et=j.Bootstrap||[];return j.Bootstrap=[],await _.config.replace(j),{Peers:et.map(tt=>multiaddr$3(tt))}}return withTimeoutOption(o)}function createList$4({repo:_}){async function o($={}){return{Peers:(await _.config.get("Bootstrap",$)||[]).map(et=>multiaddr$3(et))}}return withTimeoutOption(o)}const getDefaultConfig=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});function createReset$1({repo:_}){async function o($={}){const j=await _.config.getAll($);return j.Bootstrap=getDefaultConfig().Bootstrap,await _.config.replace(j),{Peers:getDefaultConfig().Bootstrap.map(et=>multiaddr$3(et))}}return withTimeoutOption(o)}function createRm$a({repo:_}){async function o($,j={}){if(!isValidMultiaddr($))throw new Error(`${$} is not a valid Multiaddr`);const et=await _.config.getAll(j);return et.Bootstrap=(et.Bootstrap||[]).filter(tt=>tt.toString()!==$.toString()),await _.config.replace(et),{Peers:[$]}}return withTimeoutOption(o)}class BootstrapAPI{constructor({repo:o}){this.add=createAdd$6({repo:o}),this.list=createList$4({repo:o}),this.rm=createRm$a({repo:o}),this.clear=createClear$1({repo:o}),this.reset=createReset$1({repo:o})}}function createGet$9({preload:_,repo:o}){async function $(j,et={}){return et.preload!==!1&&_(j),o.blocks.get(j,et)}return withTimeoutOption($)}function createPut$6({codecs:_,hashers:o,repo:$,preload:j}){async function et(tt,rt={}){const nt=rt.pin?await $.gcLock.readLock():null;try{const it=rt.version!=null?rt.version:0,st=rt.format||(it===0?"dag-pb":"raw"),at=await(await o.getHasher(rt.mhtype||"sha2-256")).digest(tt),ct=await _.getCodec(st),ut=CID$3.create(it,ct.code,at);return await $.blocks.put(ut,tt,{signal:rt.signal}),rt.preload!==!1&&j(ut),rt.pin===!0&&await $.pins.pinRecursively(ut,{signal:rt.signal}),ut}finally{nt&&nt()}}return withTimeoutOption(et)}function pDefer$1(){const _={};return _.promise=new Promise((o,$)=>{_.resolve=o,_.reject=$}),_}const CustomEvent$1=globalThis.CustomEvent??Event;async function*parallel(_,o={}){let $=o.concurrency??1/0;$<1&&($=1/0);const j=o.ordered==null?!1:o.ordered,et=new EventTarget,tt=[];let rt=pDefer$1(),nt=pDefer$1(),it=!1,st,ot=!1;et.addEventListener("task-complete",()=>{nt.resolve()}),Promise.resolve().then(async()=>{try{for await(const ft of _){if(tt.length===$&&(rt=pDefer$1(),await rt.promise),ot)break;const ht={done:!1};tt.push(ht),ft().then(mt=>{ht.done=!0,ht.ok=!0,ht.value=mt,et.dispatchEvent(new CustomEvent$1("task-complete"))},mt=>{ht.done=!0,ht.err=mt,et.dispatchEvent(new CustomEvent$1("task-complete"))})}it=!0,et.dispatchEvent(new CustomEvent$1("task-complete"))}catch(ft){st=ft,et.dispatchEvent(new CustomEvent$1("task-complete"))}});function at(){var ft;return j?(ft=tt[0])==null?void 0:ft.done:!!tt.find(ht=>ht.done)}function*ct(){for(;tt.length>0&&tt[0].done;){const ft=tt[0];if(tt.shift(),ft.ok)yield ft.value;else throw ot=!0,rt.resolve(),ft.err;rt.resolve()}}function*ut(){for(;at();)for(let ft=0;ft<tt.length;ft++)if(tt[ft].done){const ht=tt[ft];if(tt.splice(ft,1),ft--,ht.ok)yield ht.value;else throw ot=!0,rt.resolve(),ht.err;rt.resolve()}}for(;;){if(at()||(nt=pDefer$1(),await nt.promise),st!=null)throw st;if(j?yield*ct():yield*ut(),it&&tt.length===0)break}}function cleanCid(_){return _ instanceof Uint8Array?CID$3.decode(_):CID$3.parse(_.toString())}const BLOCK_RM_CONCURRENCY$1=8;function createRm$9({repo:_}){async function*o($,j={}){Array.isArray($)||($=[$]);const et=await _.gcLock.writeLock();try{yield*pipe($,tt=>map$3(tt,rt=>async()=>{rt=cleanCid(rt);const nt={cid:rt};try{if(!await _.blocks.has(rt))throw errCode(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await _.blocks.delete(rt)}catch(it){j.force||(it.message=`cannot remove ${rt}: ${it.message}`,nt.error=it)}return nt}),tt=>parallel(tt,{concurrency:BLOCK_RM_CONCURRENCY$1}),tt=>filter$1(tt,()=>!j.quiet))}finally{et()}}return withTimeoutOption(o)}function createStat$8({repo:_,preload:o}){async function $(j,et={}){j=cleanCid(j),et.preload!==!1&&o(j);const tt=await _.blocks.get(j);return{cid:j,size:tt.length}}return withTimeoutOption($)}class BlockAPI{constructor({codecs:o,hashers:$,preload:j,repo:et}){this.get=createGet$9({preload:j,repo:et}),this.put=createPut$6({codecs:o,hashers:$,preload:j,repo:et}),this.rm=createRm$9({repo:et}),this.stat=createStat$8({preload:j,repo:et})}}async function*browserReadableStreamToIt(_,o={}){const $=_.getReader();try{for(;;){const j=await $.read();if(j.done)return;yield j.value}}finally{o.preventCancel!==!0&&await $.cancel(),$.releaseLock()}}function blobToIt(_){return typeof _.stream=="function"?browserReadableStreamToIt(_.stream()):browserReadableStreamToIt(new Response(_).body)}function peekableIterator(_){const[o,$]=_[Symbol.asyncIterator]!=null?[_[Symbol.asyncIterator](),Symbol.asyncIterator]:[_[Symbol.iterator](),Symbol.iterator],j=[];return{peek:()=>o.next(),push:et=>{j.push(et)},next:()=>j.length>0?{done:!1,value:j.shift()}:o.next(),[$](){return this}}}function isBytes(_){return ArrayBuffer.isView(_)||_ instanceof ArrayBuffer}function isBlob(_){return _.constructor&&(_.constructor.name==="Blob"||_.constructor.name==="File")&&typeof _.stream=="function"}function isFileObject(_){return typeof _=="object"&&(_.path||_.content)}const isReadableStream=_=>_&&typeof _.getReader=="function";async function*toAsyncIterable(_){yield _}async function normaliseContent$1(_){if(isBytes(_))return toAsyncIterable(toBytes$2(_));if(typeof _=="string"||_ instanceof String)return toAsyncIterable(toBytes$2(_.toString()));if(isBlob(_))return blobToIt(_);if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const o=peekableIterator(_),{value:$,done:j}=await o.peek();if(j)return toAsyncIterable(new Uint8Array(0));if(o.push($),Number.isInteger($))return toAsyncIterable(Uint8Array.from(await all$1(o)));if(isBytes($)||typeof $=="string"||$ instanceof String)return map$3(o,toBytes$2)}throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT")}function toBytes$2(_){return _ instanceof Uint8Array?_:ArrayBuffer.isView(_)?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_ instanceof ArrayBuffer?new Uint8Array(_):Array.isArray(_)?Uint8Array.from(_):fromString$8(_.toString())}async function*normaliseCandidateSingle(_,o){if(_==null)throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT");if(typeof _=="string"||_ instanceof String){yield toFileObject$1(_.toString(),o);return}if(isBytes(_)||isBlob(_)){yield toFileObject$1(_,o);return}if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const $=peekableIterator(_),{value:j,done:et}=await $.peek();if(et){yield{content:[]};return}if($.push(j),Number.isInteger(j)||isBytes(j)||typeof j=="string"||j instanceof String){yield toFileObject$1($,o);return}throw errCode(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(isFileObject(_)){yield toFileObject$1(_,o);return}throw errCode(new Error('Unexpected input: cannot convert "'+typeof _+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function toFileObject$1(_,o){const{path:$,mode:j,mtime:et,content:tt}=_,rt={path:$||"",mode:parseMode(j),mtime:parseMtime$1(et)};return tt?rt.content=await o(tt):$||(rt.content=await o(_)),rt}function normaliseInput$2(_){return normaliseCandidateSingle(_,normaliseContent$1)}function createAdd$5({addAll:_}){async function o($,j={}){const et=await last(_(normaliseInput$2($),j));if(et==null)throw Error("Failed to add a file, if you see this please report a bug");return et}return o}async function*batch(_,o=1){let $=[];o<1&&(o=1);for await(const j of _)for($.push(j);$.length>=o;)yield $.slice(0,o),$=$.slice(o);for(;$.length>0;)yield $.slice(0,o),$=$.slice(o)}async function*parallelBatch(_,o=1){for await(const $ of batch(_,o)){const j=$.map(async et=>await et().then(tt=>({ok:!0,value:tt}),tt=>({ok:!1,err:tt})));for(let et=0;et<j.length;et++){const tt=await j[et];if(tt.ok)yield tt.value;else throw tt.err}}}var murmurhash3jsRevisitedExports={},murmurhash3jsRevisited={get exports(){return murmurhash3jsRevisitedExports},set exports(_){murmurhash3jsRevisitedExports=_}},murmurHash3jsExports={},murmurHash3js={get exports(){return murmurHash3jsExports},set exports(_){murmurHash3jsExports=_}};(function(_,o){(function($,j){var et={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function tt(ht){if(!Array.isArray(ht)&&!ArrayBuffer.isView(ht))return!1;for(var mt=0;mt<ht.length;mt++)if(!Number.isInteger(ht[mt])||ht[mt]<0||ht[mt]>255)return!1;return!0}function rt(ht,mt){return(ht&65535)*mt+(((ht>>>16)*mt&65535)<<16)}function nt(ht,mt){return ht<<mt|ht>>>32-mt}function it(ht){return ht^=ht>>>16,ht=rt(ht,2246822507),ht^=ht>>>13,ht=rt(ht,3266489909),ht^=ht>>>16,ht}function st(ht,mt){ht=[ht[0]>>>16,ht[0]&65535,ht[1]>>>16,ht[1]&65535],mt=[mt[0]>>>16,mt[0]&65535,mt[1]>>>16,mt[1]&65535];var gt=[0,0,0,0];return gt[3]+=ht[3]+mt[3],gt[2]+=gt[3]>>>16,gt[3]&=65535,gt[2]+=ht[2]+mt[2],gt[1]+=gt[2]>>>16,gt[2]&=65535,gt[1]+=ht[1]+mt[1],gt[0]+=gt[1]>>>16,gt[1]&=65535,gt[0]+=ht[0]+mt[0],gt[0]&=65535,[gt[0]<<16|gt[1],gt[2]<<16|gt[3]]}function ot(ht,mt){ht=[ht[0]>>>16,ht[0]&65535,ht[1]>>>16,ht[1]&65535],mt=[mt[0]>>>16,mt[0]&65535,mt[1]>>>16,mt[1]&65535];var gt=[0,0,0,0];return gt[3]+=ht[3]*mt[3],gt[2]+=gt[3]>>>16,gt[3]&=65535,gt[2]+=ht[2]*mt[3],gt[1]+=gt[2]>>>16,gt[2]&=65535,gt[2]+=ht[3]*mt[2],gt[1]+=gt[2]>>>16,gt[2]&=65535,gt[1]+=ht[1]*mt[3],gt[0]+=gt[1]>>>16,gt[1]&=65535,gt[1]+=ht[2]*mt[2],gt[0]+=gt[1]>>>16,gt[1]&=65535,gt[1]+=ht[3]*mt[1],gt[0]+=gt[1]>>>16,gt[1]&=65535,gt[0]+=ht[0]*mt[3]+ht[1]*mt[2]+ht[2]*mt[1]+ht[3]*mt[0],gt[0]&=65535,[gt[0]<<16|gt[1],gt[2]<<16|gt[3]]}function at(ht,mt){return mt%=64,mt===32?[ht[1],ht[0]]:mt<32?[ht[0]<<mt|ht[1]>>>32-mt,ht[1]<<mt|ht[0]>>>32-mt]:(mt-=32,[ht[1]<<mt|ht[0]>>>32-mt,ht[0]<<mt|ht[1]>>>32-mt])}function ct(ht,mt){return mt%=64,mt===0?ht:mt<32?[ht[0]<<mt|ht[1]>>>32-mt,ht[1]<<mt]:[ht[1]<<mt-32,0]}function ut(ht,mt){return[ht[0]^mt[0],ht[1]^mt[1]]}function ft(ht){return ht=ut(ht,[0,ht[0]>>>1]),ht=ot(ht,[4283543511,3981806797]),ht=ut(ht,[0,ht[0]>>>1]),ht=ot(ht,[3301882366,444984403]),ht=ut(ht,[0,ht[0]>>>1]),ht}et.x86.hash32=function(ht,mt){if(et.inputValidation&&!tt(ht))return j;mt=mt||0;for(var gt=ht.length%4,Et=ht.length-gt,St=mt,At=0,kt=3432918353,Rt=461845907,Tt=0;Tt<Et;Tt=Tt+4)At=ht[Tt]|ht[Tt+1]<<8|ht[Tt+2]<<16|ht[Tt+3]<<24,At=rt(At,kt),At=nt(At,15),At=rt(At,Rt),St^=At,St=nt(St,13),St=rt(St,5)+3864292196;switch(At=0,gt){case 3:At^=ht[Tt+2]<<16;case 2:At^=ht[Tt+1]<<8;case 1:At^=ht[Tt],At=rt(At,kt),At=nt(At,15),At=rt(At,Rt),St^=At}return St^=ht.length,St=it(St),St>>>0},et.x86.hash128=function(ht,mt){if(et.inputValidation&&!tt(ht))return j;mt=mt||0;for(var gt=ht.length%16,Et=ht.length-gt,St=mt,At=mt,kt=mt,Rt=mt,Tt=0,Dt=0,Ot=0,jt=0,Nt=597399067,It=2869860233,yt=951274213,lt=2716044179,pt=0;pt<Et;pt=pt+16)Tt=ht[pt]|ht[pt+1]<<8|ht[pt+2]<<16|ht[pt+3]<<24,Dt=ht[pt+4]|ht[pt+5]<<8|ht[pt+6]<<16|ht[pt+7]<<24,Ot=ht[pt+8]|ht[pt+9]<<8|ht[pt+10]<<16|ht[pt+11]<<24,jt=ht[pt+12]|ht[pt+13]<<8|ht[pt+14]<<16|ht[pt+15]<<24,Tt=rt(Tt,Nt),Tt=nt(Tt,15),Tt=rt(Tt,It),St^=Tt,St=nt(St,19),St+=At,St=rt(St,5)+1444728091,Dt=rt(Dt,It),Dt=nt(Dt,16),Dt=rt(Dt,yt),At^=Dt,At=nt(At,17),At+=kt,At=rt(At,5)+197830471,Ot=rt(Ot,yt),Ot=nt(Ot,17),Ot=rt(Ot,lt),kt^=Ot,kt=nt(kt,15),kt+=Rt,kt=rt(kt,5)+2530024501,jt=rt(jt,lt),jt=nt(jt,18),jt=rt(jt,Nt),Rt^=jt,Rt=nt(Rt,13),Rt+=St,Rt=rt(Rt,5)+850148119;switch(Tt=0,Dt=0,Ot=0,jt=0,gt){case 15:jt^=ht[pt+14]<<16;case 14:jt^=ht[pt+13]<<8;case 13:jt^=ht[pt+12],jt=rt(jt,lt),jt=nt(jt,18),jt=rt(jt,Nt),Rt^=jt;case 12:Ot^=ht[pt+11]<<24;case 11:Ot^=ht[pt+10]<<16;case 10:Ot^=ht[pt+9]<<8;case 9:Ot^=ht[pt+8],Ot=rt(Ot,yt),Ot=nt(Ot,17),Ot=rt(Ot,lt),kt^=Ot;case 8:Dt^=ht[pt+7]<<24;case 7:Dt^=ht[pt+6]<<16;case 6:Dt^=ht[pt+5]<<8;case 5:Dt^=ht[pt+4],Dt=rt(Dt,It),Dt=nt(Dt,16),Dt=rt(Dt,yt),At^=Dt;case 4:Tt^=ht[pt+3]<<24;case 3:Tt^=ht[pt+2]<<16;case 2:Tt^=ht[pt+1]<<8;case 1:Tt^=ht[pt],Tt=rt(Tt,Nt),Tt=nt(Tt,15),Tt=rt(Tt,It),St^=Tt}return St^=ht.length,At^=ht.length,kt^=ht.length,Rt^=ht.length,St+=At,St+=kt,St+=Rt,At+=St,kt+=St,Rt+=St,St=it(St),At=it(At),kt=it(kt),Rt=it(Rt),St+=At,St+=kt,St+=Rt,At+=St,kt+=St,Rt+=St,("00000000"+(St>>>0).toString(16)).slice(-8)+("00000000"+(At>>>0).toString(16)).slice(-8)+("00000000"+(kt>>>0).toString(16)).slice(-8)+("00000000"+(Rt>>>0).toString(16)).slice(-8)},et.x64.hash128=function(ht,mt){if(et.inputValidation&&!tt(ht))return j;mt=mt||0;for(var gt=ht.length%16,Et=ht.length-gt,St=[0,mt],At=[0,mt],kt=[0,0],Rt=[0,0],Tt=[2277735313,289559509],Dt=[1291169091,658871167],Ot=0;Ot<Et;Ot=Ot+16)kt=[ht[Ot+4]|ht[Ot+5]<<8|ht[Ot+6]<<16|ht[Ot+7]<<24,ht[Ot]|ht[Ot+1]<<8|ht[Ot+2]<<16|ht[Ot+3]<<24],Rt=[ht[Ot+12]|ht[Ot+13]<<8|ht[Ot+14]<<16|ht[Ot+15]<<24,ht[Ot+8]|ht[Ot+9]<<8|ht[Ot+10]<<16|ht[Ot+11]<<24],kt=ot(kt,Tt),kt=at(kt,31),kt=ot(kt,Dt),St=ut(St,kt),St=at(St,27),St=st(St,At),St=st(ot(St,[0,5]),[0,1390208809]),Rt=ot(Rt,Dt),Rt=at(Rt,33),Rt=ot(Rt,Tt),At=ut(At,Rt),At=at(At,31),At=st(At,St),At=st(ot(At,[0,5]),[0,944331445]);switch(kt=[0,0],Rt=[0,0],gt){case 15:Rt=ut(Rt,ct([0,ht[Ot+14]],48));case 14:Rt=ut(Rt,ct([0,ht[Ot+13]],40));case 13:Rt=ut(Rt,ct([0,ht[Ot+12]],32));case 12:Rt=ut(Rt,ct([0,ht[Ot+11]],24));case 11:Rt=ut(Rt,ct([0,ht[Ot+10]],16));case 10:Rt=ut(Rt,ct([0,ht[Ot+9]],8));case 9:Rt=ut(Rt,[0,ht[Ot+8]]),Rt=ot(Rt,Dt),Rt=at(Rt,33),Rt=ot(Rt,Tt),At=ut(At,Rt);case 8:kt=ut(kt,ct([0,ht[Ot+7]],56));case 7:kt=ut(kt,ct([0,ht[Ot+6]],48));case 6:kt=ut(kt,ct([0,ht[Ot+5]],40));case 5:kt=ut(kt,ct([0,ht[Ot+4]],32));case 4:kt=ut(kt,ct([0,ht[Ot+3]],24));case 3:kt=ut(kt,ct([0,ht[Ot+2]],16));case 2:kt=ut(kt,ct([0,ht[Ot+1]],8));case 1:kt=ut(kt,[0,ht[Ot]]),kt=ot(kt,Tt),kt=at(kt,31),kt=ot(kt,Dt),St=ut(St,kt)}return St=ut(St,[0,ht.length]),At=ut(At,[0,ht.length]),St=st(St,At),At=st(At,St),St=ft(St),At=ft(At),St=st(St,At),At=st(At,St),("00000000"+(St[0]>>>0).toString(16)).slice(-8)+("00000000"+(St[1]>>>0).toString(16)).slice(-8)+("00000000"+(At[0]>>>0).toString(16)).slice(-8)+("00000000"+(At[1]>>>0).toString(16)).slice(-8)},_.exports&&(o=_.exports=et),o.murmurHash3=et})()})(murmurHash3js,murmurHash3jsExports);(function(_){_.exports=murmurHash3jsExports})(murmurhash3jsRevisited);const mur=getDefaultExportFromCjs(murmurhash3jsRevisitedExports),murmur3128=from$7({name:"murmur3-128",code:34,encode:_=>fromHex(mur.x64.hash128(_))});async function hamtHashFn$1(_){return(await murmur3128.encode(_)).slice(0,8).reverse()}const defaultOptions$l={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:sha256$8,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:hamtHashFn$1,hamtHashCode:34,hamtBucketBits:8},defaultOptions$m=(_={})=>mergeOptions$g.bind({ignoreUndefined:!0})(defaultOptions$l,_),persist$1=async(_,o,$)=>{$.codec||($.codec=dagPB),$.hasher||($.hasher=sha256$8),$.cidVersion===void 0&&($.cidVersion=1),$.codec===dagPB&&$.hasher!==sha256$8&&($.cidVersion=1);const j=await $.hasher.digest(_),et=CID$3.create($.cidVersion,$.codec.code,j);return $.onlyHash||await o.put(et,_,{signal:$.signal}),et},dirBuilder=async(_,o,$)=>{const j=new UnixFS({type:"directory",mtime:_.mtime,mode:_.mode}),et=encode$B(prepare$1({Data:j.marshal()})),tt=await persist$1(et,o,$),rt=_.path;return{cid:tt,path:rt,unixfs:j,size:et.length}};async function flat(_,o){return o(await all$1(_))}function balanced(_,o,$){return reduceToParents(_,o,$)}async function reduceToParents(_,o,$){const j=[];for await(const et of batch(_,$.maxChildrenPerNode))j.push(await o(et));return j.length>1?reduceToParents(j,o,$):j[0]}async function trickleStream(_,o,$){const j=new Root($.layerRepeat);let et=0,tt=1,rt=j;for await(const nt of batch(_,$.maxChildrenPerNode))rt.isFull()&&(rt!==j&&j.addChild(await rt.reduce(o)),et&&et%$.layerRepeat===0&&tt++,rt=new SubTree(tt,$.layerRepeat,et),et++),rt.append(nt);return rt&&rt!==j&&j.addChild(await rt.reduce(o)),j.reduce(o)}class SubTree{constructor(o,$,j=0){this.maxDepth=o,this.layerRepeat=$,this.currentDepth=1,this.iteration=j,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:o,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const o=this._findParent(this.node,this.currentDepth);return o?(this._addNextNodeToParent(o),!1):!0}_addNextNodeToParent(o){this.parent=o;const $={children:[],depth:o.depth+1,parent:o,maxDepth:this.maxDepth,maxChildren:Math.floor(o.children.length/this.layerRepeat)*this.layerRepeat};o.children.push($),this.currentDepth=$.depth,this.node=$}append(o){this.node.data=o}reduce(o){return this._reduce(this.root,o)}async _reduce(o,$){let j=[];return o.children.length&&(j=await Promise.all(o.children.filter(et=>et.data).map(et=>this._reduce(et,$)))),$((o.data||[]).concat(j))}_findParent(o,$){const j=o.parent;if(!(!j||j.depth===0))return j.children.length===j.maxChildren||!j.maxChildren?this._findParent(j,$):j}}class Root extends SubTree{constructor(o){super(0,o),this.root.depth=0,this.currentDepth=1}addChild(o){this.root.children.push(o)}reduce(o){return o((this.root.data||[]).concat(this.root.children))}}async function*bufferImporter(_,o,$){for await(let j of _.content)yield async()=>{$.progress(j.length,_.path);let et;const tt={codec:dagPB,cidVersion:$.cidVersion,hasher:$.hasher,onlyHash:$.onlyHash};return $.rawLeaves?(tt.codec=raw,tt.cidVersion=1):(et=new UnixFS({type:$.leafType,data:j}),j=encode$B({Data:et.marshal(),Links:[]})),{cid:await persist$1(j,o,tt),unixfs:et,size:j.length}}}const dagBuilders={flat,balanced,trickle:trickleStream};async function*buildFileBatch(_,o,$){let j=-1,et,tt;typeof $.bufferImporter=="function"?tt=$.bufferImporter:tt=bufferImporter;for await(const rt of parallelBatch(tt(_,o,$),$.blockWriteConcurrency)){if(j++,j===0){et=rt;continue}else j===1&&et&&(yield et,et=null);yield rt}et&&(et.single=!0,yield et)}const reduce=(_,o,$)=>{async function j(et){if(et.length===1&&et[0].single&&$.reduceSingleLeafToSelf){const ot=et[0];if(_.mtime!==void 0||_.mode!==void 0){let at=await o.get(ot.cid);ot.unixfs=new UnixFS({type:"file",mtime:_.mtime,mode:_.mode,data:at}),at=encode$B(prepare$1({Data:ot.unixfs.marshal()})),ot.cid=await persist$1(at,o,{...$,codec:dagPB,hasher:$.hasher,cidVersion:$.cidVersion}),ot.size=at.length}return{cid:ot.cid,path:_.path,unixfs:ot.unixfs,size:ot.size}}const tt=new UnixFS({type:"file",mtime:_.mtime,mode:_.mode}),rt=et.filter(ot=>ot.cid.code===code$6&&ot.size||ot.unixfs&&!ot.unixfs.data&&ot.unixfs.fileSize()?!0:!!(ot.unixfs&&ot.unixfs.data&&ot.unixfs.data.length)).map(ot=>ot.cid.code===code$6?(tt.addBlockSize(ot.size),{Name:"",Tsize:ot.size,Hash:ot.cid}):(!ot.unixfs||!ot.unixfs.data?tt.addBlockSize(ot.unixfs&&ot.unixfs.fileSize()||0):tt.addBlockSize(ot.unixfs.data.length),{Name:"",Tsize:ot.size,Hash:ot.cid})),nt={Data:tt.marshal(),Links:rt},it=encode$B(prepare$1(nt));return{cid:await persist$1(it,o,$),path:_.path,unixfs:tt,size:it.length+nt.Links.reduce((ot,at)=>ot+at.Tsize,0)}}return j};function fileBuilder(_,o,$){const j=dagBuilders[$.strategy];if(!j)throw errCode(new Error(`Unknown importer build strategy name: ${$.strategy}`),"ERR_BAD_STRATEGY");return j(buildFileBatch(_,o,$),reduce(_,o,$),$)}const symbol$5=Symbol.for("@achingbrain/uint8arraylist");function findBufAndOffset(_,o){if(o==null||o<0)throw new RangeError("index is out of bounds");let $=0;for(const j of _){const et=$+j.byteLength;if(o<et)return{buf:j,index:o-$};$=et}throw new RangeError("index is out of bounds")}function isUint8ArrayList(_){return!!(_!=null&&_[symbol$5])}class Uint8ArrayList{constructor(...o){Object.defineProperty(this,symbol$5,{value:!0}),this.bufs=[],this.length=0,o.length>0&&this.appendAll(o)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...o){this.appendAll(o)}appendAll(o){let $=0;for(const j of o)if(j instanceof Uint8Array)$+=j.byteLength,this.bufs.push(j);else if(isUint8ArrayList(j))$+=j.byteLength,this.bufs.push(...j.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=$}prepend(...o){this.prependAll(o)}prependAll(o){let $=0;for(const j of o.reverse())if(j instanceof Uint8Array)$+=j.byteLength,this.bufs.unshift(j);else if(isUint8ArrayList(j))$+=j.byteLength,this.bufs.unshift(...j.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=$}get(o){const $=findBufAndOffset(this.bufs,o);return $.buf[$.index]}set(o,$){const j=findBufAndOffset(this.bufs,o);j.buf[j.index]=$}write(o,$=0){if(o instanceof Uint8Array)for(let j=0;j<o.length;j++)this.set($+j,o[j]);else if(isUint8ArrayList(o))for(let j=0;j<o.length;j++)this.set($+j,o.get(j));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(o){if(o=Math.trunc(o),!(Number.isNaN(o)||o<=0)){if(o===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(o>=this.bufs[0].byteLength)o-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(o),this.length-=o;break}}}slice(o,$){const{bufs:j,length:et}=this._subList(o,$);return concat$2(j,et)}subarray(o,$){const{bufs:j,length:et}=this._subList(o,$);return j.length===1?j[0]:concat$2(j,et)}sublist(o,$){const{bufs:j,length:et}=this._subList(o,$),tt=new Uint8ArrayList;return tt.length=et,tt.bufs=j,tt}_subList(o,$){if(o=o??0,$=$??this.length,o<0&&(o=this.length+o),$<0&&($=this.length+$),o<0||$>this.length)throw new RangeError("index is out of bounds");if(o===$)return{bufs:[],length:0};if(o===0&&$===this.length)return{bufs:[...this.bufs],length:this.length};const j=[];let et=0;for(let tt=0;tt<this.bufs.length;tt++){const rt=this.bufs[tt],nt=et,it=nt+rt.byteLength;if(et=it,o>=it)continue;const st=o>=nt&&o<it,ot=$>nt&&$<=it;if(st&&ot){if(o===nt&&$===it){j.push(rt);break}const at=o-nt;j.push(rt.subarray(at,at+($-o)));break}if(st){if(o===0){j.push(rt);continue}j.push(rt.subarray(o-nt));continue}if(ot){if($===it){j.push(rt);break}j.push(rt.subarray(0,$-nt));break}j.push(rt)}return{bufs:j,length:$-o}}indexOf(o,$=0){if(!isUint8ArrayList(o)&&!(o instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const j=o instanceof Uint8Array?o:o.subarray();if($=Number($??0),isNaN($)&&($=0),$<0&&($=this.length+$),$<0&&($=0),o.length===0)return $>this.length?this.length:$;const et=j.byteLength;if(et===0)throw new TypeError("search must be at least 1 byte long");const tt=256,rt=new Int32Array(tt);for(let at=0;at<tt;at++)rt[at]=-1;for(let at=0;at<et;at++)rt[j[at]]=at;const nt=rt,it=this.byteLength-j.byteLength,st=j.byteLength-1;let ot;for(let at=$;at<=it;at+=ot){ot=0;for(let ct=st;ct>=0;ct--){const ut=this.get(at+ct);if(j[ct]!==ut){ot=Math.max(1,ct-nt[ut]);break}}if(ot===0)return at}return-1}getInt8(o){const $=this.subarray(o,o+1);return new DataView($.buffer,$.byteOffset,$.byteLength).getInt8(0)}setInt8(o,$){const j=allocUnsafe$5(1);new DataView(j.buffer,j.byteOffset,j.byteLength).setInt8(0,$),this.write(j,o)}getInt16(o,$){const j=this.subarray(o,o+2);return new DataView(j.buffer,j.byteOffset,j.byteLength).getInt16(0,$)}setInt16(o,$,j){const et=alloc(2);new DataView(et.buffer,et.byteOffset,et.byteLength).setInt16(0,$,j),this.write(et,o)}getInt32(o,$){const j=this.subarray(o,o+4);return new DataView(j.buffer,j.byteOffset,j.byteLength).getInt32(0,$)}setInt32(o,$,j){const et=alloc(4);new DataView(et.buffer,et.byteOffset,et.byteLength).setInt32(0,$,j),this.write(et,o)}getBigInt64(o,$){const j=this.subarray(o,o+8);return new DataView(j.buffer,j.byteOffset,j.byteLength).getBigInt64(0,$)}setBigInt64(o,$,j){const et=alloc(8);new DataView(et.buffer,et.byteOffset,et.byteLength).setBigInt64(0,$,j),this.write(et,o)}getUint8(o){const $=this.subarray(o,o+1);return new DataView($.buffer,$.byteOffset,$.byteLength).getUint8(0)}setUint8(o,$){const j=allocUnsafe$5(1);new DataView(j.buffer,j.byteOffset,j.byteLength).setUint8(0,$),this.write(j,o)}getUint16(o,$){const j=this.subarray(o,o+2);return new DataView(j.buffer,j.byteOffset,j.byteLength).getUint16(0,$)}setUint16(o,$,j){const et=alloc(2);new DataView(et.buffer,et.byteOffset,et.byteLength).setUint16(0,$,j),this.write(et,o)}getUint32(o,$){const j=this.subarray(o,o+4);return new DataView(j.buffer,j.byteOffset,j.byteLength).getUint32(0,$)}setUint32(o,$,j){const et=alloc(4);new DataView(et.buffer,et.byteOffset,et.byteLength).setUint32(0,$,j),this.write(et,o)}getBigUint64(o,$){const j=this.subarray(o,o+8);return new DataView(j.buffer,j.byteOffset,j.byteLength).getBigUint64(0,$)}setBigUint64(o,$,j){const et=alloc(8);new DataView(et.buffer,et.byteOffset,et.byteLength).setBigUint64(0,$,j),this.write(et,o)}getFloat32(o,$){const j=this.subarray(o,o+4);return new DataView(j.buffer,j.byteOffset,j.byteLength).getFloat32(0,$)}setFloat32(o,$,j){const et=alloc(4);new DataView(et.buffer,et.byteOffset,et.byteLength).setFloat32(0,$,j),this.write(et,o)}getFloat64(o,$){const j=this.subarray(o,o+8);return new DataView(j.buffer,j.byteOffset,j.byteLength).getFloat64(0,$)}setFloat64(o,$,j){const et=alloc(8);new DataView(et.buffer,et.byteOffset,et.byteLength).setFloat64(0,$,j),this.write(et,o)}equals(o){if(o==null||!(o instanceof Uint8ArrayList)||o.bufs.length!==this.bufs.length)return!1;for(let $=0;$<this.bufs.length;$++)if(!equals$6(this.bufs[$],o.bufs[$]))return!1;return!0}static fromUint8Arrays(o,$){const j=new Uint8ArrayList;return j.bufs=o,$==null&&($=o.reduce((et,tt)=>et+tt.byteLength,0)),j.length=$,j}}let Rabin$1=class{constructor(o,$=12,j=8*1024,et=32*1024,tt=64,rt){this.bits=$,this.min=j,this.max=et,this.asModule=o,this.rabin=new o.Rabin($,j,et,tt,rt),this.polynomial=rt}fingerprint(o){const{__retain:$,__release:j,__allocArray:et,__getInt32Array:tt,Int32Array_ID:rt,Uint8Array_ID:nt}=this.asModule,it=new Int32Array(Math.ceil(o.length/this.min)),st=$(et(rt,it)),ot=$(et(nt,o)),at=this.rabin.fingerprint(ot,st),ct=tt(at);j(ot),j(st);const ut=ct.indexOf(0);return ut>=0?ct.subarray(0,ut):ct}};var rabin$1=Rabin$1,loader={};const ID_OFFSET=-8,SIZE_OFFSET=-4,ARRAYBUFFER_ID=0,STRING_ID=1,ARRAYBUFFERVIEW=1<<0,ARRAY=1<<1,VAL_ALIGN_OFFSET=5,VAL_SIGNED=1<<10,VAL_FLOAT=1<<11,VAL_MANAGED=1<<13,ARRAYBUFFERVIEW_BUFFER_OFFSET=0,ARRAYBUFFERVIEW_DATASTART_OFFSET=4,ARRAYBUFFERVIEW_DATALENGTH_OFFSET=8,ARRAYBUFFERVIEW_SIZE=12,ARRAY_LENGTH_OFFSET=12,ARRAY_SIZE=16,BIGINT=typeof BigUint64Array<"u",THIS=Symbol(),CHUNKSIZE=1024;function getStringImpl(_,o){const $=new Uint32Array(_),j=new Uint16Array(_);var et=$[o+SIZE_OFFSET>>>2]>>>1,tt=o>>>1;if(et<=CHUNKSIZE)return String.fromCharCode.apply(String,j.subarray(tt,tt+et));const rt=[];do{const nt=j[tt+CHUNKSIZE-1],it=nt>=55296&&nt<56320?CHUNKSIZE-1:CHUNKSIZE;rt.push(String.fromCharCode.apply(String,j.subarray(tt,tt+=it))),et-=it}while(et>CHUNKSIZE);return rt.join("")+String.fromCharCode.apply(String,j.subarray(tt,tt+et))}function preInstantiate(_){const o={};function $(et,tt){return et?getStringImpl(et.buffer,tt):"<yet unknown>"}const j=_.env=_.env||{};return j.abort=j.abort||function(tt,rt,nt,it){const st=o.memory||j.memory;throw Error("abort: "+$(st,tt)+" at "+$(st,rt)+":"+nt+":"+it)},j.trace=j.trace||function(tt,rt){const nt=o.memory||j.memory;console.log("trace: "+$(nt,tt)+(rt?" ":"")+Array.prototype.slice.call(arguments,2,2+rt).join(", "))},_.Math=_.Math||Math,_.Date=_.Date||Date,o}function postInstantiate(_,o){const $=o.exports,j=$.memory,et=$.table,tt=$.__alloc,rt=$.__retain,nt=$.__rtti_base||-1;function it(kt){const Rt=new Uint32Array(j.buffer),Tt=Rt[nt>>>2];if((kt>>>=0)>=Tt)throw Error("invalid id: "+kt);return Rt[(nt+4>>>2)+kt*2]}function st(kt){const Rt=new Uint32Array(j.buffer),Tt=Rt[nt>>>2];if((kt>>>=0)>=Tt)throw Error("invalid id: "+kt);return Rt[(nt+4>>>2)+kt*2+1]}function ot(kt){return 31-Math.clz32(kt>>>VAL_ALIGN_OFFSET&31)}function at(kt){const Rt=kt.length,Tt=tt(Rt<<1,STRING_ID),Dt=new Uint16Array(j.buffer);for(var Ot=0,jt=Tt>>>1;Ot<Rt;++Ot)Dt[jt+Ot]=kt.charCodeAt(Ot);return Tt}_.__allocString=at;function ct(kt){const Rt=j.buffer;if(new Uint32Array(Rt)[kt+ID_OFFSET>>>2]!==STRING_ID)throw Error("not a string: "+kt);return getStringImpl(Rt,kt)}_.__getString=ct;function ut(kt,Rt,Tt){const Dt=j.buffer;if(Tt)switch(kt){case 2:return new Float32Array(Dt);case 3:return new Float64Array(Dt)}else switch(kt){case 0:return new(Rt?Int8Array:Uint8Array)(Dt);case 1:return new(Rt?Int16Array:Uint16Array)(Dt);case 2:return new(Rt?Int32Array:Uint32Array)(Dt);case 3:return new(Rt?BigInt64Array:BigUint64Array)(Dt)}throw Error("unsupported align: "+kt)}function ft(kt,Rt){const Tt=it(kt);if(!(Tt&(ARRAYBUFFERVIEW|ARRAY)))throw Error("not an array: "+kt+" @ "+Tt);const Dt=ot(Tt),Ot=Rt.length,jt=tt(Ot<<Dt,ARRAYBUFFER_ID),Nt=tt(Tt&ARRAY?ARRAY_SIZE:ARRAYBUFFERVIEW_SIZE,kt),It=new Uint32Array(j.buffer);It[Nt+ARRAYBUFFERVIEW_BUFFER_OFFSET>>>2]=rt(jt),It[Nt+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2]=jt,It[Nt+ARRAYBUFFERVIEW_DATALENGTH_OFFSET>>>2]=Ot<<Dt,Tt&ARRAY&&(It[Nt+ARRAY_LENGTH_OFFSET>>>2]=Ot);const yt=ut(Dt,Tt&VAL_SIGNED,Tt&VAL_FLOAT);if(Tt&VAL_MANAGED)for(let lt=0;lt<Ot;++lt)yt[(jt>>>Dt)+lt]=rt(Rt[lt]);else yt.set(Rt,jt>>>Dt);return Nt}_.__allocArray=ft;function ht(kt){const Rt=new Uint32Array(j.buffer),Tt=Rt[kt+ID_OFFSET>>>2],Dt=it(Tt);if(!(Dt&ARRAYBUFFERVIEW))throw Error("not an array: "+Tt);const Ot=ot(Dt);var jt=Rt[kt+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2];const Nt=Dt&ARRAY?Rt[kt+ARRAY_LENGTH_OFFSET>>>2]:Rt[jt+SIZE_OFFSET>>>2]>>>Ot;return ut(Ot,Dt&VAL_SIGNED,Dt&VAL_FLOAT).subarray(jt>>>=Ot,jt+Nt)}_.__getArrayView=ht;function mt(kt){const Rt=ht(kt),Tt=Rt.length,Dt=new Array(Tt);for(let Ot=0;Ot<Tt;Ot++)Dt[Ot]=Rt[Ot];return Dt}_.__getArray=mt;function gt(kt){const Rt=j.buffer,Tt=new Uint32Array(Rt)[kt+SIZE_OFFSET>>>2];return Rt.slice(kt,kt+Tt)}_.__getArrayBuffer=gt;function Et(kt,Rt,Tt){return new kt(St(kt,Rt,Tt))}function St(kt,Rt,Tt){const Dt=j.buffer,Ot=new Uint32Array(Dt),jt=Ot[Tt+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2];return new kt(Dt,jt,Ot[jt+SIZE_OFFSET>>>2]>>>Rt)}_.__getInt8Array=Et.bind(null,Int8Array,0),_.__getInt8ArrayView=St.bind(null,Int8Array,0),_.__getUint8Array=Et.bind(null,Uint8Array,0),_.__getUint8ArrayView=St.bind(null,Uint8Array,0),_.__getUint8ClampedArray=Et.bind(null,Uint8ClampedArray,0),_.__getUint8ClampedArrayView=St.bind(null,Uint8ClampedArray,0),_.__getInt16Array=Et.bind(null,Int16Array,1),_.__getInt16ArrayView=St.bind(null,Int16Array,1),_.__getUint16Array=Et.bind(null,Uint16Array,1),_.__getUint16ArrayView=St.bind(null,Uint16Array,1),_.__getInt32Array=Et.bind(null,Int32Array,2),_.__getInt32ArrayView=St.bind(null,Int32Array,2),_.__getUint32Array=Et.bind(null,Uint32Array,2),_.__getUint32ArrayView=St.bind(null,Uint32Array,2),BIGINT&&(_.__getInt64Array=Et.bind(null,BigInt64Array,3),_.__getInt64ArrayView=St.bind(null,BigInt64Array,3),_.__getUint64Array=Et.bind(null,BigUint64Array,3),_.__getUint64ArrayView=St.bind(null,BigUint64Array,3)),_.__getFloat32Array=Et.bind(null,Float32Array,2),_.__getFloat32ArrayView=St.bind(null,Float32Array,2),_.__getFloat64Array=Et.bind(null,Float64Array,3),_.__getFloat64ArrayView=St.bind(null,Float64Array,3);function At(kt,Rt){const Tt=new Uint32Array(j.buffer);var Dt=Tt[kt+ID_OFFSET>>>2];if(Dt<=Tt[nt>>>2])do if(Dt==Rt)return!0;while(Dt=st(Dt));return!1}return _.__instanceof=At,_.memory=_.memory||j,_.table=_.table||et,demangle($,_)}function isResponse(_){return typeof Response<"u"&&_ instanceof Response}async function instantiate$1(_,o){return isResponse(_=await _)?instantiateStreaming(_,o):postInstantiate(preInstantiate(o||(o={})),await WebAssembly.instantiate(_ instanceof WebAssembly.Module?_:await WebAssembly.compile(_),o))}loader.instantiate=instantiate$1;function instantiateSync(_,o){return postInstantiate(preInstantiate(o||(o={})),new WebAssembly.Instance(_ instanceof WebAssembly.Module?_:new WebAssembly.Module(_),o))}loader.instantiateSync=instantiateSync;async function instantiateStreaming(_,o){return WebAssembly.instantiateStreaming?postInstantiate(preInstantiate(o||(o={})),(await WebAssembly.instantiateStreaming(_,o)).instance):instantiate$1(isResponse(_=await _)?_.arrayBuffer():_,o)}loader.instantiateStreaming=instantiateStreaming;function demangle(_,o){var $=o?Object.create(o):{},j=_.__argumentsLength?function(et){_.__argumentsLength.value=et}:_.__setArgumentsLength||_.__setargc||function(){};for(let et in _){if(!Object.prototype.hasOwnProperty.call(_,et))continue;const tt=_[et];let rt=et.split("."),nt=$;for(;rt.length>1;){let ot=rt.shift();Object.prototype.hasOwnProperty.call(nt,ot)||(nt[ot]={}),nt=nt[ot]}let it=rt[0],st=it.indexOf("#");if(st>=0){let ot=it.substring(0,st),at=nt[ot];if(typeof at>"u"||!at.prototype){let ct=function(...ut){return ct.wrap(ct.prototype.constructor(0,...ut))};ct.prototype={valueOf:function(){return this[THIS]}},ct.wrap=function(ut){return Object.create(ct.prototype,{[THIS]:{value:ut,writable:!1}})},at&&Object.getOwnPropertyNames(at).forEach(ut=>Object.defineProperty(ct,ut,Object.getOwnPropertyDescriptor(at,ut))),nt[ot]=ct}if(it=it.substring(st+1),nt=nt[ot].prototype,/^(get|set):/.test(it)){if(!Object.prototype.hasOwnProperty.call(nt,it=it.substring(4))){let ct=_[et.replace("set:","get:")],ut=_[et.replace("get:","set:")];Object.defineProperty(nt,it,{get:function(){return ct(this[THIS])},set:function(ft){ut(this[THIS],ft)},enumerable:!0})}}else it==="constructor"?(nt[it]=(...ct)=>(j(ct.length),tt(...ct))).original=tt:(nt[it]=function(...ct){return j(ct.length),tt(this[THIS],...ct)}).original=tt}else/^(get|set):/.test(it)?Object.prototype.hasOwnProperty.call(nt,it=it.substring(4))||Object.defineProperty(nt,it,{get:_[et.replace("set:","get:")],set:_[et.replace("get:","set:")],enumerable:!0}):typeof tt=="function"&&tt!==j?(nt[it]=(...ot)=>(j(ot.length),tt(...ot))).original=tt:nt[it]=tt}return $}loader.demangle=demangle;const{instantiate}=loader;loadWebAssembly.supported=typeof WebAssembly<"u";function loadWebAssembly(_={}){if(!loadWebAssembly.supported)return null;var o=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return instantiate(new Response(new Blob([o],{type:"application/wasm"})),_)}var rabinWasm=loadWebAssembly;const Rabin=rabin$1,getRabin=rabinWasm,create$4=async(_,o,$,j,et)=>{const tt=await getRabin();return new Rabin(tt,_,o,$,j,et)};var src$2={Rabin,create:create$4};async function*rabinChunker(_,o){let $,j,et;if(o.minChunkSize&&o.maxChunkSize&&o.avgChunkSize)et=o.avgChunkSize,$=o.minChunkSize,j=o.maxChunkSize;else if(o.avgChunkSize)et=o.avgChunkSize,$=et/3,j=et+et/2;else throw errCode(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if($<16)throw errCode(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");j<$&&(j=$),et<$&&(et=$);const tt=Math.floor(Math.log2(et));for await(const rt of rabin(_,{min:$,max:j,bits:tt,window:o.window,polynomial:o.polynomial}))yield rt}async function*rabin(_,o){const $=await src$2.create(o.bits,o.min,o.max,o.window),j=new Uint8ArrayList;for await(const et of _){j.append(et);const tt=$.fingerprint(et);for(let rt=0;rt<tt.length;rt++){const nt=tt[rt],it=j.slice(0,nt);j.consume(nt),yield it}}j.length&&(yield j.subarray(0))}async function*fixedSizeChunker(_,o){let $=new Uint8ArrayList,j=0,et=!1;const tt=o.maxChunkSize;for await(const rt of _)for($.append(rt),j+=rt.length;j>=tt;)if(yield $.slice(0,tt),et=!0,tt===$.length)$=new Uint8ArrayList,j=0;else{const nt=new Uint8ArrayList;nt.append($.sublist(tt)),$=nt,j-=tt}(!et||j)&&(yield $.subarray(0,j))}async function*validateChunks(_){for await(const o of _){if(o.length===void 0)throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof o=="string"||o instanceof String)yield fromString$8(o.toString());else if(Array.isArray(o))yield Uint8Array.from(o);else if(o instanceof Uint8Array)yield o;else throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}function isIterable(_){return Symbol.iterator in _}function isAsyncIterable(_){return Symbol.asyncIterator in _}function contentAsAsyncIterable(_){try{if(_ instanceof Uint8Array)return async function*(){yield _}();if(isIterable(_))return async function*(){yield*_}();if(isAsyncIterable(_))return _}catch{throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*dagBuilder(_,o,$){for await(const j of _)if(j.path&&(j.path.substring(0,2)==="./"&&($.wrapWithDirectory=!0),j.path=j.path.split("/").filter(et=>et&&et!==".").join("/")),j.content){let et;typeof $.chunker=="function"?et=$.chunker:$.chunker==="rabin"?et=rabinChunker:et=fixedSizeChunker;let tt;typeof $.chunkValidator=="function"?tt=$.chunkValidator:tt=validateChunks;const rt={path:j.path,mtime:j.mtime,mode:j.mode,content:et(tt(contentAsAsyncIterable(j.content),$),$)};yield()=>fileBuilder(rt,o,$)}else if(j.path){const et={path:j.path,mtime:j.mtime,mode:j.mode};yield()=>dirBuilder(et,o,$)}else throw new Error("Import candidate must have content or path or both")}let Dir$1=class{constructor(o,$){this.options=$||{},this.root=o.root,this.dir=o.dir,this.path=o.path,this.dirty=o.dirty,this.flat=o.flat,this.parent=o.parent,this.parentKey=o.parentKey,this.unixfs=o.unixfs,this.mode=o.mode,this.mtime=o.mtime,this.cid=void 0,this.size=void 0}async put(o,$){}get(o){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(o){}};class DirFlat extends Dir$1{constructor(o,$){super(o,$),this._children={}}async put(o,$){this.cid=void 0,this.size=void 0,this._children[o]=$}get(o){return Promise.resolve(this._children[o])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){const o=Object.keys(this._children);for(let $=0;$<o.length;$++){const j=o[$];yield{key:j,child:this._children[j]}}}async*flush(o){const $=Object.keys(this._children),j=[];for(let st=0;st<$.length;st++){let ot=this._children[$[st]];if(ot instanceof Dir$1)for await(const at of ot.flush(o))ot=at,yield ot;ot.size!=null&&ot.cid&&j.push({Name:$[st],Tsize:ot.size,Hash:ot.cid})}const et=new UnixFS({type:"directory",mtime:this.mtime,mode:this.mode}),tt={Data:et.marshal(),Links:j},rt=encode$B(prepare$1(tt)),nt=await persist$1(rt,o,this.options),it=rt.length+tt.Links.reduce((st,ot)=>st+(ot.Tsize==null?0:ot.Tsize),0);this.cid=nt,this.size=it,yield{cid:nt,unixfs:et,path:this.path,size:it}}}const BITS_PER_BYTE=7;var sparseArray=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(o,$){let j=this._internalPositionFor(o,!1);if($===void 0)j!==-1&&(this._unsetInternalPos(j),this._unsetBit(o),this._changedLength=!0,this._changedData=!0);else{let et=!1;j===-1?(j=this._data.length,this._setBit(o),this._changedData=!0):et=!0,this._setInternalPos(j,o,$,et),this._changedLength=!0}}unset(o){this.set(o,void 0)}get(o){this._sortData();const $=this._internalPositionFor(o,!0);if($!==-1)return this._data[$][1]}push(o){return this.set(this.length,o),this.length}get length(){if(this._sortData(),this._changedLength){const o=this._data[this._data.length-1];this._length=o?o[0]+1:0,this._changedLength=!1}return this._length}forEach(o){let $=0;for(;$<this.length;)o(this.get($),$,this),$++}map(o){let $=0,j=new Array(this.length);for(;$<this.length;)j[$]=o(this.get($),$,this),$++;return j}reduce(o,$){let j=0,et=$;for(;j<this.length;){const tt=this.get(j);et=o(et,tt,j),j++}return et}find(o){let $=0,j,et;for(;$<this.length&&!j;)et=this.get($),j=o(et),$++;return j?et:void 0}_internalPositionFor(o,$){const j=this._bytePosFor(o,$);if(j>=this._bitArrays.length)return-1;const et=this._bitArrays[j],tt=o-j*BITS_PER_BYTE;if(!((et&1<<tt)>0))return-1;const nt=this._bitArrays.slice(0,j).reduce(popCountReduce,0),it=~(4294967295<<tt+1),st=popCount(et&it);return nt+st-1}_bytePosFor(o,$){const j=Math.floor(o/BITS_PER_BYTE),et=j+1;for(;!$&&this._bitArrays.length<et;)this._bitArrays.push(0);return j}_setBit(o){const $=this._bytePosFor(o,!1);this._bitArrays[$]|=1<<o-$*BITS_PER_BYTE}_unsetBit(o){const $=this._bytePosFor(o,!1);this._bitArrays[$]&=~(1<<o-$*BITS_PER_BYTE)}_setInternalPos(o,$,j,et){const tt=this._data,rt=[$,j];if(et)this._sortData(),tt[o]=rt;else{if(tt.length)if(tt[tt.length-1][0]>=$)tt.push(rt);else if(tt[0][0]<=$)tt.unshift(rt);else{const nt=Math.round(tt.length/2);this._data=tt.slice(0,nt).concat(rt).concat(tt.slice(nt))}else this._data.push(rt);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(o){this._data.splice(o,1)}_sortData(){this._changedData&&this._data.sort(sortInternal),this._changedData=!1}bitField(){const o=[];let $=8,j=0,et=0,tt;const rt=this._bitArrays.slice();for(;rt.length||j;){j===0&&(tt=rt.shift(),j=7);const it=Math.min(j,$),st=~(255<<it),ot=tt&st;et|=ot<<8-$,tt=tt>>>it,j-=it,$-=it,(!$||!j&&!rt.length)&&(o.push(et),et=0,$=8)}for(var nt=o.length-1;nt>0&&o[nt]===0;nt--)o.pop();return o}compactArray(){return this._sortData(),this._data.map(valueOnly)}};function popCountReduce(_,o){return _+popCount(o)}function popCount(_){let o=_;return o=o-(o>>1&1431655765),o=(o&858993459)+(o>>2&858993459),(o+(o>>4)&252645135)*16843009>>24}function sortInternal(_,o){return _[0]-o[0]}function valueOnly(_){return _[1]}class Bucket{constructor(o,$,j=0){this._options=o,this._popCount=0,this._parent=$,this._posAtParent=j,this._children=new sparseArray,this.key=null}async put(o,$){const j=await this._findNewBucketAndPos(o);await j.bucket._putAt(j,o,$)}async get(o){const $=await this._findChild(o);if($!=null)return $.value}async del(o){const $=await this._findPlace(o),j=$.bucket._at($.pos);j!=null&&j.key===o&&$.bucket._delAt($.pos)}leafCount(){return this._children.compactArray().reduce(($,j)=>j instanceof Bucket?$+j.leafCount():$+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const o=this._children.compactArray();for(const $ of o)$ instanceof Bucket?yield*$.eachLeafSeries():yield $}serialize(o,$){const j=[];return $(this._children.reduce((et,tt,rt)=>(tt!=null&&(tt instanceof Bucket?et.push(tt.serialize(o,$)):et.push(o(tt,rt))),et),j))}async asyncTransform(o,$){return await asyncTransformBucket(this,o,$)}toJSON(){return this.serialize(mapNode,reduceNodes)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(o){const $=await this._findPlace(o),j=$.bucket._at($.pos);if(!(j instanceof Bucket)&&j!=null&&j.key===o)return j}async _findPlace(o){const $=this._options.hash(typeof o=="string"?fromString$8(o):o),j=await $.take(this._options.bits),et=this._children.get(j);return et instanceof Bucket?await et._findPlace($):{bucket:this,pos:j,hash:$,existingChild:et}}async _findNewBucketAndPos(o){const $=await this._findPlace(o);if($.existingChild!=null&&$.existingChild.key!==o){const j=new Bucket(this._options,$.bucket,$.pos);$.bucket._putObjectAt($.pos,j);const et=await j._findPlace($.existingChild.hash);return et.bucket._putAt(et,$.existingChild.key,$.existingChild.value),await j._findNewBucketAndPos($.hash)}return $}_putAt(o,$,j){this._putObjectAt(o.pos,{key:$,value:j,hash:o.hash})}_putObjectAt(o,$){this._children.get(o)==null&&this._popCount++,this._children.set(o,$)}_delAt(o){if(o===-1)throw new Error("Invalid position");this._children.get(o)!=null&&this._popCount--,this._children.unset(o),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){const o=this._children.find(exists);if(o!=null&&!(o instanceof Bucket)){const $=o.hash;$.untake(this._options.bits);const j={pos:this._posAtParent,hash:$,bucket:this._parent};this._parent._putAt(j,o.key,o.value)}}else this._parent._delAt(this._posAtParent)}_at(o){return this._children.get(o)}}function exists(_){return!!_}function mapNode(_,o){return _.key}function reduceNodes(_){return _}async function asyncTransformBucket(_,o,$){const j=[];for(const et of _._children.compactArray())if(et instanceof Bucket)await asyncTransformBucket(et,o,$);else{const tt=await o(et);j.push({bitField:_._children.bitField(),children:tt})}return await $(j)}const START_MASKS=[255,254,252,248,240,224,192,128],STOP_MASKS=[1,3,7,15,31,63,127,255];class ConsumableBuffer{constructor(o){this._value=o,this._currentBytePos=o.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(o){let $=o,j=0;for(;$>0&&this._haveBits();){const et=this._value[this._currentBytePos],tt=this._currentBitPos+1,rt=Math.min(tt,$),nt=byteBitsToInt(et,tt-rt,rt);j=(j<<rt)+nt,$-=rt,this._currentBitPos-=rt,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return j}untake(o){for(this._currentBitPos+=o;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function byteBitsToInt(_,o,$){const j=maskFor(o,$);return(_&j)>>>o}function maskFor(_,o){return START_MASKS[_]&STOP_MASKS[Math.min(o+_-1,7)]}function wrapHash(_){function o($){return $ instanceof InfiniteHash?$:new InfiniteHash($,_)}return o}class InfiniteHash{constructor(o,$){if(!(o instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=o,this._hashFn=$,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(o){let $=o;for(;this._availableBits<$;)await this._produceMoreBits();let j=0;for(;$>0;){const et=this._buffers[this._currentBufferIndex],tt=Math.min(et.availableBits(),$),rt=et.take(tt);j=(j<<tt)+rt,$-=tt,this._availableBits-=tt,et.availableBits()===0&&this._currentBufferIndex++}return j}untake(o){let $=o;for(;$>0;){const j=this._buffers[this._currentBufferIndex],et=Math.min(j.totalBits()-j.availableBits(),$);j.untake(et),$-=et,this._availableBits+=et,this._currentBufferIndex>0&&j.totalBits()===j.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const o=this._depth>0?concat$2([this._value,Uint8Array.from([this._depth])]):this._value,$=await this._hashFn(o),j=new ConsumableBuffer($);this._buffers.push(j),this._availableBits+=j.availableBits()}}function createHAMT(_){if(_==null||_.hashFn==null)throw new Error("please define an options.hashFn");const o={bits:_.bits??8,hash:wrapHash(_.hashFn)};return new Bucket(o)}let DirSharded$1=class extends Dir$1{constructor(o,$){super(o,$),this._bucket=createHAMT({hashFn:$.hamtHashFn,bits:$.hamtBucketBits})}async put(o,$){await this._bucket.put(o,$)}get(o){return this._bucket.get(o)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:o,value:$}of this._bucket.eachLeafSeries())yield{key:o,child:$}}async*flush(o){for await(const $ of flush$1(this._bucket,o,this,this.options))yield{...$,path:this.path}}};async function*flush$1(_,o,$,j){const et=_._children,tt=[];let rt=0;for(let ut=0;ut<et.length;ut++){const ft=et.get(ut);if(!ft)continue;const ht=ut.toString(16).toUpperCase().padStart(2,"0");if(ft instanceof Bucket){let mt;for await(const gt of await flush$1(ft,o,null,j))mt=gt;if(!mt)throw new Error("Could not flush sharded directory, no subshard found");tt.push({Name:ht,Tsize:mt.size,Hash:mt.cid}),rt+=mt.size}else if(typeof ft.value.flush=="function"){const mt=ft.value;let gt;for await(const St of mt.flush(o))gt=St,yield gt;const Et=ht+ft.key;tt.push({Name:Et,Tsize:gt.size,Hash:gt.cid}),rt+=gt.size}else{const mt=ft.value;if(!mt.cid)continue;const gt=ht+ft.key,Et=mt.size;tt.push({Name:gt,Tsize:Et,Hash:mt.cid}),rt+=Et}}const nt=Uint8Array.from(et.bitField().reverse()),it=new UnixFS({type:"hamt-sharded-directory",data:nt,fanout:_.tableSize(),hashType:j.hamtHashCode,mtime:$&&$.mtime,mode:$&&$.mode}),st={Data:it.marshal(),Links:tt},ot=encode$B(prepare$1(st)),at=await persist$1(ot,o,j),ct=ot.length+rt;yield{cid:at,unixfs:it,size:ct}}async function flatToShard(_,o,$,j){let et=o;o instanceof DirFlat&&o.directChildrenCount()>=$&&(et=await convertToShard(o,j));const tt=et.parent;if(tt){if(et!==o){if(_&&(_.parent=et),!et.parentKey)throw new Error("No parent key found");await tt.put(et.parentKey,et)}return flatToShard(et,tt,$,j)}return et}async function convertToShard(_,o){const $=new DirSharded$1({root:_.root,dir:!0,parent:_.parent,parentKey:_.parentKey,path:_.path,dirty:_.dirty,flat:!1,mtime:_.mtime,mode:_.mode},o);for await(const{key:j,child:et}of _.eachChildSeries())await $.put(j,et);return $}const toPathComponents$2=(_="")=>(_.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);async function addToTree(_,o,$){const j=toPathComponents$2(_.path||""),et=j.length-1;let tt=o,rt="";for(let nt=0;nt<j.length;nt++){const it=j[nt];rt+=`${rt?"/":""}${it}`;const st=nt===et;if(tt.dirty=!0,tt.cid=void 0,tt.size=void 0,st)await tt.put(it,_),o=await flatToShard(null,tt,$.shardSplitThreshold,$);else{let ot=await tt.get(it);(!ot||!(ot instanceof Dir$1))&&(ot=new DirFlat({root:!1,dir:!0,parent:tt,parentKey:it,path:rt,dirty:!0,flat:!0,mtime:ot&&ot.unixfs&&ot.unixfs.mtime,mode:ot&&ot.unixfs&&ot.unixfs.mode},$)),await tt.put(it,ot),tt=ot}}return o}async function*flushAndYield(_,o){if(!(_ instanceof Dir$1)){_&&_.unixfs&&_.unixfs.isDirectory()&&(yield _);return}yield*_.flush(o)}async function*treeBuilder(_,o,$){let j=new DirFlat({root:!0,dir:!0,path:"",dirty:!0,flat:!0},$);for await(const et of _)et&&(j=await addToTree(et,j,$),(!et.unixfs||!et.unixfs.isDirectory())&&(yield et));if($.wrapWithDirectory)yield*flushAndYield(j,o);else for await(const et of j.eachChildSeries())et&&(yield*flushAndYield(et.child,o))}async function*importer(_,o,$={}){const j=defaultOptions$m($);let et;typeof $.dagBuilder=="function"?et=$.dagBuilder:et=dagBuilder;let tt;typeof $.treeBuilder=="function"?tt=$.treeBuilder:tt=treeBuilder;let rt;Symbol.asyncIterator in _||Symbol.iterator in _?rt=_:rt=[_];for await(const nt of tt(parallelBatch(et(rt,o,j),j.fileImportConcurrency),o,j))yield{cid:nt.cid,path:nt.path,unixfs:nt.unixfs,size:nt.size}}async function*normaliseCandidateMultiple(_,o){if(typeof _=="string"||_ instanceof String||isBytes(_)||isBlob(_)||_._readableState)throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const $=peekableIterator(_),{value:j,done:et}=await $.peek();if(et){yield*[];return}if($.push(j),Number.isInteger(j))throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(j._readableState){yield*map$3($,tt=>toFileObject({content:tt},o));return}if(isBytes(j)){yield toFileObject({content:$},o);return}if(isFileObject(j)||j[Symbol.iterator]||j[Symbol.asyncIterator]||isReadableStream(j)||isBlob(j)){yield*map$3($,tt=>toFileObject(tt,o));return}}throw isFileObject(_)?errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}async function toFileObject(_,o){const{path:$,mode:j,mtime:et,content:tt}=_,rt={path:$||"",mode:parseMode(j),mtime:parseMtime$1(et)};return tt?rt.content=await o(tt):$||(rt.content=await o(_)),rt}function normaliseInput$1(_){return normaliseCandidateMultiple(_,normaliseContent$1)}const parseChunkerString=_=>{if(_)if(_.startsWith("size-")){const o=_.split("-")[1],$=parseInt(o);if(isNaN($))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:$}}else{if(_.startsWith("rabin"))return{chunker:"rabin",...parseRabinString(_)};throw new Error(`Unrecognized chunker option: ${_}`)}else return{chunker:"fixed"}},parseRabinString=_=>{const o={},$=_.split("-");switch($.length){case 1:o.avgChunkSize=262144;break;case 2:o.avgChunkSize=parseChunkSize($[1],"avg");break;case 4:o.minChunkSize=parseChunkSize($[1],"min"),o.avgChunkSize=parseChunkSize($[2],"avg"),o.maxChunkSize=parseChunkSize($[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return o},parseChunkSize=(_,o)=>{const $=parseInt(_);if(isNaN($))throw new Error(`Chunker parameter ${o} must be an integer`);return $},mergeOptions$d=mergeOptions$g.bind({ignoreUndefined:!0});function createAddAll$2({repo:_,preload:o,hashers:$,options:j}){const et=j&&j.sharding;async function*tt(rt,nt={}){const it=mergeOptions$d({shardSplitThreshold:et?1e3:1/0,strategy:"balanced"},nt,{...parseChunkerString(nt.chunker)});it.hashAlg&&it.hashAlg!=="sha2-256"&&it.cidVersion!==1&&(it.cidVersion=1),it.trickle&&(it.strategy="trickle"),it.strategy==="trickle"&&(it.leafType="raw",it.reduceSingleLeafToSelf=!1),it.cidVersion>0&&it.rawLeaves===void 0&&(it.rawLeaves=!0),it.hashAlg!==void 0&&it.rawLeaves===void 0&&(it.rawLeaves=!0),delete it.trickle;const st={};if(it.progress){const ut=it.progress;it.progress=(ft,ht)=>{st[ht]||(st[ht]=0),st[ht]+=ft,ut(st[ht],ht)}}let ot;it.hashAlg!=null&&(ot=await $.getHasher(it.hashAlg));const at=pipe(normaliseInput$1(rt),ut=>importer(ut,_.blocks,{...it,hasher:ot,pin:!1}),transformFile(it),preloadFile(o,it),pinFile(_,it)),ct=await _.gcLock.readLock();try{for await(const ut of at){const ft=ut.path??ut.cid.toString();delete st[ft],yield{...ut,path:ft}}}finally{ct()}}return withTimeoutOption(tt)}function transformFile(_){async function*o($){for await(const j of $){let et=j.cid;_.cidVersion===1&&(et=et.toV1());let tt=j.path?j.path:et.toString();_.wrapWithDirectory&&!j.path&&(tt=""),yield{path:tt,cid:et,size:j.size,mode:j.unixfs&&j.unixfs.mode,mtime:j.unixfs&&j.unixfs.mtime}}}return o}function preloadFile(_,o){async function*$(j){for await(const et of j)(!et.path||o.wrapWithDirectory?et.path==="":!et.path.includes("/"))&&!o.onlyHash&&o.preload!==!1&&_(et.cid),yield et}return $}function pinFile(_,o){async function*$(j){for await(const et of j){const tt=!(et.path&&et.path.includes("/"));(o.pin==null?!0:o.pin)&&tt&&!o.onlyHash&&await _.pins.pinRecursively(et.cid),yield et}}return $}const hashFn=async function(_){return(await murmur3128.encode(_)).slice(0,8).reverse()},addLinksToHamtBucket$1=(_,o,$)=>Promise.all(_.map(j=>{if(j.Name==null)throw new Error("Unexpected Link without a Name");if(j.Name.length===2){const et=parseInt(j.Name,16);return o._putObjectAt(et,new Bucket({hash:$._options.hash,bits:$._options.bits},o,et))}return $.put(j.Name.substring(2),!0)})),toPrefix$1=_=>_.toString(16).toUpperCase().padStart(2,"0").substring(0,2),toBucketPath$1=_=>{let o=_.bucket;const $=[];for(;o._parent;)$.push(o),o=o._parent;return $.push(o),$.reverse()},findShardCid=async(_,o,$,j,et)=>{if(!j){const ot=createHAMT({hashFn});j={rootBucket:ot,hamtDepth:1,lastBucket:ot}}await addLinksToHamtBucket$1(_.Links,j.lastBucket,j.rootBucket);const tt=await j.rootBucket._findNewBucketAndPos(o);let rt=toPrefix$1(tt.pos);const nt=toBucketPath$1(tt);nt.length>j.hamtDepth&&(j.lastBucket=nt[j.hamtDepth],rt=toPrefix$1(j.lastBucket._posAtParent));const it=_.Links.find(ot=>{if(ot.Name==null)return!1;const at=ot.Name.substring(0,2),ct=ot.Name.substring(2);return!(at!==rt||ct&&ct!==o)});if(!it)return null;if(it.Name!=null&&it.Name.substring(2)===o)return it.Hash;j.hamtDepth++;const st=await $.get(it.Hash,et);return _=decode$y(st),findShardCid(_,o,$,j,et)};function extractDataFromBlock(_,o,$,j){const et=_.length,tt=o+et;return $>=tt||j<o?new Uint8Array(0):(j>=o&&j<tt&&(_=_.subarray(0,j-o)),$>=o&&$<tt&&(_=_.subarray($-o)),_)}const validateOffsetAndLength=(_,o,$)=>{if(o||(o=0),o<0)throw errCode(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(o>_)throw errCode(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!$&&$!==0&&($=_-o),$<0)throw errCode(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return o+$>_&&($=_-o),{offset:o,length:$}};async function walkDAG(_,o,$,j,et,tt,rt,nt){if(o instanceof Uint8Array){$.push(extractDataFromBlock(o,j,et,tt));return}if(o.Data==null)throw errCode(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let it;try{it=UnixFS.unmarshal(o.Data)}catch(ot){throw errCode(ot,"ERR_NOT_UNIXFS")}if(it.data!=null){const ot=it.data,at=extractDataFromBlock(ot,j,et,tt);$.push(at),j+=at.byteLength}const st=[];for(let ot=0;ot<o.Links.length;ot++){const at=o.Links[ot],ct=j,ut=ct+it.blockSizes[ot];if((et>=ct&&et<ut||tt>=ct&&tt<=ut||et<ct&&tt>ut)&&st.push({link:at,blockStart:j}),j=ut,j>tt)break}await pipe(st,ot=>map$3(ot,at=>async()=>{const ct=await _.get(at.link.Hash,{signal:nt.signal});return{...at,block:ct}}),ot=>parallel(ot,{ordered:!0}),async ot=>{for await(const{link:at,block:ct,blockStart:ut}of ot){let ft;switch(at.Hash.code){case code$9:ft=decode$y(ct);break;case code$6:ft=ct;break;default:$.end(errCode(new Error(`Unsupported codec: ${at.Hash.code}`),"ERR_NOT_UNIXFS"));return}rt.add(async()=>{await walkDAG(_,ft,$,ut,et,tt,rt,nt)})}})}const fileContent=(_,o,$,j,et,tt,rt)=>{async function*nt(it={}){const st=$.fileSize();if(st===void 0)throw new Error("File was a directory");const{offset:ot,length:at}=validateOffsetAndLength(st,it.offset,it.length);if(at===0)return;const ct=new PQueue({concurrency:1}),ut=pushable();ct.add(async()=>{await walkDAG(rt,o,ut,0,ot,ot+at,ct,it)}),ct.on("error",ht=>{ut.end(ht)});let ft=0;for await(const ht of ut)ht!=null&&(ft+=ht.byteLength,ft===at&&ut.end(),yield ht)}return nt},directoryContent=(_,o,$,j,et,tt,rt)=>{async function*nt(it={}){const st=it.offset||0,ot=it.length||o.Links.length,at=o.Links.slice(st,ot);for(const ct of at){const ut=await et(ct.Hash,ct.Name||"",`${j}/${ct.Name||""}`,[],tt+1,rt,it);ut.entry&&(yield ut.entry)}}return nt},hamtShardedDirectoryContent=(_,o,$,j,et,tt,rt)=>{function nt(it={}){return listDirectory(o,j,et,tt,rt,it)}return nt};async function*listDirectory(_,o,$,j,et,tt){const rt=_.Links;for(const nt of rt){const it=nt.Name!=null?nt.Name.substring(2):null;if(it)yield(await $(nt.Hash,it,`${o}/${it}`,[],j+1,et,tt)).entry;else{const st=await et.get(nt.Hash);_=decode$y(st);for await(const ot of listDirectory(_,o,$,j,et,tt))yield ot}}}const findLinkCid=(_,o)=>{const $=_.Links.find(j=>j.Name===o);return $&&$.Hash},contentExporters={raw:fileContent,file:fileContent,directory:directoryContent,"hamt-sharded-directory":hamtShardedDirectoryContent,metadata:(_,o,$,j,et,tt,rt)=>()=>[],symlink:(_,o,$,j,et,tt,rt)=>()=>[]},unixFsResolver=async(_,o,$,j,et,tt,rt,nt)=>{const it=await rt.get(_,nt),st=decode$y(it);let ot,at;if(o||(o=_.toString()),st.Data==null)throw errCode(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{ot=UnixFS.unmarshal(st.Data)}catch(ct){throw errCode(ct,"ERR_NOT_UNIXFS")}if($||($=o),j.length){let ct;if(ot&&ot.type==="hamt-sharded-directory"?ct=await findShardCid(st,j[0],rt):ct=findLinkCid(st,j[0]),!ct)throw errCode(new Error("file does not exist"),"ERR_NOT_FOUND");const ut=j.shift(),ft=`${$}/${ut}`;at={cid:ct,toResolve:j,name:ut||"",path:ft}}return{entry:{type:ot.isDirectory()?"directory":"file",name:o,path:$,cid:_,content:contentExporters[ot.type](_,st,ot,$,et,tt,rt),unixfs:ot,depth:tt,node:st,size:ot.fileSize()},next:at}},rawContent$1=_=>{async function*o($={}){const{offset:j,length:et}=validateOffsetAndLength(_.length,$.offset,$.length);yield extractDataFromBlock(_,0,j,j+et)}return o},resolve$4=async(_,o,$,j,et,tt,rt,nt)=>{if(j.length)throw errCode(new Error(`No link named ${$} found in raw node ${_}`),"ERR_NOT_FOUND");const it=await rt.get(_,nt);return{entry:{type:"raw",name:o,path:$,cid:_,content:rawContent$1(it),depth:tt,size:it.length,node:it}}},resolve$3=async(_,o,$,j,et,tt,rt,nt)=>{const it=await rt.get(_),st=decode$w(it);let ot=st,at=$;for(;j.length;){const ct=j[0];if(ct in ot){j.shift(),at=`${at}/${ct}`;const ut=CID$3.asCID(ot[ct]);if(ut)return{entry:{type:"object",name:o,path:$,cid:_,node:it,depth:tt,size:it.length,content:async function*(){yield st}},next:{cid:ut,name:ct,path:at,toResolve:j}};ot=ot[ct]}else throw errCode(new Error(`No property named ${ct} found in cbor node ${_}`),"ERR_NO_PROP")}return{entry:{type:"object",name:o,path:$,cid:_,node:it,depth:tt,size:it.length,content:async function*(){yield st}}}},rawContent=_=>{async function*o($={}){const{offset:j,length:et}=validateOffsetAndLength(_.length,$.offset,$.length);yield extractDataFromBlock(_,0,j,j+et)}return o},resolve$2=async(_,o,$,j,et,tt,rt,nt)=>{if(j.length)throw errCode(new Error(`No link named ${$} found in raw node ${_}`),"ERR_NOT_FOUND");const it=await decode$B(_.multihash.bytes);return{entry:{type:"identity",name:o,path:$,cid:_,content:rawContent(it.digest),depth:tt,size:it.digest.length,node:it.digest}}},resolvers$2={[code$9]:unixFsResolver,[code$6]:resolve$4,[code$8]:resolve$3,[identity$3.code]:resolve$2};function resolve$1(_,o,$,j,et,tt,rt){const nt=resolvers$2[_.code];if(!nt)throw errCode(new Error(`No resolver for code ${_.code}`),"ERR_NO_RESOLVER");return nt(_,o,$,j,resolve$1,et,tt,rt)}const toPathComponents$1=(_="")=>(_.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),cidAndRest=_=>{if(_ instanceof Uint8Array)return{cid:CID$3.decode(_),toResolve:[]};const o=CID$3.asCID(_);if(o)return{cid:o,toResolve:[]};if(typeof _=="string"){_.indexOf("/ipfs/")===0&&(_=_.substring(6));const $=toPathComponents$1(_);return{cid:CID$3.parse($[0]),toResolve:$.slice(1)}}throw errCode(new Error(`Unknown path type ${_}`),"ERR_BAD_PATH")};async function*walkPath(_,o,$={}){let{cid:j,toResolve:et}=cidAndRest(_),tt=j.toString(),rt=tt;const nt=et.length;for(;;){const it=await resolve$1(j,tt,rt,et,nt,o,$);if(!it.entry&&!it.next)throw errCode(new Error(`Could not resolve ${_}`),"ERR_NOT_FOUND");if(it.entry&&(yield it.entry),!it.next)return;et=it.next.toResolve,j=it.next.cid,tt=it.next.name,rt=it.next.path}}async function exporter(_,o,$={}){const j=await last(walkPath(_,o,$));if(!j)throw errCode(new Error(`Could not resolve ${_}`),"ERR_NOT_FOUND");return j}async function*recursive(_,o,$={}){const j=await exporter(_,o,$);if(!j)return;if(yield j,j.type==="directory")for await(const tt of et(j,$))yield tt;async function*et(tt,rt){for await(const nt of tt.content(rt))yield nt,!(nt instanceof Uint8Array)&&nt.type==="directory"&&(yield*et(nt,rt))}}function createCat$1({repo:_,preload:o}){async function*$(j,et={}){if(j=normalizeCidPath(j),et.preload!==!1){const rt=j.split("/");o(CID$3.parse(rt[0]))}const tt=await exporter(j,_.blocks,et);if(tt.type==="directory")throw new Error("this dag node is a directory");if(!tt.content)throw new Error("this dag node has no content");yield*tt.content(et)}return withTimeoutOption($)}fromString$8("ustar\0","binary");fromString$8("ustar ","binary");fromString$8(" \0","binary");function reader$3(_){const o=async function*(){let $=yield,j=new Uint8ArrayList;for await(const et of _){if($==null){j.append(et),$=yield j,j=new Uint8ArrayList;continue}for(j.append(et);j.length>=$;){const tt=j.sublist(0,$);if(j.consume($),$=yield tt,$==null){j.length>0&&($=yield j,j=new Uint8ArrayList);break}}}if($!=null)throw Object.assign(new Error(`stream ended before ${$} bytes became available`),{code:"ERR_UNDER_READ",buffer:j})}();return o.next(),o}var index_browser={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:8,RTLD_LOCAL:4,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGINFO:29,SIGSYS:12,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,UV_FS_O_FILEMAP:0,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_DSYNC:4194304,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488447,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6};async function toBuffer(_){let o=new Uint8Array(0);for await(const $ of _)o=concat$2([o,$],o.length+$.length);return o}const ZEROS="0000000000000000000",SEVENS="7777777777777777777",ZERO_OFFSET="0".charCodeAt(0),USTAR_MAGIC=fromString$8("ustar\0","binary"),USTAR_VER=fromString$8("00","binary"),MASK=parseInt("7777",8),MAGIC_OFFSET=257,VERSION_OFFSET=263,toTypeflag=function(_){switch(_){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72;default:return 0}},cksum=function(_){let o=256;for(let $=0;$<148;$++)o+=_[$];for(let $=156;$<512;$++)o+=_[$];return o},encodeOct=function(_,o){const $=_.toString(8);return $.length>o?fromString$8(SEVENS.slice(0,o)+" "):fromString$8(ZEROS.slice(0,o-$.length)+$+" ")},addLength=function(_){const o=fromString$8(_).byteLength;let $=Math.floor(Math.log(o)/Math.log(10))+1;return o+$>=Math.pow(10,$)&&$++,`${o+$}${_}`};function encodePax$1(_){let o="";_.name!=null&&(o+=addLength(" path="+_.name+`
`)),_.linkname!=null&&(o+=addLength(" linkpath="+_.linkname+`
`));const $=_.pax;if($!=null)for(const j in $)Object.prototype.hasOwnProperty.call($,j)&&(o+=addLength(" "+j+"="+$[j]+`
`));return fromString$8(o)}function encode$7(_){const o=new Uint8Array(512);let $=_.name,j="";if(_.typeflag===5&&$[$.length-1]!=="/"&&($+="/"),fromString$8($).byteLength!==$.length)return null;for(;fromString$8($).byteLength>100;){const et=$.indexOf("/");if(et===-1)return null;j+=j!==""?"/"+$.slice(0,et):$.slice(0,et),$=$.slice(et+1)}return fromString$8($).byteLength>100||fromString$8(j).byteLength>155||_.linkname!=null&&fromString$8(_.linkname).byteLength>100?null:(o.set(fromString$8($),0),o.set(encodeOct(_.mode&MASK,6),100),o.set(encodeOct(_.uid,6),108),o.set(encodeOct(_.gid,6),116),o.set(encodeOct(_.size,11),124),o.set(encodeOct(_.mtime.getTime()/1e3|0,11),136),o[156]=ZERO_OFFSET+toTypeflag(_.type),_.linkname!=null&&o.set(fromString$8(_.linkname),157),o.set(USTAR_MAGIC,MAGIC_OFFSET),o.set(USTAR_VER,VERSION_OFFSET),_.uname!=null&&o.set(fromString$8(_.uname),265),_.gname!=null&&o.set(fromString$8(_.gname),297),o.set(encodeOct(_.devmajor??0,6),329),o.set(encodeOct(_.devminor??0,6),337),j!=null&&o.set(fromString$8(j),345),o.set(encodeOct(cksum(o),6),148),o)}const{S_IFMT,S_IFBLK,S_IFCHR,S_IFDIR,S_IFIFO,S_IFLNK}=index_browser,DMODE=parseInt("755",8),FMODE=parseInt("644",8),END_OF_TAR=new Uint8Array(1024);function modeToType(_=0){switch(_&S_IFMT){case S_IFBLK:return"block-device";case S_IFCHR:return"character-device";case S_IFDIR:return"directory";case S_IFIFO:return"fifo";case S_IFLNK:return"symlink";default:return"file"}}function getPadding(_){return _&=511,_!==0?END_OF_TAR.subarray(0,512-_):new Uint8Array(0)}function encode$6(_){if(_.pax==null){const o=encode$7(_);if(o!=null)return o}return encodePax(_)}function encodePax(_){const o=encodePax$1(_),$={name:"PaxHeader",mode:_.mode,uid:_.uid,gid:_.gid,size:o.length,mtime:_.mtime,type:"pax-header",linkname:_.linkname,uname:_.uname,gname:_.gname,devmajor:_.devmajor,devminor:_.devminor};return new Uint8ArrayList(encode$7($)??new Uint8Array(0),o,getPadding(o.length),encode$7({...$,size:_.size,type:_.type})??new Uint8Array(0)).subarray()}function pack(){return async function*(_){for await(let{header:o,body:$}of _){const j={...o,size:o.type==="symlink"?0:o.size??0,type:o.type??modeToType(o.mode),mode:o.mode??(o.type==="directory"?DMODE:FMODE),uid:o.uid??0,gid:o.gid??0,mtime:o.mtime??new Date};if(typeof $=="string"&&($=fromString$8($)),$ instanceof Uint8Array||isUint8ArrayList($)){j.size=$.length,yield encode$6(j),yield isUint8ArrayList($)?$.subarray():$,yield getPadding(j.size);continue}if(j.type==="symlink"&&j.linkname==null){if($==null)throw new Error("type was symlink but no linkname or body specified");j.linkname=toString$a(await toBuffer($)),yield encode$6(j);continue}if(yield encode$6(j),j.type!=="file"&&j.type!=="contiguous-file")continue;let et=0;for await(const tt of $??[])et+=tt.length,yield isUint8ArrayList(tt)?tt.subarray():tt;if(et!==j.size)throw new Error(`size mismatch, wrote ${et} of ${j.size} bytes`);yield getPadding(j.size)}yield END_OF_TAR}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(_){let o=_.length;for(;--o>=0;)_[o]=0}const STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(_,o,$,j,et){this.static_tree=_,this.extra_bits=o,this.extra_base=$,this.elems=j,this.max_length=et,this.has_stree=_&&_.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(_,o){this.dyn_tree=_,this.max_code=0,this.stat_desc=o}const d_code=_=>_<256?_dist_code[_]:_dist_code[256+(_>>>7)],put_short=(_,o)=>{_.pending_buf[_.pending++]=o&255,_.pending_buf[_.pending++]=o>>>8&255},send_bits=(_,o,$)=>{_.bi_valid>Buf_size-$?(_.bi_buf|=o<<_.bi_valid&65535,put_short(_,_.bi_buf),_.bi_buf=o>>Buf_size-_.bi_valid,_.bi_valid+=$-Buf_size):(_.bi_buf|=o<<_.bi_valid&65535,_.bi_valid+=$)},send_code=(_,o,$)=>{send_bits(_,$[o*2],$[o*2+1])},bi_reverse=(_,o)=>{let $=0;do $|=_&1,_>>>=1,$<<=1;while(--o>0);return $>>>1},bi_flush=_=>{_.bi_valid===16?(put_short(_,_.bi_buf),_.bi_buf=0,_.bi_valid=0):_.bi_valid>=8&&(_.pending_buf[_.pending++]=_.bi_buf&255,_.bi_buf>>=8,_.bi_valid-=8)},gen_bitlen=(_,o)=>{const $=o.dyn_tree,j=o.max_code,et=o.stat_desc.static_tree,tt=o.stat_desc.has_stree,rt=o.stat_desc.extra_bits,nt=o.stat_desc.extra_base,it=o.stat_desc.max_length;let st,ot,at,ct,ut,ft,ht=0;for(ct=0;ct<=MAX_BITS$1;ct++)_.bl_count[ct]=0;for($[_.heap[_.heap_max]*2+1]=0,st=_.heap_max+1;st<HEAP_SIZE$1;st++)ot=_.heap[st],ct=$[$[ot*2+1]*2+1]+1,ct>it&&(ct=it,ht++),$[ot*2+1]=ct,!(ot>j)&&(_.bl_count[ct]++,ut=0,ot>=nt&&(ut=rt[ot-nt]),ft=$[ot*2],_.opt_len+=ft*(ct+ut),tt&&(_.static_len+=ft*(et[ot*2+1]+ut)));if(ht!==0){do{for(ct=it-1;_.bl_count[ct]===0;)ct--;_.bl_count[ct]--,_.bl_count[ct+1]+=2,_.bl_count[it]--,ht-=2}while(ht>0);for(ct=it;ct!==0;ct--)for(ot=_.bl_count[ct];ot!==0;)at=_.heap[--st],!(at>j)&&($[at*2+1]!==ct&&(_.opt_len+=(ct-$[at*2+1])*$[at*2],$[at*2+1]=ct),ot--)}},gen_codes=(_,o,$)=>{const j=new Array(MAX_BITS$1+1);let et=0,tt,rt;for(tt=1;tt<=MAX_BITS$1;tt++)et=et+$[tt-1]<<1,j[tt]=et;for(rt=0;rt<=o;rt++){let nt=_[rt*2+1];nt!==0&&(_[rt*2]=bi_reverse(j[nt]++,nt))}},tr_static_init=()=>{let _,o,$,j,et;const tt=new Array(MAX_BITS$1+1);for($=0,j=0;j<LENGTH_CODES$1-1;j++)for(base_length[j]=$,_=0;_<1<<extra_lbits[j];_++)_length_code[$++]=j;for(_length_code[$-1]=j,et=0,j=0;j<16;j++)for(base_dist[j]=et,_=0;_<1<<extra_dbits[j];_++)_dist_code[et++]=j;for(et>>=7;j<D_CODES$1;j++)for(base_dist[j]=et<<7,_=0;_<1<<extra_dbits[j]-7;_++)_dist_code[256+et++]=j;for(o=0;o<=MAX_BITS$1;o++)tt[o]=0;for(_=0;_<=143;)static_ltree[_*2+1]=8,_++,tt[8]++;for(;_<=255;)static_ltree[_*2+1]=9,_++,tt[9]++;for(;_<=279;)static_ltree[_*2+1]=7,_++,tt[7]++;for(;_<=287;)static_ltree[_*2+1]=8,_++,tt[8]++;for(gen_codes(static_ltree,L_CODES$1+1,tt),_=0;_<D_CODES$1;_++)static_dtree[_*2+1]=5,static_dtree[_*2]=bi_reverse(_,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)},init_block=_=>{let o;for(o=0;o<L_CODES$1;o++)_.dyn_ltree[o*2]=0;for(o=0;o<D_CODES$1;o++)_.dyn_dtree[o*2]=0;for(o=0;o<BL_CODES$1;o++)_.bl_tree[o*2]=0;_.dyn_ltree[END_BLOCK*2]=1,_.opt_len=_.static_len=0,_.sym_next=_.matches=0},bi_windup=_=>{_.bi_valid>8?put_short(_,_.bi_buf):_.bi_valid>0&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0},smaller=(_,o,$,j)=>{const et=o*2,tt=$*2;return _[et]<_[tt]||_[et]===_[tt]&&j[o]<=j[$]},pqdownheap=(_,o,$)=>{const j=_.heap[$];let et=$<<1;for(;et<=_.heap_len&&(et<_.heap_len&&smaller(o,_.heap[et+1],_.heap[et],_.depth)&&et++,!smaller(o,j,_.heap[et],_.depth));)_.heap[$]=_.heap[et],$=et,et<<=1;_.heap[$]=j},compress_block=(_,o,$)=>{let j,et,tt=0,rt,nt;if(_.sym_next!==0)do j=_.pending_buf[_.sym_buf+tt++]&255,j+=(_.pending_buf[_.sym_buf+tt++]&255)<<8,et=_.pending_buf[_.sym_buf+tt++],j===0?send_code(_,et,o):(rt=_length_code[et],send_code(_,rt+LITERALS$1+1,o),nt=extra_lbits[rt],nt!==0&&(et-=base_length[rt],send_bits(_,et,nt)),j--,rt=d_code(j),send_code(_,rt,$),nt=extra_dbits[rt],nt!==0&&(j-=base_dist[rt],send_bits(_,j,nt)));while(tt<_.sym_next);send_code(_,END_BLOCK,o)},build_tree=(_,o)=>{const $=o.dyn_tree,j=o.stat_desc.static_tree,et=o.stat_desc.has_stree,tt=o.stat_desc.elems;let rt,nt,it=-1,st;for(_.heap_len=0,_.heap_max=HEAP_SIZE$1,rt=0;rt<tt;rt++)$[rt*2]!==0?(_.heap[++_.heap_len]=it=rt,_.depth[rt]=0):$[rt*2+1]=0;for(;_.heap_len<2;)st=_.heap[++_.heap_len]=it<2?++it:0,$[st*2]=1,_.depth[st]=0,_.opt_len--,et&&(_.static_len-=j[st*2+1]);for(o.max_code=it,rt=_.heap_len>>1;rt>=1;rt--)pqdownheap(_,$,rt);st=tt;do rt=_.heap[1],_.heap[1]=_.heap[_.heap_len--],pqdownheap(_,$,1),nt=_.heap[1],_.heap[--_.heap_max]=rt,_.heap[--_.heap_max]=nt,$[st*2]=$[rt*2]+$[nt*2],_.depth[st]=(_.depth[rt]>=_.depth[nt]?_.depth[rt]:_.depth[nt])+1,$[rt*2+1]=$[nt*2+1]=st,_.heap[1]=st++,pqdownheap(_,$,1);while(_.heap_len>=2);_.heap[--_.heap_max]=_.heap[1],gen_bitlen(_,o),gen_codes($,it,_.bl_count)},scan_tree=(_,o,$)=>{let j,et=-1,tt,rt=o[0*2+1],nt=0,it=7,st=4;for(rt===0&&(it=138,st=3),o[($+1)*2+1]=65535,j=0;j<=$;j++)tt=rt,rt=o[(j+1)*2+1],!(++nt<it&&tt===rt)&&(nt<st?_.bl_tree[tt*2]+=nt:tt!==0?(tt!==et&&_.bl_tree[tt*2]++,_.bl_tree[REP_3_6*2]++):nt<=10?_.bl_tree[REPZ_3_10*2]++:_.bl_tree[REPZ_11_138*2]++,nt=0,et=tt,rt===0?(it=138,st=3):tt===rt?(it=6,st=3):(it=7,st=4))},send_tree=(_,o,$)=>{let j,et=-1,tt,rt=o[0*2+1],nt=0,it=7,st=4;for(rt===0&&(it=138,st=3),j=0;j<=$;j++)if(tt=rt,rt=o[(j+1)*2+1],!(++nt<it&&tt===rt)){if(nt<st)do send_code(_,tt,_.bl_tree);while(--nt!==0);else tt!==0?(tt!==et&&(send_code(_,tt,_.bl_tree),nt--),send_code(_,REP_3_6,_.bl_tree),send_bits(_,nt-3,2)):nt<=10?(send_code(_,REPZ_3_10,_.bl_tree),send_bits(_,nt-3,3)):(send_code(_,REPZ_11_138,_.bl_tree),send_bits(_,nt-11,7));nt=0,et=tt,rt===0?(it=138,st=3):tt===rt?(it=6,st=3):(it=7,st=4)}},build_bl_tree=_=>{let o;for(scan_tree(_,_.dyn_ltree,_.l_desc.max_code),scan_tree(_,_.dyn_dtree,_.d_desc.max_code),build_tree(_,_.bl_desc),o=BL_CODES$1-1;o>=3&&_.bl_tree[bl_order[o]*2+1]===0;o--);return _.opt_len+=3*(o+1)+5+5+4,o},send_all_trees=(_,o,$,j)=>{let et;for(send_bits(_,o-257,5),send_bits(_,$-1,5),send_bits(_,j-4,4),et=0;et<j;et++)send_bits(_,_.bl_tree[bl_order[et]*2+1],3);send_tree(_,_.dyn_ltree,o-1),send_tree(_,_.dyn_dtree,$-1)},detect_data_type=_=>{let o=4093624447,$;for($=0;$<=31;$++,o>>>=1)if(o&1&&_.dyn_ltree[$*2]!==0)return Z_BINARY;if(_.dyn_ltree[9*2]!==0||_.dyn_ltree[10*2]!==0||_.dyn_ltree[13*2]!==0)return Z_TEXT;for($=32;$<LITERALS$1;$++)if(_.dyn_ltree[$*2]!==0)return Z_TEXT;return Z_BINARY};let static_init_done=!1;const _tr_init$1=_=>{static_init_done||(tr_static_init(),static_init_done=!0),_.l_desc=new TreeDesc(_.dyn_ltree,static_l_desc),_.d_desc=new TreeDesc(_.dyn_dtree,static_d_desc),_.bl_desc=new TreeDesc(_.bl_tree,static_bl_desc),_.bi_buf=0,_.bi_valid=0,init_block(_)},_tr_stored_block$1=(_,o,$,j)=>{send_bits(_,(STORED_BLOCK<<1)+(j?1:0),3),bi_windup(_),put_short(_,$),put_short(_,~$),$&&_.pending_buf.set(_.window.subarray(o,o+$),_.pending),_.pending+=$},_tr_align$1=_=>{send_bits(_,STATIC_TREES<<1,3),send_code(_,END_BLOCK,static_ltree),bi_flush(_)},_tr_flush_block$1=(_,o,$,j)=>{let et,tt,rt=0;_.level>0?(_.strm.data_type===Z_UNKNOWN$1&&(_.strm.data_type=detect_data_type(_)),build_tree(_,_.l_desc),build_tree(_,_.d_desc),rt=build_bl_tree(_),et=_.opt_len+3+7>>>3,tt=_.static_len+3+7>>>3,tt<=et&&(et=tt)):et=tt=$+5,$+4<=et&&o!==-1?_tr_stored_block$1(_,o,$,j):_.strategy===Z_FIXED$1||tt===et?(send_bits(_,(STATIC_TREES<<1)+(j?1:0),3),compress_block(_,static_ltree,static_dtree)):(send_bits(_,(DYN_TREES<<1)+(j?1:0),3),send_all_trees(_,_.l_desc.max_code+1,_.d_desc.max_code+1,rt+1),compress_block(_,_.dyn_ltree,_.dyn_dtree)),init_block(_),j&&bi_windup(_)},_tr_tally$1=(_,o,$)=>(_.pending_buf[_.sym_buf+_.sym_next++]=o,_.pending_buf[_.sym_buf+_.sym_next++]=o>>8,_.pending_buf[_.sym_buf+_.sym_next++]=$,o===0?_.dyn_ltree[$*2]++:(_.matches++,o--,_.dyn_ltree[(_length_code[$]+LITERALS$1+1)*2]++,_.dyn_dtree[d_code(o)*2]++),_.sym_next===_.sym_end);var _tr_init_1=_tr_init$1,_tr_stored_block_1=_tr_stored_block$1,_tr_flush_block_1=_tr_flush_block$1,_tr_tally_1=_tr_tally$1,_tr_align_1=_tr_align$1,trees={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};const adler32=(_,o,$,j)=>{let et=_&65535|0,tt=_>>>16&65535|0,rt=0;for(;$!==0;){rt=$>2e3?2e3:$,$-=rt;do et=et+o[j++]|0,tt=tt+et|0;while(--rt);et%=65521,tt%=65521}return et|tt<<16|0};var adler32_1=adler32;const makeTable=()=>{let _,o=[];for(var $=0;$<256;$++){_=$;for(var j=0;j<8;j++)_=_&1?3988292384^_>>>1:_>>>1;o[$]=_}return o},crcTable=new Uint32Array(makeTable()),crc32=(_,o,$,j)=>{const et=crcTable,tt=j+$;_^=-1;for(let rt=j;rt<tt;rt++)_=_>>>8^et[(_^o[rt])&255];return _^-1};var crc32_1=crc32,messages$1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,GZIP_STATE=57,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=(_,o)=>(_.msg=messages$1[o],o),rank=_=>_*2-(_>4?9:0),zero=_=>{let o=_.length;for(;--o>=0;)_[o]=0},slide_hash=_=>{let o,$,j,et=_.w_size;o=_.hash_size,j=o;do $=_.head[--j],_.head[j]=$>=et?$-et:0;while(--o);o=et,j=o;do $=_.prev[--j],_.prev[j]=$>=et?$-et:0;while(--o)};let HASH_ZLIB=(_,o,$)=>(o<<_.hash_shift^$)&_.hash_mask,HASH=HASH_ZLIB;const flush_pending=_=>{const o=_.state;let $=o.pending;$>_.avail_out&&($=_.avail_out),$!==0&&(_.output.set(o.pending_buf.subarray(o.pending_out,o.pending_out+$),_.next_out),_.next_out+=$,o.pending_out+=$,_.total_out+=$,_.avail_out-=$,o.pending-=$,o.pending===0&&(o.pending_out=0))},flush_block_only=(_,o)=>{_tr_flush_block(_,_.block_start>=0?_.block_start:-1,_.strstart-_.block_start,o),_.block_start=_.strstart,flush_pending(_.strm)},put_byte=(_,o)=>{_.pending_buf[_.pending++]=o},putShortMSB=(_,o)=>{_.pending_buf[_.pending++]=o>>>8&255,_.pending_buf[_.pending++]=o&255},read_buf=(_,o,$,j)=>{let et=_.avail_in;return et>j&&(et=j),et===0?0:(_.avail_in-=et,o.set(_.input.subarray(_.next_in,_.next_in+et),$),_.state.wrap===1?_.adler=adler32_1(_.adler,o,et,$):_.state.wrap===2&&(_.adler=crc32_1(_.adler,o,et,$)),_.next_in+=et,_.total_in+=et,et)},longest_match=(_,o)=>{let $=_.max_chain_length,j=_.strstart,et,tt,rt=_.prev_length,nt=_.nice_match;const it=_.strstart>_.w_size-MIN_LOOKAHEAD?_.strstart-(_.w_size-MIN_LOOKAHEAD):0,st=_.window,ot=_.w_mask,at=_.prev,ct=_.strstart+MAX_MATCH;let ut=st[j+rt-1],ft=st[j+rt];_.prev_length>=_.good_match&&($>>=2),nt>_.lookahead&&(nt=_.lookahead);do if(et=o,!(st[et+rt]!==ft||st[et+rt-1]!==ut||st[et]!==st[j]||st[++et]!==st[j+1])){j+=2,et++;do;while(st[++j]===st[++et]&&st[++j]===st[++et]&&st[++j]===st[++et]&&st[++j]===st[++et]&&st[++j]===st[++et]&&st[++j]===st[++et]&&st[++j]===st[++et]&&st[++j]===st[++et]&&j<ct);if(tt=MAX_MATCH-(ct-j),j=ct-MAX_MATCH,tt>rt){if(_.match_start=o,rt=tt,tt>=nt)break;ut=st[j+rt-1],ft=st[j+rt]}}while((o=at[o&ot])>it&&--$!==0);return rt<=_.lookahead?rt:_.lookahead},fill_window=_=>{const o=_.w_size;let $,j,et;do{if(j=_.window_size-_.lookahead-_.strstart,_.strstart>=o+(o-MIN_LOOKAHEAD)&&(_.window.set(_.window.subarray(o,o+o-j),0),_.match_start-=o,_.strstart-=o,_.block_start-=o,_.insert>_.strstart&&(_.insert=_.strstart),slide_hash(_),j+=o),_.strm.avail_in===0)break;if($=read_buf(_.strm,_.window,_.strstart+_.lookahead,j),_.lookahead+=$,_.lookahead+_.insert>=MIN_MATCH)for(et=_.strstart-_.insert,_.ins_h=_.window[et],_.ins_h=HASH(_,_.ins_h,_.window[et+1]);_.insert&&(_.ins_h=HASH(_,_.ins_h,_.window[et+MIN_MATCH-1]),_.prev[et&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=et,et++,_.insert--,!(_.lookahead+_.insert<MIN_MATCH)););}while(_.lookahead<MIN_LOOKAHEAD&&_.strm.avail_in!==0)},deflate_stored=(_,o)=>{let $=_.pending_buf_size-5>_.w_size?_.w_size:_.pending_buf_size-5,j,et,tt,rt=0,nt=_.strm.avail_in;do{if(j=65535,tt=_.bi_valid+42>>3,_.strm.avail_out<tt||(tt=_.strm.avail_out-tt,et=_.strstart-_.block_start,j>et+_.strm.avail_in&&(j=et+_.strm.avail_in),j>tt&&(j=tt),j<$&&(j===0&&o!==Z_FINISH$3||o===Z_NO_FLUSH$2||j!==et+_.strm.avail_in)))break;rt=o===Z_FINISH$3&&j===et+_.strm.avail_in?1:0,_tr_stored_block(_,0,0,rt),_.pending_buf[_.pending-4]=j,_.pending_buf[_.pending-3]=j>>8,_.pending_buf[_.pending-2]=~j,_.pending_buf[_.pending-1]=~j>>8,flush_pending(_.strm),et&&(et>j&&(et=j),_.strm.output.set(_.window.subarray(_.block_start,_.block_start+et),_.strm.next_out),_.strm.next_out+=et,_.strm.avail_out-=et,_.strm.total_out+=et,_.block_start+=et,j-=et),j&&(read_buf(_.strm,_.strm.output,_.strm.next_out,j),_.strm.next_out+=j,_.strm.avail_out-=j,_.strm.total_out+=j)}while(rt===0);return nt-=_.strm.avail_in,nt&&(nt>=_.w_size?(_.matches=2,_.window.set(_.strm.input.subarray(_.strm.next_in-_.w_size,_.strm.next_in),0),_.strstart=_.w_size,_.insert=_.strstart):(_.window_size-_.strstart<=nt&&(_.strstart-=_.w_size,_.window.set(_.window.subarray(_.w_size,_.w_size+_.strstart),0),_.matches<2&&_.matches++,_.insert>_.strstart&&(_.insert=_.strstart)),_.window.set(_.strm.input.subarray(_.strm.next_in-nt,_.strm.next_in),_.strstart),_.strstart+=nt,_.insert+=nt>_.w_size-_.insert?_.w_size-_.insert:nt),_.block_start=_.strstart),_.high_water<_.strstart&&(_.high_water=_.strstart),rt?BS_FINISH_DONE:o!==Z_NO_FLUSH$2&&o!==Z_FINISH$3&&_.strm.avail_in===0&&_.strstart===_.block_start?BS_BLOCK_DONE:(tt=_.window_size-_.strstart,_.strm.avail_in>tt&&_.block_start>=_.w_size&&(_.block_start-=_.w_size,_.strstart-=_.w_size,_.window.set(_.window.subarray(_.w_size,_.w_size+_.strstart),0),_.matches<2&&_.matches++,tt+=_.w_size,_.insert>_.strstart&&(_.insert=_.strstart)),tt>_.strm.avail_in&&(tt=_.strm.avail_in),tt&&(read_buf(_.strm,_.window,_.strstart,tt),_.strstart+=tt,_.insert+=tt>_.w_size-_.insert?_.w_size-_.insert:tt),_.high_water<_.strstart&&(_.high_water=_.strstart),tt=_.bi_valid+42>>3,tt=_.pending_buf_size-tt>65535?65535:_.pending_buf_size-tt,$=tt>_.w_size?_.w_size:tt,et=_.strstart-_.block_start,(et>=$||(et||o===Z_FINISH$3)&&o!==Z_NO_FLUSH$2&&_.strm.avail_in===0&&et<=tt)&&(j=et>tt?tt:et,rt=o===Z_FINISH$3&&_.strm.avail_in===0&&j===et?1:0,_tr_stored_block(_,_.block_start,j,rt),_.block_start+=j,flush_pending(_.strm)),rt?BS_FINISH_STARTED:BS_NEED_MORE)},deflate_fast=(_,o)=>{let $,j;for(;;){if(_.lookahead<MIN_LOOKAHEAD){if(fill_window(_),_.lookahead<MIN_LOOKAHEAD&&o===Z_NO_FLUSH$2)return BS_NEED_MORE;if(_.lookahead===0)break}if($=0,_.lookahead>=MIN_MATCH&&(_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),$!==0&&_.strstart-$<=_.w_size-MIN_LOOKAHEAD&&(_.match_length=longest_match(_,$)),_.match_length>=MIN_MATCH)if(j=_tr_tally(_,_.strstart-_.match_start,_.match_length-MIN_MATCH),_.lookahead-=_.match_length,_.match_length<=_.max_lazy_match&&_.lookahead>=MIN_MATCH){_.match_length--;do _.strstart++,_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart;while(--_.match_length!==0);_.strstart++}else _.strstart+=_.match_length,_.match_length=0,_.ins_h=_.window[_.strstart],_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+1]);else j=_tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++;if(j&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}return _.insert=_.strstart<MIN_MATCH-1?_.strstart:MIN_MATCH-1,o===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.sym_next&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(_,o)=>{let $,j,et;for(;;){if(_.lookahead<MIN_LOOKAHEAD){if(fill_window(_),_.lookahead<MIN_LOOKAHEAD&&o===Z_NO_FLUSH$2)return BS_NEED_MORE;if(_.lookahead===0)break}if($=0,_.lookahead>=MIN_MATCH&&(_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),_.prev_length=_.match_length,_.prev_match=_.match_start,_.match_length=MIN_MATCH-1,$!==0&&_.prev_length<_.max_lazy_match&&_.strstart-$<=_.w_size-MIN_LOOKAHEAD&&(_.match_length=longest_match(_,$),_.match_length<=5&&(_.strategy===Z_FILTERED||_.match_length===MIN_MATCH&&_.strstart-_.match_start>4096)&&(_.match_length=MIN_MATCH-1)),_.prev_length>=MIN_MATCH&&_.match_length<=_.prev_length){et=_.strstart+_.lookahead-MIN_MATCH,j=_tr_tally(_,_.strstart-1-_.prev_match,_.prev_length-MIN_MATCH),_.lookahead-=_.prev_length-1,_.prev_length-=2;do++_.strstart<=et&&(_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart);while(--_.prev_length!==0);if(_.match_available=0,_.match_length=MIN_MATCH-1,_.strstart++,j&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}else if(_.match_available){if(j=_tr_tally(_,0,_.window[_.strstart-1]),j&&flush_block_only(_,!1),_.strstart++,_.lookahead--,_.strm.avail_out===0)return BS_NEED_MORE}else _.match_available=1,_.strstart++,_.lookahead--}return _.match_available&&(j=_tr_tally(_,0,_.window[_.strstart-1]),_.match_available=0),_.insert=_.strstart<MIN_MATCH-1?_.strstart:MIN_MATCH-1,o===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.sym_next&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=(_,o)=>{let $,j,et,tt;const rt=_.window;for(;;){if(_.lookahead<=MAX_MATCH){if(fill_window(_),_.lookahead<=MAX_MATCH&&o===Z_NO_FLUSH$2)return BS_NEED_MORE;if(_.lookahead===0)break}if(_.match_length=0,_.lookahead>=MIN_MATCH&&_.strstart>0&&(et=_.strstart-1,j=rt[et],j===rt[++et]&&j===rt[++et]&&j===rt[++et])){tt=_.strstart+MAX_MATCH;do;while(j===rt[++et]&&j===rt[++et]&&j===rt[++et]&&j===rt[++et]&&j===rt[++et]&&j===rt[++et]&&j===rt[++et]&&j===rt[++et]&&et<tt);_.match_length=MAX_MATCH-(tt-et),_.match_length>_.lookahead&&(_.match_length=_.lookahead)}if(_.match_length>=MIN_MATCH?($=_tr_tally(_,1,_.match_length-MIN_MATCH),_.lookahead-=_.match_length,_.strstart+=_.match_length,_.match_length=0):($=_tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++),$&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}return _.insert=0,o===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.sym_next&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=(_,o)=>{let $;for(;;){if(_.lookahead===0&&(fill_window(_),_.lookahead===0)){if(o===Z_NO_FLUSH$2)return BS_NEED_MORE;break}if(_.match_length=0,$=_tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++,$&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}return _.insert=0,o===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.sym_next&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(_,o,$,j,et){this.good_length=_,this.max_lazy=o,this.nice_length=$,this.max_chain=j,this.func=et}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=_=>{_.window_size=2*_.w_size,zero(_.head),_.max_lazy_match=configuration_table[_.level].max_lazy,_.good_match=configuration_table[_.level].good_length,_.nice_match=configuration_table[_.level].nice_length,_.max_chain_length=configuration_table[_.level].max_chain,_.strstart=0,_.block_start=0,_.lookahead=0,_.insert=0,_.match_length=_.prev_length=MIN_MATCH-1,_.match_available=0,_.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*D_CODES+1)*2),this.bl_tree=new Uint16Array((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateStateCheck=_=>{if(!_)return 1;const o=_.state;return!o||o.strm!==_||o.status!==INIT_STATE&&o.status!==GZIP_STATE&&o.status!==EXTRA_STATE&&o.status!==NAME_STATE&&o.status!==COMMENT_STATE&&o.status!==HCRC_STATE&&o.status!==BUSY_STATE&&o.status!==FINISH_STATE?1:0},deflateResetKeep=_=>{if(deflateStateCheck(_))return err(_,Z_STREAM_ERROR$2);_.total_in=_.total_out=0,_.data_type=Z_UNKNOWN;const o=_.state;return o.pending=0,o.pending_out=0,o.wrap<0&&(o.wrap=-o.wrap),o.status=o.wrap===2?GZIP_STATE:o.wrap?INIT_STATE:BUSY_STATE,_.adler=o.wrap===2?0:1,o.last_flush=-2,_tr_init(o),Z_OK$3},deflateReset=_=>{const o=deflateResetKeep(_);return o===Z_OK$3&&lm_init(_.state),o},deflateSetHeader=(_,o)=>deflateStateCheck(_)||_.state.wrap!==2?Z_STREAM_ERROR$2:(_.state.gzhead=o,Z_OK$3),deflateInit2=(_,o,$,j,et,tt)=>{if(!_)return Z_STREAM_ERROR$2;let rt=1;if(o===Z_DEFAULT_COMPRESSION$1&&(o=6),j<0?(rt=0,j=-j):j>15&&(rt=2,j-=16),et<1||et>MAX_MEM_LEVEL||$!==Z_DEFLATED$2||j<8||j>15||o<0||o>9||tt<0||tt>Z_FIXED||j===8&&rt!==1)return err(_,Z_STREAM_ERROR$2);j===8&&(j=9);const nt=new DeflateState;return _.state=nt,nt.strm=_,nt.status=INIT_STATE,nt.wrap=rt,nt.gzhead=null,nt.w_bits=j,nt.w_size=1<<nt.w_bits,nt.w_mask=nt.w_size-1,nt.hash_bits=et+7,nt.hash_size=1<<nt.hash_bits,nt.hash_mask=nt.hash_size-1,nt.hash_shift=~~((nt.hash_bits+MIN_MATCH-1)/MIN_MATCH),nt.window=new Uint8Array(nt.w_size*2),nt.head=new Uint16Array(nt.hash_size),nt.prev=new Uint16Array(nt.w_size),nt.lit_bufsize=1<<et+6,nt.pending_buf_size=nt.lit_bufsize*4,nt.pending_buf=new Uint8Array(nt.pending_buf_size),nt.sym_buf=nt.lit_bufsize,nt.sym_end=(nt.lit_bufsize-1)*3,nt.level=o,nt.strategy=tt,nt.method=$,deflateReset(_)},deflateInit=(_,o)=>deflateInit2(_,o,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1),deflate$2=(_,o)=>{if(deflateStateCheck(_)||o>Z_BLOCK$1||o<0)return _?err(_,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const $=_.state;if(!_.output||_.avail_in!==0&&!_.input||$.status===FINISH_STATE&&o!==Z_FINISH$3)return err(_,_.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);const j=$.last_flush;if($.last_flush=o,$.pending!==0){if(flush_pending(_),_.avail_out===0)return $.last_flush=-1,Z_OK$3}else if(_.avail_in===0&&rank(o)<=rank(j)&&o!==Z_FINISH$3)return err(_,Z_BUF_ERROR$1);if($.status===FINISH_STATE&&_.avail_in!==0)return err(_,Z_BUF_ERROR$1);if($.status===INIT_STATE&&$.wrap===0&&($.status=BUSY_STATE),$.status===INIT_STATE){let et=Z_DEFLATED$2+($.w_bits-8<<4)<<8,tt=-1;if($.strategy>=Z_HUFFMAN_ONLY||$.level<2?tt=0:$.level<6?tt=1:$.level===6?tt=2:tt=3,et|=tt<<6,$.strstart!==0&&(et|=PRESET_DICT),et+=31-et%31,putShortMSB($,et),$.strstart!==0&&(putShortMSB($,_.adler>>>16),putShortMSB($,_.adler&65535)),_.adler=1,$.status=BUSY_STATE,flush_pending(_),$.pending!==0)return $.last_flush=-1,Z_OK$3}if($.status===GZIP_STATE){if(_.adler=0,put_byte($,31),put_byte($,139),put_byte($,8),$.gzhead)put_byte($,($.gzhead.text?1:0)+($.gzhead.hcrc?2:0)+($.gzhead.extra?4:0)+($.gzhead.name?8:0)+($.gzhead.comment?16:0)),put_byte($,$.gzhead.time&255),put_byte($,$.gzhead.time>>8&255),put_byte($,$.gzhead.time>>16&255),put_byte($,$.gzhead.time>>24&255),put_byte($,$.level===9?2:$.strategy>=Z_HUFFMAN_ONLY||$.level<2?4:0),put_byte($,$.gzhead.os&255),$.gzhead.extra&&$.gzhead.extra.length&&(put_byte($,$.gzhead.extra.length&255),put_byte($,$.gzhead.extra.length>>8&255)),$.gzhead.hcrc&&(_.adler=crc32_1(_.adler,$.pending_buf,$.pending,0)),$.gzindex=0,$.status=EXTRA_STATE;else if(put_byte($,0),put_byte($,0),put_byte($,0),put_byte($,0),put_byte($,0),put_byte($,$.level===9?2:$.strategy>=Z_HUFFMAN_ONLY||$.level<2?4:0),put_byte($,OS_CODE),$.status=BUSY_STATE,flush_pending(_),$.pending!==0)return $.last_flush=-1,Z_OK$3}if($.status===EXTRA_STATE){if($.gzhead.extra){let et=$.pending,tt=($.gzhead.extra.length&65535)-$.gzindex;for(;$.pending+tt>$.pending_buf_size;){let nt=$.pending_buf_size-$.pending;if($.pending_buf.set($.gzhead.extra.subarray($.gzindex,$.gzindex+nt),$.pending),$.pending=$.pending_buf_size,$.gzhead.hcrc&&$.pending>et&&(_.adler=crc32_1(_.adler,$.pending_buf,$.pending-et,et)),$.gzindex+=nt,flush_pending(_),$.pending!==0)return $.last_flush=-1,Z_OK$3;et=0,tt-=nt}let rt=new Uint8Array($.gzhead.extra);$.pending_buf.set(rt.subarray($.gzindex,$.gzindex+tt),$.pending),$.pending+=tt,$.gzhead.hcrc&&$.pending>et&&(_.adler=crc32_1(_.adler,$.pending_buf,$.pending-et,et)),$.gzindex=0}$.status=NAME_STATE}if($.status===NAME_STATE){if($.gzhead.name){let et=$.pending,tt;do{if($.pending===$.pending_buf_size){if($.gzhead.hcrc&&$.pending>et&&(_.adler=crc32_1(_.adler,$.pending_buf,$.pending-et,et)),flush_pending(_),$.pending!==0)return $.last_flush=-1,Z_OK$3;et=0}$.gzindex<$.gzhead.name.length?tt=$.gzhead.name.charCodeAt($.gzindex++)&255:tt=0,put_byte($,tt)}while(tt!==0);$.gzhead.hcrc&&$.pending>et&&(_.adler=crc32_1(_.adler,$.pending_buf,$.pending-et,et)),$.gzindex=0}$.status=COMMENT_STATE}if($.status===COMMENT_STATE){if($.gzhead.comment){let et=$.pending,tt;do{if($.pending===$.pending_buf_size){if($.gzhead.hcrc&&$.pending>et&&(_.adler=crc32_1(_.adler,$.pending_buf,$.pending-et,et)),flush_pending(_),$.pending!==0)return $.last_flush=-1,Z_OK$3;et=0}$.gzindex<$.gzhead.comment.length?tt=$.gzhead.comment.charCodeAt($.gzindex++)&255:tt=0,put_byte($,tt)}while(tt!==0);$.gzhead.hcrc&&$.pending>et&&(_.adler=crc32_1(_.adler,$.pending_buf,$.pending-et,et))}$.status=HCRC_STATE}if($.status===HCRC_STATE){if($.gzhead.hcrc){if($.pending+2>$.pending_buf_size&&(flush_pending(_),$.pending!==0))return $.last_flush=-1,Z_OK$3;put_byte($,_.adler&255),put_byte($,_.adler>>8&255),_.adler=0}if($.status=BUSY_STATE,flush_pending(_),$.pending!==0)return $.last_flush=-1,Z_OK$3}if(_.avail_in!==0||$.lookahead!==0||o!==Z_NO_FLUSH$2&&$.status!==FINISH_STATE){let et=$.level===0?deflate_stored($,o):$.strategy===Z_HUFFMAN_ONLY?deflate_huff($,o):$.strategy===Z_RLE?deflate_rle($,o):configuration_table[$.level].func($,o);if((et===BS_FINISH_STARTED||et===BS_FINISH_DONE)&&($.status=FINISH_STATE),et===BS_NEED_MORE||et===BS_FINISH_STARTED)return _.avail_out===0&&($.last_flush=-1),Z_OK$3;if(et===BS_BLOCK_DONE&&(o===Z_PARTIAL_FLUSH?_tr_align($):o!==Z_BLOCK$1&&(_tr_stored_block($,0,0,!1),o===Z_FULL_FLUSH$1&&(zero($.head),$.lookahead===0&&($.strstart=0,$.block_start=0,$.insert=0))),flush_pending(_),_.avail_out===0))return $.last_flush=-1,Z_OK$3}return o!==Z_FINISH$3?Z_OK$3:$.wrap<=0?Z_STREAM_END$3:($.wrap===2?(put_byte($,_.adler&255),put_byte($,_.adler>>8&255),put_byte($,_.adler>>16&255),put_byte($,_.adler>>24&255),put_byte($,_.total_in&255),put_byte($,_.total_in>>8&255),put_byte($,_.total_in>>16&255),put_byte($,_.total_in>>24&255)):(putShortMSB($,_.adler>>>16),putShortMSB($,_.adler&65535)),flush_pending(_),$.wrap>0&&($.wrap=-$.wrap),$.pending!==0?Z_OK$3:Z_STREAM_END$3)},deflateEnd=_=>{if(deflateStateCheck(_))return Z_STREAM_ERROR$2;const o=_.state.status;return _.state=null,o===BUSY_STATE?err(_,Z_DATA_ERROR$2):Z_OK$3},deflateSetDictionary=(_,o)=>{let $=o.length;if(deflateStateCheck(_))return Z_STREAM_ERROR$2;const j=_.state,et=j.wrap;if(et===2||et===1&&j.status!==INIT_STATE||j.lookahead)return Z_STREAM_ERROR$2;if(et===1&&(_.adler=adler32_1(_.adler,o,$,0)),j.wrap=0,$>=j.w_size){et===0&&(zero(j.head),j.strstart=0,j.block_start=0,j.insert=0);let it=new Uint8Array(j.w_size);it.set(o.subarray($-j.w_size,$),0),o=it,$=j.w_size}const tt=_.avail_in,rt=_.next_in,nt=_.input;for(_.avail_in=$,_.next_in=0,_.input=o,fill_window(j);j.lookahead>=MIN_MATCH;){let it=j.strstart,st=j.lookahead-(MIN_MATCH-1);do j.ins_h=HASH(j,j.ins_h,j.window[it+MIN_MATCH-1]),j.prev[it&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=it,it++;while(--st);j.strstart=it,j.lookahead=MIN_MATCH-1,fill_window(j)}return j.strstart+=j.lookahead,j.block_start=j.strstart,j.insert=j.lookahead,j.lookahead=0,j.match_length=j.prev_length=MIN_MATCH-1,j.match_available=0,_.next_in=rt,_.input=nt,_.avail_in=tt,j.wrap=et,Z_OK$3};var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2$1=deflate$2,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1$2={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2$1,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo};const _has=(_,o)=>Object.prototype.hasOwnProperty.call(_,o);var assign=function(_){const o=Array.prototype.slice.call(arguments,1);for(;o.length;){const $=o.shift();if($){if(typeof $!="object")throw new TypeError($+"must be non-object");for(const j in $)_has($,j)&&(_[j]=$[j])}}return _},flattenChunks=_=>{let o=0;for(let j=0,et=_.length;j<et;j++)o+=_[j].length;const $=new Uint8Array(o);for(let j=0,et=0,tt=_.length;j<tt;j++){let rt=_[j];$.set(rt,et),et+=rt.length}return $},common={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(_){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let _=0;_<256;_++)_utf8len[_]=_>=252?6:_>=248?5:_>=240?4:_>=224?3:_>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=_=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(_);let o,$,j,et,tt,rt=_.length,nt=0;for(et=0;et<rt;et++)$=_.charCodeAt(et),($&64512)===55296&&et+1<rt&&(j=_.charCodeAt(et+1),(j&64512)===56320&&($=65536+($-55296<<10)+(j-56320),et++)),nt+=$<128?1:$<2048?2:$<65536?3:4;for(o=new Uint8Array(nt),tt=0,et=0;tt<nt;et++)$=_.charCodeAt(et),($&64512)===55296&&et+1<rt&&(j=_.charCodeAt(et+1),(j&64512)===56320&&($=65536+($-55296<<10)+(j-56320),et++)),$<128?o[tt++]=$:$<2048?(o[tt++]=192|$>>>6,o[tt++]=128|$&63):$<65536?(o[tt++]=224|$>>>12,o[tt++]=128|$>>>6&63,o[tt++]=128|$&63):(o[tt++]=240|$>>>18,o[tt++]=128|$>>>12&63,o[tt++]=128|$>>>6&63,o[tt++]=128|$&63);return o};const buf2binstring=(_,o)=>{if(o<65534&&_.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,_.length===o?_:_.subarray(0,o));let $="";for(let j=0;j<o;j++)$+=String.fromCharCode(_[j]);return $};var buf2string=(_,o)=>{const $=o||_.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(_.subarray(0,o));let j,et;const tt=new Array($*2);for(et=0,j=0;j<$;){let rt=_[j++];if(rt<128){tt[et++]=rt;continue}let nt=_utf8len[rt];if(nt>4){tt[et++]=65533,j+=nt-1;continue}for(rt&=nt===2?31:nt===3?15:7;nt>1&&j<$;)rt=rt<<6|_[j++]&63,nt--;if(nt>1){tt[et++]=65533;continue}rt<65536?tt[et++]=rt:(rt-=65536,tt[et++]=55296|rt>>10&1023,tt[et++]=56320|rt&1023)}return buf2binstring(tt,et)},utf8border=(_,o)=>{o=o||_.length,o>_.length&&(o=_.length);let $=o-1;for(;$>=0&&(_[$]&192)===128;)$--;return $<0||$===0?o:$+_utf8len[_[$]]>o?$:o},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const toString$1$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2;function Deflate$1(_){this.options=common.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},_||{});let o=this.options;o.raw&&o.windowBits>0?o.windowBits=-o.windowBits:o.gzip&&o.windowBits>0&&o.windowBits<16&&(o.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let $=deflate_1$2.deflateInit2(this.strm,o.level,o.method,o.windowBits,o.memLevel,o.strategy);if($!==Z_OK$2)throw new Error(messages$1[$]);if(o.header&&deflate_1$2.deflateSetHeader(this.strm,o.header),o.dictionary){let j;if(typeof o.dictionary=="string"?j=strings.string2buf(o.dictionary):toString$1$1.call(o.dictionary)==="[object ArrayBuffer]"?j=new Uint8Array(o.dictionary):j=o.dictionary,$=deflate_1$2.deflateSetDictionary(this.strm,j),$!==Z_OK$2)throw new Error(messages$1[$]);this._dict_set=!0}}Deflate$1.prototype.push=function(_,o){const $=this.strm,j=this.options.chunkSize;let et,tt;if(this.ended)return!1;for(o===~~o?tt=o:tt=o===!0?Z_FINISH$2:Z_NO_FLUSH$1,typeof _=="string"?$.input=strings.string2buf(_):toString$1$1.call(_)==="[object ArrayBuffer]"?$.input=new Uint8Array(_):$.input=_,$.next_in=0,$.avail_in=$.input.length;;){if($.avail_out===0&&($.output=new Uint8Array(j),$.next_out=0,$.avail_out=j),(tt===Z_SYNC_FLUSH||tt===Z_FULL_FLUSH)&&$.avail_out<=6){this.onData($.output.subarray(0,$.next_out)),$.avail_out=0;continue}if(et=deflate_1$2.deflate($,tt),et===Z_STREAM_END$2)return $.next_out>0&&this.onData($.output.subarray(0,$.next_out)),et=deflate_1$2.deflateEnd(this.strm),this.onEnd(et),this.ended=!0,et===Z_OK$2;if($.avail_out===0){this.onData($.output);continue}if(tt>0&&$.next_out>0){this.onData($.output.subarray(0,$.next_out)),$.avail_out=0;continue}if($.avail_in===0)break}return!0};Deflate$1.prototype.onData=function(_){this.chunks.push(_)};Deflate$1.prototype.onEnd=function(_){_===Z_OK$2&&(this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function deflate$1(_,o){const $=new Deflate$1(o);if($.push(_,!0),$.err)throw $.msg||messages$1[$.err];return $.result}function deflateRaw$1(_,o){return o=o||{},o.raw=!0,deflate$1(_,o)}function gzip$1(_,o){return o=o||{},o.gzip=!0,deflate$1(_,o)}var Deflate_1$1=Deflate$1,deflate_2=deflate$1,deflateRaw_1$1=deflateRaw$1,gzip_1$1=gzip$1,constants$1=constants$2,deflate_1$1={Deflate:Deflate_1$1,deflate:deflate_2,deflateRaw:deflateRaw_1$1,gzip:gzip_1$1,constants:constants$1};const BAD$1=16209,TYPE$1=16191;var inffast=function _(o,$){let j,et,tt,rt,nt,it,st,ot,at,ct,ut,ft,ht,mt,gt,Et,St,At,kt,Rt,Tt,Dt,Ot,jt;const Nt=o.state;j=o.next_in,Ot=o.input,et=j+(o.avail_in-5),tt=o.next_out,jt=o.output,rt=tt-($-o.avail_out),nt=tt+(o.avail_out-257),it=Nt.dmax,st=Nt.wsize,ot=Nt.whave,at=Nt.wnext,ct=Nt.window,ut=Nt.hold,ft=Nt.bits,ht=Nt.lencode,mt=Nt.distcode,gt=(1<<Nt.lenbits)-1,Et=(1<<Nt.distbits)-1;e:do{ft<15&&(ut+=Ot[j++]<<ft,ft+=8,ut+=Ot[j++]<<ft,ft+=8),St=ht[ut&gt];t:for(;;){if(At=St>>>24,ut>>>=At,ft-=At,At=St>>>16&255,At===0)jt[tt++]=St&65535;else if(At&16){kt=St&65535,At&=15,At&&(ft<At&&(ut+=Ot[j++]<<ft,ft+=8),kt+=ut&(1<<At)-1,ut>>>=At,ft-=At),ft<15&&(ut+=Ot[j++]<<ft,ft+=8,ut+=Ot[j++]<<ft,ft+=8),St=mt[ut&Et];r:for(;;){if(At=St>>>24,ut>>>=At,ft-=At,At=St>>>16&255,At&16){if(Rt=St&65535,At&=15,ft<At&&(ut+=Ot[j++]<<ft,ft+=8,ft<At&&(ut+=Ot[j++]<<ft,ft+=8)),Rt+=ut&(1<<At)-1,Rt>it){o.msg="invalid distance too far back",Nt.mode=BAD$1;break e}if(ut>>>=At,ft-=At,At=tt-rt,Rt>At){if(At=Rt-At,At>ot&&Nt.sane){o.msg="invalid distance too far back",Nt.mode=BAD$1;break e}if(Tt=0,Dt=ct,at===0){if(Tt+=st-At,At<kt){kt-=At;do jt[tt++]=ct[Tt++];while(--At);Tt=tt-Rt,Dt=jt}}else if(at<At){if(Tt+=st+at-At,At-=at,At<kt){kt-=At;do jt[tt++]=ct[Tt++];while(--At);if(Tt=0,at<kt){At=at,kt-=At;do jt[tt++]=ct[Tt++];while(--At);Tt=tt-Rt,Dt=jt}}}else if(Tt+=at-At,At<kt){kt-=At;do jt[tt++]=ct[Tt++];while(--At);Tt=tt-Rt,Dt=jt}for(;kt>2;)jt[tt++]=Dt[Tt++],jt[tt++]=Dt[Tt++],jt[tt++]=Dt[Tt++],kt-=3;kt&&(jt[tt++]=Dt[Tt++],kt>1&&(jt[tt++]=Dt[Tt++]))}else{Tt=tt-Rt;do jt[tt++]=jt[Tt++],jt[tt++]=jt[Tt++],jt[tt++]=jt[Tt++],kt-=3;while(kt>2);kt&&(jt[tt++]=jt[Tt++],kt>1&&(jt[tt++]=jt[Tt++]))}}else if(At&64){o.msg="invalid distance code",Nt.mode=BAD$1;break e}else{St=mt[(St&65535)+(ut&(1<<At)-1)];continue r}break}}else if(At&64)if(At&32){Nt.mode=TYPE$1;break e}else{o.msg="invalid literal/length code",Nt.mode=BAD$1;break e}else{St=ht[(St&65535)+(ut&(1<<At)-1)];continue t}break}}while(j<et&&tt<nt);kt=ft>>3,j-=kt,ft-=kt<<3,ut&=(1<<ft)-1,o.next_in=j,o.next_out=tt,o.avail_in=j<et?5+(et-j):5-(j-et),o.avail_out=tt<nt?257+(nt-tt):257-(tt-nt),Nt.hold=ut,Nt.bits=ft};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(_,o,$,j,et,tt,rt,nt)=>{const it=nt.bits;let st=0,ot=0,at=0,ct=0,ut=0,ft=0,ht=0,mt=0,gt=0,Et=0,St,At,kt,Rt,Tt,Dt=null,Ot;const jt=new Uint16Array(MAXBITS+1),Nt=new Uint16Array(MAXBITS+1);let It=null,yt,lt,pt;for(st=0;st<=MAXBITS;st++)jt[st]=0;for(ot=0;ot<j;ot++)jt[o[$+ot]]++;for(ut=it,ct=MAXBITS;ct>=1&&jt[ct]===0;ct--);if(ut>ct&&(ut=ct),ct===0)return et[tt++]=1<<24|64<<16|0,et[tt++]=1<<24|64<<16|0,nt.bits=1,0;for(at=1;at<ct&&jt[at]===0;at++);for(ut<at&&(ut=at),mt=1,st=1;st<=MAXBITS;st++)if(mt<<=1,mt-=jt[st],mt<0)return-1;if(mt>0&&(_===CODES$1||ct!==1))return-1;for(Nt[1]=0,st=1;st<MAXBITS;st++)Nt[st+1]=Nt[st]+jt[st];for(ot=0;ot<j;ot++)o[$+ot]!==0&&(rt[Nt[o[$+ot]]++]=ot);if(_===CODES$1?(Dt=It=rt,Ot=20):_===LENS$1?(Dt=lbase,It=lext,Ot=257):(Dt=dbase,It=dext,Ot=0),Et=0,ot=0,st=at,Tt=tt,ft=ut,ht=0,kt=-1,gt=1<<ut,Rt=gt-1,_===LENS$1&&gt>ENOUGH_LENS$1||_===DISTS$1&&gt>ENOUGH_DISTS$1)return 1;for(;;){yt=st-ht,rt[ot]+1<Ot?(lt=0,pt=rt[ot]):rt[ot]>=Ot?(lt=It[rt[ot]-Ot],pt=Dt[rt[ot]-Ot]):(lt=32+64,pt=0),St=1<<st-ht,At=1<<ft,at=At;do At-=St,et[Tt+(Et>>ht)+At]=yt<<24|lt<<16|pt|0;while(At!==0);for(St=1<<st-1;Et&St;)St>>=1;if(St!==0?(Et&=St-1,Et+=St):Et=0,ot++,--jt[st]===0){if(st===ct)break;st=o[$+rt[ot]]}if(st>ut&&(Et&Rt)!==kt){for(ht===0&&(ht=ut),Tt+=at,ft=st-ht,mt=1<<ft;ft+ht<ct&&(mt-=jt[ft+ht],!(mt<=0));)ft++,mt<<=1;if(gt+=1<<ft,_===LENS$1&&gt>ENOUGH_LENS$1||_===DISTS$1&&gt>ENOUGH_DISTS$1)return 1;kt=Et&Rt,et[kt]=ut<<24|ft<<16|Tt-tt|0}}return Et!==0&&(et[Tt+Et]=st-ht<<24|64<<16|0),nt.bits=ut,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=_=>(_>>>24&255)+(_>>>8&65280)+((_&65280)<<8)+((_&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=_=>{if(!_)return 1;const o=_.state;return!o||o.strm!==_||o.mode<HEAD||o.mode>SYNC?1:0},inflateResetKeep=_=>{if(inflateStateCheck(_))return Z_STREAM_ERROR$1;const o=_.state;return _.total_in=_.total_out=o.total=0,_.msg="",o.wrap&&(_.adler=o.wrap&1),o.mode=HEAD,o.last=0,o.havedict=0,o.flags=-1,o.dmax=32768,o.head=null,o.hold=0,o.bits=0,o.lencode=o.lendyn=new Int32Array(ENOUGH_LENS),o.distcode=o.distdyn=new Int32Array(ENOUGH_DISTS),o.sane=1,o.back=-1,Z_OK$1},inflateReset=_=>{if(inflateStateCheck(_))return Z_STREAM_ERROR$1;const o=_.state;return o.wsize=0,o.whave=0,o.wnext=0,inflateResetKeep(_)},inflateReset2=(_,o)=>{let $;if(inflateStateCheck(_))return Z_STREAM_ERROR$1;const j=_.state;return o<0?($=0,o=-o):($=(o>>4)+5,o<48&&(o&=15)),o&&(o<8||o>15)?Z_STREAM_ERROR$1:(j.window!==null&&j.wbits!==o&&(j.window=null),j.wrap=$,j.wbits=o,inflateReset(_))},inflateInit2=(_,o)=>{if(!_)return Z_STREAM_ERROR$1;const $=new InflateState;_.state=$,$.strm=_,$.window=null,$.mode=HEAD;const j=inflateReset2(_,o);return j!==Z_OK$1&&(_.state=null),j},inflateInit=_=>inflateInit2(_,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=_=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let o=0;for(;o<144;)_.lens[o++]=8;for(;o<256;)_.lens[o++]=9;for(;o<280;)_.lens[o++]=7;for(;o<288;)_.lens[o++]=8;for(inftrees(LENS,_.lens,0,288,lenfix,0,_.work,{bits:9}),o=0;o<32;)_.lens[o++]=5;inftrees(DISTS,_.lens,0,32,distfix,0,_.work,{bits:5}),virgin=!1}_.lencode=lenfix,_.lenbits=9,_.distcode=distfix,_.distbits=5},updatewindow=(_,o,$,j)=>{let et;const tt=_.state;return tt.window===null&&(tt.wsize=1<<tt.wbits,tt.wnext=0,tt.whave=0,tt.window=new Uint8Array(tt.wsize)),j>=tt.wsize?(tt.window.set(o.subarray($-tt.wsize,$),0),tt.wnext=0,tt.whave=tt.wsize):(et=tt.wsize-tt.wnext,et>j&&(et=j),tt.window.set(o.subarray($-j,$-j+et),tt.wnext),j-=et,j?(tt.window.set(o.subarray($-j,$),0),tt.wnext=j,tt.whave=tt.wsize):(tt.wnext+=et,tt.wnext===tt.wsize&&(tt.wnext=0),tt.whave<tt.wsize&&(tt.whave+=et))),0},inflate$2=(_,o)=>{let $,j,et,tt,rt,nt,it,st,ot,at,ct,ut,ft,ht,mt=0,gt,Et,St,At,kt,Rt,Tt,Dt;const Ot=new Uint8Array(4);let jt,Nt;const It=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(_)||!_.output||!_.input&&_.avail_in!==0)return Z_STREAM_ERROR$1;$=_.state,$.mode===TYPE&&($.mode=TYPEDO),rt=_.next_out,et=_.output,it=_.avail_out,tt=_.next_in,j=_.input,nt=_.avail_in,st=$.hold,ot=$.bits,at=nt,ct=it,Dt=Z_OK$1;e:for(;;)switch($.mode){case HEAD:if($.wrap===0){$.mode=TYPEDO;break}for(;ot<16;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if($.wrap&2&&st===35615){$.wbits===0&&($.wbits=15),$.check=0,Ot[0]=st&255,Ot[1]=st>>>8&255,$.check=crc32_1($.check,Ot,2,0),st=0,ot=0,$.mode=FLAGS;break}if($.head&&($.head.done=!1),!($.wrap&1)||(((st&255)<<8)+(st>>8))%31){_.msg="incorrect header check",$.mode=BAD;break}if((st&15)!==Z_DEFLATED){_.msg="unknown compression method",$.mode=BAD;break}if(st>>>=4,ot-=4,Tt=(st&15)+8,$.wbits===0&&($.wbits=Tt),Tt>15||Tt>$.wbits){_.msg="invalid window size",$.mode=BAD;break}$.dmax=1<<$.wbits,$.flags=0,_.adler=$.check=1,$.mode=st&512?DICTID:TYPE,st=0,ot=0;break;case FLAGS:for(;ot<16;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if($.flags=st,($.flags&255)!==Z_DEFLATED){_.msg="unknown compression method",$.mode=BAD;break}if($.flags&57344){_.msg="unknown header flags set",$.mode=BAD;break}$.head&&($.head.text=st>>8&1),$.flags&512&&$.wrap&4&&(Ot[0]=st&255,Ot[1]=st>>>8&255,$.check=crc32_1($.check,Ot,2,0)),st=0,ot=0,$.mode=TIME;case TIME:for(;ot<32;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}$.head&&($.head.time=st),$.flags&512&&$.wrap&4&&(Ot[0]=st&255,Ot[1]=st>>>8&255,Ot[2]=st>>>16&255,Ot[3]=st>>>24&255,$.check=crc32_1($.check,Ot,4,0)),st=0,ot=0,$.mode=OS;case OS:for(;ot<16;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}$.head&&($.head.xflags=st&255,$.head.os=st>>8),$.flags&512&&$.wrap&4&&(Ot[0]=st&255,Ot[1]=st>>>8&255,$.check=crc32_1($.check,Ot,2,0)),st=0,ot=0,$.mode=EXLEN;case EXLEN:if($.flags&1024){for(;ot<16;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}$.length=st,$.head&&($.head.extra_len=st),$.flags&512&&$.wrap&4&&(Ot[0]=st&255,Ot[1]=st>>>8&255,$.check=crc32_1($.check,Ot,2,0)),st=0,ot=0}else $.head&&($.head.extra=null);$.mode=EXTRA;case EXTRA:if($.flags&1024&&(ut=$.length,ut>nt&&(ut=nt),ut&&($.head&&(Tt=$.head.extra_len-$.length,$.head.extra||($.head.extra=new Uint8Array($.head.extra_len)),$.head.extra.set(j.subarray(tt,tt+ut),Tt)),$.flags&512&&$.wrap&4&&($.check=crc32_1($.check,j,ut,tt)),nt-=ut,tt+=ut,$.length-=ut),$.length))break e;$.length=0,$.mode=NAME;case NAME:if($.flags&2048){if(nt===0)break e;ut=0;do Tt=j[tt+ut++],$.head&&Tt&&$.length<65536&&($.head.name+=String.fromCharCode(Tt));while(Tt&&ut<nt);if($.flags&512&&$.wrap&4&&($.check=crc32_1($.check,j,ut,tt)),nt-=ut,tt+=ut,Tt)break e}else $.head&&($.head.name=null);$.length=0,$.mode=COMMENT;case COMMENT:if($.flags&4096){if(nt===0)break e;ut=0;do Tt=j[tt+ut++],$.head&&Tt&&$.length<65536&&($.head.comment+=String.fromCharCode(Tt));while(Tt&&ut<nt);if($.flags&512&&$.wrap&4&&($.check=crc32_1($.check,j,ut,tt)),nt-=ut,tt+=ut,Tt)break e}else $.head&&($.head.comment=null);$.mode=HCRC;case HCRC:if($.flags&512){for(;ot<16;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if($.wrap&4&&st!==($.check&65535)){_.msg="header crc mismatch",$.mode=BAD;break}st=0,ot=0}$.head&&($.head.hcrc=$.flags>>9&1,$.head.done=!0),_.adler=$.check=0,$.mode=TYPE;break;case DICTID:for(;ot<32;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}_.adler=$.check=zswap32(st),st=0,ot=0,$.mode=DICT;case DICT:if($.havedict===0)return _.next_out=rt,_.avail_out=it,_.next_in=tt,_.avail_in=nt,$.hold=st,$.bits=ot,Z_NEED_DICT$1;_.adler=$.check=1,$.mode=TYPE;case TYPE:if(o===Z_BLOCK||o===Z_TREES)break e;case TYPEDO:if($.last){st>>>=ot&7,ot-=ot&7,$.mode=CHECK;break}for(;ot<3;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}switch($.last=st&1,st>>>=1,ot-=1,st&3){case 0:$.mode=STORED;break;case 1:if(fixedtables($),$.mode=LEN_,o===Z_TREES){st>>>=2,ot-=2;break e}break;case 2:$.mode=TABLE;break;case 3:_.msg="invalid block type",$.mode=BAD}st>>>=2,ot-=2;break;case STORED:for(st>>>=ot&7,ot-=ot&7;ot<32;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if((st&65535)!==(st>>>16^65535)){_.msg="invalid stored block lengths",$.mode=BAD;break}if($.length=st&65535,st=0,ot=0,$.mode=COPY_,o===Z_TREES)break e;case COPY_:$.mode=COPY;case COPY:if(ut=$.length,ut){if(ut>nt&&(ut=nt),ut>it&&(ut=it),ut===0)break e;et.set(j.subarray(tt,tt+ut),rt),nt-=ut,tt+=ut,it-=ut,rt+=ut,$.length-=ut;break}$.mode=TYPE;break;case TABLE:for(;ot<14;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if($.nlen=(st&31)+257,st>>>=5,ot-=5,$.ndist=(st&31)+1,st>>>=5,ot-=5,$.ncode=(st&15)+4,st>>>=4,ot-=4,$.nlen>286||$.ndist>30){_.msg="too many length or distance symbols",$.mode=BAD;break}$.have=0,$.mode=LENLENS;case LENLENS:for(;$.have<$.ncode;){for(;ot<3;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}$.lens[It[$.have++]]=st&7,st>>>=3,ot-=3}for(;$.have<19;)$.lens[It[$.have++]]=0;if($.lencode=$.lendyn,$.lenbits=7,jt={bits:$.lenbits},Dt=inftrees(CODES,$.lens,0,19,$.lencode,0,$.work,jt),$.lenbits=jt.bits,Dt){_.msg="invalid code lengths set",$.mode=BAD;break}$.have=0,$.mode=CODELENS;case CODELENS:for(;$.have<$.nlen+$.ndist;){for(;mt=$.lencode[st&(1<<$.lenbits)-1],gt=mt>>>24,Et=mt>>>16&255,St=mt&65535,!(gt<=ot);){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if(St<16)st>>>=gt,ot-=gt,$.lens[$.have++]=St;else{if(St===16){for(Nt=gt+2;ot<Nt;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if(st>>>=gt,ot-=gt,$.have===0){_.msg="invalid bit length repeat",$.mode=BAD;break}Tt=$.lens[$.have-1],ut=3+(st&3),st>>>=2,ot-=2}else if(St===17){for(Nt=gt+3;ot<Nt;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}st>>>=gt,ot-=gt,Tt=0,ut=3+(st&7),st>>>=3,ot-=3}else{for(Nt=gt+7;ot<Nt;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}st>>>=gt,ot-=gt,Tt=0,ut=11+(st&127),st>>>=7,ot-=7}if($.have+ut>$.nlen+$.ndist){_.msg="invalid bit length repeat",$.mode=BAD;break}for(;ut--;)$.lens[$.have++]=Tt}}if($.mode===BAD)break;if($.lens[256]===0){_.msg="invalid code -- missing end-of-block",$.mode=BAD;break}if($.lenbits=9,jt={bits:$.lenbits},Dt=inftrees(LENS,$.lens,0,$.nlen,$.lencode,0,$.work,jt),$.lenbits=jt.bits,Dt){_.msg="invalid literal/lengths set",$.mode=BAD;break}if($.distbits=6,$.distcode=$.distdyn,jt={bits:$.distbits},Dt=inftrees(DISTS,$.lens,$.nlen,$.ndist,$.distcode,0,$.work,jt),$.distbits=jt.bits,Dt){_.msg="invalid distances set",$.mode=BAD;break}if($.mode=LEN_,o===Z_TREES)break e;case LEN_:$.mode=LEN;case LEN:if(nt>=6&&it>=258){_.next_out=rt,_.avail_out=it,_.next_in=tt,_.avail_in=nt,$.hold=st,$.bits=ot,inffast(_,ct),rt=_.next_out,et=_.output,it=_.avail_out,tt=_.next_in,j=_.input,nt=_.avail_in,st=$.hold,ot=$.bits,$.mode===TYPE&&($.back=-1);break}for($.back=0;mt=$.lencode[st&(1<<$.lenbits)-1],gt=mt>>>24,Et=mt>>>16&255,St=mt&65535,!(gt<=ot);){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if(Et&&!(Et&240)){for(At=gt,kt=Et,Rt=St;mt=$.lencode[Rt+((st&(1<<At+kt)-1)>>At)],gt=mt>>>24,Et=mt>>>16&255,St=mt&65535,!(At+gt<=ot);){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}st>>>=At,ot-=At,$.back+=At}if(st>>>=gt,ot-=gt,$.back+=gt,$.length=St,Et===0){$.mode=LIT;break}if(Et&32){$.back=-1,$.mode=TYPE;break}if(Et&64){_.msg="invalid literal/length code",$.mode=BAD;break}$.extra=Et&15,$.mode=LENEXT;case LENEXT:if($.extra){for(Nt=$.extra;ot<Nt;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}$.length+=st&(1<<$.extra)-1,st>>>=$.extra,ot-=$.extra,$.back+=$.extra}$.was=$.length,$.mode=DIST;case DIST:for(;mt=$.distcode[st&(1<<$.distbits)-1],gt=mt>>>24,Et=mt>>>16&255,St=mt&65535,!(gt<=ot);){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if(!(Et&240)){for(At=gt,kt=Et,Rt=St;mt=$.distcode[Rt+((st&(1<<At+kt)-1)>>At)],gt=mt>>>24,Et=mt>>>16&255,St=mt&65535,!(At+gt<=ot);){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}st>>>=At,ot-=At,$.back+=At}if(st>>>=gt,ot-=gt,$.back+=gt,Et&64){_.msg="invalid distance code",$.mode=BAD;break}$.offset=St,$.extra=Et&15,$.mode=DISTEXT;case DISTEXT:if($.extra){for(Nt=$.extra;ot<Nt;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}$.offset+=st&(1<<$.extra)-1,st>>>=$.extra,ot-=$.extra,$.back+=$.extra}if($.offset>$.dmax){_.msg="invalid distance too far back",$.mode=BAD;break}$.mode=MATCH;case MATCH:if(it===0)break e;if(ut=ct-it,$.offset>ut){if(ut=$.offset-ut,ut>$.whave&&$.sane){_.msg="invalid distance too far back",$.mode=BAD;break}ut>$.wnext?(ut-=$.wnext,ft=$.wsize-ut):ft=$.wnext-ut,ut>$.length&&(ut=$.length),ht=$.window}else ht=et,ft=rt-$.offset,ut=$.length;ut>it&&(ut=it),it-=ut,$.length-=ut;do et[rt++]=ht[ft++];while(--ut);$.length===0&&($.mode=LEN);break;case LIT:if(it===0)break e;et[rt++]=$.length,it--,$.mode=LEN;break;case CHECK:if($.wrap){for(;ot<32;){if(nt===0)break e;nt--,st|=j[tt++]<<ot,ot+=8}if(ct-=it,_.total_out+=ct,$.total+=ct,$.wrap&4&&ct&&(_.adler=$.check=$.flags?crc32_1($.check,et,ct,rt-ct):adler32_1($.check,et,ct,rt-ct)),ct=it,$.wrap&4&&($.flags?st:zswap32(st))!==$.check){_.msg="incorrect data check",$.mode=BAD;break}st=0,ot=0}$.mode=LENGTH;case LENGTH:if($.wrap&&$.flags){for(;ot<32;){if(nt===0)break e;nt--,st+=j[tt++]<<ot,ot+=8}if($.wrap&4&&st!==($.total&4294967295)){_.msg="incorrect length check",$.mode=BAD;break}st=0,ot=0}$.mode=DONE;case DONE:Dt=Z_STREAM_END$1;break e;case BAD:Dt=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return _.next_out=rt,_.avail_out=it,_.next_in=tt,_.avail_in=nt,$.hold=st,$.bits=ot,($.wsize||ct!==_.avail_out&&$.mode<BAD&&($.mode<CHECK||o!==Z_FINISH$1))&&updatewindow(_,_.output,_.next_out,ct-_.avail_out),at-=_.avail_in,ct-=_.avail_out,_.total_in+=at,_.total_out+=ct,$.total+=ct,$.wrap&4&&ct&&(_.adler=$.check=$.flags?crc32_1($.check,et,ct,_.next_out-ct):adler32_1($.check,et,ct,_.next_out-ct)),_.data_type=$.bits+($.last?64:0)+($.mode===TYPE?128:0)+($.mode===LEN_||$.mode===COPY_?256:0),(at===0&&ct===0||o===Z_FINISH$1)&&Dt===Z_OK$1&&(Dt=Z_BUF_ERROR),Dt},inflateEnd=_=>{if(inflateStateCheck(_))return Z_STREAM_ERROR$1;let o=_.state;return o.window&&(o.window=null),_.state=null,Z_OK$1},inflateGetHeader=(_,o)=>{if(inflateStateCheck(_))return Z_STREAM_ERROR$1;const $=_.state;return $.wrap&2?($.head=o,o.done=!1,Z_OK$1):Z_STREAM_ERROR$1},inflateSetDictionary=(_,o)=>{const $=o.length;let j,et,tt;return inflateStateCheck(_)||(j=_.state,j.wrap!==0&&j.mode!==DICT)?Z_STREAM_ERROR$1:j.mode===DICT&&(et=1,et=adler32_1(et,o,$,0),et!==j.check)?Z_DATA_ERROR$1:(tt=updatewindow(_,o,$,$),tt?(j.mode=MEM,Z_MEM_ERROR$1):(j.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString$3=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(_){this.options=common.assign({chunkSize:1024*64,windowBits:15,to:""},_||{});const o=this.options;o.raw&&o.windowBits>=0&&o.windowBits<16&&(o.windowBits=-o.windowBits,o.windowBits===0&&(o.windowBits=-15)),o.windowBits>=0&&o.windowBits<16&&!(_&&_.windowBits)&&(o.windowBits+=32),o.windowBits>15&&o.windowBits<48&&(o.windowBits&15||(o.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let $=inflate_1$2.inflateInit2(this.strm,o.windowBits);if($!==Z_OK)throw new Error(messages$1[$]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),o.dictionary&&(typeof o.dictionary=="string"?o.dictionary=strings.string2buf(o.dictionary):toString$3.call(o.dictionary)==="[object ArrayBuffer]"&&(o.dictionary=new Uint8Array(o.dictionary)),o.raw&&($=inflate_1$2.inflateSetDictionary(this.strm,o.dictionary),$!==Z_OK)))throw new Error(messages$1[$])}Inflate$1.prototype.push=function(_,o){const $=this.strm,j=this.options.chunkSize,et=this.options.dictionary;let tt,rt,nt;if(this.ended)return!1;for(o===~~o?rt=o:rt=o===!0?Z_FINISH:Z_NO_FLUSH,toString$3.call(_)==="[object ArrayBuffer]"?$.input=new Uint8Array(_):$.input=_,$.next_in=0,$.avail_in=$.input.length;;){for($.avail_out===0&&($.output=new Uint8Array(j),$.next_out=0,$.avail_out=j),tt=inflate_1$2.inflate($,rt),tt===Z_NEED_DICT&&et&&(tt=inflate_1$2.inflateSetDictionary($,et),tt===Z_OK?tt=inflate_1$2.inflate($,rt):tt===Z_DATA_ERROR&&(tt=Z_NEED_DICT));$.avail_in>0&&tt===Z_STREAM_END&&$.state.wrap>0&&_[$.next_in]!==0;)inflate_1$2.inflateReset($),tt=inflate_1$2.inflate($,rt);switch(tt){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(tt),this.ended=!0,!1}if(nt=$.avail_out,$.next_out&&($.avail_out===0||tt===Z_STREAM_END))if(this.options.to==="string"){let it=strings.utf8border($.output,$.next_out),st=$.next_out-it,ot=strings.buf2string($.output,it);$.next_out=st,$.avail_out=j-st,st&&$.output.set($.output.subarray(it,it+st),0),this.onData(ot)}else this.onData($.output.length===$.next_out?$.output:$.output.subarray(0,$.next_out));if(!(tt===Z_OK&&nt===0)){if(tt===Z_STREAM_END)return tt=inflate_1$2.inflateEnd(this.strm),this.onEnd(tt),this.ended=!0,!0;if($.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(_){this.chunks.push(_)};Inflate$1.prototype.onEnd=function(_){_===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function inflate$1(_,o){const $=new Inflate$1(o);if($.push(_),$.err)throw $.msg||messages$1[$.err];return $.result}function inflateRaw$1(_,o){return o=o||{},o.raw=!0,inflate$1(_,o)}var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2,inflateRaw:inflateRaw_1$1,ungzip:ungzip$1,constants};const{Deflate,deflate,deflateRaw,gzip}=deflate_1$1,{Inflate,inflate,inflateRaw,ungzip}=inflate_1$1;var Deflate_1=Deflate,deflate_1=deflate,deflateRaw_1=deflateRaw,gzip_1=gzip,Inflate_1=Inflate,inflate_1=inflate,inflateRaw_1=inflateRaw,ungzip_1=ungzip,constants_1=constants$2,pako={Deflate:Deflate_1,deflate:deflate_1,deflateRaw:deflateRaw_1,gzip:gzip_1,Inflate:Inflate_1,inflate:inflate_1,inflateRaw:inflateRaw_1,ungzip:ungzip_1,constants:constants_1};const DEFAULT_COMPRESSION_LEVEL=6;function createGet$8({repo:_,preload:o}){async function*$(j,et={}){if(et.compressionLevel!=null&&(et.compressionLevel<-1||et.compressionLevel>9))throw errCode(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(et.preload!==!1){let nt;try{nt=normalizeCidPath(j).split("/")}catch(it){throw errCode(it,"ERR_INVALID_PATH")}o(CID$3.parse(nt[0]))}const tt=CID$3.asCID(j)||j,rt=await exporter(tt,_.blocks,et);if(rt.type==="file"||rt.type==="raw"){const nt=[];!et.compress||et.archive===!0?nt.push([{header:{name:rt.path,mode:rt.type==="file"&&rt.unixfs.mode,mtime:rt.type==="file"&&rt.unixfs.mtime?new Date(rt.unixfs.mtime.secs*1e3):void 0,size:rt.size,type:"file"},body:rt.content()}],pack()):nt.push(rt.content),et.compress&&nt.push(async function*(it){const st=await toBuffer(it);yield pako.gzip(st,{level:et.compressionLevel||DEFAULT_COMPRESSION_LEVEL})}),yield*pipe(...nt);return}if(rt.type==="directory"){const nt=[recursive(tt,_.blocks,et),async function*(it){for await(const st of it){const ot={header:{name:st.path,size:st.size}};if(st.type==="file")ot.header.type="file",ot.header.mode=st.unixfs.mode!=null?st.unixfs.mode:void 0,ot.header.mtime=st.unixfs.mtime?new Date(st.unixfs.mtime.secs*1e3):void 0,ot.body=st.content();else if(st.type==="raw")ot.header.type="file",ot.body=st.content();else if(st.type==="directory")ot.header.type="directory",ot.header.mode=st.unixfs.mode!=null?st.unixfs.mode:void 0,ot.header.mtime=st.unixfs.mtime?new Date(st.unixfs.mtime.secs*1e3):void 0;else throw errCode(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield ot}},pack()];if(et.compress){if(!et.archive)throw errCode(new Error("file is not regular"),"ERR_INVALID_PATH");et.compress&&nt.push(async function*(it){const st=await toBuffer(it);yield pako.gzip(st,{level:et.compressionLevel||DEFAULT_COMPRESSION_LEVEL})})}yield*pipe(...nt);return}throw errCode(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return withTimeoutOption($)}function createLs$8({repo:_,preload:o}){async function*$(j,et={}){const tt=normalizeCidPath(j),rt=tt.split("/");et.preload!==!1&&o(CID$3.parse(rt[0]));const nt=CID$3.asCID(tt)||tt,it=await exporter(nt,_.blocks,et);if(it.type==="file"){yield mapFile(it);return}if(it.type==="directory"){for await(const st of it.content())yield mapFile(st);return}throw errCode(new Error(`Unknown UnixFS type ${it.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return withTimeoutOption($)}class RootAPI{constructor({preload:o,repo:$,hashers:j,options:et}){const tt=createAddAll$2({preload:o,repo:$,options:et,hashers:j});this.addAll=tt,this.add=createAdd$5({addAll:tt}),this.cat=createCat$1({repo:$,preload:o}),this.get=createGet$8({repo:$,preload:o}),this.ls=createLs$8({repo:$,preload:o})}}const ipfsCore="0.18.0",commit="",interfaceIpfsCore="^0.158.0";function createVersion$3({repo:_}){async function o($={}){const j=await _.version.get();return{version:ipfsCore,commit,repo:`${j}`,"ipfs-core":ipfsCore,"interface-ipfs-core":interfaceIpfsCore}}return withTimeoutOption(o)}const log$1q=logger$1("ipfs:components:id");function createId$1({peerId:_,network:o}){async function $(j={}){const et=o.try();if(!et){if(j.peerId)throw new NotStartedError;if(_.publicKey==null)throw errCode(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:_,publicKey:toString$a(_.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${ipfsCore}`,protocolVersion:"9000",protocols:[]}}const{libp2p:tt}=et,rt=j.peerId?j.peerId:_,nt=await findPeer(rt,tt,j),it=toString$a(nt.metadata.get("AgentVersion")||new Uint8Array),st=toString$a(nt.metadata.get("ProtocolVersion")||new Uint8Array),ot=nt.id.toString(),at=nt.publicKey?toString$a(nt.publicKey,"base64pad"):"";return{id:rt,publicKey:at,addresses:(nt.addresses||[]).map(ct=>{const ut=ct.toString();return ut.endsWith(`/p2p/${ot}`)?ut:`${ut}/p2p/${ot}`}).sort().map(ct=>multiaddr$3(ct)),agentVersion:it,protocolVersion:st,protocols:(nt.protocols||[]).sort()}}return withTimeoutOption($)}async function findPeer(_,o,$){let j=await o.peerStore.get(_);j||(j=await findPeerOnDht(_,o,$));let et=_.publicKey?_.publicKey:await o.peerStore.keyBook.get(_);if(et==null)try{et=await o.getPublicKey(_,$)}catch(tt){log$1q.error("Could not load public key for",_.toString(),tt)}return{...j,publicKey:et,metadata:j.metadata||new Map,addresses:j.addresses.map(tt=>tt.multiaddr)}}async function findPeerOnDht(_,o,$){if(o.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(const et of o.dht.findPeer(_,$))if(et.name==="FINAL_PEER")break;const j=await o.peerStore.get(_);if(!j)throw errCode(new Error("Could not find peer"),"ERR_NOT_FOUND");return j}var objectSafeSet=set;function set(_,o,$){var j,et;if(Array.isArray(o)&&(j=o.slice(0)),typeof o=="string"&&(j=o.split(".")),typeof o=="symbol"&&(j=[o]),!Array.isArray(j))throw new Error("props arg must be an array, a string or a symbol");if(et=j.pop(),!et)return!1;prototypeCheck(et);for(var tt;tt=j.shift();)if(prototypeCheck(tt),typeof _[tt]>"u"&&(_[tt]={}),_=_[tt],!_||typeof _!="object")return!1;return _[et]=$,!0}function prototypeCheck(_){if(_=="__proto__"||_=="constructor"||_=="prototype")throw new Error("setting of prototype values not supported")}const profiles={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:_=>(objectSafeSet(_,"Discovery.MDNS.Enabled",!1),objectSafeSet(_,"Discovery.webRTCStar.Enabled",!1),_.Swarm={..._.Swarm||{},DisableNatPortMap:!0},_)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:_=>(objectSafeSet(_,"Discovery.MDNS.Enabled",!0),objectSafeSet(_,"Discovery.webRTCStar.Enabled",!0),objectSafeSet(_,"Swarm",{..._.Swarm||{},DisableNatPortMap:!1}),_)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:_=>{const o=getDefaultConfig();return objectSafeSet(_,"Addresses.API",o.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),objectSafeSet(_,"Addresses.Gateway",o.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),objectSafeSet(_,"Addresses.Swarm",o.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),objectSafeSet(_,"Addresses.Delegates",[]),objectSafeSet(_,"Bootstrap",[]),objectSafeSet(_,"Discovery.MDNS.Enabled",!1),objectSafeSet(_,"Discovery.webRTCStar.Enabled",!1),objectSafeSet(_,"Swarm",{..._.Swarm||{},DisableNatPortMap:!0}),_}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:_=>{const o=getDefaultConfig();return objectSafeSet(_,"Addresses.API",o.Addresses.API),objectSafeSet(_,"Addresses.Gateway",o.Addresses.Gateway),objectSafeSet(_,"Addresses.Swarm",o.Addresses.Swarm),objectSafeSet(_,"Addresses.Delegates",o.Addresses.Delegates),objectSafeSet(_,"Bootstrap",o.Bootstrap),objectSafeSet(_,"Discovery.MDNS.Enabled",o.Discovery.MDNS.Enabled),objectSafeSet(_,"Discovery.webRTCStar.Enabled",o.Discovery.webRTCStar.Enabled),objectSafeSet(_,"Swarm",{..._.Swarm||{},DisableNatPortMap:!1}),_}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:_=>{const o=_.Swarm||{},$=o.ConnMgr||{};return $.LowWater=20,$.HighWater=40,o.ConnMgr=$,_.Swarm=o,_}},"default-power":{description:'Inverse of "lowpower" profile.',transform:_=>{const o=getDefaultConfig();return _.Swarm=o.Swarm,_}}},log$1p=logger$1("ipfs:core:config");function createConfig$1({repo:_}){return{getAll:withTimeoutOption(o),get:withTimeoutOption($),set:withTimeoutOption(j),replace:withTimeoutOption(et),profiles:{apply:withTimeoutOption(tt),list:withTimeoutOption(listProfiles)}};async function o(rt={}){return _.config.getAll(rt)}async function $(rt,nt){return rt?_.config.get(rt,nt):Promise.reject(new Error("key argument is required"))}async function j(rt,nt,it){return _.config.set(rt,nt,it)}async function et(rt,nt){return _.config.replace(rt,nt)}async function tt(rt,nt={dryRun:!1}){const{dryRun:it}=nt,st=profiles[rt];if(!st)throw new Error(`No profile with name '${rt}' exists`);try{const ot=await _.config.getAll(nt);let at=JSON.parse(JSON.stringify(ot));return at=st.transform(at),it||await _.config.replace(at,nt),delete ot.Identity.PrivKey,delete at.Identity.PrivKey,{original:ot,updated:at}}catch(ot){throw log$1p(ot),new Error(`Could not apply profile '${rt}' to config: ${ot.message}`)}}}async function listProfiles(_){return Object.keys(profiles).map(o=>({name:o,description:profiles[o].description}))}function createHeader(_){const o=encode$z({version:1,roots:_}),$=varint$2.encode(o.length),j=new Uint8Array($.length+o.length);return j.set($,0),j.set(o,$.length),j}function createEncoder(_){return{async setRoots(o){const $=createHeader(o);await _.write($)},async writeBlock(o){const{cid:$,bytes:j}=o;await _.write(new Uint8Array(varint$2.encode($.bytes.length+j.length))),await _.write($.bytes),j.length&&await _.write(j)},async close(){await _.end()}}}function noop$4(){}function create$3(){const _=[];let o=null,$=noop$4,j=!1,et=null,tt=noop$4;const rt=()=>(o||(o=new Promise(st=>{$=()=>{o=null,$=noop$4,st()}})),o),nt={write(st){_.push(st);const ot=rt();return tt(),ot},async end(){j=!0;const st=rt();tt(),await st}},it={async next(){const st=_.shift();return st?(_.length===0&&$(),{done:!1,value:st}):j?($(),{done:!0,value:void 0}):(et||(et=new Promise(ot=>{tt=()=>(et=null,tt=noop$4,ot(it.next()))})),et)}};return{writer:nt,iterator:it}}const Kinds={Null:_=>_===null,Int:_=>Number.isInteger(_),Float:_=>typeof _=="number"&&Number.isFinite(_),String:_=>typeof _=="string",Bool:_=>typeof _=="boolean",Bytes:_=>_ instanceof Uint8Array,Link:_=>!Kinds.Null(_)&&typeof _=="object"&&_.asCID===_,List:_=>Array.isArray(_),Map:_=>!Kinds.Null(_)&&typeof _=="object"&&_.asCID!==_&&!Kinds.List(_)&&!Kinds.Bytes(_)},Types={Int:Kinds.Int,"CarHeader > version":_=>Types.Int(_),"CarHeader > roots (anon) > valueType (anon)":Kinds.Link,"CarHeader > roots (anon)":_=>Kinds.List(_)&&Array.prototype.every.call(_,Types["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":_=>Types["CarHeader > roots (anon)"](_),CarHeader:_=>{const o=_&&Object.keys(_);return Kinds.Map(_)&&["version"].every($=>o.includes($))&&Object.entries(_).every(([$,j])=>Types["CarHeader > "+$]&&Types["CarHeader > "+$](j))}},CarHeader=Types.CarHeader,CIDV0_BYTES={SHA2_256:18,LENGTH:32,DAG_PB:112},V2_HEADER_LENGTH=16+8+8+8;function decodeVarint(_,o){if(!_.length)throw new Error("Unexpected end of data");const $=varint$2.decode(_);return o.seek(varint$2.decode.bytes),$}function decodeV2Header(_){const o=new DataView(_.buffer,_.byteOffset,_.byteLength);let $=0;return{version:2,characteristics:[o.getBigUint64($,!0),o.getBigUint64($+=8,!0)],dataOffset:Number(o.getBigUint64($+=8,!0)),dataSize:Number(o.getBigUint64($+=8,!0)),indexOffset:Number(o.getBigUint64($+=8,!0))}}function getMultihashLength(_){varint$2.decode(_);const o=varint$2.decode.bytes,$=varint$2.decode(_.subarray(varint$2.decode.bytes)),j=varint$2.decode.bytes;return o+j+$}async function readHeader$1(_,o){const $=decodeVarint(await _.upTo(8),_);if($===0)throw new Error("Invalid CAR header (zero length)");const j=await _.exactly($,!0),et=decode$w(j);if(!CarHeader(et))throw new Error("Invalid CAR header format");if(et.version!==1&&et.version!==2||o!==void 0&&et.version!==o)throw new Error(`Invalid CAR version: ${et.version}${o!==void 0?` (expected ${o})`:""}`);const tt=Array.isArray(et.roots);if(et.version===1&&!tt||et.version===2&&tt)throw new Error("Invalid CAR header format");if(et.version===1)return et;const rt=decodeV2Header(await _.exactly(V2_HEADER_LENGTH,!0));_.seek(rt.dataOffset-_.pos);const nt=await readHeader$1(_,1);return Object.assign(nt,rt)}async function readCid(_){const o=await _.exactly(2,!1);if(o[0]===CIDV0_BYTES.SHA2_256&&o[1]===CIDV0_BYTES.LENGTH){const rt=await _.exactly(34,!0),nt=decode$B(rt);return CID$3.create(0,CIDV0_BYTES.DAG_PB,nt)}const $=decodeVarint(await _.upTo(8),_);if($!==1)throw new Error(`Unexpected CID version (${$})`);const j=decodeVarint(await _.upTo(8),_),et=await _.exactly(getMultihashLength(await _.upTo(8)),!0),tt=decode$B(et);return CID$3.create($,j,tt)}async function readBlockHead(_){const o=_.pos;let $=decodeVarint(await _.upTo(8),_);if($===0)throw new Error("Invalid CAR section (zero length)");$+=_.pos-o;const j=await readCid(_),et=$-Number(_.pos-o);return{cid:j,length:$,blockLength:et}}async function readBlock(_){const{cid:o,blockLength:$}=await readBlockHead(_);return{bytes:await _.exactly($,!0),cid:o}}async function readBlockIndex(_){const o=_.pos,{cid:$,length:j,blockLength:et}=await readBlockHead(_),tt={cid:$,length:j,blockLength:et,offset:o,blockOffset:_.pos};return _.seek(tt.blockLength),tt}function createDecoder(_){const o=(async()=>{const $=await readHeader$1(_);if($.version===2){const j=_.pos-$.dataOffset;_=limitReader(_,$.dataSize-j)}return $})();return{header:()=>o,async*blocks(){for(await o;(await _.upTo(8)).length>0;)yield await readBlock(_)},async*blocksIndex(){for(await o;(await _.upTo(8)).length>0;)yield await readBlockIndex(_)}}}function bytesReader(_){let o=0;return{async upTo($){return _.subarray(o,o+Math.min($,_.length-o))},async exactly($,j=!1){if($>_.length-o)throw new Error("Unexpected end of data");const et=_.subarray(o,o+$);return j&&(o+=$),et},seek($){o+=$},get pos(){return o}}}function chunkReader(_){let o=0,$=0,j=0,et=new Uint8Array(0);const tt=async rt=>{$=et.length-j;const nt=[et.subarray(j)];for(;$<rt;){const st=await _();if(st==null)break;$<0?st.length>$&&nt.push(st.subarray(-$)):nt.push(st),$+=st.length}et=new Uint8Array(nt.reduce((st,ot)=>st+ot.length,0));let it=0;for(const st of nt)et.set(st,it),it+=st.length;j=0};return{async upTo(rt){return et.length-j<rt&&await tt(rt),et.subarray(j,j+Math.min(et.length-j,rt))},async exactly(rt,nt=!1){if(et.length-j<rt&&await tt(rt),et.length-j<rt)throw new Error("Unexpected end of data");const it=et.subarray(j,j+rt);return nt&&(o+=rt,j+=rt),it},seek(rt){o+=rt,j+=rt},get pos(){return o}}}function asyncIterableReader(_){const o=_[Symbol.asyncIterator]();async function $(){const j=await o.next();return j.done?null:j.value}return chunkReader($)}function limitReader(_,o){let $=0;return{async upTo(j){let et=await _.upTo(j);return et.length+$>o&&(et=et.subarray(0,o-$)),et},async exactly(j,et=!1){const tt=await _.exactly(j,et);if(tt.length+$>o)throw new Error("Unexpected end of data");return et&&($+=j),tt},seek(j){$+=j,_.seek(j)},get pos(){return _.pos}}}class CarWriter{constructor(o,$){this._encoder=$,this._mutex=$.setRoots(o),this._ended=!1}async put(o){if(!(o.bytes instanceof Uint8Array)||!o.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");const $=CID$3.asCID(o.cid);if(!$)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:$,bytes:o.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(o){o=toRoots(o);const{encoder:$,iterator:j}=encodeWriter(),et=new CarWriter(o,$),tt=new CarWriterOut(j);return{writer:et,out:tt}}static createAppender(){const{encoder:o,iterator:$}=encodeWriter();o.setRoots=()=>Promise.resolve();const j=new CarWriter([],o),et=new CarWriterOut($);return{writer:j,out:et}}static async updateRootsInBytes(o,$){const j=bytesReader(o);await readHeader$1(j);const et=createHeader($);if(Number(j.pos)!==et.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${j.pos} bytes, new header is ${et.length} bytes)`);return o.set(et,0),o}}class CarWriterOut{constructor(o){this._iterator=o}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function encodeWriter(){const _=create$3(),{writer:o,iterator:$}=_;return{encoder:createEncoder(o),iterator:$}}function toRoots(_){if(_===void 0)return[];if(!Array.isArray(_)){const $=CID$3.asCID(_);if(!$)throw new TypeError("roots must be a single CID or an array of CIDs");return[$]}const o=[];for(const $ of _){const j=CID$3.asCID($);if(!j)throw new TypeError("roots must be a single CID or an array of CIDs");o.push(j)}return o}const walk=async({cid:_,load:o,seen:$})=>{$=$||new Set;const j=_.toString(base58btc$4);if($.has(j))return;const et=await o(_);if($.add(j),et!==null)for(const[,tt]of et.links())await walk({cid:tt,load:o,seen:$})},log$1o=logger$1("ipfs:components:dag:import"),NO_LINKS_CODECS=[code$6,code$5];function createExport$3({repo:_,preload:o,codecs:$}){async function*j(et,tt={}){tt.preload!==!1&&o(et);const rt=CID$3.asCID(et);if(!rt)throw new Error(`Unexpected error converting CID type: ${et}`);log$1o(`Exporting ${rt} as car`);const{writer:nt,out:it}=await CarWriter.create([rt]);let st=null;(async()=>{try{const ot=makeLoader(_,nt,{signal:tt.signal,timeout:tt.timeout},$);await walk({cid:rt,load:ot})}catch(ot){st=ot}finally{nt.close()}})();for await(const ot of it){if(st)break;yield ot}if(st)throw st}return withTimeoutOption(j)}function makeLoader(_,o,$,j){return async et=>{const tt=await j.getCodec(et.code);if(!tt)throw new Error(`Can't decode links in block with codec 0x${et.code.toString(16)} to form complete DAG`);const rt=await _.blocks.get(et,$);return log$1o(`Adding block ${et} to car`),await o.put({cid:et,bytes:rt}),NO_LINKS_CODECS.includes(et.code)?null:createUnsafe({bytes:rt,cid:et,codec:tt})}}async function first(_){for await(const o of _)return o}function createGet$7({codecs:_,repo:o,preload:$}){return withTimeoutOption(async function(tt,rt={}){if(rt.preload!==!1&&$(tt),rt.path){const at=rt.localResolve?await first(resolve$5(tt,rt.path,_,o,rt)):await last(resolve$5(tt,rt.path,_,o,rt));if(!at)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return at}const nt=await _.getCodec(tt.code),it=await o.blocks.get(tt,rt);return{value:nt.decode(it),remainderPath:""}})}class CarIteratorBase{constructor(o,$,j){this._version=o,this._roots=$,this._iterable=j,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class CarBlockIterator extends CarIteratorBase{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(o){const{version:$,roots:j,iterator:et}=await fromBytes$2(o);return new CarBlockIterator($,j,et)}static async fromIterable(o){const{version:$,roots:j,iterator:et}=await fromIterable(o);return new CarBlockIterator($,j,et)}}async function fromBytes$2(_){if(!(_ instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return decodeIterator(bytesReader(_))}async function fromIterable(_){if(!_||typeof _[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return decodeIterator(asyncIterableReader(_))}async function decodeIterator(_){const o=createDecoder(_),{version:$,roots:j}=await o.header();return{version:$,roots:j,iterator:o.blocks()}}const log$1n=logger$1("ipfs:components:dag:import");function createImport$3({repo:_}){async function*o($,j={}){const et=await _.gcLock.readLock();try{const tt={signal:j.signal,timeout:j.timeout},rt=peekableIterator($),{value:nt,done:it}=await rt.peek();if(it)return;nt&&rt.push(nt);let st;nt instanceof Uint8Array?st=[rt]:st=rt;for await(const ot of st){const at=await importCar(_,tt,ot);if(j.pinRoots!==!1)for(const ct of at){let ut="";try{await _.blocks.has(ct)?(log$1n(`Pinning root ${ct}`),await _.pins.pinRecursively(ct)):ut="blockstore: block not found"}catch(ft){ut=ft.message}yield{root:{cid:ct,pinErrorMsg:ut}}}}}finally{et()}}return withTimeoutOption(o)}async function importCar(_,o,$){const j=await CarBlockIterator.fromIterable($),et=await j.getRoots();return await drain(_.blocks.putMany(map$3(j,({cid:tt,bytes:rt})=>(log$1n(`Import block ${tt}`),{key:tt,value:rt})),{signal:o.signal})),et}function createPut$5({repo:_,codecs:o,hashers:$,preload:j}){async function et(tt,rt={}){const nt=rt.pin?await _.gcLock.readLock():null;try{const it=await o.getCodec(rt.storeCodec||"dag-cbor");if(!it)throw new Error(`Unknown storeCodec ${rt.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(rt.inputCodec){if(!(tt instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");const ft=await o.getCodec(rt.inputCodec);if(!ft)throw new Error(`Unknown inputCodec ${rt.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);tt=ft.decode(tt)}const st=rt.version!=null?rt.version:1,ot=await $.getHasher(rt.hashAlg||"sha2-256");if(!ot)throw new Error(`Unknown hash algorithm ${rt.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);const at=it.encode(tt),ct=await ot.digest(at),ut=CID$3.create(st,it.code,ct);return await _.blocks.put(ut,at,{signal:rt.signal}),rt.pin&&await _.pins.pinRecursively(ut),rt.preload!==!1&&j(ut),ut}finally{nt&&nt()}}return withTimeoutOption(et)}function createResolve$3({repo:_,codecs:o,preload:$}){async function j(et,tt={}){const{cid:rt}=toCidAndPath(et);return tt.preload!==!1&&$(rt),resolvePath$1(_,o,et,tt)}return withTimeoutOption(j)}class DagAPI{constructor({repo:o,codecs:$,hashers:j,preload:et}){this.export=createExport$3({repo:o,preload:et,codecs:$}),this.get=createGet$7({codecs:$,repo:o,preload:et}),this.import=createImport$3({repo:o}),this.resolve=createResolve$3({repo:o,codecs:$,preload:et}),this.put=createPut$5({repo:o,codecs:$,hashers:j,preload:et})}}const reduceValue=(_,o)=>o,tcpUri=(_,o,$,j)=>{if(j!=null&&j.assumeHttp===!1)return`tcp://${_}:${o}`;let et="tcp",tt=`:${o}`;return $[$.length-1].protocol==="tcp"&&(et=o==="443"?"https":"http",tt=o==="443"||o==="80"?"":tt),`${et}://${_}${tt}`},Reducers={ip4:reduceValue,ip6:(_,o,$,j)=>j.length===1&&j[0].protocol==="ip6"?o:`[${o}]`,tcp:(_,o,$,j,et)=>j.some(tt=>["http","https","ws","wss"].includes(tt.protocol))?`${_}:${o}`:tcpUri(_,o,j,et),udp:(_,o)=>`udp://${_}:${o}`,dnsaddr:reduceValue,dns4:reduceValue,dns6:reduceValue,ipfs:(_,o)=>`${_}/ipfs/${o}`,p2p:(_,o)=>`${_}/p2p/${o}`,http:_=>`http://${_}`,https:_=>`https://${_}`,ws:_=>`ws://${_}`,wss:_=>`wss://${_}`,"p2p-websocket-star":_=>`${_}/p2p-websocket-star`,"p2p-webrtc-star":_=>`${_}/p2p-webrtc-star`,"p2p-webrtc-direct":_=>`${_}/p2p-webrtc-direct`};function multiaddrToUri(_,o){const $=multiaddr$3(_),j=$.toString().split("/").slice(1);return $.tuples().map(et=>({protocol:j.shift()??"",content:et[1]!=null?j.shift()??"":""})).reduce((et,tt,rt,nt)=>{const it=Reducers[tt.protocol];if(it==null)throw new Error(`Unsupported protocol ${tt.protocol}`);return it(et,tt.content,rt,nt,o)},"")}function arrayShuffle(_){if(!Array.isArray(_))throw new TypeError(`Expected an array, got ${typeof _}`);_=[..._];for(let o=_.length-1;o>0;o--){const $=Math.floor(Math.random()*(o+1));[_[o],_[$]]=[_[$],_[o]]}return _}const log$1m=logger$1("ipfs:preload"),Queue$2=PQueue.default?PQueue.default:PQueue,httpQueue=new Queue$2({concurrency:4});function preload(_,o={}){return log$1m(_),httpQueue.add(async()=>{const j=(await http.post(_,{signal:o.signal})).body.getReader();try{for(;;){const{done:et}=await j.read();if(et)return}}finally{j.releaseLock()}})}const log$1l=logger$1("ipfs:preload");function createPreloader(_={}){if(_.enabled=!!_.enabled,_.addresses=_.addresses||[],_.cache=_.cache||1e3,!_.enabled||!_.addresses.length)return log$1l("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let o=!0,$=[];const j=_.addresses.map(rt=>multiaddrToUri(rt)),et=hashlru(_.cache),tt=async rt=>{try{if(o)throw new Error(`preload ${rt} but preloader is not started`);const nt=rt.toString();if(et.has(nt))return;et.set(nt,!0);const it=arrayShuffle(j);let st=!1;const ot=Date.now();for(const at of it){if(o)throw new Error(`preload aborted for ${nt}`);let ct;try{ct=new AbortController,$=$.concat(ct),await preload(`${at}/api/v0/refs?r=true&arg=${encodeURIComponent(nt)}`,{signal:ct.signal}),st=!0}catch(ut){ut.type!=="aborted"&&log$1l.error(ut)}finally{$=$.filter(ut=>ut!==ct)}if(st)break}log$1l(`${st?"":"un"}successfully preloaded ${nt} in ${Date.now()-ot}ms`)}catch(nt){log$1l.error(nt)}};return tt.start=()=>{o=!1},tt.stop=()=>{o=!0,log$1l(`aborting ${$.length} pending preload request(s)`),$.forEach(rt=>rt.abort()),$=[]},tt}const log$1k=logger$1("ipfs:mfs-preload");function createMfsPreloader({preload:_,files:o,options:$={}}){if($.interval=$.interval||30*1e3,!$.enabled){log$1k("MFS preload disabled");const rt=async()=>{};return{start:rt,stop:rt}}let j="",et;const tt=async()=>{try{const rt=await o.stat("/"),nt=rt.cid.toString();j!==nt&&(log$1k(`preloading updated MFS root ${j} -> ${rt.cid}`),await _(rt.cid),j=nt)}catch(rt){log$1k.error("failed to preload MFS root",rt)}finally{et=setTimeout(tt,$.interval)}};return{async start(){const rt=await o.stat("/");j=rt.cid.toString(),log$1k(`monitoring MFS root ${rt.cid}`),et=setTimeout(tt,$.interval)},stop(){clearTimeout(et)}}}let TimeoutError$1=class extends Error{constructor(o){super(o),this.name="TimeoutError"}},AbortError$2=class extends Error{constructor(o){super(),this.name="AbortError",this.message=o}};const getDOMException$1=_=>globalThis.DOMException===void 0?new AbortError$2(_):new DOMException(_),getAbortedReason$1=_=>{const o=_.reason===void 0?getDOMException$1("This operation was aborted."):_.reason;return o instanceof Error?o:getDOMException$1(o)};function pTimeout$1(_,o){const{milliseconds:$,fallback:j,message:et,customTimers:tt={setTimeout,clearTimeout}}=o;let rt;const nt=new Promise((it,st)=>{if(typeof $!="number"||Math.sign($)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${$}\``);if($===Number.POSITIVE_INFINITY){it(_);return}if(o.signal){const{signal:at}=o;at.aborted&&st(getAbortedReason$1(at)),at.addEventListener("abort",()=>{st(getAbortedReason$1(at))})}const ot=new TimeoutError$1;rt=tt.setTimeout.call(void 0,()=>{if(j){try{it(j())}catch(at){st(at)}return}typeof _.cancel=="function"&&_.cancel(),et===!1?it():et instanceof Error?st(et):(ot.message=et??`Promise timed out after ${$} milliseconds`,st(ot))},$),(async()=>{try{it(await _)}catch(at){st(at)}finally{tt.clearTimeout.call(void 0,rt)}})()});return nt.clear=()=>{tt.clearTimeout.call(void 0,rt),rt=void 0},nt}const WORKER_REQUEST_READ_LOCK="lock:worker:request-read",WORKER_RELEASE_READ_LOCK="lock:worker:release-read",MASTER_GRANT_READ_LOCK="lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK="lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK="lock:worker:release-write",MASTER_GRANT_WRITE_LOCK="lock:master:grant-write",events={},observable=_=>{_.addEventListener("message",o=>{observable.dispatchEvent("message",_,o)}),_.port!=null&&_.port.addEventListener("message",o=>{observable.dispatchEvent("message",_,o)})};observable.addEventListener=(_,o)=>{events[_]==null&&(events[_]=[]),events[_].push(o)};observable.removeEventListener=(_,o)=>{events[_]!=null&&(events[_]=events[_].filter($=>$===o))};observable.dispatchEvent=function(_,o,$){events[_]!=null&&events[_].forEach(j=>j(o,$))};const handleWorkerLockRequest=(_,o,$,j,et)=>(tt,rt)=>{if(rt.data.type!==$)return;const nt={type:rt.data.type,name:rt.data.name,identifier:rt.data.identifier};_.dispatchEvent(new MessageEvent(o,{data:{name:nt.name,handler:async()=>(tt.postMessage({type:et,name:nt.name,identifier:nt.identifier}),await new Promise(it=>{const st=ot=>{if(ot==null||ot.data==null)return;const at={type:ot.data.type,name:ot.data.name,identifier:ot.data.identifier};at.type===j&&at.identifier===nt.identifier&&(tt.removeEventListener("message",st),it())};tt.addEventListener("message",st)}))}}))},makeWorkerLockRequest=(_,o,$,j)=>async()=>{const et=nanoid();return globalThis.postMessage({type:o,identifier:et,name:_}),await new Promise(tt=>{const rt=nt=>{if(nt==null||nt.data==null)return;const it={type:nt.data.type,identifier:nt.data.identifier};it.type===$&&it.identifier===et&&(globalThis.removeEventListener("message",rt),tt(()=>{globalThis.postMessage({type:j,identifier:et,name:_})}))};globalThis.addEventListener("message",rt)})},defaultOptions$k={singleProcess:!1},impl=_=>{if(_=Object.assign({},defaultOptions$k,_),!!globalThis.document||_.singleProcess){const $=new EventTarget;return observable.addEventListener("message",handleWorkerLockRequest($,"requestReadLock",WORKER_REQUEST_READ_LOCK,WORKER_RELEASE_READ_LOCK,MASTER_GRANT_READ_LOCK)),observable.addEventListener("message",handleWorkerLockRequest($,"requestWriteLock",WORKER_REQUEST_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK)),$}return{isWorker:!0,readLock:$=>makeWorkerLockRequest($,WORKER_REQUEST_READ_LOCK,MASTER_GRANT_READ_LOCK,WORKER_RELEASE_READ_LOCK),writeLock:$=>makeWorkerLockRequest($,WORKER_REQUEST_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK)}},mutexes={};let implementation;async function createReleaseable(_,o){let $;const j=new Promise(et=>{$=et});return _.add(async()=>await pTimeout$1((async()=>await new Promise(et=>{$(()=>{et()})}))(),{milliseconds:o.timeout})),await j}const createMutex=(_,o)=>{if(implementation.isWorker===!0)return{readLock:implementation.readLock(_,o),writeLock:implementation.writeLock(_,o)};const $=new PQueue({concurrency:1});let j;return{async readLock(){if(j!=null)return await createReleaseable(j,o);j=new PQueue({concurrency:o.concurrency,autoStart:!1});const et=j,tt=createReleaseable(j,o);return $.add(async()=>(et.start(),await et.onIdle().then(()=>{j===et&&(j=null)}))),await tt},async writeLock(){return j=null,await createReleaseable($,o)}}},defaultOptions$j={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function createMortice(_){const o=Object.assign({},defaultOptions$j,_);return implementation==null&&(implementation=impl(o),implementation.isWorker!==!0&&(implementation.addEventListener("requestReadLock",$=>{mutexes[$.data.name]!=null&&mutexes[$.data.name].readLock().then(async j=>await $.data.handler().finally(()=>j()))}),implementation.addEventListener("requestWriteLock",async $=>{mutexes[$.data.name]!=null&&mutexes[$.data.name].writeLock().then(async j=>await $.data.handler().finally(()=>j()))}))),mutexes[o.name]==null&&(mutexes[o.name]=createMutex(o.name,o)),mutexes[o.name]}let lock$1;function createLock(_=!1){if(lock$1)return lock$1;const o=createMortice({singleProcess:_});return lock$1={readLock:$=>async(...j)=>{const et=await o.readLock();try{return await $.apply(null,j)}finally{et()}},writeLock:$=>async(...j)=>{const et=await o.writeLock();try{return await $.apply(null,j)}finally{et()}}},lock$1}const log$1j=logger$1("ipfs:mfs:utils:with-mfs-root");async function loadMfsRoot(_,o){if(o&&o.signal&&o.signal.aborted)throw errCode(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await _.repo.datastore.open();let $;try{const j=await _.repo.datastore.get(MFS_ROOT_KEY$2);$=CID$3.decode(j)}catch(j){if(j.code!=="ERR_NOT_FOUND")throw j;log$1j("Creating new MFS root");const et=encode$B({Data:new UnixFS({type:"directory"}).marshal(),Links:[]}),tt=await sha256$8.digest(et);if($=CID$3.createV0(tt),await _.repo.blocks.put($,et),o&&o.signal&&o.signal.aborted)throw errCode(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await _.repo.datastore.put(MFS_ROOT_KEY$2,$.bytes)}return log$1j(`Loaded MFS root /ipfs/${$}`),$}function toPathComponents(_=""){return(_.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}const IPFS_PREFIX="ipfs",toMfsPath=async(_,o,$)=>{const j=await loadMfsRoot(_,$);let et={entryType:"file"},tt="";if(CID$3.asCID(o)?tt=`/ipfs/${o}`:tt=o.toString(),tt=tt.trim(),tt=tt.replace(/(\/\/+)/g,"/"),tt.endsWith("/")&&tt.length>1&&(tt=tt.substring(0,tt.length-1)),!tt)throw errCode(new Error("paths must not be empty"),"ERR_NO_PATH");if(tt.substring(0,1)!=="/")throw errCode(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");tt.substring(tt.length-1)==="/"&&(tt=tt.substring(0,tt.length-1));const rt=toPathComponents(tt);if(rt[0]===IPFS_PREFIX){let it;rt.length===2?it=`/${rt.join("/")}`:it=`/${rt.slice(0,rt.length-1).join("/")}`,et={type:"ipfs",depth:rt.length-2,entryType:"file",mfsPath:`/${rt.join("/")}`,mfsDirectory:it,parts:rt,path:`/${rt.join("/")}`,name:rt[rt.length-1]}}else{const it=`/${IPFS_PREFIX}/${j}${rt.length?"/"+rt.join("/"):""}`,st=`/${IPFS_PREFIX}/${j}/${rt.slice(0,rt.length-1).join("/")}`;et={type:"mfs",depth:rt.length,entryType:"file",mfsDirectory:st,mfsPath:it,parts:rt,path:`/${rt.join("/")}`,name:rt[rt.length-1]}}const nt=et.type==="mfs"?et.mfsPath:et.path;try{const it=await exporter(nt,_.repo.blocks,$);et.cid=it.cid,et.mfsPath=`/ipfs/${it.path}`,et.entryType=it.type,et.content=it.content,(et.entryType==="file"||et.entryType==="directory")&&(it.type==="file"||it.type==="directory")&&(et.unixfs=it.unixfs)}catch(it){if(it.code!=="ERR_NOT_FOUND")throw it}return et.exists=!!et.cid,et},mergeOptions$c=mergeOptions$g.bind({ignoreUndefined:!0}),log$1i=logger$1("ipfs:mfs:stat"),defaultOptions$i={withLocal:!1};function createStat$7(_){async function o($,j={}){j=mergeOptions$c(defaultOptions$i,j),log$1i(`Fetching stats for ${$}`);const{type:et,cid:tt,mfsPath:rt}=await toMfsPath(_,$,j),nt=et==="ipfs"&&tt?tt:rt;let it;try{it=await exporter(nt,_.repo.blocks)}catch(st){throw st.code==="ERR_NOT_FOUND"?errCode(new Error(`${$} does not exist`),"ERR_NOT_FOUND"):st}if(!statters[it.type])throw new Error(`Cannot stat codec ${it.cid.code}`);return statters[it.type](it)}return withTimeoutOption(o)}const statters={raw:_=>({cid:_.cid,size:_.node.length,cumulativeSize:_.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:_=>{const o={cid:_.cid,type:"file",size:_.unixfs.fileSize(),cumulativeSize:encode$B(_.node).length+(_.node.Links||[]).reduce(($,j)=>$+(j.Tsize||0),0),blocks:_.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:_.unixfs.mode};return _.unixfs.mtime&&(o.mtime=_.unixfs.mtime),o},directory:_=>{const o={cid:_.cid,type:"directory",size:0,cumulativeSize:encode$B(_.node).length+(_.node.Links||[]).reduce(($,j)=>$+(j.Tsize||0),0),blocks:_.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:_.unixfs.mode};return _.unixfs.mtime&&(o.mtime=_.unixfs.mtime),o},object:_=>({cid:_.cid,size:_.node.length,cumulativeSize:_.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:_=>({cid:_.cid,size:_.node.length,cumulativeSize:_.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})},log$1h=logger$1("ipfs:mfs:utils:to-trail");async function toTrail(_,o){log$1h(`Creating trail for path ${o}`);const $=[];for await(const j of walkPath(o,_.repo.blocks))$.push({name:j.name,cid:j.cid,size:j.size,type:j.type});return $}const persist=async(_,o,$)=>{$.codec||($.codec=dagPB),$.hasher||($.hasher=sha256$8),$.cidVersion===void 0&&($.cidVersion=1),$.codec===dagPB&&$.hasher!==sha256$8&&($.cidVersion=1);const j=await $.hasher.digest(_),et=CID$3.create($.cidVersion,$.codec.code,j);return $.onlyHash||await o.put(et,_,{signal:$.signal}),et},hamtHashCode=murmur3128.code,hamtBucketBits=8;async function hamtHashFn(_){return(await murmur3128.encode(_)).subarray(0,8).reverse()}class Dir{constructor(o,$){this.options=$||{},this.root=o.root,this.dir=o.dir,this.path=o.path,this.dirty=o.dirty,this.flat=o.flat,this.parent=o.parent,this.parentKey=o.parentKey,this.unixfs=o.unixfs,this.mode=o.mode,this.mtime=o.mtime,this.cid=void 0,this.size=void 0}async put(o,$){}get(o){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(o){}}class DirSharded extends Dir{constructor(o,$){super(o,$),this._bucket=createHAMT({hashFn:hamtHashFn,bits:hamtBucketBits})}async put(o,$){await this._bucket.put(o,$)}get(o){return this._bucket.get(o)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:o,value:$}of this._bucket.eachLeafSeries())yield{key:o,child:$}}async*flush(o){yield*flush(this._bucket,o,this,this.options)}}async function*flush(_,o,$,j){const et=_._children,tt=[];let rt=0;for(let ut=0;ut<et.length;ut++){const ft=et.get(ut);if(!ft)continue;const ht=ut.toString(16).toUpperCase().padStart(2,"0");if(ft instanceof Bucket){let mt;for await(const gt of await flush(ft,o,null,j))mt=gt;if(!mt)throw new Error("Could not flush sharded directory, no subshard found");tt.push({Name:ht,Tsize:mt.size,Hash:mt.cid}),rt+=mt.size}else if(typeof ft.value.flush=="function"){const mt=ft.value;let gt;for await(const St of mt.flush(o))gt=St,yield gt;const Et=ht+ft.key;tt.push({Name:Et,Tsize:gt.size,Hash:gt.cid}),rt+=gt.size}else{const mt=ft.value;if(!mt.cid)continue;const gt=ht+ft.key,Et=mt.size;tt.push({Name:gt,Tsize:Et,Hash:mt.cid}),rt+=Et}}const nt=Uint8Array.from(et.bitField().reverse()),st={Data:new UnixFS({type:"hamt-sharded-directory",data:nt,fanout:_.tableSize(),hashType:hamtHashCode,mtime:$&&$.mtime,mode:$&&$.mode}).marshal(),Links:tt},ot=encode$B(prepare$1(st)),at=await persist(ot,o,j),ct=ot.length+rt;yield{cid:at,node:st,size:ct}}const log$1g=logger$1("ipfs:mfs:core:utils:hamt-utils"),updateHamtDirectory=async(_,o,$,j)=>{if(!j.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");const et=Uint8Array.from($._children.bitField().reverse()),tt=UnixFS.unmarshal(j.parent.Data),rt=new UnixFS({type:"hamt-sharded-directory",data:et,fanout:$.tableSize(),hashType:hamtHashCode,mode:tt.mode,mtime:tt.mtime}),nt=await _.hashers.getHasher(j.hashAlg),it={Data:rt.marshal(),Links:o.sort((ct,ut)=>(ct.Name||"").localeCompare(ut.Name||""))},st=encode$B(it),ot=await nt.digest(st),at=CID$3.create(j.cidVersion,code$9,ot);return j.flush&&await _.repo.blocks.put(at,st),{node:it,cid:at,size:o.reduce((ct,ut)=>ct+(ut.Tsize||0),st.length)}},recreateHamtLevel=async(_,o,$,j,et)=>{const tt=new Bucket({hash:$._options.hash,bits:$._options.bits},j,et);return j._putObjectAt(et,tt),await addLinksToHamtBucket(_,o,tt,$),tt},recreateInitialHamtLevel=async _=>{const o=createHAMT({hashFn:hamtHashFn,bits:hamtBucketBits});return await Promise.all(_.map(async $=>{const j=$.Name||"";if(j.length===2){const et=parseInt(j,16),tt=new Bucket({hash:o._options.hash,bits:o._options.bits},o,et);return o._putObjectAt(et,tt),Promise.resolve()}return o.put(j.substring(2),{size:$.Tsize,cid:$.Hash})})),o},addLinksToHamtBucket=async(_,o,$,j)=>{await Promise.all(o.map(async et=>{const tt=et.Name||"";if(tt.length===2){log$1g("Populating sub bucket",tt);const rt=parseInt(tt,16),nt=await _.repo.blocks.get(et.Hash),it=decode$y(nt),st=new Bucket({hash:j._options.hash,bits:j._options.bits},$,rt);return $._putObjectAt(rt,st),await addLinksToHamtBucket(_,it.Links,st,j),Promise.resolve()}return j.put(tt.substring(2),{size:et.Tsize,cid:et.Hash})}))},toPrefix=_=>_.toString(16).toUpperCase().padStart(2,"0").substring(0,2),generatePath=async(_,o,$)=>{const j=await recreateInitialHamtLevel($.Links),et=await j._findNewBucketAndPos(o),tt=[{bucket:et.bucket,prefix:toPrefix(et.pos)}];let rt=et.bucket;for(;rt!==j;)tt.push({bucket:rt,prefix:toPrefix(rt._posAtParent)}),rt=rt._parent;tt.reverse(),tt[0].node=$;for(let nt=0;nt<tt.length;nt++){const it=tt[nt];if(!it.node)throw new Error("Could not generate HAMT path");const st=it.node.Links.filter(ut=>(ut.Name||"").substring(0,2)===it.prefix).pop();if(!st){log$1g(`Link ${it.prefix}${o} will be added`);continue}if(st.Name===`${it.prefix}${o}`){log$1g(`Link ${it.prefix}${o} will be replaced`);continue}log$1g(`Found subshard ${it.prefix}`);const ot=await _.repo.blocks.get(st.Hash),at=decode$y(ot);if(!tt[nt+1]){log$1g(`Loaded new subshard ${it.prefix}`),await recreateHamtLevel(_,at.Links,j,it.bucket,parseInt(it.prefix,16));const ut=await j._findNewBucketAndPos(o);tt.push({bucket:ut.bucket,prefix:toPrefix(ut.pos),node:at});continue}const ct=tt[nt+1];await addLinksToHamtBucket(_,at.Links,ct.bucket,j),ct.node=at}return await j.put(o,!0),tt.reverse(),{rootBucket:j,path:tt}},createShard=async(_,o,$={})=>{const j=new DirSharded({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:$.mtime,mode:$.mode},$);for(let tt=0;tt<o.length;tt++)await j._bucket.put(o[tt].name,{size:o[tt].size,cid:o[tt].cid});const et=await last(j.flush(_.repo.blocks));if(!et)throw new Error("Flushing shard yielded no result");return et},log$1f=logger$1("ipfs:mfs:core:utils:add-link");async function addLink(_,o){let $=o.parent;if(o.parentCid){const et=CID$3.asCID(o.parentCid);if(et===null)throw errCode(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(et.code!==code$9)throw errCode(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");log$1f(`Loading parent node ${et}`);const tt=await _.repo.blocks.get(et);$=decode$y(tt)}if(!$)throw errCode(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!o.cid)throw errCode(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!o.name)throw errCode(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!o.size&&o.size!==0)throw errCode(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!$.Data)throw errCode(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");const j=UnixFS.unmarshal($.Data);return j.type==="hamt-sharded-directory"?(log$1f("Adding link to sharded directory"),addToShardedDirectory(_,{...o,parent:$})):$.Links.length>=o.shardSplitThreshold?(log$1f("Converting directory to sharded directory"),convertToShardedDirectory(_,{...o,parent:$,mtime:j.mtime,mode:j.mode})):(log$1f(`Adding ${o.name} (${o.cid}) to regular directory`),addToDirectory(_,{...o,parent:$}))}const convertToShardedDirectory=async(_,o)=>{const $=await createShard(_,o.parent.Links.map(j=>({name:j.Name||"",size:j.Tsize||0,cid:j.Hash})).concat({name:o.name,size:o.size,cid:o.cid}),o);return log$1f(`Converted directory to sharded directory ${$.cid}`),$},addToDirectory=async(_,o)=>{const $=o.parent.Links.filter(st=>st.Name!==o.name);if($.push({Name:o.name,Tsize:o.size,Hash:o.cid}),!o.parent.Data)throw errCode(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");const j=UnixFS.unmarshal(o.parent.Data);let et;if(j.mtime){const st=Date.now(),ot=Math.floor(st/1e3);j.mtime={secs:ot,nsecs:(st-ot*1e3)*1e3},et=j.marshal()}else et=o.parent.Data;o.parent=prepare$1({Data:et,Links:$});const tt=await _.hashers.getHasher(o.hashAlg),rt=encode$B(o.parent),nt=await tt.digest(rt),it=CID$3.create(o.cidVersion,code$9,nt);return o.flush&&await _.repo.blocks.put(it,rt),{node:o.parent,cid:it,size:rt.length}},addToShardedDirectory=async(_,o)=>{const{shard:$,path:j}=await addFileToShardedDirectory(_,o),et=await last($.flush(_.repo.blocks));if(!et)throw new Error("No result from flushing shard");const tt=await _.repo.blocks.get(et.cid),rt=decode$y(tt),nt=o.parent.Links.filter(st=>(st.Name||"").substring(0,2)!==j[0].prefix),it=rt.Links.find(st=>(st.Name||"").substring(0,2)===j[0].prefix);if(!it)throw new Error(`No link found with prefix ${j[0].prefix}`);return nt.push(it),updateHamtDirectory(_,nt,j[0].bucket,o)},addFileToShardedDirectory=async(_,o)=>{const $={name:o.name,cid:o.cid,size:o.size};if(!o.parent.Data)throw errCode(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");const j=await recreateInitialHamtLevel(o.parent.Links),et=UnixFS.unmarshal(o.parent.Data),tt=new DirSharded({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:et.mode},o);tt._bucket=j,et.mtime&&(tt.mtime={secs:Math.round(Date.now()/1e3)});const rt=await j._findNewBucketAndPos($.name),nt=toBucketPath(rt);nt[0].node=o.parent;let it=0;for(;it<nt.length;){const st=nt[it];it++;const ot=st.node;if(!ot)throw new Error("Segment had no node");const at=ot.Links.find(ht=>(ht.Name||"").substring(0,2)===st.prefix);if(!at){log$1f(`Link ${st.prefix}${$.name} will be added`),it=nt.length;break}if(at.Name===`${st.prefix}${$.name}`){log$1f(`Link ${st.prefix}${$.name} will be replaced`),it=nt.length;break}if((at.Name||"").length>2){log$1f(`Link ${at.Name} ${at.Hash} will be replaced with a subshard`),it=nt.length;break}log$1f(`Found subshard ${st.prefix}`);const ct=await _.repo.blocks.get(at.Hash),ut=decode$y(ct);if(!nt[it]){log$1f(`Loaded new subshard ${st.prefix}`),await recreateHamtLevel(_,ut.Links,j,st.bucket,parseInt(st.prefix,16));const ht=await j._findNewBucketAndPos($.name);nt.push({bucket:ht.bucket,prefix:toPrefix(ht.pos),node:ut});break}const ft=nt[it];await addLinksToHamtBucket(_,ut.Links,ft.bucket,j),ft.node=ut}return await tt._bucket.put($.name,{size:$.size,cid:$.cid}),{shard:tt,path:nt}},toBucketPath=_=>{const o=[{bucket:_.bucket,prefix:toPrefix(_.pos)}];let $=_.bucket._parent,j=_.bucket._posAtParent;for(;$;)o.push({bucket:$,prefix:toPrefix(j)}),j=$._posAtParent,$=$._parent;return o.reverse(),o},log$1e=logger$1("ipfs:mfs:utils:update-tree"),defaultOptions$h={shardSplitThreshold:1e3};async function updateTree(_,o,$){$=Object.assign({},defaultOptions$h,$),log$1e("Trail",o),o=o.slice().reverse();let j=0,et;for await(const rt of _.repo.blocks.getMany(o.map(nt=>nt.cid))){const nt=decode$y(rt),it=o[j].cid,st=o[j].name;if(j++,!et){et={cid:it,name:st,size:rt.length};continue}const ot=await addLink(_,{parent:nt,name:et.name,cid:et.cid,size:et.size,flush:$.flush,shardSplitThreshold:$.shardSplitThreshold,hashAlg:$.hashAlg,cidVersion:$.cidVersion});et={cid:ot.cid,name:st,size:ot.size}}const{cid:tt}=et;return log$1e(`Final CID ${tt}`),tt}const log$1d=logger$1("ipfs:mfs:utils:update-mfs-root");async function updateMfsRoot(_,o,$){if($&&$.signal&&$.signal.aborted)throw errCode(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return log$1d(`New MFS root will be ${o}`),await _.repo.datastore.put(MFS_ROOT_KEY$2,o.bytes),o}async function createNode$1(_,o,$){const j=new UnixFS({type:o,mode:$.mode,mtime:$.mtime}),et=await _.hashers.getHasher($.hashAlg),tt={Data:j.marshal(),Links:[]},rt=encode$B(tt),nt=await et.digest(rt),it=CID$3.create($.cidVersion,code$9,nt);return $.flush&&await _.repo.blocks.put(it,rt),{cid:it,node:tt}}const mergeOptions$b=mergeOptions$g.bind({ignoreUndefined:!0}),log$1c=logger$1("ipfs:mfs:mkdir"),defaultOptions$g={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function createMkdir$1(_){async function o($,j={}){const et=mergeOptions$b(defaultOptions$g,j);if(!$)throw new Error("no path given to Mkdir");if($=$.trim(),$==="/"){if(et.parents)return;throw errCode(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if($.substring(0,1)!=="/")throw errCode(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");log$1c(`Creating ${$}`);const tt=toPathComponents($);if(tt[0]==="ipfs")throw errCode(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");const rt=await loadMfsRoot(_,et);let nt;const it=[],st=await createNode$1(_,"directory",et);for(let at=0;at<=tt.length;at++){const ct=tt.slice(0,at),ut=`/ipfs/${rt}/${ct.join("/")}`;try{if(nt=await exporter(ut,_.repo.blocks),nt.type!=="file"&&nt.type!=="directory")throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(at===tt.length){if(et.parents)return;throw errCode(new Error("file already exists"),"ERR_ALREADY_EXISTS")}it.push({name:nt.name,cid:nt.cid})}catch(ft){if(ft.code==="ERR_NOT_FOUND"){if(at<tt.length&&!et.parents)throw errCode(new Error(`Intermediate directory path ${ut} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await addEmptyDir$1(_,ct[ct.length-1],st,it[it.length-1],it,et)}else throw ft}}const ot=await updateTree(_,it,et);await updateMfsRoot(_,ot,et)}return withTimeoutOption(o)}const addEmptyDir$1=async(_,o,$,j,et,tt)=>{log$1c(`Adding empty dir called ${o} to ${j.cid}`);const rt=await addLink(_,{parent:j.node,parentCid:j.cid,size:0,cid:$.cid,name:o,hashAlg:tt.hashAlg,cidVersion:tt.cidVersion,flush:tt.flush,shardSplitThreshold:tt.shardSplitThreshold});et[et.length-1].cid=rt.cid,et.push({name:o,cid:$.cid})},mergeOptions$a=mergeOptions$g.bind({ignoreUndefined:!0}),log$1b=logger$1("ipfs:mfs:cp"),defaultOptions$f={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function createCp$1(_){async function o($,j,et={}){const tt=mergeOptions$a(defaultOptions$f,et);Array.isArray($)||($=[$]);const rt=await Promise.all($.map(ct=>toMfsPath(_,ct,tt)));let nt=await toMfsPath(_,j,tt);if(!rt.length||!nt)throw errCode(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");const it=rt.find(ct=>!ct.exists);if(it)throw errCode(new Error(`${it.path} does not exist`),"ERR_INVALID_PARAMS");const st=isDirectory(nt);if(nt.exists){if(log$1b("Destination exists"),rt.length===1&&!st)throw errCode(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(log$1b("Destination does not exist"),rt.length>1){if(!tt.parents)throw errCode(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await createMkdir$1(_)(nt.path,tt),nt=await toMfsPath(_,nt.path,tt)}else if(nt.parts.length>1){const ct=`/${nt.parts.slice(0,-1).join("/")}`;try{await createStat$7(_)(ct,tt)}catch(ut){if(ut.code!=="ERR_NOT_FOUND")throw ut;if(!tt.parents)throw errCode(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await createMkdir$1(_)(ct,tt),nt=await toMfsPath(_,nt.path,tt)}}const ot=isDirectory(nt)?nt.mfsPath:nt.mfsDirectory,at=await toTrail(_,ot);if(rt.length===1){const ct=rt.pop();if(!ct)throw errCode(new Error("could not find source"),"ERR_INVALID_PARAMS");const ut=st?ct.name:nt.name;return log$1b(`Only one source, copying to destination ${st?"directory":"file"} ${ut}`),copyToFile(_,ct,ut,at,tt)}return log$1b("Multiple sources, wrapping in a directory"),copyToDirectory(_,rt,nt,at,tt)}return withTimeoutOption(o)}const isDirectory=_=>_.unixfs&&_.unixfs.type&&_.unixfs.type.includes("directory"),copyToFile=async(_,o,$,j,et)=>{let tt=j.pop();if(!tt)throw errCode(new Error("destination had no parent"),"ERR_INVALID_PARAMS");tt=await addSourceToParent(_,o,$,tt,et),j.push(tt);const rt=await updateTree(_,j,et);await updateMfsRoot(_,rt,et)},copyToDirectory=async(_,o,$,j,et)=>{for(let rt=0;rt<o.length;rt++){const nt=o[rt];$=await addSourceToParent(_,nt,nt.name,$,et)}j[j.length-1]=$;const tt=await updateTree(_,j,et);await updateMfsRoot(_,tt,et)},addSourceToParent=async(_,o,$,j,et)=>{const tt=await _.repo.blocks.get(o.cid),{node:rt,cid:nt,size:it}=await addLink(_,{parentCid:j.cid,size:tt.length,cid:o.cid,name:$,hashAlg:et.hashAlg,cidVersion:et.cidVersion,flush:et.flush,shardSplitThreshold:et.shardSplitThreshold});return j.node=rt,j.cid=nt,j.size=it,j},log$1a=logger$1("ipfs:mfs:core:utils:remove-link");async function removeLink(_,o){let $=o.parent;if(o.parentCid){const et=CID$3.asCID(o.parentCid);if(et===null)throw errCode(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");log$1a(`Loading parent node ${et}`);const tt=await _.repo.blocks.get(et);$=decode$y(tt)}if(!$)throw errCode(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!o.name)throw errCode(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!$.Data)throw errCode(new Error("Parent node had no data"),"ERR_INVALID_NODE");return UnixFS.unmarshal($.Data).type==="hamt-sharded-directory"?(log$1a(`Removing ${o.name} from sharded directory`),removeFromShardedDirectory(_,{...o,parent:$})):(log$1a(`Removing link ${o.name} regular directory`),removeFromDirectory(_,{...o,parent:$}))}const removeFromDirectory=async(_,o)=>{o.parent.Links=o.parent.Links.filter(rt=>rt.Name!==o.name);const $=await encode$B(o.parent),et=await(await _.hashers.getHasher(o.hashAlg)).digest($),tt=CID$3.create(o.cidVersion,code$9,et);return await _.repo.blocks.put(tt,$),log$1a(`Updated regular directory ${tt}`),{node:o.parent,cid:tt}},removeFromShardedDirectory=async(_,o)=>{const{rootBucket:$,path:j}=await generatePath(_,o.name,o.parent);await $.del(o.name);const{node:et}=await updateShard(_,j,o.name,o);return updateHamtDirectory(_,et.Links,$,o)},updateShard=async(_,o,$,j)=>{const et=o.pop();if(!et)throw errCode(new Error("Could not find parent"),"EINVALIDPARENT");const{bucket:tt,prefix:rt,node:nt}=et;if(!nt)throw errCode(new Error("Could not find parent"),"EINVALIDPARENT");const it=nt.Links.find(ut=>(ut.Name||"").substring(0,2)===rt);if(!it)throw errCode(new Error(`No link found with prefix ${rt} for file ${$}`),"ERR_NOT_FOUND");if(it.Name===`${rt}${$}`){log$1a(`Removing existing link ${it.Name}`);const ut=nt.Links.filter(ft=>ft.Name!==it.Name);return await tt.del($),updateHamtDirectory(_,ut,tt,j)}log$1a(`Descending into sub-shard ${it.Name} for ${rt}${$}`);const st=await updateShard(_,o,$,j);let ot=st.cid,at=st.size,ct=rt;if(st.node.Links.length===1){log$1a(`Removing subshard for ${rt}`);const ut=st.node.Links[0];ct=`${rt}${(ut.Name||"").substring(2)}`,ot=ut.Hash,at=ut.Tsize||0}return log$1a(`Updating shard ${rt} with name ${ct}`),updateShardParent(_,tt,nt,rt,ct,at,ot,j)},updateShardParent=(_,o,$,j,et,tt,rt,nt)=>{const it=$.Links.filter(st=>st.Name!==j);return it.push({Name:et,Tsize:tt,Hash:rt}),updateHamtDirectory(_,it,o,nt)},mergeOptions$9=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$e={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function createRm$8(_){async function o($,j={}){const et=mergeOptions$9(defaultOptions$e,j);Array.isArray($)||($=[$]);const tt=await Promise.all($.map(rt=>toMfsPath(_,rt,et)));if(!tt.length)throw errCode(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");tt.forEach(rt=>{if(rt.path==="/")throw errCode(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(const rt of tt)await removePath(_,rt.path,et)}return withTimeoutOption(o)}const removePath=async(_,o,$)=>{const j=await toMfsPath(_,o,$),et=await toTrail(_,j.mfsPath),tt=et[et.length-1];et.pop();const rt=et[et.length-1];if(!rt)throw errCode(new Error(`${o} does not exist`),"ERR_NOT_FOUND");if(tt.type==="directory"&&!$.recursive)throw errCode(new Error(`${o} is a directory, use -r to remove directories`),"ERR_WAS_DIR");const{cid:nt}=await removeLink(_,{parentCid:rt.cid,name:tt.name,hashAlg:$.hashAlg,cidVersion:$.cidVersion,flush:$.flush,shardSplitThreshold:$.shardSplitThreshold});rt.cid=nt;const it=await updateTree(_,et,$);await updateMfsRoot(_,it,$)},mergeOptions$8=mergeOptions$g.bind({ignoreUndefined:!0}),log$19=logger$1("ipfs:mfs:touch"),defaultOptions$d={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function calculateModification(_,o,$){let j=0;return(_.includes("x")||_.includes("X")&&($||o&1||o&8||o&64))&&(j+=1),_.includes("w")&&(j+=2),_.includes("r")&&(j+=4),j}function calculateUGO(_,o){let $=0;return _.includes("u")&&($+=o<<6),_.includes("g")&&($+=o<<3),_.includes("o")&&($+=o),$}function calculateSpecial(_,o,$){return o.includes("t")&&($+=parseInt("1000",8)),o.includes("s")&&(_.includes("u")&&($+=parseInt("4000",8)),_.includes("g")&&($+=parseInt("2000",8))),$}function parseSymbolicMode(_,o,$){o||(o=0);const j=_.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!j)throw new Error(`Invalid file mode: ${_}`);let[,et,tt,rt]=j;(et==="a"||!et)&&(et="ugo");let nt=calculateModification(rt,o,$);return nt=calculateUGO(et,nt),nt=calculateSpecial(et,rt,nt),tt==="="?(et.includes("u")&&(o=o&parseInt("7077",8),o=o|nt),et.includes("g")&&(o=o&parseInt("7707",8),o=o|nt),et.includes("o")&&(o=o&parseInt("7770",8),o=o|nt),o):tt==="+"?nt|o:tt==="-"?nt^o:o}function calculateMode(_,o){if(_ instanceof String||typeof _=="string"){const $=`${_}`;$.match(/^\d+$/g)?_=parseInt($,8):_=0+$.split(",").reduce((j,et)=>parseSymbolicMode(et,j,o.isDirectory()),o.mode||0)}return _}function createChmod$1(_){async function o($,j,et={}){const tt=mergeOptions$8(defaultOptions$d,et);log$19(`Fetching stats for ${$}`);const{cid:rt,mfsDirectory:nt,name:it}=await toMfsPath(_,$,tt);if(rt.code!==code$9)throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(tt.recursive){const Dt=await pipe(async function*(){for await(const Ot of recursive(rt,_.repo.blocks)){if(Ot.type!=="file"&&Ot.type!=="directory")throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");Ot.unixfs.mode=calculateMode(j,Ot.unixfs);const jt=prepare$1({Data:Ot.unixfs.marshal(),Links:Ot.node.Links});yield{path:Ot.path,content:jt}}},Ot=>importer(Ot,_.repo.blocks,{...tt,pin:!1,dagBuilder:async function*(jt,Nt,It){for await(const yt of jt)yield async function(){const lt=yt.content,pt=encode$B(lt),bt=await persist(pt,Nt,It);if(!lt.Data)throw errCode(new Error(`${bt} had no data`),"ERR_INVALID_NODE");const _t=UnixFS.unmarshal(lt.Data);return{cid:bt,size:pt.length,path:yt.path,unixfs:_t}}}}),Ot=>last(Ot));if(!Dt)throw errCode(new Error(`Could not chmod ${$}`),"ERR_COULD_NOT_CHMOD");await createRm$8(_)($,tt),await createCp$1(_)(`/ipfs/${Dt.cid}`,$,tt);return}const st=await _.repo.blocks.get(rt),ot=decode$y(st);if(!ot.Data)throw errCode(new Error(`${rt} had no data`),"ERR_INVALID_NODE");const at=UnixFS.unmarshal(ot.Data);at.mode=calculateMode(j,at);const ct=encode$B({Data:at.marshal(),Links:ot.Links}),ut=tt.hashAlg||defaultOptions$d.hashAlg,ht=await(await _.hashers.getHasher(ut)).digest(ct),mt=CID$3.create(tt.cidVersion,code$9,ht);tt.flush&&await _.repo.blocks.put(mt,ct);const gt=await toTrail(_,nt),Et=gt[gt.length-1],St=CID$3.decode(Et.cid.bytes),At=await _.repo.blocks.get(St),kt=decode$y(At),Rt=await addLink(_,{parent:kt,name:it,cid:mt,size:ct.length,flush:tt.flush,hashAlg:ut,cidVersion:rt.version,shardSplitThreshold:1/0});Et.cid=Rt.cid;const Tt=await updateTree(_,gt,tt);await updateMfsRoot(_,Tt,tt)}return withTimeoutOption(o)}const mergeOptions$7=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$c={};function createFlush$1(_){async function o($,j={}){j=mergeOptions$7(defaultOptions$c,j);const{cid:et}=await createStat$7(_)($,j);return et}return withTimeoutOption(o)}const mergeOptions$6=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$b={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function createMv$1(_){async function o($,j,et={}){const tt=mergeOptions$6(defaultOptions$b,et);await createCp$1(_)($,j,tt),await createRm$8(_)($,{...tt,recursive:!0})}return withTimeoutOption(o)}const mergeOptions$5=mergeOptions$g.bind({ignoreUndefined:!0}),log$18=logger$1("ipfs:mfs:touch"),defaultOptions$a={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function createTouch$1(_){async function o($,j={}){const et=mergeOptions$5(defaultOptions$a,j);et.mtime=et.mtime||new Date,log$18(`Touching ${$} mtime: ${et.mtime}`);const{cid:tt,mfsDirectory:rt,name:nt,exists:it}=await toMfsPath(_,$,et),st=j.hashAlg||defaultOptions$a.hashAlg,ot=await _.hashers.getHasher(st);let at,ct,ut=et.cidVersion;if(it){if(tt.code!==code$9)throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");ut=tt.version;const kt=await _.repo.blocks.get(tt),Rt=decode$y(kt);if(!Rt.Data)throw errCode(new Error(`${$} had no data`),"ERR_INVALID_NODE");const Tt=UnixFS.unmarshal(Rt.Data);Tt.mtime=et.mtime,at=encode$B({Data:Tt.marshal(),Links:Rt.Links});const Dt=await ot.digest(at);ct=CID$3.create(et.cidVersion,code$9,Dt),et.flush&&await _.repo.blocks.put(ct,at)}else{const kt=new UnixFS({type:"file",mtime:et.mtime});at=encode$B({Data:kt.marshal(),Links:[]});const Rt=await ot.digest(at);ct=CID$3.create(et.cidVersion,code$9,Rt),et.flush&&await _.repo.blocks.put(ct,at)}const ft=await toTrail(_,rt),ht=ft[ft.length-1],mt=ht.cid,gt=await _.repo.blocks.get(mt),Et=decode$y(gt),St=await addLink(_,{parent:Et,name:nt,cid:ct,size:at.length,flush:et.flush,shardSplitThreshold:et.shardSplitThreshold,hashAlg:et.hashAlg,cidVersion:ut});ht.cid=St.cid;const At=await updateTree(_,ft,et);await updateMfsRoot(_,At,et)}return withTimeoutOption(o)}const mergeOptions$4=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$9={offset:0,length:1/0};function createRead$1(_){function o($,j={}){return j=mergeOptions$4(defaultOptions$9,j),{[Symbol.asyncIterator]:async function*(){const tt=await toMfsPath(_,$,j),rt=await exporter(tt.mfsPath,_.repo.blocks);if(rt.type!=="file"&&rt.type!=="raw")throw errCode(new Error(`${$} was not a file or raw bytes`),"ERR_NOT_FILE");if(!rt.content)throw errCode(new Error(`Could not load content stream from ${$}`),"ERR_NO_CONTENT");for await(const nt of rt.content({offset:j.offset,length:j.length}))yield nt}}}return withTimeoutOption(o)}const log$17=logger$1("ipfs:mfs:utils:to-async-iterator");function toAsyncIterator(_){if(!_)throw errCode(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof _=="string"||_ instanceof String)&&(log$17("Content was a string"),_=fromString$8(_.toString())),_.length)return log$17("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield _}};if(_[Symbol.asyncIterator])return log$17("Content was an async iterator"),_;if(_[Symbol.iterator])return log$17("Content was an iterator"),_;if(_global.Blob&&_ instanceof _global.Blob)return log$17("Content was an HTML5 Blob"),browserReadableStreamToIt(_.stream());throw errCode(new Error(`Don't know how to convert ${_} into an async iterator`),"ERR_INVALID_PARAMS")}const mergeOptions$3=mergeOptions$g.bind({ignoreUndefined:!0}),log$16=logger$1("ipfs:mfs:write"),defaultOptions$8={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(_,o)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function createWrite$1(_){async function o($,j,et={}){const tt=mergeOptions$3(defaultOptions$8,et);let rt,nt,it;if(log$16("Reading source, destination and parent"),await createLock().readLock(async()=>{rt=await toAsyncIterator(j),nt=await toMfsPath(_,$,tt),it=await toMfsPath(_,nt.mfsDirectory,tt)})(),log$16("Read source, destination and parent"),!tt.parents&&!it.exists)throw errCode(new Error("directory does not exist"),"ERR_NO_EXIST");if(rt==null)throw errCode(new Error("could not create source"),"ERR_NO_SOURCE");if(nt==null)throw errCode(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!tt.create&&!nt.exists)throw errCode(new Error("file does not exist"),"ERR_NO_EXIST");if(nt.entryType!=="file")throw errCode(new Error("not a file"),"ERR_NOT_A_FILE");return updateOrImport(_,$,rt,nt,tt)}return withTimeoutOption(o)}const updateOrImport=async(_,o,$,j,et)=>{const tt=await write$1(_,$,j,et);await createLock().writeLock(async()=>{const rt=toPathComponents(o),nt=rt.pop();if(nt==null)throw errCode(new Error("source does not exist"),"ERR_NO_EXIST");let it=!1;try{await createStat$7(_)(`/${rt.join("/")}`,et),it=!0}catch(mt){if(mt.code!=="ERR_NOT_FOUND")throw mt}it||await createMkdir$1(_)(`/${rt.join("/")}`,et);const st=await toMfsPath(_,o,et),ot=await toTrail(_,st.mfsDirectory),at=ot[ot.length-1];if(!at)throw errCode(new Error("directory does not exist"),"ERR_NO_EXIST");if(!at.type||!at.type.includes("directory"))throw errCode(new Error(`cannot write to ${at.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const ct=await _.repo.blocks.get(at.cid),ut=decode$y(ct),ft=await addLink(_,{parent:ut,name:nt,cid:tt.cid,size:tt.size,flush:et.flush,shardSplitThreshold:et.shardSplitThreshold,hashAlg:et.hashAlg,cidVersion:et.cidVersion});at.cid=ft.cid;const ht=await updateTree(_,ot,et);await updateMfsRoot(_,ht,et)})()},write$1=async(_,o,$,j)=>{$.exists?log$16(`Overwriting file ${$.cid} offset ${j.offset} length ${j.length}`):log$16(`Writing file offset ${j.offset} length ${j.length}`);const et=[];if(j.offset>0)if($.unixfs){if(log$16(`Writing first ${j.offset} bytes of original file`),et.push(()=>$.content({offset:0,length:j.offset})),$.unixfs.fileSize()<j.offset){const ot=j.offset-$.unixfs.fileSize();log$16(`Writing zeros for extra ${ot} bytes`),et.push(asyncZeroes(ot))}}else log$16(`Writing zeros for first ${j.offset} bytes`),et.push(asyncZeroes(j.offset));et.push(limitAsyncStreamBytes(o,j.length));const tt=countBytesStreamed(catAsyncIterators(et),ot=>{if($.unixfs&&!j.truncate){const at=$.unixfs.fileSize();if(at>ot)return log$16(`Writing last ${at-ot} of ${at} bytes from original file starting at offset ${ot}`),$.content({offset:ot});log$16("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}});let rt;j.mode!==void 0&&j.mode!==null?rt=parseMode(j.mode):$&&$.unixfs&&(rt=$.unixfs.mode);let nt;j.mtime!=null?nt=parseMtime$1(j.mtime):$&&$.unixfs&&(nt=$.unixfs.mtime);const it=await _.hashers.getHasher(j.hashAlg),st=await last(importer([{content:tt,mode:rt,mtime:nt}],_.repo.blocks,{progress:j.progress,hasher:it,cidVersion:j.cidVersion,strategy:j.strategy,rawLeaves:j.rawLeaves,reduceSingleLeafToSelf:j.reduceSingleLeafToSelf,leafType:j.leafType}));if(!st)throw errCode(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return log$16(`Wrote ${st.cid}`),{cid:st.cid,size:st.size}},limitAsyncStreamBytes=(_,o)=>async function*(){let j=0;for await(const et of _){if(j+=et.length,j>o){yield et.subarray(0,o-j);return}yield et}},asyncZeroes=(_,o=MFS_MAX_CHUNK_SIZE)=>{const $=new Uint8Array(o);async function*j(){for(;;)yield $}return limitAsyncStreamBytes(j(),_)},catAsyncIterators=async function*(_){for(let o=0;o<_.length;o++)yield*_[o]()},countBytesStreamed=async function*(_,o){let $=0;for await(const j of _)$+=j.length,yield j;for await(const j of o($))$+=j.length,yield j},toOutput=_=>{const o={cid:_.cid,name:_.name,type:_.type==="directory"?"directory":"file",size:_.size};return(_.type==="file"||_.type==="directory")&&(o.mode=_.unixfs.mode,o.mtime=_.unixfs.mtime),o};function createLs$7(_){async function*o($,j={}){const et=await toMfsPath(_,$,j),tt=await exporter(et.mfsPath,_.repo.blocks);if(tt.type==="directory"){yield*map$3(tt.content(j),toOutput);return}yield toOutput(tt)}return withTimeoutOption(o)}const readOperations={stat:createStat$7},writeOperations={chmod:createChmod$1,cp:createCp$1,flush:createFlush$1,mkdir:createMkdir$1,mv:createMv$1,rm:createRm$8,touch:createTouch$1},unwrappedOperations={write:createWrite$1,read:createRead$1,ls:createLs$7},wrap=({options:_,mfs:o,operations:$,lock:j})=>{Object.keys($).forEach(et=>{o[et]=j($[et](_))})},defaultOptions$7={repoOwner:!0,repo:null};function createMfs(_){const{repoOwner:o}=Object.assign({},defaultOptions$7||{},_),$=createLock(o),j=rt=>$.readLock(rt),et=rt=>$.writeLock(rt),tt={};return wrap({options:_,mfs:tt,operations:readOperations,lock:j}),wrap({options:_,mfs:tt,operations:writeOperations,lock:et}),Object.keys(unwrappedOperations).forEach(rt=>{tt[rt]=unwrappedOperations[rt](_)}),tt}function createFiles$1({repo:_,preload:o,hashers:$,options:j}){const et=createMfs({repo:_,repoOwner:j.repoOwner!==!1,hashers:$}),tt=rt=>(...it)=>{const st=it.filter(ot=>ipfsPath$1(ot)||isCID$1(ot));if(st.length){const ot=it[it.length-1];ot&&ot.preload!==!1&&st.forEach(at=>o(at))}return rt(...it)};return{...et,chmod:et.chmod,cp:tt(et.cp),mkdir:et.mkdir,stat:tt(et.stat),rm:et.rm,read:tt(et.read),touch:et.touch,write:et.write,mv:tt(et.mv),flush:et.flush,ls:tt(async function*(...rt){for await(const nt of et.ls(...rt))yield{...nt,size:nt.size||0}})}}function createExport$2({keychain:_}){return withTimeoutOption(($,j)=>_.exportKey($,j))}const DEFAULT_KEY_TYPE="Ed25519",DEFAULT_KEY_SIZE=2048;function createGen$1({keychain:_}){return withTimeoutOption(($,j={type:DEFAULT_KEY_TYPE,size:DEFAULT_KEY_SIZE})=>_.createKey($,j.type||DEFAULT_KEY_TYPE,j.size||DEFAULT_KEY_SIZE))}function createImport$2({keychain:_}){return withTimeoutOption(($,j,et)=>_.importKey($,j,et))}function createInfo$1({keychain:_}){return withTimeoutOption($=>_.findKeyByName($))}function createList$3({keychain:_}){return withTimeoutOption(()=>_.listKeys())}function createRename$1({keychain:_}){return withTimeoutOption(async($,j)=>{const et=await _.renameKey($,j);return{was:$,now:et.name,id:et.id,overwrite:!1}})}function createRm$7({keychain:_}){return withTimeoutOption($=>_.removeKey($))}class KeyAPI{constructor({keychain:o}){this.gen=createGen$1({keychain:o}),this.list=createList$3({keychain:o}),this.rm=createRm$7({keychain:o}),this.rename=createRename$1({keychain:o}),this.export=createExport$2({keychain:o}),this.import=createImport$2({keychain:o}),this.info=createInfo$1({keychain:o})}}function createGet$6({repo:_,preload:o}){async function $(j,et={}){et.preload!==!1&&o(j);const tt=await _.blocks.get(j,et);return decode$y(tt)}return withTimeoutOption($)}function createData$1({repo:_,preload:o}){const $=createGet$6({repo:_,preload:o});async function j(et,tt={}){return(await $(et,tt)).Data||new Uint8Array(0)}return withTimeoutOption(j)}function findLinks(_,o=[]){for(const $ in _){const j=_[$];if($==="/"&&Object.keys(_).length===1)try{o.push({Name:"",Tsize:0,Hash:CID$3.parse(j)});continue}catch{}const et=CID$3.asCID(j);if(et){o.push({Name:"",Tsize:0,Hash:et});continue}Array.isArray(j)&&findLinks(j,o),j&&typeof j=="object"&&findLinks(j,o)}return o}function createLinks$1({repo:_,codecs:o}){async function $(j,et={}){const tt=await o.getCodec(j.code),rt=await _.blocks.get(j,et),nt=tt.decode(rt);switch(j.code){case code$6:return[];case code$9:return nt.Links;case code$8:case code$1:return findLinks(nt);default:throw new Error(`Cannot resolve links from codec ${j.code}`)}}return withTimeoutOption($)}function createNew$1({repo:_,preload:o}){async function $(j={}){let et;if(j.template)if(j.template==="unixfs-dir")et=new UnixFS({type:"directory"}).marshal();else throw new Error("unknown template");const tt=encode$B({Data:et,Links:[]}),rt=await sha256$8.digest(tt),nt=CID$3.createV0(rt);return await _.blocks.put(nt,tt,{signal:j.signal}),j.preload!==!1&&o(nt),nt}return withTimeoutOption($)}function createPut$4({repo:_,preload:o}){async function $(j,et={}){const tt=await _.gcLock.readLock();try{const rt=encode$B(j),nt=await sha256$8.digest(rt),it=CID$3.createV1(code$9,nt);return await _.blocks.put(it,rt,{signal:et.signal}),et.preload!==!1&&o(it),et.pin&&await _.pins.pinRecursively(it,{signal:et.signal}),it}finally{tt()}}return withTimeoutOption($)}function createStat$6({repo:_,preload:o}){const $=createGet$6({repo:_,preload:o});async function j(et,tt={}){const rt=await $(et,tt),it=encode$B(rt).length,st=rt.Links.reduce((ot,at)=>ot+(at.Tsize||0),0);return{Hash:et,NumLinks:rt.Links.length,BlockSize:it,LinksSize:it-(rt.Data||[]).length,DataSize:(rt.Data||[]).length,CumulativeSize:it+st}}return withTimeoutOption(j)}function createAddLink$1({repo:_,preload:o}){const $=createGet$6({repo:_,preload:o}),j=createPut$4({repo:_,preload:o});async function et(tt,rt,nt={}){const it=await $(tt,nt);return j({...it,Links:it.Links.concat([rt])},nt)}return withTimeoutOption(et)}function createAppendData$1({repo:_,preload:o}){const $=createGet$6({repo:_,preload:o}),j=createPut$4({repo:_,preload:o});async function et(tt,rt,nt={}){const it=await $(tt,nt),st=concat$2([it.Data||[],rt]);return j({...it,Data:st},nt)}return withTimeoutOption(et)}function createRmLink$1({repo:_,preload:o}){const $=createGet$6({repo:_,preload:o}),j=createPut$4({repo:_,preload:o});async function et(tt,rt,nt={}){const it=await $(tt,nt),st=(typeof rt=="string"?rt:rt.Name)||"";return it.Links=it.Links.filter(ot=>ot.Name!==st),j(it,nt)}return withTimeoutOption(et)}function createSetData$1({repo:_,preload:o}){const $=createGet$6({repo:_,preload:o}),j=createPut$4({repo:_,preload:o});async function et(tt,rt,nt={}){const it=await $(tt,nt);return j({...it,Data:rt},nt)}return withTimeoutOption(et)}class ObjectPatchAPI{constructor({repo:o,preload:$}){this.addLink=createAddLink$1({repo:o,preload:$}),this.appendData=createAppendData$1({repo:o,preload:$}),this.rmLink=createRmLink$1({repo:o,preload:$}),this.setData=createSetData$1({repo:o,preload:$})}}class ObjectAPI{constructor({repo:o,codecs:$,preload:j}){this.data=createData$1({repo:o,preload:j}),this.get=createGet$6({repo:o,preload:j}),this.links=createLinks$1({repo:o,codecs:$}),this.new=createNew$1({repo:o,preload:j}),this.put=createPut$4({repo:o,preload:j}),this.stat=createStat$6({repo:o,preload:j}),this.patch=new ObjectPatchAPI({repo:o,preload:j})}}const log$15=logger$1("ipfs:repo:gc");function createGc$1({repo:_,hashers:o}){async function*$(j={}){const et=Date.now();let tt;try{tt=await loadMfsRoot({repo:_,hashers:o},j),await _.pins.pinRecursively(tt),yield*_.gc()}finally{tt&&await _.pins.unpin(tt)}log$15(`Complete (${Date.now()-et}ms)`)}return withTimeoutOption($)}function createStat$5({repo:_}){async function o($={}){const j=await _.stat();return{numObjects:BigInt(j.numObjects.toString()),repoSize:BigInt(j.repoSize.toString()),repoPath:j.repoPath,version:`${j.version}`,storageMax:BigInt(j.storageMax.toString())}}return withTimeoutOption(o)}const repoVersion=12;function createVersion$2({repo:_}){async function o($={}){try{await _._checkInitialized($)}catch(j){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(tt=>tt.test(j.message)))return repoVersion;throw j}return _.version.get()}return withTimeoutOption(o)}class RepoAPI{constructor({repo:o,hashers:$}){this.gc=createGc$1({repo:o,hashers:$}),this.stat=createStat$5({repo:o}),this.version=createVersion$2({repo:o}),this.setApiAddr=j=>o.apiAddr.set(j)}}function getBandwidthStats(_,o){return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0}}function createBw$1({network:_}){return withTimeoutOption(async function*($={}){const{libp2p:j}=await _.use($);if(!$.poll){yield getBandwidthStats();return}const et=$.interval||1e3;let tt=-1;try{if(tt=typeof et=="string"?parse$4(et)||-1:et,!tt||tt<0)throw new Error("invalid duration")}catch(nt){throw errCode(nt,"ERR_INVALID_POLL_INTERVAL")}let rt;try{for(;;)yield getBandwidthStats(j,$),await new Promise(nt=>{rt=setTimeout(nt,tt)})}finally{clearTimeout(rt)}})}class StatsAPI{constructor({repo:o,network:$}){this.repo=createStat$5({repo:o}),this.bw=createBw$1({network:$}),this.bitswap=createStat$9({network:$})}}var objectSafeGet=get;function get(_,o,$){if(!_)return $;var j,et;if(Array.isArray(o)&&(j=o.slice(0)),typeof o=="string"&&(j=o.split(".")),typeof o=="symbol"&&(j=[o]),!Array.isArray(j))throw new Error("props arg must be an array, a string or a symbol");for(;j.length;)if(et=j.shift(),!_||(_=_[et],_===void 0))return $;return _}async function length$2(_){let o=0;for await(const $ of _)o++;return o}const log$14=browserExports$1("ipfs:repo:migrator:migration-8");function unwrap$1(_){return _.child?unwrap$1(_.child):_}function keyToMultihash$1(_){try{const o=base32$6.decode(`b${_.toString().toLowerCase().slice(1)}`),$=CID$3.decode(o).multihash.bytes,j=base32$6.encode($).slice(1).toUpperCase();return new Key(`/${j}`,!1)}catch{return _}}function keyToCid$1(_){try{const o=base32$6.decode(`b${_.toString().toLowerCase().slice(1)}`),$=decode$B(o),j=base32$6.encode(CID$3.createV1(code$6,$).bytes).slice(1);return new Key(`/${j.toUpperCase()}`,!1)}catch{return _}}async function process$2(_,o,$){const j=_.blocks;await j.open();const et=unwrap$1(j),tt=await length$2(et.queryKeys({filters:[rt=>$(rt).toString()!==rt.toString()]}));try{let rt=0;for await(const nt of et.query({})){const it=$(nt.key);it.toString()!==nt.key.toString()&&(rt+=1,log$14(`Migrating Block from ${nt.key} to ${it}`,await et.has(nt.key)),await et.delete(nt.key),await et.put(it,nt.value),o(rt/tt*100,`Migrated Block from ${nt.key} to ${it}`))}}finally{await j.close()}}const migration$4={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(_,o=()=>{})=>process$2(_,o,keyToMultihash$1),revert:(_,o=()=>{})=>process$2(_,o,keyToCid$1)},$Reader$6=$protobuf.Reader,$Writer$6=$protobuf.Writer;$protobuf.util;const $root$6=$protobuf.roots.default||($protobuf.roots.default={}),ipfs$1=$root$6.ipfs=(()=>{const _={};return _.pin=function(){const o={};return o.Set=function(){function $(j){if(j)for(var et=Object.keys(j),tt=0;tt<et.length;++tt)j[et[tt]]!=null&&(this[et[tt]]=j[et[tt]])}return $.prototype.version=0,$.prototype.fanout=0,$.prototype.seed=0,$.encode=function(et,tt){return tt||(tt=$Writer$6.create()),et.version!=null&&Object.hasOwnProperty.call(et,"version")&&tt.uint32(8).uint32(et.version),et.fanout!=null&&Object.hasOwnProperty.call(et,"fanout")&&tt.uint32(16).uint32(et.fanout),et.seed!=null&&Object.hasOwnProperty.call(et,"seed")&&tt.uint32(29).fixed32(et.seed),tt},$.decode=function(et,tt){et instanceof $Reader$6||(et=$Reader$6.create(et));for(var rt=tt===void 0?et.len:et.pos+tt,nt=new $root$6.ipfs.pin.Set;et.pos<rt;){var it=et.uint32();switch(it>>>3){case 1:nt.version=et.uint32();break;case 2:nt.fanout=et.uint32();break;case 3:nt.seed=et.fixed32();break;default:et.skipType(it&7);break}}return nt},$.fromObject=function(et){if(et instanceof $root$6.ipfs.pin.Set)return et;var tt=new $root$6.ipfs.pin.Set;return et.version!=null&&(tt.version=et.version>>>0),et.fanout!=null&&(tt.fanout=et.fanout>>>0),et.seed!=null&&(tt.seed=et.seed>>>0),tt},$.toObject=function(et,tt){tt||(tt={});var rt={};return tt.defaults&&(rt.version=0,rt.fanout=0,rt.seed=0),et.version!=null&&et.hasOwnProperty("version")&&(rt.version=et.version),et.fanout!=null&&et.hasOwnProperty("fanout")&&(rt.fanout=et.fanout),et.seed!=null&&et.hasOwnProperty("seed")&&(rt.seed=et.seed),rt},$.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},$}(),o}(),_})();var fnv1aExports={},fnv1a$1={get exports(){return fnv1aExports},set exports(_){fnv1aExports=_}};(function(_,o){Object.defineProperty(o,"__esModule",{value:!0}),$.BASE=2166136261;function $(j,et=$.BASE){const tt=j.length;for(let rt=0;rt<tt;rt++)et^=j.charCodeAt(rt),et+=(et<<1)+(et<<4)+(et<<7)+(et<<8)+(et<<24);return et>>>0}o.default=$,_.exports=$})(fnv1a$1,fnv1aExports);const fnv1a=getDefaultExportFromCjs(fnv1aExports),PIN_DS_KEY=new Key("/local/pins"),DEFAULT_FANOUT=256,MAX_ITEMS=8192,EMPTY_KEY=CID$3.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),PinTypes={direct:"direct",recursive:"recursive"};function cidToKey$2(_){return new Key(`/${base32$6.encode(_.multihash.bytes).toUpperCase().substring(1)}`)}const PinSet=ipfs$1.pin.Set;function readHeader(_){const o=_.Data;if(!o)throw new Error("No data present");const $=varint$2.decode(o),j=varint$2.decode.bytes??0;if(j<=0)throw new Error("Invalid Set header length");if(j+$>o.length)throw new Error("Impossibly large set header length");const et=o.slice(j,$+j),tt=PinSet.toObject(PinSet.decode(et),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(tt.version!==1)throw new Error(`Unsupported Set version: ${tt.version}`);if(tt.fanout>_.Links.length)throw new Error("Impossibly large fanout");return{header:tt,data:o.slice($+j)}}function hash$1(_,o){const $=new Uint8Array(4);new DataView($.buffer).setUint32(0,_,!0);const et=fromString$8(o.toString()),tt=concat$2([$,et],$.byteLength+et.byteLength);return fnv1a(toString$a(tt))}async function*walkItems(_,o){const $=readHeader(o);let j=0;for(const et of o.Links){if(j<$.header.fanout){const tt=et.Hash;if(!EMPTY_KEY.equals(tt)){const rt=await _.get(tt),nt=decode$y(rt);yield*walkItems(_,nt)}}else yield et.Hash;j++}}async function*loadSet(_,o,$){const j=o.Links.find(rt=>rt.Name===$);if(!j)throw new Error("No link found with name "+$);const et=await _.get(j.Hash),tt=decode$y(et);yield*walkItems(_,tt)}function storeItems(_,o){return $(o,0);async function $(j,et){const tt=PinSet.encode({version:1,fanout:DEFAULT_FANOUT,seed:et}).finish(),rt=varint$2.encode(tt.length),nt=concat$2([rt,tt]),it=[];for(let ot=0;ot<DEFAULT_FANOUT;ot++)it.push({Name:"",Tsize:1,Hash:EMPTY_KEY});if(j.length<=MAX_ITEMS){const ot=j.map(ut=>({link:{Name:"",Tsize:1,Hash:ut.key},data:ut.data||new Uint8Array})).sort((ut,ft)=>compare$1(ut.link.Hash.bytes,ft.link.Hash.bytes)),at=it.concat(ot.map(ut=>ut.link));return{Data:concat$2([nt,...ot.map(ut=>ut.data)]),Links:at}}else{const ot=j.reduce((ct,ut)=>{const ft=hash$1(et,ut.key)%DEFAULT_FANOUT;return ct[ft]=ft in ct?ct[ft].concat([ut]):[ut],ct},[]);let at=0;for(const ct of ot){const ut=await $(ct,et+1);await st(ut,at),at++}return{Data:nt,Links:it}}async function st(ot,at){const ct=encode$B(ot),ut=await sha256$8.digest(ct),ft=CID$3.createV0(ut);await _.put(ft,ct);const ht=ot.Links.reduce((mt,gt)=>mt+(gt.Tsize||0),0)+ct.length;it[at]={Name:"",Tsize:ht,Hash:ft}}}}async function storeSet(_,o,$){const j=await storeItems(_,$.map(it=>({key:it}))),et=encode$B(j),tt=await sha256$8.digest(et),rt=CID$3.createV0(tt);await _.put(rt,et);const nt=j.Links.reduce((it,st)=>it+st.Tsize,0)+et.length;return{Name:o,Tsize:nt,Hash:rt}}async function pinsToDatastore(_,o,$,j){if(!await o.has(PIN_DS_KEY))return;const et=await o.get(PIN_DS_KEY),tt=CID$3.decode(et),rt=await _.get(tt),nt=decode$y(rt);let it=0;const st=await length$2(loadSet(_,nt,PinTypes.recursive))+await length$2(loadSet(_,nt,PinTypes.direct));for await(const ot of loadSet(_,nt,PinTypes.recursive)){it++;const at={depth:1/0};ot.version!==0&&(at.version=ot.version),ot.code!==code$9&&(at.codec=ot.code),await $.put(cidToKey$2(ot),encode$A(at)),j(it/st*100,`Migrated recursive pin ${ot}`)}for await(const ot of loadSet(_,nt,PinTypes.direct)){it++;const at={depth:0};ot.version!==0&&(at.version=ot.version),ot.code!==code$9&&(at.codec=ot.code),await $.put(cidToKey$2(ot),encode$A(at)),j(it/st*100,`Migrated direct pin ${ot}`)}await _.delete(tt),await o.delete(PIN_DS_KEY)}async function pinsToDAG(_,o,$,j){const et=[],tt=[];let rt=0;const nt=await length$2($.queryKeys({}));for await(const{key:ct,value:ut}of $.query({})){rt++;const ft=decode$x(ut),ht=CID$3.create(ft.version||0,ft.codec||code$9,decode$B(base32$6.decode("b"+ct.toString().toLowerCase().split("/").pop())));ft.depth===0?(j(rt/nt*100,`Reverted direct pin ${ht}`),tt.push(ht)):(j(rt/nt*100,`Reverted recursive pin ${ht}`),et.push(ht))}j(100,"Updating pin root");const it={Links:[await storeSet(_,PinTypes.direct,tt),await storeSet(_,PinTypes.recursive,et)]},st=encode$B(it),ot=await sha256$8.digest(st),at=CID$3.createV0(ot);await _.put(at,st),await o.put(PIN_DS_KEY,at.bytes)}async function process$1(_,o,$){const j=_.blocks,et=_.datastore,tt=_.pins;await j.open(),await et.open(),await tt.open();try{await $(j,et,tt,o)}finally{await tt.close(),await et.close(),await j.close()}}const migration$3={version:9,description:"Migrates pins to datastore",migrate:(_,o=()=>{})=>process$1(_,o,pinsToDatastore),revert:(_,o=()=>{})=>process$1(_,o,pinsToDAG)},CONFIG_KEY=new Key("/config"),VERSION_KEY=new Key("/version");function findLevelJs$1(_){let o=_;for(;o.db||o.child;)if(o=o.db||o.child,o.type==="level-js"||o.constructor.name==="Level")return o}async function hasWithFallback$1(_,o,$){const j=await o(_);if(j)return j;const et=findLevelJs$1($);return et?new Promise((tt,rt)=>{const nt=et.store("readonly").get(_.toString());nt.transaction.onabort=()=>{rt(nt.transaction.error)},nt.transaction.oncomplete=()=>{tt(!!nt.result)}}):!1}async function getWithFallback$1(_,o,$,j){if(await $(_))return o(_);const et=findLevelJs$1(j);if(!et)throw notFoundError();return new Promise((tt,rt)=>{const nt=et.store("readonly").get(_.toString());nt.transaction.onabort=()=>{rt(nt.transaction.error)},nt.transaction.oncomplete=()=>{if(nt.result)return tt(nt.result);rt(notFoundError())}})}function wrapStore(_){const o=_.get.bind(_),$=_.has.bind(_);return _.get=j=>getWithFallback$1(j,o,$,_),_.has=j=>hasWithFallback$1(j,$,_),_}function wrapBackends(_){return{..._,root:wrapStore(_.root),datastore:wrapStore(_.datastore),pins:wrapStore(_.pins),keys:wrapStore(_.keys)}}async function keysToBinary(_,o,$=()=>{}){const j=findLevelJs$1(o);if(!j){$(`${_} did not need an upgrade`);return}$(`Upgrading ${_}`),await withEach(j,(tt,rt)=>[{type:"del",key:tt},{type:"put",key:fromString$8(tt),value:rt}])}async function keysToStrings(_,o,$=()=>{}){const j=findLevelJs$1(o);if(!j){$(`${_} did not need a downgrade`);return}$(`Downgrading ${_}`),await withEach(j,(tt,rt)=>[{type:"del",key:tt},{type:"put",key:toString$a(tt),value:rt}])}function unwrap(_){return _.child?unwrap(_.child):_}async function process(_,o,$){const j=Object.entries(_).map(([rt,nt])=>({key:rt,backend:unwrap(nt)})).filter(({key:rt,backend:nt})=>nt.constructor.name==="LevelDatastore").map(({key:rt,backend:nt})=>({name:rt,store:nt}));o(0,`Migrating ${j.length} dbs`);let et=0;const tt=rt=>{o(Math.round(et/j.length*100),rt)};for(const{name:rt,store:nt}of j){await nt.open();try{await $(rt,nt,tt)}finally{et++,await nt.close()}}o(100,`Migrated ${j.length} dbs`)}const migration$2={version:10,description:"Migrates datastore-level keys to binary",migrate:(_,o=()=>{})=>process(_,o,keysToBinary),revert:(_,o=()=>{})=>process(_,o,keysToStrings)};function withEach(_,o){function $(j,et){const tt=_.store("readwrite"),rt=tt.transaction;let nt=0,it;rt.onabort=()=>et(it||rt.error||new Error("aborted by user")),rt.oncomplete=()=>et();function st(){const ot=j[nt++],at=ot.key;let ct;try{ct=ot.type==="del"?tt.delete(at):tt.put(ot.value,at)}catch(ut){it=ut,rt.abort();return}nt<j.length&&(ct.onsuccess=st)}st()}return new Promise((j,et)=>{const tt=_.iterator(),rt=it=>it;tt._deserializeKey=tt._deserializeValue=rt,nt();function nt(){const it=(st,ot,at)=>{if(st||ot===void 0){const ct=ut=>{if(ut){et(ut);return}j()};tt.end(ct);return}$(o(ot,at),nt)};tt.next(it)}})}const MFS_ROOT_KEY$1=new Key("/local/filesroot");async function storeMfsRootInDatastore(_,o=()=>{}){if(o(100,"Migrating MFS root to repo datastore"),await _.root.open(),await _.datastore.open(),await _.root.has(MFS_ROOT_KEY$1)){const $=await _.root.get(MFS_ROOT_KEY$1);await _.datastore.put(MFS_ROOT_KEY$1,$),await _.root.delete(MFS_ROOT_KEY$1)}await _.datastore.close(),await _.root.close(),o(100,"Stored MFS root in repo datastore")}async function storeMfsRootInRoot(_,o=()=>{}){if(o(100,"Migrating MFS root to repo root datastore"),await _.root.open(),await _.datastore.open(),await _.datastore.has(MFS_ROOT_KEY$1)){const $=await _.datastore.get(MFS_ROOT_KEY$1);await _.root.put(MFS_ROOT_KEY$1,$),await _.datastore.delete(MFS_ROOT_KEY$1)}await _.datastore.close(),await _.root.close(),o(100,"Stored MFS root in repo root datastore")}const migration$1={version:11,description:"Store mfs root in the datastore",migrate:storeMfsRootInDatastore,revert:storeMfsRootInRoot},$Reader$5=$protobuf.Reader,$Writer$5=$protobuf.Writer,$util$5=$protobuf.util,$root$5=$protobuf.roots.default||($protobuf.roots.default={}),Protocols=$root$5.Protocols=(()=>{function _(o){if(this.protocols=[],o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.protocols=$util$5.emptyArray,_.encode=function($,j){if(j||(j=$Writer$5.create()),$.protocols!=null&&$.protocols.length)for(var et=0;et<$.protocols.length;++et)j.uint32(10).string($.protocols[et]);return j},_.decode=function($,j){$ instanceof $Reader$5||($=$Reader$5.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$5.Protocols;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.protocols&&tt.protocols.length||(tt.protocols=[]),tt.protocols.push($.string());break;default:$.skipType(rt&7);break}}return tt},_.fromObject=function($){if($ instanceof $root$5.Protocols)return $;var j=new $root$5.Protocols;if($.protocols){if(!Array.isArray($.protocols))throw TypeError(".Protocols.protocols: array expected");j.protocols=[];for(var et=0;et<$.protocols.length;++et)j.protocols[et]=String($.protocols[et])}return j},_.toObject=function($,j){j||(j={});var et={};if((j.arrays||j.defaults)&&(et.protocols=[]),$.protocols&&$.protocols.length){et.protocols=[];for(var tt=0;tt<$.protocols.length;++tt)et.protocols[tt]=$.protocols[tt]}return et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})(),$Reader$4=$protobuf.Reader,$Writer$4=$protobuf.Writer,$util$4=$protobuf.util,$root$4=$protobuf.roots.default||($protobuf.roots.default={}),Addresses=$root$4.Addresses=(()=>{function _(o){if(this.addrs=[],o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.addrs=$util$4.emptyArray,_.prototype.certifiedRecord=null,_.encode=function($,j){if(j||(j=$Writer$4.create()),$.addrs!=null&&$.addrs.length)for(var et=0;et<$.addrs.length;++et)$root$4.Addresses.Address.encode($.addrs[et],j.uint32(10).fork()).ldelim();return $.certifiedRecord!=null&&Object.hasOwnProperty.call($,"certifiedRecord")&&$root$4.Addresses.CertifiedRecord.encode($.certifiedRecord,j.uint32(18).fork()).ldelim(),j},_.decode=function($,j){$ instanceof $Reader$4||($=$Reader$4.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$4.Addresses;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.addrs&&tt.addrs.length||(tt.addrs=[]),tt.addrs.push($root$4.Addresses.Address.decode($,$.uint32()));break;case 2:tt.certifiedRecord=$root$4.Addresses.CertifiedRecord.decode($,$.uint32());break;default:$.skipType(rt&7);break}}return tt},_.fromObject=function($){if($ instanceof $root$4.Addresses)return $;var j=new $root$4.Addresses;if($.addrs){if(!Array.isArray($.addrs))throw TypeError(".Addresses.addrs: array expected");j.addrs=[];for(var et=0;et<$.addrs.length;++et){if(typeof $.addrs[et]!="object")throw TypeError(".Addresses.addrs: object expected");j.addrs[et]=$root$4.Addresses.Address.fromObject($.addrs[et])}}if($.certifiedRecord!=null){if(typeof $.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");j.certifiedRecord=$root$4.Addresses.CertifiedRecord.fromObject($.certifiedRecord)}return j},_.toObject=function($,j){j||(j={});var et={};if((j.arrays||j.defaults)&&(et.addrs=[]),j.defaults&&(et.certifiedRecord=null),$.addrs&&$.addrs.length){et.addrs=[];for(var tt=0;tt<$.addrs.length;++tt)et.addrs[tt]=$root$4.Addresses.Address.toObject($.addrs[tt],j)}return $.certifiedRecord!=null&&$.hasOwnProperty("certifiedRecord")&&(et.certifiedRecord=$root$4.Addresses.CertifiedRecord.toObject($.certifiedRecord,j)),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.Address=function(){function o(j){if(j)for(var et=Object.keys(j),tt=0;tt<et.length;++tt)j[et[tt]]!=null&&(this[et[tt]]=j[et[tt]])}o.prototype.multiaddr=$util$4.newBuffer([]),o.prototype.isCertified=null;let $;return Object.defineProperty(o.prototype,"_isCertified",{get:$util$4.oneOfGetter($=["isCertified"]),set:$util$4.oneOfSetter($)}),o.encode=function(et,tt){return tt||(tt=$Writer$4.create()),et.multiaddr!=null&&Object.hasOwnProperty.call(et,"multiaddr")&&tt.uint32(10).bytes(et.multiaddr),et.isCertified!=null&&Object.hasOwnProperty.call(et,"isCertified")&&tt.uint32(16).bool(et.isCertified),tt},o.decode=function(et,tt){et instanceof $Reader$4||(et=$Reader$4.create(et));for(var rt=tt===void 0?et.len:et.pos+tt,nt=new $root$4.Addresses.Address;et.pos<rt;){var it=et.uint32();switch(it>>>3){case 1:nt.multiaddr=et.bytes();break;case 2:nt.isCertified=et.bool();break;default:et.skipType(it&7);break}}return nt},o.fromObject=function(et){if(et instanceof $root$4.Addresses.Address)return et;var tt=new $root$4.Addresses.Address;return et.multiaddr!=null&&(typeof et.multiaddr=="string"?$util$4.base64.decode(et.multiaddr,tt.multiaddr=$util$4.newBuffer($util$4.base64.length(et.multiaddr)),0):et.multiaddr.length&&(tt.multiaddr=et.multiaddr)),et.isCertified!=null&&(tt.isCertified=!!et.isCertified),tt},o.toObject=function(et,tt){tt||(tt={});var rt={};return tt.defaults&&(tt.bytes===String?rt.multiaddr="":(rt.multiaddr=[],tt.bytes!==Array&&(rt.multiaddr=$util$4.newBuffer(rt.multiaddr)))),et.multiaddr!=null&&et.hasOwnProperty("multiaddr")&&(rt.multiaddr=tt.bytes===String?$util$4.base64.encode(et.multiaddr,0,et.multiaddr.length):tt.bytes===Array?Array.prototype.slice.call(et.multiaddr):et.multiaddr),et.isCertified!=null&&et.hasOwnProperty("isCertified")&&(rt.isCertified=et.isCertified,tt.oneofs&&(rt._isCertified="isCertified")),rt},o.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},o}(),_.CertifiedRecord=function(){function o($){if($)for(var j=Object.keys($),et=0;et<j.length;++et)$[j[et]]!=null&&(this[j[et]]=$[j[et]])}return o.prototype.seq=$util$4.Long?$util$4.Long.fromBits(0,0,!0):0,o.prototype.raw=$util$4.newBuffer([]),o.encode=function(j,et){return et||(et=$Writer$4.create()),j.seq!=null&&Object.hasOwnProperty.call(j,"seq")&&et.uint32(8).uint64(j.seq),j.raw!=null&&Object.hasOwnProperty.call(j,"raw")&&et.uint32(18).bytes(j.raw),et},o.decode=function(j,et){j instanceof $Reader$4||(j=$Reader$4.create(j));for(var tt=et===void 0?j.len:j.pos+et,rt=new $root$4.Addresses.CertifiedRecord;j.pos<tt;){var nt=j.uint32();switch(nt>>>3){case 1:rt.seq=j.uint64();break;case 2:rt.raw=j.bytes();break;default:j.skipType(nt&7);break}}return rt},o.fromObject=function(j){if(j instanceof $root$4.Addresses.CertifiedRecord)return j;var et=new $root$4.Addresses.CertifiedRecord;return j.seq!=null&&($util$4.Long?(et.seq=$util$4.Long.fromValue(j.seq)).unsigned=!0:typeof j.seq=="string"?et.seq=parseInt(j.seq,10):typeof j.seq=="number"?et.seq=j.seq:typeof j.seq=="object"&&(et.seq=new $util$4.LongBits(j.seq.low>>>0,j.seq.high>>>0).toNumber(!0))),j.raw!=null&&(typeof j.raw=="string"?$util$4.base64.decode(j.raw,et.raw=$util$4.newBuffer($util$4.base64.length(j.raw)),0):j.raw.length&&(et.raw=j.raw)),et},o.toObject=function(j,et){et||(et={});var tt={};if(et.defaults){if($util$4.Long){var rt=new $util$4.Long(0,0,!0);tt.seq=et.longs===String?rt.toString():et.longs===Number?rt.toNumber():rt}else tt.seq=et.longs===String?"0":0;et.bytes===String?tt.raw="":(tt.raw=[],et.bytes!==Array&&(tt.raw=$util$4.newBuffer(tt.raw)))}return j.seq!=null&&j.hasOwnProperty("seq")&&(typeof j.seq=="number"?tt.seq=et.longs===String?String(j.seq):j.seq:tt.seq=et.longs===String?$util$4.Long.prototype.toString.call(j.seq):et.longs===Number?new $util$4.LongBits(j.seq.low>>>0,j.seq.high>>>0).toNumber(!0):j.seq),j.raw!=null&&j.hasOwnProperty("raw")&&(tt.raw=et.bytes===String?$util$4.base64.encode(j.raw,0,j.raw.length):et.bytes===Array?Array.prototype.slice.call(j.raw):j.raw),tt},o.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},o}(),_})(),$Reader$3=$protobuf.Reader,$Writer$3=$protobuf.Writer,$util$3=$protobuf.util,$root$3=$protobuf.roots.default||($protobuf.roots.default={}),Peer$1=$root$3.Peer=(()=>{function _($){if(this.addresses=[],this.protocols=[],this.metadata=[],$)for(var j=Object.keys($),et=0;et<j.length;++et)$[j[et]]!=null&&(this[j[et]]=$[j[et]])}_.prototype.addresses=$util$3.emptyArray,_.prototype.protocols=$util$3.emptyArray,_.prototype.metadata=$util$3.emptyArray,_.prototype.pubKey=null,_.prototype.peerRecordEnvelope=null;let o;return Object.defineProperty(_.prototype,"_pubKey",{get:$util$3.oneOfGetter(o=["pubKey"]),set:$util$3.oneOfSetter(o)}),Object.defineProperty(_.prototype,"_peerRecordEnvelope",{get:$util$3.oneOfGetter(o=["peerRecordEnvelope"]),set:$util$3.oneOfSetter(o)}),_.encode=function(j,et){if(et||(et=$Writer$3.create()),j.addresses!=null&&j.addresses.length)for(var tt=0;tt<j.addresses.length;++tt)$root$3.Address.encode(j.addresses[tt],et.uint32(10).fork()).ldelim();if(j.protocols!=null&&j.protocols.length)for(var tt=0;tt<j.protocols.length;++tt)et.uint32(18).string(j.protocols[tt]);if(j.metadata!=null&&j.metadata.length)for(var tt=0;tt<j.metadata.length;++tt)$root$3.Metadata.encode(j.metadata[tt],et.uint32(26).fork()).ldelim();return j.pubKey!=null&&Object.hasOwnProperty.call(j,"pubKey")&&et.uint32(34).bytes(j.pubKey),j.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(j,"peerRecordEnvelope")&&et.uint32(42).bytes(j.peerRecordEnvelope),et},_.decode=function(j,et){j instanceof $Reader$3||(j=$Reader$3.create(j));for(var tt=et===void 0?j.len:j.pos+et,rt=new $root$3.Peer;j.pos<tt;){var nt=j.uint32();switch(nt>>>3){case 1:rt.addresses&&rt.addresses.length||(rt.addresses=[]),rt.addresses.push($root$3.Address.decode(j,j.uint32()));break;case 2:rt.protocols&&rt.protocols.length||(rt.protocols=[]),rt.protocols.push(j.string());break;case 3:rt.metadata&&rt.metadata.length||(rt.metadata=[]),rt.metadata.push($root$3.Metadata.decode(j,j.uint32()));break;case 4:rt.pubKey=j.bytes();break;case 5:rt.peerRecordEnvelope=j.bytes();break;default:j.skipType(nt&7);break}}return rt},_.fromObject=function(j){if(j instanceof $root$3.Peer)return j;var et=new $root$3.Peer;if(j.addresses){if(!Array.isArray(j.addresses))throw TypeError(".Peer.addresses: array expected");et.addresses=[];for(var tt=0;tt<j.addresses.length;++tt){if(typeof j.addresses[tt]!="object")throw TypeError(".Peer.addresses: object expected");et.addresses[tt]=$root$3.Address.fromObject(j.addresses[tt])}}if(j.protocols){if(!Array.isArray(j.protocols))throw TypeError(".Peer.protocols: array expected");et.protocols=[];for(var tt=0;tt<j.protocols.length;++tt)et.protocols[tt]=String(j.protocols[tt])}if(j.metadata){if(!Array.isArray(j.metadata))throw TypeError(".Peer.metadata: array expected");et.metadata=[];for(var tt=0;tt<j.metadata.length;++tt){if(typeof j.metadata[tt]!="object")throw TypeError(".Peer.metadata: object expected");et.metadata[tt]=$root$3.Metadata.fromObject(j.metadata[tt])}}return j.pubKey!=null&&(typeof j.pubKey=="string"?$util$3.base64.decode(j.pubKey,et.pubKey=$util$3.newBuffer($util$3.base64.length(j.pubKey)),0):j.pubKey.length&&(et.pubKey=j.pubKey)),j.peerRecordEnvelope!=null&&(typeof j.peerRecordEnvelope=="string"?$util$3.base64.decode(j.peerRecordEnvelope,et.peerRecordEnvelope=$util$3.newBuffer($util$3.base64.length(j.peerRecordEnvelope)),0):j.peerRecordEnvelope.length&&(et.peerRecordEnvelope=j.peerRecordEnvelope)),et},_.toObject=function(j,et){et||(et={});var tt={};if((et.arrays||et.defaults)&&(tt.addresses=[],tt.protocols=[],tt.metadata=[]),j.addresses&&j.addresses.length){tt.addresses=[];for(var rt=0;rt<j.addresses.length;++rt)tt.addresses[rt]=$root$3.Address.toObject(j.addresses[rt],et)}if(j.protocols&&j.protocols.length){tt.protocols=[];for(var rt=0;rt<j.protocols.length;++rt)tt.protocols[rt]=j.protocols[rt]}if(j.metadata&&j.metadata.length){tt.metadata=[];for(var rt=0;rt<j.metadata.length;++rt)tt.metadata[rt]=$root$3.Metadata.toObject(j.metadata[rt],et)}return j.pubKey!=null&&j.hasOwnProperty("pubKey")&&(tt.pubKey=et.bytes===String?$util$3.base64.encode(j.pubKey,0,j.pubKey.length):et.bytes===Array?Array.prototype.slice.call(j.pubKey):j.pubKey,et.oneofs&&(tt._pubKey="pubKey")),j.peerRecordEnvelope!=null&&j.hasOwnProperty("peerRecordEnvelope")&&(tt.peerRecordEnvelope=et.bytes===String?$util$3.base64.encode(j.peerRecordEnvelope,0,j.peerRecordEnvelope.length):et.bytes===Array?Array.prototype.slice.call(j.peerRecordEnvelope):j.peerRecordEnvelope,et.oneofs&&(tt._peerRecordEnvelope="peerRecordEnvelope")),tt},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();$root$3.Address=(()=>{function _($){if($)for(var j=Object.keys($),et=0;et<j.length;++et)$[j[et]]!=null&&(this[j[et]]=$[j[et]])}_.prototype.multiaddr=$util$3.newBuffer([]),_.prototype.isCertified=null;let o;return Object.defineProperty(_.prototype,"_isCertified",{get:$util$3.oneOfGetter(o=["isCertified"]),set:$util$3.oneOfSetter(o)}),_.encode=function(j,et){return et||(et=$Writer$3.create()),j.multiaddr!=null&&Object.hasOwnProperty.call(j,"multiaddr")&&et.uint32(10).bytes(j.multiaddr),j.isCertified!=null&&Object.hasOwnProperty.call(j,"isCertified")&&et.uint32(16).bool(j.isCertified),et},_.decode=function(j,et){j instanceof $Reader$3||(j=$Reader$3.create(j));for(var tt=et===void 0?j.len:j.pos+et,rt=new $root$3.Address;j.pos<tt;){var nt=j.uint32();switch(nt>>>3){case 1:rt.multiaddr=j.bytes();break;case 2:rt.isCertified=j.bool();break;default:j.skipType(nt&7);break}}return rt},_.fromObject=function(j){if(j instanceof $root$3.Address)return j;var et=new $root$3.Address;return j.multiaddr!=null&&(typeof j.multiaddr=="string"?$util$3.base64.decode(j.multiaddr,et.multiaddr=$util$3.newBuffer($util$3.base64.length(j.multiaddr)),0):j.multiaddr.length&&(et.multiaddr=j.multiaddr)),j.isCertified!=null&&(et.isCertified=!!j.isCertified),et},_.toObject=function(j,et){et||(et={});var tt={};return et.defaults&&(et.bytes===String?tt.multiaddr="":(tt.multiaddr=[],et.bytes!==Array&&(tt.multiaddr=$util$3.newBuffer(tt.multiaddr)))),j.multiaddr!=null&&j.hasOwnProperty("multiaddr")&&(tt.multiaddr=et.bytes===String?$util$3.base64.encode(j.multiaddr,0,j.multiaddr.length):et.bytes===Array?Array.prototype.slice.call(j.multiaddr):j.multiaddr),j.isCertified!=null&&j.hasOwnProperty("isCertified")&&(tt.isCertified=j.isCertified,et.oneofs&&(tt._isCertified="isCertified")),tt},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();$root$3.Metadata=(()=>{function _(o){if(o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.key="",_.prototype.value=$util$3.newBuffer([]),_.encode=function($,j){return j||(j=$Writer$3.create()),$.key!=null&&Object.hasOwnProperty.call($,"key")&&j.uint32(10).string($.key),$.value!=null&&Object.hasOwnProperty.call($,"value")&&j.uint32(18).bytes($.value),j},_.decode=function($,j){$ instanceof $Reader$3||($=$Reader$3.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$3.Metadata;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.key=$.string();break;case 2:tt.value=$.bytes();break;default:$.skipType(rt&7);break}}return tt},_.fromObject=function($){if($ instanceof $root$3.Metadata)return $;var j=new $root$3.Metadata;return $.key!=null&&(j.key=String($.key)),$.value!=null&&(typeof $.value=="string"?$util$3.base64.decode($.value,j.value=$util$3.newBuffer($util$3.base64.length($.value)),0):$.value.length&&(j.value=$.value)),j},_.toObject=function($,j){j||(j={});var et={};return j.defaults&&(et.key="",j.bytes===String?et.value="":(et.value=[],j.bytes!==Array&&(et.value=$util$3.newBuffer(et.value)))),$.key!=null&&$.hasOwnProperty("key")&&(et.key=$.key),$.value!=null&&$.hasOwnProperty("value")&&(et.value=j.bytes===String?$util$3.base64.encode($.value,0,$.value.length):j.bytes===Array?Array.prototype.slice.call($.value):$.value),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();const $Reader$2=$protobuf.Reader,$Writer$2=$protobuf.Writer,$util$2=$protobuf.util,$root$2=$protobuf.roots.default||($protobuf.roots.default={}),Envelope$1=$root$2.Envelope=(()=>{function _(o){if(o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.publicKey=$util$2.newBuffer([]),_.prototype.payloadType=$util$2.newBuffer([]),_.prototype.payload=$util$2.newBuffer([]),_.prototype.signature=$util$2.newBuffer([]),_.encode=function($,j){return j||(j=$Writer$2.create()),$.publicKey!=null&&Object.hasOwnProperty.call($,"publicKey")&&j.uint32(10).bytes($.publicKey),$.payloadType!=null&&Object.hasOwnProperty.call($,"payloadType")&&j.uint32(18).bytes($.payloadType),$.payload!=null&&Object.hasOwnProperty.call($,"payload")&&j.uint32(26).bytes($.payload),$.signature!=null&&Object.hasOwnProperty.call($,"signature")&&j.uint32(42).bytes($.signature),j},_.decode=function($,j){$ instanceof $Reader$2||($=$Reader$2.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$2.Envelope;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.publicKey=$.bytes();break;case 2:tt.payloadType=$.bytes();break;case 3:tt.payload=$.bytes();break;case 5:tt.signature=$.bytes();break;default:$.skipType(rt&7);break}}return tt},_.fromObject=function($){if($ instanceof $root$2.Envelope)return $;var j=new $root$2.Envelope;return $.publicKey!=null&&(typeof $.publicKey=="string"?$util$2.base64.decode($.publicKey,j.publicKey=$util$2.newBuffer($util$2.base64.length($.publicKey)),0):$.publicKey.length&&(j.publicKey=$.publicKey)),$.payloadType!=null&&(typeof $.payloadType=="string"?$util$2.base64.decode($.payloadType,j.payloadType=$util$2.newBuffer($util$2.base64.length($.payloadType)),0):$.payloadType.length&&(j.payloadType=$.payloadType)),$.payload!=null&&(typeof $.payload=="string"?$util$2.base64.decode($.payload,j.payload=$util$2.newBuffer($util$2.base64.length($.payload)),0):$.payload.length&&(j.payload=$.payload)),$.signature!=null&&(typeof $.signature=="string"?$util$2.base64.decode($.signature,j.signature=$util$2.newBuffer($util$2.base64.length($.signature)),0):$.signature.length&&(j.signature=$.signature)),j},_.toObject=function($,j){j||(j={});var et={};return j.defaults&&(j.bytes===String?et.publicKey="":(et.publicKey=[],j.bytes!==Array&&(et.publicKey=$util$2.newBuffer(et.publicKey))),j.bytes===String?et.payloadType="":(et.payloadType=[],j.bytes!==Array&&(et.payloadType=$util$2.newBuffer(et.payloadType))),j.bytes===String?et.payload="":(et.payload=[],j.bytes!==Array&&(et.payload=$util$2.newBuffer(et.payload))),j.bytes===String?et.signature="":(et.signature=[],j.bytes!==Array&&(et.signature=$util$2.newBuffer(et.signature)))),$.publicKey!=null&&$.hasOwnProperty("publicKey")&&(et.publicKey=j.bytes===String?$util$2.base64.encode($.publicKey,0,$.publicKey.length):j.bytes===Array?Array.prototype.slice.call($.publicKey):$.publicKey),$.payloadType!=null&&$.hasOwnProperty("payloadType")&&(et.payloadType=j.bytes===String?$util$2.base64.encode($.payloadType,0,$.payloadType.length):j.bytes===Array?Array.prototype.slice.call($.payloadType):$.payloadType),$.payload!=null&&$.hasOwnProperty("payload")&&(et.payload=j.bytes===String?$util$2.base64.encode($.payload,0,$.payload.length):j.bytes===Array?Array.prototype.slice.call($.payload):$.payload),$.signature!=null&&$.hasOwnProperty("signature")&&(et.signature=j.bytes===String?$util$2.base64.encode($.signature,0,$.signature.length):j.bytes===Array?Array.prototype.slice.call($.signature):$.signature),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})(),$Reader$1=$protobuf.Reader,$Writer$1=$protobuf.Writer,$util$1=$protobuf.util,$root$1=$protobuf.roots.default||($protobuf.roots.default={}),PeerRecord$2=$root$1.PeerRecord=(()=>{function _(o){if(this.addresses=[],o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.peerId=$util$1.newBuffer([]),_.prototype.seq=$util$1.Long?$util$1.Long.fromBits(0,0,!0):0,_.prototype.addresses=$util$1.emptyArray,_.encode=function($,j){if(j||(j=$Writer$1.create()),$.peerId!=null&&Object.hasOwnProperty.call($,"peerId")&&j.uint32(10).bytes($.peerId),$.seq!=null&&Object.hasOwnProperty.call($,"seq")&&j.uint32(16).uint64($.seq),$.addresses!=null&&$.addresses.length)for(var et=0;et<$.addresses.length;++et)$root$1.PeerRecord.AddressInfo.encode($.addresses[et],j.uint32(26).fork()).ldelim();return j},_.decode=function($,j){$ instanceof $Reader$1||($=$Reader$1.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root$1.PeerRecord;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:tt.peerId=$.bytes();break;case 2:tt.seq=$.uint64();break;case 3:tt.addresses&&tt.addresses.length||(tt.addresses=[]),tt.addresses.push($root$1.PeerRecord.AddressInfo.decode($,$.uint32()));break;default:$.skipType(rt&7);break}}return tt},_.fromObject=function($){if($ instanceof $root$1.PeerRecord)return $;var j=new $root$1.PeerRecord;if($.peerId!=null&&(typeof $.peerId=="string"?$util$1.base64.decode($.peerId,j.peerId=$util$1.newBuffer($util$1.base64.length($.peerId)),0):$.peerId.length&&(j.peerId=$.peerId)),$.seq!=null&&($util$1.Long?(j.seq=$util$1.Long.fromValue($.seq)).unsigned=!0:typeof $.seq=="string"?j.seq=parseInt($.seq,10):typeof $.seq=="number"?j.seq=$.seq:typeof $.seq=="object"&&(j.seq=new $util$1.LongBits($.seq.low>>>0,$.seq.high>>>0).toNumber(!0))),$.addresses){if(!Array.isArray($.addresses))throw TypeError(".PeerRecord.addresses: array expected");j.addresses=[];for(var et=0;et<$.addresses.length;++et){if(typeof $.addresses[et]!="object")throw TypeError(".PeerRecord.addresses: object expected");j.addresses[et]=$root$1.PeerRecord.AddressInfo.fromObject($.addresses[et])}}return j},_.toObject=function($,j){j||(j={});var et={};if((j.arrays||j.defaults)&&(et.addresses=[]),j.defaults)if(j.bytes===String?et.peerId="":(et.peerId=[],j.bytes!==Array&&(et.peerId=$util$1.newBuffer(et.peerId))),$util$1.Long){var tt=new $util$1.Long(0,0,!0);et.seq=j.longs===String?tt.toString():j.longs===Number?tt.toNumber():tt}else et.seq=j.longs===String?"0":0;if($.peerId!=null&&$.hasOwnProperty("peerId")&&(et.peerId=j.bytes===String?$util$1.base64.encode($.peerId,0,$.peerId.length):j.bytes===Array?Array.prototype.slice.call($.peerId):$.peerId),$.seq!=null&&$.hasOwnProperty("seq")&&(typeof $.seq=="number"?et.seq=j.longs===String?String($.seq):$.seq:et.seq=j.longs===String?$util$1.Long.prototype.toString.call($.seq):j.longs===Number?new $util$1.LongBits($.seq.low>>>0,$.seq.high>>>0).toNumber(!0):$.seq),$.addresses&&$.addresses.length){et.addresses=[];for(var rt=0;rt<$.addresses.length;++rt)et.addresses[rt]=$root$1.PeerRecord.AddressInfo.toObject($.addresses[rt],j)}return et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.AddressInfo=function(){function o($){if($)for(var j=Object.keys($),et=0;et<j.length;++et)$[j[et]]!=null&&(this[j[et]]=$[j[et]])}return o.prototype.multiaddr=$util$1.newBuffer([]),o.encode=function(j,et){return et||(et=$Writer$1.create()),j.multiaddr!=null&&Object.hasOwnProperty.call(j,"multiaddr")&&et.uint32(10).bytes(j.multiaddr),et},o.decode=function(j,et){j instanceof $Reader$1||(j=$Reader$1.create(j));for(var tt=et===void 0?j.len:j.pos+et,rt=new $root$1.PeerRecord.AddressInfo;j.pos<tt;){var nt=j.uint32();switch(nt>>>3){case 1:rt.multiaddr=j.bytes();break;default:j.skipType(nt&7);break}}return rt},o.fromObject=function(j){if(j instanceof $root$1.PeerRecord.AddressInfo)return j;var et=new $root$1.PeerRecord.AddressInfo;return j.multiaddr!=null&&(typeof j.multiaddr=="string"?$util$1.base64.decode(j.multiaddr,et.multiaddr=$util$1.newBuffer($util$1.base64.length(j.multiaddr)),0):j.multiaddr.length&&(et.multiaddr=j.multiaddr)),et},o.toObject=function(j,et){et||(et={});var tt={};return et.defaults&&(et.bytes===String?tt.multiaddr="":(tt.multiaddr=[],et.bytes!==Array&&(tt.multiaddr=$util$1.newBuffer(tt.multiaddr)))),j.multiaddr!=null&&j.hasOwnProperty("multiaddr")&&(tt.multiaddr=et.bytes===String?$util$1.base64.encode(j.multiaddr,0,j.multiaddr.length):et.bytes===Array?Array.prototype.slice.call(j.multiaddr):j.multiaddr),tt},o.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},o}(),_})();$protobuf.util.Long=void 0;$protobuf.configure();async function storePeerUnderSingleDatastoreKey(_,o=()=>{}){o(0,"Storing each peerstore key under a single datastore key"),await _.datastore.open();const $={},j=[];for await(const{key:et,value:tt}of _.datastore.query({prefix:"/peers"})){j.push(et);const rt=et.toString(),[,nt,it,st,ot]=rt.split("/");if(nt==="peers"&&["protos","addrs","metadata","keys"].includes(it)&&st)if($[st]=$[st]||{addresses:[],protocols:[],metadata:[]},it==="protos"){const at=Protocols.decode(tt);$[st].protocols=at.protocols.sort()}else if(it==="addrs"){const at=Addresses.decode(tt);$[st].addresses=at.addrs.sort((ct,ut)=>multiaddr$3(ct.multiaddr).toString().localeCompare(multiaddr$3(ut.multiaddr).toString())),at.certifiedRecord&&at.certifiedRecord.raw&&($[st].peerRecordEnvelope=at.certifiedRecord.raw)}else it==="metadata"?$[st].metadata.push({key:ot,value:tt}):it==="keys"&&($[st].pubKey=tt)}o(33,"Read peer data from store");for(const et of j)await _.datastore.delete(et);o(66,"Removed existing peer data from store");for(const et of Object.keys($)){const tt=$[et];tt.metadata=tt.metadata.sort((nt,it)=>nt.key.localeCompare(it.key));const rt=Peer$1.encode(tt).finish();await _.datastore.put(new Key(`/peers/${et}`),rt)}await _.datastore.close(),o(100,"Stored each peerstore key under a single datastore key")}async function storePeerUnderMultipleDatastoreKeys(_,o=()=>{}){o(0,"Storing each peerstore key under a multiple datastore keys"),await _.datastore.open();const $={},j=[];for await(const{key:et,value:tt}of _.datastore.query({prefix:"/peers"})){j.push(et);const rt=et.toString(),[,,nt]=rt.split("/");$[nt]=Peer$1.decode(tt)}o(33,"Read peer data from store");for(const et of j)await _.datastore.delete(et);o(66,"Removed existing peer data from store");for(const[et,tt]of Object.entries($)){if(tt.protocols&&tt.protocols.length>0&&await _.datastore.put(new Key(`/peers/protos/${et}`),Protocols.encode({protocols:tt.protocols}).finish()),tt.addresses&&tt.addresses.length>0){const rt=tt.peerRecordEnvelope;let nt;if(rt){const it=Envelope$1.decode(rt),st=PeerRecord$2.decode(it.payload);nt={raw:rt,seq:st.seq}}await _.datastore.put(new Key(`/peers/addrs/${et}`),Addresses.encode({addrs:tt.addresses,certifiedRecord:nt}).finish())}if(tt.metadata&&tt.metadata.length>0)for(const{key:rt,value:nt}of tt.metadata)await _.datastore.put(new Key(`/peers/metadata/${et}/${rt}`),nt);tt.pubKey&&await _.datastore.put(new Key(`/peers/keys/${et}`),tt.pubKey)}await _.datastore.close(),o(100,"Stored each peerstore key under multiple datastore keys")}const migration={version:12,description:"Store each peerstore peer under a single datastore key",migrate:storePeerUnderSingleDatastoreKey,revert:storePeerUnderMultipleDatastoreKeys},emptyMigration={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},defaultMigrations=[Object.assign({version:1},emptyMigration),Object.assign({version:2},emptyMigration),Object.assign({version:3},emptyMigration),Object.assign({version:4},emptyMigration),Object.assign({version:5},emptyMigration),Object.assign({version:6},emptyMigration),Object.assign({version:7},emptyMigration),migration$4,migration$3,migration$2,migration$1,migration];class NonReversibleMigrationError extends Error{constructor(o){super(o),this.name="NonReversibleMigrationError",this.code=NonReversibleMigrationError.code,this.message=o}}NonReversibleMigrationError.code="ERR_NON_REVERSIBLE_MIGRATION";class NotInitializedRepoError extends Error{constructor(o){super(o),this.name="NotInitializedRepoError",this.code=NotInitializedRepoError.code,this.message=o}}NotInitializedRepoError.code="ERR_NOT_INITIALIZED_REPO";class RequiredParameterError extends Error{constructor(o){super(o),this.name="RequiredParameterError",this.code=RequiredParameterError.code,this.message=o}}RequiredParameterError.code="ERR_REQUIRED_PARAMETER";class InvalidValueError extends Error{constructor(o){super(o),this.name="InvalidValueError",this.code=InvalidValueError.code,this.message=o}}InvalidValueError.code="ERR_INVALID_VALUE";class MissingRepoOptionsError extends Error{constructor(o){super(o),this.name="MissingRepoOptionsError",this.code=MissingRepoOptionsError.code,this.message=o}}MissingRepoOptionsError.code="ERR_MISSING_REPO_OPTIONS";const Errors=Object.freeze(Object.defineProperty({__proto__:null,InvalidValueError,MissingRepoOptionsError,NonReversibleMigrationError,NotInitializedRepoError,RequiredParameterError},Symbol.toStringTag,{value:"Module"})),log$13=browserExports$1("ipfs:repo:migrator:repo:init");async function isRepoInitialized(_){if(!_)throw new MissingRepoOptionsError("Please pass repo options when trying to open a repo");const o=_.root;try{await o.open();const $=await o.has(VERSION_KEY),j=await o.has(CONFIG_KEY);return!$||!j?(log$13(`Version entry present: ${$}`),log$13(`Config entry present: ${j}`),!1):!0}catch($){return log$13("While checking if repo is initialized error was thrown: "+$.message),!1}finally{if(o!==void 0)try{await o.close()}catch{}}}async function getVersion(_){if(!await isRepoInitialized(_))throw new NotInitializedRepoError("Repo is not initialized!");const o=_.root;await o.open();try{return parseInt(toString$a(await o.get(VERSION_KEY)))}finally{await o.close()}}async function setVersion(_,o){if(!o)throw new MissingRepoOptionsError("Please pass repo options when trying to open a repo");const $=o.root;await $.open(),await $.put(VERSION_KEY,fromString$8(String(_))),await $.close()}const log$12=browserExports$1("ipfs:repo:migrator");function getLatestMigrationVersion(_){return _=_||defaultMigrations,!Array.isArray(_)||_.length===0?0:_[_.length-1].version}async function migrate(_,o,$,j,et={}){const tt=et.ignoreLock??!1,rt=et.onProgress,nt=et.isDryRun??!1,it=et.migrations??defaultMigrations;if(!_)throw new errors.RequiredParameterError("Path argument is required!");if(!$)throw new errors.RequiredParameterError("repoOptions argument is required!");if(!j)throw new errors.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(j)||j<=0)throw new errors.InvalidValueError("Version has to be positive integer!");o=wrapBackends(o);const st=await getVersion(o);if(st===j){log$12("Nothing to migrate.");return}if(st>j)throw new errors.InvalidValueError(`Current repo's version (${st}) is higher then toVersion (${j}), you probably wanted to revert it?`);verifyAvailableMigrations(it,st,j);let ot;!nt&&!tt&&(ot=await $.repoLock.lock(_));try{for(const at of it){if(j!==void 0&&at.version>j)break;if(!(at.version<=st)){log$12(`Migrating version ${at.version}`);try{if(!nt){let ct=()=>{};rt&&(ct=(ut,ft)=>rt(at.version,ut.toFixed(2),ft)),await at.migrate(o,ct)}}catch(ct){const ut=at.version-1;throw log$12(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${ut}`),await setVersion(ut,o),new Error(`During migration to version ${at.version} exception was raised: ${ct.stack||ct.message||ct}`)}log$12(`Migrating to version ${at.version} finished`)}}nt||await setVersion(j||getLatestMigrationVersion(it),o),log$12("Repo successfully migrated",j!==void 0?`to version ${j}!`:"to latest version!")}finally{!nt&&!tt&&ot&&await ot.close()}}async function revert(_,o,$,j,et={}){const tt=et.ignoreLock??!1,rt=et.onProgress,nt=et.isDryRun??!1,it=et.migrations??defaultMigrations;if(!_)throw new errors.RequiredParameterError("Path argument is required!");if(!$)throw new errors.RequiredParameterError("repoOptions argument is required!");if(!j)throw new errors.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(j)||j<=0)throw new errors.InvalidValueError("Version has to be positive integer!");o=wrapBackends(o);const st=await getVersion(o);if(st===j){log$12("Nothing to revert.");return}if(st<j)throw new errors.InvalidValueError(`Current repo's version (${st}) is lower then toVersion (${j}), you probably wanted to migrate it?`);verifyAvailableMigrations(it,j,st,!0);let ot;!nt&&!tt&&(ot=await $.repoLock.lock(_)),log$12(`Reverting from version ${st} to ${j}`);try{const at=it.slice().reverse();for(const ct of at){if(ct.version<=j)break;if(!(ct.version>st)){log$12(`Reverting migration version ${ct.version}`);try{if(!nt){let ut=()=>{};rt&&(ut=(ft,ht)=>rt(ct.version,ft.toFixed(2),ht)),await ct.revert(o,ut)}}catch(ut){const ft=ct.version;throw log$12(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${ft}`),await setVersion(ft,o),ut.message=`During reversion to version ${ct.version} exception was raised: ${ut.message}`,ut}log$12(`Reverting to version ${ct.version} finished`)}}nt||await setVersion(j,o),log$12(`All migrations successfully reverted to version ${j}!`)}finally{!nt&&!tt&&ot&&await ot.close()}}function verifyAvailableMigrations(_,o,$,j=!1){let et=0;for(const tt of _){if(tt.version>$)break;if(tt.version>o){if(j&&!tt.revert)throw new errors.NonReversibleMigrationError(`It is not possible to revert to version ${o} because migration version ${tt.version} is not reversible. Cancelling reversion.`);et++}}if(et!==$-o)throw new errors.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${o} to ${$}`)}const errors=Errors;var bytesExports={},bytes$1={get exports(){return bytesExports},set exports(_){bytesExports=_}};/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */bytes$1.exports=bytes;bytesExports.format=format$1;bytesExports.parse=parse$3;var formatThousandsRegExp=/\B(?=(\d{3})+(?!\d))/g,formatDecimalsRegExp=/(?:\.0*|(\.[^0]+)0+)$/,map$2={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},parseRegExp=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function bytes(_,o){return typeof _=="string"?parse$3(_):typeof _=="number"?format$1(_,o):null}function format$1(_,o){if(!Number.isFinite(_))return null;var $=Math.abs(_),j=o&&o.thousandsSeparator||"",et=o&&o.unitSeparator||"",tt=o&&o.decimalPlaces!==void 0?o.decimalPlaces:2,rt=!!(o&&o.fixedDecimals),nt=o&&o.unit||"";(!nt||!map$2[nt.toLowerCase()])&&($>=map$2.pb?nt="PB":$>=map$2.tb?nt="TB":$>=map$2.gb?nt="GB":$>=map$2.mb?nt="MB":$>=map$2.kb?nt="KB":nt="B");var it=_/map$2[nt.toLowerCase()],st=it.toFixed(tt);return rt||(st=st.replace(formatDecimalsRegExp,"$1")),j&&(st=st.split(".").map(function(ot,at){return at===0?ot.replace(formatThousandsRegExp,j):ot}).join(".")),st+et+nt}function parse$3(_){if(typeof _=="number"&&!isNaN(_))return _;if(typeof _!="string")return null;var o=parseRegExp.exec(_),$,j="b";return o?($=parseFloat(o[1]),j=o[4].toLowerCase()):($=parseInt(_,10),j="b"),isNaN($)?null:Math.floor(map$2[j]*$)}class LockExistsError extends Error{constructor(o){super(o),this.name="LockExistsError",this.code=LockExistsError.code}}LockExistsError.code="ERR_LOCK_EXISTS";class NotFoundError extends Error{constructor(o){super(o),this.name="NotFoundError",this.code=NotFoundError.code}}NotFoundError.code="ERR_NOT_FOUND";class InvalidRepoVersionError extends Error{constructor(o){super(o),this.name="InvalidRepoVersionError",this.code=InvalidRepoVersionError.code}}InvalidRepoVersionError.code="ERR_INVALID_REPO_VERSION";const ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED",ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN",ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED";async function hasWithFallback(_,o,$){const j=await o(_);if(j)return j;const et=findLevelJs($);return et?new Promise((tt,rt)=>{const nt=et.store("readonly").get(_.toString());nt.transaction.onabort=()=>{rt(nt.transaction.error)},nt.transaction.oncomplete=()=>{tt(!!nt.result)}}):!1}async function getWithFallback(_,o,$,j){if(await $(_))return o(_);const et=findLevelJs(j);if(!et)throw new NotFoundError;return new Promise((tt,rt)=>{const nt=et.store("readonly").get(_.toString());nt.transaction.onabort=()=>{rt(nt.transaction.error)},nt.transaction.oncomplete=()=>{if(nt.result)return tt(nt.result);rt(new NotFoundError)}})}function findLevelJs(_){let o=_;for(;o.db||o.child;)if(o=o.db||o.child,o.type==="level-js"||o.constructor.name==="Level")return o}const log$11=browserExports$1("ipfs:repo:version"),versionKey=new Key("version");function version$1(_){return{async exists(){return hasWithFallback(versionKey,_.has.bind(_),_)},async get(){const o=await getWithFallback(versionKey,_.get.bind(_),_.has.bind(_),_);return parseInt(toString$a(o),10)},set(o){return _.put(versionKey,fromString$8(String(o)))},async check(o){const $=await this.get();return log$11("comparing version: %s and %s",$,o),$===o||($===6&&o===7||o===6&&$===7)}}}const Queue$1=PQueue.default?PQueue.default:PQueue,configKey=new Key("config");function config$1(_){const o=new Queue$1({concurrency:1}),$={async getAll(tt={}){const rt=await getWithFallback(configKey,_.get.bind(_),_.has.bind(_),_);return JSON.parse(toString$a(rt))},async get(tt,rt={}){if(tt==null)throw new NotFoundError(`Key ${tt} does not exist in config`);const nt=await this.getAll(rt),it=objectSafeGet(nt,tt);if(it===void 0)throw new NotFoundError(`Key ${tt} does not exist in config`);return it},set(tt,rt,nt={}){if(typeof tt!="string"&&!(tt instanceof String))throw errCode(new Error("Invalid key type: "+typeof tt),"ERR_INVALID_KEY");if(rt===void 0||rt instanceof Uint8Array)throw errCode(new Error("Invalid value type: "+typeof rt),"ERR_INVALID_VALUE");return o.add(()=>j({key:tt,value:rt},nt.signal))},replace(tt,rt={}){if(!tt||tt instanceof Uint8Array)throw errCode(new Error("Invalid value type: "+typeof tt),"ERR_INVALID_VALUE");return o.add(()=>j({key:void 0,value:tt},rt.signal))},async exists(){return hasWithFallback(configKey,_.has.bind(_),_)}};return $;async function j(tt,rt){if(rt&&rt.aborted)return;const nt=tt.key,it=tt.value;if(nt){const st=await $.getAll();return typeof st=="object"&&st!==null&&objectSafeSet(st,nt,it),et(st)}return et(it)}function et(tt){const rt=fromString$8(JSON.stringify(tt,null,2));return _.put(configKey,rt)}}function isPlainObject(_){if(typeof _!="object"||_===null)return!1;const o=Object.getPrototypeOf(_);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in _)&&!(Symbol.iterator in _)}function sortKeys(_,o={}){if(!isPlainObject(_)&&!Array.isArray(_))throw new TypeError("Expected a plain object or array");const{deep:$,compare:j}=o,et=[],tt=[],rt=it=>{const st=et.indexOf(it);if(st!==-1)return tt[st];const ot=[];return et.push(it),tt.push(ot),ot.push(...it.map(at=>Array.isArray(at)?rt(at):isPlainObject(at)?nt(at):at)),ot},nt=it=>{const st=et.indexOf(it);if(st!==-1)return tt[st];const ot={},at=Object.keys(it).sort(j);et.push(it),tt.push(ot);for(const ct of at){const ut=it[ct];let ft;$&&Array.isArray(ut)?ft=rt(ut):ft=$&&isPlainObject(ut)?nt(ut):ut,Object.defineProperty(ot,ct,{...Object.getOwnPropertyDescriptor(it,ct),value:ft})}return ot};return Array.isArray(_)?$?rt(_):_.slice():nt(_)}const specKey=new Key("datastore_spec");function spec(_){return{exists(){return _.has(specKey)},async get(){const o=await _.get(specKey);return JSON.parse(toString$a(o))},async set(o){return _.put(specKey,fromString$8(JSON.stringify(sortKeys(o,{deep:!0}))))}}}const apiFile=new Key("api");function apiAddr(_){return{async get(){const o=await _.get(apiFile);return o&&o.toString()},set(o){return _.put(apiFile,fromString$8(o.toString()))},delete(){return _.delete(apiFile)}}}function createIdStore(_){return{open(){return _.open()},close(){return _.close()},query(o,$){return _.query(o,$)},queryKeys(o,$){return _.queryKeys(o,$)},async get(o,$){const j=extractContents(o);return j.isIdentity?Promise.resolve(j.digest):_.get(o,$)},async*getMany(o,$){for await(const j of o)yield this.get(j,$)},async put(o,$,j){const{isIdentity:et}=extractContents(o);et||await _.put(o,$,j)},async*putMany(o,$){const j=pushable({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await drain(_.putMany(async function*(){for await(const{key:tt,value:rt}of o)extractContents(tt).isIdentity||(yield{key:tt,value:rt}),j.push({key:tt,value:rt})}())),j.end()}catch(tt){j.end(tt)}}),yield*j},has(o,$){const{isIdentity:j}=extractContents(o);return j?Promise.resolve(!0):_.has(o,$)},delete(o,$){const{isIdentity:j}=extractContents(o);return j?Promise.resolve():_.delete(o,$)},deleteMany(o,$){return _.deleteMany(filter$1(o,j=>!extractContents(j).isIdentity),$)},batch(){const o=_.batch();return{put($,j){const{isIdentity:et}=extractContents($);et||o.put($,j)},delete($){const{isIdentity:j}=extractContents($);j||o.delete($)},commit:$=>o.commit($)}}}}function extractContents(_){const o=CID$3.asCID(_);if(o==null)throw errCode(new Error("Not a valid cid"),"ERR_INVALID_CID");return o.multihash.code!==identity$3.code?{isIdentity:!1}:{isIdentity:!0,digest:o.multihash.digest}}const log$10=browserExports$1("ipfs:repo:lock:memory"),lockFile="repo.lock",LOCKS={};async function lock(_){const o=_+"/"+lockFile;if(log$10("locking %s",o),LOCKS[o]===!0)throw new LockExistsError(`Lock already being held for file: ${o}`);return LOCKS[o]=!0,{async close(){LOCKS[o]&&delete LOCKS[o]}}}async function locked(_){const o=_+"/"+lockFile;return log$10(`checking lock: ${o}`),!!LOCKS[o]}const MemoryLock={lock,locked},defaultOptions$6={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:MemoryLock},defaultDatastore={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function cidToKey$1(_){const o=CID$3.asCID(_);if(o==null)throw errCode(new Error("Not a valid cid"),"ERR_INVALID_CID");const $=base32$6.encode(o.multihash.bytes);return new Key("/"+$.slice(1).toUpperCase(),!1)}function keyToMultihash(_){return decode$B(base32$6.decode(`b${_.toString().toLowerCase().substring(1)}`))}const log$$=browserExports$1("ipfs:repo:utils:walk-dag");async function*walkDag(_,o,$,j){try{const et=await o.get(_,j),tt=await $(_.code),rt=createUnsafe({bytes:et,cid:_,codec:tt});for(const[,nt]of rt.links())yield nt,yield*walkDag(nt,o,$,j)}catch(et){throw log$$("Could not walk DAG for CID",_.toString(),et),et}}class QuickLRU extends Map{constructor(o={}){if(super(),!(o.maxSize&&o.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof o.maxAge=="number"&&o.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=o.maxSize,this.maxAge=o.maxAge||Number.POSITIVE_INFINITY,this.onEviction=o.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(o){if(typeof this.onEviction=="function")for(const[$,j]of o)this.onEviction($,j.value)}_deleteIfExpired(o,$){return typeof $.expiry=="number"&&$.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(o,$.value),this.delete(o)):!1}_getOrDeleteIfExpired(o,$){if(this._deleteIfExpired(o,$)===!1)return $.value}_getItemValue(o,$){return $.expiry?this._getOrDeleteIfExpired(o,$):$.value}_peek(o,$){const j=$.get(o);return this._getItemValue(o,j)}_set(o,$){this.cache.set(o,$),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(o,$){this.oldCache.delete(o),this._set(o,$)}*_entriesAscending(){for(const o of this.oldCache){const[$,j]=o;this.cache.has($)||this._deleteIfExpired($,j)===!1&&(yield o)}for(const o of this.cache){const[$,j]=o;this._deleteIfExpired($,j)===!1&&(yield o)}}get(o){if(this.cache.has(o)){const $=this.cache.get(o);return this._getItemValue(o,$)}if(this.oldCache.has(o)){const $=this.oldCache.get(o);if(this._deleteIfExpired(o,$)===!1)return this._moveToRecent(o,$),$.value}}set(o,$,{maxAge:j=this.maxAge}={}){const et=typeof j=="number"&&j!==Number.POSITIVE_INFINITY?Date.now()+j:void 0;this.cache.has(o)?this.cache.set(o,{value:$,expiry:et}):this._set(o,{value:$,expiry:et})}has(o){return this.cache.has(o)?!this._deleteIfExpired(o,this.cache.get(o)):this.oldCache.has(o)?!this._deleteIfExpired(o,this.oldCache.get(o)):!1}peek(o){if(this.cache.has(o))return this._peek(o,this.cache);if(this.oldCache.has(o))return this._peek(o,this.oldCache)}delete(o){const $=this.cache.delete(o);return $&&this._size--,this.oldCache.delete(o)||$}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(o){if(!(o&&o>0))throw new TypeError("`maxSize` must be a number greater than 0");const $=[...this._entriesAscending()],j=$.length-o;j<0?(this.cache=new Map($),this.oldCache=new Map,this._size=$.length):(j>0&&this._emitEvictions($.slice(0,j)),this.oldCache=new Map($.slice(j)),this.cache=new Map,this._size=0),this.maxSize=o}*keys(){for(const[o]of this)yield o}*values(){for(const[,o]of this)yield o}*[Symbol.iterator](){for(const o of this.cache){const[$,j]=o;this._deleteIfExpired($,j)===!1&&(yield[$,j.value])}for(const o of this.oldCache){const[$,j]=o;this.cache.has($)||this._deleteIfExpired($,j)===!1&&(yield[$,j.value])}}*entriesDescending(){let o=[...this.cache];for(let $=o.length-1;$>=0;--$){const j=o[$],[et,tt]=j;this._deleteIfExpired(et,tt)===!1&&(yield[et,tt.value])}o=[...this.oldCache];for(let $=o.length-1;$>=0;--$){const j=o[$],[et,tt]=j;this.cache.has(et)||this._deleteIfExpired(et,tt)===!1&&(yield[et,tt.value])}}*entriesAscending(){for(const[o,$]of this._entriesAscending())yield[o,$.value]}get size(){if(!this._size)return this.oldCache.size;let o=0;for(const $ of this.oldCache.keys())this.cache.has($)||o++;return Math.min(this._size+o,this.maxSize)}entries(){return this.entriesAscending()}forEach(o,$=this){for(const[j,et]of this.entriesAscending())o.call($,et,j,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}const CID_CACHE_MAX_SIZE=2048;function invalidPinTypeErr(_){const o=`Invalid type '${_}', must be one of {direct, indirect, recursive, all}`;return errCode(new Error(o),"ERR_INVALID_PIN_TYPE")}class PinManager{constructor({pinstore:o,blockstore:$,loadCodec:j}){this.pinstore=o,this.blockstore=$,this.loadCodec=j,this.log=browserExports$1("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(o,$={}){await this.blockstore.get(o,$);const j={depth:0};return o.version!==0&&(j.version=o.version),o.code!==code$9&&(j.codec=o.code),$.metadata&&(j.metadata=$.metadata),this.pinstore.put(cidToKey$1(o),encode$A(j))}unpin(o,$){return this.pinstore.delete(cidToKey$1(o),$)}async pinRecursively(o,$={}){await this.fetchCompleteDag(o,$);const j={depth:1/0};o.version!==0&&(j.version=o.version),o.code!==code$9&&(j.codec=o.code),$.metadata&&(j.metadata=$.metadata),await this.pinstore.put(cidToKey$1(o),encode$A(j))}async*directKeys(o){for await(const $ of this.pinstore.query({filters:[j=>decode$x(j.value).depth===0]})){const j=decode$x($.value),et=j.version||0,tt=j.codec!=null?j.codec:code$9,rt=keyToMultihash($.key);yield{cid:CID$3.create(et,tt,rt),metadata:j.metadata}}}async*recursiveKeys(o){for await(const $ of this.pinstore.query({filters:[j=>decode$x(j.value).depth===1/0]})){const j=decode$x($.value),et=j.version||0,tt=j.codec!=null?j.codec:code$9,rt=keyToMultihash($.key);yield{cid:CID$3.create(et,tt,rt),metadata:j.metadata}}}async*indirectKeys(o){for await(const{cid:$}of this.recursiveKeys())for await(const j of walkDag($,this.blockstore,this.loadCodec,o)){const et=[PinTypes$1.recursive];(await this.isPinnedWithType(j,et)).pinned||(yield j)}}async isPinnedWithType(o,$,j){Array.isArray($)||($=[$]);const et=$.includes(PinTypes$1.all),tt=$.includes(PinTypes$1.direct),rt=$.includes(PinTypes$1.recursive),nt=$.includes(PinTypes$1.indirect);if(rt||tt||et){const ot=await first(this.pinstore.query({prefix:cidToKey$1(o).toString(),filters:[at=>{if(et)return!0;const ct=decode$x(at.value);return $.includes(ct.depth===0?PinTypes$1.direct:PinTypes$1.recursive)}],limit:1}));if(ot){const at=decode$x(ot.value);return{cid:o,pinned:!0,reason:at.depth===0?PinTypes$1.direct:PinTypes$1.recursive,metadata:at.metadata}}}const it=this;async function*st(ot,at){for await(const{cid:ct}of at)for await(const ut of walkDag(ct,it.blockstore,it.loadCodec))if(ut.equals(ot)){yield ct;return}}if(et||nt){const ot=await first(st(o,this.recursiveKeys()));if(ot)return{cid:o,pinned:!0,reason:PinTypes$1.indirect,parent:ot}}return{cid:o,pinned:!1}}async fetchCompleteDag(o,$={}){const j=new QuickLRU({maxSize:$.cidCacheMaxSize??CID_CACHE_MAX_SIZE}),et=async(tt,rt)=>{if(j.has(tt.toString()))return;j.set(tt.toString(),!0);const nt=await this.blockstore.get(tt,rt),it=await this.loadCodec(tt.code),st=createUnsafe({bytes:nt,cid:tt,codec:it});await Promise.all([...st.links()].map(([,ot])=>et(ot,rt)))};await et(o,$)}static checkPinType(o){if(typeof o!="string"||!Object.keys(PinTypes$1).includes(o))throw invalidPinTypeErr(o);return!0}}function createPinnedBlockstore(_,o){return{open(){return o.open()},close(){return o.close()},query($,j){return o.query($,j)},queryKeys($,j){return o.queryKeys($,j)},async get($,j){return o.get($,j)},async*getMany($,j){yield*o.getMany($,j)},async put($,j,et){await o.put($,j,et)},async*putMany($,j){yield*o.putMany($,j)},has($,j){return o.has($,j)},async delete($,j){return await ensureNotPinned($,_),o.delete($,j)},deleteMany($,j){return o.deleteMany(map$3($,async et=>(await ensureNotPinned(et,_),et)),j)},batch(){return o.batch()}}}async function ensureNotPinned(_,o){const{pinned:$,reason:j}=await o.isPinnedWithType(_,PinTypes$1.all);if($)throw errCode(new Error(`pinned: ${j}`),"ERR_BLOCK_PINNED")}const log$_=browserExports$1("ipfs:repo:gc"),ERR_NOT_FOUND=notFoundError().code,BLOCK_RM_CONCURRENCY=256,MFS_ROOT_KEY=new Key("/local/filesroot");function gc({gcLock:_,pins:o,blockstore:$,root:j,loadCodec:et}){async function*tt(){const rt=Date.now();log$_("Creating set of marked blocks");const nt=await _.writeLock();try{const it=await createMarkedSet({pins:o,blockstore:$,root:j,loadCodec:et}),st=$.queryKeys({});yield*deleteUnmarkedBlocks({blockstore:$},it,st),log$_(`Complete (${Date.now()-rt}ms)`)}finally{nt()}}return tt}async function createMarkedSet({pins:_,blockstore:o,loadCodec:$,root:j}){const et=async function*(){let nt;try{nt=await j.get(MFS_ROOT_KEY)}catch(st){if(st.code===ERR_NOT_FOUND){log$_("No blocks in MFS");return}throw st}const it=CID$3.decode(nt);yield it,yield*walkDag(it,o,$)}(),tt=merge$1(map$3(_.recursiveKeys(),({cid:nt})=>nt),_.indirectKeys(),map$3(_.directKeys(),({cid:nt})=>nt),et),rt=new Set;for await(const nt of merge$1(tt,et))rt.add(base32$6.encode(nt.multihash.bytes));return rt}async function*deleteUnmarkedBlocks({blockstore:_},o,$){let j=0,et=0;yield*pipe(parallelBatch(map$3($,async rt=>async function(){j++;try{const it=base32$6.encode(rt.multihash.bytes);if(o.has(it))return null;try{await _.delete(rt),et++}catch(st){return{err:new Error(`Could not delete block with CID ${rt}: ${st.message}`)}}return{cid:rt}}catch(it){const st=`Could delete block with CID ${rt}`;return log$_(st,it),{err:new Error(st+`: ${it.message}`)}}}),BLOCK_RM_CONCURRENCY),rt=>filter$1(rt,Boolean)),log$_(`Marked set has ${o.size} unique blocks. Blockstore has ${j} blocks. Deleted ${et} blocks.`)}const log$Z=browserExports$1("ipfs:repo"),noLimit=Number.MAX_SAFE_INTEGER,AUTO_MIGRATE_CONFIG_KEY="repoAutoMigrate";class Repo{constructor(o,$,j,et){if(typeof o!="string")throw new Error("missing repo path");if(typeof $!="function")throw new Error("missing codec loader");this.options=mergeOptions$g(defaultOptions$6,et),this.closed=!0,this.path=o,this.root=j.root,this.datastore=j.datastore,this.keys=j.keys;const tt=j.blocks,rt=j.pins;this.pins=new PinManager({pinstore:rt,blockstore:tt,loadCodec:$});const nt=createPinnedBlockstore(this.pins,tt);this.blocks=createIdStore(nt),this.version=version$1(this.root),this.config=config$1(this.root),this.spec=spec(this.root),this.apiAddr=apiAddr(this.root),this.gcLock=createMortice({name:o,singleProcess:this.options.repoOwner!==!1}),this.gc=gc({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:$})}async init(o){log$Z("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(buildConfig(o)),await this.spec.set(buildDatastoreSpec(o)),await this.version.set(repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw errCode(new Error("repo is already open"),ERR_REPO_ALREADY_OPEN);log$Z("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),log$Z("acquired repo.lock"),!await this.version.check(repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");log$Z("creating datastore"),await this.datastore.open(),log$Z("creating blocks"),await this.blocks.open(),log$Z("creating keystore"),await this.keys.open(),log$Z("creating pins"),await this.pins.pinstore.open(),this.closed=!1,log$Z("all opened")}catch(o){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch($){log$Z("error removing lock",$)}throw o}}async _openRoot(){try{await this.root.open()}catch(o){if(o.message!=="Already open")throw o}}async _openLock(){const o=await this.options.repoLock.lock(this.path);if(typeof o.close!="function")throw errCode(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return o}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){log$Z("init check");let o;try{[o]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch($){throw $.code==="ERR_NOT_FOUND"?errCode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path}):$}if(!o)throw errCode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw errCode(new Error("repo is already closed"),ERR_REPO_ALREADY_CLOSED);log$Z("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(o){if(o.code!==ERR_REPO_NOT_INITIALIZED&&!o.message.startsWith("ENOENT"))throw o}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(o=>o&&o.close())),log$Z("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[o,$,j,et,tt]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),getSize(this.datastore),getSize(this.keys)]),rt=$.size+et+tt;return{repoPath:this.path,storageMax:o,version:j,numObjects:$.count,repoSize:rt}}throw errCode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let o;try{o=await this.config.get(AUTO_MIGRATE_CONFIG_KEY)}catch($){if($.code===NotFoundError.code)o=!0;else throw $}return o}async _migrate(o,$){return await this.version.get()>o?(log$Z(`reverting to version ${o}`),revert(this.path,$,this.options,o,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(log$Z(`migrating to version ${o}`),migrate(this.path,$,this.options,o,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const o=await this.config.get("Datastore.StorageMax");return BigInt(bytesExports(o))}catch{return BigInt(noLimit)}}async _blockStat(){let o=BigInt(0),$=BigInt(0);if(this.blocks)for await(const{key:j,value:et}of this.blocks.query({}))o+=BigInt(1),$+=BigInt(et.byteLength),$+=BigInt(j.bytes.byteLength);return{count:o,size:$}}}async function getSize(_){let o=BigInt(0);for await(const $ of _.query({}))o+=BigInt($.value.byteLength),o+=BigInt($.key.uint8Array().byteLength);return o}function createRepo$2(_,o,$,j){return new Repo(_,o,$,j)}function buildConfig(_){return _.Datastore=Object.assign({},defaultDatastore,objectSafeGet(_,"datastore")),_}function buildDatastoreSpec(_){const o={...defaultDatastore.Spec,...objectSafeGet(_,"Datastore.Spec")};return{type:o.type,mounts:o.mounts.map($=>({mountpoint:$.mountpoint,type:$.child.type,path:$.child.path,shardFunc:$.child.shardFunc}))}}async function*sort(_,o){yield*(await all$1(_)).sort(o)}class LevelDatastore extends BaseDatastore{constructor(o,$={}){super(),this.db=typeof o=="string"?new Level(o,{...$,keyEncoding:"utf8",valueEncoding:"view"}):o,this.opts={createIfMissing:!0,compression:!1,...$}}async open(){try{await this.db.open(this.opts)}catch(o){throw dbOpenFailedError(o)}}async put(o,$){try{await this.db.put(o.toString(),$)}catch(j){throw dbWriteFailedError(j)}}async get(o){let $;try{$=await this.db.get(o.toString())}catch(j){throw j.notFound?notFoundError(j):dbWriteFailedError(j)}return $}async has(o){try{await this.db.get(o.toString())}catch($){if($.notFound)return!1;throw $}return!0}async delete(o){try{await this.db.del(o.toString())}catch($){throw dbDeleteFailedError($)}}close(){return this.db&&this.db.close()}batch(){const o=[];return{put:($,j)=>{o.push({type:"put",key:$.toString(),value:j})},delete:$=>{o.push({type:"del",key:$.toString()})},commit:()=>this.db.batch(o)}}query(o){let $=this._query({values:!0,prefix:o.prefix});Array.isArray(o.filters)&&($=o.filters.reduce((tt,rt)=>filter$1(tt,rt),$)),Array.isArray(o.orders)&&($=o.orders.reduce((tt,rt)=>sort(tt,rt),$));const{offset:j,limit:et}=o;if(j){let tt=0;$=filter$1($,()=>tt++>=j)}return et&&($=take($,et)),$}queryKeys(o){let $=map$3(this._query({values:!1,prefix:o.prefix}),({key:tt})=>tt);Array.isArray(o.filters)&&($=o.filters.reduce((tt,rt)=>filter$1(tt,rt),$)),Array.isArray(o.orders)&&($=o.orders.reduce((tt,rt)=>sort(tt,rt),$));const{offset:j,limit:et}=o;if(j){let tt=0;$=filter$1($,()=>tt++>=j)}return et&&($=take($,et)),$}_query(o){const $={keys:!0,keyEncoding:"buffer",values:o.values};if(o.prefix!=null){const et=o.prefix.toString();$.gte=et,$.lt=et+""}const j=this.db.iterator($);if(j[Symbol.asyncIterator])return levelIteratorToIterator(j);if(j.next!=null&&j.end!=null)return oldLevelIteratorToIterator(j);throw new Error("Level returned incompatible iterator")}}async function*levelIteratorToIterator(_){for await(const[o,$]of _)yield{key:new Key(o,!1),value:$};await _.close()}function oldLevelIteratorToIterator(_){return{[Symbol.asyncIterator](){return{next:()=>new Promise((o,$)=>{_.next((j,et,tt)=>{if(j)return $(j);if(et==null)return _.end(rt=>{if(rt)return $(rt);o({done:!0,value:void 0})});o({done:!1,value:{key:new Key(et,!1),value:tt}})})}),return:()=>new Promise((o,$)=>{_.end(j=>{if(j)return $(j);o({done:!0,value:void 0})})})}}}}const sortAll=(_,o)=>async function*(){yield*(await all$1(_)).sort(o)}();class BaseBlockstore{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(o,$,j){return Promise.reject(new Error(".put is not implemented"))}get(o,$){return Promise.reject(new Error(".get is not implemented"))}has(o,$){return Promise.reject(new Error(".has is not implemented"))}delete(o,$){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(o,$={}){for await(const{key:j,value:et}of o)await this.put(j,et,$),yield{key:j,value:et}}async*getMany(o,$={}){for await(const j of o)yield this.get(j,$)}async*deleteMany(o,$={}){for await(const j of o)await this.delete(j,$),yield j}batch(){let o=[],$=[];return{put(j,et){o.push({key:j,value:et})},delete(j){$.push(j)},commit:async j=>{await drain(this.putMany(o,j)),o=[],await drain(this.deleteMany($,j)),$=[]}}}async*_all(o,$){throw new Error("._all is not implemented")}async*_allKeys(o,$){throw new Error("._allKeys is not implemented")}query(o,$){let j=this._all(o,$);if(o.prefix!=null&&(j=filter$1(j,et=>et.key.toString().startsWith(o.prefix||""))),Array.isArray(o.filters)&&(j=o.filters.reduce((et,tt)=>filter$1(et,tt),j)),Array.isArray(o.orders)&&(j=o.orders.reduce((et,tt)=>sortAll(et,tt),j)),o.offset!=null){let et=0;j=filter$1(j,()=>et++>=(o.offset||0))}return o.limit!=null&&(j=take(j,o.limit)),j}queryKeys(o,$){let j=this._allKeys(o,$);if(o.prefix!=null&&(j=filter$1(j,et=>et.toString().startsWith(o.prefix||""))),Array.isArray(o.filters)&&(j=o.filters.reduce((et,tt)=>filter$1(et,tt),j)),Array.isArray(o.orders)&&(j=o.orders.reduce((et,tt)=>sortAll(et,tt),j)),o.offset!=null){let et=0;j=filter$1(j,()=>et++>=o.offset)}return o.limit!=null&&(j=take(j,o.limit)),j}}function cidToKey(_){const o=CID$3.asCID(_);if(!o)throw errCode(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Key("/"+base32$6.encode(o.multihash.bytes).slice(1).toUpperCase(),!1)}function keyToCid(_){return CID$3.createV1(code$6,decode$B(base32$6.decode("b"+_.toString().slice(1).toLowerCase())))}function convertPrefix(_){const o=_.substring(0,1);if(o==="/")return convertPrefix(_.substring(1));let $;o.toLowerCase()==="b"?$=tt=>base32$6.decode(tt.toLowerCase()).subarray(2):o.toLowerCase()==="c"?$=tt=>base32pad$2.decode(tt.toLowerCase()).subarray(2):o==="z"?$=tt=>base58btc$4.decode(tt).subarray(2):o==="Q"?$=tt=>base58btc$4.decode("z"+tt):$=tt=>base32$6.decode("b"+tt.toLowerCase()).subarray(2);let j;for(let tt=1;tt<_.length;tt++)try{j=$(_.substring(0,tt))}catch(rt){if(rt.message!=="Unexpected end of data")throw rt}let et="/C";return j&&(et=`/${base32$6.encode(j).slice(1,-1).toUpperCase()||"C"}`),et}function convertQuery(_){return{..._,prefix:_.prefix?convertPrefix(_.prefix):void 0,filters:_.filters?_.filters.map(o=>$=>o({key:keyToCid($.key),value:$.value})):void 0,orders:_.orders?_.orders.map(o=>($,j)=>o({key:keyToCid($.key),value:$.value},{key:keyToCid(j.key),value:j.value})):void 0}}function convertKeyQuery(_){return{..._,prefix:_.prefix?convertPrefix(_.prefix):void 0,filters:_.filters?_.filters.map(o=>$=>o(keyToCid($))):void 0,orders:_.orders?_.orders.map(o=>($,j)=>o(keyToCid($),keyToCid(j))):void 0}}class BlockstoreDatastoreAdapter extends BaseBlockstore{constructor(o){super(),this.child=o}open(){return this.child.open()}close(){return this.child.close()}async*query(o,$){for await(const{key:j,value:et}of this.child.query(convertQuery(o),$))yield{key:keyToCid(j),value:et}}async*queryKeys(o,$){for await(const j of this.child.queryKeys(convertKeyQuery(o),$))yield keyToCid(j)}async get(o,$){return this.child.get(cidToKey(o),$)}async*getMany(o,$){for await(const j of o)yield this.get(j,$)}async put(o,$,j){await this.child.put(cidToKey(o),$,j)}async*putMany(o,$){const j=pushable({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{const tt=this.child;await drain(this.child.putMany(async function*(){for await(const rt of o){const nt=cidToKey(rt.key);await tt.has(nt,$)||(yield{key:nt,value:rt.value}),j.push(rt)}}())),j.end()}catch(tt){j.end(tt)}}),yield*j}has(o,$){return this.child.has(cidToKey(o),$)}delete(o,$){return this.child.delete(cidToKey(o),$)}deleteMany(o,$){const j=pushable({objectMode:!0});return drain(this.child.deleteMany(async function*(){for await(const et of o)yield cidToKey(et),j.push(et);j.end()}(),$)).catch(et=>{j.end(et)}),j}}function createRepo$1(_,o,$){const j=$.path||"ipfs";return createRepo$2(j,et=>o.getCodec(et),{root:new LevelDatastore(j,{prefix:"",version:2}),blocks:new BlockstoreDatastoreAdapter(new LevelDatastore(`${j}/blocks`,{prefix:"",version:2})),datastore:new LevelDatastore(`${j}/datastore`,{prefix:"",version:2}),keys:new LevelDatastore(`${j}/keys`,{prefix:"",version:2}),pins:new LevelDatastore(`${j}/pins`,{prefix:"",version:2})},{autoMigrate:$.autoMigrate,onMigrationProgress:$.onMigrationProgress||_,repoLock:MemoryLock})}const codes$4={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var Envelope;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.publicKey!=null&&$.publicKey.byteLength>0&&(j.uint32(10),j.bytes($.publicKey)),$.payloadType!=null&&$.payloadType.byteLength>0&&(j.uint32(18),j.bytes($.payloadType)),$.payload!=null&&$.payload.byteLength>0&&(j.uint32(26),j.bytes($.payload)),$.signature!=null&&$.signature.byteLength>0&&(j.uint32(42),j.bytes($.signature)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.publicKey=$.bytes();break;case 2:et.payloadType=$.bytes();break;case 3:et.payload=$.bytes();break;case 5:et.signature=$.bytes();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Envelope||(Envelope={}));function accessor(_){return _ instanceof Uint8Array?{get(o){return _[o]},set(o,$){_[o]=$}}:{get(o){return _.get(o)},set(o,$){_.set(o,$)}}}const TWO_32=4294967296;class LongBits{constructor(o=0,$=0){this.hi=o,this.lo=$}toBigInt(o){if(o===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){const $=~this.lo+1>>>0;let j=~this.hi>>>0;return $===0&&(j=j+1>>>0),-(BigInt($)+(BigInt(j)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(o){return Number(this.toBigInt(o))}zzDecode(){const o=-(this.lo&1),$=((this.lo>>>1|this.hi<<31)^o)>>>0,j=(this.hi>>>1^o)>>>0;return new LongBits(j,$)}zzEncode(){const o=this.hi>>31,$=((this.hi<<1|this.lo>>>31)^o)>>>0,j=(this.lo<<1^o)>>>0;return new LongBits($,j)}toBytes(o,$=0){const j=accessor(o);for(;this.hi>0;)j.set($++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)j.set($++,this.lo&127|128),this.lo=this.lo>>>7;j.set($++,this.lo)}static fromBigInt(o){if(o===0n)return new LongBits;const $=o<0;$&&(o=-o);let j=Number(o>>32n)|0,et=Number(o-(BigInt(j)<<32n))|0;return $&&(j=~j>>>0,et=~et>>>0,++et>TWO_32&&(et=0,++j>TWO_32&&(j=0))),new LongBits(j,et)}static fromNumber(o){if(o===0)return new LongBits;const $=o<0;$&&(o=-o);let j=o>>>0,et=(o-j)/4294967296>>>0;return $&&(et=~et>>>0,j=~j>>>0,++j>4294967295&&(j=0,++et>4294967295&&(et=0))),new LongBits(et,j)}static fromBytes(o,$=0){const j=accessor(o),et=new LongBits;let tt=0;if(o.length-$>4){for(;tt<4;++tt)if(et.lo=(et.lo|(j.get($)&127)<<tt*7)>>>0,j.get($++)<128)return et;if(et.lo=(et.lo|(j.get($)&127)<<28)>>>0,et.hi=(et.hi|(j.get($)&127)>>4)>>>0,j.get($++)<128)return et;tt=0}else for(;tt<4;++tt){if($>=o.length)throw RangeError(`index out of range: ${$} > ${o.length}`);if(et.lo=(et.lo|(j.get($)&127)<<tt*7)>>>0,j.get($++)<128)return et}if(o.length-$>4){for(;tt<5;++tt)if(et.hi=(et.hi|(j.get($)&127)<<tt*7+3)>>>0,j.get($++)<128)return et}else if($<o.byteLength)for(;tt<5;++tt){if($>=o.length)throw RangeError(`index out of range: ${$} > ${o.length}`);if(et.hi=(et.hi|(j.get($)&127)<<tt*7+3)>>>0,j.get($++)<128)return et}throw RangeError("invalid varint encoding")}}const N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),unsigned={encodingLength(_){return _<N1$1?1:_<N2$1?2:_<N3$1?3:_<N4$1?4:_<N5$1?5:_<N6$1?6:_<N7$1?7:_<N8$1?8:_<N9$1?9:10},encode(_,o,$=0){if(Number.MAX_SAFE_INTEGER!=null&&_>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return o==null&&(o=allocUnsafe$5(unsigned.encodingLength(_))),LongBits.fromNumber(_).toBytes(o,$),o},decode(_,o=0){return LongBits.fromBytes(_,o).toNumber(!0)}};class RecordEnvelope{constructor(o){const{peerId:$,payloadType:j,payload:et,signature:tt}=o;this.peerId=$,this.payloadType=j,this.payload=et,this.signature=tt}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=Envelope.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(o){return equals$6(this.marshal(),o.marshal())}async validate(o){const $=formatSignaturePayload(o,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await unmarshalPublicKey(this.peerId.publicKey).verify($.subarray(),this.signature)}}RecordEnvelope.createFromProtobuf=async _=>{const o=Envelope.decode(_),$=await peerIdFromKeys(o.publicKey);return new RecordEnvelope({peerId:$,payloadType:o.payloadType,payload:o.payload,signature:o.signature})};RecordEnvelope.seal=async(_,o)=>{if(o.privateKey==null)throw new Error("Missing private key");const $=_.domain,j=_.codec,et=_.marshal(),tt=formatSignaturePayload($,j,et),nt=await(await unmarshalPrivateKey(o.privateKey)).sign(tt.subarray());return new RecordEnvelope({peerId:o,payloadType:j,payload:et,signature:nt})};RecordEnvelope.openAndCertify=async(_,o)=>{const $=await RecordEnvelope.createFromProtobuf(_);if(!await $.validate(o))throw new CodeError("envelope signature is not valid for the given domain",codes$4.ERR_SIGNATURE_NOT_VALID);return $};const formatSignaturePayload=(_,o,$)=>{const j=fromString$8(_),et=unsigned.encode(j.byteLength),tt=unsigned.encode(o.length),rt=unsigned.encode($.length);return new Uint8ArrayList(et,j,tt,o,rt,$)},isV4$1=isIPv4,isV6$1=isIPv6,toBytes$1=function(_){let o=0;if(_=_.toString().trim(),isV4$1(_)){const $=new Uint8Array(o+4);return _.split(/\./g).forEach(j=>{$[o++]=parseInt(j,10)&255}),$}if(isV6$1(_)){const $=_.split(":",8);let j;for(j=0;j<$.length;j++){const tt=isV4$1($[j]);let rt;tt&&(rt=toBytes$1($[j]),$[j]=toString$a(rt.slice(0,2),"base16")),rt!=null&&++j<8&&$.splice(j,0,toString$a(rt.slice(2,4),"base16"))}if($[0]==="")for(;$.length<8;)$.unshift("0");else if($[$.length-1]==="")for(;$.length<8;)$.push("0");else if($.length<8){for(j=0;j<$.length&&$[j]!=="";j++);const tt=[j,1];for(j=9-$.length;j>0;j--)tt.push("0");$.splice.apply($,tt)}const et=new Uint8Array(o+16);for(j=0;j<$.length;j++){const tt=parseInt($[j],16);et[o++]=tt>>8&255,et[o++]=tt&255}return et}throw new Error("invalid ip address")},toString$2=function(_,o=0,$){o=~~o,$=$??_.length-o;const j=new DataView(_.buffer);if($===4){const et=[];for(let tt=0;tt<$;tt++)et.push(_[o+tt]);return et.join(".")}if($===16){const et=[];for(let tt=0;tt<$;tt+=2)et.push(j.getUint16(o+tt).toString(16));return et.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V$1=-1,names$1={},codes$3={},table$1=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$1,"ip6zone"],[43,8,"ipcidr"],[53,V$1,"dns",!0],[54,V$1,"dns4",!0],[55,V$1,"dns6",!0],[56,V$1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$1,"unix",!1,!0],[421,V$1,"ipfs"],[421,V$1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$1,"garlic64"],[448,0,"tls"],[449,V$1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V$1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$1,"memory"]];table$1.forEach(_=>{const o=createProtocol$1(..._);codes$3[o.code]=o,names$1[o.name]=o});function createProtocol$1(_,o,$,j,et){return{code:_,size:o,name:$,resolvable:!!j,path:!!et}}function getProtocol$1(_){if(typeof _=="number"){if(codes$3[_]!=null)return codes$3[_];throw new Error(`no protocol with code: ${_}`)}else if(typeof _=="string"){if(names$1[_]!=null)return names$1[_];throw new Error(`no protocol with name: ${_}`)}throw new Error(`invalid protocol id type: ${typeof _}`)}function convertToString$1(_,o){switch(getProtocol$1(_).code){case 4:case 41:return bytes2ip$1(o);case 42:return bytes2str$1(o);case 6:case 273:case 33:case 132:return bytes2port$1(o).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str$1(o);case 421:return bytes2mh$1(o);case 444:return bytes2onion$1(o);case 445:return bytes2onion$1(o);case 466:return bytes2mb$1(o);default:return toString$a(o,"base16")}}function convertToBytes$1(_,o){switch(getProtocol$1(_).code){case 4:return ip2bytes$1(o);case 41:return ip2bytes$1(o);case 42:return str2bytes$1(o);case 6:case 273:case 33:case 132:return port2bytes$1(parseInt(o,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes$1(o);case 421:return mh2bytes$1(o);case 444:return onion2bytes$1(o);case 445:return onion32bytes$1(o);case 466:return mb2bytes$1(o);default:return fromString$8(o,"base16")}}const decoders$1=Object.values(bases$2).map(_=>_.decoder),anybaseDecoder$1=function(){let _=decoders$1[0].or(decoders$1[1]);return decoders$1.slice(2).forEach(o=>_=_.or(o)),_}();function ip2bytes$1(_){if(!isIP(_))throw new Error("invalid ip address");return toBytes$1(_)}function bytes2ip$1(_){const o=toString$2(_,0,_.length);if(o==null)throw new Error("ipBuff is required");if(!isIP(o))throw new Error("invalid ip address");return o}function port2bytes$1(_){const o=new ArrayBuffer(2);return new DataView(o).setUint16(0,_),new Uint8Array(o)}function bytes2port$1(_){return new DataView(_.buffer).getUint16(_.byteOffset)}function str2bytes$1(_){const o=fromString$8(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2str$1(_){const o=varint$2.decode(_);if(_=_.slice(varint$2.decode.bytes),_.length!==o)throw new Error("inconsistent lengths");return toString$a(_)}function mh2bytes$1(_){let o;_[0]==="Q"||_[0]==="1"?o=decode$B(base58btc$4.decode(`z${_}`)).bytes:o=CID$3.parse(_).multihash.bytes;const $=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function mb2bytes$1(_){const o=anybaseDecoder$1.decode(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2mb$1(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return"u"+toString$a($,"base64url")}function bytes2mh$1(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return toString$a($,"base58btc")}function onion2bytes$1(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==16)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion address.`);const $=base32$6.decode("b"+o[0]),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes$1(j);return concat$2([$,et],$.length+et.length)}function onion32bytes$1(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==56)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion3 address.`);const $=base32$6.decode(`b${o[0]}`),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes$1(j);return concat$2([$,et],$.length+et.length)}function bytes2onion$1(_){const o=_.slice(0,_.length-2),$=_.slice(_.length-2),j=toString$a(o,"base32"),et=bytes2port$1($);return`${j}:${et}`}function stringToStringTuples$1(_){const o=[],$=_.split("/").slice(1);if($.length===1&&$[0]==="")return[];for(let j=0;j<$.length;j++){const et=$[j],tt=getProtocol$1(et);if(tt.size===0){o.push([et]);continue}if(j++,j>=$.length)throw ParseError$1("invalid address: "+_);if(tt.path===!0){o.push([et,cleanPath$1($.slice(j).join("/"))]);break}o.push([et,$[j]])}return o}function stringTuplesToString$1(_){const o=[];return _.map($=>{const j=protoFromTuple$1($);return o.push(j.name),$.length>1&&$[1]!=null&&o.push($[1]),null}),cleanPath$1(o.join("/"))}function stringTuplesToTuples$1(_){return _.map(o=>{Array.isArray(o)||(o=[o]);const $=protoFromTuple$1(o);return o.length>1?[$.code,convertToBytes$1($.code,o[1])]:[$.code]})}function tuplesToStringTuples$1(_){return _.map(o=>{const $=protoFromTuple$1(o);return o[1]!=null?[$.code,convertToString$1($.code,o[1])]:[$.code]})}function tuplesToBytes$1(_){return fromBytes$1(concat$2(_.map(o=>{const $=protoFromTuple$1(o);let j=Uint8Array.from(varint$2.encode($.code));return o.length>1&&o[1]!=null&&(j=concat$2([j,o[1]])),j})))}function sizeForAddr$1(_,o){return _.size>0?_.size/8:_.size===0?0:varint$2.decode(o)+(varint$2.decode.bytes??0)}function bytesToTuples$1(_){const o=[];let $=0;for(;$<_.length;){const j=varint$2.decode(_,$),et=varint$2.decode.bytes??0,tt=getProtocol$1(j),rt=sizeForAddr$1(tt,_.slice($+et));if(rt===0){o.push([j]),$+=et;continue}const nt=_.slice($+et,$+et+rt);if($+=rt+et,$>_.length)throw ParseError$1("Invalid address Uint8Array: "+toString$a(_,"base16"));o.push([j,nt])}return o}function bytesToString$1(_){const o=bytesToTuples$1(_),$=tuplesToStringTuples$1(o);return stringTuplesToString$1($)}function stringToBytes$1(_){_=cleanPath$1(_);const o=stringToStringTuples$1(_),$=stringTuplesToTuples$1(o);return tuplesToBytes$1($)}function fromString$1(_){return stringToBytes$1(_)}function fromBytes$1(_){const o=validateBytes$1(_);if(o!=null)throw o;return Uint8Array.from(_)}function validateBytes$1(_){try{bytesToTuples$1(_)}catch(o){return o}}function cleanPath$1(_){return"/"+_.trim().split("/").filter(o=>o).join("/")}function ParseError$1(_){return new Error("Error parsing address: "+_)}function protoFromTuple$1(_){return getProtocol$1(_[0])}var __classPrivateFieldGet$2=globalThis&&globalThis.__classPrivateFieldGet||function(_,o,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?_!==o||!j:!o.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:o.get(_)},__classPrivateFieldSet$1=globalThis&&globalThis.__classPrivateFieldSet||function(_,o,$,j,et){if(j==="m")throw new TypeError("Private method is not writable");if(j==="a"&&!et)throw new TypeError("Private accessor was defined without a setter");if(typeof o=="function"?_!==o||!et:!o.has(_))throw new TypeError("Cannot write private member to an object whose class did not declare it");return j==="a"?et.call(_,$):et?et.value=$:o.set(_,$),$},_DefaultMultiaddr_string$1,_DefaultMultiaddr_tuples$1,_DefaultMultiaddr_stringTuples$1,_a$1;const inspect$1=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES$1=[getProtocol$1("dns").code,getProtocol$1("dns4").code,getProtocol$1("dns6").code,getProtocol$1("dnsaddr").code],resolvers$1=new Map,symbol$4=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr$1(_){return!!(_!=null&&_[symbol$4])}let DefaultMultiaddr$1=class ls{constructor(o){if(_DefaultMultiaddr_string$1.set(this,void 0),_DefaultMultiaddr_tuples$1.set(this,void 0),_DefaultMultiaddr_stringTuples$1.set(this,void 0),this[_a$1]=!0,o==null&&(o=""),o instanceof Uint8Array)this.bytes=fromBytes$1(o);else if(typeof o=="string"){if(o.length>0&&o.charAt(0)!=="/")throw new Error(`multiaddr "${o}" must start with a "/"`);this.bytes=fromString$1(o)}else if(isMultiaddr$1(o))this.bytes=fromBytes$1(o.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet$2(this,_DefaultMultiaddr_string$1,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_string$1,bytesToString$1(this.bytes),"f"),__classPrivateFieldGet$2(this,_DefaultMultiaddr_string$1,"f")}toJSON(){return this.toString()}toOptions(){let o,$,j,et,tt="";const rt=getProtocol$1("tcp"),nt=getProtocol$1("udp"),it=getProtocol$1("ip4"),st=getProtocol$1("ip6"),ot=getProtocol$1("dns6"),at=getProtocol$1("ip6zone");for(const[ut,ft]of this.stringTuples())ut===at.code&&(tt=`%${ft??""}`),DNS_CODES$1.includes(ut)&&($=rt.name,et=443,j=`${ft??""}${tt}`,o=ut===ot.code?6:4),(ut===rt.code||ut===nt.code)&&($=getProtocol$1(ut).name,et=parseInt(ft??"")),(ut===it.code||ut===st.code)&&($=getProtocol$1(ut).name,j=`${ft??""}${tt}`,o=ut===st.code?6:4);if(o==null||$==null||j==null||et==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:o,host:j,transport:$,port:et}}protos(){return this.protoCodes().map(o=>Object.assign({},getProtocol$1(o)))}protoCodes(){const o=[],$=this.bytes;let j=0;for(;j<$.length;){const et=varint$2.decode($,j),tt=varint$2.decode.bytes??0,rt=getProtocol$1(et),nt=sizeForAddr$1(rt,$.slice(j+tt));j+=nt+tt,o.push(et)}return o}protoNames(){return this.protos().map(o=>o.name)}tuples(){return __classPrivateFieldGet$2(this,_DefaultMultiaddr_tuples$1,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_tuples$1,bytesToTuples$1(this.bytes),"f"),__classPrivateFieldGet$2(this,_DefaultMultiaddr_tuples$1,"f")}stringTuples(){return __classPrivateFieldGet$2(this,_DefaultMultiaddr_stringTuples$1,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_stringTuples$1,tuplesToStringTuples$1(this.tuples()),"f"),__classPrivateFieldGet$2(this,_DefaultMultiaddr_stringTuples$1,"f")}encapsulate(o){return o=new ls(o),new ls(this.toString()+o.toString())}decapsulate(o){const $=o.toString(),j=this.toString(),et=j.lastIndexOf($);if(et<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${o.toString()}`);return new ls(j.slice(0,et))}decapsulateCode(o){const $=this.tuples();for(let j=$.length-1;j>=0;j--)if($[j][0]===o)return new ls(tuplesToBytes$1($.slice(0,j)));return this}getPeerId(){try{const $=this.stringTuples().filter(j=>j[0]===names$1.ipfs.code).pop();if(($==null?void 0:$[1])!=null){const j=$[1];return j[0]==="Q"||j[0]==="1"?toString$a(base58btc$4.decode(`z${j}`),"base58btc"):toString$a(CID$3.parse(j).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let o=null;try{o=this.stringTuples().filter($=>getProtocol$1($[0]).path===!0)[0][1],o==null&&(o=null)}catch{o=null}return o}equals(o){return equals$6(this.bytes,o.bytes)}async resolve(o){const $=this.protos().find(tt=>tt.resolvable);if($==null)return[this];const j=resolvers$1.get($.name);if(j==null)throw errCode(new Error(`no available resolver for ${$.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await j(this,o)).map(tt=>new ls(tt))}nodeAddress(){const o=this.toOptions();if(o.transport!=="tcp"&&o.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${o.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:o.family,address:o.host,port:o.port}}isThinWaistAddress(o){const $=(o??this).protos();return!($.length!==2||$[0].code!==4&&$[0].code!==41||$[1].code!==6&&$[1].code!==273)}[(_DefaultMultiaddr_string$1=new WeakMap,_DefaultMultiaddr_tuples$1=new WeakMap,_DefaultMultiaddr_stringTuples$1=new WeakMap,_a$1=symbol$4,inspect$1)](){return`Multiaddr(${bytesToString$1(this.bytes)})`}};function multiaddr$1(_){return new DefaultMultiaddr$1(_)}function arrayEquals$1(_,o){const $=(j,et)=>j.toString().localeCompare(et.toString());return _.length!==o.length?!1:(o.sort($),_.sort($).every((j,et)=>o[et].equals(j)))}var PeerRecord$1;(function(_){(function($){let j;$.codec=()=>(j==null&&(j=message$3((et,tt,rt={})=>{rt.lengthDelimited!==!1&&tt.fork(),et.multiaddr!=null&&et.multiaddr.byteLength>0&&(tt.uint32(10),tt.bytes(et.multiaddr)),rt.lengthDelimited!==!1&&tt.ldelim()},(et,tt)=>{const rt={multiaddr:new Uint8Array(0)},nt=tt==null?et.len:et.pos+tt;for(;et.pos<nt;){const it=et.uint32();switch(it>>>3){case 1:rt.multiaddr=et.bytes();break;default:et.skipType(it&7);break}}return rt})),j),$.encode=et=>encodeMessage$3(et,$.codec()),$.decode=et=>decodeMessage$4(et,$.codec())})(_.AddressInfo||(_.AddressInfo={}));let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{if(et.lengthDelimited!==!1&&j.fork(),$.peerId!=null&&$.peerId.byteLength>0&&(j.uint32(10),j.bytes($.peerId)),$.seq!=null&&$.seq!==0n&&(j.uint32(16),j.uint64($.seq)),$.addresses!=null)for(const tt of $.addresses)j.uint32(26),_.AddressInfo.codec().encode(tt,j);et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={peerId:new Uint8Array(0),seq:0n,addresses:[]},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.peerId=$.bytes();break;case 2:et.seq=$.uint64();break;case 3:et.addresses.push(_.AddressInfo.codec().decode($,$.uint32()));break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(PeerRecord$1||(PeerRecord$1={}));const ENVELOPE_DOMAIN_PEER_RECORD="libp2p-peer-record",ENVELOPE_PAYLOAD_TYPE_PEER_RECORD=Uint8Array.from([3,1]);class PeerRecord{constructor(o){this.domain=PeerRecord.DOMAIN,this.codec=PeerRecord.CODEC;const{peerId:$,multiaddrs:j,seqNumber:et}=o;this.peerId=$,this.multiaddrs=j??[],this.seqNumber=et??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=PeerRecord$1.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(o=>({multiaddr:o.bytes}))})),this.marshaled}equals(o){return!(!(o instanceof PeerRecord)||!this.peerId.equals(o.peerId)||this.seqNumber!==o.seqNumber||!arrayEquals$1(this.multiaddrs,o.multiaddrs))}}PeerRecord.createFromProtobuf=_=>{const o=PeerRecord$1.decode(_),$=peerIdFromBytes(o.peerId),j=(o.addresses??[]).map(tt=>multiaddr$1(tt.multiaddr)),et=o.seq;return new PeerRecord({peerId:$,multiaddrs:j,seqNumber:et})};PeerRecord.DOMAIN=ENVELOPE_DOMAIN_PEER_RECORD;PeerRecord.CODEC=ENVELOPE_PAYLOAD_TYPE_PEER_RECORD;const topologySymbol=Symbol.for("@libp2p/topology");function isTopology(_){return _!=null&&!!_[topologySymbol]}const noop$3=()=>{};class TopologyImpl{constructor(o){this.min=o.min??0,this.max=o.max??1/0,this.peers=new Set,this.onConnect=o.onConnect??noop$3,this.onDisconnect=o.onDisconnect??noop$3}get[Symbol.toStringTag](){return topologySymbol.toString()}get[topologySymbol](){return!0}async setRegistrar(o){this.registrar=o}disconnect(o){this.onDisconnect(o)}}function createTopology(_){return new TopologyImpl(_)}var __classPrivateFieldGet$1=globalThis&&globalThis.__classPrivateFieldGet||function(_,o,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?_!==o||!j:!o.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:o.get(_)},_EventEmitter_listeners;let EventEmitter$1=class extends EventTarget{constructor(){super(...arguments),_EventEmitter_listeners.set(this,new Map)}listenerCount(o){const $=__classPrivateFieldGet$1(this,_EventEmitter_listeners,"f").get(o);return $==null?0:$.length}addEventListener(o,$,j){super.addEventListener(o,$,j);let et=__classPrivateFieldGet$1(this,_EventEmitter_listeners,"f").get(o);et==null&&(et=[],__classPrivateFieldGet$1(this,_EventEmitter_listeners,"f").set(o,et)),et.push({callback:$,once:(j!==!0&&j!==!1&&(j==null?void 0:j.once))??!1})}removeEventListener(o,$,j){super.removeEventListener(o.toString(),$??null,j);let et=__classPrivateFieldGet$1(this,_EventEmitter_listeners,"f").get(o);et!=null&&(et=et.filter(({callback:tt})=>tt!==$),__classPrivateFieldGet$1(this,_EventEmitter_listeners,"f").set(o,et))}dispatchEvent(o){const $=super.dispatchEvent(o);let j=__classPrivateFieldGet$1(this,_EventEmitter_listeners,"f").get(o.type);return j==null||(j=j.filter(({once:et})=>!et),__classPrivateFieldGet$1(this,_EventEmitter_listeners,"f").set(o.type,j)),$}safeDispatchEvent(o,$){return this.dispatchEvent(new CustomEvent(o,$))}};_EventEmitter_listeners=new WeakMap;class CustomEventPolyfill extends Event{constructor(o,$){super(o,$),this.detail=$==null?void 0:$.detail}}const CustomEvent=globalThis.CustomEvent??CustomEventPolyfill;class MessageCache{constructor(o,$,j){this.gossip=o,this.msgs=new Map,this.history=[],this.notValidatedCount=0,this.msgIdToStrFn=j;for(let et=0;et<$;et++)this.history[et]=[]}get size(){return this.msgs.size}put(o,$,j=!1){const{msgIdStr:et}=o;return this.msgs.has(et)?!1:(this.msgs.set(et,{message:$,validated:j,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...o,topic:$.topic}),j||this.notValidatedCount++,!0)}observeDuplicate(o,$){const j=this.msgs.get(o);j&&!j.validated&&j.originatingPeers.add($)}get(o){var $;return($=this.msgs.get(this.msgIdToStrFn(o)))==null?void 0:$.message}getWithIWantCount(o,$){const j=this.msgs.get(o);if(!j)return null;const et=(j.iwantCounts.get($)??0)+1;return j.iwantCounts.set($,et),{msg:j.message,count:et}}getGossipIDs(o){const $=new Map;for(let j=0;j<this.gossip;j++)this.history[j].forEach(et=>{const tt=this.msgs.get(et.msgIdStr);if(tt&&tt.validated&&o.has(et.topic)){let rt=$.get(et.topic);rt||(rt=[],$.set(et.topic,rt)),rt.push(et.msgId)}});return $}validate(o){const $=this.msgs.get(o);if(!$)return null;$.validated||this.notValidatedCount--;const{message:j,originatingPeers:et}=$;return $.validated=!0,$.originatingPeers=new Set,{message:j,originatingPeers:et}}shift(){this.history[this.history.length-1].forEach($=>{const j=this.msgs.get($.msgIdStr);j&&(this.msgs.delete($.msgIdStr),j.validated||this.notValidatedCount--)}),this.history.pop(),this.history.unshift([])}remove(o){const $=this.msgs.get(o);return $?(this.msgs.delete(o),$):null}}var rpcExports={},rpc$1={get exports(){return rpcExports},set exports(_){rpcExports=_}},minimalExports$1={},minimal$1={get exports(){return minimalExports$1},set exports(_){minimalExports$1=_}},indexMinimal={},minimal={},longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=o;var _=requireMinimal$1();function o(tt,rt){this.lo=tt>>>0,this.hi=rt>>>0}var $=o.zero=new o(0,0);$.toNumber=function(){return 0},$.zzEncode=$.zzDecode=function(){return this},$.length=function(){return 1};var j=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(rt){if(rt===0)return $;var nt=rt<0;nt&&(rt=-rt);var it=rt>>>0,st=(rt-it)/4294967296>>>0;return nt&&(st=~st>>>0,it=~it>>>0,++it>4294967295&&(it=0,++st>4294967295&&(st=0))),new o(it,st)},o.from=function(rt){if(typeof rt=="number")return o.fromNumber(rt);if(_.isString(rt))if(_.Long)rt=_.Long.fromString(rt);else return o.fromNumber(parseInt(rt,10));return rt.low||rt.high?new o(rt.low>>>0,rt.high>>>0):$},o.prototype.toNumber=function(rt){if(!rt&&this.hi>>>31){var nt=~this.lo+1>>>0,it=~this.hi>>>0;return nt||(it=it+1>>>0),-(nt+it*4294967296)}return this.lo+this.hi*4294967296},o.prototype.toLong=function(rt){return _.Long?new _.Long(this.lo|0,this.hi|0,!!rt):{low:this.lo|0,high:this.hi|0,unsigned:!!rt}};var et=String.prototype.charCodeAt;return o.fromHash=function(rt){return rt===j?$:new o((et.call(rt,0)|et.call(rt,1)<<8|et.call(rt,2)<<16|et.call(rt,3)<<24)>>>0,(et.call(rt,4)|et.call(rt,5)<<8|et.call(rt,6)<<16|et.call(rt,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var rt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^rt)>>>0,this.lo=(this.lo<<1^rt)>>>0,this},o.prototype.zzDecode=function(){var rt=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^rt)>>>0,this.hi=(this.hi>>>1^rt)>>>0,this},o.prototype.length=function(){var rt=this.lo,nt=(this.lo>>>28|this.hi<<4)>>>0,it=this.hi>>>24;return it===0?nt===0?rt<16384?rt<128?1:2:rt<2097152?3:4:nt<16384?nt<128?5:6:nt<2097152?7:8:it<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(_){var o=_;o.asPromise=aspromise,o.base64=base64$5,o.EventEmitter=eventemitter,o.float=float,o.inquire=inquire_1,o.utf8=utf8$2,o.pool=pool_1,o.LongBits=requireLongbits(),o.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),o.global=o.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isInteger=Number.isInteger||function(tt){return typeof tt=="number"&&isFinite(tt)&&Math.floor(tt)===tt},o.isString=function(tt){return typeof tt=="string"||tt instanceof String},o.isObject=function(tt){return tt&&typeof tt=="object"},o.isset=o.isSet=function(tt,rt){var nt=tt[rt];return nt!=null&&tt.hasOwnProperty(rt)?typeof nt!="object"||(Array.isArray(nt)?nt.length:Object.keys(nt).length)>0:!1},o.Buffer=function(){try{var et=o.inquire("buffer").Buffer;return et.prototype.utf8Write?et:null}catch{return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(tt){return typeof tt=="number"?o.Buffer?o._Buffer_allocUnsafe(tt):new o.Array(tt):o.Buffer?o._Buffer_from(tt):typeof Uint8Array>"u"?tt:new Uint8Array(tt)},o.Array=typeof Uint8Array<"u"?Uint8Array:Array,o.Long=o.global.dcodeIO&&o.global.dcodeIO.Long||o.global.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(tt){return tt?o.LongBits.from(tt).toHash():o.LongBits.zeroHash},o.longFromHash=function(tt,rt){var nt=o.LongBits.fromHash(tt);return o.Long?o.Long.fromBits(nt.lo,nt.hi,rt):nt.toNumber(!!rt)};function $(et,tt,rt){for(var nt=Object.keys(tt),it=0;it<nt.length;++it)(et[nt[it]]===void 0||!rt)&&(et[nt[it]]=tt[nt[it]]);return et}o.merge=$,o.lcFirst=function(tt){return tt.charAt(0).toLowerCase()+tt.substring(1)};function j(et){function tt(rt,nt){if(!(this instanceof tt))return new tt(rt,nt);Object.defineProperty(this,"message",{get:function(){return rt}}),Error.captureStackTrace?Error.captureStackTrace(this,tt):Object.defineProperty(this,"stack",{value:new Error().stack||""}),nt&&$(this,nt)}return(tt.prototype=Object.create(Error.prototype)).constructor=tt,Object.defineProperty(tt.prototype,"name",{get:function(){return et}}),tt.prototype.toString=function(){return this.name+": "+this.message},tt}o.newError=j,o.ProtocolError=j("ProtocolError"),o.oneOfGetter=function(tt){for(var rt={},nt=0;nt<tt.length;++nt)rt[tt[nt]]=1;return function(){for(var it=Object.keys(this),st=it.length-1;st>-1;--st)if(rt[it[st]]===1&&this[it[st]]!==void 0&&this[it[st]]!==null)return it[st]}},o.oneOfSetter=function(tt){return function(rt){for(var nt=0;nt<tt.length;++nt)tt[nt]!==rt&&delete this[tt[nt]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var et=o.Buffer;if(!et){o._Buffer_from=o._Buffer_allocUnsafe=null;return}o._Buffer_from=et.from!==Uint8Array.from&&et.from||function(rt,nt){return new et(rt,nt)},o._Buffer_allocUnsafe=et.allocUnsafe||function(rt){return new et(rt)}}}(minimal)),minimal}var writer$2,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer$2;hasRequiredWriter=1,writer$2=it;var _=requireMinimal$1(),o,$=_.LongBits,j=_.base64,et=_.utf8;function tt(mt,gt,Et){this.fn=mt,this.len=gt,this.next=void 0,this.val=Et}function rt(){}function nt(mt){this.head=mt.head,this.tail=mt.tail,this.len=mt.len,this.next=mt.states}function it(){this.len=0,this.head=new tt(rt,0,0),this.tail=this.head,this.states=null}var st=function(){return _.Buffer?function(){return(it.create=function(){return new o})()}:function(){return new it}};it.create=st(),it.alloc=function(gt){return new _.Array(gt)},_.Array!==Array&&(it.alloc=_.pool(it.alloc,_.Array.prototype.subarray)),it.prototype._push=function(gt,Et,St){return this.tail=this.tail.next=new tt(gt,Et,St),this.len+=Et,this};function ot(mt,gt,Et){gt[Et]=mt&255}function at(mt,gt,Et){for(;mt>127;)gt[Et++]=mt&127|128,mt>>>=7;gt[Et]=mt}function ct(mt,gt){this.len=mt,this.next=void 0,this.val=gt}ct.prototype=Object.create(tt.prototype),ct.prototype.fn=at,it.prototype.uint32=function(gt){return this.len+=(this.tail=this.tail.next=new ct((gt=gt>>>0)<128?1:gt<16384?2:gt<2097152?3:gt<268435456?4:5,gt)).len,this},it.prototype.int32=function(gt){return gt<0?this._push(ut,10,$.fromNumber(gt)):this.uint32(gt)},it.prototype.sint32=function(gt){return this.uint32((gt<<1^gt>>31)>>>0)};function ut(mt,gt,Et){for(;mt.hi;)gt[Et++]=mt.lo&127|128,mt.lo=(mt.lo>>>7|mt.hi<<25)>>>0,mt.hi>>>=7;for(;mt.lo>127;)gt[Et++]=mt.lo&127|128,mt.lo=mt.lo>>>7;gt[Et++]=mt.lo}it.prototype.uint64=function(gt){var Et=$.from(gt);return this._push(ut,Et.length(),Et)},it.prototype.int64=it.prototype.uint64,it.prototype.sint64=function(gt){var Et=$.from(gt).zzEncode();return this._push(ut,Et.length(),Et)},it.prototype.bool=function(gt){return this._push(ot,1,gt?1:0)};function ft(mt,gt,Et){gt[Et]=mt&255,gt[Et+1]=mt>>>8&255,gt[Et+2]=mt>>>16&255,gt[Et+3]=mt>>>24}it.prototype.fixed32=function(gt){return this._push(ft,4,gt>>>0)},it.prototype.sfixed32=it.prototype.fixed32,it.prototype.fixed64=function(gt){var Et=$.from(gt);return this._push(ft,4,Et.lo)._push(ft,4,Et.hi)},it.prototype.sfixed64=it.prototype.fixed64,it.prototype.float=function(gt){return this._push(_.float.writeFloatLE,4,gt)},it.prototype.double=function(gt){return this._push(_.float.writeDoubleLE,8,gt)};var ht=_.Array.prototype.set?function(gt,Et,St){Et.set(gt,St)}:function(gt,Et,St){for(var At=0;At<gt.length;++At)Et[St+At]=gt[At]};return it.prototype.bytes=function(gt){var Et=gt.length>>>0;if(!Et)return this._push(ot,1,0);if(_.isString(gt)){var St=it.alloc(Et=j.length(gt));j.decode(gt,St,0),gt=St}return this.uint32(Et)._push(ht,Et,gt)},it.prototype.string=function(gt){var Et=et.length(gt);return Et?this.uint32(Et)._push(et.write,Et,gt):this._push(ot,1,0)},it.prototype.fork=function(){return this.states=new nt(this),this.head=this.tail=new tt(rt,0,0),this.len=0,this},it.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new tt(rt,0,0),this.len=0),this},it.prototype.ldelim=function(){var gt=this.head,Et=this.tail,St=this.len;return this.reset().uint32(St),St&&(this.tail.next=gt.next,this.tail=Et,this.len+=St),this},it.prototype.finish=function(){for(var gt=this.head.next,Et=this.constructor.alloc(this.len),St=0;gt;)gt.fn(gt.val,Et,St),St+=gt.len,gt=gt.next;return Et},it._configure=function(mt){o=mt,it.create=st(),o._configure()},writer$2}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=$;var _=requireWriter();($.prototype=Object.create(_.prototype)).constructor=$;var o=requireMinimal$1();function $(){_.call(this)}$._configure=function(){$.alloc=o._Buffer_allocUnsafe,$.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&o.Buffer.prototype.set.name==="set"?function(tt,rt,nt){rt.set(tt,nt)}:function(tt,rt,nt){if(tt.copy)tt.copy(rt,nt,0,tt.length);else for(var it=0;it<tt.length;)rt[nt++]=tt[it++]}},$.prototype.bytes=function(tt){o.isString(tt)&&(tt=o._Buffer_from(tt,"base64"));var rt=tt.length>>>0;return this.uint32(rt),rt&&this._push($.writeBytesBuffer,rt,tt),this};function j(et,tt,rt){et.length<40?o.utf8.write(et,tt,rt):tt.utf8Write?tt.utf8Write(et,rt):tt.write(et,rt)}return $.prototype.string=function(tt){var rt=o.Buffer.byteLength(tt);return this.uint32(rt),rt&&this._push(j,rt,tt),this},$._configure(),writer_buffer}var reader$2,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader$2;hasRequiredReader=1,reader$2=tt;var _=requireMinimal$1(),o,$=_.LongBits,j=_.utf8;function et(at,ct){return RangeError("index out of range: "+at.pos+" + "+(ct||1)+" > "+at.len)}function tt(at){this.buf=at,this.pos=0,this.len=at.length}var rt=typeof Uint8Array<"u"?function(ct){if(ct instanceof Uint8Array||Array.isArray(ct))return new tt(ct);throw Error("illegal buffer")}:function(ct){if(Array.isArray(ct))return new tt(ct);throw Error("illegal buffer")},nt=function(){return _.Buffer?function(ut){return(tt.create=function(ht){return _.Buffer.isBuffer(ht)?new o(ht):rt(ht)})(ut)}:rt};tt.create=nt(),tt.prototype._slice=_.Array.prototype.subarray||_.Array.prototype.slice,tt.prototype.uint32=function(){var ct=4294967295;return function(){if(ct=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(ct=(ct|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(ct=(ct|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(ct=(ct|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(ct=(ct|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return ct;if((this.pos+=5)>this.len)throw this.pos=this.len,et(this,10);return ct}}(),tt.prototype.int32=function(){return this.uint32()|0},tt.prototype.sint32=function(){var ct=this.uint32();return ct>>>1^-(ct&1)|0};function it(){var at=new $(0,0),ct=0;if(this.len-this.pos>4){for(;ct<4;++ct)if(at.lo=(at.lo|(this.buf[this.pos]&127)<<ct*7)>>>0,this.buf[this.pos++]<128)return at;if(at.lo=(at.lo|(this.buf[this.pos]&127)<<28)>>>0,at.hi=(at.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return at;ct=0}else{for(;ct<3;++ct){if(this.pos>=this.len)throw et(this);if(at.lo=(at.lo|(this.buf[this.pos]&127)<<ct*7)>>>0,this.buf[this.pos++]<128)return at}return at.lo=(at.lo|(this.buf[this.pos++]&127)<<ct*7)>>>0,at}if(this.len-this.pos>4){for(;ct<5;++ct)if(at.hi=(at.hi|(this.buf[this.pos]&127)<<ct*7+3)>>>0,this.buf[this.pos++]<128)return at}else for(;ct<5;++ct){if(this.pos>=this.len)throw et(this);if(at.hi=(at.hi|(this.buf[this.pos]&127)<<ct*7+3)>>>0,this.buf[this.pos++]<128)return at}throw Error("invalid varint encoding")}tt.prototype.bool=function(){return this.uint32()!==0};function st(at,ct){return(at[ct-4]|at[ct-3]<<8|at[ct-2]<<16|at[ct-1]<<24)>>>0}tt.prototype.fixed32=function(){if(this.pos+4>this.len)throw et(this,4);return st(this.buf,this.pos+=4)},tt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw et(this,4);return st(this.buf,this.pos+=4)|0};function ot(){if(this.pos+8>this.len)throw et(this,8);return new $(st(this.buf,this.pos+=4),st(this.buf,this.pos+=4))}return tt.prototype.float=function(){if(this.pos+4>this.len)throw et(this,4);var ct=_.float.readFloatLE(this.buf,this.pos);return this.pos+=4,ct},tt.prototype.double=function(){if(this.pos+8>this.len)throw et(this,4);var ct=_.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,ct},tt.prototype.bytes=function(){var ct=this.uint32(),ut=this.pos,ft=this.pos+ct;if(ft>this.len)throw et(this,ct);return this.pos+=ct,Array.isArray(this.buf)?this.buf.slice(ut,ft):ut===ft?new this.buf.constructor(0):this._slice.call(this.buf,ut,ft)},tt.prototype.string=function(){var ct=this.bytes();return j.read(ct,0,ct.length)},tt.prototype.skip=function(ct){if(typeof ct=="number"){if(this.pos+ct>this.len)throw et(this,ct);this.pos+=ct}else do if(this.pos>=this.len)throw et(this);while(this.buf[this.pos++]&128);return this},tt.prototype.skipType=function(at){switch(at){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(at=this.uint32()&7)!==4;)this.skipType(at);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+at+" at offset "+this.pos)}return this},tt._configure=function(at){o=at,tt.create=nt(),o._configure();var ct=_.Long?"toLong":"toNumber";_.merge(tt.prototype,{int64:function(){return it.call(this)[ct](!1)},uint64:function(){return it.call(this)[ct](!0)},sint64:function(){return it.call(this).zzDecode()[ct](!1)},fixed64:function(){return ot.call(this)[ct](!0)},sfixed64:function(){return ot.call(this)[ct](!1)}})},reader$2}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=$;var _=requireReader();($.prototype=Object.create(_.prototype)).constructor=$;var o=requireMinimal$1();function $(j){_.call(this,j)}return $._configure=function(){o.Buffer&&($.prototype._slice=o.Buffer.prototype.slice)},$.prototype.string=function(){var et=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+et,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+et,this.len))},$._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=o;var _=requireMinimal$1();(o.prototype=Object.create(_.EventEmitter.prototype)).constructor=o;function o($,j,et){if(typeof $!="function")throw TypeError("rpcImpl must be a function");_.EventEmitter.call(this),this.rpcImpl=$,this.requestDelimited=!!j,this.responseDelimited=!!et}return o.prototype.rpcCall=function $(j,et,tt,rt,nt){if(!rt)throw TypeError("request must be specified");var it=this;if(!nt)return _.asPromise($,it,j,et,tt,rt);if(!it.rpcImpl){setTimeout(function(){nt(Error("already ended"))},0);return}try{return it.rpcImpl(j,et[it.requestDelimited?"encodeDelimited":"encode"](rt).finish(),function(ot,at){if(ot)return it.emit("error",ot,j),nt(ot);if(at===null){it.end(!0);return}if(!(at instanceof tt))try{at=tt[it.responseDelimited?"decodeDelimited":"decode"](at)}catch(ct){return it.emit("error",ct,j),nt(ct)}return it.emit("data",at,j),nt(null,at)})}catch(st){it.emit("error",st,j),setTimeout(function(){nt(st)},0);return}},o.prototype.end=function(j){return this.rpcImpl&&(j||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(_){var o=_;o.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(_){var o=_;o.build="minimal",o.Writer=requireWriter(),o.BufferWriter=requireWriter_buffer(),o.Reader=requireReader(),o.BufferReader=requireReader_buffer(),o.util=requireMinimal$1(),o.rpc=requireRpc(),o.roots=requireRoots(),o.configure=$;function $(){o.util._configure(),o.Writer._configure(o.BufferWriter),o.Reader._configure(o.BufferReader)}$()}(indexMinimal)),indexMinimal}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(_){_.exports=requireIndexMinimal()}(minimal$1)),minimalExports$1}(function(_){(function(o,$){typeof commonjsRequire$1=="function"&&_&&_.exports&&(_.exports=$(requireMinimal()))})(commonjsGlobal,function(o){var $=o.Reader,j=o.Writer,et=o.util,tt=o.roots.default||(o.roots.default={});return tt.RPC=function(){function rt(it){if(this.subscriptions=[],this.messages=[],it)for(var st=Object.keys(it),ot=0;ot<st.length;++ot)it[st[ot]]!=null&&(this[st[ot]]=it[st[ot]])}rt.prototype.subscriptions=et.emptyArray,rt.prototype.messages=et.emptyArray,rt.prototype.control=null;var nt;return Object.defineProperty(rt.prototype,"_control",{get:et.oneOfGetter(nt=["control"]),set:et.oneOfSetter(nt)}),rt.encode=function(st,ot){if(ot||(ot=j.create()),st.subscriptions!=null&&st.subscriptions.length)for(var at=0;at<st.subscriptions.length;++at)tt.RPC.SubOpts.encode(st.subscriptions[at],ot.uint32(10).fork()).ldelim();if(st.messages!=null&&st.messages.length)for(var at=0;at<st.messages.length;++at)tt.RPC.Message.encode(st.messages[at],ot.uint32(18).fork()).ldelim();return st.control!=null&&Object.hasOwnProperty.call(st,"control")&&tt.RPC.ControlMessage.encode(st.control,ot.uint32(26).fork()).ldelim(),ot},rt.decode=function(st,ot){st instanceof $||(st=$.create(st));for(var at=ot===void 0?st.len:st.pos+ot,ct=new tt.RPC;st.pos<at;){var ut=st.uint32();switch(ut>>>3){case 1:ct.subscriptions&&ct.subscriptions.length||(ct.subscriptions=[]),ct.subscriptions.push(tt.RPC.SubOpts.decode(st,st.uint32()));break;case 2:ct.messages&&ct.messages.length||(ct.messages=[]),ct.messages.push(tt.RPC.Message.decode(st,st.uint32()));break;case 3:ct.control=tt.RPC.ControlMessage.decode(st,st.uint32());break;default:st.skipType(ut&7);break}}return ct},rt.fromObject=function(st){if(st instanceof tt.RPC)return st;var ot=new tt.RPC;if(st.subscriptions){if(!Array.isArray(st.subscriptions))throw TypeError(".RPC.subscriptions: array expected");ot.subscriptions=[];for(var at=0;at<st.subscriptions.length;++at){if(typeof st.subscriptions[at]!="object")throw TypeError(".RPC.subscriptions: object expected");ot.subscriptions[at]=tt.RPC.SubOpts.fromObject(st.subscriptions[at])}}if(st.messages){if(!Array.isArray(st.messages))throw TypeError(".RPC.messages: array expected");ot.messages=[];for(var at=0;at<st.messages.length;++at){if(typeof st.messages[at]!="object")throw TypeError(".RPC.messages: object expected");ot.messages[at]=tt.RPC.Message.fromObject(st.messages[at])}}if(st.control!=null){if(typeof st.control!="object")throw TypeError(".RPC.control: object expected");ot.control=tt.RPC.ControlMessage.fromObject(st.control)}return ot},rt.toObject=function(st,ot){ot||(ot={});var at={};if((ot.arrays||ot.defaults)&&(at.subscriptions=[],at.messages=[]),st.subscriptions&&st.subscriptions.length){at.subscriptions=[];for(var ct=0;ct<st.subscriptions.length;++ct)at.subscriptions[ct]=tt.RPC.SubOpts.toObject(st.subscriptions[ct],ot)}if(st.messages&&st.messages.length){at.messages=[];for(var ct=0;ct<st.messages.length;++ct)at.messages[ct]=tt.RPC.Message.toObject(st.messages[ct],ot)}return st.control!=null&&st.hasOwnProperty("control")&&(at.control=tt.RPC.ControlMessage.toObject(st.control,ot),ot.oneofs&&(at._control="control")),at},rt.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},rt.SubOpts=function(){function it(ot){if(ot)for(var at=Object.keys(ot),ct=0;ct<at.length;++ct)ot[at[ct]]!=null&&(this[at[ct]]=ot[at[ct]])}it.prototype.subscribe=null,it.prototype.topic=null;var st;return Object.defineProperty(it.prototype,"_subscribe",{get:et.oneOfGetter(st=["subscribe"]),set:et.oneOfSetter(st)}),Object.defineProperty(it.prototype,"_topic",{get:et.oneOfGetter(st=["topic"]),set:et.oneOfSetter(st)}),it.encode=function(at,ct){return ct||(ct=j.create()),at.subscribe!=null&&Object.hasOwnProperty.call(at,"subscribe")&&ct.uint32(8).bool(at.subscribe),at.topic!=null&&Object.hasOwnProperty.call(at,"topic")&&ct.uint32(18).string(at.topic),ct},it.decode=function(at,ct){at instanceof $||(at=$.create(at));for(var ut=ct===void 0?at.len:at.pos+ct,ft=new tt.RPC.SubOpts;at.pos<ut;){var ht=at.uint32();switch(ht>>>3){case 1:ft.subscribe=at.bool();break;case 2:ft.topic=at.string();break;default:at.skipType(ht&7);break}}return ft},it.fromObject=function(at){if(at instanceof tt.RPC.SubOpts)return at;var ct=new tt.RPC.SubOpts;return at.subscribe!=null&&(ct.subscribe=!!at.subscribe),at.topic!=null&&(ct.topic=String(at.topic)),ct},it.toObject=function(at,ct){ct||(ct={});var ut={};return at.subscribe!=null&&at.hasOwnProperty("subscribe")&&(ut.subscribe=at.subscribe,ct.oneofs&&(ut._subscribe="subscribe")),at.topic!=null&&at.hasOwnProperty("topic")&&(ut.topic=at.topic,ct.oneofs&&(ut._topic="topic")),ut},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt.Message=function(){function it(ot){if(ot)for(var at=Object.keys(ot),ct=0;ct<at.length;++ct)ot[at[ct]]!=null&&(this[at[ct]]=ot[at[ct]])}it.prototype.from=null,it.prototype.data=null,it.prototype.seqno=null,it.prototype.topic="",it.prototype.signature=null,it.prototype.key=null;var st;return Object.defineProperty(it.prototype,"_from",{get:et.oneOfGetter(st=["from"]),set:et.oneOfSetter(st)}),Object.defineProperty(it.prototype,"_data",{get:et.oneOfGetter(st=["data"]),set:et.oneOfSetter(st)}),Object.defineProperty(it.prototype,"_seqno",{get:et.oneOfGetter(st=["seqno"]),set:et.oneOfSetter(st)}),Object.defineProperty(it.prototype,"_signature",{get:et.oneOfGetter(st=["signature"]),set:et.oneOfSetter(st)}),Object.defineProperty(it.prototype,"_key",{get:et.oneOfGetter(st=["key"]),set:et.oneOfSetter(st)}),it.encode=function(at,ct){return ct||(ct=j.create()),at.from!=null&&Object.hasOwnProperty.call(at,"from")&&ct.uint32(10).bytes(at.from),at.data!=null&&Object.hasOwnProperty.call(at,"data")&&ct.uint32(18).bytes(at.data),at.seqno!=null&&Object.hasOwnProperty.call(at,"seqno")&&ct.uint32(26).bytes(at.seqno),ct.uint32(34).string(at.topic),at.signature!=null&&Object.hasOwnProperty.call(at,"signature")&&ct.uint32(42).bytes(at.signature),at.key!=null&&Object.hasOwnProperty.call(at,"key")&&ct.uint32(50).bytes(at.key),ct},it.decode=function(at,ct){at instanceof $||(at=$.create(at));for(var ut=ct===void 0?at.len:at.pos+ct,ft=new tt.RPC.Message;at.pos<ut;){var ht=at.uint32();switch(ht>>>3){case 1:ft.from=at.bytes();break;case 2:ft.data=at.bytes();break;case 3:ft.seqno=at.bytes();break;case 4:ft.topic=at.string();break;case 5:ft.signature=at.bytes();break;case 6:ft.key=at.bytes();break;default:at.skipType(ht&7);break}}if(!ft.hasOwnProperty("topic"))throw et.ProtocolError("missing required 'topic'",{instance:ft});return ft},it.fromObject=function(at){if(at instanceof tt.RPC.Message)return at;var ct=new tt.RPC.Message;return at.from!=null&&(typeof at.from=="string"?et.base64.decode(at.from,ct.from=et.newBuffer(et.base64.length(at.from)),0):at.from.length&&(ct.from=at.from)),at.data!=null&&(typeof at.data=="string"?et.base64.decode(at.data,ct.data=et.newBuffer(et.base64.length(at.data)),0):at.data.length&&(ct.data=at.data)),at.seqno!=null&&(typeof at.seqno=="string"?et.base64.decode(at.seqno,ct.seqno=et.newBuffer(et.base64.length(at.seqno)),0):at.seqno.length&&(ct.seqno=at.seqno)),at.topic!=null&&(ct.topic=String(at.topic)),at.signature!=null&&(typeof at.signature=="string"?et.base64.decode(at.signature,ct.signature=et.newBuffer(et.base64.length(at.signature)),0):at.signature.length&&(ct.signature=at.signature)),at.key!=null&&(typeof at.key=="string"?et.base64.decode(at.key,ct.key=et.newBuffer(et.base64.length(at.key)),0):at.key.length&&(ct.key=at.key)),ct},it.toObject=function(at,ct){ct||(ct={});var ut={};return ct.defaults&&(ut.topic=""),at.from!=null&&at.hasOwnProperty("from")&&(ut.from=ct.bytes===String?et.base64.encode(at.from,0,at.from.length):ct.bytes===Array?Array.prototype.slice.call(at.from):at.from,ct.oneofs&&(ut._from="from")),at.data!=null&&at.hasOwnProperty("data")&&(ut.data=ct.bytes===String?et.base64.encode(at.data,0,at.data.length):ct.bytes===Array?Array.prototype.slice.call(at.data):at.data,ct.oneofs&&(ut._data="data")),at.seqno!=null&&at.hasOwnProperty("seqno")&&(ut.seqno=ct.bytes===String?et.base64.encode(at.seqno,0,at.seqno.length):ct.bytes===Array?Array.prototype.slice.call(at.seqno):at.seqno,ct.oneofs&&(ut._seqno="seqno")),at.topic!=null&&at.hasOwnProperty("topic")&&(ut.topic=at.topic),at.signature!=null&&at.hasOwnProperty("signature")&&(ut.signature=ct.bytes===String?et.base64.encode(at.signature,0,at.signature.length):ct.bytes===Array?Array.prototype.slice.call(at.signature):at.signature,ct.oneofs&&(ut._signature="signature")),at.key!=null&&at.hasOwnProperty("key")&&(ut.key=ct.bytes===String?et.base64.encode(at.key,0,at.key.length):ct.bytes===Array?Array.prototype.slice.call(at.key):at.key,ct.oneofs&&(ut._key="key")),ut},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt.ControlMessage=function(){function it(st){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}return it.prototype.ihave=et.emptyArray,it.prototype.iwant=et.emptyArray,it.prototype.graft=et.emptyArray,it.prototype.prune=et.emptyArray,it.encode=function(ot,at){if(at||(at=j.create()),ot.ihave!=null&&ot.ihave.length)for(var ct=0;ct<ot.ihave.length;++ct)tt.RPC.ControlIHave.encode(ot.ihave[ct],at.uint32(10).fork()).ldelim();if(ot.iwant!=null&&ot.iwant.length)for(var ct=0;ct<ot.iwant.length;++ct)tt.RPC.ControlIWant.encode(ot.iwant[ct],at.uint32(18).fork()).ldelim();if(ot.graft!=null&&ot.graft.length)for(var ct=0;ct<ot.graft.length;++ct)tt.RPC.ControlGraft.encode(ot.graft[ct],at.uint32(26).fork()).ldelim();if(ot.prune!=null&&ot.prune.length)for(var ct=0;ct<ot.prune.length;++ct)tt.RPC.ControlPrune.encode(ot.prune[ct],at.uint32(34).fork()).ldelim();return at},it.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var ct=at===void 0?ot.len:ot.pos+at,ut=new tt.RPC.ControlMessage;ot.pos<ct;){var ft=ot.uint32();switch(ft>>>3){case 1:ut.ihave&&ut.ihave.length||(ut.ihave=[]),ut.ihave.push(tt.RPC.ControlIHave.decode(ot,ot.uint32()));break;case 2:ut.iwant&&ut.iwant.length||(ut.iwant=[]),ut.iwant.push(tt.RPC.ControlIWant.decode(ot,ot.uint32()));break;case 3:ut.graft&&ut.graft.length||(ut.graft=[]),ut.graft.push(tt.RPC.ControlGraft.decode(ot,ot.uint32()));break;case 4:ut.prune&&ut.prune.length||(ut.prune=[]),ut.prune.push(tt.RPC.ControlPrune.decode(ot,ot.uint32()));break;default:ot.skipType(ft&7);break}}return ut},it.fromObject=function(ot){if(ot instanceof tt.RPC.ControlMessage)return ot;var at=new tt.RPC.ControlMessage;if(ot.ihave){if(!Array.isArray(ot.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");at.ihave=[];for(var ct=0;ct<ot.ihave.length;++ct){if(typeof ot.ihave[ct]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");at.ihave[ct]=tt.RPC.ControlIHave.fromObject(ot.ihave[ct])}}if(ot.iwant){if(!Array.isArray(ot.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");at.iwant=[];for(var ct=0;ct<ot.iwant.length;++ct){if(typeof ot.iwant[ct]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");at.iwant[ct]=tt.RPC.ControlIWant.fromObject(ot.iwant[ct])}}if(ot.graft){if(!Array.isArray(ot.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");at.graft=[];for(var ct=0;ct<ot.graft.length;++ct){if(typeof ot.graft[ct]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");at.graft[ct]=tt.RPC.ControlGraft.fromObject(ot.graft[ct])}}if(ot.prune){if(!Array.isArray(ot.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");at.prune=[];for(var ct=0;ct<ot.prune.length;++ct){if(typeof ot.prune[ct]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");at.prune[ct]=tt.RPC.ControlPrune.fromObject(ot.prune[ct])}}return at},it.toObject=function(ot,at){at||(at={});var ct={};if((at.arrays||at.defaults)&&(ct.ihave=[],ct.iwant=[],ct.graft=[],ct.prune=[]),ot.ihave&&ot.ihave.length){ct.ihave=[];for(var ut=0;ut<ot.ihave.length;++ut)ct.ihave[ut]=tt.RPC.ControlIHave.toObject(ot.ihave[ut],at)}if(ot.iwant&&ot.iwant.length){ct.iwant=[];for(var ut=0;ut<ot.iwant.length;++ut)ct.iwant[ut]=tt.RPC.ControlIWant.toObject(ot.iwant[ut],at)}if(ot.graft&&ot.graft.length){ct.graft=[];for(var ut=0;ut<ot.graft.length;++ut)ct.graft[ut]=tt.RPC.ControlGraft.toObject(ot.graft[ut],at)}if(ot.prune&&ot.prune.length){ct.prune=[];for(var ut=0;ut<ot.prune.length;++ut)ct.prune[ut]=tt.RPC.ControlPrune.toObject(ot.prune[ut],at)}return ct},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt.ControlIHave=function(){function it(ot){if(this.messageIDs=[],ot)for(var at=Object.keys(ot),ct=0;ct<at.length;++ct)ot[at[ct]]!=null&&(this[at[ct]]=ot[at[ct]])}it.prototype.topicID=null,it.prototype.messageIDs=et.emptyArray;var st;return Object.defineProperty(it.prototype,"_topicID",{get:et.oneOfGetter(st=["topicID"]),set:et.oneOfSetter(st)}),it.encode=function(at,ct){if(ct||(ct=j.create()),at.topicID!=null&&Object.hasOwnProperty.call(at,"topicID")&&ct.uint32(10).string(at.topicID),at.messageIDs!=null&&at.messageIDs.length)for(var ut=0;ut<at.messageIDs.length;++ut)ct.uint32(18).bytes(at.messageIDs[ut]);return ct},it.decode=function(at,ct){at instanceof $||(at=$.create(at));for(var ut=ct===void 0?at.len:at.pos+ct,ft=new tt.RPC.ControlIHave;at.pos<ut;){var ht=at.uint32();switch(ht>>>3){case 1:ft.topicID=at.string();break;case 2:ft.messageIDs&&ft.messageIDs.length||(ft.messageIDs=[]),ft.messageIDs.push(at.bytes());break;default:at.skipType(ht&7);break}}return ft},it.fromObject=function(at){if(at instanceof tt.RPC.ControlIHave)return at;var ct=new tt.RPC.ControlIHave;if(at.topicID!=null&&(ct.topicID=String(at.topicID)),at.messageIDs){if(!Array.isArray(at.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");ct.messageIDs=[];for(var ut=0;ut<at.messageIDs.length;++ut)typeof at.messageIDs[ut]=="string"?et.base64.decode(at.messageIDs[ut],ct.messageIDs[ut]=et.newBuffer(et.base64.length(at.messageIDs[ut])),0):at.messageIDs[ut].length&&(ct.messageIDs[ut]=at.messageIDs[ut])}return ct},it.toObject=function(at,ct){ct||(ct={});var ut={};if((ct.arrays||ct.defaults)&&(ut.messageIDs=[]),at.topicID!=null&&at.hasOwnProperty("topicID")&&(ut.topicID=at.topicID,ct.oneofs&&(ut._topicID="topicID")),at.messageIDs&&at.messageIDs.length){ut.messageIDs=[];for(var ft=0;ft<at.messageIDs.length;++ft)ut.messageIDs[ft]=ct.bytes===String?et.base64.encode(at.messageIDs[ft],0,at.messageIDs[ft].length):ct.bytes===Array?Array.prototype.slice.call(at.messageIDs[ft]):at.messageIDs[ft]}return ut},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt.ControlIWant=function(){function it(st){if(this.messageIDs=[],st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}return it.prototype.messageIDs=et.emptyArray,it.encode=function(ot,at){if(at||(at=j.create()),ot.messageIDs!=null&&ot.messageIDs.length)for(var ct=0;ct<ot.messageIDs.length;++ct)at.uint32(10).bytes(ot.messageIDs[ct]);return at},it.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var ct=at===void 0?ot.len:ot.pos+at,ut=new tt.RPC.ControlIWant;ot.pos<ct;){var ft=ot.uint32();switch(ft>>>3){case 1:ut.messageIDs&&ut.messageIDs.length||(ut.messageIDs=[]),ut.messageIDs.push(ot.bytes());break;default:ot.skipType(ft&7);break}}return ut},it.fromObject=function(ot){if(ot instanceof tt.RPC.ControlIWant)return ot;var at=new tt.RPC.ControlIWant;if(ot.messageIDs){if(!Array.isArray(ot.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");at.messageIDs=[];for(var ct=0;ct<ot.messageIDs.length;++ct)typeof ot.messageIDs[ct]=="string"?et.base64.decode(ot.messageIDs[ct],at.messageIDs[ct]=et.newBuffer(et.base64.length(ot.messageIDs[ct])),0):ot.messageIDs[ct].length&&(at.messageIDs[ct]=ot.messageIDs[ct])}return at},it.toObject=function(ot,at){at||(at={});var ct={};if((at.arrays||at.defaults)&&(ct.messageIDs=[]),ot.messageIDs&&ot.messageIDs.length){ct.messageIDs=[];for(var ut=0;ut<ot.messageIDs.length;++ut)ct.messageIDs[ut]=at.bytes===String?et.base64.encode(ot.messageIDs[ut],0,ot.messageIDs[ut].length):at.bytes===Array?Array.prototype.slice.call(ot.messageIDs[ut]):ot.messageIDs[ut]}return ct},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt.ControlGraft=function(){function it(ot){if(ot)for(var at=Object.keys(ot),ct=0;ct<at.length;++ct)ot[at[ct]]!=null&&(this[at[ct]]=ot[at[ct]])}it.prototype.topicID=null;var st;return Object.defineProperty(it.prototype,"_topicID",{get:et.oneOfGetter(st=["topicID"]),set:et.oneOfSetter(st)}),it.encode=function(at,ct){return ct||(ct=j.create()),at.topicID!=null&&Object.hasOwnProperty.call(at,"topicID")&&ct.uint32(10).string(at.topicID),ct},it.decode=function(at,ct){at instanceof $||(at=$.create(at));for(var ut=ct===void 0?at.len:at.pos+ct,ft=new tt.RPC.ControlGraft;at.pos<ut;){var ht=at.uint32();switch(ht>>>3){case 1:ft.topicID=at.string();break;default:at.skipType(ht&7);break}}return ft},it.fromObject=function(at){if(at instanceof tt.RPC.ControlGraft)return at;var ct=new tt.RPC.ControlGraft;return at.topicID!=null&&(ct.topicID=String(at.topicID)),ct},it.toObject=function(at,ct){ct||(ct={});var ut={};return at.topicID!=null&&at.hasOwnProperty("topicID")&&(ut.topicID=at.topicID,ct.oneofs&&(ut._topicID="topicID")),ut},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt.ControlPrune=function(){function it(ot){if(this.peers=[],ot)for(var at=Object.keys(ot),ct=0;ct<at.length;++ct)ot[at[ct]]!=null&&(this[at[ct]]=ot[at[ct]])}it.prototype.topicID=null,it.prototype.peers=et.emptyArray,it.prototype.backoff=null;var st;return Object.defineProperty(it.prototype,"_topicID",{get:et.oneOfGetter(st=["topicID"]),set:et.oneOfSetter(st)}),Object.defineProperty(it.prototype,"_backoff",{get:et.oneOfGetter(st=["backoff"]),set:et.oneOfSetter(st)}),it.encode=function(at,ct){if(ct||(ct=j.create()),at.topicID!=null&&Object.hasOwnProperty.call(at,"topicID")&&ct.uint32(10).string(at.topicID),at.peers!=null&&at.peers.length)for(var ut=0;ut<at.peers.length;++ut)tt.RPC.PeerInfo.encode(at.peers[ut],ct.uint32(18).fork()).ldelim();return at.backoff!=null&&Object.hasOwnProperty.call(at,"backoff")&&ct.uint32(24).uint64(at.backoff),ct},it.decode=function(at,ct){at instanceof $||(at=$.create(at));for(var ut=ct===void 0?at.len:at.pos+ct,ft=new tt.RPC.ControlPrune;at.pos<ut;){var ht=at.uint32();switch(ht>>>3){case 1:ft.topicID=at.string();break;case 2:ft.peers&&ft.peers.length||(ft.peers=[]),ft.peers.push(tt.RPC.PeerInfo.decode(at,at.uint32()));break;case 3:ft.backoff=at.uint64();break;default:at.skipType(ht&7);break}}return ft},it.fromObject=function(at){if(at instanceof tt.RPC.ControlPrune)return at;var ct=new tt.RPC.ControlPrune;if(at.topicID!=null&&(ct.topicID=String(at.topicID)),at.peers){if(!Array.isArray(at.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");ct.peers=[];for(var ut=0;ut<at.peers.length;++ut){if(typeof at.peers[ut]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");ct.peers[ut]=tt.RPC.PeerInfo.fromObject(at.peers[ut])}}return at.backoff!=null&&(et.Long?(ct.backoff=et.Long.fromValue(at.backoff)).unsigned=!0:typeof at.backoff=="string"?ct.backoff=parseInt(at.backoff,10):typeof at.backoff=="number"?ct.backoff=at.backoff:typeof at.backoff=="object"&&(ct.backoff=new et.LongBits(at.backoff.low>>>0,at.backoff.high>>>0).toNumber(!0))),ct},it.toObject=function(at,ct){ct||(ct={});var ut={};if((ct.arrays||ct.defaults)&&(ut.peers=[]),at.topicID!=null&&at.hasOwnProperty("topicID")&&(ut.topicID=at.topicID,ct.oneofs&&(ut._topicID="topicID")),at.peers&&at.peers.length){ut.peers=[];for(var ft=0;ft<at.peers.length;++ft)ut.peers[ft]=tt.RPC.PeerInfo.toObject(at.peers[ft],ct)}return at.backoff!=null&&at.hasOwnProperty("backoff")&&(typeof at.backoff=="number"?ut.backoff=ct.longs===String?String(at.backoff):at.backoff:ut.backoff=ct.longs===String?et.Long.prototype.toString.call(at.backoff):ct.longs===Number?new et.LongBits(at.backoff.low>>>0,at.backoff.high>>>0).toNumber(!0):at.backoff,ct.oneofs&&(ut._backoff="backoff")),ut},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt.PeerInfo=function(){function it(ot){if(ot)for(var at=Object.keys(ot),ct=0;ct<at.length;++ct)ot[at[ct]]!=null&&(this[at[ct]]=ot[at[ct]])}it.prototype.peerID=null,it.prototype.signedPeerRecord=null;var st;return Object.defineProperty(it.prototype,"_peerID",{get:et.oneOfGetter(st=["peerID"]),set:et.oneOfSetter(st)}),Object.defineProperty(it.prototype,"_signedPeerRecord",{get:et.oneOfGetter(st=["signedPeerRecord"]),set:et.oneOfSetter(st)}),it.encode=function(at,ct){return ct||(ct=j.create()),at.peerID!=null&&Object.hasOwnProperty.call(at,"peerID")&&ct.uint32(10).bytes(at.peerID),at.signedPeerRecord!=null&&Object.hasOwnProperty.call(at,"signedPeerRecord")&&ct.uint32(18).bytes(at.signedPeerRecord),ct},it.decode=function(at,ct){at instanceof $||(at=$.create(at));for(var ut=ct===void 0?at.len:at.pos+ct,ft=new tt.RPC.PeerInfo;at.pos<ut;){var ht=at.uint32();switch(ht>>>3){case 1:ft.peerID=at.bytes();break;case 2:ft.signedPeerRecord=at.bytes();break;default:at.skipType(ht&7);break}}return ft},it.fromObject=function(at){if(at instanceof tt.RPC.PeerInfo)return at;var ct=new tt.RPC.PeerInfo;return at.peerID!=null&&(typeof at.peerID=="string"?et.base64.decode(at.peerID,ct.peerID=et.newBuffer(et.base64.length(at.peerID)),0):at.peerID.length&&(ct.peerID=at.peerID)),at.signedPeerRecord!=null&&(typeof at.signedPeerRecord=="string"?et.base64.decode(at.signedPeerRecord,ct.signedPeerRecord=et.newBuffer(et.base64.length(at.signedPeerRecord)),0):at.signedPeerRecord.length&&(ct.signedPeerRecord=at.signedPeerRecord)),ct},it.toObject=function(at,ct){ct||(ct={});var ut={};return at.peerID!=null&&at.hasOwnProperty("peerID")&&(ut.peerID=ct.bytes===String?et.base64.encode(at.peerID,0,at.peerID.length):ct.bytes===Array?Array.prototype.slice.call(at.peerID):at.peerID,ct.oneofs&&(ut._peerID="peerID")),at.signedPeerRecord!=null&&at.hasOwnProperty("signedPeerRecord")&&(ut.signedPeerRecord=ct.bytes===String?et.base64.encode(at.signedPeerRecord,0,at.signedPeerRecord.length):ct.bytes===Array?Array.prototype.slice.call(at.signedPeerRecord):at.signedPeerRecord,ct.oneofs&&(ut._signedPeerRecord="signedPeerRecord")),ut},it.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},it}(),rt}(),tt})})(rpc$1);const cjs=rpcExports,{RPC:RPC$1}=cjs,second$1=1e3,minute$2=60*second$1,FloodsubID="/floodsub/1.0.0",GossipsubIDv10="/meshsub/1.0.0",GossipsubIDv11="/meshsub/1.1.0",GossipsubD=6,GossipsubDlo=4,GossipsubDhi=12,GossipsubDscore=4,GossipsubDout=2,GossipsubHistoryLength=5,GossipsubHistoryGossip=3,GossipsubDlazy=6,GossipsubGossipFactor=.25,GossipsubGossipRetransmission=3,GossipsubHeartbeatInitialDelay=100,GossipsubHeartbeatInterval=second$1,GossipsubFanoutTTL=minute$2,GossipsubPrunePeers=16,GossipsubPruneBackoff=minute$2,GossipsubPruneBackoffTicks=15,GossipsubDirectConnectTicks=300,GossipsubDirectConnectInitialDelay=second$1,GossipsubOpportunisticGraftTicks=60,GossipsubOpportunisticGraftPeers=2,GossipsubGraftFloodThreshold=10*second$1,GossipsubMaxIHaveLength=5e3,GossipsubMaxIHaveMessages=10,GossipsubIWantFollowupTime=3*second$1,GossipsubSeenTTL=2*minute$2,TimeCacheDuration=120*1e3,ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT",ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE",ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0,ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128,ACCEPT_FROM_WHITELIST_DURATION_MS=1e3,DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS=1e3;function shuffle(_){if(_.length<=1)return _;const o=()=>Math.floor(Math.random()*Math.floor(_.length));for(let $=0;$<_.length;$++){const j=o(),et=_[$];_[$]=_[j],_[j]=et}return _}function messageIdToString(_){return toString$a(_,"base64")}const StrictSign="StrictSign",StrictNoSign="StrictNoSign";var TopicValidatorResult;(function(_){_.Accept="accept",_.Ignore="ignore",_.Reject="reject"})(TopicValidatorResult||(TopicValidatorResult={}));var SignaturePolicy;(function(_){_.StrictSign="StrictSign",_.StrictNoSign="StrictNoSign"})(SignaturePolicy||(SignaturePolicy={}));var PublishConfigType;(function(_){_[_.Signing=0]="Signing",_[_.Anonymous=1]="Anonymous"})(PublishConfigType||(PublishConfigType={}));var RejectReason;(function(_){_.Error="error",_.Ignore="ignore",_.Reject="reject",_.Blacklisted="blacklisted"})(RejectReason||(RejectReason={}));var ValidateError;(function(_){_.InvalidSignature="invalid_signature",_.InvalidSeqno="invalid_seqno",_.InvalidPeerId="invalid_peerid",_.SignaturePresent="signature_present",_.SeqnoPresent="seqno_present",_.FromPresent="from_present",_.TransformFailed="transform_failed"})(ValidateError||(ValidateError={}));var MessageStatus;(function(_){_.duplicate="duplicate",_.invalid="invalid",_.valid="valid"})(MessageStatus||(MessageStatus={}));function rejectReasonFromAcceptance(_){switch(_){case TopicValidatorResult.Ignore:return RejectReason.Ignore;case TopicValidatorResult.Reject:return RejectReason.Reject}}async function getPublishConfigFromPeerId(_,o){switch(_){case StrictSign:{if(!o)throw Error("Must provide PeerId");if(o.privateKey==null)throw Error("Cannot sign message, no private key present");if(o.publicKey==null)throw Error("Cannot sign message, no public key present");const $=await unmarshalPrivateKey(o.privateKey);return{type:PublishConfigType.Signing,author:o,key:o.publicKey,privateKey:$}}case StrictNoSign:return{type:PublishConfigType.Anonymous};default:throw new Error(`Unknown signature policy "${_}"`)}}const ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS",defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function createPeerScoreParams(_={}){return{...defaultPeerScoreParams,..._,topics:_.topics?Object.entries(_.topics).reduce((o,[$,j])=>(o[$]=createTopicScoreParams(j),o),{}):{}}}function createTopicScoreParams(_={}){return{...defaultTopicScoreParams,..._}}function validatePeerScoreParams(_){for(const[o,$]of Object.entries(_.topics))try{validateTopicScoreParams($)}catch(j){throw new CodeError(`invalid score parameters for topic ${o}: ${j.message}`,ERR_INVALID_PEER_SCORE_PARAMS)}if(_.topicScoreCap<0)throw new CodeError("invalid topic score cap; must be positive (or 0 for no cap)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.appSpecificScore===null||_.appSpecificScore===void 0)throw new CodeError("missing application specific score function",ERR_INVALID_PEER_SCORE_PARAMS);if(_.IPColocationFactorWeight>0)throw new CodeError("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.IPColocationFactorWeight!==0&&_.IPColocationFactorThreshold<1)throw new CodeError("invalid IPColocationFactorThreshold; must be at least 1",ERR_INVALID_PEER_SCORE_PARAMS);if(_.behaviourPenaltyWeight>0)throw new CodeError("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.behaviourPenaltyWeight!==0&&(_.behaviourPenaltyDecay<=0||_.behaviourPenaltyDecay>=1))throw new CodeError("invalid BehaviourPenaltyDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(_.decayInterval<1e3)throw new CodeError("invalid DecayInterval; must be at least 1s",ERR_INVALID_PEER_SCORE_PARAMS);if(_.decayToZero<=0||_.decayToZero>=1)throw new CodeError("invalid DecayToZero; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS)}function validateTopicScoreParams(_){if(_.topicWeight<0)throw new CodeError("invalid topic weight; must be >= 0",ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshQuantum===0)throw new CodeError("invalid TimeInMeshQuantum; must be non zero",ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshWeight<0)throw new CodeError("invalid TimeInMeshWeight; must be positive (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshWeight!==0&&_.timeInMeshQuantum<=0)throw new CodeError("invalid TimeInMeshQuantum; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshWeight!==0&&_.timeInMeshCap<=0)throw new CodeError("invalid TimeInMeshCap; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(_.firstMessageDeliveriesWeight<0)throw new CodeError("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.firstMessageDeliveriesWeight!==0&&(_.firstMessageDeliveriesDecay<=0||_.firstMessageDeliveriesDecay>=1))throw new CodeError("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(_.firstMessageDeliveriesWeight!==0&&_.firstMessageDeliveriesCap<=0)throw new CodeError("invalid FirstMessageDeliveriesCap; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight>0)throw new CodeError("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&(_.meshMessageDeliveriesDecay<=0||_.meshMessageDeliveriesDecay>=1))throw new CodeError("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&_.meshMessageDeliveriesCap<=0)throw new CodeError("invalid MeshMessageDeliveriesCap; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&_.meshMessageDeliveriesThreshold<=0)throw new CodeError("invalid MeshMessageDeliveriesThreshold; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWindow<0)throw new CodeError("invalid MeshMessageDeliveriesWindow; must be non-negative",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&_.meshMessageDeliveriesActivation<1e3)throw new CodeError("invalid MeshMessageDeliveriesActivation; must be at least 1s",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshFailurePenaltyWeight>0)throw new CodeError("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshFailurePenaltyWeight!==0&&(_.meshFailurePenaltyDecay<=0||_.meshFailurePenaltyDecay>=1))throw new CodeError("invalid MeshFailurePenaltyDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(_.invalidMessageDeliveriesWeight>0)throw new CodeError("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(_.invalidMessageDeliveriesDecay<=0||_.invalidMessageDeliveriesDecay>=1)throw new CodeError("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS)}const defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function createPeerScoreThresholds(_={}){return{...defaultPeerScoreThresholds,..._}}function computeScore(_,o,$,j){let et=0;Object.entries(o.topics).forEach(([rt,nt])=>{const it=$.topics[rt];if(it===void 0)return;let st=0;if(nt.inMesh){let ut=nt.meshTime/it.timeInMeshQuantum;ut>it.timeInMeshCap&&(ut=it.timeInMeshCap),st+=ut*it.timeInMeshWeight}let ot=nt.firstMessageDeliveries;if(ot>it.firstMessageDeliveriesCap&&(ot=it.firstMessageDeliveriesCap),st+=ot*it.firstMessageDeliveriesWeight,nt.meshMessageDeliveriesActive&&nt.meshMessageDeliveries<it.meshMessageDeliveriesThreshold){const ut=it.meshMessageDeliveriesThreshold-nt.meshMessageDeliveries,ft=ut*ut;st+=ft*it.meshMessageDeliveriesWeight}const at=nt.meshFailurePenalty;st+=at*it.meshFailurePenaltyWeight;const ct=nt.invalidMessageDeliveries*nt.invalidMessageDeliveries;st+=ct*it.invalidMessageDeliveriesWeight,et+=st*it.topicWeight}),$.topicScoreCap>0&&et>$.topicScoreCap&&(et=$.topicScoreCap);const tt=$.appSpecificScore(_);if(et+=tt*$.appSpecificWeight,o.knownIPs.forEach(rt=>{if($.IPColocationFactorWhitelist.has(rt))return;const nt=j.get(rt),it=nt?nt.size:0;if(it>$.IPColocationFactorThreshold){const st=it-$.IPColocationFactorThreshold,ot=st*st;et+=ot*$.IPColocationFactorWeight}}),o.behaviourPenalty>$.behaviourPenaltyThreshold){const rt=o.behaviourPenalty-$.behaviourPenaltyThreshold,nt=rt*rt;et+=nt*$.behaviourPenaltyWeight}return et}function Denque(_,$){var $=$||{};this._head=0,this._tail=0,this._capacity=$.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(_)&&this._fromArray(_)}Denque.prototype.peekAt=function _(o){var $=o;if($===($|0)){var j=this.size();if(!($>=j||$<-j))return $<0&&($+=j),$=this._head+$&this._capacityMask,this._list[$]}};Denque.prototype.get=function _(o){return this.peekAt(o)};Denque.prototype.peek=function _(){if(this._head!==this._tail)return this._list[this._head]};Denque.prototype.peekFront=function _(){return this.peek()};Denque.prototype.peekBack=function _(){return this.peekAt(-1)};Object.defineProperty(Denque.prototype,"length",{get:function _(){return this.size()}});Denque.prototype.size=function _(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.unshift=function _(o){if(o===void 0)return this.size();var $=this._list.length;return this._head=this._head-1+$&this._capacityMask,this._list[this._head]=o,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.shift=function _(){var o=this._head;if(o!==this._tail){var $=this._list[o];return this._list[o]=void 0,this._head=o+1&this._capacityMask,o<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),$}};Denque.prototype.push=function _(o){if(o===void 0)return this.size();var $=this._tail;return this._list[$]=o,this._tail=$+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.pop=function _(){var o=this._tail;if(o!==this._head){var $=this._list.length;this._tail=o-1+$&this._capacityMask;var j=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&o>1e4&&o<=$>>>2&&this._shrinkArray(),j}};Denque.prototype.removeOne=function _(o){var $=o;if($===($|0)&&this._head!==this._tail){var j=this.size(),et=this._list.length;if(!($>=j||$<-j)){$<0&&($+=j),$=this._head+$&this._capacityMask;var tt=this._list[$],rt;if(o<j/2){for(rt=o;rt>0;rt--)this._list[$]=this._list[$=$-1+et&this._capacityMask];this._list[$]=void 0,this._head=this._head+1+et&this._capacityMask}else{for(rt=j-1-o;rt>0;rt--)this._list[$]=this._list[$=$+1+et&this._capacityMask];this._list[$]=void 0,this._tail=this._tail-1+et&this._capacityMask}return tt}}};Denque.prototype.remove=function _(o,$){var j=o,et,tt=$;if(j===(j|0)&&this._head!==this._tail){var rt=this.size(),nt=this._list.length;if(!(j>=rt||j<-rt||$<1)){if(j<0&&(j+=rt),$===1||!$)return et=new Array(1),et[0]=this.removeOne(j),et;if(j===0&&j+$>=rt)return et=this.toArray(),this.clear(),et;j+$>rt&&($=rt-j);var it;for(et=new Array($),it=0;it<$;it++)et[it]=this._list[this._head+j+it&this._capacityMask];if(j=this._head+j&this._capacityMask,o+$===rt){for(this._tail=this._tail-$+nt&this._capacityMask,it=$;it>0;it--)this._list[j=j+1+nt&this._capacityMask]=void 0;return et}if(o===0){for(this._head=this._head+$+nt&this._capacityMask,it=$-1;it>0;it--)this._list[j=j+1+nt&this._capacityMask]=void 0;return et}if(j<rt/2){for(this._head=this._head+o+$+nt&this._capacityMask,it=o;it>0;it--)this.unshift(this._list[j=j-1+nt&this._capacityMask]);for(j=this._head-1+nt&this._capacityMask;tt>0;)this._list[j=j-1+nt&this._capacityMask]=void 0,tt--;o<0&&(this._tail=j)}else{for(this._tail=j,j=j+$+nt&this._capacityMask,it=rt-($+o);it>0;it--)this.push(this._list[j++]);for(j=this._tail;tt>0;)this._list[j=j+1+nt&this._capacityMask]=void 0,tt--}return this._head<2&&this._tail>1e4&&this._tail<=nt>>>2&&this._shrinkArray(),et}}};Denque.prototype.splice=function _(o,$){var j=o;if(j===(j|0)){var et=this.size();if(j<0&&(j+=et),!(j>et))if(arguments.length>2){var tt,rt,nt,it=arguments.length,st=this._list.length,ot=2;if(!et||j<et/2){for(rt=new Array(j),tt=0;tt<j;tt++)rt[tt]=this._list[this._head+tt&this._capacityMask];for($===0?(nt=[],j>0&&(this._head=this._head+j+st&this._capacityMask)):(nt=this.remove(j,$),this._head=this._head+j+st&this._capacityMask);it>ot;)this.unshift(arguments[--it]);for(tt=j;tt>0;tt--)this.unshift(rt[tt-1])}else{rt=new Array(et-(j+$));var at=rt.length;for(tt=0;tt<at;tt++)rt[tt]=this._list[this._head+j+$+tt&this._capacityMask];for($===0?(nt=[],j!=et&&(this._tail=this._head+j+st&this._capacityMask)):(nt=this.remove(j,$),this._tail=this._tail-at+st&this._capacityMask);ot<it;)this.push(arguments[ot++]);for(tt=0;tt<at;tt++)this.push(rt[tt])}return nt}else return this.remove(j,$)}};Denque.prototype.clear=function _(){this._head=0,this._tail=0};Denque.prototype.isEmpty=function _(){return this._head===this._tail};Denque.prototype.toArray=function _(){return this._copyArray(!1)};Denque.prototype._fromArray=function _(o){for(var $=0;$<o.length;$++)this.push(o[$])};Denque.prototype._copyArray=function _(o){var $=[],j=this._list,et=j.length,tt;if(o||this._head>this._tail){for(tt=this._head;tt<et;tt++)$.push(j[tt]);for(tt=0;tt<this._tail;tt++)$.push(j[tt])}else for(tt=this._head;tt<this._tail;tt++)$.push(j[tt]);return $};Denque.prototype._growArray=function _(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};Denque.prototype._shrinkArray=function _(){this._list.length>>>=1,this._capacityMask>>>=1};var denque=Denque,DeliveryRecordStatus;(function(_){_[_.unknown=0]="unknown",_[_.valid=1]="valid",_[_.invalid=2]="invalid",_[_.ignored=3]="ignored"})(DeliveryRecordStatus||(DeliveryRecordStatus={}));class MessageDeliveries{constructor(){this.records=new Map,this.queue=new denque}ensureRecord(o){let $=this.records.get(o);if($)return $;$={status:DeliveryRecordStatus.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(o,$);const j={msgId:o,expire:Date.now()+TimeCacheDuration};return this.queue.push(j),$}gc(){const o=Date.now();let $=this.queue.peekFront();for(;$&&$.expire<o;)this.records.delete($.msgId),this.queue.shift(),$=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function removeItemsFromSet(_,o,$=()=>!0){const j=new Set;if(o<=0)return j;for(const et of _){if(j.size>=o)break;$(et)&&(j.add(et),_.delete(et))}return j}function removeFirstNItemsFromSet(_,o){return removeItemsFromSet(_,o,()=>!0)}class MapDef extends Map{constructor(o){super(),this.getDefault=o}getOrDefault(o){let $=super.get(o);return $===void 0&&($=this.getDefault(),this.set(o,$)),$}}const log$Y=logger$1("libp2p:gossipsub:score");class PeerScore{constructor(o,$,j){this.params=o,this.metrics=$,this.peerStats=new Map,this.peerIPs=new MapDef(()=>new Set),this.scoreCache=new Map,this.deliveryRecords=new MessageDeliveries,validatePeerScoreParams(o),this.scoreCacheValidityMs=j.scoreCacheValidityMs,this.computeScore=j.computeScore??computeScore}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){log$Y("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),log$Y("started")}stop(){if(!this._backgroundInterval){log$Y("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),log$Y("stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([o,$])=>[o,$]))}refreshScores(){const o=Date.now(),$=this.params.decayToZero;this.peerStats.forEach((j,et)=>{if(!j.connected){o>j.expire&&(this.removeIPsForPeer(et,j.knownIPs),this.peerStats.delete(et),this.scoreCache.delete(et));return}Object.entries(j.topics).forEach(([tt,rt])=>{const nt=this.params.topics[tt];nt!==void 0&&(rt.firstMessageDeliveries*=nt.firstMessageDeliveriesDecay,rt.firstMessageDeliveries<$&&(rt.firstMessageDeliveries=0),rt.meshMessageDeliveries*=nt.meshMessageDeliveriesDecay,rt.meshMessageDeliveries<$&&(rt.meshMessageDeliveries=0),rt.meshFailurePenalty*=nt.meshFailurePenaltyDecay,rt.meshFailurePenalty<$&&(rt.meshFailurePenalty=0),rt.invalidMessageDeliveries*=nt.invalidMessageDeliveriesDecay,rt.invalidMessageDeliveries<$&&(rt.invalidMessageDeliveries=0),rt.inMesh&&(rt.meshTime=o-rt.graftTime,rt.meshTime>nt.meshMessageDeliveriesActivation&&(rt.meshMessageDeliveriesActive=!0)))}),j.behaviourPenalty*=this.params.behaviourPenaltyDecay,j.behaviourPenalty<$&&(j.behaviourPenalty=0)})}score(o){var nt,it,st;(nt=this.metrics)==null||nt.scoreFnCalls.inc();const $=this.peerStats.get(o);if(!$)return 0;const j=Date.now(),et=this.scoreCache.get(o);if(et&&et.cacheUntil>j)return et.score;(it=this.metrics)==null||it.scoreFnRuns.inc();const tt=this.computeScore(o,$,this.params,this.peerIPs),rt=j+this.scoreCacheValidityMs;return et?((st=this.metrics)==null||st.scoreCachedDelta.observe(Math.abs(tt-et.score)),et.score=tt,et.cacheUntil=rt):this.scoreCache.set(o,{score:tt,cacheUntil:rt}),tt}addPenalty(o,$,j){var tt;const et=this.peerStats.get(o);et&&(et.behaviourPenalty+=$,(tt=this.metrics)==null||tt.onScorePenalty(j))}addPeer(o){const $={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(o,$)}addIP(o,$){const j=this.peerStats.get(o);j&&j.knownIPs.add($),this.peerIPs.getOrDefault($).add(o)}removeIP(o,$){const j=this.peerStats.get(o);j&&j.knownIPs.delete($);const et=this.peerIPs.get($);et&&(et.delete(o),et.size===0&&this.peerIPs.delete($))}removePeer(o){const $=this.peerStats.get(o);if($){if(this.score(o)>0){this.removeIPsForPeer(o,$.knownIPs),this.peerStats.delete(o);return}Object.entries($.topics).forEach(([j,et])=>{et.firstMessageDeliveries=0;const tt=this.params.topics[j].meshMessageDeliveriesThreshold;if(et.inMesh&&et.meshMessageDeliveriesActive&&et.meshMessageDeliveries<tt){const rt=tt-et.meshMessageDeliveries;et.meshFailurePenalty+=rt*rt}et.inMesh=!1,et.meshMessageDeliveriesActive=!1}),$.connected=!1,$.expire=Date.now()+this.params.retainScore}}graft(o,$){const j=this.peerStats.get(o);if(j){const et=this.getPtopicStats(j,$);et&&(et.inMesh=!0,et.graftTime=Date.now(),et.meshTime=0,et.meshMessageDeliveriesActive=!1)}}prune(o,$){const j=this.peerStats.get(o);if(j){const et=this.getPtopicStats(j,$);if(et){const tt=this.params.topics[$].meshMessageDeliveriesThreshold;if(et.meshMessageDeliveriesActive&&et.meshMessageDeliveries<tt){const rt=tt-et.meshMessageDeliveries;et.meshFailurePenalty+=rt*rt}et.meshMessageDeliveriesActive=!1,et.inMesh=!1}}}validateMessage(o){this.deliveryRecords.ensureRecord(o)}deliverMessage(o,$,j){this.markFirstMessageDelivery(o,j);const et=this.deliveryRecords.ensureRecord($),tt=Date.now();if(et.status!==DeliveryRecordStatus.unknown){log$Y("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",o,tt-et.firstSeen,DeliveryRecordStatus[et.status]);return}et.status=DeliveryRecordStatus.valid,et.validated=tt,et.peers.forEach(rt=>{rt!==o.toString()&&this.markDuplicateMessageDelivery(rt,j)})}rejectInvalidMessage(o,$){this.markInvalidMessageDelivery(o,$)}rejectMessage(o,$,j,et){switch(et){case RejectReason.Error:this.markInvalidMessageDelivery(o,j);return;case RejectReason.Blacklisted:return}const tt=this.deliveryRecords.ensureRecord($);if(tt.status!==DeliveryRecordStatus.unknown){log$Y("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",o,Date.now()-tt.firstSeen,DeliveryRecordStatus[tt.status]);return}if(et===RejectReason.Ignore){tt.status=DeliveryRecordStatus.ignored,tt.peers.clear();return}tt.status=DeliveryRecordStatus.invalid,this.markInvalidMessageDelivery(o,j),tt.peers.forEach(rt=>{this.markInvalidMessageDelivery(rt,j)}),tt.peers.clear()}duplicateMessage(o,$,j){const et=this.deliveryRecords.ensureRecord($);if(!et.peers.has(o))switch(et.status){case DeliveryRecordStatus.unknown:et.peers.add(o);break;case DeliveryRecordStatus.valid:et.peers.add(o),this.markDuplicateMessageDelivery(o,j,et.validated);break;case DeliveryRecordStatus.invalid:this.markInvalidMessageDelivery(o,j);break;case DeliveryRecordStatus.ignored:break}}markInvalidMessageDelivery(o,$){const j=this.peerStats.get(o);if(j){const et=this.getPtopicStats(j,$);et&&(et.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(o,$){const j=this.peerStats.get(o);if(j){const et=this.getPtopicStats(j,$);if(et){let tt=this.params.topics[$].firstMessageDeliveriesCap;et.firstMessageDeliveries=Math.min(tt,et.firstMessageDeliveries+1),et.inMesh&&(tt=this.params.topics[$].meshMessageDeliveriesCap,et.meshMessageDeliveries=Math.min(tt,et.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(o,$,j){var tt;const et=this.peerStats.get(o);if(et){const rt=j!==void 0?Date.now():0,nt=this.getPtopicStats(et,$);if(nt&&nt.inMesh){const it=this.params.topics[$];if(j!==void 0){const ot=rt-j,at=ot>it.meshMessageDeliveriesWindow;if((tt=this.metrics)==null||tt.onDuplicateMsgDelivery($,ot,at),at)return}const st=it.meshMessageDeliveriesCap;nt.meshMessageDeliveries=Math.min(st,nt.meshMessageDeliveries+1)}}}removeIPsForPeer(o,$){for(const j of $){const et=this.peerIPs.get(j);et&&(et.delete(o),et.size===0&&this.peerIPs.delete(j))}}getPtopicStats(o,$){let j=o.topics[$];return j!==void 0?j:this.params.topics[$]!==void 0?(j={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},o.topics[$]=j,j):null}}class IWantTracer{constructor(o,$,j){this.gossipsubIWantFollowupMs=o,this.msgIdToStrFn=$,this.metrics=j,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*o}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(o,$){const j=Math.floor(Math.random()*$.length),et=$[j],tt=this.msgIdToStrFn(et);let rt=this.promises.get(tt);rt||(rt=new Map,this.promises.set(tt,rt));const nt=Date.now();rt.has(o)||(rt.set(o,nt+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(tt)||this.requestMsByMsg.set(tt,nt)))}getBrokenPromises(){var et;const o=Date.now(),$=new Map;let j=0;return this.promises.forEach((tt,rt)=>{tt.forEach((nt,it)=>{nt<o&&($.set(it,($.get(it)??0)+1),tt.delete(it),j++)}),tt.size||this.promises.delete(rt)}),(et=this.metrics)==null||et.iwantPromiseBroken.inc(j),$}deliverMessage(o,$=!1){this.trackMessage(o);const j=this.promises.get(o);j&&(this.promises.delete(o),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),$&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(j.size)))}rejectMessage(o,$){switch(this.trackMessage(o),$){case RejectReason.Error:return}this.promises.delete(o)}clear(){this.promises.clear()}prune(){var j;const o=Date.now()-this.requestMsByMsgExpire;let $=0;for(const[et,tt]of this.requestMsByMsg.entries())if(tt<o)this.requestMsByMsg.delete(et),$++;else break;(j=this.metrics)==null||j.iwantMessagePruned.inc($)}trackMessage(o){if(this.metrics){const $=this.requestMsByMsg.get(o);$!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-$)/1e3),this.requestMsByMsg.delete(o))}}}class SimpleTimeCache{constructor(o){this.entries=new Map,this.validityMs=o.validityMs}get size(){return this.entries.size}put(o,$){return this.entries.has(o)?!0:(this.entries.set(o,{value:$,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){const o=Date.now();for(const[$,j]of this.entries.entries())if(j.validUntilMs<o)this.entries.delete($);else break}has(o){return this.entries.has(o)}get(o){const $=this.entries.get(o);return $&&$.validUntilMs>=Date.now()?$.value:void 0}clear(){this.entries.clear()}}var MessageSource;(function(_){_.forward="forward",_.publish="publish"})(MessageSource||(MessageSource={}));var InclusionReason;(function(_){_.Fanout="fanout",_.Random="random",_.Subscribed="subscribed",_.Outbound="outbound",_.NotEnough="not_enough",_.Opportunistic="opportunistic"})(InclusionReason||(InclusionReason={}));var ChurnReason;(function(_){_.Dc="disconnected",_.BadScore="bad_score",_.Prune="prune",_.Unsub="unsubscribed",_.Excess="excess"})(ChurnReason||(ChurnReason={}));var ScorePenalty;(function(_){_.GraftBackoff="graft_backoff",_.BrokenPromise="broken_promise",_.MessageDeficit="message_deficit",_.IPColocation="IP_colocation"})(ScorePenalty||(ScorePenalty={}));var IHaveIgnoreReason;(function(_){_.LowScore="low_score",_.MaxIhave="max_ihave",_.MaxIasked="max_iasked"})(IHaveIgnoreReason||(IHaveIgnoreReason={}));var ScoreThreshold;(function(_){_.graylist="graylist",_.publish="publish",_.gossip="gossip",_.mesh="mesh"})(ScoreThreshold||(ScoreThreshold={}));function getMetrics(_,o,$){return{protocolsEnabled:_.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:_.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:_.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:_.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:_.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:_.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:_.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:_.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:_.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:_.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:_.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:_.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:_.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:_.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:_.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:_.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:_.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:_.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:_.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:_.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:_.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:_.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:_.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:_.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:_.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:_.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:_.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:_.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:_.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:_.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:_.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:_.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:_.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:_.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:_.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:_.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:_.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:_.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:_.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:_.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*$.maxMeshMessageDeliveriesWindowSec,.5*$.maxMeshMessageDeliveriesWindowSec,1*$.maxMeshMessageDeliveriesWindowSec,2*$.maxMeshMessageDeliveriesWindowSec,4*$.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:_.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:_.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:_.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:_.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:_.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:_.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:_.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:_.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:_.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:_.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:_.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*$.behaviourPenaltyThreshold,.5*$.behaviourPenaltyThreshold,1*$.behaviourPenaltyThreshold,2*$.behaviourPenaltyThreshold,4*$.behaviourPenaltyThreshold]}),ihaveRcvIgnored:_.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:_.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:_.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:_.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:_.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:_.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:_.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:_.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:_.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:_.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:_.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:_.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*$.gossipPromiseExpireSec,1*$.gossipPromiseExpireSec,2*$.gossipPromiseExpireSec,4*$.gossipPromiseExpireSec]}),cacheSize:_.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:_.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:_.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:_.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:_.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:o,toTopic(j){return this.topicStrToLabel.get(j)??j},onJoin(j){this.topicSubscriptionStatus.set({topicStr:j},1),this.meshPeerCounts.set({topicStr:j},0)},onLeave(j){this.topicSubscriptionStatus.set({topicStr:j},0),this.meshPeerCounts.set({topicStr:j},0)},onAddToMesh(j,et,tt){const rt=this.toTopic(j);this.meshPeerInclusionEvents.inc({topic:rt,reason:et},tt)},onRemoveFromMesh(j,et,tt){const rt=this.toTopic(j);this.meshPeerChurnEvents.inc({topic:rt,reason:et},tt)},onReportValidationMcacheHit(j){this.asyncValidationMcacheHit.inc({hit:j?"hit":"miss"})},onReportValidation(j,et){const tt=this.toTopic(j);this.asyncValidationResult.inc({topic:tt,acceptance:et})},onScorePenalty(j){this.scoringPenalties.inc({penalty:j},1)},onIhaveRcv(j,et,tt){const rt=this.toTopic(j);this.ihaveRcvMsgids.inc({topic:rt},et),this.ihaveRcvNotSeenMsgids.inc({topic:rt},tt)},onIwantRcv(j,et){for(const[tt,rt]of j){const nt=this.toTopic(tt);this.iwantRcvMsgids.inc({topic:nt},rt)}this.iwantRcvDonthaveMsgids.inc(et)},onForwardMsg(j,et){const tt=this.toTopic(j);this.msgForwardCount.inc({topic:tt},1),this.msgForwardPeers.inc({topic:tt},et)},onPublishMsg(j,et,tt,rt){const nt=this.toTopic(j);this.msgPublishCount.inc({topic:nt},1),this.msgPublishBytes.inc({topic:nt},tt*rt),this.msgPublishPeers.inc({topic:nt},tt),this.msgPublishPeersByGroup.inc({topic:nt,peerGroup:"direct"},et.direct),this.msgPublishPeersByGroup.inc({topic:nt,peerGroup:"floodsub"},et.floodsub),this.msgPublishPeersByGroup.inc({topic:nt,peerGroup:"mesh"},et.mesh),this.msgPublishPeersByGroup.inc({topic:nt,peerGroup:"fanout"},et.fanout)},onMsgRecvPreValidation(j){const et=this.toTopic(j);this.msgReceivedPreValidation.inc({topic:et},1)},onMsgRecvResult(j,et){const tt=this.toTopic(j);this.msgReceivedStatus.inc({topic:tt,status:et})},onMsgRecvInvalid(j,et){const tt=this.toTopic(j),rt=et.reason===RejectReason.Error?et.error:et.reason;this.msgReceivedInvalid.inc({topic:tt,error:rt},1)},onDuplicateMsgDelivery(j,et,tt){if(this.duplicateMsgDeliveryDelay.observe(et/1e3),tt){const rt=this.toTopic(j);this.duplicateMsgLateDelivery.inc({topic:rt},1)}},onPublishDuplicateMsg(j){const et=this.toTopic(j);this.duplicateMsgIgnored.inc({topic:et},1)},onRpcRecv(j,et){this.rpcRecvBytes.inc(et),this.rpcRecvCount.inc(1),j.subscriptions&&this.rpcRecvSubscription.inc(j.subscriptions.length),j.messages&&this.rpcRecvMessage.inc(j.messages.length),j.control&&(this.rpcRecvControl.inc(1),j.control.ihave&&this.rpcRecvIHave.inc(j.control.ihave.length),j.control.iwant&&this.rpcRecvIWant.inc(j.control.iwant.length),j.control.graft&&this.rpcRecvGraft.inc(j.control.graft.length),j.control.prune&&this.rpcRecvPrune.inc(j.control.prune.length))},onRpcSent(j,et){var tt,rt,nt,it;if(this.rpcSentBytes.inc(et),this.rpcSentCount.inc(1),j.subscriptions&&this.rpcSentSubscription.inc(j.subscriptions.length),j.messages&&this.rpcSentMessage.inc(j.messages.length),j.control){const st=((tt=j.control.ihave)==null?void 0:tt.length)??0,ot=((rt=j.control.iwant)==null?void 0:rt.length)??0,at=((nt=j.control.graft)==null?void 0:nt.length)??0,ct=((it=j.control.prune)==null?void 0:it.length)??0;st>0&&this.rpcSentIHave.inc(st),ot>0&&this.rpcSentIWant.inc(ot),at>0&&this.rpcSentGraft.inc(at),ct>0&&this.rpcSentPrune.inc(ct),(st>0||ot>0||at>0||ct>0)&&this.rpcSentControl.inc(1)}},registerScores(j,et){let tt=0,rt=0,nt=0,it=0;for(const st of j)st>=et.graylistThreshold&&tt++,st>=et.publishThreshold&&rt++,st>=et.gossipThreshold&&nt++,st>=0&&it++;this.peersByScoreThreshold.set({threshold:ScoreThreshold.graylist},tt),this.peersByScoreThreshold.set({threshold:ScoreThreshold.publish},rt),this.peersByScoreThreshold.set({threshold:ScoreThreshold.gossip},nt),this.peersByScoreThreshold.set({threshold:ScoreThreshold.mesh},it),this.score.set(j)},registerScoreWeights(j){for(const[et,tt]of j.byTopic)this.scoreWeights.set({topic:et,p:"p1"},tt.p1w),this.scoreWeights.set({topic:et,p:"p2"},tt.p2w),this.scoreWeights.set({topic:et,p:"p3"},tt.p3w),this.scoreWeights.set({topic:et,p:"p3b"},tt.p3bw),this.scoreWeights.set({topic:et,p:"p4"},tt.p4w);this.scoreWeights.set({p:"p5"},j.p5w),this.scoreWeights.set({p:"p6"},j.p6w),this.scoreWeights.set({p:"p7"},j.p7w)},registerScorePerMesh(j,et){const tt=new Map;j.forEach((rt,nt)=>{const it=this.topicStrToLabel.get(nt)??"unknown";let st=tt.get(it);st||(st=new Set,tt.set(it,st)),rt.forEach(ot=>st==null?void 0:st.add(ot))});for(const[rt,nt]of tt){const it=[];nt.forEach(st=>{it.push(et.get(st)??0)}),this.scorePerMesh.set({topic:rt},it)}}}}const SignPrefix=fromString$8("libp2p-pubsub:");async function buildRawMessage(_,o,$,j){switch(_.type){case PublishConfigType.Signing:{const et={from:_.author.toBytes(),data:j,seqno:randomBytes$3(8),topic:o,signature:void 0,key:void 0},tt=concat$2([SignPrefix,RPC$1.Message.encode(et).finish()]);et.signature=await _.privateKey.sign(tt),et.key=_.key;const rt={type:"signed",from:_.author,data:$,sequenceNumber:BigInt(`0x${toString$a(et.seqno,"base16")}`),topic:o,signature:et.signature,key:et.key};return{raw:et,msg:rt}}case PublishConfigType.Anonymous:return{raw:{from:void 0,data:j,seqno:void 0,topic:o,signature:void 0,key:void 0},msg:{type:"unsigned",data:$,topic:o}}}}async function validateToRawMessage(_,o){switch(_){case StrictNoSign:return o.signature!=null?{valid:!1,error:ValidateError.SignaturePresent}:o.seqno!=null?{valid:!1,error:ValidateError.SeqnoPresent}:o.key!=null?{valid:!1,error:ValidateError.FromPresent}:{valid:!0,message:{type:"unsigned",topic:o.topic,data:o.data??new Uint8Array(0)}};case StrictSign:{if(o.seqno==null)return{valid:!1,error:ValidateError.InvalidSeqno};if(o.seqno.length!==8)return{valid:!1,error:ValidateError.InvalidSeqno};if(o.signature==null)return{valid:!1,error:ValidateError.InvalidSignature};if(o.from==null)return{valid:!1,error:ValidateError.InvalidPeerId};let $;try{$=peerIdFromBytes(o.from)}catch{return{valid:!1,error:ValidateError.InvalidPeerId}}let j;if(o.key){if(j=unmarshalPublicKey(o.key),$.publicKey!==void 0&&!equals$6(j.bytes,$.publicKey))return{valid:!1,error:ValidateError.InvalidPeerId}}else{if($.publicKey==null)return{valid:!1,error:ValidateError.InvalidPeerId};j=unmarshalPublicKey($.publicKey)}const et={from:o.from,data:o.data,seqno:o.seqno,topic:o.topic,signature:void 0,key:void 0},tt=concat$2([SignPrefix,RPC$1.Message.encode(et).finish()]);return await j.verify(tt,o.signature)?{valid:!0,message:{type:"signed",from:$,data:o.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${toString$a(o.seqno,"base16")}`),topic:o.topic,signature:o.signature,key:o.key??marshalPublicKey(j)}}:{valid:!1,error:ValidateError.InvalidSignature}}}}const msgId=(_,o)=>{const $=fromString$8(o.toString(16).padStart(16,"0"),"base16"),j=new Uint8Array(_.length+$.length);return j.set(_,0),j.set($,_.length),j};function msgIdFnStrictSign(_){if(_.type!=="signed")throw new Error("expected signed message type");if(_.sequenceNumber==null)throw Error("missing seqno field");return msgId(_.from.toBytes(),_.sequenceNumber)}async function msgIdFnStrictNoSign(_){return await sha256$8.encode(_.data)}function computeScoreWeights(_,o,$,j,et){let tt=0;const rt=new Map;if(Object.entries(o.topics).forEach(([ct,ut])=>{const ft=et.get(ct)??"unknown",ht=$.topics[ct];if(ht===void 0)return;let mt=rt.get(ft);mt||(mt={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},rt.set(ft,mt));let gt=0,Et=0,St=0,At=0,kt=0;if(ut.inMesh){const Ot=Math.max(ut.meshTime/ht.timeInMeshQuantum,ht.timeInMeshCap);gt+=Ot*ht.timeInMeshWeight}let Rt=ut.firstMessageDeliveries;if(Rt>ht.firstMessageDeliveriesCap&&(Rt=ht.firstMessageDeliveriesCap),Et+=Rt*ht.firstMessageDeliveriesWeight,ut.meshMessageDeliveriesActive&&ut.meshMessageDeliveries<ht.meshMessageDeliveriesThreshold){const Ot=ht.meshMessageDeliveriesThreshold-ut.meshMessageDeliveries,jt=Ot*Ot;St+=jt*ht.meshMessageDeliveriesWeight}const Tt=ut.meshFailurePenalty;At+=Tt*ht.meshFailurePenaltyWeight;const Dt=ut.invalidMessageDeliveries*ut.invalidMessageDeliveries;kt+=Dt*ht.invalidMessageDeliveriesWeight,tt+=(gt+Et+St+At+kt)*ht.topicWeight,mt.p1w+=gt,mt.p2w+=Et,mt.p3w+=St,mt.p3bw+=At,mt.p4w+=kt}),$.topicScoreCap>0&&tt>$.topicScoreCap){tt=$.topicScoreCap;const ct=$.topicScoreCap/tt;for(const ut of rt.values())ut.p1w*=ct,ut.p2w*=ct,ut.p3w*=ct,ut.p3bw*=ct,ut.p4w*=ct}let nt=0,it=0,st=0;const ot=$.appSpecificScore(_);nt+=ot*$.appSpecificWeight,o.knownIPs.forEach(ct=>{if($.IPColocationFactorWhitelist.has(ct))return;const ut=j.get(ct),ft=ut?ut.size:0;if(ft>$.IPColocationFactorThreshold){const ht=ft-$.IPColocationFactorThreshold,mt=ht*ht;it+=mt*$.IPColocationFactorWeight}});const at=o.behaviourPenalty*o.behaviourPenalty;return st+=at*$.behaviourPenaltyWeight,tt+=nt+it+st,{byTopic:rt,p5w:nt,p6w:it,p7w:st,score:tt}}function computeAllPeersScoreWeights(_,o,$,j,et){const tt={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const rt of _){const nt=o.get(rt);if(nt){const it=computeScoreWeights(rt,nt,$,j,et);for(const[st,ot]of it.byTopic){let at=tt.byTopic.get(st);at||(at={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},tt.byTopic.set(st,at)),at.p1w.push(ot.p1w),at.p2w.push(ot.p2w),at.p3w.push(ot.p3w),at.p3bw.push(ot.p3bw),at.p4w.push(ot.p4w)}tt.p5w.push(it.p5w),tt.p6w.push(it.p6w),tt.p7w.push(it.p7w),tt.score.push(it.score)}else tt.p5w.push(0),tt.p6w.push(0),tt.p7w.push(0),tt.score.push(0)}return tt}let AbortError$1=class extends Error{constructor(o,$){super(o??"The operation was aborted"),this.type="aborted",this.code=$??"ABORT_ERR"}};function getIterator(_){if(_!=null){if(typeof _[Symbol.iterator]=="function")return _[Symbol.iterator]();if(typeof _[Symbol.asyncIterator]=="function")return _[Symbol.asyncIterator]();if(typeof _.next=="function")return _}throw new Error("argument is not an iterator or iterable")}function abortableSource(_,o,$){const j=$??{},et=getIterator(_);async function*tt(){let rt;const nt=()=>{rt!=null&&rt()};for(o.addEventListener("abort",nt);;){let it;try{if(o.aborted){const{abortMessage:ot,abortCode:at}=j;throw new AbortError$1(ot,at)}const st=new Promise((ot,at)=>{rt=()=>{const{abortMessage:ct,abortCode:ut}=j;at(new AbortError$1(ct,ut))}});it=await Promise.race([st,et.next()]),rt=null}catch(st){o.removeEventListener("abort",nt);const ot=st.type==="aborted"&&o.aborted;if(ot&&j.onAbort!=null&&await j.onAbort(_),typeof et.return=="function")try{const at=et.return();at instanceof Promise&&at.catch(ct=>{j.onReturnError!=null&&j.onReturnError(ct)})}catch(at){j.onReturnError!=null&&j.onReturnError(at)}if(ot&&j.returnOnAbort===!0)return;throw st}if(it.done===!0)break;yield it.value}o.removeEventListener("abort",nt)}return tt()}function abortableSink(_,o,$){return j=>_(abortableSource(j,o,$))}function abortableDuplex(_,o,$){return{sink:abortableSink(_.sink,o,{...$,onAbort:void 0}),source:abortableSource(_.source,o,$)}}function allocUnsafe$2(_){var o;return((o=globalThis==null?void 0:globalThis.Buffer)==null?void 0:o.allocUnsafe)!=null?globalThis.Buffer.allocUnsafe(_):new Uint8Array(_)}const defaultEncoder=_=>{const o=unsigned.encodingLength(_),$=allocUnsafe$2(o);return unsigned.encode(_,$),defaultEncoder.bytes=o,$};defaultEncoder.bytes=0;function encode$5(_){_=_??{};const o=_.lengthEncoder??defaultEncoder;return async function*(j){for await(const et of j){const tt=o(et.byteLength);tt instanceof Uint8Array?yield tt:yield*tt,et instanceof Uint8Array?yield et:yield*et}}}encode$5.single=(_,o)=>{o=o??{};const $=o.lengthEncoder??defaultEncoder;return new Uint8ArrayList($(_.byteLength),_)};const MAX_LENGTH_LENGTH=8,MAX_DATA_LENGTH=1024*1024*4;var ReadMode;(function(_){_[_.LENGTH=0]="LENGTH",_[_.DATA=1]="DATA"})(ReadMode||(ReadMode={}));const defaultDecoder=_=>{const o=unsigned.decode(_);return defaultDecoder.bytes=unsigned.encodingLength(o),o};defaultDecoder.bytes=0;function decode$3(_){return async function*($){const j=new Uint8ArrayList;let et=ReadMode.LENGTH,tt=-1;const rt=(_==null?void 0:_.lengthDecoder)??defaultDecoder,nt=(_==null?void 0:_.maxLengthLength)??MAX_LENGTH_LENGTH,it=(_==null?void 0:_.maxDataLength)??MAX_DATA_LENGTH;for await(const st of $)for(j.append(st);j.byteLength>0;){if(et===ReadMode.LENGTH)try{if(tt=rt(j),tt<0)throw errCode(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(tt>it)throw errCode(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const ot=rt.bytes;j.consume(ot),(_==null?void 0:_.onLength)!=null&&_.onLength(tt),et=ReadMode.DATA}catch(ot){if(ot instanceof RangeError){if(j.byteLength>nt)throw errCode(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw ot}if(et===ReadMode.DATA){if(j.byteLength<tt)break;const ot=j.sublist(0,tt);j.consume(tt),(_==null?void 0:_.onData)!=null&&_.onData(ot),yield ot,et=ReadMode.LENGTH}}if(j.byteLength>0)throw errCode(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}decode$3.fromReader=(_,o)=>{let $=1;const j=async function*(){for(;;)try{const{done:tt,value:rt}=await _.next($);if(tt===!0)return;rt!=null&&(yield rt)}catch(tt){if(tt.code==="ERR_UNDER_READ")return{done:!0,value:null};throw tt}finally{$=1}}();return decode$3({...o??{},onLength:tt=>{$=tt}})(j)};class OutboundStream{constructor(o,$,j){this.rawStream=o,this.pushable=pushable({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=j.maxBufferSize??1/0,pipe(abortableSource(this.pushable,this.closeController.signal,{returnOnAbort:!0}),encode$5(),this.rawStream).catch($)}get protocol(){return this.rawStream.stat.protocol}push(o){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(o)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class InboundStream{constructor(o,$={}){this.rawStream=o,this.closeController=new AbortController,this.source=abortableSource(pipe(this.rawStream,decode$3($)),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var minimalExports=requireMinimal();const protobuf=getDefaultExportFromCjs(minimalExports),defaultDecodeRpcLimits={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function decodeRpc(_,o){o={...o};const $=protobuf.Reader.create(_),j=_.length,et=j===void 0?$.len:$.pos+j,tt={};for(;$.pos<et;){const rt=$.uint32();switch(rt>>>3){case 1:tt.subscriptions&&tt.subscriptions.length||(tt.subscriptions=[]),tt.subscriptions.length<o.maxSubscriptions?tt.subscriptions.push(decodeSubOpts($,$.uint32())):$.skipType(rt&7);break;case 2:tt.messages&&tt.messages.length||(tt.messages=[]),tt.messages.length<o.maxMessages?tt.messages.push(decodeMessage$2($,$.uint32())):$.skipType(rt&7);break;case 3:tt.control=decodeControlMessage($,$.uint32(),o);break;default:$.skipType(rt&7);break}}return tt}function decodeSubOpts(_,o){const $=o===void 0?_.len:_.pos+o,j={};for(;_.pos<$;){const et=_.uint32();switch(et>>>3){case 1:j.subscribe=_.bool();break;case 2:j.topic=_.string();break;default:_.skipType(et&7);break}}return j}function decodeMessage$2(_,o){const $=o===void 0?_.len:_.pos+o,j={};for(;_.pos<$;){const et=_.uint32();switch(et>>>3){case 1:j.from=_.bytes();break;case 2:j.data=_.bytes();break;case 3:j.seqno=_.bytes();break;case 4:j.topic=_.string();break;case 5:j.signature=_.bytes();break;case 6:j.key=_.bytes();break;default:_.skipType(et&7);break}}if(!j.topic)throw Error("missing required 'topic'");return j}function decodeControlMessage(_,o,$){const j=o===void 0?_.len:_.pos+o,et={};for(;_.pos<j;){const tt=_.uint32();switch(tt>>>3){case 1:et.ihave&&et.ihave.length||(et.ihave=[]),et.ihave.length<$.maxControlMessages?et.ihave.push(decodeControlIHave(_,_.uint32(),$)):_.skipType(tt&7);break;case 2:et.iwant&&et.iwant.length||(et.iwant=[]),et.iwant.length<$.maxControlMessages?et.iwant.push(decodeControlIWant(_,_.uint32(),$)):_.skipType(tt&7);break;case 3:et.graft&&et.graft.length||(et.graft=[]),et.graft.length<$.maxControlMessages?et.graft.push(decodeControlGraft(_,_.uint32())):_.skipType(tt&7);break;case 4:et.prune&&et.prune.length||(et.prune=[]),et.prune.length<$.maxControlMessages?et.prune.push(decodeControlPrune(_,_.uint32(),$)):_.skipType(tt&7);break;default:_.skipType(tt&7);break}}return et}function decodeControlIHave(_,o,$){const j=o===void 0?_.len:_.pos+o,et={};for(;_.pos<j;){const tt=_.uint32();switch(tt>>>3){case 1:et.topicID=_.string();break;case 2:et.messageIDs&&et.messageIDs.length||(et.messageIDs=[]),$.maxIhaveMessageIDs-- >0?et.messageIDs.push(_.bytes()):_.skipType(tt&7);break;default:_.skipType(tt&7);break}}return et}function decodeControlIWant(_,o,$){const j=o===void 0?_.len:_.pos+o,et={};for(;_.pos<j;){const tt=_.uint32();switch(tt>>>3){case 1:et.messageIDs&&et.messageIDs.length||(et.messageIDs=[]),$.maxIwantMessageIDs-- >0?et.messageIDs.push(_.bytes()):_.skipType(tt&7);break;default:_.skipType(tt&7);break}}return et}function decodeControlGraft(_,o){const $=o===void 0?_.len:_.pos+o,j={};for(;_.pos<$;){const et=_.uint32();switch(et>>>3){case 1:j.topicID=_.string();break;default:_.skipType(et&7);break}}return j}function decodeControlPrune(_,o,$){const j=o===void 0?_.len:_.pos+o,et={};for(;_.pos<j;){const tt=_.uint32();switch(tt>>>3){case 1:et.topicID=_.string();break;case 2:et.peers&&et.peers.length||(et.peers=[]),$.maxPeerInfos-- >0?et.peers.push(decodePeerInfo(_,_.uint32())):_.skipType(tt&7);break;case 3:et.backoff=_.uint64();break;default:_.skipType(tt&7);break}}return et}function decodePeerInfo(_,o){const $=o===void 0?_.len:_.pos+o,j={};for(;_.pos<$;){const et=_.uint32();switch(et>>>3){case 1:j.peerID=_.bytes();break;case 2:j.signedPeerRecord=_.bytes();break;default:_.skipType(et&7);break}}return j}var Protocol;(function(_){_[_.ip4=4]="ip4",_[_.ip6=41]="ip6"})(Protocol||(Protocol={}));function multiaddrToIPStr(_){for(const o of _.tuples())switch(o[0]){case Protocol.ip4:case Protocol.ip6:return convertToString$4(o[0],o[1])}return null}var GossipStatusCode;(function(_){_[_.started=0]="started",_[_.stopped=1]="stopped"})(GossipStatusCode||(GossipStatusCode={}));class GossipSub extends EventEmitter$1{constructor(o,$={}){super(),this.multicodecs=[GossipsubIDv11,GossipsubIDv10],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=pushable({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.directPeerInitial=null,this.status={code:GossipStatusCode.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{var tt;const et=(tt=this.metrics)==null?void 0:tt.heartbeatDuration.startTimer();this.heartbeat().catch(rt=>{this.log("Error running heartbeat",rt)}).finally(()=>{var rt;if(et!=null&&et(),this.status.code===GossipStatusCode.started){clearTimeout(this.status.heartbeatTimeout);let nt=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;nt<this.opts.heartbeatInterval*.25&&(nt+=this.opts.heartbeatInterval,(rt=this.metrics)==null||rt.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,nt)}})};const j={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:GossipsubD,Dlo:GossipsubDlo,Dhi:GossipsubDhi,Dscore:GossipsubDscore,Dout:GossipsubDout,Dlazy:GossipsubDlazy,heartbeatInterval:GossipsubHeartbeatInterval,fanoutTTL:GossipsubFanoutTTL,mcacheLength:GossipsubHistoryLength,mcacheGossip:GossipsubHistoryGossip,seenTTL:GossipsubSeenTTL,gossipsubIWantFollowupMs:GossipsubIWantFollowupTime,prunePeers:GossipsubPrunePeers,pruneBackoff:GossipsubPruneBackoff,graftFloodThreshold:GossipsubGraftFloodThreshold,opportunisticGraftPeers:GossipsubOpportunisticGraftPeers,opportunisticGraftTicks:GossipsubOpportunisticGraftTicks,directConnectTicks:GossipsubDirectConnectTicks,...$,scoreParams:createPeerScoreParams($.scoreParams),scoreThresholds:createPeerScoreThresholds($.scoreThresholds)};if(this.components=o,this.decodeRpcLimits=j.decodeRpcLimits??defaultDecodeRpcLimits,this.globalSignaturePolicy=j.globalSignaturePolicy??StrictSign,j.fallbackToFloodsub&&this.multicodecs.push(FloodsubID),this.log=logger$1(j.debugName??"libp2p:gossipsub"),this.opts=j,this.direct=new Set(j.directPeers.map(et=>et.id.toString())),this.seenCache=new SimpleTimeCache({validityMs:j.seenTTL}),this.publishedMessageIds=new SimpleTimeCache({validityMs:j.seenTTL}),$.msgIdFn)this.msgIdFn=$.msgIdFn;else switch(this.globalSignaturePolicy){case StrictSign:this.msgIdFn=msgIdFnStrictSign;break;case StrictNoSign:this.msgIdFn=msgIdFnStrictNoSign;break}if($.fastMsgIdFn&&(this.fastMsgIdFn=$.fastMsgIdFn,this.fastMsgIdCache=new SimpleTimeCache({validityMs:j.seenTTL})),this.msgIdToStrFn=$.msgIdToStrFn??messageIdToString,this.mcache=$.messageCache||new MessageCache(j.mcacheGossip,j.mcacheLength,this.msgIdToStrFn),$.dataTransform&&(this.dataTransform=$.dataTransform),$.metricsRegister){if(!$.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const et=Math.max(...Object.values(j.scoreParams.topics).map(rt=>rt.meshMessageDeliveriesWindow),DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS),tt=getMetrics($.metricsRegister,$.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:j.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:et/1e3});tt.mcacheSize.addCollect(()=>this.onScrapeMetrics(tt));for(const rt of this.multicodecs)tt.protocolsEnabled.set({protocol:rt},1);this.metrics=tt}else this.metrics=null;this.gossipTracer=new IWantTracer(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new PeerScore(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:j.heartbeatInterval}),this.maxInboundStreams=$.maxInboundStreams,this.maxOutboundStreams=$.maxOutboundStreams,this.allowedTopics=j.allowedTopics?new Set(j.allowedTopics):null}getPeers(){return[...this.peers.keys()].map(o=>peerIdFromString(o))}isStarted(){return this.status.code===GossipStatusCode.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await getPublishConfigFromPeerId(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=pushable({objectMode:!0}),pipe(this.outboundInflightQueue,async tt=>{for await(const{peerId:rt,connection:nt}of tt)await this.createOutboundStream(rt,nt)}).catch(tt=>this.log.error("outbound inflight queue error",tt)),await Promise.all(this.opts.directPeers.map(async tt=>{await this.components.peerStore.addressBook.add(tt.id,tt.addrs)}));const o=this.components.registrar;await Promise.all(this.multicodecs.map(tt=>o.handle(tt,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));const $=createTopology({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),j=await Promise.all(this.multicodecs.map(tt=>o.register(tt,$))),et=setTimeout(this.runHeartbeat,GossipsubHeartbeatInitialDelay);this.status={code:GossipStatusCode.started,registrarTopologyIds:j,heartbeatTimeout:et,hearbeatStartMs:Date.now()+GossipsubHeartbeatInitialDelay},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async tt=>await this.connect(tt)))}).catch(tt=>{this.log(tt)})},GossipsubDirectConnectInitialDelay),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==GossipStatusCode.started)return;const{registrarTopologyIds:o}=this.status;this.status={code:GossipStatusCode.stopped};const $=this.components.registrar;o.forEach(j=>$.unregister(j)),this.outboundInflightQueue.end();for(const j of this.streamsOutbound.values())j.close();this.streamsOutbound.clear();for(const j of this.streamsInbound.values())j.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:o,connection:$}){if(!this.isStarted())return;const j=$.remotePeer;this.addPeer(j,$.stat.direction,$.remoteAddr),this.createInboundStream(j,o),this.outboundInflightQueue.push({peerId:j,connection:$})}onPeerConnected(o,$){var j;(j=this.metrics)==null||j.newConnectionCount.inc({status:$.stat.status}),!(!this.isStarted()||$.stat.status!=="OPEN")&&(this.addPeer(o,$.stat.direction,$.remoteAddr),this.outboundInflightQueue.push({peerId:o,connection:$}))}onPeerDisconnected(o){this.log("connection ended %p",o),this.removePeer(o)}async createOutboundStream(o,$){var et;if(!this.isStarted())return;const j=o.toString();if(this.peers.has(j)&&!this.streamsOutbound.has(j))try{const tt=new OutboundStream(await $.newStream(this.multicodecs),nt=>this.log.error("outbound pipe error",nt),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",o),this.streamsOutbound.set(j,tt);const rt=tt.protocol;rt===FloodsubID&&this.floodsubPeers.add(j),(et=this.metrics)==null||et.peersPerProtocol.inc({protocol:rt},1),this.subscriptions.size>0&&(this.log("send subscriptions to",j),this.sendSubscriptions(j,Array.from(this.subscriptions),!0))}catch(tt){this.log.error("createOutboundStream error",tt)}}async createInboundStream(o,$){if(!this.isStarted())return;const j=o.toString();if(!this.peers.has(j))return;const et=this.streamsInbound.get(j);et!==void 0&&(this.log("replacing existing inbound steam %s",j),et.close()),this.log("create inbound stream %s",j);const tt=new InboundStream($,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(j,tt),this.pipePeerReadStream(o,tt.source).catch(rt=>this.log(rt))}addPeer(o,$,j){const et=o.toString();if(!this.peers.has(et)){this.log("new peer %p",o),this.peers.add(et),this.score.addPeer(et);const tt=multiaddrToIPStr(j);tt!==null?this.score.addIP(et,tt):this.log("Added peer has no IP in current address %s %s",et,j.toString()),this.outbound.has(et)||this.outbound.set(et,$==="outbound")}}removePeer(o){var tt,rt;const $=o.toString();if(!this.peers.has($))return;this.log("delete peer %p",o),this.peers.delete($);const j=this.streamsOutbound.get($),et=this.streamsInbound.get($);j&&((tt=this.metrics)==null||tt.peersPerProtocol.inc({protocol:j.protocol},-1)),j==null||j.close(),et==null||et.close(),this.streamsOutbound.delete($),this.streamsInbound.delete($);for(const nt of this.topics.values())nt.delete($);for(const[nt,it]of this.mesh)it.delete($)===!0&&((rt=this.metrics)==null||rt.onRemoveFromMesh(nt,ChurnReason.Dc,1));for(const nt of this.fanout.values())nt.delete($);this.floodsubPeers.delete($),this.gossip.delete($),this.control.delete($),this.outbound.delete($),this.score.removePeer($),this.acceptFromWhitelist.delete($)}get started(){return this.status.code===GossipStatusCode.started}getMeshPeers(o){const $=this.mesh.get(o);return $?Array.from($):[]}getSubscribers(o){const $=this.topics.get(o);return($?Array.from($):[]).map(j=>peerIdFromString(j))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(o,$){try{await pipe($,async j=>{var et;for await(const tt of j)try{const rt=tt.subarray(),nt=decodeRpc(rt,this.decodeRpcLimits);(et=this.metrics)==null||et.onRpcRecv(nt,rt.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(o,nt):this.handleReceivedRpc(o,nt).catch(it=>this.log(it))}catch(rt){this.log(rt)}})}catch(j){this.handlePeerReadStreamError(j,o)}}handlePeerReadStreamError(o,$){this.log.error(o),this.onPeerDisconnected($)}async handleReceivedRpc(o,$){var j;if(!this.acceptFrom(o.toString())){this.log("received message from unacceptable peer %p",o),(j=this.metrics)==null||j.rpcRecvNotAccepted.inc();return}if(this.log("rpc from %p",o),$.subscriptions&&$.subscriptions.length>0){const et=[];$.subscriptions.forEach(tt=>{const rt=tt.topic,nt=tt.subscribe===!0;if(rt!=null){if(this.allowedTopics&&!this.allowedTopics.has(rt))return;this.handleReceivedSubscription(o,rt,nt),et.push({topic:rt,subscribe:nt})}}),this.dispatchEvent(new CustomEvent("subscription-change",{detail:{peerId:o,subscriptions:et}}))}if($.messages)for(const et of $.messages){if(this.allowedTopics&&!this.allowedTopics.has(et.topic))continue;const tt=this.handleReceivedMessage(o,et).catch(rt=>this.log(rt));this.opts.awaitRpcMessageHandler&&await tt}$.control&&await this.handleControlMessage(o.toString(),$.control)}handleReceivedSubscription(o,$,j){this.log("subscription update from %p topic %s",o,$);let et=this.topics.get($);et==null&&(et=new Set,this.topics.set($,et)),j?et.add(o.toString()):et.delete(o.toString())}async handleReceivedMessage(o,$){var et,tt,rt;(et=this.metrics)==null||et.onMsgRecvPreValidation($.topic);const j=await this.validateReceivedMessage(o,$);switch((tt=this.metrics)==null||tt.onMsgRecvResult($.topic,j.code),j.code){case MessageStatus.duplicate:this.score.duplicateMessage(o.toString(),j.msgIdStr,$.topic),this.gossipTracer.deliverMessage(j.msgIdStr,!0),this.mcache.observeDuplicate(j.msgIdStr,o.toString());return;case MessageStatus.invalid:if(j.msgIdStr){const nt=j.msgIdStr;this.score.rejectMessage(o.toString(),nt,$.topic,j.reason),this.gossipTracer.rejectMessage(nt,j.reason)}else this.score.rejectInvalidMessage(o.toString(),$.topic);(rt=this.metrics)==null||rt.onMsgRecvInvalid($.topic,j);return;case MessageStatus.valid:this.score.validateMessage(j.messageId.msgIdStr),this.gossipTracer.deliverMessage(j.messageId.msgIdStr),this.mcache.put(j.messageId,$,!this.opts.asyncValidation),this.subscriptions.has($.topic)&&(!this.components.peerId.equals(o)||this.opts.emitSelf)&&(super.dispatchEvent(new CustomEvent("gossipsub:message",{detail:{propagationSource:o,msgId:j.messageId.msgIdStr,msg:j.msg}})),super.dispatchEvent(new CustomEvent("message",{detail:j.msg}))),this.opts.asyncValidation||this.forwardMessage(j.messageId.msgIdStr,$,o.toString())}}async validateReceivedMessage(o,$){var at,ct,ut;const j=(at=this.fastMsgIdFn)==null?void 0:at.call(this,$),et=j!==void 0?(ct=this.fastMsgIdCache)==null?void 0:ct.get(j):void 0;if(et)return{code:MessageStatus.duplicate,msgIdStr:et};const tt=await validateToRawMessage(this.globalSignaturePolicy,$);if(!tt.valid)return{code:MessageStatus.invalid,reason:RejectReason.Error,error:tt.error};const rt=tt.message;try{this.dataTransform&&(rt.data=this.dataTransform.inboundTransform($.topic,rt.data))}catch(ft){return this.log("Invalid message, transform failed",ft),{code:MessageStatus.invalid,reason:RejectReason.Error,error:ValidateError.TransformFailed}}const nt=await this.msgIdFn(rt),it=this.msgIdToStrFn(nt),st={msgId:nt,msgIdStr:it};if(j!==void 0&&this.fastMsgIdCache&&this.fastMsgIdCache.put(j,it)&&((ut=this.metrics)==null||ut.fastMsgIdCacheCollision.inc()),this.seenCache.has(it))return{code:MessageStatus.duplicate,msgIdStr:it};this.seenCache.put(it);const ot=this.topicValidators.get($.topic);if(ot!=null){let ft;try{ft=await ot(o,rt)}catch(ht){const mt=ht.code;mt===ERR_TOPIC_VALIDATOR_IGNORE&&(ft=TopicValidatorResult.Ignore),mt===ERR_TOPIC_VALIDATOR_REJECT?ft=TopicValidatorResult.Reject:ft=TopicValidatorResult.Ignore}if(ft!==TopicValidatorResult.Accept)return{code:MessageStatus.invalid,reason:rejectReasonFromAcceptance(ft),msgIdStr:it}}return{code:MessageStatus.valid,messageId:st,msg:rt}}getScore(o){return this.score.score(o)}sendSubscriptions(o,$,j){this.sendRpc(o,{subscriptions:$.map(et=>({topic:et,subscribe:j}))})}async handleControlMessage(o,$){if($===void 0)return;const j=$.ihave?this.handleIHave(o,$.ihave):[],et=$.iwant?this.handleIWant(o,$.iwant):[],tt=$.graft?await this.handleGraft(o,$.graft):[];$.prune&&await this.handlePrune(o,$.prune),!(!j.length&&!et.length&&!tt.length)&&this.sendRpc(o,{messages:et,control:{iwant:j,prune:tt}})}acceptFrom(o){if(this.direct.has(o))return!0;const $=Date.now(),j=this.acceptFromWhitelist.get(o);if(j&&j.messagesAccepted<ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&j.acceptUntil>=$)return j.messagesAccepted+=1,!0;const et=this.score.score(o);return et>=ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(o,{messagesAccepted:0,acceptUntil:$+ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(o),et>=this.opts.scoreThresholds.graylistThreshold}handleIHave(o,$){var st,ot,at;if(!$.length)return[];const j=this.score.score(o);if(j<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",o,j),(st=this.metrics)==null||st.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.LowScore}),[];const et=(this.peerhave.get(o)??0)+1;if(this.peerhave.set(o,et),et>GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",o,et),(ot=this.metrics)==null||ot.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.MaxIhave}),[];const tt=this.iasked.get(o)??0;if(tt>=GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",o,tt),(at=this.metrics)==null||at.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.MaxIasked}),[];const rt=new Map;if($.forEach(({topicID:ct,messageIDs:ut})=>{var ht;if(!ct||!ut||!this.mesh.has(ct))return;let ft=0;ut.forEach(mt=>{const gt=this.msgIdToStrFn(mt);this.seenCache.has(gt)||(rt.set(gt,mt),ft++)}),(ht=this.metrics)==null||ht.onIhaveRcv(ct,ut.length,ft)}),!rt.size)return[];let nt=rt.size;nt+tt>GossipsubMaxIHaveLength&&(nt=GossipsubMaxIHaveLength-tt),this.log("IHAVE: Asking for %d out of %d messages from %s",nt,rt.size,o);let it=Array.from(rt.values());return shuffle(it),it=it.slice(0,nt),this.iasked.set(o,tt+nt),this.gossipTracer.addPromise(o,it),[{messageIDs:it}]}handleIWant(o,$){var nt;if(!$.length)return[];const j=this.score.score(o);if(j<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",o,j),[];const et=new Map,tt=new Map;let rt=0;return $.forEach(({messageIDs:it})=>{it&&it.forEach(st=>{const ot=this.msgIdToStrFn(st),at=this.mcache.getWithIWantCount(ot,o);if(at==null){rt++;return}if(tt.set(at.msg.topic,1+(tt.get(at.msg.topic)??0)),at.count>GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",o,st);return}et.set(ot,at.msg)})}),(nt=this.metrics)==null||nt.onIwantRcv(tt,rt),et.size?(this.log("IWANT: Sending %d messages to %s",et.size,o),Array.from(et.values())):(this.log("IWANT: Could not provide any wanted messages to %s",o),[])}async handleGraft(o,$){const j=[],et=this.score.score(o),tt=Date.now();let rt=this.opts.doPX;return $.forEach(({topicID:nt})=>{var ot,at;if(!nt)return;const it=this.mesh.get(nt);if(!it){rt=!1;return}if(it.has(o))return;if(this.direct.has(o)){this.log("GRAFT: ignoring request from direct peer %s",o),j.push(nt),rt=!1;return}const st=(ot=this.backoff.get(nt))==null?void 0:ot.get(o);if(typeof st=="number"&&tt<st){this.log("GRAFT: ignoring backed off peer %s",o),this.score.addPenalty(o,1,ScorePenalty.GraftBackoff),rt=!1;const ct=st+this.opts.graftFloodThreshold-this.opts.pruneBackoff;tt<ct&&this.score.addPenalty(o,1,ScorePenalty.GraftBackoff),this.addBackoff(o,nt),j.push(nt);return}if(et<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",o,et,nt),j.push(nt),rt=!1,this.addBackoff(o,nt);return}if(it.size>=this.opts.Dhi&&!this.outbound.get(o)){j.push(nt),this.addBackoff(o,nt);return}this.log("GRAFT: Add mesh link from %s in %s",o,nt),this.score.graft(o,nt),it.add(o),(at=this.metrics)==null||at.onAddToMesh(nt,InclusionReason.Subscribed,1)}),j.length?await Promise.all(j.map(nt=>this.makePrune(o,nt,rt))):[]}async handlePrune(o,$){var et;const j=this.score.score(o);for(const{topicID:tt,backoff:rt,peers:nt}of $){if(tt==null)continue;const it=this.mesh.get(tt);if(!it)return;if(this.log("PRUNE: Remove mesh link to %s in %s",o,tt),this.score.prune(o,tt),it.has(o)&&(it.delete(o),(et=this.metrics)==null||et.onRemoveFromMesh(tt,ChurnReason.Unsub,1)),typeof rt=="number"&&rt>0?this.doAddBackoff(o,tt,rt*1e3):this.addBackoff(o,tt),nt&&nt.length){if(j<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",o,j,tt);continue}await this.pxConnect(nt)}}}addBackoff(o,$){this.doAddBackoff(o,$,this.opts.pruneBackoff)}doAddBackoff(o,$,j){let et=this.backoff.get($);et||(et=new Map,this.backoff.set($,et));const tt=Date.now()+j;(et.get(o)??0)<tt&&et.set(o,tt)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((o,$)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",$,o),this.score.addPenalty($,o,ScorePenalty.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%GossipsubPruneBackoffTicks!==0)return;const o=Date.now();this.backoff.forEach(($,j)=>{$.forEach((et,tt)=>{et<o&&$.delete(tt)}),$.size===0&&this.backoff.delete(j)})}async directConnect(){const o=[];this.direct.forEach($=>{this.streamsOutbound.has($)||o.push($)}),await Promise.all(o.map(async $=>await this.connect($)))}async pxConnect(o){o.length>this.opts.prunePeers&&(shuffle(o),o=o.slice(0,this.opts.prunePeers));const $=[];await Promise.all(o.map(async j=>{if(!j.peerID)return;const et=peerIdFromBytes(j.peerID).toString();if(!this.peers.has(et)){if(!j.signedPeerRecord){$.push(et);return}try{const tt=await RecordEnvelope.openAndCertify(j.signedPeerRecord,"libp2p-peer-record"),rt=tt.peerId;if(!tt.peerId.equals(et)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",rt,et);return}if(!await this.components.peerStore.addressBook.consumePeerRecord(tt)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}$.push(et)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),$.length&&await Promise.all($.map(async j=>await this.connect(j)))}async connect(o){this.log("Initiating connection with %s",o);const $=peerIdFromString(o),j=await this.components.connectionManager.openConnection($);for(const et of this.multicodecs)for(const tt of this.components.registrar.getTopologies(et))tt.onConnect($,j)}subscribe(o){if(this.status.code!==GossipStatusCode.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(o)){this.subscriptions.add(o);for(const $ of this.peers.keys())this.sendSubscriptions($,[o],!0)}this.join(o)}unsubscribe(o){if(this.status.code!==GossipStatusCode.started)throw new Error("Pubsub is not started");const $=this.subscriptions.delete(o);if(this.log("unsubscribe from %s - am subscribed %s",o,$),$)for(const j of this.peers.keys())this.sendSubscriptions(j,[o],!1);this.leave(o)}join(o){var et,tt,rt;if(this.status.code!==GossipStatusCode.started)throw new Error("Gossipsub has not started");if(this.mesh.has(o))return;this.log("JOIN %s",o),(et=this.metrics)==null||et.onJoin(o);const $=new Set,j=this.fanout.get(o);if(j&&(this.fanout.delete(o),this.fanoutLastpub.delete(o),j.forEach(nt=>{!this.direct.has(nt)&&this.score.score(nt)>=0&&$.add(nt)}),(tt=this.metrics)==null||tt.onAddToMesh(o,InclusionReason.Fanout,$.size)),$.size<this.opts.D){const nt=$.size;this.getRandomGossipPeers(o,this.opts.D,st=>!$.has(st)&&!this.direct.has(st)&&this.score.score(st)>=0).forEach(st=>{$.add(st)}),(rt=this.metrics)==null||rt.onAddToMesh(o,InclusionReason.Random,$.size-nt)}this.mesh.set(o,$),$.forEach(nt=>{this.log("JOIN: Add mesh link to %s in %s",nt,o),this.sendGraft(nt,o)})}leave(o){var j;if(this.status.code!==GossipStatusCode.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",o),(j=this.metrics)==null||j.onLeave(o);const $=this.mesh.get(o);$&&(Promise.all(Array.from($).map(async et=>(this.log("LEAVE: Remove mesh link to %s in %s",et,o),await this.sendPrune(et,o)))).catch(et=>{this.log("Error sending prunes to mesh peers",et)}),this.mesh.delete(o))}selectPeersToForward(o,$,j){const et=new Set,tt=this.topics.get(o);tt&&(this.direct.forEach(nt=>{tt.has(nt)&&$!==nt&&!(j!=null&&j.has(nt))&&et.add(nt)}),this.floodsubPeers.forEach(nt=>{tt.has(nt)&&$!==nt&&!(j!=null&&j.has(nt))&&this.score.score(nt)>=this.opts.scoreThresholds.publishThreshold&&et.add(nt)}));const rt=this.mesh.get(o);return rt&&rt.size>0&&rt.forEach(nt=>{$!==nt&&!(j!=null&&j.has(nt))&&et.add(nt)}),et}selectPeersToPublish(o){const $=new Set,j={direct:0,floodsub:0,mesh:0,fanout:0},et=this.topics.get(o);if(et)if(this.opts.floodPublish)et.forEach(tt=>{this.direct.has(tt)?($.add(tt),j.direct++):this.score.score(tt)>=this.opts.scoreThresholds.publishThreshold&&($.add(tt),j.floodsub++)});else{this.direct.forEach(rt=>{et.has(rt)&&($.add(rt),j.direct++)}),this.floodsubPeers.forEach(rt=>{et.has(rt)&&this.score.score(rt)>=this.opts.scoreThresholds.publishThreshold&&($.add(rt),j.floodsub++)});const tt=this.mesh.get(o);if(tt&&tt.size>0)tt.forEach(rt=>{$.add(rt),j.mesh++});else{const rt=this.fanout.get(o);if(rt&&rt.size>0)rt.forEach(nt=>{$.add(nt),j.fanout++});else{const nt=this.getRandomGossipPeers(o,this.opts.D,it=>this.score.score(it)>=this.opts.scoreThresholds.publishThreshold);nt.size>0&&(this.fanout.set(o,nt),nt.forEach(it=>{$.add(it),j.fanout++}))}this.fanoutLastpub.set(o,Date.now())}}return{tosend:$,tosendCount:j}}forwardMessage(o,$,j,et){var rt;j&&this.score.deliverMessage(j,o,$.topic);const tt=this.selectPeersToForward($.topic,j,et);tt.forEach(nt=>{this.sendRpc(nt,{messages:[$]})}),(rt=this.metrics)==null||rt.onForwardMsg($.topic,tt.size)}async publish(o,$,j){var ft,ht;const et=this.dataTransform?this.dataTransform.outboundTransform(o,$):$;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");const{raw:tt,msg:rt}=await buildRawMessage(this.publishConfig,o,$,et),nt=await this.msgIdFn(rt),it=this.msgIdToStrFn(nt),st=(j==null?void 0:j.ignoreDuplicatePublishError)??this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(it)){if(st)return(ft=this.metrics)==null||ft.onPublishDuplicateMsg(o),{recipients:[]};throw Error("PublishError.Duplicate")}const{tosend:ot,tosendCount:at}=this.selectPeersToPublish(o),ct=this.opts.emitSelf===!0&&this.subscriptions.has(o),ut=(j==null?void 0:j.allowPublishToZeroPeers)??this.opts.allowPublishToZeroPeers;if(ot.size===0&&!ut&&!ct)throw Error("PublishError.InsufficientPeers");this.seenCache.put(it),this.mcache.put({msgId:nt,msgIdStr:it},tt,!0),this.publishedMessageIds.put(it);for(const mt of ot)this.sendRpc(mt,{messages:[tt]})||ot.delete(mt);return(ht=this.metrics)==null||ht.onPublishMsg(o,at,ot.size,tt.data!=null?tt.data.length:0),ct&&(ot.add(this.components.peerId.toString()),super.dispatchEvent(new CustomEvent("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:it,msg:rt}})),super.dispatchEvent(new CustomEvent("message",{detail:rt}))),{recipients:Array.from(ot.values()).map(mt=>peerIdFromString(mt))}}reportMessageValidationResult(o,$,j){var et,tt,rt,nt;if(j===TopicValidatorResult.Accept){const it=this.mcache.validate(o);if((et=this.metrics)==null||et.onReportValidationMcacheHit(it!==null),it!=null){const{message:st,originatingPeers:ot}=it;this.score.deliverMessage($.toString(),o,st.topic),this.forwardMessage(o,it.message,$.toString(),ot),(tt=this.metrics)==null||tt.onReportValidation(st.topic,j)}}else{const it=this.mcache.remove(o);if((rt=this.metrics)==null||rt.onReportValidationMcacheHit(it!==null),it){const st=rejectReasonFromAcceptance(j),{message:ot,originatingPeers:at}=it;this.score.rejectMessage($.toString(),o,ot.topic,st);for(const ct of at)this.score.rejectMessage(ct,o,ot.topic,st);(nt=this.metrics)==null||nt.onReportValidation(ot.topic,j)}}}sendGraft(o,$){const j=[{topicID:$}];this.sendRpc(o,{control:{graft:j}})}async sendPrune(o,$){const j=[await this.makePrune(o,$,this.opts.doPX)];this.sendRpc(o,{control:{prune:j}})}sendRpc(o,$){var nt;const j=this.streamsOutbound.get(o);if(!j)return this.log(`Cannot send RPC to ${o} as there is no open stream to it available`),!1;const et=this.control.get(o);et&&(this.piggybackControl(o,$,et),this.control.delete(o));const tt=this.gossip.get(o);tt&&(this.piggybackGossip(o,$,tt),this.gossip.delete(o));const rt=RPC$1.encode($).finish();try{j.push(rt)}catch(it){return this.log.error(`Cannot send rpc to ${o}`,it),et&&this.control.set(o,et),tt&&this.gossip.set(o,tt),!1}return(nt=this.metrics)==null||nt.onRpcSent($,rt.length),!0}piggybackControl(o,$,j){var et,tt;if(j.graft){$.control||($.control={}),$.control.graft||($.control.graft=[]);for(const rt of j.graft)rt.topicID&&((et=this.mesh.get(rt.topicID))!=null&&et.has(o))&&$.control.graft.push(rt)}if(j.prune){$.control||($.control={}),$.control.prune||($.control.prune=[]);for(const rt of j.prune)rt.topicID&&!((tt=this.mesh.get(rt.topicID))!=null&&tt.has(o))&&$.control.prune.push(rt)}}piggybackGossip(o,$,j){$.control||($.control={}),$.control.ihave=j}async sendGraftPrune(o,$,j){const et=this.opts.doPX;for(const[tt,rt]of o){const nt=rt.map(ot=>({topicID:ot}));let it=[];const st=$.get(tt);st&&(it=await Promise.all(st.map(async ot=>await this.makePrune(tt,ot,et&&!(j.get(tt)??!1)))),$.delete(tt)),this.sendRpc(tt,{control:{graft:nt,prune:it}})}for(const[tt,rt]of $){const nt=await Promise.all(rt.map(async it=>await this.makePrune(tt,it,et&&!(j.get(tt)??!1))));this.sendRpc(tt,{control:{prune:nt}})}}emitGossip(o){const $=this.mcache.getGossipIDs(new Set(o.keys()));for(const[j,et]of o)this.doEmitGossip(j,et,$.get(j)??[])}doEmitGossip(o,$,j){if(!j.length||(shuffle(j),j.length>GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",j.length),!$.size))return;let et=this.opts.Dlazy;const tt=GossipsubGossipFactor*$.size;let rt=$;tt>et&&(et=tt),et>rt.size?et=rt.size:rt=shuffle(Array.from(rt)).slice(0,et),rt.forEach(nt=>{let it=j;j.length>GossipsubMaxIHaveLength&&(it=shuffle(it.slice()).slice(0,GossipsubMaxIHaveLength)),this.pushGossip(nt,{topicID:o,messageIDs:it})})}flush(){for(const[o,$]of this.gossip.entries())this.gossip.delete(o),this.sendRpc(o,{control:{ihave:$}});for(const[o,$]of this.control.entries())this.control.delete(o),this.sendRpc(o,{control:{graft:$.graft,prune:$.prune}})}pushGossip(o,$){this.log("Add gossip to %s",o);const j=this.gossip.get(o)||[];this.gossip.set(o,j.concat($))}async makePrune(o,$,j){if(this.score.prune(o,$),this.streamsOutbound.get(o).protocol===GossipsubIDv10)return{topicID:$,peers:[]};const et=this.opts.pruneBackoff/1e3;if(!j)return{topicID:$,peers:[],backoff:et};const tt=this.getRandomGossipPeers($,this.opts.prunePeers,nt=>nt!==o&&this.score.score(nt)>=0),rt=await Promise.all(Array.from(tt).map(async nt=>{const it=peerIdFromString(nt);return{peerID:it.toBytes(),signedPeerRecord:await this.components.peerStore.addressBook.getRawEnvelope(it)}}));return{topicID:$,peers:rt,backoff:et}}async heartbeat(){var ft,ht;const{D:o,Dlo:$,Dhi:j,Dscore:et,Dout:tt,fanoutTTL:rt}=this.opts;this.heartbeatTicks++;const nt=new Map,it=mt=>{let gt=nt.get(mt);return gt===void 0&&(gt=this.score.score(mt),nt.set(mt,gt)),gt},st=new Map,ot=new Map,at=new Map;this.clearBackoff(),this.peerhave.clear(),(ft=this.metrics)==null||ft.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),(ht=this.fastMsgIdCache)==null||ht.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const ct=new Map;this.mesh.forEach((mt,gt)=>{const Et=this.topics.get(gt),St=new Set,At=new Set;if(ct.set(gt,At),Et){const Tt=shuffle(Array.from(Et)),Dt=this.backoff.get(gt);for(const Ot of Tt){const jt=this.streamsOutbound.get(Ot);if(jt&&this.multicodecs.includes(jt.protocol)&&!mt.has(Ot)&&!this.direct.has(Ot)){const Nt=it(Ot);(!Dt||!Dt.has(Ot))&&Nt>=0&&St.add(Ot),Nt>=this.opts.scoreThresholds.gossipThreshold&&At.add(Ot)}}}const kt=(Tt,Dt)=>{var jt;this.log("HEARTBEAT: Remove mesh link to %s in %s",Tt,gt),this.addBackoff(Tt,gt),mt.delete(Tt),it(Tt)>=this.opts.scoreThresholds.gossipThreshold&&At.add(Tt),(jt=this.metrics)==null||jt.onRemoveFromMesh(gt,Dt,1);const Ot=ot.get(Tt);Ot?Ot.push(gt):ot.set(Tt,[gt])},Rt=(Tt,Dt)=>{var jt;this.log("HEARTBEAT: Add mesh link to %s in %s",Tt,gt),this.score.graft(Tt,gt),mt.add(Tt),At.delete(Tt),(jt=this.metrics)==null||jt.onAddToMesh(gt,Dt,1);const Ot=st.get(Tt);Ot?Ot.push(gt):st.set(Tt,[gt])};if(mt.forEach(Tt=>{const Dt=it(Tt);Dt<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",Tt,Dt,gt),kt(Tt,ChurnReason.BadScore),at.set(Tt,!0))}),mt.size<$){const Tt=o-mt.size;removeFirstNItemsFromSet(St,Tt).forEach(Ot=>{Rt(Ot,InclusionReason.NotEnough)})}if(mt.size>j){let Tt=Array.from(mt);Tt.sort((Ot,jt)=>it(jt)-it(Ot)),Tt=Tt.slice(0,et).concat(shuffle(Tt.slice(et)));let Dt=0;if(Tt.slice(0,o).forEach(Ot=>{this.outbound.get(Ot)&&Dt++}),Dt<tt){const Ot=Nt=>{const It=Tt[Nt];for(let yt=Nt;yt>0;yt--)Tt[yt]=Tt[yt-1];Tt[0]=It};if(Dt>0){let Nt=Dt;for(let It=1;It<o&&Nt>0;It++)this.outbound.get(Tt[It])&&(Ot(It),Nt--)}let jt=o-Dt;for(let Nt=o;Nt<Tt.length&&jt>0;Nt++)this.outbound.get(Tt[Nt])&&(Ot(Nt),jt--)}Tt.slice(o).forEach(Ot=>{kt(Ot,ChurnReason.Excess)})}if(mt.size>=$){let Tt=0;if(mt.forEach(Dt=>{this.outbound.get(Dt)&&Tt++}),Tt<tt){const Dt=tt-Tt;removeItemsFromSet(St,Dt,jt=>this.outbound.get(jt)===!0).forEach(jt=>{Rt(jt,InclusionReason.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&mt.size>1){const Tt=Array.from(mt).sort((jt,Nt)=>it(jt)-it(Nt)),Dt=Math.floor(mt.size/2),Ot=it(Tt[Dt]);if(Ot<this.opts.scoreThresholds.opportunisticGraftThreshold){const jt=this.opts.opportunisticGraftPeers,Nt=removeItemsFromSet(St,jt,It=>it(It)>Ot);for(const It of Nt)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",It,gt),Rt(It,InclusionReason.Opportunistic)}}});const ut=Date.now();this.fanoutLastpub.forEach((mt,gt)=>{mt+rt<ut&&(this.fanout.delete(gt),this.fanoutLastpub.delete(gt))}),this.fanout.forEach((mt,gt)=>{const Et=this.topics.get(gt);mt.forEach(Rt=>{(!Et.has(Rt)||it(Rt)<this.opts.scoreThresholds.publishThreshold)&&mt.delete(Rt)});const St=this.topics.get(gt),At=[],kt=new Set;if(ct.set(gt,kt),St){const Rt=shuffle(Array.from(St));for(const Tt of Rt){const Dt=this.streamsOutbound.get(Tt);if(Dt&&this.multicodecs.includes(Dt.protocol)&&!mt.has(Tt)&&!this.direct.has(Tt)){const Ot=it(Tt);Ot>=this.opts.scoreThresholds.publishThreshold&&At.push(Tt),Ot>=this.opts.scoreThresholds.gossipThreshold&&kt.add(Tt)}}}if(mt.size<o){const Rt=o-mt.size;At.slice(0,Rt).forEach(Tt=>{mt.add(Tt),kt==null||kt.delete(Tt)})}}),this.emitGossip(ct),await this.sendGraftPrune(st,ot,at),this.flush(),this.mcache.shift(),this.dispatchEvent(new CustomEvent("gossipsub:heartbeat"))}getRandomGossipPeers(o,$,j=()=>!0){const et=this.topics.get(o);if(!et)return new Set;let tt=[];return et.forEach(rt=>{const nt=this.streamsOutbound.get(rt);nt&&this.multicodecs.includes(nt.protocol)&&j(rt)&&tt.push(rt)}),tt=shuffle(tt),$>0&&tt.length>$&&(tt=tt.slice(0,$)),new Set(tt)}onScrapeMetrics(o){var rt,nt;o.mcacheSize.set(this.mcache.size),o.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),o.cacheSize.set({cache:"direct"},this.direct.size),o.cacheSize.set({cache:"seenCache"},this.seenCache.size),o.cacheSize.set({cache:"fastMsgIdCache"},((rt=this.fastMsgIdCache)==null?void 0:rt.size)??0),o.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),o.cacheSize.set({cache:"mcache"},this.mcache.size),o.cacheSize.set({cache:"score"},this.score.size),o.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),o.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),o.cacheSize.set({cache:"topics"},this.topics.size),o.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),o.cacheSize.set({cache:"mesh"},this.mesh.size),o.cacheSize.set({cache:"fanout"},this.fanout.size),o.cacheSize.set({cache:"peers"},this.peers.size),o.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),o.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),o.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),o.cacheSize.set({cache:"gossip"},this.gossip.size),o.cacheSize.set({cache:"control"},this.control.size),o.cacheSize.set({cache:"peerhave"},this.peerhave.size),o.cacheSize.set({cache:"outbound"},this.outbound.size);let $=0;for(const it of this.backoff.values())$+=it.size;o.cacheSize.set({cache:"backoff"},$);for(const[it,st]of this.topics)o.topicPeersCount.set({topicStr:it},st.size);for(const[it,st]of this.mesh)o.meshPeerCounts.set({topicStr:it},st.size);const j=[],et=new Map;o.behaviourPenalty.reset();for(const it of this.peers.keys()){const st=this.score.score(it);j.push(st),et.set(it,st),o.behaviourPenalty.observe(((nt=this.score.peerStats.get(it))==null?void 0:nt.behaviourPenalty)??0)}o.registerScores(j,this.opts.scoreThresholds),o.registerScorePerMesh(this.mesh,et);const tt=computeAllPeersScoreWeights(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,o.topicStrToLabel);o.registerScoreWeights(tt)}}GossipSub.multicodec=GossipsubIDv11;function gossipsub(_={}){return o=>new GossipSub(o,_)}const routers=()=>({gossipsub:gossipsub({fallbackToFloodsub:!0,emitSelf:!0,maxInboundStreams:64,maxOutboundStreams:128})}),log$X=logger$1("libp2p-delegated-peer-routing"),DEFAULT_TIMEOUT$1=3e4,CONCURRENT_HTTP_REQUESTS$1=4;var EventTypes$1;(function(_){_[_.SENDING_QUERY=0]="SENDING_QUERY",_[_.PEER_RESPONSE=1]="PEER_RESPONSE",_[_.FINAL_PEER=2]="FINAL_PEER",_[_.QUERY_ERROR=3]="QUERY_ERROR",_[_.PROVIDER=4]="PROVIDER",_[_.VALUE=5]="VALUE",_[_.ADDING_PEER=6]="ADDING_PEER",_[_.DIALING_PEER=7]="DIALING_PEER"})(EventTypes$1||(EventTypes$1={}));var MessageType$1;(function(_){_[_.PUT_VALUE=0]="PUT_VALUE",_[_.GET_VALUE=1]="GET_VALUE",_[_.ADD_PROVIDER=2]="ADD_PROVIDER",_[_.GET_PROVIDERS=3]="GET_PROVIDERS",_[_.FIND_NODE=4]="FIND_NODE",_[_.PING=5]="PING"})(MessageType$1||(MessageType$1={}));class DelegatedPeerRouting{constructor(o){if(o==null)throw new Error("missing ipfs http client");this.client=o,this.started=!1,this.abortController=new AbortController,this.httpQueue=new PQueue({concurrency:CONCURRENT_HTTP_REQUESTS$1});const{protocol:$,host:j,port:et}=o.getEndpointConfig();log$X(`enabled DelegatedPeerRouting via ${$}://${j}:${et}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(o,$={}){log$X("findPeer starts: %p",o),$.timeout=$.timeout??DEFAULT_TIMEOUT$1,$.signal=anySignalExports([this.abortController.signal].concat($.signal!=null?[$.signal]:[]));const j=pDefer$1(),et=pDefer$1();this.httpQueue.add(async()=>(j.resolve(),await et.promise));try{await j.promise;for await(const tt of this.client.dht.findPeer(o,$))if(tt.name==="FINAL_PEER")return{id:tt.peer.id,multiaddrs:tt.peer.multiaddrs,protocols:[]}}catch(tt){throw log$X.error("findPeer errored: %o",tt),tt}finally{et.resolve(),log$X("findPeer finished: %p",o)}throw errCode(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(o,$={}){let j;const et=CID$3.asCID(o);et!=null?j=et:j=peerIdFromBytes(o),log$X("getClosestPeers starts: %s",j),$.timeout=$.timeout??DEFAULT_TIMEOUT$1,$.signal=anySignalExports([this.abortController.signal].concat($.signal!=null?[$.signal]:[]));const tt=pDefer$1(),rt=pDefer$1();this.httpQueue.add(async()=>(tt.resolve(),await rt.promise));try{await tt.promise;for await(const nt of this.client.dht.query(j,$))nt.name==="PEER_RESPONSE"&&(yield*nt.closer.map(it=>({id:it.id,multiaddrs:it.multiaddrs,protocols:[]})))}catch(nt){throw log$X.error("getClosestPeers errored:",nt),nt}finally{rt.resolve(),log$X("getClosestPeers finished: %b",o)}}}function delegatedPeerRouting(_){return()=>new DelegatedPeerRouting(_)}const log$W=logger$1("libp2p:delegated-content-routing"),DEFAULT_TIMEOUT=3e4,CONCURRENT_HTTP_REQUESTS=4,CONCURRENT_HTTP_REFS_REQUESTS=2;var EventTypes;(function(_){_[_.SENDING_QUERY=0]="SENDING_QUERY",_[_.PEER_RESPONSE=1]="PEER_RESPONSE",_[_.FINAL_PEER=2]="FINAL_PEER",_[_.QUERY_ERROR=3]="QUERY_ERROR",_[_.PROVIDER=4]="PROVIDER",_[_.VALUE=5]="VALUE",_[_.ADDING_PEER=6]="ADDING_PEER",_[_.DIALING_PEER=7]="DIALING_PEER"})(EventTypes||(EventTypes={}));var MessageType;(function(_){_[_.PUT_VALUE=0]="PUT_VALUE",_[_.GET_VALUE=1]="GET_VALUE",_[_.ADD_PROVIDER=2]="ADD_PROVIDER",_[_.GET_PROVIDERS=3]="GET_PROVIDERS",_[_.FIND_NODE=4]="FIND_NODE",_[_.PING=5]="PING"})(MessageType||(MessageType={}));class DelegatedContentRouting{constructor(o){if(o==null)throw new Error("missing ipfs http client");this.client=o,this.started=!1,this.abortController=new AbortController,this.httpQueue=new PQueue({concurrency:CONCURRENT_HTTP_REQUESTS}),this.httpQueueRefs=new PQueue({concurrency:CONCURRENT_HTTP_REFS_REQUESTS});const{protocol:$,host:j,port:et}=o.getEndpointConfig();log$W(`enabled DelegatedContentRouting via ${$}://${j}:${et}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(o,$={}){log$W("findProviders starts: %c",o),$.timeout=$.timeout??DEFAULT_TIMEOUT,$.signal=anySignalExports([this.abortController.signal].concat($.signal!=null?[$.signal]:[]));const j=pDefer$1(),et=pDefer$1();this.httpQueue.add(async()=>(j.resolve(),await et.promise));try{await j.promise;for await(const tt of this.client.dht.findProvs(o,$))tt.name==="PROVIDER"&&(yield*tt.providers.map(rt=>({id:rt.id,protocols:[],multiaddrs:rt.multiaddrs})))}catch(tt){throw log$W.error("findProviders errored:",tt),tt}finally{et.resolve(),log$W("findProviders finished: %c",o)}}async provide(o,$={}){log$W("provide starts: %c",o),$.timeout=$.timeout??DEFAULT_TIMEOUT,$.signal=anySignalExports([this.abortController.signal].concat($.signal!=null?[$.signal]:[])),await this.httpQueueRefs.add(async()=>{await this.client.block.stat(o,$),await drain(this.client.dht.provide(o,$))}),log$W("provide finished: %c",o)}async put(o,$,j={}){log$W("put value start: %b",o),j.timeout=j.timeout??DEFAULT_TIMEOUT,j.signal=anySignalExports([this.abortController.signal].concat(j.signal!=null?[j.signal]:[])),await this.httpQueue.add(async()=>{await drain(this.client.dht.put(o,$,j))}),log$W("put value finished: %b",o)}async get(o,$={}){log$W("get value start: %b",o),$.timeout=$.timeout??DEFAULT_TIMEOUT,$.signal=anySignalExports([this.abortController.signal].concat($.signal!=null?[$.signal]:[]));const j=await this.httpQueue.add(async()=>{for await(const et of this.client.dht.get(o,$))if(et.name==="VALUE")return log$W("get value finished: %b",o),et.value;throw errCode(new Error("Not found"),"ERR_NOT_FOUND")});if(j===void 0)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return j}}function delegatedContentRouting(_){return()=>new DelegatedContentRouting(_)}const LOAD_BASE=_=>Promise.reject(new Error(`No base found for "${_}"`));class Multibases{constructor(o){this._basesByName={},this._basesByPrefix={},this._loadBase=o.loadBase||LOAD_BASE;for(const $ of o.bases)this.addBase($)}addBase(o){if(this._basesByName[o.name]||this._basesByPrefix[o.prefix])throw new Error(`Codec already exists for codec "${o.name}"`);this._basesByName[o.name]=o,this._basesByPrefix[o.prefix]=o}removeBase(o){delete this._basesByName[o.name],delete this._basesByPrefix[o.prefix]}async getBase(o){if(this._basesByName[o])return this._basesByName[o];if(this._basesByPrefix[o])return this._basesByPrefix[o];const $=await this._loadBase(o);return this._basesByName[$.name]==null&&this._basesByPrefix[$.prefix]==null&&this.addBase($),$}listBases(){return Object.values(this._basesByName)}}const LOAD_CODEC=_=>Promise.reject(new Error(`No codec found for "${_}"`));class Multicodecs{constructor(o){this._codecsByName={},this._codecsByCode={},this._loadCodec=o.loadCodec||LOAD_CODEC;for(const $ of o.codecs)this.addCodec($)}addCodec(o){if(this._codecsByName[o.name]||this._codecsByCode[o.code])throw new Error(`Resolver already exists for codec "${o.name}"`);this._codecsByName[o.name]=o,this._codecsByCode[o.code]=o}removeCodec(o){delete this._codecsByName[o.name],delete this._codecsByCode[o.code]}async getCodec(o){const $=typeof o=="string"?this._codecsByName:this._codecsByCode;if($[o])return $[o];const j=await this._loadCodec(o);return $[o]==null&&this.addCodec(j),j}listCodecs(){return Object.values(this._codecsByName)}}const LOAD_HASHER=_=>Promise.reject(new Error(`No hasher found for "${_}"`));class Multihashes{constructor(o){this._hashersByName={},this._hashersByCode={},this._loadHasher=o.loadHasher||LOAD_HASHER;for(const $ of o.hashers)this.addHasher($)}addHasher(o){if(this._hashersByName[o.name]||this._hashersByCode[o.code])throw new Error(`Resolver already exists for codec "${o.name}"`);this._hashersByName[o.name]=o,this._hashersByCode[o.code]=o}removeHasher(o){delete this._hashersByName[o.name],delete this._hashersByCode[o.code]}async getHasher(o){const $=typeof o=="string"?this._hashersByName:this._hashersByCode;if($[o])return $[o];const j=await this._loadHasher(o);return $[o]==null&&this.addHasher(j),j}listHashers(){return Object.values(this._hashersByName)}}function toUrlString(_){try{_=multiaddrToUri(multiaddr$3(_))}catch{}return _=_.toString(),_}const getAgent=()=>{},log$V=logger$1("ipfs-http-client:lib:error-handler"),merge=mergeOptions$g.bind({ignoreUndefined:!0}),DEFAULT_PROTOCOL=env.isBrowser||env.isWebWorker?location.protocol:"http",DEFAULT_HOST=env.isBrowser||env.isWebWorker?location.hostname:"localhost",DEFAULT_PORT=env.isBrowser||env.isWebWorker?location.port:"5001",normalizeOptions=(_={})=>{let o,$={},j;if(typeof _=="string"||isMultiaddr$3(_))o=new URL(toUrlString(_));else if(_ instanceof URL)o=_;else if(typeof _.url=="string"||isMultiaddr$3(_.url))o=new URL(toUrlString(_.url)),$=_;else if(_.url instanceof URL)o=_.url,$=_;else{$=_||{};const et=($.protocol||DEFAULT_PROTOCOL).replace(":",""),tt=($.host||DEFAULT_HOST).split(":")[0],rt=$.port||DEFAULT_PORT;o=new URL(`${et}://${tt}:${rt}`)}if($.apiPath?o.pathname=$.apiPath:(o.pathname==="/"||o.pathname===void 0)&&(o.pathname="api/v0"),env.isNode){const et=getAgent();j=$.agent||new et({keepAlive:!0,maxSockets:6})}return{...$,host:o.host,protocol:o.protocol.replace(":",""),port:Number(o.port),apiPath:o.pathname,url:o,agent:j}},errorHandler=async _=>{let o;try{if((_.headers.get("Content-Type")||"").startsWith("application/json")){const j=await _.json();log$V(j),o=j.Message||j.message}else o=await _.text()}catch(j){log$V("Failed to parse error response",j),o=j.message}let $=new http.HTTPError(_);throw o&&(o.includes("deadline has elapsed")&&($=new http.TimeoutError),o&&o.includes("context deadline exceeded")&&($=new http.TimeoutError)),o&&o.includes("request timed out")&&($=new http.TimeoutError),o&&($.message=o),$},KEBAB_REGEX=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,kebabCase=_=>_.replace(KEBAB_REGEX,function(o){return"-"+o.toLowerCase()}),parseTimeout=_=>typeof _=="string"?parse$4(_):_;class Client extends http{constructor(o={}){const $=normalizeOptions(o);super({timeout:parseTimeout($.timeout||0)||void 0,headers:$.headers,base:`${$.url}`,handleError:errorHandler,transformSearchParams:et=>{const tt=new URLSearchParams;for(const[rt,nt]of et)nt!=="undefined"&&nt!=="null"&&rt!=="signal"&&tt.append(kebabCase(rt),nt),rt==="timeout"&&!isNaN(nt)&&tt.append(kebabCase(rt),nt);return tt},agent:$.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const j=this.fetch;this.fetch=(et,tt={})=>(typeof et=="string"&&!et.startsWith("/")&&(et=`${$.url}/${et}`),j.call(this,et,merge(tt,{method:"POST"})))}}http.HTTPError;const configure$2=_=>o=>_(new Client(o),o);function modeToString$1(_){if(_!=null)return typeof _=="string"?_:_.toString(8).padStart(4,"0")}function parseMtime(_){if(_==null)return;let o;if(_.secs!=null&&(o={secs:_.secs,nsecs:_.nsecs}),_.Seconds!=null&&(o={secs:_.Seconds,nsecs:_.FractionalNanoseconds}),Array.isArray(_)&&(o={secs:_[0],nsecs:_[1]}),_ instanceof Date){const $=_.getTime(),j=Math.floor($/1e3);o={secs:j,nsecs:($-j*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(o,"secs")){if(o!=null&&o.nsecs!=null&&(o.nsecs<0||o.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return o}}function toUrlSearchParams({arg:_,searchParams:o,hashAlg:$,mtime:j,mode:et,...tt}={}){o&&(tt={...tt,...o}),$&&(tt.hash=$),j!=null&&(j=parseMtime(j),tt.mtime=j.secs,tt.mtimeNsecs=j.nsecs),et!=null&&(tt.mode=modeToString$1(et)),tt.timeout&&!isNaN(tt.timeout)&&(tt.timeout=`${tt.timeout}ms`),_==null?_=[]:Array.isArray(_)||(_=[_]);const rt=new URLSearchParams(tt);return _.forEach(nt=>rt.append("arg",nt)),rt}const createWantlist=configure$2(_=>{async function o($={}){return((await(await _.post("bitswap/wantlist",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Keys||[]).map(et=>CID$3.parse(et["/"]))}return o}),createWantlistForPeer=configure$2(_=>{async function o($,j={}){return((await(await _.post("bitswap/wantlist",{signal:j.signal,searchParams:toUrlSearchParams({...j,peer:$.toString()}),headers:j.headers})).json()).Keys||[]).map(tt=>CID$3.parse(tt["/"]))}return o}),createStat$4=configure$2(_=>{async function o($={}){const j=await _.post("bitswap/stat",{searchParams:toUrlSearchParams($),signal:$.signal,headers:$.headers});return toCoreInterface$4(await j.json())}return o});function toCoreInterface$4(_){return{provideBufLen:_.ProvideBufLen,wantlist:(_.Wantlist||[]).map(o=>CID$3.parse(o["/"])),peers:(_.Peers||[]).map(o=>peerIdFromString(o)),blocksReceived:BigInt(_.BlocksReceived),dataReceived:BigInt(_.DataReceived),blocksSent:BigInt(_.BlocksSent),dataSent:BigInt(_.DataSent),dupBlksReceived:BigInt(_.DupBlksReceived),dupDataReceived:BigInt(_.DupDataReceived)}}const createUnwant=configure$2(_=>{async function o($,j={}){return(await _.post("bitswap/unwant",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers})).json()}return o});function createBitswap$1(_){return{wantlist:createWantlist(_),wantlistForPeer:createWantlistForPeer(_),unwant:createUnwant(_),stat:createStat$4(_)}}const createGet$5=configure$2(_=>{async function o($,j={}){const et=await _.post("block/get",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers});return new Uint8Array(await et.arrayBuffer())}return o});async function normaliseContent(_){if(isBytes(_))return new Blob([_]);if(typeof _=="string"||_ instanceof String)return new Blob([_.toString()]);if(isBlob(_))return _;if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const o=peekableIterator(_),{value:$,done:j}=await o.peek();if(j)return itToBlob(o);if(o.push($),Number.isInteger($))return new Blob([Uint8Array.from(await all$1(o))]);if(isBytes($)||typeof $=="string"||$ instanceof String)return itToBlob(o)}throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT")}async function itToBlob(_){const o=[];for await(const $ of _)o.push($);return new Blob(o)}function normaliseInput(_){return normaliseCandidateMultiple(_,normaliseContent)}function modeToString(_){if(_!=null)return typeof _=="string"?_:_.toString(8).padStart(4,"0")}async function multipartRequest(_,o,$={}){const j=[],et=new FormData;let tt=0,rt=0;for await(const{content:nt,path:it,mode:st,mtime:ot}of normaliseInput(_)){let at="";const ct=nt?"file":"dir";tt>0&&(at=`-${tt}`);let ut=ct+at;const ft=[];if(st!=null&&ft.push(`mode=${modeToString(st)}`),ot!=null){const{secs:ht,nsecs:mt}=ot;ft.push(`mtime=${ht}`),mt!=null&&ft.push(`mtime-nsecs=${mt}`)}if(ft.length&&(ut=`${ut}?${ft.join("&")}`),nt){et.set(ut,nt,it!=null?encodeURIComponent(it):void 0);const ht=rt+nt.size;j.push({name:it,start:rt,end:ht}),rt=ht}else if(it!=null)et.set(ut,new File([""],encodeURIComponent(it),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");tt++}return{total:rt,parts:j,headers:$,body:et}}function filter(_){return _.filter(Boolean)}function abortSignal(..._){return anySignal_2(filter(_))}const createPut$3=configure$2(_=>{async function o($,j={}){const et=new AbortController,tt=abortSignal(et.signal,j.signal);let rt;try{rt=await(await _.post("block/put",{signal:tt,searchParams:toUrlSearchParams(j),...await multipartRequest([$],et,j.headers)})).json()}catch(nt){if(j.format==="dag-pb")return o($,{...j,format:"protobuf"});if(j.format==="dag-cbor")return o($,{...j,format:"cbor"});throw nt}return CID$3.parse(rt.Key)}return o}),createRm$6=configure$2(_=>{async function*o($,j={}){Array.isArray($)||($=[$]);const et=await _.post("block/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.map(tt=>tt.toString()),"stream-channels":!0,...j}),headers:j.headers});for await(const tt of et.ndjson())yield toCoreInterface$3(tt)}return o});function toCoreInterface$3(_){const o={cid:CID$3.parse(_.Hash)};return _.Error&&(o.error=new Error(_.Error)),o}const createStat$3=configure$2(_=>{async function o($,j={}){const tt=await(await _.post("block/stat",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers})).json();return{cid:CID$3.parse(tt.Key),size:tt.Size}}return o});function createBlock(_){return{get:createGet$5(_),put:createPut$3(_),rm:createRm$6(_),stat:createStat$3(_)}}const createAdd$4=configure$2(_=>{async function o($,j={}){const et=await _.post("bootstrap/add",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Peers:tt}=await et.json();return{Peers:tt.map(rt=>multiaddr$3(rt))}}return o}),createClear=configure$2(_=>{async function o($={}){const j=await _.post("bootstrap/rm",{signal:$.signal,searchParams:toUrlSearchParams({...$,all:!0}),headers:$.headers}),{Peers:et}=await j.json();return{Peers:et.map(tt=>multiaddr$3(tt))}}return o}),createList$2=configure$2(_=>{async function o($={}){const j=await _.post("bootstrap/list",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Peers:et}=await j.json();return{Peers:et.map(tt=>multiaddr$3(tt))}}return o}),createReset=configure$2(_=>{async function o($={}){const j=await _.post("bootstrap/add",{signal:$.signal,searchParams:toUrlSearchParams({...$,default:!0}),headers:$.headers}),{Peers:et}=await j.json();return{Peers:et.map(tt=>multiaddr$3(tt))}}return o}),createRm$5=configure$2(_=>{async function o($,j={}){const et=await _.post("bootstrap/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Peers:tt}=await et.json();return{Peers:tt.map(rt=>multiaddr$3(rt))}}return o});function createBootstrap(_){return{add:createAdd$4(_),clear:createClear(_),list:createList$2(_),reset:createReset(_),rm:createRm$5(_)}}const createApply=configure$2(_=>{async function o($,j={}){const tt=await(await _.post("config/profile/apply",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return{original:tt.OldCfg,updated:tt.NewCfg}}return o});function objectToCamel(_){if(_==null)return _;const o=/^[A-Z]+$/,$={};return Object.keys(_).reduce((j,et)=>(o.test(et)?j[et.toLowerCase()]=_[et]:o.test(et[0])?j[et[0].toLowerCase()+et.slice(1)]=_[et]:j[et]=_[et],j),$)}const createList$1=configure$2(_=>{async function o($={}){return(await(await _.post("config/profile/list",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).map(tt=>objectToCamel(tt))}return o});function createProfiles(_){return{apply:createApply(_),list:createList$1(_)}}const createGet$4=configure$2(_=>async($,j={})=>{if(!$)throw new Error("key argument is required");return(await(await _.post("config",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json()).Value}),createGetAll=configure$2(_=>async($={})=>await(await _.post("config/show",{signal:$.signal,searchParams:toUrlSearchParams({...$}),headers:$.headers})).json()),createReplace=configure$2(_=>async($,j={})=>{const et=new AbortController,tt=abortSignal(et.signal,j.signal);await(await _.post("config/replace",{signal:tt,searchParams:toUrlSearchParams(j),...await multipartRequest([fromString$8(JSON.stringify($))],et,j.headers)})).text()}),createSet=configure$2(_=>async($,j,et={})=>{if(typeof $!="string")throw new Error("Invalid key type");const tt={...et,...encodeParam($,j)};await(await _.post("config",{signal:et.signal,searchParams:toUrlSearchParams(tt),headers:et.headers})).text()}),encodeParam=(_,o)=>{switch(typeof o){case"boolean":return{arg:[_,o.toString()],bool:!0};case"string":return{arg:[_,o]};default:return{arg:[_,JSON.stringify(o)],json:!0}}};function createConfig(_){return{getAll:createGetAll(_),get:createGet$4(_),set:createSet(_),replace:createReplace(_),profiles:createProfiles(_)}}const createExport$1=configure$2(_=>{async function*o($,j={}){yield*(await _.post("dag/export",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString()}),headers:j.headers})).iterator()}return o});async function*resolve(_,o,$,j,et){const tt=async st=>{const ot=await $.getCodec(st.code),at=await j(st,et);return ot.decode(at)},rt=o.split("/").filter(Boolean);let nt=await tt(_),it=_;for(;rt.length;){const st=rt.shift();if(!st)throw errCode(new Error(`Could not resolve path "${o}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(nt,st))nt=nt[st],yield{value:nt,remainderPath:rt.join("/")};else throw errCode(new Error(`no link named "${st}" under ${it}`),"ERR_NO_LINK");const ot=CID$3.asCID(nt);ot&&(it=ot,nt=await tt(nt))}yield{value:nt,remainderPath:""}}const createGet$3=(_,o)=>configure$2((j,et)=>{const tt=createGet$5(et);return async(nt,it={})=>{if(it.path){const ut=it.localResolve?await first(resolve(nt,it.path,_,tt,it)):await last(resolve(nt,it.path,_,tt,it));if(!ut)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return ut}const st=await _.getCodec(nt.code),ot=await tt(nt,it);return{value:st.decode(ot),remainderPath:""}}})(o),createImport$1=configure$2(_=>{async function*o($,j={}){const et=new AbortController,tt=abortSignal(et.signal,j.signal),{headers:rt,body:nt}=await multipartRequest($,et,j.headers),it=await _.post("dag/import",{signal:tt,headers:rt,body:nt,searchParams:toUrlSearchParams({"pin-roots":j.pinRoots})});for await(const{Root:st}of it.ndjson())if(st!==void 0){const{Cid:{"/":ot},PinErrorMsg:at}=st;yield{root:{cid:CID$3.parse(ot),pinErrorMsg:at}}}}return o}),createPut$2=(_,o)=>configure$2(j=>async(tt,rt={})=>{const nt={storeCodec:"dag-cbor",hashAlg:"sha2-256",...rt};let it;if(nt.inputCodec){if(!(tt instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");it=tt}else it=(await _.getCodec(nt.storeCodec)).encode(tt),nt.inputCodec=nt.storeCodec;const st=new AbortController,ot=abortSignal(st.signal,nt.signal),ct=await(await j.post("dag/put",{timeout:nt.timeout,signal:ot,searchParams:toUrlSearchParams(nt),...await multipartRequest([it],st,nt.headers)})).json();return CID$3.parse(ct.Cid["/"])})(o),createResolve$2=configure$2(_=>async($,j={})=>{const tt=await(await _.post("dag/resolve",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}${j.path?`/${j.path}`.replace(/\/[/]+/g,"/"):""}`,...j}),headers:j.headers})).json();return{cid:CID$3.parse(tt.Cid["/"]),remainderPath:tt.RemPath}});function createDag(_,o){return{export:createExport$1(o),get:createGet$3(_,o),import:createImport$1(o),put:createPut$2(_,o),resolve:createResolve$2(o)}}const SendingQuery=0,PeerResponse=1,FinalPeer=2,QueryError=3,Provider=4,Value=5,AddingPeer=6,DialingPeer=7,mapEvent=_=>{if(_.Type===SendingQuery)return{name:"SENDING_QUERY",type:_.Type};if(_.Type===PeerResponse)return{from:peerIdFromString(_.ID),name:"PEER_RESPONSE",type:_.Type,messageType:0,messageName:"PUT_VALUE",closer:(_.Responses||[]).map(({ID:o,Addrs:$})=>({id:peerIdFromString(o),multiaddrs:$.map(j=>multiaddr$3(j)),protocols:[]})),providers:(_.Responses||[]).map(({ID:o,Addrs:$})=>({id:peerIdFromString(o),multiaddrs:$.map(j=>multiaddr$3(j)),protocols:[]}))};if(_.Type===FinalPeer){let o={id:_.ID??peerIdFromString(_.ID),multiaddrs:[],protocols:[]};return _.Responses&&_.Responses.length&&(o={id:peerIdFromString(_.Responses[0].ID),multiaddrs:_.Responses[0].Addrs.map($=>multiaddr$3($)),protocols:[]}),{name:"FINAL_PEER",type:_.Type,peer:o}}if(_.Type===QueryError)return{name:"QUERY_ERROR",type:_.Type,error:new Error(_.Extra)};if(_.Type===Provider)return{name:"PROVIDER",type:_.Type,providers:_.Responses.map(({ID:o,Addrs:$})=>({id:peerIdFromString(o),multiaddrs:$.map(j=>multiaddr$3(j)),protocols:[]}))};if(_.Type===Value)return{name:"VALUE",type:_.Type,value:fromString$8(_.Extra,"base64pad")};if(_.Type===AddingPeer){const o=_.Responses.map(({ID:$})=>peerIdFromString($));if(!o.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:_.Type,peer:o[0]}}if(_.Type===DialingPeer)return{name:"DIALING_PEER",type:_.Type,peer:peerIdFromString(_.ID)};throw new Error("Unknown DHT event type")},createFindPeer=configure$2(_=>{async function*o($,j={}){const et=await _.post("dht/findpeer",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers});for await(const tt of et.ndjson())yield mapEvent(tt)}return o}),createFindProvs=configure$2(_=>{async function*o($,j={}){const et=await _.post("dht/findprovs",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers});for await(const tt of et.ndjson())yield mapEvent(tt)}return o}),createGet$2=configure$2(_=>{async function*o($,j={}){const et=await _.post("dht/get",{signal:j.signal,searchParams:toUrlSearchParams({arg:$ instanceof Uint8Array?toString$a($):$.toString(),...j}),headers:j.headers});for await(const tt of et.ndjson())yield mapEvent(tt)}return o}),createProvide=configure$2(_=>{async function*o($,j={recursive:!1}){const et=Array.isArray($)?$:[$],tt=await _.post("dht/provide",{signal:j.signal,searchParams:toUrlSearchParams({arg:et.map(rt=>rt.toString()),...j}),headers:j.headers});for await(const rt of tt.ndjson())yield mapEvent(rt)}return o}),createPut$1=configure$2(_=>{async function*o($,j,et={}){const tt=new AbortController,rt=abortSignal(tt.signal,et.signal),nt=await _.post("dht/put",{signal:rt,searchParams:toUrlSearchParams({arg:$ instanceof Uint8Array?toString$a($):$.toString(),...et}),...await multipartRequest([j],tt,et.headers)});for await(const it of nt.ndjson())yield mapEvent(it)}return o}),createQuery=configure$2(_=>{async function*o($,j={}){const et=await _.post("dht/query",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers});for await(const tt of et.ndjson())yield mapEvent(tt)}return o});function createDht$1(_){return{findPeer:createFindPeer(_),findProvs:createFindProvs(_),get:createGet$2(_),provide:createProvide(_),put:createPut$1(_),query:createQuery(_)}}const createCmds=configure$2(_=>{async function o($={}){return(await _.post("diag/cmds",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()}return o}),createNet=configure$2(_=>{async function o($={}){return(await _.post("diag/net",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()}return o}),createSys=configure$2(_=>{async function o($={}){return(await _.post("diag/sys",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()}return o});function createDiag(_){return{cmds:createCmds(_),net:createNet(_),sys:createSys(_)}}const createChmod=configure$2(_=>{async function o($,j,et={}){await(await _.post("files/chmod",{signal:et.signal,searchParams:toUrlSearchParams({arg:$,mode:j,...et}),headers:et.headers})).text()}return o}),createCp=configure$2(_=>{async function o($,j,et={}){const tt=Array.isArray($)?$:[$];await(await _.post("files/cp",{signal:et.signal,searchParams:toUrlSearchParams({arg:tt.concat(j).map(nt=>CID$3.asCID(nt)?`/ipfs/${nt}`:nt),...et}),headers:et.headers})).text()}return o}),createFlush=configure$2(_=>{async function o($,j={}){if(!$||typeof $!="string")throw new Error("ipfs.files.flush requires a path");const tt=await(await _.post("files/flush",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return CID$3.parse(tt.Cid)}return o});function objectToCamelWithMetadata(_){const o=objectToCamel(_);return Object.prototype.hasOwnProperty.call(o,"mode")&&(o.mode=parseInt(o.mode,8)),Object.prototype.hasOwnProperty.call(o,"mtime")&&(o.mtime={secs:o.mtime,nsecs:o.mtimeNsecs||0},delete o.mtimeNsecs),o}const createLs$6=configure$2(_=>{async function*o($,j={}){if(!$)throw new Error("ipfs.files.ls requires a path");const et=await _.post("files/ls",{signal:j.signal,searchParams:toUrlSearchParams({arg:CID$3.asCID($)?`/ipfs/${$}`:$,long:!0,...j,stream:!0}),headers:j.headers});for await(const tt of et.ndjson())if("Entries"in tt)for(const rt of tt.Entries||[])yield toCoreInterface$2(objectToCamelWithMetadata(rt));else yield toCoreInterface$2(objectToCamelWithMetadata(tt))}return o});function toCoreInterface$2(_){return _.hash&&(_.cid=CID$3.parse(_.hash)),delete _.hash,_.type=_.type===1?"directory":"file",_}const createMkdir=configure$2(_=>{async function o($,j={}){await(await _.post("files/mkdir",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).text()}return o}),createMv=configure$2(_=>{async function o($,j,et={}){Array.isArray($)||($=[$]),await(await _.post("files/mv",{signal:et.signal,searchParams:toUrlSearchParams({arg:$.concat(j),...et}),headers:et.headers})).text()}return o});var source$1=_=>{if(_[Symbol.asyncIterator])return _;if(_.getReader)return async function*(){const o=_.getReader();try{for(;;){const{done:$,value:j}=await o.read();if($)return;yield j}}finally{o.releaseLock()}}();throw new Error("unknown stream")};const createRead=configure$2(_=>{async function*o($,j={}){const et=await _.post("files/read",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,count:j.length,...j}),headers:j.headers});yield*source$1(et.body)}return o}),createRm$4=configure$2(_=>{async function o($,j={}){const et=await _.post("files/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),tt=await et.text();if(tt!==""){const rt=new http.HTTPError(et);throw rt.message=tt,rt}}return o}),createStat$2=configure$2(_=>{async function o($,j={}){const tt=await(await _.post("files/stat",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return tt.WithLocality=tt.WithLocality||!1,toCoreInterface$1(objectToCamelWithMetadata(tt))}return o});function toCoreInterface$1(_){return _.cid=CID$3.parse(_.hash),delete _.hash,_}const createTouch=configure$2(_=>{async function o($,j={}){await(await _.post("files/touch",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).text()}return o}),createWrite=configure$2(_=>{async function o($,j,et={}){const tt=new AbortController,rt=abortSignal(tt.signal,et.signal);await(await _.post("files/write",{signal:rt,searchParams:toUrlSearchParams({arg:$,streamChannels:!0,count:et.length,...et}),...await multipartRequest([{content:j,path:"arg",mode:modeToString$1(et.mode),mtime:parseMtime(et.mtime)}],tt,et.headers)})).text()}return o});function createFiles(_){return{chmod:createChmod(_),cp:createCp(_),flush:createFlush(_),ls:createLs$6(_),mkdir:createMkdir(_),mv:createMv(_),read:createRead(_),rm:createRm$4(_),stat:createStat$2(_),touch:createTouch(_),write:createWrite(_)}}const createExport=configure$2(_=>async($,j,et={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createGen=configure$2(_=>{async function o($,j){const et=j??{type:"Ed25519"},rt=await(await _.post("key/gen",{signal:et.signal,searchParams:toUrlSearchParams({arg:$,...et}),headers:et.headers})).json();return objectToCamel(rt)}return o}),createImport=configure$2(_=>{async function o($,j,et,tt={}){const nt=await(await _.post("key/import",{signal:tt.signal,searchParams:toUrlSearchParams({arg:$,pem:j,password:et,...tt}),headers:tt.headers})).json();return objectToCamel(nt)}return o}),createInfo=configure$2(_=>async($,j={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createList=configure$2(_=>{async function o($={}){return((await(await _.post("key/list",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Keys||[]).map(tt=>objectToCamel(tt))}return o}),createRename=configure$2(_=>{async function o($,j,et={}){const tt=await _.post("key/rename",{signal:et.signal,searchParams:toUrlSearchParams({arg:[$,j],...et}),headers:et.headers});return objectToCamel(await tt.json())}return o}),createRm$3=configure$2(_=>{async function o($,j={}){const tt=await(await _.post("key/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return objectToCamel(tt.Keys[0])}return o});function createKey(_){return{export:createExport(_),gen:createGen(_),import:createImport(_),info:createInfo(_),list:createList(_),rename:createRename(_),rm:createRm$3(_)}}const createLevel=configure$2(_=>{async function o($,j,et={}){const tt=await _.post("log/level",{signal:et.signal,searchParams:toUrlSearchParams({arg:[$,j],...et}),headers:et.headers});return objectToCamel(await tt.json())}return o}),createLs$5=configure$2(_=>{async function o($={}){return(await(await _.post("log/ls",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Strings}return o}),createTail=configure$2(_=>{async function*o($={}){yield*(await _.post("log/tail",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).ndjson()}return o});function createLog(_){return{level:createLevel(_),ls:createLs$5(_),tail:createTail(_)}}const createPublish$1=configure$2(_=>{async function o($,j={}){const et=await _.post("name/publish",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}`,...j}),headers:j.headers});return objectToCamel(await et.json())}return o}),createResolve$1=configure$2(_=>{async function*o($,j={}){const et=await _.post("name/resolve",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,stream:!0,...j}),headers:j.headers});for await(const tt of et.ndjson())yield tt.Path}return o}),createCancel=configure$2(_=>{async function o($,j={}){const et=await _.post("name/pubsub/cancel",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers});return objectToCamel(await et.json())}return o}),createState=configure$2(_=>{async function o($={}){const j=await _.post("name/pubsub/state",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers});return objectToCamel(await j.json())}return o}),createSubs=configure$2(_=>{async function o($={}){return(await(await _.post("name/pubsub/subs",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Strings||[]}return o});function createPubsub$2(_){return{cancel:createCancel(_),state:createState(_),subs:createSubs(_)}}function createName(_){return{publish:createPublish$1(_),resolve:createResolve$1(_),pubsub:createPubsub$2(_)}}const createData=configure$2(_=>{async function o($,j={}){const tt=await(await _.post("object/data",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$ instanceof Uint8Array?CID$3.decode($):$}`,...j}),headers:j.headers})).arrayBuffer();return new Uint8Array(tt,0,tt.byteLength)}return o}),createGet$1=configure$2(_=>{async function o($,j={}){const tt=await(await _.post("object/get",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$ instanceof Uint8Array?CID$3.decode($):$}`,dataEncoding:"base64",...j}),headers:j.headers})).json();return{Data:fromString$8(tt.Data,"base64pad"),Links:(tt.Links||[]).map(rt=>({Name:rt.Name,Hash:CID$3.parse(rt.Hash),Tsize:rt.Size}))}}return o}),createLinks=configure$2(_=>{async function o($,j={}){return((await(await _.post("object/links",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$ instanceof Uint8Array?CID$3.decode($):$}`,...j}),headers:j.headers})).json()).Links||[]).map(rt=>({Name:rt.Name,Tsize:rt.Size,Hash:CID$3.parse(rt.Hash)}))}return o}),createNew=configure$2(_=>{async function o($={}){const j=await _.post("object/new",{signal:$.signal,searchParams:toUrlSearchParams({arg:$.template,...$}),headers:$.headers}),{Hash:et}=await j.json();return CID$3.parse(et)}return o}),createPut=(_,o)=>configure$2(j=>{const et=createPut$2(_,o);async function tt(rt,nt={}){return et(rt,{...nt,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return tt})(o),createStat$1=configure$2(_=>{async function o($,j={}){const tt=await(await _.post("object/stat",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}`,...j}),headers:j.headers})).json();return{...tt,Hash:CID$3.parse(tt.Hash)}}return o}),createAddLink=configure$2(_=>{async function o($,j,et={}){const tt=await _.post("object/patch/add-link",{signal:et.signal,searchParams:toUrlSearchParams({arg:[`${$}`,j.Name||j.name||"",(j.Hash||j.cid||"").toString()||null],...et}),headers:et.headers}),{Hash:rt}=await tt.json();return CID$3.parse(rt)}return o}),createAppendData=configure$2(_=>{async function o($,j,et={}){const tt=new AbortController,rt=abortSignal(tt.signal,et.signal),nt=await _.post("object/patch/append-data",{signal:rt,searchParams:toUrlSearchParams({arg:`${$}`,...et}),...await multipartRequest([j],tt,et.headers)}),{Hash:it}=await nt.json();return CID$3.parse(it)}return o}),createRmLink=configure$2(_=>{async function o($,j,et={}){const tt=await _.post("object/patch/rm-link",{signal:et.signal,searchParams:toUrlSearchParams({arg:[`${$}`,j.Name||j.name||null],...et}),headers:et.headers}),{Hash:rt}=await tt.json();return CID$3.parse(rt)}return o}),createSetData=configure$2(_=>{async function o($,j,et={}){const tt=new AbortController,rt=abortSignal(tt.signal,et.signal),nt=await _.post("object/patch/set-data",{signal:rt,searchParams:toUrlSearchParams({arg:[`${$}`],...et}),...await multipartRequest([j],tt,et.headers)}),{Hash:it}=await nt.json();return CID$3.parse(it)}return o});function createPatch(_){return{addLink:createAddLink(_),appendData:createAppendData(_),rmLink:createRmLink(_),setData:createSetData(_)}}function createObject(_,o){return{data:createData(o),get:createGet$1(o),links:createLinks(o),new:createNew(o),put:createPut(_,o),stat:createStat$1(o),patch:createPatch(o)}}const createAddAll$1=configure$2(_=>{async function*o($,j={}){for await(const{path:et,recursive:tt,metadata:rt}of normaliseInput$3($)){const nt=await _.post("pin/add",{signal:j.signal,searchParams:toUrlSearchParams({...j,arg:et,recursive:tt,metadata:rt?JSON.stringify(rt):void 0,stream:!0}),headers:j.headers});for await(const it of nt.ndjson()){if(it.Pins){for(const st of it.Pins)yield CID$3.parse(st);continue}yield CID$3.parse(it)}}}return o});function createAdd$3(_){const o=createAddAll$1(_);return configure$2(()=>{async function $(j,et={}){return last(o([{path:j,...et}],et))}return $})(_)}function toPin(_,o,$){const j={type:_,cid:CID$3.parse(o)};return $&&(j.metadata=$),j}const createLs$4=configure$2(_=>{async function*o($={}){let j=[];$.paths&&(j=Array.isArray($.paths)?$.paths:[$.paths]);const et=await _.post("pin/ls",{signal:$.signal,searchParams:toUrlSearchParams({...$,arg:j.map(tt=>`${tt}`),stream:!0}),headers:$.headers});for await(const tt of et.ndjson()){if(tt.Keys){for(const rt of Object.keys(tt.Keys))yield toPin(tt.Keys[rt].Type,rt,tt.Keys[rt].Metadata);return}yield toPin(tt.Type,tt.Cid,tt.Metadata)}}return o}),createRmAll$1=configure$2(_=>{async function*o($,j={}){for await(const{path:et,recursive:tt}of normaliseInput$3($)){const rt=new URLSearchParams(j.searchParams);rt.append("arg",`${et}`),tt!=null&&rt.set("recursive",String(tt));const nt=await _.post("pin/rm",{signal:j.signal,headers:j.headers,searchParams:toUrlSearchParams({...j,arg:`${et}`,recursive:tt})});for await(const it of nt.ndjson()){if(it.Pins){yield*it.Pins.map(st=>CID$3.parse(st));continue}yield CID$3.parse(it)}}}return o}),createRm$2=_=>{const o=createRmAll$1(_);return configure$2(()=>{async function $(j,et={}){return last(o([{path:j,...et}],et))}return $})(_)},decodePin=({Name:_,Status:o,Cid:$})=>({cid:CID$3.parse($),name:_,status:o}),encodeService=_=>{if(typeof _=="string"&&_!=="")return _;throw new TypeError("service name must be passed")},encodeCID=_=>{if(CID$3.asCID(_))return _.toString();throw new TypeError(`CID instance expected instead of ${typeof _}`)},encodeQuery=({service:_,cid:o,name:$,status:j,all:et})=>{const tt=toUrlSearchParams({service:encodeService(_),name:$,force:et?!0:void 0});if(o)for(const rt of o)tt.append("cid",encodeCID(rt));if(j)for(const rt of j)tt.append("status",rt);return tt},encodeAddParams=({cid:_,service:o,background:$,name:j,origins:et})=>{const tt=toUrlSearchParams({arg:encodeCID(_),service:encodeService(o),name:j,background:$?!0:void 0});if(et)for(const rt of et)tt.append("origin",rt.toString());return tt};function createAdd$2(_){async function o($,{timeout:j,signal:et,headers:tt,...rt}){const nt=await _.post("pin/remote/add",{timeout:j,signal:et,headers:tt,searchParams:encodeAddParams({cid:$,...rt})});return decodePin(await nt.json())}return o}function createLs$3(_){async function*o({timeout:$,signal:j,headers:et,...tt}){const rt=await _.post("pin/remote/ls",{timeout:$,signal:j,headers:et,searchParams:encodeQuery(tt)});for await(const nt of rt.ndjson())yield decodePin(nt)}return o}function createRm$1(_){async function o({timeout:$,signal:j,headers:et,...tt}){await _.post("pin/remote/rm",{timeout:$,signal:j,headers:et,searchParams:encodeQuery({...tt,all:!1})})}return o}function createRmAll(_){async function o({timeout:$,signal:j,headers:et,...tt}){await _.post("pin/remote/rm",{timeout:$,signal:j,headers:et,searchParams:encodeQuery({...tt,all:!0})})}return o}function encodeEndpoint(_){const o=String(_);if(o==="undefined")throw Error("endpoint is required");return o[o.length-1]==="/"?o.slice(0,-1):o}function decodeRemoteService(_){return{service:_.Service,endpoint:new URL(_.ApiEndpoint),..._.Stat&&{stat:decodeStat(_.Stat)}}}function decodeStat(_){switch(_.Status){case"valid":{const{Pinning:o,Pinned:$,Queued:j,Failed:et}=_.PinCount;return{status:"valid",pinCount:{queued:j,pinning:o,pinned:$,failed:et}}}case"invalid":return{status:"invalid"};default:return{status:_.Status}}}function createAdd$1(_){async function o($,j){const{endpoint:et,key:tt,headers:rt,timeout:nt,signal:it}=j;await _.post("pin/remote/service/add",{timeout:nt,signal:it,searchParams:toUrlSearchParams({arg:[$,encodeEndpoint(et),tt]}),headers:rt})}return o}function createLs$2(_){async function o($={}){const{stat:j,headers:et,timeout:tt,signal:rt}=$,nt=await _.post("pin/remote/service/ls",{timeout:tt,signal:rt,headers:et,searchParams:j===!0?toUrlSearchParams({stat:j}):void 0}),{RemoteServices:it}=await nt.json();return it.map(decodeRemoteService)}return o}function createRm(_){async function o($,j={}){await _.post("pin/remote/service/rm",{signal:j.signal,headers:j.headers,searchParams:toUrlSearchParams({arg:$})})}return o}function createService(_){const o=new Client(_);return{add:createAdd$1(o),ls:createLs$2(o),rm:createRm(o)}}function createRemote(_){const o=new Client(_);return{add:createAdd$2(o),ls:createLs$3(o),rm:createRm$1(o),rmAll:createRmAll(o),service:createService(_)}}function createPin(_){return{addAll:createAddAll$1(_),add:createAdd$3(_),ls:createLs$4(_),rmAll:createRmAll$1(_),rm:createRm$2(_),remote:createRemote(_)}}const rpcArrayToTextArray=_=>Array.isArray(_)?_.map(rpcToText):_,rpcToText=_=>toString$a(rpcToBytes(_)),rpcToBytes=_=>base64url$2.decode(_),rpcToBigInt=_=>BigInt(`0x${toString$a(base64url$2.decode(_),"base16")}`),textToUrlSafeRpc=_=>base64url$2.encode(fromString$8(_)),createLs$1=configure$2(_=>{async function o($={}){const{Strings:j}=await(await _.post("pubsub/ls",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json();return rpcArrayToTextArray(j)||[]}return o}),createPeers$2=configure$2(_=>{async function o($,j={}){const et=await _.post("pubsub/peers",{signal:j.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc($),...j}),headers:j.headers}),{Strings:tt}=await et.json();return tt||[]}return o}),createPublish=configure$2(_=>{async function o($,j,et={}){const tt=toUrlSearchParams({arg:textToUrlSafeRpc($),...et}),rt=new AbortController,nt=abortSignal(rt.signal,et.signal);await(await _.post("pubsub/pub",{signal:nt,searchParams:tt,...await multipartRequest([j],rt,et.headers)})).text()}return o}),log$U=logger$1("ipfs-http-client:pubsub:subscribe"),createSubscribe=(_,o)=>configure$2($=>{async function j(et,tt,rt={}){rt.signal=o.subscribe(et,tt,rt.signal);let nt,it;const st=new Promise((at,ct)=>{nt=at,it=ct}),ot=setTimeout(()=>nt(),1e3);return $.post("pubsub/sub",{signal:rt.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc(et),...rt}),headers:rt.headers}).catch(at=>{o.unsubscribe(et,tt),it(at)}).then(at=>{clearTimeout(ot),at&&(readMessages(at,{onMessage:ct=>{if(tt){if(typeof tt=="function"){tt(ct);return}typeof tt.handleEvent=="function"&&tt.handleEvent(ct)}},onEnd:()=>o.unsubscribe(et,tt),onError:rt.onError}),nt())}),st}return j})(_);async function readMessages(_,{onMessage:o,onEnd:$,onError:j}){j=j||log$U;try{for await(const et of _.ndjson())try{if(!et.from)continue;et.from!=null&&et.seqno!=null?o({type:"signed",from:peerIdFromString(et.from),data:rpcToBytes(et.data),sequenceNumber:rpcToBigInt(et.seqno),topic:rpcToText(et.topicIDs[0]),key:rpcToBytes(et.key??"u"),signature:rpcToBytes(et.signature??"u")}):o({type:"unsigned",data:rpcToBytes(et.data),topic:rpcToText(et.topicIDs[0])})}catch(tt){tt.message=`Failed to parse pubsub message: ${tt.message}`,j(tt,!1,et)}}catch(et){isAbortError(et)||j(et,!0)}finally{$()}}const isAbortError=_=>{switch(_.type){case"aborted":return!0;case"abort":return!0;default:return _.name==="AbortError"}},createUnsubscribe=(_,o)=>{async function $(j,et){o.unsubscribe(j,et)}return $};class SubscriptionTracker{constructor(){this._subs=new Map}subscribe(o,$,j){const et=this._subs.get(o)||[];if(et.find(rt=>rt.handler===$))throw new Error(`Already subscribed to ${o} with this handler`);const tt=new AbortController;return this._subs.set(o,[{handler:$,controller:tt}].concat(et)),j&&j.addEventListener("abort",()=>this.unsubscribe(o,$)),tt.signal}unsubscribe(o,$){const j=this._subs.get(o)||[];let et;$?(this._subs.set(o,j.filter(tt=>tt.handler!==$)),et=j.filter(tt=>tt.handler===$)):(this._subs.set(o,[]),et=j),(this._subs.get(o)||[]).length||this._subs.delete(o),et.forEach(tt=>tt.controller.abort())}}function createPubsub$1(_){const o=new SubscriptionTracker;return{ls:createLs$1(_),peers:createPeers$2(_),publish:createPublish(_),subscribe:createSubscribe(_,o),unsubscribe:createUnsubscribe(_,o)}}const createLocal=configure$2(_=>{async function*o($={}){yield*(await _.post("refs/local",{signal:$.signal,transform:objectToCamel,searchParams:toUrlSearchParams($),headers:$.headers})).ndjson()}return o}),createRefs=configure$2((_,o)=>Object.assign(async function*(j,et={}){const tt=Array.isArray(j)?j:[j];yield*(await _.post("refs",{signal:et.signal,searchParams:toUrlSearchParams({arg:tt.map(nt=>`${nt instanceof Uint8Array?CID$3.decode(nt):nt}`),...et}),headers:et.headers,transform:objectToCamel})).ndjson()},{local:createLocal(o)})),createGc=configure$2(_=>{async function*o($={}){yield*(await _.post("repo/gc",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers,transform:et=>({err:et.Error?new Error(et.Error):null,cid:(et.Key||{})["/"]?CID$3.parse(et.Key["/"]):null})})).ndjson()}return o}),createStat=configure$2(_=>{async function o($={}){const et=await(await _.post("repo/stat",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json();return{numObjects:BigInt(et.NumObjects),repoSize:BigInt(et.RepoSize),repoPath:et.RepoPath,version:et.Version,storageMax:BigInt(et.StorageMax)}}return o}),createVersion$1=configure$2(_=>{async function o($={}){return(await(await _.post("repo/version",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Version}return o});function createRepo(_){return{gc:createGc(_),stat:createStat(_),version:createVersion$1(_)}}const createBw=configure$2(_=>{async function*o($={}){yield*(await _.post("stats/bw",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers,transform:et=>({totalIn:BigInt(et.TotalIn),totalOut:BigInt(et.TotalOut),rateIn:parseFloat(et.RateIn),rateOut:parseFloat(et.RateOut)})})).ndjson()}return o});function createStats(_){return{bitswap:createStat$4(_),repo:createStat(_),bw:createBw(_)}}const createAddrs$1=configure$2(_=>{async function o($={}){const j=await _.post("swarm/addrs",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Addrs:et}=await j.json();return Object.keys(et).map(tt=>({id:peerIdFromString(tt),addrs:(et[tt]||[]).map(rt=>multiaddr$3(rt))}))}return o}),createConnect$1=configure$2(_=>{async function o($,j={}){const et=await _.post("swarm/connect",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Strings:tt}=await et.json();return tt||[]}return o}),createDisconnect$1=configure$2(_=>{async function o($,j={}){const et=await _.post("swarm/disconnect",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Strings:tt}=await et.json();return tt||[]}return o}),createLocalAddrs$1=configure$2(_=>{async function o($={}){const j=await _.post("swarm/addrs/local",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Strings:et}=await j.json();return(et||[]).map(tt=>multiaddr$3(tt))}return o}),createPeers$1=configure$2(_=>{async function o($={}){const j=await _.post("swarm/peers",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Peers:et}=await j.json();return(et||[]).map(tt=>({addr:multiaddr$3(tt.Addr),peer:peerIdFromString(tt.Peer),muxer:tt.Muxer,latency:tt.Latency,streams:tt.Streams,direction:tt.Direction==null?void 0:tt.Direction===0?"inbound":"outbound"}))}return o});function createSwarm(_){return{addrs:createAddrs$1(_),connect:createConnect$1(_),disconnect:createDisconnect$1(_),localAddrs:createLocalAddrs$1(_),peers:createPeers$1(_)}}const createAddAll=configure$2(_=>{async function*o($,j={}){const et=new AbortController,tt=abortSignal(et.signal,j.signal),{headers:rt,body:nt,total:it,parts:st}=await multipartRequest($,et,j.headers),[ot,at]=typeof j.progress=="function"?createProgressHandler(it,st,j.progress):[void 0,void 0],ct=await _.post("add",{searchParams:toUrlSearchParams({"stream-channels":!0,...j,progress:!!ot}),onUploadProgress:at,signal:tt,headers:rt,body:nt});for await(let ut of ct.ndjson())ut=objectToCamel(ut),ut.hash!==void 0?yield toCoreInterface(ut):ot&&ot(ut.bytes||0,ut.name)}return o}),createProgressHandler=(_,o,$)=>o?[void 0,createOnUploadProgress(_,o,$)]:[$,void 0],createOnUploadProgress=(_,o,$)=>{let j=0;const et=o.length;return({loaded:tt,total:rt})=>{const nt=Math.floor(tt/rt*_);for(;j<et;){const{start:it,end:st,name:ot}=o[j];if(nt<st){$(nt-it,ot);break}else $(st-it,ot),j+=1}}};function toCoreInterface({name:_,hash:o,size:$,mode:j,mtime:et,mtimeNsecs:tt}){const rt={path:_,cid:CID$3.parse(o),size:parseInt($)};return j!=null&&(rt.mode=parseInt(j,8)),et!=null&&(rt.mtime={secs:et,nsecs:tt||0}),rt}function createAdd(_){const o=createAddAll(_);return configure$2(()=>{async function $(j,et={}){return await last(o(normaliseInput$2(j),et))}return $})(_)}const createCat=configure$2(_=>{async function*o($,j={}){yield*(await _.post("cat",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers})).iterator()}return o}),createCommands=configure$2(_=>async($={})=>(await _.post("commands",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()),createDns=configure$2(_=>async($,j={})=>(await(await _.post("dns",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json()).Path),createGetEndpointConfig=configure$2(_=>()=>{const o=new URL(_.opts.base||"");return{host:o.hostname,port:o.port,protocol:o.protocol,pathname:o.pathname,"api-path":o.pathname}}),createGet=configure$2(_=>{async function*o($,j={}){const et={arg:`${$ instanceof Uint8Array?CID$3.decode($):$}`,...j};et.compressionLevel&&(et["compression-level"]=et.compressionLevel,delete et.compressionLevel),yield*(await _.post("get",{signal:j.signal,searchParams:toUrlSearchParams(et),headers:j.headers})).iterator()}return o}),createId=configure$2(_=>{async function o($={}){const et=await(await _.post("id",{signal:$.signal,searchParams:toUrlSearchParams({arg:$.peerId?$.peerId.toString():void 0,...$}),headers:$.headers})).json(),tt={...objectToCamel(et)};return tt.id=peerIdFromString(tt.id),tt.addresses&&(tt.addresses=tt.addresses.map(rt=>multiaddr$3(rt))),tt}return o}),createIsOnline=_=>{const o=createId(_);async function $(j={}){const et=await o(j);return!!(et&&et.addresses&&et.addresses.length)}return $},createLs=configure$2((_,o)=>{async function*$(j,et={}){const tt=`${j instanceof Uint8Array?CID$3.decode(j):j}`;async function rt(it){let st=it.Hash;if(st.includes("/")){const at=st.startsWith("/ipfs/")?st:`/ipfs/${st}`;st=(await createStat$2(o)(at)).cid}else st=CID$3.parse(st);const ot={name:it.Name,path:tt+(it.Name?`/${it.Name}`:""),size:it.Size,cid:st,type:typeOf(it)};return it.Mode&&(ot.mode=parseInt(it.Mode,8)),it.Mtime!==void 0&&it.Mtime!==null&&(ot.mtime={secs:it.Mtime},it.MtimeNsecs!==void 0&&it.MtimeNsecs!==null&&(ot.mtime.nsecs=it.MtimeNsecs)),ot}const nt=await _.post("ls",{signal:et.signal,searchParams:toUrlSearchParams({arg:tt,...et}),headers:et.headers});for await(let it of nt.ndjson()){if(it=it.Objects,!it)throw new Error("expected .Objects in results");if(it=it[0],!it)throw new Error("expected one array in results.Objects");const st=it.Links;if(!Array.isArray(st))throw new Error("expected one array in results.Objects[0].Links");if(!st.length){yield rt(it);return}yield*st.map(rt)}}return $});function typeOf(_){switch(_.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const createMount=configure$2(_=>{async function o($={}){const j=await _.post("dns",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers});return objectToCamel(await j.json())}return o}),createPing$1=configure$2(_=>{async function*o($,j={}){yield*(await _.post("ping",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}`,...j}),headers:j.headers,transform:objectToCamel})).ndjson()}return o}),createResolve=configure$2(_=>{async function o($,j={}){const et=await _.post("resolve",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Path:tt}=await et.json();return tt}return o}),createStart=configure$2(_=>async($={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createStop=configure$2(_=>{async function o($={}){await(await _.post("shutdown",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).text()}return o}),createVersion=configure$2(_=>{async function o($={}){const j=await _.post("version",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers});return{...objectToCamel(await j.json()),"ipfs-http-client":"1.0.0"}}return o});function create$2(_={}){const o={name:identity$3.name,code:identity$3.code,encode:st=>st,decode:st=>st},$=Object.values(bases$2);(_.ipld&&_.ipld.bases?_.ipld.bases:[]).forEach(st=>$.push(st));const j=new Multibases({bases:$,loadBase:_.ipld&&_.ipld.loadBase}),et=Object.values(codecs);[dagPB,dagCBOR$1,dagJSON,dagJOSE,o].concat(_.ipld&&_.ipld.codecs||[]).forEach(st=>et.push(st));const tt=new Multicodecs({codecs:et,loadCodec:_.ipld&&_.ipld.loadCodec}),rt=Object.values(hashes);(_.ipld&&_.ipld.hashers?_.ipld.hashers:[]).forEach(st=>rt.push(st));const nt=new Multihashes({hashers:rt,loadHasher:_.ipld&&_.ipld.loadHasher});return{add:createAdd(_),addAll:createAddAll(_),bitswap:createBitswap$1(_),block:createBlock(_),bootstrap:createBootstrap(_),cat:createCat(_),commands:createCommands(_),config:createConfig(_),dag:createDag(tt,_),dht:createDht$1(_),diag:createDiag(_),dns:createDns(_),files:createFiles(_),get:createGet(_),getEndpointConfig:createGetEndpointConfig(_),id:createId(_),isOnline:createIsOnline(_),key:createKey(_),log:createLog(_),ls:createLs(_),mount:createMount(_),name:createName(_),object:createObject(tt,_),pin:createPin(_),ping:createPing$1(_),pubsub:createPubsub$1(_),refs:createRefs(_),repo:createRepo(_),resolve:createResolve(_),start:createStart(_),stats:createStats(_),stop:createStop(_),swarm:createSwarm(_),version:createVersion(_),bases:j,codecs:tt,hashers:nt}}const CODE_P2P$1=421,CODE_CIRCUIT$1=290,CLOSE_TIMEOUT$1=2e3,PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(_=>{PACKET_TYPES_REVERSE[PACKET_TYPES[_]]=_});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=_=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(_):_&&_.buffer instanceof ArrayBuffer,encodePacket=({type:_,data:o},$,j)=>withNativeBlob$1&&o instanceof Blob?$?j(o):encodeBlobAsBase64(o,j):withNativeArrayBuffer$2&&(o instanceof ArrayBuffer||isView$1(o))?$?j(o):encodeBlobAsBase64(new Blob([o]),j):j(PACKET_TYPES[_]+(o||"")),encodeBlobAsBase64=(_,o)=>{const $=new FileReader;return $.onload=function(){const j=$.result.split(",")[1];o("b"+(j||""))},$.readAsDataURL(_)},chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let _=0;_<chars.length;_++)lookup$1[chars.charCodeAt(_)]=_;const decode$2=_=>{let o=_.length*.75,$=_.length,j,et=0,tt,rt,nt,it;_[_.length-1]==="="&&(o--,_[_.length-2]==="="&&o--);const st=new ArrayBuffer(o),ot=new Uint8Array(st);for(j=0;j<$;j+=4)tt=lookup$1[_.charCodeAt(j)],rt=lookup$1[_.charCodeAt(j+1)],nt=lookup$1[_.charCodeAt(j+2)],it=lookup$1[_.charCodeAt(j+3)],ot[et++]=tt<<2|rt>>4,ot[et++]=(rt&15)<<4|nt>>2,ot[et++]=(nt&3)<<6|it&63;return st},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(_,o)=>{if(typeof _!="string")return{type:"message",data:mapBinary(_,o)};const $=_.charAt(0);return $==="b"?{type:"message",data:decodeBase64Packet(_.substring(1),o)}:PACKET_TYPES_REVERSE[$]?_.length>1?{type:PACKET_TYPES_REVERSE[$],data:_.substring(1)}:{type:PACKET_TYPES_REVERSE[$]}:ERROR_PACKET},decodeBase64Packet=(_,o)=>{if(withNativeArrayBuffer$1){const $=decode$2(_);return mapBinary($,o)}else return{base64:!0,data:_}},mapBinary=(_,o)=>{switch(o){case"blob":return _ instanceof ArrayBuffer?new Blob([_]):_;case"arraybuffer":default:return _}},SEPARATOR=String.fromCharCode(30),encodePayload=(_,o)=>{const $=_.length,j=new Array($);let et=0;_.forEach((tt,rt)=>{encodePacket(tt,!1,nt=>{j[rt]=nt,++et===$&&o(j.join(SEPARATOR))})})},decodePayload$1=(_,o)=>{const $=_.split(SEPARATOR),j=[];for(let et=0;et<$.length;et++){const tt=decodePacket($[et],o);if(j.push(tt),tt.type==="error")break}return j},protocol$1=4;function Emitter(_){if(_)return mixin(_)}function mixin(_){for(var o in Emitter.prototype)_[o]=Emitter.prototype[o];return _}Emitter.prototype.on=Emitter.prototype.addEventListener=function(_,o){return this._callbacks=this._callbacks||{},(this._callbacks["$"+_]=this._callbacks["$"+_]||[]).push(o),this};Emitter.prototype.once=function(_,o){function $(){this.off(_,$),o.apply(this,arguments)}return $.fn=o,this.on(_,$),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(_,o){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var $=this._callbacks["$"+_];if(!$)return this;if(arguments.length==1)return delete this._callbacks["$"+_],this;for(var j,et=0;et<$.length;et++)if(j=$[et],j===o||j.fn===o){$.splice(et,1);break}return $.length===0&&delete this._callbacks["$"+_],this};Emitter.prototype.emit=function(_){this._callbacks=this._callbacks||{};for(var o=new Array(arguments.length-1),$=this._callbacks["$"+_],j=1;j<arguments.length;j++)o[j-1]=arguments[j];if($){$=$.slice(0);for(var j=0,et=$.length;j<et;++j)$[j].apply(this,o)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(_){return this._callbacks=this._callbacks||{},this._callbacks["$"+_]||[]};Emitter.prototype.hasListeners=function(_){return!!this.listeners(_).length};const globalThisShim=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function pick(_,...o){return o.reduce(($,j)=>(_.hasOwnProperty(j)&&($[j]=_[j]),$),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(_,o){o.useNativeTimers?(_.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),_.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(_.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),_.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(_){return typeof _=="string"?utf8Length(_):Math.ceil((_.byteLength||_.size)*BASE64_OVERHEAD)}function utf8Length(_){let o=0,$=0;for(let j=0,et=_.length;j<et;j++)o=_.charCodeAt(j),o<128?$+=1:o<2048?$+=2:o<55296||o>=57344?$+=3:(j++,$+=4);return $}class TransportError extends Error{constructor(o,$,j){super(o),this.description=$,this.context=j,this.type="TransportError"}}class Transport extends Emitter{constructor(o){super(),this.writable=!1,installTimerFunctions(this,o),this.opts=o,this.query=o.query,this.socket=o.socket}onError(o,$,j){return super.emitReserved("error",new TransportError(o,$,j)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(o){this.readyState==="open"&&this.write(o)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(o){const $=decodePacket(o,this.socket.binaryType);this.onPacket($)}onPacket(o){super.emitReserved("packet",o)}onClose(o){this.readyState="closed",super.emitReserved("close",o)}pause(o){}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length$1=64,map$1={};let seed=0,i=0,prev;function encode$4(_){let o="";do o=alphabet[_%length$1]+o,_=Math.floor(_/length$1);while(_>0);return o}function yeast(){const _=encode$4(+new Date);return _!==prev?(seed=0,prev=_):_+"."+encode$4(seed++)}for(;i<length$1;i++)map$1[alphabet[i]]=i;function encode$3(_){let o="";for(let $ in _)_.hasOwnProperty($)&&(o.length&&(o+="&"),o+=encodeURIComponent($)+"="+encodeURIComponent(_[$]));return o}function decode$1(_){let o={},$=_.split("&");for(let j=0,et=$.length;j<et;j++){let tt=$[j].split("=");o[decodeURIComponent(tt[0])]=decodeURIComponent(tt[1])}return o}let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch(_){}const hasCORS=value;function XHR(_){const o=_.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!o||hasCORS))return new XMLHttpRequest}catch{}if(!o)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(o){if(super(o),this.polling=!1,typeof location<"u"){const j=location.protocol==="https:";let et=location.port;et||(et=j?"443":"80"),this.xd=typeof location<"u"&&o.hostname!==location.hostname||et!==o.port,this.xs=o.secure!==j}const $=o&&o.forceBase64;this.supportsBinary=hasXHR2&&!$}get name(){return"polling"}doOpen(){this.poll()}pause(o){this.readyState="pausing";const $=()=>{this.readyState="paused",o()};if(this.polling||!this.writable){let j=0;this.polling&&(j++,this.once("pollComplete",function(){--j||$()})),this.writable||(j++,this.once("drain",function(){--j||$()}))}else $()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(o){const $=j=>{if(this.readyState==="opening"&&j.type==="open"&&this.onOpen(),j.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(j)};decodePayload$1(o,this.socket.binaryType).forEach($),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const o=()=>{this.write([{type:"close"}])};this.readyState==="open"?o():this.once("open",o)}write(o){this.writable=!1,encodePayload(o,$=>{this.doWrite($,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let o=this.query||{};const $=this.opts.secure?"https":"http";let j="";this.opts.timestampRequests!==!1&&(o[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!o.sid&&(o.b64=1),this.opts.port&&($==="https"&&Number(this.opts.port)!==443||$==="http"&&Number(this.opts.port)!==80)&&(j=":"+this.opts.port);const et=encode$3(o),tt=this.opts.hostname.indexOf(":")!==-1;return $+"://"+(tt?"["+this.opts.hostname+"]":this.opts.hostname)+j+this.opts.path+(et.length?"?"+et:"")}request(o={}){return Object.assign(o,{xd:this.xd,xs:this.xs},this.opts),new Request(this.uri(),o)}doWrite(o,$){const j=this.request({method:"POST",data:o});j.on("success",$),j.on("error",(et,tt)=>{this.onError("xhr post error",et,tt)})}doPoll(){const o=this.request();o.on("data",this.onData.bind(this)),o.on("error",($,j)=>{this.onError("xhr poll error",$,j)}),this.pollXhr=o}}class Request extends Emitter{constructor(o,$){super(),installTimerFunctions(this,$),this.opts=$,this.method=$.method||"GET",this.uri=o,this.async=$.async!==!1,this.data=$.data!==void 0?$.data:null,this.create()}create(){const o=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");o.xdomain=!!this.opts.xd,o.xscheme=!!this.opts.xs;const $=this.xhr=new XHR(o);try{$.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){$.setDisableHeaderCheck&&$.setDisableHeaderCheck(!0);for(let j in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(j)&&$.setRequestHeader(j,this.opts.extraHeaders[j])}}catch{}if(this.method==="POST")try{$.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{$.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in $&&($.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&($.timeout=this.opts.requestTimeout),$.onreadystatechange=()=>{$.readyState===4&&($.status===200||$.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof $.status=="number"?$.status:0)},0))},$.send(this.data)}catch(j){this.setTimeoutFn(()=>{this.onError(j)},0);return}typeof document<"u"&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(o){this.emitReserved("error",o,this.xhr),this.cleanup(!0)}cleanup(o){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,o)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Request.requests[this.index],this.xhr=null}}onLoad(){const o=this.xhr.responseText;o!==null&&(this.emitReserved("data",o),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Request.requestsCount=0;Request.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const _="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(_,unloadHandler,!1)}}function unloadHandler(){for(let _ in Request.requests)Request.requests.hasOwnProperty(_)&&Request.requests[_].abort()}const nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?o=>Promise.resolve().then(o):(o,$)=>$(o,0))(),WebSocket$2=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class WS extends Transport{constructor(o){super(o),this.supportsBinary=!o.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const o=this.uri(),$=this.opts.protocols,j=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(j.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?$?new WebSocket$2(o,$):new WebSocket$2(o):new WebSocket$2(o,$,j)}catch(et){return this.emitReserved("error",et)}this.ws.binaryType=this.socket.binaryType||defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=o=>this.onClose({description:"websocket connection closed",context:o}),this.ws.onmessage=o=>this.onData(o.data),this.ws.onerror=o=>this.onError("websocket error",o)}write(o){this.writable=!1;for(let $=0;$<o.length;$++){const j=o[$],et=$===o.length-1;encodePacket(j,this.supportsBinary,tt=>{const rt={};try{usingBrowserWebSocket&&this.ws.send(tt)}catch{}et&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let o=this.query||{};const $=this.opts.secure?"wss":"ws";let j="";this.opts.port&&($==="wss"&&Number(this.opts.port)!==443||$==="ws"&&Number(this.opts.port)!==80)&&(j=":"+this.opts.port),this.opts.timestampRequests&&(o[this.opts.timestampParam]=yeast()),this.supportsBinary||(o.b64=1);const et=encode$3(o),tt=this.opts.hostname.indexOf(":")!==-1;return $+"://"+(tt?"["+this.opts.hostname+"]":this.opts.hostname)+j+this.opts.path+(et.length?"?"+et:"")}check(){return!!WebSocket$2}}const transports={websocket:WS,polling:Polling},re=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse$2(_){const o=_,$=_.indexOf("["),j=_.indexOf("]");$!=-1&&j!=-1&&(_=_.substring(0,$)+_.substring($,j).replace(/:/g,";")+_.substring(j,_.length));let et=re.exec(_||""),tt={},rt=14;for(;rt--;)tt[parts[rt]]=et[rt]||"";return $!=-1&&j!=-1&&(tt.source=o,tt.host=tt.host.substring(1,tt.host.length-1).replace(/;/g,":"),tt.authority=tt.authority.replace("[","").replace("]","").replace(/;/g,":"),tt.ipv6uri=!0),tt.pathNames=pathNames(tt,tt.path),tt.queryKey=queryKey(tt,tt.query),tt}function pathNames(_,o){const $=/\/{2,9}/g,j=o.replace($,"/").split("/");return(o.slice(0,1)=="/"||o.length===0)&&j.splice(0,1),o.slice(-1)=="/"&&j.splice(j.length-1,1),j}function queryKey(_,o){const $={};return o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(j,et,tt){et&&($[et]=tt)}),$}let Socket$1=class us extends Emitter{constructor(o,$={}){super(),this.writeBuffer=[],o&&typeof o=="object"&&($=o,o=null),o?(o=parse$2(o),$.hostname=o.host,$.secure=o.protocol==="https"||o.protocol==="wss",$.port=o.port,o.query&&($.query=o.query)):$.host&&($.hostname=parse$2($.host).host),installTimerFunctions(this,$),this.secure=$.secure!=null?$.secure:typeof location<"u"&&location.protocol==="https:",$.hostname&&!$.port&&($.port=this.secure?"443":"80"),this.hostname=$.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=$.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=$.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},$),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode$1(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(o){const $=Object.assign({},this.opts.query);$.EIO=protocol$1,$.transport=o,this.id&&($.sid=this.id);const j=Object.assign({},this.opts.transportOptions[o],this.opts,{query:$,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new transports[o](j)}open(){let o;if(this.opts.rememberUpgrade&&us.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)o="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else o=this.transports[0];this.readyState="opening";try{o=this.createTransport(o)}catch{this.transports.shift(),this.open();return}o.open(),this.setTransport(o)}setTransport(o){this.transport&&this.transport.removeAllListeners(),this.transport=o,o.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",$=>this.onClose("transport close",$))}probe(o){let $=this.createTransport(o),j=!1;us.priorWebsocketSuccess=!1;const et=()=>{j||($.send([{type:"ping",data:"probe"}]),$.once("packet",at=>{if(!j)if(at.type==="pong"&&at.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",$),!$)return;us.priorWebsocketSuccess=$.name==="websocket",this.transport.pause(()=>{j||this.readyState!=="closed"&&(ot(),this.setTransport($),$.send([{type:"upgrade"}]),this.emitReserved("upgrade",$),$=null,this.upgrading=!1,this.flush())})}else{const ct=new Error("probe error");ct.transport=$.name,this.emitReserved("upgradeError",ct)}}))};function tt(){j||(j=!0,ot(),$.close(),$=null)}const rt=at=>{const ct=new Error("probe error: "+at);ct.transport=$.name,tt(),this.emitReserved("upgradeError",ct)};function nt(){rt("transport closed")}function it(){rt("socket closed")}function st(at){$&&at.name!==$.name&&tt()}const ot=()=>{$.removeListener("open",et),$.removeListener("error",rt),$.removeListener("close",nt),this.off("close",it),this.off("upgrading",st)};$.once("open",et),$.once("error",rt),$.once("close",nt),this.once("close",it),this.once("upgrading",st),$.open()}onOpen(){if(this.readyState="open",us.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let o=0;const $=this.upgrades.length;for(;o<$;o++)this.probe(this.upgrades[o])}}onPacket(o){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",o),this.emitReserved("heartbeat"),o.type){case"open":this.onHandshake(JSON.parse(o.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const $=new Error("server error");$.code=o.data,this.onError($);break;case"message":this.emitReserved("data",o.data),this.emitReserved("message",o.data);break}}onHandshake(o){this.emitReserved("handshake",o),this.id=o.sid,this.transport.query.sid=o.sid,this.upgrades=this.filterUpgrades(o.upgrades),this.pingInterval=o.pingInterval,this.pingTimeout=o.pingTimeout,this.maxPayload=o.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const o=this.getWritablePackets();this.transport.send(o),this.prevBufferLen=o.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let $=1;for(let j=0;j<this.writeBuffer.length;j++){const et=this.writeBuffer[j].data;if(et&&($+=byteLength(et)),j>0&&$>this.maxPayload)return this.writeBuffer.slice(0,j);$+=2}return this.writeBuffer}write(o,$,j){return this.sendPacket("message",o,$,j),this}send(o,$,j){return this.sendPacket("message",o,$,j),this}sendPacket(o,$,j,et){if(typeof $=="function"&&(et=$,$=void 0),typeof j=="function"&&(et=j,j=null),this.readyState==="closing"||this.readyState==="closed")return;j=j||{},j.compress=j.compress!==!1;const tt={type:o,data:$,options:j};this.emitReserved("packetCreate",tt),this.writeBuffer.push(tt),et&&this.once("flush",et),this.flush()}close(){const o=()=>{this.onClose("forced close"),this.transport.close()},$=()=>{this.off("upgrade",$),this.off("upgradeError",$),o()},j=()=>{this.once("upgrade",$),this.once("upgradeError",$)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?j():o()}):this.upgrading?j():o()),this}onError(o){us.priorWebsocketSuccess=!1,this.emitReserved("error",o),this.onClose("transport error",o)}onClose(o,$){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",o,$),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(o){const $=[];let j=0;const et=o.length;for(;j<et;j++)~this.transports.indexOf(o[j])&&$.push(o[j]);return $}};Socket$1.protocol=protocol$1;function url(_,o="",$){let j=_;$=$||typeof location<"u"&&location,_==null&&(_=$.protocol+"//"+$.host),typeof _=="string"&&(_.charAt(0)==="/"&&(_.charAt(1)==="/"?_=$.protocol+_:_=$.host+_),/^(https?|wss?):\/\//.test(_)||(typeof $<"u"?_=$.protocol+"//"+_:_="https://"+_),j=parse$2(_)),j.port||(/^(http|ws)$/.test(j.protocol)?j.port="80":/^(http|ws)s$/.test(j.protocol)&&(j.port="443")),j.path=j.path||"/";const tt=j.host.indexOf(":")!==-1?"["+j.host+"]":j.host;return j.id=j.protocol+"://"+tt+":"+j.port+o,j.href=j.protocol+"://"+tt+($&&$.port===j.port?"":":"+j.port),j}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=_=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(_):_.buffer instanceof ArrayBuffer,toString$1=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString$1.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString$1.call(File)==="[object FileConstructor]";function isBinary(_){return withNativeArrayBuffer&&(_ instanceof ArrayBuffer||isView(_))||withNativeBlob&&_ instanceof Blob||withNativeFile&&_ instanceof File}function hasBinary(_,o){if(!_||typeof _!="object")return!1;if(Array.isArray(_)){for(let $=0,j=_.length;$<j;$++)if(hasBinary(_[$]))return!0;return!1}if(isBinary(_))return!0;if(_.toJSON&&typeof _.toJSON=="function"&&arguments.length===1)return hasBinary(_.toJSON(),!0);for(const $ in _)if(Object.prototype.hasOwnProperty.call(_,$)&&hasBinary(_[$]))return!0;return!1}function deconstructPacket(_){const o=[],$=_.data,j=_;return j.data=_deconstructPacket($,o),j.attachments=o.length,{packet:j,buffers:o}}function _deconstructPacket(_,o){if(!_)return _;if(isBinary(_)){const $={_placeholder:!0,num:o.length};return o.push(_),$}else if(Array.isArray(_)){const $=new Array(_.length);for(let j=0;j<_.length;j++)$[j]=_deconstructPacket(_[j],o);return $}else if(typeof _=="object"&&!(_ instanceof Date)){const $={};for(const j in _)Object.prototype.hasOwnProperty.call(_,j)&&($[j]=_deconstructPacket(_[j],o));return $}return _}function reconstructPacket(_,o){return _.data=_reconstructPacket(_.data,o),delete _.attachments,_}function _reconstructPacket(_,o){if(!_)return _;if(_&&_._placeholder===!0){if(typeof _.num=="number"&&_.num>=0&&_.num<o.length)return o[_.num];throw new Error("illegal attachments")}else if(Array.isArray(_))for(let $=0;$<_.length;$++)_[$]=_reconstructPacket(_[$],o);else if(typeof _=="object")for(const $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(_[$]=_reconstructPacket(_[$],o));return _}const protocol=5;var PacketType;(function(_){_[_.CONNECT=0]="CONNECT",_[_.DISCONNECT=1]="DISCONNECT",_[_.EVENT=2]="EVENT",_[_.ACK=3]="ACK",_[_.CONNECT_ERROR=4]="CONNECT_ERROR",_[_.BINARY_EVENT=5]="BINARY_EVENT",_[_.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));let Encoder$1=class{constructor(o){this.replacer=o}encode(o){return(o.type===PacketType.EVENT||o.type===PacketType.ACK)&&hasBinary(o)?this.encodeAsBinary({type:o.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:o.nsp,data:o.data,id:o.id}):[this.encodeAsString(o)]}encodeAsString(o){let $=""+o.type;return(o.type===PacketType.BINARY_EVENT||o.type===PacketType.BINARY_ACK)&&($+=o.attachments+"-"),o.nsp&&o.nsp!=="/"&&($+=o.nsp+","),o.id!=null&&($+=o.id),o.data!=null&&($+=JSON.stringify(o.data,this.replacer)),$}encodeAsBinary(o){const $=deconstructPacket(o),j=this.encodeAsString($.packet),et=$.buffers;return et.unshift(j),et}},Decoder$1=class Oo extends Emitter{constructor(o){super(),this.reviver=o}add(o){let $;if(typeof o=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");$=this.decodeString(o);const j=$.type===PacketType.BINARY_EVENT;j||$.type===PacketType.BINARY_ACK?($.type=j?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor($),$.attachments===0&&super.emitReserved("decoded",$)):super.emitReserved("decoded",$)}else if(isBinary(o)||o.base64)if(this.reconstructor)$=this.reconstructor.takeBinaryData(o),$&&(this.reconstructor=null,super.emitReserved("decoded",$));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+o)}decodeString(o){let $=0;const j={type:Number(o.charAt(0))};if(PacketType[j.type]===void 0)throw new Error("unknown packet type "+j.type);if(j.type===PacketType.BINARY_EVENT||j.type===PacketType.BINARY_ACK){const tt=$+1;for(;o.charAt(++$)!=="-"&&$!=o.length;);const rt=o.substring(tt,$);if(rt!=Number(rt)||o.charAt($)!=="-")throw new Error("Illegal attachments");j.attachments=Number(rt)}if(o.charAt($+1)==="/"){const tt=$+1;for(;++$&&!(o.charAt($)===","||$===o.length););j.nsp=o.substring(tt,$)}else j.nsp="/";const et=o.charAt($+1);if(et!==""&&Number(et)==et){const tt=$+1;for(;++$;){const rt=o.charAt($);if(rt==null||Number(rt)!=rt){--$;break}if($===o.length)break}j.id=Number(o.substring(tt,$+1))}if(o.charAt(++$)){const tt=this.tryParse(o.substr($));if(Oo.isPayloadValid(j.type,tt))j.data=tt;else throw new Error("invalid payload")}return j}tryParse(o){try{return JSON.parse(o,this.reviver)}catch{return!1}}static isPayloadValid(o,$){switch(o){case PacketType.CONNECT:return typeof $=="object";case PacketType.DISCONNECT:return $===void 0;case PacketType.CONNECT_ERROR:return typeof $=="string"||typeof $=="object";case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray($)&&$.length>0;case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray($)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};class BinaryReconstructor{constructor(o){this.packet=o,this.buffers=[],this.reconPack=o}takeBinaryData(o){if(this.buffers.push(o),this.buffers.length===this.reconPack.attachments){const $=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),$}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Decoder$1,Encoder:Encoder$1,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"}));function on(_,o,$){return _.on(o,$),function(){_.off(o,$)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(o,$,j){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=o,this.nsp=$,j&&j.auth&&(this.auth=j.auth),this._opts=Object.assign({},j),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const o=this.io;this.subs=[on(o,"open",this.onopen.bind(this)),on(o,"packet",this.onpacket.bind(this)),on(o,"error",this.onerror.bind(this)),on(o,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...o){return o.unshift("message"),this.emit.apply(this,o),this}emit(o,...$){if(RESERVED_EVENTS.hasOwnProperty(o))throw new Error('"'+o.toString()+'" is a reserved event name');if($.unshift(o),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue($),this;const j={type:PacketType.EVENT,data:$};if(j.options={},j.options.compress=this.flags.compress!==!1,typeof $[$.length-1]=="function"){const rt=this.ids++,nt=$.pop();this._registerAckCallback(rt,nt),j.id=rt}const et=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!et||!this.connected)||(this.connected?(this.notifyOutgoingListeners(j),this.packet(j)):this.sendBuffer.push(j)),this.flags={},this}_registerAckCallback(o,$){var j;const et=(j=this.flags.timeout)!==null&&j!==void 0?j:this._opts.ackTimeout;if(et===void 0){this.acks[o]=$;return}const tt=this.io.setTimeoutFn(()=>{delete this.acks[o];for(let rt=0;rt<this.sendBuffer.length;rt++)this.sendBuffer[rt].id===o&&this.sendBuffer.splice(rt,1);$.call(this,new Error("operation has timed out"))},et);this.acks[o]=(...rt)=>{this.io.clearTimeoutFn(tt),$.apply(this,[null,...rt])}}emitWithAck(o,...$){const j=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((et,tt)=>{$.push((rt,nt)=>j?rt?tt(rt):et(nt):et(rt)),this.emit(o,...$)})}_addToQueue(o){let $;typeof o[o.length-1]=="function"&&($=o.pop());const j={id:this._queueSeq++,tryCount:0,pending:!1,args:o,flags:Object.assign({fromQueue:!0},this.flags)};o.push((et,...tt)=>j!==this._queue[0]?void 0:(et!==null?j.tryCount>this._opts.retries&&(this._queue.shift(),$&&$(et)):(this._queue.shift(),$&&$(null,...tt)),j.pending=!1,this._drainQueue())),this._queue.push(j),this._drainQueue()}_drainQueue(o=!1){if(!this.connected||this._queue.length===0)return;const $=this._queue[0];$.pending&&!o||($.pending=!0,$.tryCount++,this.flags=$.flags,this.emit.apply(this,$.args))}packet(o){o.nsp=this.nsp,this.io._packet(o)}onopen(){typeof this.auth=="function"?this.auth(o=>{this._sendConnectPacket(o)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(o){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},o):o})}onerror(o){this.connected||this.emitReserved("connect_error",o)}onclose(o,$){this.connected=!1,delete this.id,this.emitReserved("disconnect",o,$)}onpacket(o){if(o.nsp===this.nsp)switch(o.type){case PacketType.CONNECT:o.data&&o.data.sid?this.onconnect(o.data.sid,o.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(o);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(o);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const j=new Error(o.data.message);j.data=o.data.data,this.emitReserved("connect_error",j);break}}onevent(o){const $=o.data||[];o.id!=null&&$.push(this.ack(o.id)),this.connected?this.emitEvent($):this.receiveBuffer.push(Object.freeze($))}emitEvent(o){if(this._anyListeners&&this._anyListeners.length){const $=this._anyListeners.slice();for(const j of $)j.apply(this,o)}super.emit.apply(this,o),this._pid&&o.length&&typeof o[o.length-1]=="string"&&(this._lastOffset=o[o.length-1])}ack(o){const $=this;let j=!1;return function(...et){j||(j=!0,$.packet({type:PacketType.ACK,id:o,data:et}))}}onack(o){const $=this.acks[o.id];typeof $=="function"&&($.apply(this,o.data),delete this.acks[o.id])}onconnect(o,$){this.id=o,this.recovered=$&&this._pid===$,this._pid=$,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(o=>this.emitEvent(o)),this.receiveBuffer=[],this.sendBuffer.forEach(o=>{this.notifyOutgoingListeners(o),this.packet(o)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(o=>o()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(o){return this.flags.compress=o,this}get volatile(){return this.flags.volatile=!0,this}timeout(o){return this.flags.timeout=o,this}onAny(o){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(o),this}prependAny(o){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(o),this}offAny(o){if(!this._anyListeners)return this;if(o){const $=this._anyListeners;for(let j=0;j<$.length;j++)if(o===$[j])return $.splice(j,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(o){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(o),this}prependAnyOutgoing(o){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(o),this}offAnyOutgoing(o){if(!this._anyOutgoingListeners)return this;if(o){const $=this._anyOutgoingListeners;for(let j=0;j<$.length;j++)if(o===$[j])return $.splice(j,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(o){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const $=this._anyOutgoingListeners.slice();for(const j of $)j.apply(this,o.data)}}}function Backoff(_){_=_||{},this.ms=_.min||100,this.max=_.max||1e4,this.factor=_.factor||2,this.jitter=_.jitter>0&&_.jitter<=1?_.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var _=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var o=Math.random(),$=Math.floor(o*this.jitter*_);_=Math.floor(o*10)&1?_+$:_-$}return Math.min(_,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(_){this.ms=_};Backoff.prototype.setMax=function(_){this.max=_};Backoff.prototype.setJitter=function(_){this.jitter=_};class Manager extends Emitter{constructor(o,$){var j;super(),this.nsps={},this.subs=[],o&&typeof o=="object"&&($=o,o=void 0),$=$||{},$.path=$.path||"/socket.io",this.opts=$,installTimerFunctions(this,$),this.reconnection($.reconnection!==!1),this.reconnectionAttempts($.reconnectionAttempts||1/0),this.reconnectionDelay($.reconnectionDelay||1e3),this.reconnectionDelayMax($.reconnectionDelayMax||5e3),this.randomizationFactor((j=$.randomizationFactor)!==null&&j!==void 0?j:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout($.timeout==null?2e4:$.timeout),this._readyState="closed",this.uri=o;const et=$.parser||parser;this.encoder=new et.Encoder,this.decoder=new et.Decoder,this._autoConnect=$.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(o){return arguments.length?(this._reconnection=!!o,this):this._reconnection}reconnectionAttempts(o){return o===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=o,this)}reconnectionDelay(o){var $;return o===void 0?this._reconnectionDelay:(this._reconnectionDelay=o,($=this.backoff)===null||$===void 0||$.setMin(o),this)}randomizationFactor(o){var $;return o===void 0?this._randomizationFactor:(this._randomizationFactor=o,($=this.backoff)===null||$===void 0||$.setJitter(o),this)}reconnectionDelayMax(o){var $;return o===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=o,($=this.backoff)===null||$===void 0||$.setMax(o),this)}timeout(o){return arguments.length?(this._timeout=o,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(o){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const $=this.engine,j=this;this._readyState="opening",this.skipReconnect=!1;const et=on($,"open",function(){j.onopen(),o&&o()}),tt=on($,"error",rt=>{j.cleanup(),j._readyState="closed",this.emitReserved("error",rt),o?o(rt):j.maybeReconnectOnOpen()});if(this._timeout!==!1){const rt=this._timeout;rt===0&&et();const nt=this.setTimeoutFn(()=>{et(),$.close(),$.emit("error",new Error("timeout"))},rt);this.opts.autoUnref&&nt.unref(),this.subs.push(function(){clearTimeout(nt)})}return this.subs.push(et),this.subs.push(tt),this}connect(o){return this.open(o)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const o=this.engine;this.subs.push(on(o,"ping",this.onping.bind(this)),on(o,"data",this.ondata.bind(this)),on(o,"error",this.onerror.bind(this)),on(o,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(o){try{this.decoder.add(o)}catch($){this.onclose("parse error",$)}}ondecoded(o){nextTick(()=>{this.emitReserved("packet",o)},this.setTimeoutFn)}onerror(o){this.emitReserved("error",o)}socket(o,$){let j=this.nsps[o];return j?this._autoConnect&&!j.active&&j.connect():(j=new Socket(this,o,$),this.nsps[o]=j),j}_destroy(o){const $=Object.keys(this.nsps);for(const j of $)if(this.nsps[j].active)return;this._close()}_packet(o){const $=this.encoder.encode(o);for(let j=0;j<$.length;j++)this.engine.write($[j],o.options)}cleanup(){this.subs.forEach(o=>o()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(o,$){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",o,$),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const o=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const $=this.backoff.duration();this._reconnecting=!0;const j=this.setTimeoutFn(()=>{o.skipReconnect||(this.emitReserved("reconnect_attempt",o.backoff.attempts),!o.skipReconnect&&o.open(et=>{et?(o._reconnecting=!1,o.reconnect(),this.emitReserved("reconnect_error",et)):o.onreconnect()}))},$);this.opts.autoUnref&&j.unref(),this.subs.push(function(){clearTimeout(j)})}}onreconnect(){const o=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",o)}}const cache$1={};function lookup(_,o){typeof _=="object"&&(o=_,_=void 0),o=o||{};const $=url(_,o.path||"/socket.io"),j=$.source,et=$.id,tt=$.path,rt=cache$1[et]&&tt in cache$1[et].nsps,nt=o.forceNew||o["force new connection"]||o.multiplex===!1||rt;let it;return nt?it=new Manager(j,o):(cache$1[et]||(cache$1[et]=new Manager(j,o)),it=cache$1[et]),$.query&&!o.query&&(o.query=$.queryKey),it.socket($.path,o)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});const MAX_BYTES=65536;function randomBytes$1(_){const o=new Uint8Array(_);let $=0;if(_>0)if(_>MAX_BYTES)for(;$<_;)$+MAX_BYTES>_?(crypto.getRandomValues(o.subarray($,$+(_-$))),$+=_-$):(crypto.getRandomValues(o.subarray($,$+MAX_BYTES)),$+=MAX_BYTES);else crypto.getRandomValues(o);return o}var random_browser=randomBytes$1;const MAX_BUFFERED_AMOUNT=64*1024,CHANNEL_CLOSING_TIMEOUT=5*1e3;class WebRTCDataChannel{constructor(o,$){this.label=o.label,this.open=pDefer$1(),this.channel=o,this.channel.binaryType="arraybuffer",this.log=$.log,typeof this.channel.bufferedAmountLowThreshold=="number"&&(this.channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT),o.addEventListener("message",et=>{$.onMessage(et)}),o.addEventListener("bufferedamountlow",()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()}),o.addEventListener("open",()=>{this.open.resolve(),$.onOpen()}),o.addEventListener("close",()=>{$.onClose()}),o.addEventListener("error",et=>{var rt,nt,it,st,ot;if(((rt=et.error)==null?void 0:rt.message)==="Transport channel closed")return this.close();$.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',o.readyState,(nt=et.error)==null?void 0:nt.message,(it=et.error)==null?void 0:it.errorDetail);const tt=et.error instanceof Error?et.error:new Error(`datachannel error: ${(st=et.error)==null?void 0:st.message} ${(ot=et.error)==null?void 0:ot.errorDetail}`);$.onError(errCode(tt,"ERR_DATA_CHANNEL"))});let j=!1;this.closingInterval=setInterval(()=>{o.readyState==="closing"?(j&&$.onClose(),j=!0):j=!1},CHANNEL_CLOSING_TIMEOUT)}async send(o){await this.open.promise,this.channel.send(o),this.channel.bufferedAmount>MAX_BUFFERED_AMOUNT&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=pDefer$1())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var delayExports={},delay$1={get exports(){return delayExports},set exports(_){delayExports=_}};const randomInteger=(_,o)=>Math.floor(Math.random()*(o-_+1)+_),createAbortError=()=>{const _=new Error("Delay aborted");return _.name="AbortError",_},createDelay=({clearTimeout:_,setTimeout:o,willResolve:$})=>(j,{value:et,signal:tt}={})=>{if(tt&&tt.aborted)return Promise.reject(createAbortError());let rt,nt,it;const st=_||clearTimeout,ot=()=>{st(rt),it(createAbortError())},at=()=>{tt&&tt.removeEventListener("abort",ot)},ct=new Promise((ut,ft)=>{nt=()=>{at(),$?ut(et):ft(et)},it=ft,rt=(o||setTimeout)(nt,j)});return tt&&tt.addEventListener("abort",ot,{once:!0}),ct.clear=()=>{st(rt),rt=null,nt()},ct},createWithTimers=_=>{const o=createDelay({..._,willResolve:!0});return o.reject=createDelay({..._,willResolve:!1}),o.range=($,j,et)=>o(randomInteger($,j),et),o},delay=createWithTimers();delay.createWithTimers=createWithTimers;delay$1.exports=delay;delayExports.default=delay;const DEFAULT_PEER_CONNECTION_CONFIG={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};function getBrowserRTC(){if(typeof globalThis>"u")throw errCode(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const _={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(_.RTCPeerConnection==null)throw errCode(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return _}class WebRTCPeer extends EventEmitter$1{constructor(o){super(),this.id=o.id??toString$a(random_browser(4),"hex").slice(0,7),this.log=logger$1(`libp2p:webrtc-peer:${o.logPrefix}:${this.id}`),this.wrtc=o.wrtc??getBrowserRTC(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},DEFAULT_PEER_CONNECTION_CONFIG,o.peerConnectionConfig)),this.closed=!1,this.connected=pDefer$1(),this.source=pushable(),this.sink=async $=>{if(await this.connected.promise,this.channel==null)throw errCode(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(const j of $)await this.channel.send(j);await this.close()}}handleDataChannelEvent(o){const $=o.channel;if($==null){this.close(errCode(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch(j=>{this.log("Error closing after event channel was found to be null",j)});return}this.channel=new WebRTCDataChannel($,{log:this.log,onMessage:j=>{this.source.push(new Uint8Array(j.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new CustomEvent("ready"))},onClose:()=>{this.close().catch(j=>{this.log("error closing connection after channel close",j)})},onError:j=>{this.close(j).catch(et=>{this.log("error closing connection after channel error",et)})}})}async close(o){var $;if(this.closed=!0,o==null&&this.channel!=null)for(;this.channel.bufferedAmount>0;)await delayExports(100);($=this.channel)==null||$.close(),this.peerConnection.close(),this.source.end(o),this.dispatchEvent(new CustomEvent("close"))}}class WebRTCHandshake extends EventEmitter$1{constructor(o){super(),this.log=o.log,this.peerConnection=o.peerConnection,this.wrtc=o.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch($=>{this.log.error("could not renegotiate %o",$)})})}async handleSignal(o){if(this.log('incoming signal "%s"',o.type),o.type==="offer")return await this.handleOffer(o);if(o.type==="answer")return await this.handleAnswer(o);if(o.type==="candidate")return await this.handleCandidate(o);if(o.type==="renegotiate")return await this.handleRenegotiate(o);if(o.type==="goodbye")return await this.handleGoodye(o);this.log(`Unknown signal type ${o.type}`)}async handleOffer(o){}async handleAnswer(o){}async handleRenegotiate(o){}async handleGoodye(o){this.peerConnection.close()}async handleCandidate(o){const $=new this.wrtc.RTCIceCandidate(o.candidate);try{await this.peerConnection.addIceCandidate($)}catch(j){if($.address==null||$.address.endsWith(".local"))this.log("ignoring unsupported ICE candidate.");else throw errCode(j,"ERR_ADD_ICE_CANDIDATE")}}}const log$T=logger$1("libp2p:webrtc-peer:receiver");class WebRTCReceiver extends WebRTCPeer{constructor(o={}){super({...o,logPrefix:"receiver"}),this.handshake=new WebRTCReceiverHandshake({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:o.answerOptions}),this.handshake.addEventListener("signal",$=>this.dispatchEvent(new CustomEvent("signal",{detail:$.detail}))),this.peerConnection.addEventListener("datachannel",$=>{this.handleDataChannelEvent($)})}handleSignal(o){this.handshake.handleSignal(o).catch($=>{this.log("error handling signal %o %o",o,$)})}}class WebRTCReceiverHandshake extends WebRTCHandshake{constructor(o){super(o),this.options=o,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){log$T.trace("renegotiate"),this.dispatchEvent(new CustomEvent("signal",{detail:{type:"renegotiate"}}))}async handleOffer(o){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(o));for(const j of this.iceCandidates)await this.handleCandidate(j);this.iceCandidates=[];const $=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription($),log$T.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new CustomEvent("signal",{detail:this.peerConnection.localDescription??$}))}async handleCandidate(o){if(this.peerConnection.remoteDescription==null||this.peerConnection.remoteDescription.type==null){this.iceCandidates.push(o);return}await super.handleCandidate(o)}}const normalizeEmitter=_=>{const o=_.on||_.addListener||_.addEventListener,$=_.off||_.removeListener||_.removeEventListener;if(!o||!$)throw new TypeError("Emitter is not compatible");return{addListener:o.bind(_),removeListener:$.bind(_)}};function pEventMultiple(_,o,$){let j;const et=new Promise((tt,rt)=>{if($={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...$},!($.count>=0&&($.count===Number.POSITIVE_INFINITY||Number.isInteger($.count))))throw new TypeError("The `count` option should be at least 0 or more");const nt=[o].flat(),it=[],{addListener:st,removeListener:ot}=normalizeEmitter(_),at=(...ut)=>{const ft=$.multiArgs?ut:ut[0];$.filter&&!$.filter(ft)||(it.push(ft),$.count===it.length&&(j(),tt(it)))},ct=ut=>{j(),rt(ut)};j=()=>{for(const ut of nt)ot(ut,at);for(const ut of $.rejectionEvents)ot(ut,ct)};for(const ut of nt)st(ut,at);for(const ut of $.rejectionEvents)st(ut,ct);$.resolveImmediately&&tt(it)});if(et.cancel=j,typeof $.timeout=="number"){const tt=pTimeout$2(et,$.timeout);return tt.cancel=j,tt}return et}function pEvent(_,o,$){typeof $=="function"&&($={filter:$}),$={...$,count:1,resolveImmediately:!1};const j=pEventMultiple(_,o,$),et=j.then(tt=>tt[0]);return et.cancel=j.cancel,et}const log$S=logger$1("libp2p:webrtc-peer:initator"),ICECOMPLETE_TIMEOUT=1e3;class WebRTCInitiator extends WebRTCPeer{constructor(o={}){super({...o,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(o.dataChannelLabel??toString$a(random_browser(20),"hex").slice(0,7),o.dataChannelInit)}),this.handshake=new WebRTCInitiatorHandshake({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:o.offerOptions}),this.handshake.addEventListener("signal",$=>{this.dispatchEvent(new CustomEvent("signal",{detail:$.detail}))})}handleSignal(o){this.handshake.handleSignal(o).catch($=>{this.log("error handling signal %o %o",o,$)})}}class WebRTCInitiatorHandshake extends WebRTCHandshake{constructor(o){super(o),this.options=o,this.status="idle",this.peerConnection.addEventListener("icecandidate",$=>{if($.candidate==null)return;const j={type:"candidate",candidate:{candidate:$.candidate.candidate,sdpMLineIndex:$.candidate.sdpMLineIndex,sdpMid:$.candidate.sdpMid}};log$S.trace("create candidate",j),this.dispatchEvent(new CustomEvent("signal",{detail:j})),this.dispatchEvent(new CustomEvent("ice-candidate"))})}async handleRenegotiate(){if(this.status==="negotiating"){this.log("already negotiating, queueing");return}this.status="negotiating";const o=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(o),await pEvent(this,"ice-candidate"),await delayExports(ICECOMPLETE_TIMEOUT),log$S.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new CustomEvent("signal",{detail:this.peerConnection.localDescription??o}))}async handleAnswer(o){log$S.trace("handle answer",o),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(o)),this.status="idle"}}const log$R=logger$1("libp2p:webrtc-star:socket");function toMultiaddrConnection(_,o){const{sink:$,source:j}=_,et={remoteAddr:o.remoteAddr,async sink(tt){o.signal!=null&&(tt=abortableSource(tt,o.signal));try{await $(tt)}catch(rt){rt.type!=="aborted"&&log$R.error(rt)}},source:o.signal!=null?abortableSource(j,o.signal):j,timeline:{open:Date.now()},async close(){if(_.closed)return;const tt=Date.now(),rt=setTimeout(()=>{if(et.remoteAddr!=null){const{host:nt,port:it}=et.remoteAddr.toOptions();log$R("timeout closing socket to %s:%s after %dms, destroying it manually",nt,it,Date.now()-tt)}_.closed||_.close().catch(nt=>{log$R.error("could not close socket",nt)})},CLOSE_TIMEOUT$1);try{await _.close()}finally{clearTimeout(rt)}}};return _.addEventListener("close",()=>{et.timeline.close==null&&(et.timeline.close=Date.now())},{once:!0}),et}function cleanUrlSIO(_){const o=_.toString().split("/"),$=_.protos()[1].name,j=_.protos()[2].name,et=_.stringTuples()[1][1];if($!=="tcp"||j!=="ws"&&j!=="wss")throw new Error(`invalid multiaddr: ${_.toString()}`);if(!isName(_))return`http://${o[2]}:${o[4]}`;if(j==="ws")return`http://${o[2]}${et==null||et==="80"?"":`:${et}`}`;if(j==="wss")return`https://${o[2]}${et==null||et==="443"?"":`:${et}`}`;throw new Error("invalid multiaddr: "+_.toString())}function cleanMultiaddr(_){const o="/libp2p-webrtc-star";if(_.startsWith(o)){_=_.substring(o.length,_.length);let $=multiaddr$3(_);const j=$.stringTuples().filter(et=>et[0]===421)[0];if(j[1]==null)throw new Error("invalid multiaddr: "+_);$=$.decapsulate("p2p"),$=$.encapsulate("/p2p-webrtc-star"),$=$.encapsulate(`/p2p/${j[1]}`),_=$.toString()}return _}const log$Q=logger$1("libp2p:webrtc-star:listener"),sioOptions={transports:["websocket"],path:"/socket.io-next/"};class SigServer extends EventEmitter$1{constructor(o,$,j,et,tt){super(),this.signallingAddr=$,this.socket=lookup(o,sioOptions),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=j,this.handler=et,this.channelOptions=tt,this.handleWsHandshake=this.handleWsHandshake.bind(this);let rt=!1;this.socket.on("connect_error",nt=>{rt&&nt.type==="TransportError"||this.dispatchEvent(new CustomEvent("error",{detail:nt}))}),this.socket.on("error",nt=>{this.dispatchEvent(new CustomEvent("error",{detail:nt}))}),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",nt=>{this.dispatchEvent(new CustomEvent("peer",{detail:nt}))}),this.socket.on("connect",()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),rt&&this.dispatchEvent(new CustomEvent("reconnect"))}),this.socket.once("connect",()=>{rt=!0,this.dispatchEvent(new CustomEvent("listening"))}),this.socket.on("disconnect",()=>{this.dispatchEvent(new CustomEvent("disconnect"))})}_createChannel(o,$,j){const et={...this.channelOptions},tt=new WebRTCReceiver(et),rt=nt=>{const it=nt.detail;log$Q.error("incoming connection errored",it)};return tt.addEventListener("error",rt),tt.addEventListener("close",()=>{tt.removeEventListener("error",rt)},{once:!0}),tt.addEventListener("signal",nt=>{const it=nt.detail;this.socket.emit("ss-handshake",{intentId:o,srcMultiaddr:$,dstMultiaddr:j,answer:!0,signal:it})}),tt.addEventListener("ready",()=>{const nt=toMultiaddrConnection(tt,{remoteAddr:this.signallingAddr});log$Q("new inbound connection %s",nt.remoteAddr);try{this.upgrader.upgradeInbound(nt).then(it=>{log$Q("inbound connection %s upgraded",nt.remoteAddr),this.connections.push(nt);const st=()=>{this.connections=this.connections.filter(ot=>ot!==nt),this.channels.delete(o),this.pendingSignals.delete(o)};tt.addEventListener("close",st,{once:!0}),this.dispatchEvent(new CustomEvent("connection",{detail:it})),this.handler(it)}).catch(it=>{log$Q.error("inbound connection failed to upgrade",it),nt.close().catch(st=>{log$Q.error("inbound connection failed to close after failing to upgrade",st)})})}catch(it){log$Q.error("inbound connection failed to upgrade",it),nt.close().catch(st=>{log$Q.error("inbound connection failed to close after failing to upgrade",st)})}},{once:!0}),tt}handleWsHandshake(o){if(log$Q('incoming handshake. signal type "%s" is answer %s',o.signal.type,o.answer),o.answer===!0||o.err!=null||o.intentId==null)return;const $=o.intentId;let j=this.pendingSignals.get($);j==null&&(j=[],this.pendingSignals.set($,j)),j.push(o);let et=this.channels.get($);if(et==null){if(o.signal.type!=="offer"){log$Q("handshake is not an offer and channel does not exist, buffering until we receive an offer");return}log$Q("creating new channel to handle offer handshake"),et=this._createChannel(o.intentId,o.srcMultiaddr,o.dstMultiaddr),this.channels.set($,et)}else log$Q("channel already exists, using it to handle handshake");for(;j.length>0;){const tt=j.shift();(tt==null?void 0:tt.signal)!=null&&et.handleSignal(tt.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map(async o=>await o.close()),...Array.from(this.channels.values()).map(async o=>await o.close())]),this.dispatchEvent(new CustomEvent("close"))}}class WebRTCListener extends EventEmitter$1{constructor(o,$,j,et,tt){super(),this.upgrader=o,this.handler=$,this.peerId=j,this.transport=et,this.options=tt}async listen(o){if(this.listeningAddr!=null)throw errCode(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const $=pDefer$1();this.listeningAddr=o;let j;o.protoCodes().includes(CODE_P2P$1)?j=o:j=o.encapsulate(`/p2p/${this.peerId.toString()}`);const et=this.signallingUrl=cleanUrlSIO(o);log$Q("connecting to signalling server on: %s",this.signallingUrl);const tt=new SigServer(this.signallingUrl,j,this.upgrader,this.handler,this.options.channelOptions);return tt.addEventListener("error",rt=>{const nt=rt.detail;log$Q("error connecting to signalling server %o",nt),tt.close().catch(it=>{log$Q.error("error closing server after error",it)}),$.reject(nt)}),tt.addEventListener("listening",()=>{log$Q("connected to signalling server"),this.dispatchEvent(new CustomEvent("listening")),$.resolve()}),tt.addEventListener("peer",rt=>{this.transport.peerDiscovered(rt.detail)}),tt.addEventListener("connection",rt=>{const nt=rt.detail;if(nt.remoteAddr==null)try{nt.remoteAddr=o.decapsulateCode(CODE_P2P$1).encapsulate(`/p2p/${nt.remotePeer.toString()}`)}catch(it){log$Q.error("could not determine remote address",it)}this.dispatchEvent(new CustomEvent("connection",{detail:nt}))}),tt.addEventListener("disconnect",()=>{this.transport.sigServers.delete(et)}),tt.addEventListener("reconnect",()=>{this.transport.sigServers.set(et,tt)}),this.transport.sigServers.set(this.signallingUrl,tt),await $.promise}async close(){if(this.signallingUrl!=null){const o=this.transport.sigServers.get(this.signallingUrl);o!=null&&(await o.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new CustomEvent("close")),this.listeningAddr=void 0}getAddrs(){return this.listeningAddr!=null?[this.listeningAddr]:[]}}function createListener$2(_,o,$,j,et){return new WebRTCListener(_,o,$,j,et)}const symbol$3=Symbol.for("@libp2p/transport");var FaultTolerance;(function(_){_[_.FATAL_ALL=0]="FATAL_ALL",_[_.NO_FATAL=1]="NO_FATAL"})(FaultTolerance||(FaultTolerance={}));const symbol$2=Symbol.for("@libp2p/peer-discovery"),webrtcSupport="RTCPeerConnection"in globalThis,log$P=logger$1("libp2p:webrtc-star"),noop$2=()=>{};class WebRTCStarDiscovery extends EventEmitter$1{constructor(){super(...arguments),this.started=!1}get[symbol$2](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(o){return this.isStarted()?super.dispatchEvent(o):!1}}class WebRTCStar{constructor(o){(o==null?void 0:o.wrtc)!=null&&(this.wrtc=o.wrtc),this.sigServers=new Map,this._discovery=new WebRTCStarDiscovery,this.discovery=()=>this._discovery,this.peerDiscovered=this.peerDiscovered.bind(this)}get[symbol$3](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}async dial(o,$){const j=await this._connect(o,$),et=toMultiaddrConnection(j,{remoteAddr:o,signal:$.signal});log$P("new outbound connection %s",et.remoteAddr);const tt=await $.upgrader.upgradeOutbound(et);return log$P("outbound connection %s upgraded",et.remoteAddr),tt}async _connect(o,$){var rt;if(((rt=$.signal)==null?void 0:rt.aborted)===!0)throw new AbortError$1;const j={...$.channelOptions??{}};this.wrtc!=null&&(j.wrtc=this.wrtc);const et=o.toOptions(),tt=toString$a(random_browser(36),"hex");return await new Promise((nt,it)=>{var mt;const st=this.sigServers.get(cleanUrlSIO(o));if((st==null?void 0:st.socket)==null)return it(errCode(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let ot=!1;log$P("dialing %s:%s",et.host,et.port);const at=new WebRTCInitiator(j),ct=gt=>{const Et=gt.detail;if(!ot){const St=`connection error ${et.host}:${et.port}: ${Et.message}`;log$P.error(St),ht(Et)}},ut=()=>{ot=!0,log$P("connection opened %s:%s",et.host,et.port),ht()},ft=()=>{log$P.error("connection aborted %s:%s",et.host,et.port),at.close().finally(()=>{ht(new AbortError$1)})},ht=gt=>{var Et;at.removeEventListener("ready",ut),(Et=$.signal)==null||Et.removeEventListener("abort",ft),gt==null?nt(at):it(gt)};at.addEventListener("ready",ut,{once:!0}),at.addEventListener("close",()=>{at.removeEventListener("error",ct)}),(mt=$.signal)==null||mt.addEventListener("abort",ft),at.addEventListener("signal",gt=>{const Et=gt.detail;st.socket.emit("ss-handshake",{intentId:tt,srcMultiaddr:st.signallingAddr.toString(),dstMultiaddr:o.toString(),signal:Et})}),st.socket.on("ws-handshake",gt=>{gt.intentId===tt&&gt.err!=null&&at.close().finally(()=>{it(errCode(new Error(gt.err),"ERR_SIGNALLING_FAILED"))}),!(gt.intentId!==tt||gt.answer==null||at.closed)&&at.handleSignal(gt.signal)})})}createListener(o){if(!webrtcSupport&&this.wrtc==null)throw errCode(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");if(o.channelOptions=o.channelOptions??{},this.wrtc!=null&&(o.channelOptions.wrtc=this.wrtc),this.peerId==null)throw errCode(new Error("PeerId not set"),"ERR_MISSING_PEER_ID");return createListener$2(o.upgrader,o.handler??noop$2,this.peerId,this,o)}filter(o){return o=Array.isArray(o)?o:[o],o.filter($=>$.protoCodes().includes(CODE_CIRCUIT$1)?!1:WebRTCStar$1.matches($))}peerDiscovered(o){log$P("peer discovered: %s",o),o=cleanMultiaddr(o);const $=multiaddr$3(o),j=$.getPeerId();if(j==null)return;const et=peerIdFromString(j);this._discovery.dispatchEvent(new CustomEvent("peer",{detail:{id:et,multiaddrs:[$],protocols:[]}}))}}function webRTCStar(_={}){const o=new WebRTCStar(_);return{transport:$=>(o.peerId=$.peerId,o),discovery:o.discovery}}function libp2pConfig(){const _=webRTCStar();return{transports:[_.transport],peerDiscovery:[_.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1}}}function isStartable(_){return _!=null&&typeof _.start=="function"&&typeof _.stop=="function"}var messages;(function(_){_.NOT_STARTED_YET="The libp2p node is not started yet",_.DHT_DISABLED="DHT is not available",_.PUBSUB_DISABLED="PubSub is not available",_.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",_.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",_.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",_.NOT_FOUND="Not found"})(messages||(messages={}));var codes$2;(function(_){_.DHT_DISABLED="ERR_DHT_DISABLED",_.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",_.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",_.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",_.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",_.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",_.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",_.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",_.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",_.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",_.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",_.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",_.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",_.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",_.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",_.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",_.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",_.ERR_DIALED_SELF="ERR_DIALED_SELF",_.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",_.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",_.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",_.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",_.ERR_INVALID_KEY="ERR_INVALID_KEY",_.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",_.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",_.ERR_INVALID_PEER="ERR_INVALID_PEER",_.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",_.ERR_NOT_FOUND="ERR_NOT_FOUND",_.ERR_TIMEOUT="ERR_TIMEOUT",_.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",_.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",_.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",_.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",_.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",_.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",_.ERR_FIND_SELF="ERR_FIND_SELF",_.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",_.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",_.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",_.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",_.ERR_INVALID_CMS="ERR_INVALID_CMS",_.ERR_MISSING_KEYS="ERR_MISSING_KEYS",_.ERR_NO_KEY="ERR_NO_KEY",_.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",_.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",_.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",_.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",_.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",_.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",_.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",_.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",_.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",_.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",_.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",_.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",_.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",_.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",_.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",_.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",_.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",_.ERR_INVALID_RECORD="ERR_INVALID_RECORD",_.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",_.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",_.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",_.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",_.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED"})(codes$2||(codes$2={}));async function*storeAddresses(_,o){yield*map$3(_,async $=>(await o.addressBook.add($.id,$.multiaddrs),$))}function uniquePeers(_){const o=new Set;return filter$1(_,$=>o.has($.id.toString())?!1:(o.add($.id.toString()),!0))}async function*requirePeers(_,o=1){let $=0;for await(const j of _)$++,yield j;if($<o)throw errCode(new Error("not found"),"NOT_FOUND")}const intervals=new Map,_generateId=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function _runPeriodically(_,o,$){for(;intervals.get($);){try{await _()}catch(j){setTimeout(()=>{throw j},1);break}if(!intervals.get($))break;await new Promise(j=>{const et=setTimeout(j,o);intervals.set($,et)})}}function setDelayedInterval(_,o,$){$=$||o;const j=_generateId(),et=setTimeout(()=>{_runPeriodically(_,o,j)},$);return intervals.set(j,et),j}function clearDelayedInterval(_){const o=intervals.get(_);o&&(clearTimeout(o),intervals.delete(_))}var src$1={setDelayedInterval,clearDelayedInterval};const log$O=logger$1("libp2p:peer-routing");class DefaultPeerRouting{constructor(o,$){this.components=o,this.routers=$.routers??[],this.refreshManagerInit=$.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||this.routers.length===0||this.timeoutId!=null||this.refreshManagerInit.enabled===!1||(this.timeoutId=src$1.setDelayedInterval(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){var o,$;if(this.abortController==null)try{this.abortController=new timeoutAbortController.TimeoutController(this.refreshManagerInit.timeout??1e4);try{(o=eventsExports.setMaxListeners)==null||o.call(eventsExports,1/0,this.abortController.signal)}catch{}await drain(this.getClosestPeers(this.components.peerId.toBytes(),{signal:this.abortController.signal}))}catch(j){log$O.error(j)}finally{($=this.abortController)==null||$.clear(),this.abortController=void 0}}async stop(){var o;src$1.clearDelayedInterval(this.timeoutId),(o=this.abortController)==null||o.abort(),this.started=!1}async findPeer(o,$){if(this.routers.length===0)throw errCode(new Error("No peer routers available"),codes$2.ERR_NO_ROUTERS_AVAILABLE);if(o.toString()===this.components.peerId.toString())throw errCode(new Error("Should not try to find self"),codes$2.ERR_FIND_SELF);const j=await pipe(merge$1(...this.routers.map(et=>async function*(){try{yield await et.findPeer(o,$)}catch(tt){log$O.error(tt)}}())),et=>filter$1(et,Boolean),et=>storeAddresses(et,this.components.peerStore),async et=>await first(et));if(j!=null)return j;throw errCode(new Error(messages.NOT_FOUND),codes$2.ERR_NOT_FOUND)}async*getClosestPeers(o,$){if(this.routers.length===0)throw errCode(new Error("No peer routers available"),codes$2.ERR_NO_ROUTERS_AVAILABLE);yield*pipe(merge$1(...this.routers.map(j=>j.getClosestPeers(o,$))),j=>storeAddresses(j,this.components.peerStore),j=>uniquePeers(j),j=>requirePeers(j))}}class CompoundContentRouting{constructor(o,$){this.routers=$.routers??[],this.started=!1,this.components=o}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(o,$={}){if(this.routers.length===0)throw errCode(new Error("No content this.routers available"),codes$2.ERR_NO_ROUTERS_AVAILABLE);yield*pipe(merge$1(...this.routers.map(j=>j.findProviders(o,$))),j=>storeAddresses(j,this.components.peerStore),j=>uniquePeers(j),j=>requirePeers(j))}async provide(o,$={}){if(this.routers.length===0)throw errCode(new Error("No content routers available"),codes$2.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(async j=>await j.provide(o,$)))}async put(o,$,j){if(!this.isStarted())throw errCode(new Error(messages.NOT_STARTED_YET),codes$2.DHT_NOT_STARTED);const et=this.components.dht;et!=null&&await drain(et.put(o,$,j))}async get(o,$){if(!this.isStarted())throw errCode(new Error(messages.NOT_STARTED_YET),codes$2.DHT_NOT_STARTED);const j=this.components.dht;if(j!=null){for await(const et of j.get(o,$))if(et.name==="VALUE")return et.value}throw errCode(new Error(messages.NOT_FOUND),codes$2.ERR_NOT_FOUND)}async*getMany(o,$,j){if(!this.isStarted())throw errCode(new Error(messages.NOT_STARTED_YET),codes$2.DHT_NOT_STARTED);if($==null||$===0)return;let et=0;const tt=this.components.dht;if(tt!=null){for await(const rt of tt.get(o,j))if(rt.name==="VALUE"&&(yield{from:rt.from,val:rt.value},et++,et===$))break}if(et===0)throw errCode(new Error(messages.NOT_FOUND),codes$2.ERR_NOT_FOUND)}}const defaultAddressFilter=_=>_;class DefaultAddressManager extends EventEmitter$1{constructor(o,$){super();const{listen:j=[],announce:et=[]}=$;this.components=o,this.listen=j.map(tt=>tt.toString()),this.announce=new Set(et.map(tt=>tt.toString())),this.observed=new Set,this.announceFilter=$.announceFilter??defaultAddressFilter}getListenAddrs(){return Array.from(this.listen).map(o=>multiaddr$3(o))}getAnnounceAddrs(){return Array.from(this.announce).map(o=>multiaddr$3(o))}getObservedAddrs(){return Array.from(this.observed).map(o=>multiaddr$3(o))}confirmObservedAddr(o){}removeObservedAddr(o){}addObservedAddr(o){let $=multiaddr$3(o);const j=$.getPeerId();j!=null&&peerIdFromString(j).equals(this.components.peerId)&&($=$.decapsulate(multiaddr$3(`/p2p/${this.components.peerId.toString()}`)));const et=$.toString();this.observed.has(et)||(this.observed.add(et),this.dispatchEvent(new CustomEvent("change:addresses")))}getAddresses(){let o=this.getAnnounceAddrs().map(j=>j.toString());o.length===0&&(o=this.components.transportManager.getAddrs().map(j=>j.toString())),o=o.concat(this.getObservedAddrs().map(j=>j.toString()));const $=new Set(o);return this.announceFilter(Array.from($).map(j=>multiaddr$3(j))).map(j=>{var et;return((et=j.protos().pop())==null?void 0:et.path)===!0||j.getPeerId()===this.components.peerId.toString()?j:j.encapsulate(`/p2p/${this.components.peerId.toString()}`)})}}const log$N=logger$1("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class VisibilityChangeEmitter extends EventEmitter$1{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",globalThis.document!=null&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let o="hidden",$="visibilitychange";typeof globalThis.document.hidden<"u"?(o="hidden",$="visibilitychange"):typeof globalThis.document.mozHidden<"u"?(o="mozHidden",$="mozvisibilitychange"):typeof globalThis.document.msHidden<"u"?(o="msHidden",$="msvisibilitychange"):typeof globalThis.document.webkitHidden<"u"&&(o="webkitHidden",$="webkitvisibilitychange"),this.hidden=o,this.visibilityChange=$}_addVisibilityChangeListener(){typeof globalThis.document.addEventListener>"u"||typeof document[this.hidden]>"u"?log$N("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this.hidden===void 0||document[this.hidden]===void 0))return document[this.hidden]==null}_handleVisibilityChange(){const o=globalThis.document[this.hidden]===!1;log$N(o?"Page Visible":"Page Hidden"),this.dispatchEvent(new CustomEvent("visibilityChange",{detail:o}))}}const log$M=logger$1("libp2p:connection-manager:latency-monitor");class LatencyMonitor extends EventEmitter$1{constructor(o={}){var rt,nt;super();const{latencyCheckIntervalMs:$,dataEmitIntervalMs:j,asyncTestFn:et,latencyRandomPercentage:tt}=o;this.latencyCheckIntervalMs=$??500,this.latencyRandomPercentage=tt??10,this.latencyCheckMultiply=2*(this.latencyRandomPercentage/100)*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=j===null||j===0?void 0:j??5*1e3,log$M("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),this.dataEmitIntervalMs!=null?log$M("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):log$M("Not emitting summaries"),this.asyncTestFn=et,((rt=globalThis.process)==null?void 0:rt.hrtime)!=null?(log$M("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=it=>{const st=this.now(it);return st[0]*1e3+st[1]/1e6}):typeof window<"u"&&((nt=window.performance)==null?void 0:nt.now)!=null?(log$M("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=it=>Math.round(this.now()-it)):(log$M("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=it=>this.now()-it),this.latencyData=this.initLatencyData()}start(){var o;isBrowser()&&(this.visibilityChangeEmitter=new VisibilityChangeEmitter,this.visibilityChangeEmitter.addEventListener("visibilityChange",$=>{const{detail:j}=$;j?this._startTimers():(this._emitSummary(),this._stopTimers())})),((o=this.visibilityChangeEmitter)==null?void 0:o.isVisible())===!0&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this.checkLatencyID==null&&(this.checkLatency(),this.dataEmitIntervalMs!=null&&(this.emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this.emitIntervalID.unref=="function"&&this.emitIntervalID.unref()))}_stopTimers(){this.checkLatencyID!=null&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),this.emitIntervalID!=null&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){const o=this.getSummary();o.events>0&&this.dispatchEvent(new CustomEvent("data",{detail:o}))}getSummary(){const o={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),log$M.trace("Summary: %O",o),o}checkLatency(){const o=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,$={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+o),startTime:this.now()},j=()=>{if(this.checkLatencyID==null)return;const et=this.getDeltaMS($.startTime)-$.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,et),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,et),this.latencyData.totalMs+=et,log$M.trace("MS: %s Data: %O",et,this.latencyData)};log$M.trace("localData: %O",$),this.checkLatencyID=setTimeout(()=>{this.asyncTestFn!=null?($.deltaOffset=0,$.startTime=this.now(),this.asyncTestFn(j)):($.deltaOffset-=1,j())},$.deltaOffset),typeof this.checkLatencyID.unref=="function"&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}function isBrowser(){return typeof globalThis.window<"u"}const OPEN="OPEN",CLOSING="CLOSING",CLOSED="CLOSED";function mapIterable(_,o){const $={[Symbol.iterator]:()=>$,next:()=>{const j=_.next(),et=j.value;return j.done===!0||et==null?{done:!0,value:void 0}:{done:!1,value:o(et)}}};return $}class PeerMap{constructor(o){if(this.map=new Map,o!=null)for(const[$,j]of o.entries())this.map.set($.toString(),j)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(o){this.map.delete(o.toString())}entries(){return mapIterable(this.map.entries(),o=>[peerIdFromString(o[0]),o[1]])}forEach(o){this.map.forEach(($,j)=>{o($,peerIdFromString(j),this)})}get(o){return this.map.get(o.toString())}has(o){return this.map.has(o.toString())}set(o,$){this.map.set(o.toString(),$)}keys(){return mapIterable(this.map.keys(),o=>peerIdFromString(o))}values(){return this.map.values()}get size(){return this.map.size}}class PeerSet{constructor(o){if(this.set=new Set,o!=null)for(const $ of o)this.set.add($.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(o){this.set.add(o.toString())}clear(){this.set.clear()}delete(o){this.set.delete(o.toString())}entries(){return mapIterable(this.set.entries(),o=>{const $=peerIdFromString(o[0]);return[$,$]})}forEach(o){this.set.forEach($=>{const j=peerIdFromString($);o(j,j,this)})}has(o){return this.set.has(o.toString())}values(){return mapIterable(this.set.values(),o=>peerIdFromString(o))}intersection(o){const $=new PeerSet;for(const j of o)this.has(j)&&$.add(j);return $}difference(o){const $=new PeerSet;for(const j of this)o.has(j)||$.add(j);return $}union(o){const $=new PeerSet;for(const j of o)$.add(j);for(const j of this)$.add(j);return $}}const KEEP_ALIVE="keep-alive";var RateLimiterAbstract_1=class{constructor(o={}){this.points=o.points,this.duration=o.duration,this.blockDuration=o.blockDuration,this.execEvenly=o.execEvenly,this.execEvenlyMinDelayMs=o.execEvenlyMinDelayMs,this.keyPrefix=o.keyPrefix}get points(){return this._points}set points(o){this._points=o>=0?o:4}get duration(){return this._duration}set duration(o){this._duration=typeof o>"u"?1:o}get msDuration(){return this.duration*1e3}get blockDuration(){return this._blockDuration}set blockDuration(o){this._blockDuration=typeof o>"u"?0:o}get msBlockDuration(){return this.blockDuration*1e3}get execEvenly(){return this._execEvenly}set execEvenly(o){this._execEvenly=typeof o>"u"?!1:!!o}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(o){this._execEvenlyMinDelayMs=typeof o>"u"?Math.ceil(this.msDuration/this.points):o}get keyPrefix(){return this._keyPrefix}set keyPrefix(o){if(typeof o>"u"&&(o="rlflx"),typeof o!="string")throw new Error("keyPrefix must be string");this._keyPrefix=o}_getKeySecDuration(o={}){return o&&o.customDuration>=0?o.customDuration:this.duration}getKey(o){return this.keyPrefix.length>0?`${this.keyPrefix}:${o}`:o}parseKey(o){return o.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}},BlockedKeys_1$1=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const o=Date.now();Object.keys(this._keys).forEach($=>{this._keys[$]<=o&&delete this._keys[$]}),this._addedKeysAmount=Object.keys(this._keys).length}add(o,$){this.addMs(o,$*1e3)}addMs(o,$){this._keys[o]=Date.now()+$,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(o){const $=this._keys[o];if($&&$>=Date.now()){this.collectExpired();const j=Date.now();return $>=j?$-j:0}return 0}delete(o){o?delete this._keys[o]:Object.keys(this._keys).forEach($=>{delete this._keys[$]})}};const BlockedKeys$1=BlockedKeys_1$1;var BlockedKeys_1=BlockedKeys$1,RateLimiterRes_1=class{constructor(o,$,j,et){this.remainingPoints=typeof o>"u"?0:o,this.msBeforeNext=typeof $>"u"?0:$,this.consumedPoints=typeof j>"u"?0:j,this.isFirstInDuration=typeof et>"u"?!1:et}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(o){return this._msBeforeNext=o,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(o){return this._remainingPoints=o,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(o){return this._consumedPoints=o,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(o){this._isFirstInDuration=!!o}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}};const RateLimiterAbstract$3=RateLimiterAbstract_1,BlockedKeys=BlockedKeys_1,RateLimiterRes$b=RateLimiterRes_1;var RateLimiterStoreAbstract_1=class extends RateLimiterAbstract$3{constructor(o={}){super(o),this.inMemoryBlockOnConsumed=o.inMemoryBlockOnConsumed||o.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=o.inMemoryBlockDuration||o.inmemoryBlockDuration,this.insuranceLimiter=o.insuranceLimiter,this._inMemoryBlockedKeys=new BlockedKeys}get client(){return this._client}set client(o){if(typeof o>"u")throw new Error("storeClient is not set");this._client=o}_afterConsume(o,$,j,et,tt,rt={}){const nt=this._getRateLimiterRes(j,et,tt);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&nt.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(j,nt.msBeforeNext),nt.consumedPoints>this.points?$(nt):o(nt);if(nt.consumedPoints>this.points){let it=Promise.resolve();this.blockDuration>0&&nt.consumedPoints<=this.points+et&&(nt.msBeforeNext=this.msBlockDuration,it=this._block(j,nt.consumedPoints,this.msBlockDuration,rt)),this.inMemoryBlockOnConsumed>0&&nt.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(j,this.inMemoryBlockDuration),nt.msBeforeNext=this.msInMemoryBlockDuration),it.then(()=>{$(nt)}).catch(st=>{$(st)})}else if(this.execEvenly&&nt.msBeforeNext>0&&!nt.isFirstInDuration){let it=Math.ceil(nt.msBeforeNext/(nt.remainingPoints+2));it<this.execEvenlyMinDelayMs&&(it=nt.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(o,it,nt)}else o(nt)}_handleError(o,$,j,et,tt,rt=!1,nt={}){this.insuranceLimiter instanceof RateLimiterAbstract$3?this.insuranceLimiter[$](tt,rt,nt).then(it=>{j(it)}).catch(it=>{et(it)}):et(o)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(o){return this.getInMemoryBlockMsBeforeExpire(o)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(o){this.inMemoryBlockOnConsumed=o}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(o){this.inMemoryBlockDuration=o}get msInmemoryBlockDuration(){return this.inMemoryBlockDuration*1e3}getInMemoryBlockMsBeforeExpire(o){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(o):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(o){if(this._inMemoryBlockOnConsumed=o?parseInt(o):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(o){if(this._inMemoryBlockDuration=o?parseInt(o):0,this.inMemoryBlockDuration>0&&this.inMemoryBlockOnConsumed===0)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return this._inMemoryBlockDuration*1e3}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(o){if(typeof o<"u"&&!(o instanceof RateLimiterAbstract$3))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=o,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(o,$,j={}){const et=$*1e3;return this._block(this.getKey(o),this.points+1,et,j)}set(o,$,j,et={}){const tt=(j>=0?j:this.duration)*1e3;return this._block(this.getKey(o),$,tt,et)}consume(o,$=1,j={}){return new Promise((et,tt)=>{const rt=this.getKey(o),nt=this.getInMemoryBlockMsBeforeExpire(rt);if(nt>0)return tt(new RateLimiterRes$b(0,nt));this._upsert(rt,$,this._getKeySecDuration(j)*1e3,!1,j).then(it=>{this._afterConsume(et,tt,rt,$,it)}).catch(it=>{this._handleError(it,"consume",et,tt,o,$,j)})})}penalty(o,$=1,j={}){const et=this.getKey(o);return new Promise((tt,rt)=>{this._upsert(et,$,this._getKeySecDuration(j)*1e3,!1,j).then(nt=>{tt(this._getRateLimiterRes(et,$,nt))}).catch(nt=>{this._handleError(nt,"penalty",tt,rt,o,$,j)})})}reward(o,$=1,j={}){const et=this.getKey(o);return new Promise((tt,rt)=>{this._upsert(et,-$,this._getKeySecDuration(j)*1e3,!1,j).then(nt=>{tt(this._getRateLimiterRes(et,-$,nt))}).catch(nt=>{this._handleError(nt,"reward",tt,rt,o,$,j)})})}get(o,$={}){const j=this.getKey(o);return new Promise((et,tt)=>{this._get(j,$).then(rt=>{et(rt===null||typeof rt>"u"?null:this._getRateLimiterRes(j,0,rt))}).catch(rt=>{this._handleError(rt,"get",et,tt,o,$)})})}delete(o,$={}){const j=this.getKey(o);return new Promise((et,tt)=>{this._delete(j,$).then(rt=>{this._inMemoryBlockedKeys.delete(j),et(rt)}).catch(rt=>{this._handleError(rt,"delete",et,tt,o,$)})})}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(o,$,j){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(o,$,j,et={}){return new Promise((tt,rt)=>{this._upsert(o,$,j,!0,et).then(()=>{tt(new RateLimiterRes$b(0,j>0?j:-1,$))}).catch(nt=>{this._handleError(nt,"block",tt,rt,this.parseKey(o),j/1e3,et)})})}_get(o,$={}){throw new Error("You have to implement the method '_get'!")}_delete(o,$={}){throw new Error("You have to implement the method '_delete'!")}_upsert(o,$,j,et=!1,tt={}){throw new Error("You have to implement the method '_upsert'!")}};const RateLimiterStoreAbstract$4=RateLimiterStoreAbstract_1,RateLimiterRes$a=RateLimiterRes_1,incrTtlLuaScript="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";let RateLimiterRedis$1=class extends RateLimiterStoreAbstract$4{constructor(o){super(o),o.redis?this.client=o.redis:this.client=o.storeClient,this._rejectIfRedisNotReady=!!o.rejectIfRedisNotReady,typeof this.client.defineCommand=="function"&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:incrTtlLuaScript})}_isRedisReady(){return this._rejectIfRedisNotReady?!(this.client.status&&this.client.status!=="ready"||typeof this.client.isReady=="function"&&!this.client.isReady()):!0}_getRateLimiterRes(o,$,j){let[et,tt]=j;Array.isArray(et)&&([,et]=et,[,tt]=tt);const rt=new RateLimiterRes$a;return rt.consumedPoints=parseInt(et),rt.isFirstInDuration=rt.consumedPoints===$,rt.remainingPoints=Math.max(this.points-rt.consumedPoints,0),rt.msBeforeNext=tt,rt}_upsert(o,$,j,et=!1){return new Promise((tt,rt)=>{if(!this._isRedisReady())return rt(new Error("Redis connection is not ready"));const nt=Math.floor(j/1e3),it=this.client.multi();if(et)nt>0?it.set(o,$,"EX",nt):it.set(o,$),it.pttl(o).exec((st,ot)=>st?rt(st):tt(ot));else if(nt>0){const st=function(ot,at){return ot?rt(ot):tt(at)};typeof this.client.rlflxIncr=="function"?this.client.rlflxIncr(o,$,nt,st):this.client.eval(incrTtlLuaScript,1,o,$,nt,st)}else it.incrby(o,$).pttl(o).exec((st,ot)=>st?rt(st):tt(ot))})}_get(o){return new Promise(($,j)=>{if(!this._isRedisReady())return j(new Error("Redis connection is not ready"));this.client.multi().get(o).pttl(o).exec((et,tt)=>{if(et)j(et);else{const[rt]=tt;if(rt===null)return $(null);$(tt)}})})}_delete(o){return new Promise(($,j)=>{this.client.del(o,(et,tt)=>{et?j(et):$(tt>0)})})}};var RateLimiterRedis_1=RateLimiterRedis$1;const RateLimiterStoreAbstract$3=RateLimiterStoreAbstract_1,RateLimiterRes$9=RateLimiterRes_1;function getDriverVersion(_){try{const o=_.client?_.client:_,{version:$}=o.topology.s.options.metadata.driver,j=$.split(".").map(et=>parseInt(et));return{major:j[0],feature:j[1],patch:j[2]}}catch{return{major:0,feature:0,patch:0}}}let RateLimiterMongo$1=class Bo extends RateLimiterStoreAbstract$3{constructor(o){super(o),this.dbName=o.dbName,this.tableName=o.tableName,this.indexKeyPrefix=o.indexKeyPrefix,o.mongo?this.client=o.mongo:this.client=o.storeClient,typeof this.client.then=="function"?this.client.then($=>{this.client=$,this._initCollection(),this._driverVersion=getDriverVersion(this.client)}):(this._initCollection(),this._driverVersion=getDriverVersion(this.client))}get dbName(){return this._dbName}set dbName(o){this._dbName=typeof o>"u"?Bo.getDbName():o}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(o){this._tableName=typeof o>"u"?this.keyPrefix:o}get client(){return this._client}set client(o){if(typeof o>"u")throw new Error("mongo is not set");this._client=o}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(o){this._indexKeyPrefix=o||{}}_initCollection(){const $=(typeof this.client.db=="function"?this.client.db(this.dbName):this.client).collection(this.tableName);$.createIndex({expire:-1},{expireAfterSeconds:0}),$.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=$}_getRateLimiterRes(o,$,j){const et=new RateLimiterRes$9;let tt;return typeof j.value>"u"?tt=j:tt=j.value,et.isFirstInDuration=tt.points===$,et.consumedPoints=tt.points,et.remainingPoints=Math.max(this.points-et.consumedPoints,0),et.msBeforeNext=tt.expire!==null?Math.max(new Date(tt.expire).getTime()-Date.now(),0):-1,et}_upsert(o,$,j,et=!1,tt={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const rt=tt.attrs||{};let nt,it;et?(nt={key:o},nt=Object.assign(nt,rt),it={$set:{key:o,points:$,expire:j>0?new Date(Date.now()+j):null}},it.$set=Object.assign(it.$set,rt)):(nt={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:o},nt=Object.assign(nt,rt),it={$setOnInsert:{key:o,expire:j>0?new Date(Date.now()+j):null},$inc:{points:$}},it.$setOnInsert=Object.assign(it.$setOnInsert,rt));const st={upsert:!0};return this._driverVersion.major>=4||this._driverVersion.major===3&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?st.returnDocument="after":st.returnOriginal=!1,new Promise((ot,at)=>{this._collection.findOneAndUpdate(nt,it,st).then(ct=>{ot(ct)}).catch(ct=>{if(ct&&ct.code===11e3){const ut=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:o},rt),ft={$set:Object.assign({key:o,points:$,expire:j>0?new Date(Date.now()+j):null},rt)};this._collection.findOneAndUpdate(ut,ft,st).then(ht=>{ot(ht)}).catch(ht=>{ht&&ht.code===11e3?this._upsert(o,$,j,et).then(mt=>ot(mt)).catch(mt=>at(mt)):at(ht)})}else at(ct)})})}_get(o,$={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const j=$.attrs||{},et=Object.assign({key:o,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},j);return this._collection.findOne(et)}_delete(o,$={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const j=$.attrs||{},et=Object.assign({key:o},j);return this._collection.deleteOne(et).then(tt=>tt.deletedCount>0)}};var RateLimiterMongo_1=RateLimiterMongo$1;const RateLimiterStoreAbstract$2=RateLimiterStoreAbstract_1,RateLimiterRes$8=RateLimiterRes_1;let RateLimiterMySQL$1=class extends RateLimiterStoreAbstract$2{constructor(o,$=null){super(o),this.client=o.storeClient,this.clientType=o.storeType,this.dbName=o.dbName,this.tableName=o.tableName,this.clearExpiredByTimeout=o.clearExpiredByTimeout,this.tableCreated=o.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof $=="function"&&$()):this._createDbAndTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof $=="function"&&$()}).catch(j=>{if(typeof $=="function")$(j);else throw j})}clearExpired(o){return new Promise($=>{this._getConnection().then(j=>{j.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,o],()=>{this._releaseConnection(j),$()})}).catch(()=>{$()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise((o,$)=>{this.client.getConnection((j,et)=>{if(j)return $(j);o(et)})});case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(o){switch(this.clientType){case"pool":return o.release();case"sequelize":return this.client.connectionManager.releaseConnection(o);case"knex":return this.client.client.releaseConnection(o);default:return!0}}_createDbAndTable(){return new Promise((o,$)=>{this._getConnection().then(j=>{j.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,et=>{if(et)return this._releaseConnection(j),$(et);j.query(this._getCreateTableStmt(),tt=>{if(tt)return this._releaseConnection(j),$(tt);this._releaseConnection(j),o()})})}).catch(j=>{$(j)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(o){if(typeof o>"u")if(this.client.constructor.name==="Connection")o="connection";else if(this.client.constructor.name==="Pool")o="pool";else if(this.client.constructor.name==="Sequelize")o="sequelize";else throw new Error("storeType is not defined");this._clientType=o.toLowerCase()}get dbName(){return this._dbName}set dbName(o){this._dbName=typeof o>"u"?"rtlmtrflx":o}get tableName(){return this._tableName}set tableName(o){this._tableName=typeof o>"u"?this.keyPrefix:o}get tableCreated(){return this._tableCreated}set tableCreated(o){this._tableCreated=typeof o>"u"?!1:!!o}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(o){this._clearExpiredByTimeout=typeof o>"u"?!0:!!o}_getRateLimiterRes(o,$,j){const et=new RateLimiterRes$8,[tt]=j;return et.isFirstInDuration=$===tt.points,et.consumedPoints=et.isFirstInDuration?$:tt.points,et.remainingPoints=Math.max(this.points-et.consumedPoints,0),et.msBeforeNext=tt.expire?Math.max(tt.expire-Date.now(),0):-1,et}_upsertTransaction(o,$,j,et,tt){return new Promise((rt,nt)=>{o.query("BEGIN",it=>{if(it)return o.rollback(),nt(it);const st=Date.now(),ot=et>0?st+et:null;let at,ct;tt?(at=`INSERT INTO ??.?? VALUES (?, ?, ?)
          ON DUPLICATE KEY UPDATE 
            points = ?, 
            expire = ?;`,ct=[this.dbName,this.tableName,$,j,ot,j,ot]):(at=`INSERT INTO ??.?? VALUES (?, ?, ?)
          ON DUPLICATE KEY UPDATE 
            points = IF(expire <= ?, ?, points + (?)), 
            expire = IF(expire <= ?, ?, expire);`,ct=[this.dbName,this.tableName,$,j,ot,st,j,j,st,ot]),o.query(at,ct,ut=>{if(ut)return o.rollback(),nt(ut);o.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,$],(ft,ht)=>{if(ft)return o.rollback(),nt(ft);o.query("COMMIT",mt=>{if(mt)return o.rollback(),nt(mt);rt(ht)})})})})})}_upsert(o,$,j,et=!1){return this.tableCreated?new Promise((tt,rt)=>{this._getConnection().then(nt=>{this._upsertTransaction(nt,o,$,j,et).then(it=>{tt(it),this._releaseConnection(nt)}).catch(it=>{rt(it),this._releaseConnection(nt)})}).catch(nt=>{rt(nt)})}):Promise.reject(Error("Table is not created yet"))}_get(o){return this.tableCreated?new Promise(($,j)=>{this._getConnection().then(et=>{et.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,o,Date.now()],(tt,rt)=>{tt?j(tt):rt.length===0?$(null):$(rt),this._releaseConnection(et)})}).catch(et=>{j(et)})}):Promise.reject(Error("Table is not created yet"))}_delete(o){return this.tableCreated?new Promise(($,j)=>{this._getConnection().then(et=>{et.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,o],(tt,rt)=>{tt?j(tt):$(rt.affectedRows>0),this._releaseConnection(et)})}).catch(et=>{j(et)})}):Promise.reject(Error("Table is not created yet"))}};var RateLimiterMySQL_1=RateLimiterMySQL$1;const RateLimiterStoreAbstract$1=RateLimiterStoreAbstract_1,RateLimiterRes$7=RateLimiterRes_1;let RateLimiterPostgres$1=class extends RateLimiterStoreAbstract$1{constructor(o,$=null){super(o),this.client=o.storeClient,this.clientType=o.storeType,this.tableName=o.tableName,this.clearExpiredByTimeout=o.clearExpiredByTimeout,this.tableCreated=o.tableCreated,this.tableCreated?typeof $=="function"&&$():this._createTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof $=="function"&&$()}).catch(j=>{if(typeof $=="function")$(j);else throw j})}clearExpired(o){return new Promise($=>{const j={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[o]};this._query(j).then(()=>{$()}).catch(()=>{$()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master);default:return Promise.resolve(this.client)}}_releaseConnection(o){switch(this.clientType){case"pool":return!0;case"sequelize":return this.client.connectionManager.releaseConnection(o);case"knex":return this.client.client.releaseConnection(o);case"typeorm":return!0;default:return!0}}_createTable(){return new Promise((o,$)=>{this._query({text:this._getCreateTableStmt()}).then(()=>{o()}).catch(j=>{j.code==="23505"?o():$(j)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( 
      key varchar(255) PRIMARY KEY,
      points integer NOT NULL DEFAULT 0,
      expire bigint
    );`}get clientType(){return this._clientType}set clientType(o){const $=this.client.constructor.name;if(typeof o>"u")if($==="Client")o="client";else if($==="Pool"||$==="BoundPool")o="pool";else if($==="Sequelize")o="sequelize";else throw new Error("storeType is not defined");this._clientType=o.toLowerCase()}get tableName(){return this._tableName}set tableName(o){this._tableName=typeof o>"u"?this.keyPrefix:o}get tableCreated(){return this._tableCreated}set tableCreated(o){this._tableCreated=typeof o>"u"?!1:!!o}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(o){this._clearExpiredByTimeout=typeof o>"u"?!0:!!o}_getRateLimiterRes(o,$,j){const et=new RateLimiterRes$7,tt=j.rows[0];return et.isFirstInDuration=$===tt.points,et.consumedPoints=et.isFirstInDuration?$:tt.points,et.remainingPoints=Math.max(this.points-et.consumedPoints,0),et.msBeforeNext=tt.expire?Math.max(tt.expire-Date.now(),0):-1,et}_query(o){const j={name:`${this.tableName.toLowerCase()}:${o.name}`,text:o.text,values:o.values};return new Promise((et,tt)=>{this._getConnection().then(rt=>{rt.query(j).then(nt=>{et(nt),this._releaseConnection(rt)}).catch(nt=>{tt(nt),this._releaseConnection(rt)})}).catch(rt=>{tt(rt)})})}_upsert(o,$,j,et=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const tt=j>0?Date.now()+j:null,rt=et?" $3 ":` CASE
             WHEN ${this.tableName}.expire <= $4 THEN $3
             ELSE ${this.tableName}.expire
            END `;return this._query({name:et?"rlflx-upsert-force":"rlflx-upsert",text:`
            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)
              ON CONFLICT(key) DO UPDATE SET
                points = CASE
                          WHEN (${this.tableName}.expire <= $4 OR 1=${et?1:0}) THEN $2
                          ELSE ${this.tableName}.points + ($2)
                         END,
                expire = ${rt}
            RETURNING points, expire;`,values:[o,$,tt,Date.now()]})}_get(o){return this.tableCreated?new Promise(($,j)=>{this._query({name:"rlflx-get",text:`
            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[o,Date.now()]}).then(et=>{et.rowCount===0&&(et=null),$(et)}).catch(et=>{j(et)})}):Promise.reject(Error("Table is not created yet"))}_delete(o){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[o]}).then($=>$.rowCount>0):Promise.reject(Error("Table is not created yet"))}};var RateLimiterPostgres_1=RateLimiterPostgres$1,Record_1=class{constructor(o,$,j=null){this.value=o,this.expiresAt=$,this.timeoutId=j}get value(){return this._value}set value(o){this._value=parseInt(o)}get expiresAt(){return this._expiresAt}set expiresAt(o){!(o instanceof Date)&&Number.isInteger(o)&&(o=new Date(o)),this._expiresAt=o}get timeoutId(){return this._timeoutId}set timeoutId(o){this._timeoutId=o}};const Record$1=Record_1,RateLimiterRes$6=RateLimiterRes_1;var MemoryStorage_1=class{constructor(){this._storage={}}incrby(o,$,j){if(this._storage[o]){const et=this._storage[o].expiresAt?this._storage[o].expiresAt.getTime()-new Date().getTime():-1;return et!==0?(this._storage[o].value=this._storage[o].value+$,new RateLimiterRes$6(0,et,this._storage[o].value,!1)):this.set(o,$,j)}return this.set(o,$,j)}set(o,$,j){const et=j*1e3;return this._storage[o]&&this._storage[o].timeoutId&&clearTimeout(this._storage[o].timeoutId),this._storage[o]=new Record$1($,et>0?new Date(Date.now()+et):null),et>0&&(this._storage[o].timeoutId=setTimeout(()=>{delete this._storage[o]},et),this._storage[o].timeoutId.unref&&this._storage[o].timeoutId.unref()),new RateLimiterRes$6(0,et===0?-1:et,this._storage[o].value,!0)}get(o){if(this._storage[o]){const $=this._storage[o].expiresAt?this._storage[o].expiresAt.getTime()-new Date().getTime():-1;return new RateLimiterRes$6(0,$,this._storage[o].value,!1)}return null}delete(o){return this._storage[o]?(this._storage[o].timeoutId&&clearTimeout(this._storage[o].timeoutId),delete this._storage[o],!0):!1}};const RateLimiterAbstract$2=RateLimiterAbstract_1,MemoryStorage=MemoryStorage_1,RateLimiterRes$5=RateLimiterRes_1;let RateLimiterMemory$2=class extends RateLimiterAbstract$2{constructor(o={}){super(o),this._memoryStorage=new MemoryStorage}consume(o,$=1,j={}){return new Promise((et,tt)=>{const rt=this.getKey(o),nt=this._getKeySecDuration(j);let it=this._memoryStorage.incrby(rt,$,nt);if(it.remainingPoints=Math.max(this.points-it.consumedPoints,0),it.consumedPoints>this.points)this.blockDuration>0&&it.consumedPoints<=this.points+$&&(it=this._memoryStorage.set(rt,it.consumedPoints,this.blockDuration)),tt(it);else if(this.execEvenly&&it.msBeforeNext>0&&!it.isFirstInDuration){let st=Math.ceil(it.msBeforeNext/(it.remainingPoints+2));st<this.execEvenlyMinDelayMs&&(st=it.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(et,st,it)}else et(it)})}penalty(o,$=1,j={}){const et=this.getKey(o);return new Promise(tt=>{const rt=this._getKeySecDuration(j),nt=this._memoryStorage.incrby(et,$,rt);nt.remainingPoints=Math.max(this.points-nt.consumedPoints,0),tt(nt)})}reward(o,$=1,j={}){const et=this.getKey(o);return new Promise(tt=>{const rt=this._getKeySecDuration(j),nt=this._memoryStorage.incrby(et,-$,rt);nt.remainingPoints=Math.max(this.points-nt.consumedPoints,0),tt(nt)})}block(o,$){const j=$*1e3,et=this.points+1;return this._memoryStorage.set(this.getKey(o),et,$),Promise.resolve(new RateLimiterRes$5(0,j===0?-1:j,et))}set(o,$,j){const et=(j>=0?j:this.duration)*1e3;return this._memoryStorage.set(this.getKey(o),$,j),Promise.resolve(new RateLimiterRes$5(0,et===0?-1:et,$))}get(o){const $=this._memoryStorage.get(this.getKey(o));return $!==null&&($.remainingPoints=Math.max(this.points-$.consumedPoints,0)),Promise.resolve($)}delete(o){return Promise.resolve(this._memoryStorage.delete(this.getKey(o)))}};var RateLimiterMemory_1=RateLimiterMemory$2;const cluster=require$$0$1,crypto$1=requireCryptoBrowserify(),RateLimiterAbstract$1=RateLimiterAbstract_1,RateLimiterMemory$1=RateLimiterMemory_1,RateLimiterRes$4=RateLimiterRes_1,channel="rate_limiter_flexible";let masterInstance=null;const masterSendToWorker=function(_,o,$,j){let et;j===null||j===!0||j===!1?et=j:et={remainingPoints:j.remainingPoints,msBeforeNext:j.msBeforeNext,consumedPoints:j.consumedPoints,isFirstInDuration:j.isFirstInDuration},_.send({channel,keyPrefix:o.keyPrefix,promiseId:o.promiseId,type:$,data:et})},workerWaitInit=function(_){setTimeout(()=>{this._initiated?browserExports$3.send(_):typeof this._promises[_.promiseId]<"u"&&workerWaitInit.call(this,_)},30)},workerSendToMaster=function(_,o,$,j,et){const tt={channel,keyPrefix:this.keyPrefix,func:_,promiseId:o,data:{key:$,arg:j,opts:et}};this._initiated?browserExports$3.send(tt):workerWaitInit.call(this,tt)},masterProcessMsg=function(_,o){if(!o||o.channel!==channel||typeof this._rateLimiters[o.keyPrefix]>"u")return!1;let $;switch(o.func){case"consume":$=this._rateLimiters[o.keyPrefix].consume(o.data.key,o.data.arg,o.data.opts);break;case"penalty":$=this._rateLimiters[o.keyPrefix].penalty(o.data.key,o.data.arg,o.data.opts);break;case"reward":$=this._rateLimiters[o.keyPrefix].reward(o.data.key,o.data.arg,o.data.opts);break;case"block":$=this._rateLimiters[o.keyPrefix].block(o.data.key,o.data.arg,o.data.opts);break;case"get":$=this._rateLimiters[o.keyPrefix].get(o.data.key,o.data.opts);break;case"delete":$=this._rateLimiters[o.keyPrefix].delete(o.data.key,o.data.opts);break;default:return!1}$&&$.then(j=>{masterSendToWorker(_,o,"resolve",j)}).catch(j=>{masterSendToWorker(_,o,"reject",j)})},workerProcessMsg=function(_){if(!_||_.channel!==channel||_.keyPrefix!==this.keyPrefix)return!1;if(this._promises[_.promiseId]){clearTimeout(this._promises[_.promiseId].timeoutId);let o;switch(_.data===null||_.data===!0||_.data===!1?o=_.data:o=new RateLimiterRes$4(_.data.remainingPoints,_.data.msBeforeNext,_.data.consumedPoints,_.data.isFirstInDuration),_.type){case"resolve":this._promises[_.promiseId].resolve(o);break;case"reject":this._promises[_.promiseId].reject(o);break;default:throw new Error(`RateLimiterCluster: no such message type '${_.type}'`)}delete this._promises[_.promiseId]}},getOpts=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},savePromise=function(_,o){const $=browserExports$3.hrtime();let j=$[0].toString()+$[1].toString();return typeof this._promises[j]<"u"&&(j+=crypto$1.randomBytes(12).toString("base64")),this._promises[j]={resolve:_,reject:o,timeoutId:setTimeout(()=>{delete this._promises[j],o(new Error("RateLimiterCluster timeout: no answer from master in time"))},this.timeoutMs)},j};let RateLimiterClusterMaster$1=class{constructor(){if(masterInstance)return masterInstance;this._rateLimiters={},cluster.setMaxListeners(0),cluster.on("message",(o,$)=>{$&&$.channel===channel&&$.type==="init"?(typeof this._rateLimiters[$.opts.keyPrefix]>"u"&&(this._rateLimiters[$.opts.keyPrefix]=new RateLimiterMemory$1($.opts)),o.send({channel,type:"init",keyPrefix:$.opts.keyPrefix})):masterProcessMsg.call(this,o,$)}),masterInstance=this}},RateLimiterClusterMasterPM2$1=class{constructor(o){if(masterInstance)return masterInstance;this._rateLimiters={},o.launchBus(($,j)=>{j.on("process:msg",et=>{const tt=et.raw;if(tt&&tt.channel===channel&&tt.type==="init")typeof this._rateLimiters[tt.opts.keyPrefix]>"u"&&(this._rateLimiters[tt.opts.keyPrefix]=new RateLimiterMemory$1(tt.opts)),o.sendDataToProcessId(et.process.pm_id,{data:{},topic:channel,channel,type:"init",keyPrefix:tt.opts.keyPrefix},(rt,nt)=>{rt&&console.log(rt,nt)});else{const rt={send:nt=>{const it=nt;it.topic=channel,typeof it.data>"u"&&(it.data={}),o.sendDataToProcessId(et.process.pm_id,it,(st,ot)=>{st&&console.log(st,ot)})}};masterProcessMsg.call(this,rt,tt)}})}),masterInstance=this}};class RateLimiterClusterWorker extends RateLimiterAbstract$1{get timeoutMs(){return this._timeoutMs}set timeoutMs(o){this._timeoutMs=typeof o>"u"?5e3:Math.abs(parseInt(o))}constructor(o={}){super(o),browserExports$3.setMaxListeners(0),this.timeoutMs=o.timeoutMs,this._initiated=!1,browserExports$3.on("message",$=>{$&&$.channel===channel&&$.type==="init"&&$.keyPrefix===this.keyPrefix?this._initiated=!0:workerProcessMsg.call(this,$)}),browserExports$3.send({channel,type:"init",opts:getOpts.call(this)}),this._promises={}}consume(o,$=1,j={}){return new Promise((et,tt)=>{const rt=savePromise.call(this,et,tt);workerSendToMaster.call(this,"consume",rt,o,$,j)})}penalty(o,$=1,j={}){return new Promise((et,tt)=>{const rt=savePromise.call(this,et,tt);workerSendToMaster.call(this,"penalty",rt,o,$,j)})}reward(o,$=1,j={}){return new Promise((et,tt)=>{const rt=savePromise.call(this,et,tt);workerSendToMaster.call(this,"reward",rt,o,$,j)})}block(o,$,j={}){return new Promise((et,tt)=>{const rt=savePromise.call(this,et,tt);workerSendToMaster.call(this,"block",rt,o,$,j)})}get(o,$={}){return new Promise((j,et)=>{const tt=savePromise.call(this,j,et);workerSendToMaster.call(this,"get",tt,o,$)})}delete(o,$={}){return new Promise((j,et)=>{const tt=savePromise.call(this,j,et);workerSendToMaster.call(this,"delete",tt,o,$)})}}var RateLimiterCluster$1={RateLimiterClusterMaster:RateLimiterClusterMaster$1,RateLimiterClusterMasterPM2:RateLimiterClusterMasterPM2$1,RateLimiterCluster:RateLimiterClusterWorker};const RateLimiterStoreAbstract=RateLimiterStoreAbstract_1,RateLimiterRes$3=RateLimiterRes_1;let RateLimiterMemcache$1=class extends RateLimiterStoreAbstract{constructor(o){super(o),this.client=o.storeClient}_getRateLimiterRes(o,$,j){const et=new RateLimiterRes$3;return et.consumedPoints=parseInt(j.consumedPoints),et.isFirstInDuration=j.consumedPoints===$,et.remainingPoints=Math.max(this.points-et.consumedPoints,0),et.msBeforeNext=j.msBeforeNext,et}_upsert(o,$,j,et=!1,tt={}){return new Promise((rt,nt)=>{const it=Date.now(),st=Math.floor(j/1e3);et?this.client.set(o,$,st,ot=>{ot?nt(ot):this.client.set(`${o}_expire`,st>0?it+st*1e3:-1,st,()=>{const at={consumedPoints:$,msBeforeNext:st>0?st*1e3:-1};rt(at)})}):this.client.incr(o,$,(ot,at)=>{ot||at===!1?this.client.add(o,$,st,(ct,ut)=>{if(ct||!ut)if(typeof tt.attemptNumber>"u"||tt.attemptNumber<3){const ft=Object.assign({},tt);ft.attemptNumber=ft.attemptNumber?ft.attemptNumber+1:1,this._upsert(o,$,j,et,ft).then(ht=>rt(ht)).catch(ht=>nt(ht))}else nt(new Error("Can not add key"));else this.client.add(`${o}_expire`,st>0?it+st*1e3:-1,st,()=>{const ft={consumedPoints:$,msBeforeNext:st>0?st*1e3:-1};rt(ft)})}):this.client.get(`${o}_expire`,(ct,ut)=>{if(ct)nt(ct);else{const ft=ut===!1?0:ut,ht={consumedPoints:at,msBeforeNext:ft>=0?Math.max(ft-it,0):-1};rt(ht)}})})})}_get(o){return new Promise(($,j)=>{const et=Date.now();this.client.get(o,(tt,rt)=>{rt?this.client.get(`${o}_expire`,(nt,it)=>{if(nt)j(nt);else{const st=it===!1?0:it,ot={consumedPoints:rt,msBeforeNext:st>=0?Math.max(st-et,0):-1};$(ot)}}):$(null)})})}_delete(o){return new Promise(($,j)=>{this.client.del(o,(et,tt)=>{et?j(et):tt===!1?$(tt):this.client.del(`${o}_expire`,rt=>{rt?j(rt):$(tt)})})})}};var RateLimiterMemcache_1=RateLimiterMemcache$1;const RateLimiterRes$2=RateLimiterRes_1;var RLWrapperBlackAndWhite_1=class{constructor(o={}){this.limiter=o.limiter,this.blackList=o.blackList,this.whiteList=o.whiteList,this.isBlackListed=o.isBlackListed,this.isWhiteListed=o.isWhiteListed,this.runActionAnyway=o.runActionAnyway}get limiter(){return this._limiter}set limiter(o){if(typeof o>"u")throw new Error("limiter is not set");this._limiter=o}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(o){this._runActionAnyway=typeof o>"u"?!1:o}get blackList(){return this._blackList}set blackList(o){this._blackList=Array.isArray(o)?o:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(o){if(typeof o>"u"&&(o=()=>!1),typeof o!="function")throw new Error("isBlackListed must be function");this._isBlackListed=o}get whiteList(){return this._whiteList}set whiteList(o){this._whiteList=Array.isArray(o)?o:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(o){if(typeof o>"u"&&(o=()=>!1),typeof o!="function")throw new Error("isWhiteListed must be function");this._isWhiteListed=o}isBlackListedSomewhere(o){return this.blackList.indexOf(o)>=0||this.isBlackListed(o)}isWhiteListedSomewhere(o){return this.whiteList.indexOf(o)>=0||this.isWhiteListed(o)}getBlackRes(){return new RateLimiterRes$2(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new RateLimiterRes$2(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(o,$=1){let j;return this.isWhiteListedSomewhere(o)?j=this.resolveWhite():this.isBlackListedSomewhere(o)&&(j=this.rejectBlack()),typeof j>"u"?this.limiter.consume(o,$):(this.runActionAnyway&&this.limiter.consume(o,$).catch(()=>{}),j)}block(o,$){let j;return this.isWhiteListedSomewhere(o)?j=this.resolveWhite():this.isBlackListedSomewhere(o)&&(j=this.resolveBlack()),typeof j>"u"?this.limiter.block(o,$):(this.runActionAnyway&&this.limiter.block(o,$).catch(()=>{}),j)}penalty(o,$){let j;return this.isWhiteListedSomewhere(o)?j=this.resolveWhite():this.isBlackListedSomewhere(o)&&(j=this.resolveBlack()),typeof j>"u"?this.limiter.penalty(o,$):(this.runActionAnyway&&this.limiter.penalty(o,$).catch(()=>{}),j)}reward(o,$){let j;return this.isWhiteListedSomewhere(o)?j=this.resolveWhite():this.isBlackListedSomewhere(o)&&(j=this.resolveBlack()),typeof j>"u"?this.limiter.reward(o,$):(this.runActionAnyway&&this.limiter.reward(o,$).catch(()=>{}),j)}get(o){let $;return this.isWhiteListedSomewhere(o)?$=this.resolveWhite():this.isBlackListedSomewhere(o)&&($=this.resolveBlack()),typeof $>"u"||this.runActionAnyway?this.limiter.get(o):$}delete(o){return this.limiter.delete(o)}};const RateLimiterAbstract=RateLimiterAbstract_1;var RateLimiterUnion_1=class{constructor(...o){if(o.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");o.forEach($=>{if(!($ instanceof RateLimiterAbstract))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")}),this._limiters=o}consume(o,$=1){return new Promise((j,et)=>{const tt=[];this._limiters.forEach(rt=>{tt.push(rt.consume(o,$).catch(nt=>({rejected:!0,rej:nt})))}),Promise.all(tt).then(rt=>{const nt={};let it=!1;rt.forEach(st=>{st.rejected===!0&&(it=!0)});for(let st=0;st<rt.length;st++)it&&rt[st].rejected===!0?nt[this._limiters[st].keyPrefix]=rt[st].rej:it||(nt[this._limiters[st].keyPrefix]=rt[st]);it?et(nt):j(nt)})})}},RateLimiterQueueError_1=class extends Error{constructor(o,$){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=o,$&&(this.extra=$)}};const RateLimiterQueueError=RateLimiterQueueError_1,MAX_QUEUE_SIZE=4294967295,KEY_DEFAULT="limiter";var RateLimiterQueue_1=class{constructor(o,$={maxQueueSize:MAX_QUEUE_SIZE}){this._queueLimiters={KEY_DEFAULT:new RateLimiterQueueInternal(o,$)},this._limiterFlexible=o,this._maxQueueSize=$.maxQueueSize}getTokensRemaining(o=KEY_DEFAULT){return this._queueLimiters[o]?this._queueLimiters[o].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(o,$=KEY_DEFAULT){return this._queueLimiters[$]||(this._queueLimiters[$]=new RateLimiterQueueInternal(this._limiterFlexible,{key:$,maxQueueSize:this._maxQueueSize})),this._queueLimiters[$].removeTokens(o)}};class RateLimiterQueueInternal{constructor(o,$={maxQueueSize:MAX_QUEUE_SIZE,key:KEY_DEFAULT}){this._key=$.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=o,this._maxQueueSize=$.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then(o=>o!==null?o.remainingPoints:this._limiterFlexible.points)}removeTokens(o){const $=this;return new Promise((j,et)=>{if(o>$._limiterFlexible.points){et(new RateLimiterQueueError(`Requested tokens ${o} exceeds maximum ${$._limiterFlexible.points} tokens per interval`));return}$._queue.length>0?$._queueRequest.call($,j,et,o):$._limiterFlexible.consume($._key,o).then(tt=>{j(tt.remainingPoints)}).catch(tt=>{tt instanceof Error?et(tt):($._queueRequest.call($,j,et,o),$._waitTimeout===null&&($._waitTimeout=setTimeout($._processFIFO.bind($),tt.msBeforeNext)))})})}_queueRequest(o,$,j){const et=this;et._queue.length<et._maxQueueSize?et._queue.push({resolve:o,reject:$,tokens:j}):$(new RateLimiterQueueError(`Number of requests reached it's maximum ${et._maxQueueSize}`))}_processFIFO(){const o=this;if(o._waitTimeout!==null&&(clearTimeout(o._waitTimeout),o._waitTimeout=null),o._queue.length===0)return;const $=o._queue.shift();o._limiterFlexible.consume(o._key,$.tokens).then(j=>{$.resolve(j.remainingPoints),o._processFIFO.call(o)}).catch(j=>{j instanceof Error?($.reject(j),o._processFIFO.call(o)):(o._queue.unshift($),o._waitTimeout===null&&(o._waitTimeout=setTimeout(o._processFIFO.bind(o),j.msBeforeNext)))})}}const RateLimiterRes$1=RateLimiterRes_1;var BurstyRateLimiter_1=class{constructor(o,$){this._rateLimiter=o,this._burstLimiter=$}_combineRes(o,$){return new RateLimiterRes$1(o.remainingPoints,Math.min(o.msBeforeNext,$.msBeforeNext),o.consumedPoints,o.isFirstInDuration)}consume(o,$=1,j={}){return this._rateLimiter.consume(o,$,j).catch(et=>et instanceof RateLimiterRes$1?this._burstLimiter.consume(o,$,j).then(tt=>Promise.resolve(this._combineRes(et,tt))).catch(tt=>tt instanceof RateLimiterRes$1?Promise.reject(this._combineRes(et,tt)):Promise.reject(tt)):Promise.reject(et))}get(o){return Promise.all([this._rateLimiter.get(o),this._burstLimiter.get(o)]).then(([$,j])=>this._combineRes($,j))}get points(){return this._rateLimiter.points}};const RateLimiterRedis=RateLimiterRedis_1,RateLimiterMongo=RateLimiterMongo_1,RateLimiterMySQL=RateLimiterMySQL_1,RateLimiterPostgres=RateLimiterPostgres_1,{RateLimiterClusterMaster,RateLimiterClusterMasterPM2,RateLimiterCluster}=RateLimiterCluster$1,RateLimiterMemory=RateLimiterMemory_1,RateLimiterMemcache=RateLimiterMemcache_1,RLWrapperBlackAndWhite=RLWrapperBlackAndWhite_1,RateLimiterUnion=RateLimiterUnion_1,RateLimiterQueue=RateLimiterQueue_1,BurstyRateLimiter=BurstyRateLimiter_1,RateLimiterRes=RateLimiterRes_1;var rateLimiterFlexible={RateLimiterRedis,RateLimiterMongo,RateLimiterMySQL,RateLimiterPostgres,RateLimiterMemory,RateLimiterMemcache,RateLimiterClusterMaster,RateLimiterClusterMasterPM2,RateLimiterCluster,RLWrapperBlackAndWhite,RateLimiterUnion,RateLimiterQueue,BurstyRateLimiter,RateLimiterRes};function getPeerAddress(_){if(isPeerId(_))return{peerId:_};if(isMultiaddr$3(_)){const o=_.getPeerId();return{multiaddr:_,peerId:o==null?void 0:peerIdFromString(o)}}throw errCode(new Error(`${_} is not a PeerId or a Multiaddr`),codes$2.ERR_INVALID_MULTIADDR)}const log$L=logger$1("libp2p:connection-manager"),defaultOptions$5={maxConnections:1/0,minConnections:0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,inboundConnectionThreshold:5,maxIncomingPendingConnections:10},STARTUP_RECONNECT_TIMEOUT=6e4;class DefaultConnectionManager extends EventEmitter$1{constructor(o,$){var j;if(super(),this.opts=mergeOptions$g.call({ignoreUndefined:!0},defaultOptions$5,$),this.opts.maxConnections<this.opts.minConnections)throw errCode(new Error("Connection Manager maxConnections must be greater than minConnections"),codes$2.ERR_INVALID_PARAMETERS);log$L("options: %o",this.opts),this.components=o,this.connections=new Map,this.started=!1,$.maxEventLoopDelay!=null&&$.maxEventLoopDelay>0&&$.maxEventLoopDelay!==1/0&&(this.latencyMonitor=new LatencyMonitor({latencyCheckIntervalMs:$.pollInterval,dataEmitIntervalMs:$.pollInterval}));try{(j=eventsExports.setMaxListeners)==null||j.call(eventsExports,1/0,this)}catch{}this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.startupReconnectTimeout=$.startupReconnectTimeout??STARTUP_RECONNECT_TIMEOUT,this.dialTimeout=$.dialTimeout??3e4,this.allow=($.allow??[]).map(et=>multiaddr$3(et)),this.deny=($.deny??[]).map(et=>multiaddr$3(et)),this.inboundConnectionRateLimiter=new rateLimiterFlexible.RateLimiterMemory({points:this.opts.inboundConnectionThreshold,duration:1}),this.incomingPendingConnections=0}isStarted(){return this.started}async start(){var o,$,j,et,tt;(o=this.components.metrics)==null||o.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const rt={inbound:0,outbound:0};for(const nt of this.connections.values())for(const it of nt)it.stat.direction==="inbound"?rt.inbound++:rt.outbound++;return rt}}),($=this.components.metrics)==null||$.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const rt={};for(const nt of this.connections.values())for(const it of nt)for(const st of it.streams){const ot=`${st.stat.direction} ${st.stat.protocol??"unnegotiated"}`;rt[ot]=(rt[ot]??0)+1}return rt}}),(j=this.components.metrics)==null||j.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const rt={};for(const it of this.connections.values())for(const st of it){const ot={};for(const at of st.streams){const ct=`${at.stat.direction} ${at.stat.protocol??"unnegotiated"}`;ot[ct]=(ot[ct]??0)+1}for(const[at,ct]of Object.entries(ot))rt[at]=rt[at]??[],rt[at].push(ct)}const nt={};for(let[it,st]of Object.entries(rt)){st=st.sort((at,ct)=>at-ct);const ot=Math.floor(st.length*.9);nt[it]=st[ot]}return nt}}),(et=this.latencyMonitor)==null||et.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),(tt=this.latencyMonitor)==null||tt.addEventListener("data",this._onLatencyMeasure),this.started=!0,log$L("started")}async afterStart(){this.components.upgrader.addEventListener("connection",this.onConnect),this.components.upgrader.addEventListener("connectionEnd",this.onDisconnect),Promise.resolve().then(async()=>{var $,j;const o=[];for(const et of await this.components.peerStore.all())(await this.components.peerStore.getTags(et.id)).filter(nt=>nt.name===KEEP_ALIVE).length>0&&o.push(et.id);($=this.connectOnStartupController)==null||$.clear(),this.connectOnStartupController=new timeoutAbortController.TimeoutController(this.startupReconnectTimeout);try{(j=eventsExports.setMaxListeners)==null||j.call(eventsExports,1/0,this.connectOnStartupController.signal)}catch{}await Promise.all(o.map(async et=>{var tt;await this.openConnection(et,{signal:(tt=this.connectOnStartupController)==null?void 0:tt.signal}).catch(rt=>{log$L.error(rt)})}))}).catch(o=>{log$L.error(o)}).finally(()=>{var o;(o=this.connectOnStartupController)==null||o.clear()})}async beforeStop(){var o;(o=this.connectOnStartupController)==null||o.abort(),this.components.upgrader.removeEventListener("connection",this.onConnect),this.components.upgrader.removeEventListener("connectionEnd",this.onDisconnect)}async stop(){var o,$;(o=this.latencyMonitor)==null||o.removeEventListener("data",this._onLatencyMeasure),($=this.latencyMonitor)==null||$.stop(),this.started=!1,await this._close(),log$L("stopped")}async _close(){const o=[];for(const $ of this.connections.values())for(const j of $)o.push((async()=>{try{await j.close()}catch(et){log$L.error(et)}})());log$L("closing %d connections",o.length),await Promise.all(o),this.connections.clear()}onConnect(o){this._onConnect(o).catch($=>{log$L.error($)})}async _onConnect(o){const{detail:$}=o;if(!this.started){await $.close();return}const j=$.remotePeer,et=j.toString(),tt=this.connections.get(et);tt!=null?tt.push($):this.connections.set(et,[$]),j.publicKey!=null&&await this.components.peerStore.keyBook.set(j,j.publicKey);const rt=this.getConnections().length,nt=rt-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",rt,nt),this.dispatchEvent(new CustomEvent("peer:connect",{detail:$}))}onDisconnect(o){const{detail:$}=o;if(!this.started)return;const j=$.remotePeer.toString();let et=this.connections.get(j);et!=null&&et.length>1?(et=et.filter(tt=>tt.id!==$.id),this.connections.set(j,et)):et!=null&&(this.connections.delete(j),this.dispatchEvent(new CustomEvent("peer:disconnect",{detail:$})))}getConnections(o){if(o!=null)return this.connections.get(o.toString())??[];let $=[];for(const j of this.connections.values())$=$.concat(j);return $}async openConnection(o,$={}){var rt;const{peerId:j,multiaddr:et}=getPeerAddress(o);if(j==null&&et==null)throw errCode(new TypeError("Can only open connections to PeerIds or Multiaddrs"),codes$2.ERR_INVALID_PARAMETERS);if(j!=null){log$L("dial to",j);const nt=this.getConnections(j);if(nt.length>0)return log$L("had an existing connection to %p",j),nt[0]}let tt;if(($==null?void 0:$.signal)==null){tt=new timeoutAbortController.TimeoutController(this.dialTimeout),$.signal=tt.signal;try{(rt=eventsExports.setMaxListeners)==null||rt.call(eventsExports,1/0,tt.signal)}catch{}}try{const nt=await this.components.dialer.dial(o,$);let it=this.connections.get(nt.remotePeer.toString());it==null&&(it=[],this.connections.set(nt.remotePeer.toString(),it));let st=!1;for(const ot of it)ot.id===nt.id&&(st=!0);return st||it.push(nt),nt}finally{tt!=null&&tt.clear()}}async closeConnections(o){const $=this.connections.get(o.toString())??[];await Promise.all($.map(async j=>await j.close()))}getAll(o){if(!isPeerId(o))throw errCode(new Error("peerId must be an instance of peer-id"),codes$2.ERR_INVALID_PARAMETERS);const $=o.toString(),j=this.connections.get($);return j!=null?j.filter(et=>et.stat.status===OPEN):[]}_onLatencyMeasure(o){const{detail:$}=o;this._checkMaxLimit("maxEventLoopDelay",$.avgMs,1).catch(j=>{log$L.error(j)})}async _checkMaxLimit(o,$,j=1){const et=this.opts[o];if(et==null){log$L.trace("limit %s was not set so it cannot be applied",o);return}log$L.trace("checking limit of %s. current value: %d of %d",o,$,et),$>et&&(log$L("%s: limit exceeded: %p, %d/%d, pruning %d connection(s)",this.components.peerId,o,$,et,j),await this._pruneConnections(j))}async _pruneConnections(o){const $=this.getConnections(),j=new PeerMap;for(const rt of $){const nt=rt.remotePeer;if(j.has(nt))continue;const it=await this.components.peerStore.getTags(nt);j.set(nt,it.reduce((st,ot)=>st+ot.value,0))}const et=$.sort((rt,nt)=>{const it=j.get(rt.remotePeer)??0,st=j.get(nt.remotePeer)??0;if(it>st)return 1;if(it<st)return-1;const ot=rt.stat.timeline.open,at=nt.stat.timeline.open;return ot<at?1:ot>at?-1:0}),tt=[];for(const rt of et)if(log$L("too many connections open - closing a connection to %p",rt.remotePeer),tt.push(rt),tt.length===o)break;await Promise.all(tt.map(async rt=>{try{await rt.close()}catch(nt){log$L.error(nt)}this.onDisconnect(new CustomEvent("connectionEnd",{detail:rt}))}))}async acceptIncomingConnection(o){if(this.deny.some(et=>o.remoteAddr.toString().startsWith(et.toString())))return log$L("connection from %s refused - connection remote address was in deny list",o.remoteAddr),!1;if(this.allow.some(et=>o.remoteAddr.toString().startsWith(et.toString())))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.opts.maxIncomingPendingConnections)return log$L("connection from %s refused - incomingPendingConnections exceeded by peer %s",o.remoteAddr),!1;if(o.remoteAddr.isThinWaistAddress()){const et=o.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(et,1)}catch{return log$L("connection from %s refused - inboundConnectionThreshold exceeded by host %s",et,o.remoteAddr),!1}}return this.getConnections().length<this.opts.maxConnections?(this.incomingPendingConnections++,!0):(log$L("connection from %s refused - maxConnections exceeded",o.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}}const log$K=logger$1("libp2p:connection-manager:auto-dialler"),defaultOptions$4={enabled:!0,minConnections:0,autoDialInterval:1e4};class AutoDialler{constructor(o,$){this.components=o,this.options=mergeOptions$g.call({ignoreUndefined:!0},defaultOptions$4,$),this.running=!1,this._autoDial=this._autoDial.bind(this),log$K("options: %j",this.options)}isStarted(){return this.running}async start(){if(!this.options.enabled){log$K("not enabled");return}this.running=!0,this._autoDial().catch(o=>{log$K.error("could start autodial",o)}),log$K("started")}async stop(){if(!this.options.enabled){log$K("not enabled");return}this.running=!1,this.autoDialTimeout!=null&&this.autoDialTimeout.clear(),log$K("stopped")}async _autoDial(){this.autoDialTimeout!=null&&this.autoDialTimeout.clear();const o=this.options.minConnections;if(this.components.connectionManager.getConnections().length>=o){this.autoDialTimeout=retimer_1(this._autoDial,this.options.autoDialInterval);return}const $=await this.components.peerStore.all(),j=await pipe($.sort(()=>Math.random()>.5?1:-1),et=>filter$1(et,tt=>!tt.id.equals(this.components.peerId)),et=>sort(et,(tt,rt)=>rt.protocols.length>tt.protocols.length||rt.id.publicKey!=null&&tt.id.publicKey==null?1:-1),async et=>await all$1(et));for(let et=0;this.running&&et<j.length&&this.components.connectionManager.getConnections().length<o;et++){if(!this.running)return;const tt=j[et];if(this.components.connectionManager.getConnections(tt.id).length===0){log$K("connecting to a peerStore stored peer %p",tt.id);try{await this.components.connectionManager.openConnection(tt.id)}catch(rt){log$K.error("could not connect to peerStore stored peer",rt)}}}this.running&&(this.autoDialTimeout=retimer_1(this._autoDial,this.options.autoDialInterval))}}function configure$1(){util$4._configure(),reader$6._configure(reader_buffer$1),writer$5._configure(writer_buffer$1)}configure$1();const methods$1=["uint64","int64","sint64","fixed64","sfixed64"];function patchReader$1(_){for(const o of methods$1){if(_[o]==null)continue;const $=_[o];_[o]=function(){return BigInt($.call(this).toString())}}return _}function reader$1(_){return patchReader$1(new reader$6(_))}function patchWriter$1(_){for(const o of methods$1){if(_[o]==null)continue;const $=_[o];_[o]=function(j){return $.call(this,j.toString())}}return _}function writer$1(){return patchWriter$1(writer$5.create())}function decodeMessage$1(_,o){const $=reader$1(_ instanceof Uint8Array?_:_.subarray());return o.decode($)}function encodeMessage$1(_,o){const $=writer$1();return o.encode(_,$,{lengthDelimited:!1}),$.finish()}var CODEC_TYPES$1;(function(_){_[_.VARINT=0]="VARINT",_[_.BIT64=1]="BIT64",_[_.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",_[_.START_GROUP=3]="START_GROUP",_[_.END_GROUP=4]="END_GROUP",_[_.BIT32=5]="BIT32"})(CODEC_TYPES$1||(CODEC_TYPES$1={}));function createCodec$1(_,o,$,j){return{name:_,type:o,encode:$,decode:j}}function enumeration(_){function o(et){if(_[et.toString()]==null)throw new Error("Invalid enum value");return _[et]}const $=function(tt,rt){const nt=o(tt);rt.int32(nt)},j=function(tt){const rt=tt.int32();return o(rt)};return createCodec$1("enum",CODEC_TYPES$1.VARINT,$,j)}function message$1(_,o){return createCodec$1("message",CODEC_TYPES$1.LENGTH_DELIMITED,_,o)}var CircuitRelay;(function(_){(function(et){et.SUCCESS="SUCCESS",et.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",et.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",et.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",et.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",et.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",et.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",et.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",et.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",et.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",et.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",et.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",et.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",et.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",et.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",et.MALFORMED_MESSAGE="MALFORMED_MESSAGE"})(_.Status||(_.Status={}));let o;(function(et){et[et.SUCCESS=100]="SUCCESS",et[et.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",et[et.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",et[et.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",et[et.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",et[et.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",et[et.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",et[et.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",et[et.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",et[et.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",et[et.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",et[et.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",et[et.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",et[et.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",et[et.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",et[et.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE"})(o||(o={})),function(et){et.codec=()=>enumeration(o)}(_.Status||(_.Status={})),function(et){et.HOP="HOP",et.STOP="STOP",et.STATUS="STATUS",et.CAN_HOP="CAN_HOP"}(_.Type||(_.Type={}));let $;(function(et){et[et.HOP=1]="HOP",et[et.STOP=2]="STOP",et[et.STATUS=3]="STATUS",et[et.CAN_HOP=4]="CAN_HOP"})($||($={})),function(et){et.codec=()=>enumeration($)}(_.Type||(_.Type={})),function(et){let tt;et.codec=()=>(tt==null&&(tt=message$1((rt,nt,it={})=>{if(it.lengthDelimited!==!1&&nt.fork(),(it.writeDefaults===!0||rt.id!=null&&rt.id.byteLength>0)&&(nt.uint32(10),nt.bytes(rt.id)),rt.addrs!=null)for(const st of rt.addrs)nt.uint32(18),nt.bytes(st);it.lengthDelimited!==!1&&nt.ldelim()},(rt,nt)=>{const it={id:new Uint8Array(0),addrs:[]},st=nt==null?rt.len:rt.pos+nt;for(;rt.pos<st;){const ot=rt.uint32();switch(ot>>>3){case 1:it.id=rt.bytes();break;case 2:it.addrs.push(rt.bytes());break;default:rt.skipType(ot&7);break}}return it})),tt),et.encode=rt=>encodeMessage$1(rt,et.codec()),et.decode=rt=>decodeMessage$1(rt,et.codec())}(_.Peer||(_.Peer={}));let j;_.codec=()=>(j==null&&(j=message$1((et,tt,rt={})=>{rt.lengthDelimited!==!1&&tt.fork(),et.type!=null&&(tt.uint32(8),_.Type.codec().encode(et.type,tt)),et.srcPeer!=null&&(tt.uint32(18),_.Peer.codec().encode(et.srcPeer,tt,{writeDefaults:!1})),et.dstPeer!=null&&(tt.uint32(26),_.Peer.codec().encode(et.dstPeer,tt,{writeDefaults:!1})),et.code!=null&&(tt.uint32(32),_.Status.codec().encode(et.code,tt)),rt.lengthDelimited!==!1&&tt.ldelim()},(et,tt)=>{const rt={},nt=tt==null?et.len:et.pos+tt;for(;et.pos<nt;){const it=et.uint32();switch(it>>>3){case 1:rt.type=_.Type.codec().decode(et);break;case 2:rt.srcPeer=_.Peer.codec().decode(et,et.uint32());break;case 3:rt.dstPeer=_.Peer.codec().decode(et,et.uint32());break;case 4:rt.code=_.Status.codec().decode(et);break;default:et.skipType(it&7);break}}return rt})),j),_.encode=et=>encodeMessage$1(et,_.codec()),_.decode=et=>decodeMessage$1(et,_.codec())})(CircuitRelay||(CircuitRelay={}));const log$J=logger$1("libp2p:stream:converter");function streamToMaConnection(_,o={}){const{stream:$,remoteAddr:j}=_,{sink:et,source:tt}=$,rt=async function*(){for await(const st of tt)yield*st}(),nt={async sink(st){o.signal!=null&&(st=abortableSource(st,o.signal));try{await et(st),await it()}catch(ot){ot.type!=="aborted"&&log$J(ot)}},source:o.signal!=null?abortableSource(rt,o.signal):rt,remoteAddr:j,timeline:{open:Date.now(),close:void 0},async close(){await et(async function*(){yield new Uint8Array(0)}()),await it()}};async function it(){nt.timeline.close==null&&(nt.timeline.close=Date.now()),await Promise.resolve()}return nt}const RELAY_CODEC="/libp2p/circuit/relay/0.1.0";function createListener$1(_){const o=new Map;async function $(tt){const rt=tt.toString().split("/p2p-circuit").find(ct=>ct!==""),nt=multiaddr$3(rt),it=nt.getPeerId();if(it==null)throw new Error("Could not determine relay peer from multiaddr");const st=peerIdFromString(it);await _.peerStore.addressBook.add(st,[nt]);const ot=await _.connectionManager.openConnection(st),at=ot.remoteAddr.encapsulate("/p2p-circuit");o.set(ot.remotePeer.toString(),at),et.dispatchEvent(new CustomEvent("listening"))}function j(){const tt=[];for(const rt of o.values())tt.push(rt);return tt}const et=Object.assign(new EventEmitter$1,{close:async()=>await Promise.resolve(),listen:$,getAddrs:j});return _.connectionManager.addEventListener("peer:disconnect",tt=>{const{detail:rt}=tt;o.delete(rt.remotePeer.toString())&&et.dispatchEvent(new CustomEvent("close"))}),et}function writeResponse(_,o){_.write({type:CircuitRelay.Type.STATUS,code:o})}function validateAddrs(_,o){var $,j;try{(($=_.dstPeer)==null?void 0:$.addrs)!=null&&_.dstPeer.addrs.forEach(et=>multiaddr$3(et))}catch(et){throw writeResponse(o,_.type===CircuitRelay.Type.HOP?CircuitRelay.Status.HOP_DST_MULTIADDR_INVALID:CircuitRelay.Status.STOP_DST_MULTIADDR_INVALID),et}try{((j=_.srcPeer)==null?void 0:j.addrs)!=null&&_.srcPeer.addrs.forEach(et=>multiaddr$3(et))}catch(et){throw writeResponse(o,_.type===CircuitRelay.Type.HOP?CircuitRelay.Status.HOP_SRC_MULTIADDR_INVALID:CircuitRelay.Status.STOP_SRC_MULTIADDR_INVALID),et}}function handshake(_){const o=pushable(),$=reader$3(_.source),j=pDefer$1();let et;const tt=_.sink(async function*(){yield*o,yield*await j.promise}());return tt.catch(nt=>{et=nt}),{reader:$,writer:o,stream:{sink:async nt=>et!=null?await Promise.reject(et):(j.resolve(nt),await tt),source:$},rest:()=>o.end(),write:o.push,read:async()=>{const nt=await $.next();if(nt.value!=null)return nt.value}}}const log$I=logger$1("libp2p:circuit:stream-handler");class StreamHandler{constructor(o){const{stream:$,maxLength:j=4096}=o;this.stream=$,this.shake=handshake(this.stream),this.decoder=decode$3.fromReader(this.shake.reader,{maxDataLength:j})}async read(){const o=await this.decoder.next();if(o.value!=null){const $=CircuitRelay.decode(o.value);return log$I("read message type",$.type),$}log$I("read received no value, closing stream"),this.close()}write(o){log$I("write message type %s",o.type),this.shake.write(encode$5.single(CircuitRelay.encode(o)))}rest(){return this.shake.rest(),this.shake.stream}end(o){this.write(o),this.close()}close(){log$I("closing the stream"),this.rest().sink([]).catch(o=>{log$I.error(o)})}}const log$H=logger$1("libp2p:circuit:stop");function handleStop(_){const{connection:o,request:$,streamHandler:j}=_;try{validateAddrs($,j)}catch(et){log$H.error("invalid stop request via peer %p %o",o.remotePeer,et);return}return log$H("stop request is valid"),j.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.SUCCESS}),j.rest()}async function stop(_){const{connection:o,request:$,signal:j}=_,et=await o.newStream(RELAY_CODEC,{signal:j});log$H("starting stop request to %p",o.remotePeer);const tt=new StreamHandler({stream:et});tt.write($);const rt=await tt.read();if(rt==null){tt.close();return}if(rt.code===CircuitRelay.Status.SUCCESS)return log$H("stop request to %p was successful",o.remotePeer),tt.rest();log$H("stop request failed with code %d",rt.code),tt.close()}const log$G=logger$1("libp2p:circuit:hop");async function handleHop(_){const{connection:o,request:$,streamHandler:j,circuit:et,connectionManager:tt}=_;if(!et.hopEnabled())return log$G("HOP request received but we are not acting as a relay"),j.end({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.HOP_CANT_SPEAK_RELAY});try{validateAddrs($,j)}catch(at){log$G.error("invalid hop request via peer %p %o",o.remotePeer,at);return}if($.dstPeer==null){log$G("HOP request received but we do not receive a dstPeer");return}const rt=peerIdFromBytes($.dstPeer.id),nt=tt.getConnections(rt);if(nt.length===0&&!et.hopActive())return log$G("HOP request received but we are not connected to the destination peer"),j.end({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.HOP_NO_CONN_TO_DST});if(nt.length===0)return log$G("did not have connection to remote peer"),j.end({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.HOP_NO_CONN_TO_DST});const it={type:CircuitRelay.Type.STOP,dstPeer:$.dstPeer,srcPeer:$.srcPeer};let st;try{log$G("performing STOP request");const at=await stop({connection:nt[0],request:it});if(at==null)throw new Error("Could not stop");st=at}catch(at){log$G.error(at);return}log$G("hop request from %p is valid",o.remotePeer),j.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.SUCCESS});const ot=j.rest();return log$G("creating related connections"),await pipe(ot,st,ot)}async function hop(_){const{connection:o,request:$,signal:j}=_,et=await o.newStream(RELAY_CODEC,{signal:j}),tt=new StreamHandler({stream:et});tt.write($);const rt=await tt.read();if(rt==null)throw errCode(new Error("HOP request had no response"),codes$2.ERR_HOP_REQUEST_FAILED);if(rt.code===CircuitRelay.Status.SUCCESS)return log$G("hop request was successful"),tt.rest();throw log$G("hop request failed with code %d, closing stream",rt.code),tt.close(),errCode(new Error(`HOP request failed with code "${rt.code??"unknown"}"`),codes$2.ERR_HOP_REQUEST_FAILED)}async function canHop(_){const{connection:o,signal:$}=_,j=await o.newStream(RELAY_CODEC,{signal:$}),et=new StreamHandler({stream:j});et.write({type:CircuitRelay.Type.CAN_HOP});const tt=await et.read();return await et.close(),!(tt==null||tt.code!==CircuitRelay.Status.SUCCESS)}function handleCanHop(_){const{connection:o,streamHandler:$,circuit:j}=_,et=j.hopEnabled();log$G("can hop (%s) request from %p",et,o.remotePeer),$.end({type:CircuitRelay.Type.STATUS,code:et?CircuitRelay.Status.SUCCESS:CircuitRelay.Status.HOP_CANT_SPEAK_RELAY})}const log$F=logger$1("libp2p:circuit");class Circuit{constructor(o,$){this._init=$,this.components=o,this._started=!1}isStarted(){return this._started}async start(){this._started||(this._started=!0,await this.components.registrar.handle(RELAY_CODEC,o=>{this._onProtocol(o).catch($=>{log$F.error($)})},{...this._init}).catch(o=>{log$F.error(o)}))}async stop(){await this.components.registrar.unhandle(RELAY_CODEC)}hopEnabled(){return!0}hopActive(){return!0}get[symbol$3](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(o){var tt,rt,nt;const{connection:$,stream:j}=o,et=new timeoutAbortController.TimeoutController(this._init.hop.timeout);try{(tt=eventsExports.setMaxListeners)==null||tt.call(eventsExports,1/0,et.signal)}catch{}try{const it=abortableDuplex(j,et.signal),st=new StreamHandler({stream:{...j,...it}}),ot=await st.read();if(ot==null){log$F("request was invalid, could not read from stream"),st.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.MALFORMED_MESSAGE}),st.close();return}let at;switch(ot.type){case CircuitRelay.Type.CAN_HOP:{log$F("received CAN_HOP request from %p",$.remotePeer),await handleCanHop({circuit:this,connection:$,streamHandler:st});break}case CircuitRelay.Type.HOP:{log$F("received HOP request from %p",$.remotePeer),await handleHop({connection:$,request:ot,streamHandler:st,circuit:this,connectionManager:this.components.connectionManager});break}case CircuitRelay.Type.STOP:{log$F("received STOP request from %p",$.remotePeer),at=await handleStop({connection:$,request:ot,streamHandler:st});break}default:{log$F("Request of type %s not supported",ot.type),st.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.MALFORMED_MESSAGE}),st.close();return}}if(at!=null){const ct=$.remoteAddr.encapsulate("/p2p-circuit").encapsulate(multiaddr$3((rt=ot.dstPeer)==null?void 0:rt.addrs[0])),ut=multiaddr$3((nt=ot.srcPeer)==null?void 0:nt.addrs[0]),ft=streamToMaConnection({stream:at,remoteAddr:ct,localAddr:ut}),ht=ot.type===CircuitRelay.Type.HOP?"relay":"inbound";log$F("new %s connection %s",ht,ft.remoteAddr);const mt=await this.components.upgrader.upgradeInbound(ft);log$F("%s connection %s upgraded",ht,ft.remoteAddr),this.handler!=null&&this.handler(mt)}}finally{et.clear()}}async dial(o,$={}){const j=o.toString().split("/p2p-circuit"),et=multiaddr$3(j[0]),tt=multiaddr$3(j[j.length-1]),rt=et.getPeerId(),nt=tt.getPeerId();if(rt==null||nt==null){const ut="Circuit relay dial failed as addresses did not have peer id";throw log$F.error(ut),errCode(new Error(ut),codes$2.ERR_RELAYED_DIAL)}const it=peerIdFromString(rt),st=peerIdFromString(nt);let ot=!1,ct=this.components.connectionManager.getConnections(it)[0];ct==null&&(await this.components.peerStore.addressBook.add(it,[et]),ct=await this.components.connectionManager.openConnection(it,$),ot=!0);try{const ut=await hop({...$,connection:ct,request:{type:CircuitRelay.Type.HOP,srcPeer:{id:this.components.peerId.toBytes(),addrs:this.components.addressManager.getAddresses().map(mt=>mt.bytes)},dstPeer:{id:st.toBytes(),addrs:[multiaddr$3(tt).bytes]}}}),ft=et.encapsulate(`/p2p-circuit/p2p/${this.components.peerId.toString()}`),ht=streamToMaConnection({stream:ut,remoteAddr:o,localAddr:ft});return log$F("new outbound connection %s",ht.remoteAddr),await this.components.upgrader.upgradeOutbound(ht)}catch(ut){throw log$F.error("Circuit relay dial failed",ut),ot&&await ct.close(),ut}}createListener(o){return this.handler=o.handler,createListener$1({connectionManager:this.components.connectionManager,peerStore:this.components.peerStore})}filter(o){return o=Array.isArray(o)?o:[o],o.filter($=>Circuit$1.matches($))}}async function namespaceToCid(_){const o=new TextEncoder().encode(_),$=await sha256$8.digest(o);return CID$3.createV0($)}const minute$1=60*1e3,ADVERTISE_BOOT_DELAY=15*minute$1,ADVERTISE_TTL=30*minute$1,CIRCUIT_PROTO_CODE=290,HOP_METADATA_KEY="hop_relay",HOP_METADATA_VALUE="true",RELAY_RENDEZVOUS_NS="/libp2p/relay";var Netmask_1;(function(){var _,o,$,j,et,tt,rt,nt;nt=function(it){var st,ot,at,ct;return st=(it&255<<24)>>>24,ot=(it&255<<16)>>>16,at=(it&255<<8)>>>8,ct=it&255,[st,ot,at,ct].join(".")},rt=function(it){var st,ot,at,ct,ut,ft;for(st=[],at=ct=0;ct<=3&&it.length!==0;at=++ct){if(at>0){if(it[0]!==".")throw new Error("Invalid IP");it=it.substring(1)}ft=o(it),ut=ft[0],ot=ft[1],it=it.substring(ot),st.push(ut)}if(it.length!==0)throw new Error("Invalid IP");switch(st.length){case 1:if(st[0]>4294967295)throw new Error("Invalid IP");return st[0]>>>0;case 2:if(st[0]>255||st[1]>16777215)throw new Error("Invalid IP");return(st[0]<<24|st[1])>>>0;case 3:if(st[0]>255||st[1]>255||st[2]>65535)throw new Error("Invalid IP");return(st[0]<<24|st[1]<<16|st[2])>>>0;case 4:if(st[0]>255||st[1]>255||st[2]>255||st[3]>255)throw new Error("Invalid IP");return(st[0]<<24|st[1]<<16|st[2]<<8|st[3])>>>0;default:throw new Error("Invalid IP")}},$=function(it){return it.charCodeAt(0)},j=$("0"),tt=$("a"),et=$("A"),o=function(it){var st,ot,at,ct,ut;for(ct=0,st=10,ot="9",at=0,it.length>1&&it[at]==="0"&&(it[at+1]==="x"||it[at+1]==="X"?(at+=2,st=16):"0"<=it[at+1]&&it[at+1]<="9"&&(at++,st=8,ot="7")),ut=at;at<it.length;){if("0"<=it[at]&&it[at]<=ot)ct=ct*st+($(it[at])-j)>>>0;else if(st===16)if("a"<=it[at]&&it[at]<="f")ct=ct*st+(10+$(it[at])-tt)>>>0;else if("A"<=it[at]&&it[at]<="F")ct=ct*st+(10+$(it[at])-et)>>>0;else break;else break;if(ct>4294967295)throw new Error("too large");at++}if(at===ut)throw new Error("empty octet");return[ct,at]},_=function(){function it(st,ot){var at,ct,ut;if(typeof st!="string")throw new Error("Missing `net' parameter");if(ot||(ut=st.split("/",2),st=ut[0],ot=ut[1]),ot||(ot=32),typeof ot=="string"&&ot.indexOf(".")>-1){try{this.maskLong=rt(ot)}catch{throw new Error("Invalid mask: "+ot)}for(at=ct=32;ct>=0;at=--ct)if(this.maskLong===4294967295<<32-at>>>0){this.bitmask=at;break}}else if(ot||ot===0)this.bitmask=parseInt(ot,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(rt(st)&this.maskLong)>>>0}catch{throw new Error("Invalid net address: "+st)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+ot);this.size=Math.pow(2,32-this.bitmask),this.base=nt(this.netLong),this.mask=nt(this.maskLong),this.hostmask=nt(~this.maskLong),this.first=this.bitmask<=30?nt(this.netLong+1):this.base,this.last=this.bitmask<=30?nt(this.netLong+this.size-2):nt(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?nt(this.netLong+this.size-1):void 0}return it.prototype.contains=function(st){return typeof st=="string"&&(st.indexOf("/")>0||st.split(".").length!==4)&&(st=new it(st)),st instanceof it?this.contains(st.base)&&this.contains(st.broadcast||st.last):(rt(st)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},it.prototype.next=function(st){return st==null&&(st=1),new it(nt(this.netLong+this.size*st),this.mask)},it.prototype.forEach=function(st){var ot,at,ct;for(ct=rt(this.first),at=rt(this.last),ot=0;ct<=at;)st(nt(ct),ct,ot),ot++,ct++},it.prototype.toString=function(){return this.base+"/"+this.bitmask},it}(),Netmask_1=_}).call(commonjsGlobal);const word="[a-fA-F\\d:]",boundry=_=>_&&_.includeBoundaries?`(?:(?<=\\s|^)(?=${word})|(?<=${word})(?=\\s|$))`:"",v4="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",v6segment="[a-fA-F\\d]{1,4}",v6=`
(?:
(?:${v6segment}:){7}(?:${v6segment}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${v6segment}:){6}(?:${v4}|:${v6segment}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${v6segment}:){5}(?::${v4}|(?::${v6segment}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${v6segment}:){4}(?:(?::${v6segment}){0,1}:${v4}|(?::${v6segment}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${v6segment}:){3}(?:(?::${v6segment}){0,2}:${v4}|(?::${v6segment}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${v6segment}:){2}(?:(?::${v6segment}){0,3}:${v4}|(?::${v6segment}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${v6segment}:){1}(?:(?::${v6segment}){0,4}:${v4}|(?::${v6segment}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${v6segment}){0,5}:${v4}|(?::${v6segment}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),v46Exact=new RegExp(`(?:^${v4}$)|(?:^${v6}$)`),v4exact=new RegExp(`^${v4}$`),v6exact=new RegExp(`^${v6}$`),ipRegex=_=>_&&_.exact?v46Exact:new RegExp(`(?:${boundry(_)}${v4}${boundry(_)})|(?:${boundry(_)}${v6}${boundry(_)})`,"g");ipRegex.v4=_=>_&&_.exact?v4exact:new RegExp(`${boundry(_)}${v4}${boundry(_)}`,"g");ipRegex.v6=_=>_&&_.exact?v6exact:new RegExp(`${boundry(_)}${v6}${boundry(_)}`,"g");var ipaddrExports={},ipaddr$1={get exports(){return ipaddrExports},set exports(_){ipaddrExports=_}};(function(_){(function(o){const $="(0?\\d+|0x[a-f0-9]+)",j={fourOctet:new RegExp(`^${$}\\.${$}\\.${$}\\.${$}$`,"i"),threeOctet:new RegExp(`^${$}\\.${$}\\.${$}$`,"i"),twoOctet:new RegExp(`^${$}\\.${$}$`,"i"),longValue:new RegExp(`^${$}$`,"i")},et=new RegExp("^0[0-7]+$","i"),tt=new RegExp("^0x[a-f0-9]+$","i"),rt="%[0-9a-z]{1,}",nt="(?:[0-9a-f]+::?)+",it={zoneIndex:new RegExp(rt,"i"),native:new RegExp(`^(::)?(${nt})?([0-9a-f]+)?(::)?(${rt})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${$}\\.${$}\\.${$}\\.${$}(${rt})?)$`,"i"),transitional:new RegExp(`^((?:${nt})|(?:::)(?:${nt})?)${$}\\.${$}\\.${$}\\.${$}(${rt})?$`,"i")};function st(ft,ht){if(ft.indexOf("::")!==ft.lastIndexOf("::"))return null;let mt=0,gt=-1,Et=(ft.match(it.zoneIndex)||[])[0],St,At;for(Et&&(Et=Et.substring(1),ft=ft.replace(/%.+$/,""));(gt=ft.indexOf(":",gt+1))>=0;)mt++;if(ft.substr(0,2)==="::"&&mt--,ft.substr(-2,2)==="::"&&mt--,mt>ht)return null;for(At=ht-mt,St=":";At--;)St+="0:";return ft=ft.replace("::",St),ft[0]===":"&&(ft=ft.slice(1)),ft[ft.length-1]===":"&&(ft=ft.slice(0,-1)),ht=function(){const kt=ft.split(":"),Rt=[];for(let Tt=0;Tt<kt.length;Tt++)Rt.push(parseInt(kt[Tt],16));return Rt}(),{parts:ht,zoneId:Et}}function ot(ft,ht,mt,gt){if(ft.length!==ht.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let Et=0,St;for(;gt>0;){if(St=mt-gt,St<0&&(St=0),ft[Et]>>St!==ht[Et]>>St)return!1;gt-=mt,Et+=1}return!0}function at(ft){if(tt.test(ft))return parseInt(ft,16);if(ft[0]==="0"&&!isNaN(parseInt(ft[1],10))){if(et.test(ft))return parseInt(ft,8);throw new Error(`ipaddr: cannot parse ${ft} as octal`)}return parseInt(ft,10)}function ct(ft,ht){for(;ft.length<ht;)ft=`0${ft}`;return ft}const ut={};ut.IPv4=function(){function ft(ht){if(ht.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let mt,gt;for(mt=0;mt<ht.length;mt++)if(gt=ht[mt],!(0<=gt&&gt<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=ht}return ft.prototype.SpecialRanges={unspecified:[[new ft([0,0,0,0]),8]],broadcast:[[new ft([255,255,255,255]),32]],multicast:[[new ft([224,0,0,0]),4]],linkLocal:[[new ft([169,254,0,0]),16]],loopback:[[new ft([127,0,0,0]),8]],carrierGradeNat:[[new ft([100,64,0,0]),10]],private:[[new ft([10,0,0,0]),8],[new ft([172,16,0,0]),12],[new ft([192,168,0,0]),16]],reserved:[[new ft([192,0,0,0]),24],[new ft([192,0,2,0]),24],[new ft([192,88,99,0]),24],[new ft([198,51,100,0]),24],[new ft([203,0,113,0]),24],[new ft([240,0,0,0]),4]]},ft.prototype.kind=function(){return"ipv4"},ft.prototype.match=function(ht,mt){let gt;if(mt===void 0&&(gt=ht,ht=gt[0],mt=gt[1]),ht.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return ot(this.octets,ht.octets,8,mt)},ft.prototype.prefixLengthFromSubnetMask=function(){let ht=0,mt=!1;const gt={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let Et,St,At;for(Et=3;Et>=0;Et-=1)if(St=this.octets[Et],St in gt){if(At=gt[St],mt&&At!==0)return null;At!==8&&(mt=!0),ht+=At}else return null;return 32-ht},ft.prototype.range=function(){return ut.subnetMatch(this,this.SpecialRanges)},ft.prototype.toByteArray=function(){return this.octets.slice(0)},ft.prototype.toIPv4MappedAddress=function(){return ut.IPv6.parse(`::ffff:${this.toString()}`)},ft.prototype.toNormalizedString=function(){return this.toString()},ft.prototype.toString=function(){return this.octets.join(".")},ft}(),ut.IPv4.broadcastAddressFromCIDR=function(ft){try{const ht=this.parseCIDR(ft),mt=ht[0].toByteArray(),gt=this.subnetMaskFromPrefixLength(ht[1]).toByteArray(),Et=[];let St=0;for(;St<4;)Et.push(parseInt(mt[St],10)|parseInt(gt[St],10)^255),St++;return new this(Et)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},ut.IPv4.isIPv4=function(ft){return this.parser(ft)!==null},ut.IPv4.isValid=function(ft){try{return new this(this.parser(ft)),!0}catch{return!1}},ut.IPv4.isValidFourPartDecimal=function(ft){return!!(ut.IPv4.isValid(ft)&&ft.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},ut.IPv4.networkAddressFromCIDR=function(ft){let ht,mt,gt,Et,St;try{for(ht=this.parseCIDR(ft),gt=ht[0].toByteArray(),St=this.subnetMaskFromPrefixLength(ht[1]).toByteArray(),Et=[],mt=0;mt<4;)Et.push(parseInt(gt[mt],10)&parseInt(St[mt],10)),mt++;return new this(Et)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},ut.IPv4.parse=function(ft){const ht=this.parser(ft);if(ht===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(ht)},ut.IPv4.parseCIDR=function(ft){let ht;if(ht=ft.match(/^(.+)\/(\d+)$/)){const mt=parseInt(ht[2]);if(mt>=0&&mt<=32){const gt=[this.parse(ht[1]),mt];return Object.defineProperty(gt,"toString",{value:function(){return this.join("/")}}),gt}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},ut.IPv4.parser=function(ft){let ht,mt,gt;if(ht=ft.match(j.fourOctet))return function(){const Et=ht.slice(1,6),St=[];for(let At=0;At<Et.length;At++)mt=Et[At],St.push(at(mt));return St}();if(ht=ft.match(j.longValue)){if(gt=at(ht[1]),gt>4294967295||gt<0)throw new Error("ipaddr: address outside defined range");return function(){const Et=[];let St;for(St=0;St<=24;St+=8)Et.push(gt>>St&255);return Et}().reverse()}else return(ht=ft.match(j.twoOctet))?function(){const Et=ht.slice(1,4),St=[];if(gt=at(Et[1]),gt>16777215||gt<0)throw new Error("ipaddr: address outside defined range");return St.push(at(Et[0])),St.push(gt>>16&255),St.push(gt>>8&255),St.push(gt&255),St}():(ht=ft.match(j.threeOctet))?function(){const Et=ht.slice(1,5),St=[];if(gt=at(Et[2]),gt>65535||gt<0)throw new Error("ipaddr: address outside defined range");return St.push(at(Et[0])),St.push(at(Et[1])),St.push(gt>>8&255),St.push(gt&255),St}():null},ut.IPv4.subnetMaskFromPrefixLength=function(ft){if(ft=parseInt(ft),ft<0||ft>32)throw new Error("ipaddr: invalid IPv4 prefix length");const ht=[0,0,0,0];let mt=0;const gt=Math.floor(ft/8);for(;mt<gt;)ht[mt]=255,mt++;return gt<4&&(ht[gt]=Math.pow(2,ft%8)-1<<8-ft%8),new this(ht)},ut.IPv6=function(){function ft(ht,mt){let gt,Et;if(ht.length===16)for(this.parts=[],gt=0;gt<=14;gt+=2)this.parts.push(ht[gt]<<8|ht[gt+1]);else if(ht.length===8)this.parts=ht;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(gt=0;gt<this.parts.length;gt++)if(Et=this.parts[gt],!(0<=Et&&Et<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");mt&&(this.zoneId=mt)}return ft.prototype.SpecialRanges={unspecified:[new ft([0,0,0,0,0,0,0,0]),128],linkLocal:[new ft([65152,0,0,0,0,0,0,0]),10],multicast:[new ft([65280,0,0,0,0,0,0,0]),8],loopback:[new ft([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new ft([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new ft([0,0,0,0,0,65535,0,0]),96],rfc6145:[new ft([0,0,0,0,65535,0,0,0]),96],rfc6052:[new ft([100,65435,0,0,0,0,0,0]),96],"6to4":[new ft([8194,0,0,0,0,0,0,0]),16],teredo:[new ft([8193,0,0,0,0,0,0,0]),32],reserved:[[new ft([8193,3512,0,0,0,0,0,0]),32]]},ft.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},ft.prototype.kind=function(){return"ipv6"},ft.prototype.match=function(ht,mt){let gt;if(mt===void 0&&(gt=ht,ht=gt[0],mt=gt[1]),ht.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return ot(this.parts,ht.parts,16,mt)},ft.prototype.prefixLengthFromSubnetMask=function(){let ht=0,mt=!1;const gt={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let Et,St;for(let At=7;At>=0;At-=1)if(Et=this.parts[At],Et in gt){if(St=gt[Et],mt&&St!==0)return null;St!==16&&(mt=!0),ht+=St}else return null;return 128-ht},ft.prototype.range=function(){return ut.subnetMatch(this,this.SpecialRanges)},ft.prototype.toByteArray=function(){let ht;const mt=[],gt=this.parts;for(let Et=0;Et<gt.length;Et++)ht=gt[Et],mt.push(ht>>8),mt.push(ht&255);return mt},ft.prototype.toFixedLengthString=function(){const ht=function(){const gt=[];for(let Et=0;Et<this.parts.length;Et++)gt.push(ct(this.parts[Et].toString(16),4));return gt}.call(this).join(":");let mt="";return this.zoneId&&(mt=`%${this.zoneId}`),ht+mt},ft.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const ht=this.parts.slice(-2),mt=ht[0],gt=ht[1];return new ut.IPv4([mt>>8,mt&255,gt>>8,gt&255])},ft.prototype.toNormalizedString=function(){const ht=function(){const gt=[];for(let Et=0;Et<this.parts.length;Et++)gt.push(this.parts[Et].toString(16));return gt}.call(this).join(":");let mt="";return this.zoneId&&(mt=`%${this.zoneId}`),ht+mt},ft.prototype.toRFC5952String=function(){const ht=/((^|:)(0(:|$)){2,})/g,mt=this.toNormalizedString();let gt=0,Et=-1,St;for(;St=ht.exec(mt);)St[0].length>Et&&(gt=St.index,Et=St[0].length);return Et<0?mt:`${mt.substring(0,gt)}::${mt.substring(gt+Et)}`},ft.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},ft}(),ut.IPv6.broadcastAddressFromCIDR=function(ft){try{const ht=this.parseCIDR(ft),mt=ht[0].toByteArray(),gt=this.subnetMaskFromPrefixLength(ht[1]).toByteArray(),Et=[];let St=0;for(;St<16;)Et.push(parseInt(mt[St],10)|parseInt(gt[St],10)^255),St++;return new this(Et)}catch(ht){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${ht})`)}},ut.IPv6.isIPv6=function(ft){return this.parser(ft)!==null},ut.IPv6.isValid=function(ft){if(typeof ft=="string"&&ft.indexOf(":")===-1)return!1;try{const ht=this.parser(ft);return new this(ht.parts,ht.zoneId),!0}catch{return!1}},ut.IPv6.networkAddressFromCIDR=function(ft){let ht,mt,gt,Et,St;try{for(ht=this.parseCIDR(ft),gt=ht[0].toByteArray(),St=this.subnetMaskFromPrefixLength(ht[1]).toByteArray(),Et=[],mt=0;mt<16;)Et.push(parseInt(gt[mt],10)&parseInt(St[mt],10)),mt++;return new this(Et)}catch(At){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${At})`)}},ut.IPv6.parse=function(ft){const ht=this.parser(ft);if(ht.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(ht.parts,ht.zoneId)},ut.IPv6.parseCIDR=function(ft){let ht,mt,gt;if((mt=ft.match(/^(.+)\/(\d+)$/))&&(ht=parseInt(mt[2]),ht>=0&&ht<=128))return gt=[this.parse(mt[1]),ht],Object.defineProperty(gt,"toString",{value:function(){return this.join("/")}}),gt;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},ut.IPv6.parser=function(ft){let ht,mt,gt,Et,St,At;if(gt=ft.match(it.deprecatedTransitional))return this.parser(`::ffff:${gt[1]}`);if(it.native.test(ft))return st(ft,8);if((gt=ft.match(it.transitional))&&(At=gt[6]||"",ht=st(gt[1].slice(0,-1)+At,6),ht.parts)){for(St=[parseInt(gt[2]),parseInt(gt[3]),parseInt(gt[4]),parseInt(gt[5])],mt=0;mt<St.length;mt++)if(Et=St[mt],!(0<=Et&&Et<=255))return null;return ht.parts.push(St[0]<<8|St[1]),ht.parts.push(St[2]<<8|St[3]),{parts:ht.parts,zoneId:ht.zoneId}}return null},ut.IPv6.subnetMaskFromPrefixLength=function(ft){if(ft=parseInt(ft),ft<0||ft>128)throw new Error("ipaddr: invalid IPv6 prefix length");const ht=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let mt=0;const gt=Math.floor(ft/8);for(;mt<gt;)ht[mt]=255,mt++;return gt<16&&(ht[gt]=Math.pow(2,ft%8)-1<<8-ft%8),new this(ht)},ut.fromByteArray=function(ft){const ht=ft.length;if(ht===4)return new ut.IPv4(ft);if(ht===16)return new ut.IPv6(ft);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},ut.isValid=function(ft){return ut.IPv6.isValid(ft)||ut.IPv4.isValid(ft)},ut.parse=function(ft){if(ut.IPv6.isValid(ft))return ut.IPv6.parse(ft);if(ut.IPv4.isValid(ft))return ut.IPv4.parse(ft);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},ut.parseCIDR=function(ft){try{return ut.IPv6.parseCIDR(ft)}catch{try{return ut.IPv4.parseCIDR(ft)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},ut.process=function(ft){const ht=this.parse(ft);return ht.kind()==="ipv6"&&ht.isIPv4MappedAddress()?ht.toIPv4Address():ht},ut.subnetMatch=function(ft,ht,mt){let gt,Et,St,At;mt==null&&(mt="unicast");for(Et in ht)if(Object.prototype.hasOwnProperty.call(ht,Et)){for(St=ht[Et],St[0]&&!(St[0]instanceof Array)&&(St=[St]),gt=0;gt<St.length;gt++)if(At=St[gt],ft.kind()===At[0].kind()&&ft.match.apply(ft,At))return Et}return mt},_.exports?_.exports=ut:o.ipaddr=ut})(commonjsGlobal)})(ipaddr$1);const ipaddr=ipaddrExports,{isValid:is_valid,parse:parse$1}=ipaddr,PRIVATE_IP_RANGES=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],NETMASK_RANGES=PRIVATE_IP_RANGES.map(_=>new Netmask_1(_));function ipv4_check(_){for(let o of NETMASK_RANGES)if(o.contains(_))return!0;return!1}function ipv6_check(_){return/^::$/.test(_)||/^::1$/.test(_)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(_)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(_)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(_)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(_)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(_)||/^ff([0-9a-fA-F]{2,2}):/i.test(_)}const is_ip_private=_=>{if(is_valid(_)){const o=parse$1(_);if(o.kind()==="ipv4")return ipv4_check(o.toNormalizedString());if(o.kind()==="ipv6")return ipv6_check(_)}else if(isIP(_)&&ipRegex.v6().test(_))return ipv6_check(_)};function isPrivate(_){const{address:o}=_.nodeAddress();return!!is_ip_private(o)}function publicAddressesFirst(_,o){const $=isPrivate(_.multiaddr),j=isPrivate(o.multiaddr);return $&&!j?1:!$&&j||_.isCertified&&!o.isCertified?-1:!_.isCertified&&o.isCertified?1:0}const log$E=logger$1("libp2p:auto-relay"),noop$1=()=>{};class AutoRelay{constructor(o,$){this.components=o,this.addressSorter=$.addressSorter??publicAddressesFirst,this.maxListeners=$.maxListeners??1,this.listenRelays=new Set,this.onError=$.onError??noop$1,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.peerStore.addEventListener("change:protocols",j=>{this._onProtocolChange(j).catch(et=>{log$E.error(et)})}),this.components.connectionManager.addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(o){const{peerId:$,protocols:j}=o.detail,et=$.toString();if(j.find(rt=>rt===RELAY_CODEC)==null){this.listenRelays.has(et)&&await this._removeListenRelay(et);return}if(!this.listenRelays.has(et))try{const rt=this.components.connectionManager.getConnections($);if(rt.length===0)return;const nt=rt[0];if(nt.remoteAddr.protoCodes().includes(CIRCUIT_PROTO_CODE)){log$E(`relayed connection to ${et} will not be used to hop on`);return}await canHop({connection:nt})&&(await this.components.peerStore.metadataBook.setValue($,HOP_METADATA_KEY,fromString$8(HOP_METADATA_VALUE)),await this._addListenRelay(nt,et))}catch(rt){this.onError(rt)}}_onPeerDisconnected(o){const et=o.detail.remotePeer.toString();this.listenRelays.has(et)&&this._removeListenRelay(et).catch(tt=>{log$E.error(tt)})}async _addListenRelay(o,$){try{if(this.listenRelays.size>=this.maxListeners)return;const j=await pipe(await this.components.peerStore.addressBook.get(o.remotePeer),tt=>sort(tt,this.addressSorter),async tt=>await all$1(tt));(await Promise.all(j.map(async tt=>{try{let rt=tt.multiaddr;return rt.getPeerId()==null&&(rt=rt.encapsulate(`/p2p/${o.remotePeer.toString()}`)),rt=rt.encapsulate("/p2p-circuit"),await this.components.transportManager.listen([rt]),!0}catch(rt){log$E.error("error listening on circuit address",rt),this.onError(rt)}return!1}))).includes(!0)&&this.listenRelays.add($)}catch(j){this.onError(j),this.listenRelays.delete($)}}async _removeListenRelay(o){this.listenRelays.delete(o)&&await this._listenOnAvailableHopRelays([o])}async _listenOnAvailableHopRelays(o=[]){if(this.listenRelays.size>=this.maxListeners)return;const $=[],j=await this.components.peerStore.all();for(const{id:et,metadata:tt}of j){const rt=et.toString();if(this.listenRelays.has(rt)||o.includes(rt))continue;const nt=tt.get(HOP_METADATA_KEY);if(nt==null||toString$a(nt)!==HOP_METADATA_VALUE)continue;const it=this.components.connectionManager.getConnections(et);if(it.length===0){$.push(et);continue}if(await this._addListenRelay(it[0],rt),this.listenRelays.size>=this.maxListeners)return}for(const et of $)if(await this._tryToListenOnRelay(et),this.listenRelays.size>=this.maxListeners)return;try{const et=await namespaceToCid(RELAY_RENDEZVOUS_NS);for await(const tt of this.components.contentRouting.findProviders(et)){if(tt.multiaddrs.length===0)continue;const rt=tt.id;if(!rt.equals(this.components.peerId)&&(await this.components.peerStore.addressBook.add(rt,tt.multiaddrs),await this._tryToListenOnRelay(rt),this.listenRelays.size>=this.maxListeners))return}}catch(et){this.onError(et)}}async _tryToListenOnRelay(o){try{const $=await this.components.connectionManager.openConnection(o);await this._addListenRelay($,o.toString())}catch($){log$E.error("Could not use %p as relay",o,$),this.onError($,`could not connect and listen on known hop relay ${o.toString()}`)}}}const log$D=logger$1("libp2p:relay");class Relay{constructor(o,$){var j;this.components=o,this.autoRelay=((j=$.autoRelay)==null?void 0:j.enabled)!==!1?new AutoRelay(o,{addressSorter:$.addressSorter,...$.autoRelay}):void 0,this.started=!1,this.init=$,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){this.init.hop.enabled!==!1&&this.init.advertise.enabled!==!1&&(this.timeout=src$1.setDelayedInterval(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){this.timeout!=null&&src$1.clearDelayedInterval(this.timeout),this.started=!1}async _advertiseService(){try{const o=await namespaceToCid(RELAY_RENDEZVOUS_NS);await this.components.contentRouting.provide(o)}catch(o){o.code===codes$2.ERR_NO_ROUTERS_AVAILABLE?(log$D.error("a content router, such as a DHT, must be provided in order to advertise the relay service",o),await this.stop()):log$D.error(o)}}}function isHighSurrogate$1(_){return _>=55296&&_<=56319}function isLowSurrogate$1(_){return _>=56320&&_<=57343}var truncate$2=function _(o,$,j){if(typeof $!="string")throw new Error("Input must be string");for(var et=$.length,tt=0,rt,nt,it=0;it<et;it+=1){if(rt=$.charCodeAt(it),nt=$[it],isHighSurrogate$1(rt)&&isLowSurrogate$1($.charCodeAt(it+1))&&(it+=1,nt+=$[it]),tt+=o(nt),tt===j)return $.slice(0,it+1);if(tt>j)return $.slice(0,it-nt.length+1)}return $};function isHighSurrogate(_){return _>=55296&&_<=56319}function isLowSurrogate(_){return _>=56320&&_<=57343}var browser$1=function _(o){if(typeof o!="string")throw new Error("Input must be string");for(var $=o.length,j=0,et=null,tt=null,rt=0;rt<$;rt++)et=o.charCodeAt(rt),isLowSurrogate(et)?tt!=null&&isHighSurrogate(tt)?j+=1:j+=3:et<=127?j+=1:et>=128&&et<=2047?j+=2:et>=2048&&et<=65535&&(j+=3),tt=et;return j},truncate$1=truncate$2,getLength=browser$1,browser=truncate$1.bind(null,getLength),truncate=browser,illegalRe=/[\/\?<>\\:\*\|"]/g,controlRe=/[\x00-\x1f\x80-\x9f]/g,reservedRe=/^\.+$/,windowsReservedRe=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,windowsTrailingRe=/[\. ]+$/;function sanitize(_,o){if(typeof _!="string")throw new Error("Input must be string");var $=_.replace(illegalRe,o).replace(controlRe,o).replace(reservedRe,o).replace(windowsReservedRe,o).replace(windowsTrailingRe,o);return truncate($,255)}var sanitizeFilename=function(_,o){var $=o&&o.replacement||"",j=sanitize(_,$);return $===""?j:sanitize(j,"")},forge$5=forge$s,asn1$2=forge$5.asn1,p7v=forge$5.pkcs7asn1=forge$5.pkcs7asn1||{};forge$5.pkcs7=forge$5.pkcs7||{};forge$5.pkcs7.asn1=p7v;var contentInfoValidator={name:"ContentInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};p7v.contentInfoValidator=contentInfoValidator;var encryptedContentInfoValidator={name:"EncryptedContentInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:asn1$2.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};p7v.envelopedDataValidator={name:"EnvelopedData",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(encryptedContentInfoValidator)};p7v.encryptedDataValidator={name:"EncryptedData",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"}].concat(encryptedContentInfoValidator)};var signerValidator={name:"SignerInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:asn1$2.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};p7v.signedDataValidator={name:"SignedData",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},contentInfoValidator,{name:"SignedData.Certificates",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SET,capture:"signerInfos",optional:!0,value:[signerValidator]}]};p7v.recipientInfoValidator={name:"RecipientInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:asn1$2.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var forge$4=forge$s;forge$4.mgf=forge$4.mgf||{};var mgf1=forge$4.mgf.mgf1=forge$4.mgf1=forge$4.mgf1||{};mgf1.create=function(_){var o={generate:function($,j){for(var et=new forge$4.util.ByteBuffer,tt=Math.ceil(j/_.digestLength),rt=0;rt<tt;rt++){var nt=new forge$4.util.ByteBuffer;nt.putInt32(rt),_.start(),_.update($+nt.getBytes()),et.putBuffer(_.digest())}return et.truncate(et.length()-j),et.getBytes()}};return o};var forge$3=forge$s;forge$3.mgf=forge$3.mgf||{};forge$3.mgf.mgf1=forge$3.mgf1;var forge$2=forge$s,pss=forge$2.pss=forge$2.pss||{};pss.create=function(_){arguments.length===3&&(_={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var o=_.md,$=_.mgf,j=o.digestLength,et=_.salt||null;typeof et=="string"&&(et=forge$2.util.createBuffer(et));var tt;if("saltLength"in _)tt=_.saltLength;else if(et!==null)tt=et.length();else throw new Error("Salt length not specified or specific salt not given.");if(et!==null&&et.length()!==tt)throw new Error("Given salt length does not match length of given salt.");var rt=_.prng||forge$2.random,nt={};return nt.encode=function(it,st){var ot,at=st-1,ct=Math.ceil(at/8),ut=it.digest().getBytes();if(ct<j+tt+2)throw new Error("Message is too long to encrypt.");var ft;et===null?ft=rt.getBytesSync(tt):ft=et.bytes();var ht=new forge$2.util.ByteBuffer;ht.fillWithByte(0,8),ht.putBytes(ut),ht.putBytes(ft),o.start(),o.update(ht.getBytes());var mt=o.digest().getBytes(),gt=new forge$2.util.ByteBuffer;gt.fillWithByte(0,ct-tt-j-2),gt.putByte(1),gt.putBytes(ft);var Et=gt.getBytes(),St=ct-j-1,At=$.generate(mt,St),kt="";for(ot=0;ot<St;ot++)kt+=String.fromCharCode(Et.charCodeAt(ot)^At.charCodeAt(ot));var Rt=65280>>8*ct-at&255;return kt=String.fromCharCode(kt.charCodeAt(0)&~Rt)+kt.substr(1),kt+mt+String.fromCharCode(188)},nt.verify=function(it,st,ot){var at,ct=ot-1,ut=Math.ceil(ct/8);if(st=st.substr(-ut),ut<j+tt+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(st.charCodeAt(ut-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var ft=ut-j-1,ht=st.substr(0,ft),mt=st.substr(ft,j),gt=65280>>8*ut-ct&255;if(ht.charCodeAt(0)&gt)throw new Error("Bits beyond keysize not zero as expected.");var Et=$.generate(mt,ft),St="";for(at=0;at<ft;at++)St+=String.fromCharCode(ht.charCodeAt(at)^Et.charCodeAt(at));St=String.fromCharCode(St.charCodeAt(0)&~gt)+St.substr(1);var At=ut-j-tt-2;for(at=0;at<At;at++)if(St.charCodeAt(at)!==0)throw new Error("Leftmost octets not zero as expected");if(St.charCodeAt(At)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var kt=St.substr(-tt),Rt=new forge$2.util.ByteBuffer;Rt.fillWithByte(0,8),Rt.putBytes(it),Rt.putBytes(kt),o.start(),o.update(Rt.getBytes());var Tt=o.digest().getBytes();return mt===Tt},nt};var forge$1=forge$s,asn1$1=forge$1.asn1,pki$1=forge$1.pki=forge$1.pki||{},oids=pki$1.oids,_shortNames={};_shortNames.CN=oids.commonName;_shortNames.commonName="CN";_shortNames.C=oids.countryName;_shortNames.countryName="C";_shortNames.L=oids.localityName;_shortNames.localityName="L";_shortNames.ST=oids.stateOrProvinceName;_shortNames.stateOrProvinceName="ST";_shortNames.O=oids.organizationName;_shortNames.organizationName="O";_shortNames.OU=oids.organizationalUnitName;_shortNames.organizationalUnitName="OU";_shortNames.E=oids.emailAddress;_shortNames.emailAddress="E";var publicKeyValidator=forge$1.pki.rsa.publicKeyValidator,x509CertificateValidator={name:"Certificate",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:asn1$1.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},publicKeyValidator,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:asn1$1.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},rsassaPssParameterValidator={name:"rsapss",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},certificationRequestInfoValidator={name:"CertificationRequestInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},publicKeyValidator,{name:"CertificationRequestInfo.attributes",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SET,constructed:!0}]}]}]},certificationRequestValidator={name:"CertificationRequest",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[certificationRequestInfoValidator,{name:"CertificationRequest.signatureAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:asn1$1.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};pki$1.RDNAttributesAsArray=function(_,o){for(var $=[],j,et,tt,rt=0;rt<_.value.length;++rt){j=_.value[rt];for(var nt=0;nt<j.value.length;++nt)tt={},et=j.value[nt],tt.type=asn1$1.derToOid(et.value[0].value),tt.value=et.value[1].value,tt.valueTagClass=et.value[1].type,tt.type in oids&&(tt.name=oids[tt.type],tt.name in _shortNames&&(tt.shortName=_shortNames[tt.name])),o&&(o.update(tt.type),o.update(tt.value)),$.push(tt)}return $};pki$1.CRIAttributesAsArray=function(_){for(var o=[],$=0;$<_.length;++$)for(var j=_[$],et=asn1$1.derToOid(j.value[0].value),tt=j.value[1].value,rt=0;rt<tt.length;++rt){var nt={};if(nt.type=et,nt.value=tt[rt].value,nt.valueTagClass=tt[rt].type,nt.type in oids&&(nt.name=oids[nt.type],nt.name in _shortNames&&(nt.shortName=_shortNames[nt.name])),nt.type===oids.extensionRequest){nt.extensions=[];for(var it=0;it<nt.value.length;++it)nt.extensions.push(pki$1.certificateExtensionFromAsn1(nt.value[it]))}o.push(nt)}return o};function _getAttribute(_,o){typeof o=="string"&&(o={shortName:o});for(var $=null,j,et=0;$===null&&et<_.attributes.length;++et)j=_.attributes[et],(o.type&&o.type===j.type||o.name&&o.name===j.name||o.shortName&&o.shortName===j.shortName)&&($=j);return $}var _readSignatureParameters=function(_,o,$){var j={};if(_!==oids["RSASSA-PSS"])return j;$&&(j={hash:{algorithmOid:oids.sha1},mgf:{algorithmOid:oids.mgf1,hash:{algorithmOid:oids.sha1}},saltLength:20});var et={},tt=[];if(!asn1$1.validate(o,rsassaPssParameterValidator,et,tt)){var rt=new Error("Cannot read RSASSA-PSS parameter block.");throw rt.errors=tt,rt}return et.hashOid!==void 0&&(j.hash=j.hash||{},j.hash.algorithmOid=asn1$1.derToOid(et.hashOid)),et.maskGenOid!==void 0&&(j.mgf=j.mgf||{},j.mgf.algorithmOid=asn1$1.derToOid(et.maskGenOid),j.mgf.hash=j.mgf.hash||{},j.mgf.hash.algorithmOid=asn1$1.derToOid(et.maskGenHashOid)),et.saltLength!==void 0&&(j.saltLength=et.saltLength.charCodeAt(0)),j},_createSignatureDigest=function(_){switch(oids[_.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return forge$1.md.sha1.create();case"md5WithRSAEncryption":return forge$1.md.md5.create();case"sha256WithRSAEncryption":return forge$1.md.sha256.create();case"sha384WithRSAEncryption":return forge$1.md.sha384.create();case"sha512WithRSAEncryption":return forge$1.md.sha512.create();case"RSASSA-PSS":return forge$1.md.sha256.create();default:var o=new Error("Could not compute "+_.type+" digest. Unknown signature OID.");throw o.signatureOid=_.signatureOid,o}},_verifySignature=function(_){var o=_.certificate,$;switch(o.signatureOid){case oids.sha1WithRSAEncryption:case oids.sha1WithRSASignature:break;case oids["RSASSA-PSS"]:var j,et;if(j=oids[o.signatureParameters.mgf.hash.algorithmOid],j===void 0||forge$1.md[j]===void 0){var tt=new Error("Unsupported MGF hash function.");throw tt.oid=o.signatureParameters.mgf.hash.algorithmOid,tt.name=j,tt}if(et=oids[o.signatureParameters.mgf.algorithmOid],et===void 0||forge$1.mgf[et]===void 0){var tt=new Error("Unsupported MGF function.");throw tt.oid=o.signatureParameters.mgf.algorithmOid,tt.name=et,tt}if(et=forge$1.mgf[et].create(forge$1.md[j].create()),j=oids[o.signatureParameters.hash.algorithmOid],j===void 0||forge$1.md[j]===void 0){var tt=new Error("Unsupported RSASSA-PSS hash function.");throw tt.oid=o.signatureParameters.hash.algorithmOid,tt.name=j,tt}$=forge$1.pss.create(forge$1.md[j].create(),et,o.signatureParameters.saltLength);break}return o.publicKey.verify(_.md.digest().getBytes(),_.signature,$)};pki$1.certificateFromPem=function(_,o,$){var j=forge$1.pem.decode(_)[0];if(j.type!=="CERTIFICATE"&&j.type!=="X509 CERTIFICATE"&&j.type!=="TRUSTED CERTIFICATE"){var et=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw et.headerType=j.type,et}if(j.procType&&j.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var tt=asn1$1.fromDer(j.body,$);return pki$1.certificateFromAsn1(tt,o)};pki$1.certificateToPem=function(_,o){var $={type:"CERTIFICATE",body:asn1$1.toDer(pki$1.certificateToAsn1(_)).getBytes()};return forge$1.pem.encode($,{maxline:o})};pki$1.publicKeyFromPem=function(_){var o=forge$1.pem.decode(_)[0];if(o.type!=="PUBLIC KEY"&&o.type!=="RSA PUBLIC KEY"){var $=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw $.headerType=o.type,$}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var j=asn1$1.fromDer(o.body);return pki$1.publicKeyFromAsn1(j)};pki$1.publicKeyToPem=function(_,o){var $={type:"PUBLIC KEY",body:asn1$1.toDer(pki$1.publicKeyToAsn1(_)).getBytes()};return forge$1.pem.encode($,{maxline:o})};pki$1.publicKeyToRSAPublicKeyPem=function(_,o){var $={type:"RSA PUBLIC KEY",body:asn1$1.toDer(pki$1.publicKeyToRSAPublicKey(_)).getBytes()};return forge$1.pem.encode($,{maxline:o})};pki$1.getPublicKeyFingerprint=function(_,o){o=o||{};var $=o.md||forge$1.md.sha1.create(),j=o.type||"RSAPublicKey",et;switch(j){case"RSAPublicKey":et=asn1$1.toDer(pki$1.publicKeyToRSAPublicKey(_)).getBytes();break;case"SubjectPublicKeyInfo":et=asn1$1.toDer(pki$1.publicKeyToAsn1(_)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+o.type+'".')}$.start(),$.update(et);var tt=$.digest();if(o.encoding==="hex"){var rt=tt.toHex();return o.delimiter?rt.match(/.{2}/g).join(o.delimiter):rt}else{if(o.encoding==="binary")return tt.getBytes();if(o.encoding)throw new Error('Unknown encoding "'+o.encoding+'".')}return tt};pki$1.certificationRequestFromPem=function(_,o,$){var j=forge$1.pem.decode(_)[0];if(j.type!=="CERTIFICATE REQUEST"){var et=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw et.headerType=j.type,et}if(j.procType&&j.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var tt=asn1$1.fromDer(j.body,$);return pki$1.certificationRequestFromAsn1(tt,o)};pki$1.certificationRequestToPem=function(_,o){var $={type:"CERTIFICATE REQUEST",body:asn1$1.toDer(pki$1.certificationRequestToAsn1(_)).getBytes()};return forge$1.pem.encode($,{maxline:o})};pki$1.createCertificate=function(){var _={};return _.version=2,_.serialNumber="00",_.signatureOid=null,_.signature=null,_.siginfo={},_.siginfo.algorithmOid=null,_.validity={},_.validity.notBefore=new Date,_.validity.notAfter=new Date,_.issuer={},_.issuer.getField=function(o){return _getAttribute(_.issuer,o)},_.issuer.addField=function(o){_fillMissingFields([o]),_.issuer.attributes.push(o)},_.issuer.attributes=[],_.issuer.hash=null,_.subject={},_.subject.getField=function(o){return _getAttribute(_.subject,o)},_.subject.addField=function(o){_fillMissingFields([o]),_.subject.attributes.push(o)},_.subject.attributes=[],_.subject.hash=null,_.extensions=[],_.publicKey=null,_.md=null,_.setSubject=function(o,$){_fillMissingFields(o),_.subject.attributes=o,delete _.subject.uniqueId,$&&(_.subject.uniqueId=$),_.subject.hash=null},_.setIssuer=function(o,$){_fillMissingFields(o),_.issuer.attributes=o,delete _.issuer.uniqueId,$&&(_.issuer.uniqueId=$),_.issuer.hash=null},_.setExtensions=function(o){for(var $=0;$<o.length;++$)_fillMissingExtensionFields(o[$],{cert:_});_.extensions=o},_.getExtension=function(o){typeof o=="string"&&(o={name:o});for(var $=null,j,et=0;$===null&&et<_.extensions.length;++et)j=_.extensions[et],(o.id&&j.id===o.id||o.name&&j.name===o.name)&&($=j);return $},_.sign=function(o,$){_.md=$||forge$1.md.sha1.create();var j=oids[_.md.algorithm+"WithRSAEncryption"];if(!j){var et=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw et.algorithm=_.md.algorithm,et}_.signatureOid=_.siginfo.algorithmOid=j,_.tbsCertificate=pki$1.getTBSCertificate(_);var tt=asn1$1.toDer(_.tbsCertificate);_.md.update(tt.getBytes()),_.signature=o.sign(_.md)},_.verify=function(o){var $=!1;if(!_.issued(o)){var j=o.issuer,et=_.subject,tt=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw tt.expectedIssuer=et.attributes,tt.actualIssuer=j.attributes,tt}var rt=o.md;if(rt===null){rt=_createSignatureDigest({signatureOid:o.signatureOid,type:"certificate"});var nt=o.tbsCertificate||pki$1.getTBSCertificate(o),it=asn1$1.toDer(nt);rt.update(it.getBytes())}return rt!==null&&($=_verifySignature({certificate:_,md:rt,signature:o.signature})),$},_.isIssuer=function(o){var $=!1,j=_.issuer,et=o.subject;if(j.hash&&et.hash)$=j.hash===et.hash;else if(j.attributes.length===et.attributes.length){$=!0;for(var tt,rt,nt=0;$&&nt<j.attributes.length;++nt)tt=j.attributes[nt],rt=et.attributes[nt],(tt.type!==rt.type||tt.value!==rt.value)&&($=!1)}return $},_.issued=function(o){return o.isIssuer(_)},_.generateSubjectKeyIdentifier=function(){return pki$1.getPublicKeyFingerprint(_.publicKey,{type:"RSAPublicKey"})},_.verifySubjectKeyIdentifier=function(){for(var o=oids.subjectKeyIdentifier,$=0;$<_.extensions.length;++$){var j=_.extensions[$];if(j.id===o){var et=_.generateSubjectKeyIdentifier().getBytes();return forge$1.util.hexToBytes(j.subjectKeyIdentifier)===et}}return!1},_};pki$1.certificateFromAsn1=function(_,o){var $={},j=[];if(!asn1$1.validate(_,x509CertificateValidator,$,j)){var et=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw et.errors=j,et}var tt=asn1$1.derToOid($.publicKeyOid);if(tt!==pki$1.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var rt=pki$1.createCertificate();rt.version=$.certVersion?$.certVersion.charCodeAt(0):0;var nt=forge$1.util.createBuffer($.certSerialNumber);rt.serialNumber=nt.toHex(),rt.signatureOid=forge$1.asn1.derToOid($.certSignatureOid),rt.signatureParameters=_readSignatureParameters(rt.signatureOid,$.certSignatureParams,!0),rt.siginfo.algorithmOid=forge$1.asn1.derToOid($.certinfoSignatureOid),rt.siginfo.parameters=_readSignatureParameters(rt.siginfo.algorithmOid,$.certinfoSignatureParams,!1),rt.signature=$.certSignature;var it=[];if($.certValidity1UTCTime!==void 0&&it.push(asn1$1.utcTimeToDate($.certValidity1UTCTime)),$.certValidity2GeneralizedTime!==void 0&&it.push(asn1$1.generalizedTimeToDate($.certValidity2GeneralizedTime)),$.certValidity3UTCTime!==void 0&&it.push(asn1$1.utcTimeToDate($.certValidity3UTCTime)),$.certValidity4GeneralizedTime!==void 0&&it.push(asn1$1.generalizedTimeToDate($.certValidity4GeneralizedTime)),it.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(it.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(rt.validity.notBefore=it[0],rt.validity.notAfter=it[1],rt.tbsCertificate=$.tbsCertificate,o){rt.md=_createSignatureDigest({signatureOid:rt.signatureOid,type:"certificate"});var st=asn1$1.toDer(rt.tbsCertificate);rt.md.update(st.getBytes())}var ot=forge$1.md.sha1.create(),at=asn1$1.toDer($.certIssuer);ot.update(at.getBytes()),rt.issuer.getField=function(ft){return _getAttribute(rt.issuer,ft)},rt.issuer.addField=function(ft){_fillMissingFields([ft]),rt.issuer.attributes.push(ft)},rt.issuer.attributes=pki$1.RDNAttributesAsArray($.certIssuer),$.certIssuerUniqueId&&(rt.issuer.uniqueId=$.certIssuerUniqueId),rt.issuer.hash=ot.digest().toHex();var ct=forge$1.md.sha1.create(),ut=asn1$1.toDer($.certSubject);return ct.update(ut.getBytes()),rt.subject.getField=function(ft){return _getAttribute(rt.subject,ft)},rt.subject.addField=function(ft){_fillMissingFields([ft]),rt.subject.attributes.push(ft)},rt.subject.attributes=pki$1.RDNAttributesAsArray($.certSubject),$.certSubjectUniqueId&&(rt.subject.uniqueId=$.certSubjectUniqueId),rt.subject.hash=ct.digest().toHex(),$.certExtensions?rt.extensions=pki$1.certificateExtensionsFromAsn1($.certExtensions):rt.extensions=[],rt.publicKey=pki$1.publicKeyFromAsn1($.subjectPublicKeyInfo),rt};pki$1.certificateExtensionsFromAsn1=function(_){for(var o=[],$=0;$<_.value.length;++$)for(var j=_.value[$],et=0;et<j.value.length;++et)o.push(pki$1.certificateExtensionFromAsn1(j.value[et]));return o};pki$1.certificateExtensionFromAsn1=function(_){var o={};if(o.id=asn1$1.derToOid(_.value[0].value),o.critical=!1,_.value[1].type===asn1$1.Type.BOOLEAN?(o.critical=_.value[1].value.charCodeAt(0)!==0,o.value=_.value[2].value):o.value=_.value[1].value,o.id in oids){if(o.name=oids[o.id],o.name==="keyUsage"){var $=asn1$1.fromDer(o.value),j=0,et=0;$.value.length>1&&(j=$.value.charCodeAt(1),et=$.value.length>2?$.value.charCodeAt(2):0),o.digitalSignature=(j&128)===128,o.nonRepudiation=(j&64)===64,o.keyEncipherment=(j&32)===32,o.dataEncipherment=(j&16)===16,o.keyAgreement=(j&8)===8,o.keyCertSign=(j&4)===4,o.cRLSign=(j&2)===2,o.encipherOnly=(j&1)===1,o.decipherOnly=(et&128)===128}else if(o.name==="basicConstraints"){var $=asn1$1.fromDer(o.value);$.value.length>0&&$.value[0].type===asn1$1.Type.BOOLEAN?o.cA=$.value[0].value.charCodeAt(0)!==0:o.cA=!1;var tt=null;$.value.length>0&&$.value[0].type===asn1$1.Type.INTEGER?tt=$.value[0].value:$.value.length>1&&(tt=$.value[1].value),tt!==null&&(o.pathLenConstraint=asn1$1.derToInteger(tt))}else if(o.name==="extKeyUsage")for(var $=asn1$1.fromDer(o.value),rt=0;rt<$.value.length;++rt){var nt=asn1$1.derToOid($.value[rt].value);nt in oids?o[oids[nt]]=!0:o[nt]=!0}else if(o.name==="nsCertType"){var $=asn1$1.fromDer(o.value),j=0;$.value.length>1&&(j=$.value.charCodeAt(1)),o.client=(j&128)===128,o.server=(j&64)===64,o.email=(j&32)===32,o.objsign=(j&16)===16,o.reserved=(j&8)===8,o.sslCA=(j&4)===4,o.emailCA=(j&2)===2,o.objCA=(j&1)===1}else if(o.name==="subjectAltName"||o.name==="issuerAltName"){o.altNames=[];for(var it,$=asn1$1.fromDer(o.value),st=0;st<$.value.length;++st){it=$.value[st];var ot={type:it.type,value:it.value};switch(o.altNames.push(ot),it.type){case 1:case 2:case 6:break;case 7:ot.ip=forge$1.util.bytesToIP(it.value);break;case 8:ot.oid=asn1$1.derToOid(it.value);break}}}else if(o.name==="subjectKeyIdentifier"){var $=asn1$1.fromDer(o.value);o.subjectKeyIdentifier=forge$1.util.bytesToHex($.value)}}return o};pki$1.certificationRequestFromAsn1=function(_,o){var $={},j=[];if(!asn1$1.validate(_,certificationRequestValidator,$,j)){var et=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw et.errors=j,et}var tt=asn1$1.derToOid($.publicKeyOid);if(tt!==pki$1.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var rt=pki$1.createCertificationRequest();if(rt.version=$.csrVersion?$.csrVersion.charCodeAt(0):0,rt.signatureOid=forge$1.asn1.derToOid($.csrSignatureOid),rt.signatureParameters=_readSignatureParameters(rt.signatureOid,$.csrSignatureParams,!0),rt.siginfo.algorithmOid=forge$1.asn1.derToOid($.csrSignatureOid),rt.siginfo.parameters=_readSignatureParameters(rt.siginfo.algorithmOid,$.csrSignatureParams,!1),rt.signature=$.csrSignature,rt.certificationRequestInfo=$.certificationRequestInfo,o){rt.md=_createSignatureDigest({signatureOid:rt.signatureOid,type:"certification request"});var nt=asn1$1.toDer(rt.certificationRequestInfo);rt.md.update(nt.getBytes())}var it=forge$1.md.sha1.create();return rt.subject.getField=function(st){return _getAttribute(rt.subject,st)},rt.subject.addField=function(st){_fillMissingFields([st]),rt.subject.attributes.push(st)},rt.subject.attributes=pki$1.RDNAttributesAsArray($.certificationRequestInfoSubject,it),rt.subject.hash=it.digest().toHex(),rt.publicKey=pki$1.publicKeyFromAsn1($.subjectPublicKeyInfo),rt.getAttribute=function(st){return _getAttribute(rt,st)},rt.addAttribute=function(st){_fillMissingFields([st]),rt.attributes.push(st)},rt.attributes=pki$1.CRIAttributesAsArray($.certificationRequestInfoAttributes||[]),rt};pki$1.createCertificationRequest=function(){var _={};return _.version=0,_.signatureOid=null,_.signature=null,_.siginfo={},_.siginfo.algorithmOid=null,_.subject={},_.subject.getField=function(o){return _getAttribute(_.subject,o)},_.subject.addField=function(o){_fillMissingFields([o]),_.subject.attributes.push(o)},_.subject.attributes=[],_.subject.hash=null,_.publicKey=null,_.attributes=[],_.getAttribute=function(o){return _getAttribute(_,o)},_.addAttribute=function(o){_fillMissingFields([o]),_.attributes.push(o)},_.md=null,_.setSubject=function(o){_fillMissingFields(o),_.subject.attributes=o,_.subject.hash=null},_.setAttributes=function(o){_fillMissingFields(o),_.attributes=o},_.sign=function(o,$){_.md=$||forge$1.md.sha1.create();var j=oids[_.md.algorithm+"WithRSAEncryption"];if(!j){var et=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw et.algorithm=_.md.algorithm,et}_.signatureOid=_.siginfo.algorithmOid=j,_.certificationRequestInfo=pki$1.getCertificationRequestInfo(_);var tt=asn1$1.toDer(_.certificationRequestInfo);_.md.update(tt.getBytes()),_.signature=o.sign(_.md)},_.verify=function(){var o=!1,$=_.md;if($===null){$=_createSignatureDigest({signatureOid:_.signatureOid,type:"certification request"});var j=_.certificationRequestInfo||pki$1.getCertificationRequestInfo(_),et=asn1$1.toDer(j);$.update(et.getBytes())}return $!==null&&(o=_verifySignature({certificate:_,md:$,signature:_.signature})),o},_};function _dnToAsn1(_){for(var o=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),$,j,et=_.attributes,tt=0;tt<et.length;++tt){$=et[tt];var rt=$.value,nt=asn1$1.Type.PRINTABLESTRING;"valueTagClass"in $&&(nt=$.valueTagClass,nt===asn1$1.Type.UTF8&&(rt=forge$1.util.encodeUtf8(rt))),j=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SET,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer($.type).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,nt,!1,rt)])]),o.value.push(j)}return o}function _fillMissingFields(_){for(var o,$=0;$<_.length;++$){if(o=_[$],typeof o.name>"u"&&(o.type&&o.type in pki$1.oids?o.name=pki$1.oids[o.type]:o.shortName&&o.shortName in _shortNames&&(o.name=pki$1.oids[_shortNames[o.shortName]])),typeof o.type>"u")if(o.name&&o.name in pki$1.oids)o.type=pki$1.oids[o.name];else{var j=new Error("Attribute type not specified.");throw j.attribute=o,j}if(typeof o.shortName>"u"&&o.name&&o.name in _shortNames&&(o.shortName=_shortNames[o.name]),o.type===oids.extensionRequest&&(o.valueConstructed=!0,o.valueTagClass=asn1$1.Type.SEQUENCE,!o.value&&o.extensions)){o.value=[];for(var et=0;et<o.extensions.length;++et)o.value.push(pki$1.certificateExtensionToAsn1(_fillMissingExtensionFields(o.extensions[et])))}if(typeof o.value>"u"){var j=new Error("Attribute value not specified.");throw j.attribute=o,j}}}function _fillMissingExtensionFields(_,o){if(o=o||{},typeof _.name>"u"&&_.id&&_.id in pki$1.oids&&(_.name=pki$1.oids[_.id]),typeof _.id>"u")if(_.name&&_.name in pki$1.oids)_.id=pki$1.oids[_.name];else{var $=new Error("Extension ID not specified.");throw $.extension=_,$}if(typeof _.value<"u")return _;if(_.name==="keyUsage"){var j=0,et=0,tt=0;_.digitalSignature&&(et|=128,j=7),_.nonRepudiation&&(et|=64,j=6),_.keyEncipherment&&(et|=32,j=5),_.dataEncipherment&&(et|=16,j=4),_.keyAgreement&&(et|=8,j=3),_.keyCertSign&&(et|=4,j=2),_.cRLSign&&(et|=2,j=1),_.encipherOnly&&(et|=1,j=0),_.decipherOnly&&(tt|=128,j=7);var rt=String.fromCharCode(j);tt!==0?rt+=String.fromCharCode(et)+String.fromCharCode(tt):et!==0&&(rt+=String.fromCharCode(et)),_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,rt)}else if(_.name==="basicConstraints")_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),_.cA&&_.value.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in _&&_.value.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(_.pathLenConstraint).getBytes()));else if(_.name==="extKeyUsage"){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);var nt=_.value.value;for(var it in _)_[it]===!0&&(it in oids?nt.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(oids[it]).getBytes())):it.indexOf(".")!==-1&&nt.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(it).getBytes())))}else if(_.name==="nsCertType"){var j=0,et=0;_.client&&(et|=128,j=7),_.server&&(et|=64,j=6),_.email&&(et|=32,j=5),_.objsign&&(et|=16,j=4),_.reserved&&(et|=8,j=3),_.sslCA&&(et|=4,j=2),_.emailCA&&(et|=2,j=1),_.objCA&&(et|=1,j=0);var rt=String.fromCharCode(j);et!==0&&(rt+=String.fromCharCode(et)),_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,rt)}else if(_.name==="subjectAltName"||_.name==="issuerAltName"){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);for(var st,ot=0;ot<_.altNames.length;++ot){st=_.altNames[ot];var rt=st.value;if(st.type===7&&st.ip){if(rt=forge$1.util.bytesFromIP(st.ip),rt===null){var $=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw $.extension=_,$}}else st.type===8&&(st.oid?rt=asn1$1.oidToDer(asn1$1.oidToDer(st.oid)):rt=asn1$1.oidToDer(rt));_.value.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,st.type,!1,rt))}}else if(_.name==="nsComment"&&o.cert){if(!/^[\x00-\x7F]*$/.test(_.comment)||_.comment.length<1||_.comment.length>128)throw new Error('Invalid "nsComment" content.');_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.IA5STRING,!1,_.comment)}else if(_.name==="subjectKeyIdentifier"&&o.cert){var at=o.cert.generateSubjectKeyIdentifier();_.subjectKeyIdentifier=at.toHex(),_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,at.getBytes())}else if(_.name==="authorityKeyIdentifier"&&o.cert){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);var nt=_.value.value;if(_.keyIdentifier){var ct=_.keyIdentifier===!0?o.cert.generateSubjectKeyIdentifier().getBytes():_.keyIdentifier;nt.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!1,ct))}if(_.authorityCertIssuer){var ut=[asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,4,!0,[_dnToAsn1(_.authorityCertIssuer===!0?o.cert.issuer:_.authorityCertIssuer)])];nt.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,1,!0,ut))}if(_.serialNumber){var ft=forge$1.util.hexToBytes(_.serialNumber===!0?o.cert.serialNumber:_.serialNumber);nt.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,2,!1,ft))}}else if(_.name==="cRLDistributionPoints"){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);for(var nt=_.value.value,ht=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),mt=asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[]),st,ot=0;ot<_.altNames.length;++ot){st=_.altNames[ot];var rt=st.value;if(st.type===7&&st.ip){if(rt=forge$1.util.bytesFromIP(st.ip),rt===null){var $=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw $.extension=_,$}}else st.type===8&&(st.oid?rt=asn1$1.oidToDer(asn1$1.oidToDer(st.oid)):rt=asn1$1.oidToDer(rt));mt.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,st.type,!1,rt))}ht.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[mt])),nt.push(ht)}if(typeof _.value>"u"){var $=new Error("Extension value not specified.");throw $.extension=_,$}return _}function _signatureParametersToAsn1(_,o){switch(_){case oids["RSASSA-PSS"]:var $=[];return o.hash.algorithmOid!==void 0&&$.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(o.hash.algorithmOid).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")])])),o.mgf.algorithmOid!==void 0&&$.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,1,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(o.mgf.algorithmOid).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(o.mgf.hash.algorithmOid).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")])])])),o.saltLength!==void 0&&$.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,2,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(o.saltLength).getBytes())])),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,$);default:return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")}}function _CRIAttributesToAsn1(_){var o=asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[]);if(_.attributes.length===0)return o;for(var $=_.attributes,j=0;j<$.length;++j){var et=$[j],tt=et.value,rt=asn1$1.Type.UTF8;"valueTagClass"in et&&(rt=et.valueTagClass),rt===asn1$1.Type.UTF8&&(tt=forge$1.util.encodeUtf8(tt));var nt=!1;"valueConstructed"in et&&(nt=et.valueConstructed);var it=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(et.type).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SET,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,rt,nt,tt)])]);o.value.push(it)}return o}var jan_1_1950=new Date("1950-01-01T00:00:00Z"),jan_1_2050=new Date("2050-01-01T00:00:00Z");function _dateToAsn1(_){return _>=jan_1_1950&&_<jan_1_2050?asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.UTCTIME,!1,asn1$1.dateToUtcTime(_)):asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.GENERALIZEDTIME,!1,asn1$1.dateToGeneralizedTime(_))}pki$1.getTBSCertificate=function(_){var o=_dateToAsn1(_.validity.notBefore),$=_dateToAsn1(_.validity.notAfter),j=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(_.version).getBytes())]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,forge$1.util.hexToBytes(_.serialNumber)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.siginfo.algorithmOid).getBytes()),_signatureParametersToAsn1(_.siginfo.algorithmOid,_.siginfo.parameters)]),_dnToAsn1(_.issuer),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[o,$]),_dnToAsn1(_.subject),pki$1.publicKeyToAsn1(_.publicKey)]);return _.issuer.uniqueId&&j.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,1,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.issuer.uniqueId)])),_.subject.uniqueId&&j.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,2,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.subject.uniqueId)])),_.extensions.length>0&&j.value.push(pki$1.certificateExtensionsToAsn1(_.extensions)),j};pki$1.getCertificationRequestInfo=function(_){var o=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(_.version).getBytes()),_dnToAsn1(_.subject),pki$1.publicKeyToAsn1(_.publicKey),_CRIAttributesToAsn1(_)]);return o};pki$1.distinguishedNameToAsn1=function(_){return _dnToAsn1(_)};pki$1.certificateToAsn1=function(_){var o=_.tbsCertificate||pki$1.getTBSCertificate(_);return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[o,asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.signatureOid).getBytes()),_signatureParametersToAsn1(_.signatureOid,_.signatureParameters)]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.signature)])};pki$1.certificateExtensionsToAsn1=function(_){var o=asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,3,!0,[]),$=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);o.value.push($);for(var j=0;j<_.length;++j)$.value.push(pki$1.certificateExtensionToAsn1(_[j]));return o};pki$1.certificateExtensionToAsn1=function(_){var o=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);o.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.id).getBytes())),_.critical&&o.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BOOLEAN,!1,String.fromCharCode(255)));var $=_.value;return typeof _.value!="string"&&($=asn1$1.toDer($).getBytes()),o.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,$)),o};pki$1.certificationRequestToAsn1=function(_){var o=_.certificationRequestInfo||pki$1.getCertificationRequestInfo(_);return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[o,asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.signatureOid).getBytes()),_signatureParametersToAsn1(_.signatureOid,_.signatureParameters)]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.signature)])};pki$1.createCaStore=function(_){var o={certs:{}};o.getIssuer=function(rt){var nt=$(rt.issuer);return nt},o.addCertificate=function(rt){if(typeof rt=="string"&&(rt=forge$1.pki.certificateFromPem(rt)),j(rt.subject),!o.hasCertificate(rt))if(rt.subject.hash in o.certs){var nt=o.certs[rt.subject.hash];forge$1.util.isArray(nt)||(nt=[nt]),nt.push(rt),o.certs[rt.subject.hash]=nt}else o.certs[rt.subject.hash]=rt},o.hasCertificate=function(rt){typeof rt=="string"&&(rt=forge$1.pki.certificateFromPem(rt));var nt=$(rt.subject);if(!nt)return!1;forge$1.util.isArray(nt)||(nt=[nt]);for(var it=asn1$1.toDer(pki$1.certificateToAsn1(rt)).getBytes(),st=0;st<nt.length;++st){var ot=asn1$1.toDer(pki$1.certificateToAsn1(nt[st])).getBytes();if(it===ot)return!0}return!1},o.listAllCertificates=function(){var rt=[];for(var nt in o.certs)if(o.certs.hasOwnProperty(nt)){var it=o.certs[nt];if(!forge$1.util.isArray(it))rt.push(it);else for(var st=0;st<it.length;++st)rt.push(it[st])}return rt},o.removeCertificate=function(rt){var nt;if(typeof rt=="string"&&(rt=forge$1.pki.certificateFromPem(rt)),j(rt.subject),!o.hasCertificate(rt))return null;var it=$(rt.subject);if(!forge$1.util.isArray(it))return nt=o.certs[rt.subject.hash],delete o.certs[rt.subject.hash],nt;for(var st=asn1$1.toDer(pki$1.certificateToAsn1(rt)).getBytes(),ot=0;ot<it.length;++ot){var at=asn1$1.toDer(pki$1.certificateToAsn1(it[ot])).getBytes();st===at&&(nt=it[ot],it.splice(ot,1))}return it.length===0&&delete o.certs[rt.subject.hash],nt};function $(rt){return j(rt),o.certs[rt.hash]||null}function j(rt){if(!rt.hash){var nt=forge$1.md.sha1.create();rt.attributes=pki$1.RDNAttributesAsArray(_dnToAsn1(rt),nt),rt.hash=nt.digest().toHex()}}if(_)for(var et=0;et<_.length;++et){var tt=_[et];o.addCertificate(tt)}return o};pki$1.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};pki$1.verifyCertificateChain=function(_,o,$){typeof $=="function"&&($={verify:$}),$=$||{},o=o.slice(0);var j=o.slice(0),et=$.validityCheckDate;typeof et>"u"&&(et=new Date);var tt=!0,rt=null,nt=0;do{var it=o.shift(),st=null,ot=!1;if(et&&(et<it.validity.notBefore||et>it.validity.notAfter)&&(rt={message:"Certificate is not valid yet or has expired.",error:pki$1.certificateError.certificate_expired,notBefore:it.validity.notBefore,notAfter:it.validity.notAfter,now:et}),rt===null){if(st=o[0]||_.getIssuer(it),st===null&&it.isIssuer(it)&&(ot=!0,st=it),st){var at=st;forge$1.util.isArray(at)||(at=[at]);for(var ct=!1;!ct&&at.length>0;){st=at.shift();try{ct=st.verify(it)}catch{}}ct||(rt={message:"Certificate signature is invalid.",error:pki$1.certificateError.bad_certificate})}rt===null&&(!st||ot)&&!_.hasCertificate(it)&&(rt={message:"Certificate is not trusted.",error:pki$1.certificateError.unknown_ca})}if(rt===null&&st&&!it.isIssuer(st)&&(rt={message:"Certificate issuer is invalid.",error:pki$1.certificateError.bad_certificate}),rt===null)for(var ut={keyUsage:!0,basicConstraints:!0},ft=0;rt===null&&ft<it.extensions.length;++ft){var ht=it.extensions[ft];ht.critical&&!(ht.name in ut)&&(rt={message:"Certificate has an unsupported critical extension.",error:pki$1.certificateError.unsupported_certificate})}if(rt===null&&(!tt||o.length===0&&(!st||ot))){var mt=it.getExtension("basicConstraints"),gt=it.getExtension("keyUsage");if(gt!==null&&(!gt.keyCertSign||mt===null)&&(rt={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:pki$1.certificateError.bad_certificate}),rt===null&&mt!==null&&!mt.cA&&(rt={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:pki$1.certificateError.bad_certificate}),rt===null&&gt!==null&&"pathLenConstraint"in mt){var Et=nt-1;Et>mt.pathLenConstraint&&(rt={message:"Certificate basicConstraints pathLenConstraint violated.",error:pki$1.certificateError.bad_certificate})}}var St=rt===null?!0:rt.error,At=$.verify?$.verify(St,nt,j):St;if(At===!0)rt=null;else throw St===!0&&(rt={message:"The application rejected the certificate.",error:pki$1.certificateError.bad_certificate}),(At||At===0)&&(typeof At=="object"&&!forge$1.util.isArray(At)?(At.message&&(rt.message=At.message),At.error&&(rt.error=At.error)):typeof At=="string"&&(rt.error=At)),rt;tt=!1,++nt}while(o.length>0);return!0};var forge=forge$s,asn1=forge.asn1,p7=forge.pkcs7=forge.pkcs7||{};p7.messageFromPem=function(_){var o=forge.pem.decode(_)[0];if(o.type!=="PKCS7"){var $=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw $.headerType=o.type,$}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var j=asn1.fromDer(o.body);return p7.messageFromAsn1(j)};p7.messageToPem=function(_,o){var $={type:"PKCS7",body:asn1.toDer(_.toAsn1()).getBytes()};return forge.pem.encode($,{maxline:o})};p7.messageFromAsn1=function(_){var o={},$=[];if(!asn1.validate(_,p7.asn1.contentInfoValidator,o,$)){var j=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw j.errors=$,j}var et=asn1.derToOid(o.contentType),tt;switch(et){case forge.pki.oids.envelopedData:tt=p7.createEnvelopedData();break;case forge.pki.oids.encryptedData:tt=p7.createEncryptedData();break;case forge.pki.oids.signedData:tt=p7.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+et+" is not (yet) supported.")}return tt.fromAsn1(o.content.value[0]),tt};p7.createSignedData=function(){var _=null;return _={type:forge.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(j){if(_fromAsn1(_,j,p7.asn1.signedDataValidator),_.certificates=[],_.crls=[],_.digestAlgorithmIdentifiers=[],_.contentInfo=null,_.signerInfos=[],_.rawCapture.certificates)for(var et=_.rawCapture.certificates.value,tt=0;tt<et.length;++tt)_.certificates.push(forge.pki.certificateFromAsn1(et[tt]))},toAsn1:function(){_.contentInfo||_.sign();for(var j=[],et=0;et<_.certificates.length;++et)j.push(forge.pki.certificateToAsn1(_.certificates[et]));var tt=[],rt=asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,_.digestAlgorithmIdentifiers),_.contentInfo])]);return j.length>0&&rt.value[0].value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,j)),tt.length>0&&rt.value[0].value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,1,!0,tt)),rt.value[0].value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,_.signerInfos)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.type).getBytes()),rt])},addSigner:function(j){var et=j.issuer,tt=j.serialNumber;if(j.certificate){var rt=j.certificate;typeof rt=="string"&&(rt=forge.pki.certificateFromPem(rt)),et=rt.issuer.attributes,tt=rt.serialNumber}var nt=j.key;if(!nt)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof nt=="string"&&(nt=forge.pki.privateKeyFromPem(nt));var it=j.digestAlgorithm||forge.pki.oids.sha1;switch(it){case forge.pki.oids.sha1:case forge.pki.oids.sha256:case forge.pki.oids.sha384:case forge.pki.oids.sha512:case forge.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+it)}var st=j.authenticatedAttributes||[];if(st.length>0){for(var ot=!1,at=!1,ct=0;ct<st.length;++ct){var ut=st[ct];if(!ot&&ut.type===forge.pki.oids.contentType){if(ot=!0,at)break;continue}if(!at&&ut.type===forge.pki.oids.messageDigest){if(at=!0,ot)break;continue}}if(!ot||!at)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}_.signers.push({key:nt,version:1,issuer:et,serialNumber:tt,digestAlgorithm:it,signatureAlgorithm:forge.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:st,unauthenticatedAttributes:[]})},sign:function(j){if(j=j||{},(typeof _.content!="object"||_.contentInfo===null)&&(_.contentInfo=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(forge.pki.oids.data).getBytes())]),"content"in _)){var et;_.content instanceof forge.util.ByteBuffer?et=_.content.bytes():typeof _.content=="string"&&(et=forge.util.encodeUtf8(_.content)),j.detached?_.detachedContent=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,et):_.contentInfo.value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,et)]))}if(_.signers.length!==0){var tt=o();$(tt)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(j){typeof j=="string"&&(j=forge.pki.certificateFromPem(j)),_.certificates.push(j)},addCertificateRevokationList:function(j){throw new Error("PKCS#7 CRL support not yet implemented.")}},_;function o(){for(var j={},et=0;et<_.signers.length;++et){var tt=_.signers[et],rt=tt.digestAlgorithm;rt in j||(j[rt]=forge.md[forge.pki.oids[rt]].create()),tt.authenticatedAttributes.length===0?tt.md=j[rt]:tt.md=forge.md[forge.pki.oids[rt]].create()}_.digestAlgorithmIdentifiers=[];for(var rt in j)_.digestAlgorithmIdentifiers.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(rt).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]));return j}function $(j){var et;if(_.detachedContent?et=_.detachedContent:(et=_.contentInfo.value[1],et=et.value[0]),!et)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var tt=asn1.derToOid(_.contentInfo.value[0].value),rt=asn1.toDer(et);rt.getByte(),asn1.getBerValueLength(rt),rt=rt.getBytes();for(var nt in j)j[nt].start().update(rt);for(var it=new Date,st=0;st<_.signers.length;++st){var ot=_.signers[st];if(ot.authenticatedAttributes.length===0){if(tt!==forge.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{ot.authenticatedAttributesAsn1=asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var at=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[]),ct=0;ct<ot.authenticatedAttributes.length;++ct){var ut=ot.authenticatedAttributes[ct];ut.type===forge.pki.oids.messageDigest?ut.value=j[ot.digestAlgorithm].digest():ut.type===forge.pki.oids.signingTime&&(ut.value||(ut.value=it)),at.value.push(_attributeToAsn1(ut)),ot.authenticatedAttributesAsn1.value.push(_attributeToAsn1(ut))}rt=asn1.toDer(at).getBytes(),ot.md.start().update(rt)}ot.signature=ot.key.sign(ot.md,"RSASSA-PKCS1-V1_5")}_.signerInfos=_signersToAsn1(_.signers)}};p7.createEncryptedData=function(){var _=null;return _={type:forge.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:forge.pki.oids["aes256-CBC"]},fromAsn1:function(o){_fromAsn1(_,o,p7.asn1.encryptedDataValidator)},decrypt:function(o){o!==void 0&&(_.encryptedContent.key=o),_decryptContent(_)}},_};p7.createEnvelopedData=function(){var _=null;return _={type:forge.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:forge.pki.oids["aes256-CBC"]},fromAsn1:function(o){var $=_fromAsn1(_,o,p7.asn1.envelopedDataValidator);_.recipients=_recipientsFromAsn1($.recipientInfos.value)},toAsn1:function(){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.type).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,_recipientsToAsn1(_.recipients)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,_encryptedContentToAsn1(_.encryptedContent))])])])},findRecipient:function(o){for(var $=o.issuer.attributes,j=0;j<_.recipients.length;++j){var et=_.recipients[j],tt=et.issuer;if(et.serialNumber===o.serialNumber&&tt.length===$.length){for(var rt=!0,nt=0;nt<$.length;++nt)if(tt[nt].type!==$[nt].type||tt[nt].value!==$[nt].value){rt=!1;break}if(rt)return et}}return null},decrypt:function(o,$){if(_.encryptedContent.key===void 0&&o!==void 0&&$!==void 0)switch(o.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:case forge.pki.oids.desCBC:var j=$.decrypt(o.encryptedContent.content);_.encryptedContent.key=forge.util.createBuffer(j);break;default:throw new Error("Unsupported asymmetric cipher, OID "+o.encryptedContent.algorithm)}_decryptContent(_)},addRecipient:function(o){_.recipients.push({version:0,issuer:o.issuer.attributes,serialNumber:o.serialNumber,encryptedContent:{algorithm:forge.pki.oids.rsaEncryption,key:o.publicKey}})},encrypt:function(o,$){if(_.encryptedContent.content===void 0){$=$||_.encryptedContent.algorithm,o=o||_.encryptedContent.key;var j,et,tt;switch($){case forge.pki.oids["aes128-CBC"]:j=16,et=16,tt=forge.aes.createEncryptionCipher;break;case forge.pki.oids["aes192-CBC"]:j=24,et=16,tt=forge.aes.createEncryptionCipher;break;case forge.pki.oids["aes256-CBC"]:j=32,et=16,tt=forge.aes.createEncryptionCipher;break;case forge.pki.oids["des-EDE3-CBC"]:j=24,et=8,tt=forge.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+$)}if(o===void 0)o=forge.util.createBuffer(forge.random.getBytes(j));else if(o.length()!=j)throw new Error("Symmetric key has wrong length; got "+o.length()+" bytes, expected "+j+".");_.encryptedContent.algorithm=$,_.encryptedContent.key=o,_.encryptedContent.parameter=forge.util.createBuffer(forge.random.getBytes(et));var rt=tt(o);if(rt.start(_.encryptedContent.parameter.copy()),rt.update(_.content),!rt.finish())throw new Error("Symmetric encryption failed.");_.encryptedContent.content=rt.output}for(var nt=0;nt<_.recipients.length;++nt){var it=_.recipients[nt];if(it.encryptedContent.content===void 0)switch(it.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:it.encryptedContent.content=it.encryptedContent.key.encrypt(_.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+it.encryptedContent.algorithm)}}}},_};function _recipientFromAsn1(_){var o={},$=[];if(!asn1.validate(_,p7.asn1.recipientInfoValidator,o,$)){var j=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw j.errors=$,j}return{version:o.version.charCodeAt(0),issuer:forge.pki.RDNAttributesAsArray(o.issuer),serialNumber:forge.util.createBuffer(o.serial).toHex(),encryptedContent:{algorithm:asn1.derToOid(o.encAlgorithm),parameter:o.encParameter?o.encParameter.value:void 0,content:o.encKey}}}function _recipientToAsn1(_){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[forge.pki.distinguishedNameToAsn1({attributes:_.issuer}),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge.util.hexToBytes(_.serialNumber))]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.encryptedContent.algorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.encryptedContent.content)])}function _recipientsFromAsn1(_){for(var o=[],$=0;$<_.length;++$)o.push(_recipientFromAsn1(_[$]));return o}function _recipientsToAsn1(_){for(var o=[],$=0;$<_.length;++$)o.push(_recipientToAsn1(_[$]));return o}function _signerToAsn1(_){var o=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[forge.pki.distinguishedNameToAsn1({attributes:_.issuer}),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge.util.hexToBytes(_.serialNumber))]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.digestAlgorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])]);if(_.authenticatedAttributesAsn1&&o.value.push(_.authenticatedAttributesAsn1),o.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.signatureAlgorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])),o.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.signature)),_.unauthenticatedAttributes.length>0){for(var $=asn1.create(asn1.Class.CONTEXT_SPECIFIC,1,!0,[]),j=0;j<_.unauthenticatedAttributes.length;++j){var et=_.unauthenticatedAttributes[j];$.values.push(_attributeToAsn1(et))}o.value.push($)}return o}function _signersToAsn1(_){for(var o=[],$=0;$<_.length;++$)o.push(_signerToAsn1(_[$]));return o}function _attributeToAsn1(_){var o;if(_.type===forge.pki.oids.contentType)o=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.value).getBytes());else if(_.type===forge.pki.oids.messageDigest)o=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.value.bytes());else if(_.type===forge.pki.oids.signingTime){var $=new Date("1950-01-01T00:00:00Z"),j=new Date("2050-01-01T00:00:00Z"),et=_.value;if(typeof et=="string"){var tt=Date.parse(et);isNaN(tt)?et.length===13?et=asn1.utcTimeToDate(et):et=asn1.generalizedTimeToDate(et):et=new Date(tt)}et>=$&&et<j?o=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.UTCTIME,!1,asn1.dateToUtcTime(et)):o=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.GENERALIZEDTIME,!1,asn1.dateToGeneralizedTime(et))}return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.type).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[o])])}function _encryptedContentToAsn1(_){return[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(forge.pki.oids.data).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.algorithm).getBytes()),_.parameter?asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.parameter.getBytes()):void 0]),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.content.getBytes())])]}function _fromAsn1(_,o,$){var j={},et=[];if(!asn1.validate(o,$,j,et)){var tt=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw tt.errors=tt,tt}var rt=asn1.derToOid(j.contentType);if(rt!==forge.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(j.encryptedContent){var nt="";if(forge.util.isArray(j.encryptedContent))for(var it=0;it<j.encryptedContent.length;++it){if(j.encryptedContent[it].type!==asn1.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");nt+=j.encryptedContent[it].value}else nt=j.encryptedContent;_.encryptedContent={algorithm:asn1.derToOid(j.encAlgorithm),parameter:forge.util.createBuffer(j.encParameter.value),content:forge.util.createBuffer(nt)}}if(j.content){var nt="";if(forge.util.isArray(j.content))for(var it=0;it<j.content.length;++it){if(j.content[it].type!==asn1.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");nt+=j.content[it].value}else nt=j.content;_.content=forge.util.createBuffer(nt)}return _.version=j.version.charCodeAt(0),_.rawCapture=j,j}function _decryptContent(_){if(_.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(_.content===void 0){var o;switch(_.encryptedContent.algorithm){case forge.pki.oids["aes128-CBC"]:case forge.pki.oids["aes192-CBC"]:case forge.pki.oids["aes256-CBC"]:o=forge.aes.createDecryptionCipher(_.encryptedContent.key);break;case forge.pki.oids.desCBC:case forge.pki.oids["des-EDE3-CBC"]:o=forge.des.createDecryptionCipher(_.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+_.encryptedContent.algorithm)}if(o.start(_.encryptedContent.parameter),o.update(_.encryptedContent.content),!o.finish())throw new Error("Symmetric decryption failed.");_.content=o.output}}const pki=forge$s.pki,certificateForKey=(_,o)=>{const $=pki.rsa.setPublicKey(o.n,o.e),j=pki.createCertificate();j.publicKey=$,j.serialNumber="01",j.validity.notBefore=new Date,j.validity.notAfter=new Date,j.validity.notAfter.setFullYear(j.validity.notBefore.getFullYear()+10);const et=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:_.id}];return j.setSubject(et),j.setIssuer(et),j.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),j.sign(o),j};async function findAsync(_,o){const $=_.map(o),et=(await Promise.all($)).findIndex(tt=>tt);return _[et]}const log$C=logger$1("libp2p:keychain:cms"),privates$1=new WeakMap;class CMS{constructor(o,$){if(o==null)throw errCode(new Error("keychain is required"),codes$2.ERR_KEYCHAIN_REQUIRED);this.keychain=o,privates$1.set(this,{dek:$})}async encrypt(o,$){if(!($ instanceof Uint8Array))throw errCode(new Error("Plain data must be a Uint8Array"),codes$2.ERR_INVALID_PARAMETERS);const j=await this.keychain.findKeyByName(o),et=await this.keychain.getPrivateKey(o),tt=privates$1.get(this);if(tt==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const rt=tt.dek,nt=forge$s.pki.decryptRsaPrivateKey(et,rt),it=await certificateForKey(j,nt),st=forge$s.pkcs7.createEnvelopedData();st.addRecipient(it),st.content=forge$s.util.createBuffer($),st.encrypt();const ot=forge$s.asn1.toDer(st.toAsn1()).getBytes();return fromString$8(ot,"ascii")}async decrypt(o){if(!(o instanceof Uint8Array))throw errCode(new Error("CMS data is required"),codes$2.ERR_INVALID_PARAMETERS);let $;try{const ot=forge$s.util.createBuffer(toString$a(o,"ascii")),at=forge$s.asn1.fromDer(ot);$=forge$s.pkcs7.messageFromAsn1(at)}catch(ot){throw log$C.error(ot),errCode(new Error("Invalid CMS"),codes$2.ERR_INVALID_CMS)}const j=$.recipients.filter(ot=>ot.issuer.find(at=>at.shortName==="O"&&at.value==="ipfs")).filter(ot=>ot.issuer.find(at=>at.shortName==="CN")).map(ot=>({recipient:ot,keyId:ot.issuer.find(at=>at.shortName==="CN").value})),et=await findAsync(j,async ot=>{try{if(await this.keychain.findKeyById(ot.keyId)!=null)return!0}catch{return!1}return!1});if(et==null){const ot=j.map(at=>at.keyId);throw errCode(new Error(`Decryption needs one of the key(s): ${ot.join(", ")}`),codes$2.ERR_MISSING_KEYS,{missingKeys:ot})}const tt=await this.keychain.findKeyById(et.keyId);if(tt==null)throw errCode(new Error("No key available to decrypto"),codes$2.ERR_NO_KEY);const rt=await this.keychain.getPrivateKey(tt.name),nt=privates$1.get(this);if(nt==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const it=nt.dek,st=forge$s.pki.decryptRsaPrivateKey(rt,it);return $.decrypt(et.recipient,st),fromString$8($.content.getBytes(),"ascii")}}const log$B=logger$1("libp2p:keychain"),keyPrefix="/pkcs8/",infoPrefix="/info/",privates=new WeakMap,NIST={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},defaultOptions$3={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function validateKeyName(_){return _==null||typeof _!="string"?!1:_===sanitizeFilename(_.trim())&&_.length>0}async function randomDelay(){const $=Math.random()*800+200;await new Promise(j=>setTimeout(j,$))}function DsName(_){return new Key(keyPrefix+_)}function DsInfoName(_){return new Key(infoPrefix+_)}class KeyChain{constructor(o,$){var et,tt,rt,nt,it,st,ot,at,ct,ut;if(this.components=o,this.init=mergeOptions$g(defaultOptions$3,$),this.init.pass!=null&&((et=this.init.pass)==null?void 0:et.length)<20)throw new Error("pass must be least 20 characters");if(((tt=this.init.dek)==null?void 0:tt.keyLength)!=null&&this.init.dek.keyLength<NIST.minKeyLength)throw new Error(`dek.keyLength must be least ${NIST.minKeyLength} bytes`);if(((nt=(rt=this.init.dek)==null?void 0:rt.salt)==null?void 0:nt.length)!=null&&this.init.dek.salt.length<NIST.minSaltLength)throw new Error(`dek.saltLength must be least ${NIST.minSaltLength} bytes`);if(((it=this.init.dek)==null?void 0:it.iterationCount)!=null&&this.init.dek.iterationCount<NIST.minIterationCount)throw new Error(`dek.iterationCount must be least ${NIST.minIterationCount}`);const j=this.init.pass!=null&&((st=this.init.dek)==null?void 0:st.salt)!=null?pbkdf2$2(this.init.pass,(ot=this.init.dek)==null?void 0:ot.salt,(at=this.init.dek)==null?void 0:at.iterationCount,(ct=this.init.dek)==null?void 0:ct.keyLength,(ut=this.init.dek)==null?void 0:ut.hash):"";privates.set(this,{dek:j}),this.started=!1}isStarted(){return this.started}async start(){const o=DsInfoName("self");await this.components.datastore.has(o)||await this.importPeer("self",this.components.peerId),this.started=!0}stop(){this.started=!1}get cms(){const o=privates.get(this);if(o==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const $=o.dek;return new CMS(this,$)}static generateOptions(){const o=Object.assign({},defaultOptions$3),$=Math.ceil(NIST.minSaltLength/3)*3;return o.dek.salt=toString$a(randomBytes$3($),"base64"),o}static get options(){return defaultOptions$3}async createKey(o,$,j=2048){if(!validateKeyName(o)||o==="self")throw await randomDelay(),errCode(new Error("Invalid key name"),codes$2.ERR_INVALID_KEY_NAME);if(typeof $!="string")throw await randomDelay(),errCode(new Error("Invalid key type"),codes$2.ERR_INVALID_KEY_TYPE);const et=DsName(o);if(await this.components.datastore.has(et))throw await randomDelay(),errCode(new Error("Key name already exists"),codes$2.ERR_KEY_ALREADY_EXISTS);switch($.toLowerCase()){case"rsa":if(!Number.isSafeInteger(j)||j<2048)throw await randomDelay(),errCode(new Error("Invalid RSA key size"),codes$2.ERR_INVALID_KEY_SIZE);break}let rt;try{const nt=await generateKeyPair($,j),it=await nt.id(),st=privates.get(this);if(st==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const ot=st.dek,at=await nt.export(ot);rt={name:o,id:it};const ct=this.components.datastore.batch();ct.put(et,fromString$8(at)),ct.put(DsInfoName(o),fromString$8(JSON.stringify(rt))),await ct.commit()}catch(nt){throw await randomDelay(),nt}return rt}async listKeys(){const o={prefix:infoPrefix},$=[];for await(const j of this.components.datastore.query(o))$.push(JSON.parse(toString$a(j.value)));return $}async findKeyById(o){try{return(await this.listKeys()).find(j=>j.id===o)}catch($){throw await randomDelay(),$}}async findKeyByName(o){if(!validateKeyName(o))throw await randomDelay(),errCode(new Error(`Invalid key name '${o}'`),codes$2.ERR_INVALID_KEY_NAME);const $=DsInfoName(o);try{const j=await this.components.datastore.get($);return JSON.parse(toString$a(j))}catch(j){throw await randomDelay(),log$B.error(j),errCode(new Error(`Key '${o}' does not exist.`),codes$2.ERR_KEY_NOT_FOUND)}}async removeKey(o){if(!validateKeyName(o)||o==="self")throw await randomDelay(),errCode(new Error(`Invalid key name '${o}'`),codes$2.ERR_INVALID_KEY_NAME);const $=DsName(o),j=await this.findKeyByName(o),et=this.components.datastore.batch();return et.delete($),et.delete(DsInfoName(o)),await et.commit(),j}async renameKey(o,$){if(!validateKeyName(o)||o==="self")throw await randomDelay(),errCode(new Error(`Invalid old key name '${o}'`),codes$2.ERR_OLD_KEY_NAME_INVALID);if(!validateKeyName($)||$==="self")throw await randomDelay(),errCode(new Error(`Invalid new key name '${$}'`),codes$2.ERR_NEW_KEY_NAME_INVALID);const j=DsName(o),et=DsName($),tt=DsInfoName(o),rt=DsInfoName($);if(await this.components.datastore.has(et))throw await randomDelay(),errCode(new Error(`Key '${$}' already exists`),codes$2.ERR_KEY_ALREADY_EXISTS);try{const it=await this.components.datastore.get(j),st=await this.components.datastore.get(tt),ot=JSON.parse(toString$a(st));ot.name=$;const at=this.components.datastore.batch();return at.put(et,it),at.put(rt,fromString$8(JSON.stringify(ot))),at.delete(j),at.delete(tt),await at.commit(),ot}catch(it){throw await randomDelay(),it}}async exportKey(o,$){if(!validateKeyName(o))throw await randomDelay(),errCode(new Error(`Invalid key name '${o}'`),codes$2.ERR_INVALID_KEY_NAME);if($==null)throw await randomDelay(),errCode(new Error("Password is required"),codes$2.ERR_PASSWORD_REQUIRED);const j=DsName(o);try{const et=await this.components.datastore.get(j),tt=toString$a(et),rt=privates.get(this);if(rt==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const nt=rt.dek;return await(await importKey(tt,nt)).export($)}catch(et){throw await randomDelay(),et}}async exportPeerId(o){const $="temporary-password",j=await this.exportKey(o,$),et=await importKey(j,$);return await peerIdFromKeys(et.public.bytes,et.bytes)}async importKey(o,$,j){if(!validateKeyName(o)||o==="self")throw await randomDelay(),errCode(new Error(`Invalid key name '${o}'`),codes$2.ERR_INVALID_KEY_NAME);if($==null)throw await randomDelay(),errCode(new Error("PEM encoded key is required"),codes$2.ERR_PEM_REQUIRED);const et=DsName(o);if(await this.components.datastore.has(et))throw await randomDelay(),errCode(new Error(`Key '${o}' already exists`),codes$2.ERR_KEY_ALREADY_EXISTS);let rt;try{rt=await importKey($,j)}catch{throw await randomDelay(),errCode(new Error("Cannot read the key, most likely the password is wrong"),codes$2.ERR_CANNOT_READ_KEY)}let nt;try{nt=await rt.id();const ot=privates.get(this);if(ot==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const at=ot.dek;$=await rt.export(at)}catch(ot){throw await randomDelay(),ot}const it={name:o,id:nt},st=this.components.datastore.batch();return st.put(et,fromString$8($)),st.put(DsInfoName(o),fromString$8(JSON.stringify(it))),await st.commit(),it}async importPeer(o,$){try{if(!validateKeyName(o))throw errCode(new Error(`Invalid key name '${o}'`),codes$2.ERR_INVALID_KEY_NAME);if($==null)throw errCode(new Error("PeerId is required"),codes$2.ERR_MISSING_PRIVATE_KEY);if($.privateKey==null)throw errCode(new Error("PeerId.privKey is required"),codes$2.ERR_MISSING_PRIVATE_KEY);const j=await unmarshalPrivateKey($.privateKey),et=DsName(o);if(await this.components.datastore.has(et))throw await randomDelay(),errCode(new Error(`Key '${o}' already exists`),codes$2.ERR_KEY_ALREADY_EXISTS);const rt=privates.get(this);if(rt==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const nt=rt.dek,it=await j.export(nt),st={name:o,id:$.toString()},ot=this.components.datastore.batch();return ot.put(et,fromString$8(it)),ot.put(DsInfoName(o),fromString$8(JSON.stringify(st))),await ot.commit(),st}catch(j){throw await randomDelay(),j}}async getPrivateKey(o){if(!validateKeyName(o))throw await randomDelay(),errCode(new Error(`Invalid key name '${o}'`),codes$2.ERR_INVALID_KEY_NAME);try{const $=DsName(o),j=await this.components.datastore.get($);return toString$a(j)}catch($){throw await randomDelay(),log$B.error($),errCode(new Error(`Key '${o}' does not exist.`),codes$2.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(o,$){var nt,it,st,ot;if(typeof o!="string")throw await randomDelay(),errCode(new Error(`Invalid old pass type '${typeof o}'`),codes$2.ERR_INVALID_OLD_PASS_TYPE);if(typeof $!="string")throw await randomDelay(),errCode(new Error(`Invalid new pass type '${typeof $}'`),codes$2.ERR_INVALID_NEW_PASS_TYPE);if($.length<20)throw await randomDelay(),errCode(new Error(`Invalid pass length ${$.length}`),codes$2.ERR_INVALID_PASS_LENGTH);log$B("recreating keychain");const j=privates.get(this);if(j==null)throw errCode(new Error("dek missing"),codes$2.ERR_INVALID_PARAMETERS);const et=j.dek;this.init.pass=$;const tt=$!=null&&((nt=this.init.dek)==null?void 0:nt.salt)!=null?pbkdf2$2($,this.init.dek.salt,(it=this.init.dek)==null?void 0:it.iterationCount,(st=this.init.dek)==null?void 0:st.keyLength,(ot=this.init.dek)==null?void 0:ot.hash):"";privates.set(this,{dek:tt});const rt=await this.listKeys();for(const at of rt){const ct=await this.components.datastore.get(DsName(at.name)),ut=toString$a(ct),ft=await importKey(ut,et),ht=tt.toString(),mt=await ft.export(ht),gt=this.components.datastore.batch(),Et={name:at.name,id:at.id};gt.put(DsName(at.name),fromString$8(mt)),gt.put(DsInfoName(at.name),fromString$8(JSON.stringify(Et))),await gt.commit()}log$B("keychain reconstructed")}}async function pReflect(_){try{return{status:"fulfilled",value:await _,isFulfilled:!0,isRejected:!1}}catch(o){return{status:"rejected",reason:o,isFulfilled:!1,isRejected:!0}}}let Node$1=class{constructor(o){os(this,"value");os(this,"next");this.value=o}};var Hn,_i,es;class Queue{constructor(){xs(this,Hn,void 0);xs(this,_i,void 0);xs(this,es,void 0);this.clear()}enqueue(o){const $=new Node$1(o);jn(this,Hn)?(jn(this,_i).next=$,zn(this,_i,$)):(zn(this,Hn,$),zn(this,_i,$)),ao(this,es)._++}dequeue(){const o=jn(this,Hn);if(o)return zn(this,Hn,jn(this,Hn).next),ao(this,es)._--,o.value}clear(){zn(this,Hn,void 0),zn(this,_i,void 0),zn(this,es,0)}get size(){return jn(this,es)}*[Symbol.iterator](){let o=jn(this,Hn);for(;o;)yield o.value,o=o.next}}Hn=new WeakMap,_i=new WeakMap,es=new WeakMap;function pLimit(_){if(!((Number.isInteger(_)||_===Number.POSITIVE_INFINITY)&&_>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const o=new Queue;let $=0;const j=()=>{$--,o.size>0&&o.dequeue()()},et=async(nt,it,st)=>{$++;const ot=(async()=>nt(...st))();it(ot);try{await ot}catch{}j()},tt=(nt,it,st)=>{o.enqueue(et.bind(void 0,nt,it,st)),(async()=>(await Promise.resolve(),$<_&&o.size>0&&o.dequeue()()))()},rt=(nt,...it)=>new Promise(st=>{tt(nt,st,it)});return Object.defineProperties(rt,{activeCount:{get:()=>$},pendingCount:{get:()=>o.size},clearQueue:{value:()=>{o.clear()}}}),rt}async function pSettle(_,o={}){const{concurrency:$=Number.POSITIVE_INFINITY}=o,j=pLimit($);return Promise.all(_.map(et=>et&&typeof et.then=="function"?pReflect(et):pReflect(typeof et=="function"?j(()=>et()):Promise.resolve(et))))}class TrackedMap extends Map{constructor(o){super();const{name:$,metrics:j}=o;this.metric=j.registerMetric($),this.updateComponentMetric()}set(o,$){return super.set(o,$),this.updateComponentMetric(),this}delete(o){const $=super.delete(o);return this.updateComponentMetric(),$}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function trackedMap(_){const{name:o,metrics:$}=_;let j;return $!=null?j=new TrackedMap({name:o,metrics:$}):j=new Map,j}const log$A=logger$1("libp2p:transports");class DefaultTransportManager extends EventEmitter$1{constructor(o,$={}){super(),this.components=o,this.started=!1,this.transports=new Map,this.listeners=trackedMap({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=$.faultTolerance??FaultTolerance.FATAL_ALL}add(o){const $=o[Symbol.toStringTag];if($==null)throw errCode(new Error("Transport must have a valid tag"),codes$2.ERR_INVALID_KEY);if(this.transports.has($))throw errCode(new Error("There is already a transport with this tag"),codes$2.ERR_DUPLICATE_TRANSPORT);log$A("adding transport %s",$),this.transports.set($,o),this.listeners.has($)||this.listeners.set($,[])}isStarted(){return this.started}async start(){const o=this.components.addressManager.getListenAddrs();await this.listen(o),this.started=!0}async stop(){const o=[];for(const[$,j]of this.listeners)for(log$A("closing listeners for %s",$);j.length>0;){const et=j.pop();et!=null&&o.push(et.close())}await Promise.all(o),log$A("all listeners closed");for(const $ of this.listeners.keys())this.listeners.set($,[]);this.started=!1}async dial(o,$){const j=this.transportForMultiaddr(o);if(j==null)throw errCode(new Error(`No transport available for address ${String(o)}`),codes$2.ERR_TRANSPORT_UNAVAILABLE);try{return await j.dial(o,{...$,upgrader:this.components.upgrader})}catch(et){throw et.code==null&&(et.code=codes$2.ERR_TRANSPORT_DIAL_FAILED),et}}getAddrs(){let o=[];for(const $ of this.listeners.values())for(const j of $)o=[...o,...j.getAddrs()];return o}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(o){for(const $ of this.transports.values())if($.filter([o]).length>0)return $}async listen(o){if(o==null||o.length===0){log$A("no addresses were provided for listening, this node is dial only");return}const $=[];for(const[j,et]of this.transports.entries()){const tt=et.filter(o),rt=[];for(const st of tt){log$A("creating listener for %s on %s",j,st);const ot=et.createListener({upgrader:this.components.upgrader});let at=this.listeners.get(j);at==null&&(at=[],this.listeners.set(j,at)),at.push(ot),ot.addEventListener("listening",()=>{this.dispatchEvent(new CustomEvent("listener:listening",{detail:ot}))}),ot.addEventListener("close",()=>{this.dispatchEvent(new CustomEvent("listener:close",{detail:ot}))}),rt.push(ot.listen(st))}if(rt.length===0){$.push(j);continue}if((await pSettle(rt)).find(st=>st.isFulfilled)==null&&this.faultTolerance!==FaultTolerance.NO_FATAL)throw errCode(new Error(`Transport (${j}) could not listen on any available address`),codes$2.ERR_NO_VALID_ADDRESSES)}if($.length===this.transports.size){const j=`no valid addresses were provided for transports [${$.join(", ")}]`;if(this.faultTolerance===FaultTolerance.FATAL_ALL)throw errCode(new Error(j),codes$2.ERR_NO_VALID_ADDRESSES);log$A(`libp2p in dial mode only: ${j}`)}}async remove(o){log$A("removing %s",o);for(const $ of this.listeners.get(o)??[])await $.close();this.transports.delete(o),this.listeners.delete(o)}async removeAll(){const o=[];for(const $ of this.transports.keys())o.push(this.remove($));await Promise.all(o)}}const PROTOCOL_ID="/multistream/1.0.0",MAX_PROTOCOL_LENGTH=1024,log$z=logger$1("libp2p:mss"),NewLine=fromString$8(`
`);function encode$2(_){const o=new Uint8ArrayList(_,NewLine);return encode$5.single(o)}function write(_,o,$={}){const j=encode$2(o);$.writeBytes===!0?_.push(j.subarray()):_.push(j)}function writeAll(_,o,$={}){const j=new Uint8ArrayList;for(const et of o)j.append(encode$2(et));$.writeBytes===!0?_.push(j.subarray()):_.push(j)}async function read$1(_,o){let $=1;const j={[Symbol.asyncIterator]:()=>j,next:async()=>await _.next($)};let et=j;(o==null?void 0:o.signal)!=null&&(et=abortableSource(j,o.signal));const rt=await pipe(et,decode$3({onLength:nt=>{$=nt},maxDataLength:MAX_PROTOCOL_LENGTH}),async nt=>await first(nt));if(rt==null||rt.length===0)throw errCode(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(rt.get(rt.byteLength-1)!==NewLine[0])throw log$z.error("Invalid mss message - missing newline - %s",rt.subarray()),errCode(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return rt.sublist(0,-1)}async function readString(_,o){const $=await read$1(_,o);return toString$a($.subarray())}const log$y=logger$1("libp2p:mss:select");async function select(_,o,$={}){o=Array.isArray(o)?[...o]:[o];const{reader:j,writer:et,rest:tt,stream:rt}=handshake(_),nt=o.shift();if(nt==null)throw new Error("At least one protocol must be specified");log$y('select: write ["%s", "%s"]',PROTOCOL_ID,nt);const it=fromString$8(PROTOCOL_ID),st=fromString$8(nt);writeAll(et,[it,st],$);let ot=await readString(j,$);if(log$y('select: read "%s"',ot),ot===PROTOCOL_ID&&(ot=await readString(j,$),log$y('select: read "%s"',ot)),ot===nt)return tt(),{stream:rt,protocol:nt};for(const at of o){log$y('select: write "%s"',at),write(et,fromString$8(at),$);const ct=await readString(j,$);if(log$y('select: read "%s" for "%s"',ct,at),ct===at)return tt(),{stream:rt,protocol:at}}throw tt(),errCode(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}const log$x=logger$1("libp2p:mss:handle");async function handle(_,o,$){o=Array.isArray(o)?o:[o];const{writer:j,reader:et,rest:tt,stream:rt}=handshake(_);for(;;){const nt=await readString(et,$);if(log$x('read "%s"',nt),nt===PROTOCOL_ID){log$x('respond with "%s" for "%s"',PROTOCOL_ID,nt),write(j,fromString$8(PROTOCOL_ID),$);continue}if(o.includes(nt))return write(j,fromString$8(nt),$),log$x('respond with "%s" for "%s"',nt,nt),tt(),{stream:rt,protocol:nt};if(nt==="ls"){write(j,new Uint8ArrayList(...o.map(it=>encode$2(fromString$8(it)))),$),log$x('respond with "%s" for %s',o,nt);continue}write(j,fromString$8("na"),$),log$x('respond with "na" for "%s"',nt)}}const symbol$1=Symbol.for("@libp2p/connection"),log$w=logger$1("libp2p:connection");class ConnectionImpl{constructor(o){const{remoteAddr:$,remotePeer:j,newStream:et,close:tt,getStreams:rt,stat:nt}=o;this.id=`${parseInt(String(Math.random()*1e9)).toString(36)}${Date.now()}`,this.remoteAddr=$,this.remotePeer=j,this.stat={...nt,status:OPEN},this._newStream=et,this._close=tt,this._getStreams=rt,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[symbol$1](){return!0}get streams(){return this._getStreams()}async newStream(o,$){if(this.stat.status===CLOSING)throw errCode(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===CLOSED)throw errCode(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(o)||(o=[o]);const j=await this._newStream(o,$);return j.stat.direction="outbound",j}addStream(o){o.stat.direction="inbound"}removeStream(o){}async close(){if(!(this.stat.status===CLOSED||this._closing)){this.stat.status=CLOSING;try{this.streams.forEach(o=>o.close())}catch(o){log$w.error(o)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=CLOSED}}}function createConnection(_){return new ConnectionImpl(_)}const log$v=logger$1("libp2p:registrar"),DEFAULT_MAX_INBOUND_STREAMS$2=32,DEFAULT_MAX_OUTBOUND_STREAMS$2=64;class DefaultRegistrar{constructor(o){this.topologies=new Map,this.handlers=new Map,this.components=o,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this._onConnect=this._onConnect.bind(this),this.components.connectionManager.addEventListener("peer:disconnect",this._onDisconnect),this.components.connectionManager.addEventListener("peer:connect",this._onConnect),this.components.peerStore.addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){return Array.from(new Set([...this.topologies.keys(),...this.handlers.keys()])).sort()}getHandler(o){const $=this.handlers.get(o);if($==null)throw errCode(new Error(`No handler registered for protocol ${o}`),codes$2.ERR_NO_HANDLER_FOR_PROTOCOL);return $}getTopologies(o){const $=this.topologies.get(o);return $==null?[]:[...$.values()]}async handle(o,$,j){if(this.handlers.has(o))throw errCode(new Error(`Handler already registered for protocol ${o}`),codes$2.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const et=mergeOptions$g.bind({ignoreUndefined:!0})({maxInboundStreams:DEFAULT_MAX_INBOUND_STREAMS$2,maxOutboundStreams:DEFAULT_MAX_OUTBOUND_STREAMS$2},j);this.handlers.set(o,{handler:$,options:et}),await this.components.peerStore.protoBook.add(this.components.peerId,[o])}async unhandle(o){const $=Array.isArray(o)?o:[o];$.forEach(j=>{this.handlers.delete(j)}),await this.components.peerStore.protoBook.remove(this.components.peerId,$)}async register(o,$){if(!isTopology($))throw log$v.error("topology must be an instance of interfaces/topology"),errCode(new Error("topology must be an instance of interfaces/topology"),codes$2.ERR_INVALID_PARAMETERS);const j=`${(Math.random()*1e9).toString(36)}${Date.now()}`;let et=this.topologies.get(o);return et==null&&(et=new Map,this.topologies.set(o,et)),et.set(j,$),await $.setRegistrar(this),j}unregister(o){for(const[$,j]of this.topologies.entries())j.has(o)&&(j.delete(o),j.size===0&&this.topologies.delete($))}_onDisconnect(o){const $=o.detail;this.components.peerStore.protoBook.get($.remotePeer).then(j=>{for(const et of j){const tt=this.topologies.get(et);if(tt!=null)for(const rt of tt.values())rt.onDisconnect($.remotePeer)}}).catch(j=>{log$v.error(j)})}_onConnect(o){const $=o.detail;this.components.peerStore.protoBook.get($.remotePeer).then(j=>{for(const et of j){const tt=this.topologies.get(et);if(tt!=null)for(const rt of tt.values())rt.onConnect($.remotePeer,$)}}).catch(j=>{log$v.error(j)})}_onProtocolChange(o){const{peerId:$,protocols:j,oldProtocols:et}=o.detail,tt=et.filter(nt=>!j.includes(nt)),rt=j.filter(nt=>!et.includes(nt));for(const nt of tt){const it=this.topologies.get(nt);if(it!=null)for(const st of it.values())st.onDisconnect($)}for(const nt of rt){const it=this.topologies.get(nt);if(it!=null)for(const st of it.values()){const ot=this.components.connectionManager.getConnections($)[0];ot!=null&&st.onConnect($,ot)}}}}const log$u=logger$1("libp2p:upgrader");function findIncomingStreamLimit(_,o){try{const{options:$}=o.getHandler(_);return $.maxInboundStreams}catch($){if($.code!==codes$2.ERR_NO_HANDLER_FOR_PROTOCOL)throw $}return DEFAULT_MAX_INBOUND_STREAMS$2}function findOutgoingStreamLimit(_,o){try{const{options:$}=o.getHandler(_);return $.maxOutboundStreams}catch($){if($.code!==codes$2.ERR_NO_HANDLER_FOR_PROTOCOL)throw $}return DEFAULT_MAX_OUTBOUND_STREAMS$2}function countStreams(_,o,$){let j=0;return $.streams.forEach(et=>{et.stat.direction===o&&et.stat.protocol===_&&j++}),j}class DefaultUpgrader extends EventEmitter$1{constructor(o,$){super(),this.components=o,this.connectionEncryption=new Map,$.connectionEncryption.forEach(j=>{this.connectionEncryption.set(j.protocol,j)}),this.muxers=new Map,$.muxers.forEach(j=>{this.muxers.set(j.protocol,j)}),this.inboundUpgradeTimeout=$.inboundUpgradeTimeout}async upgradeInbound(o,$){var ot,at;if(!await this.components.connectionManager.acceptIncomingConnection(o))throw errCode(new Error("connection denied"),codes$2.ERR_CONNECTION_DENIED);let et,tt,rt,nt,it;const st=new timeoutAbortController.TimeoutController(this.inboundUpgradeTimeout);try{(ot=eventsExports.setMaxListeners)==null||ot.call(eventsExports,1/0,st.signal)}catch{}try{const ct=abortableDuplex(o,st.signal);if(o.source=ct.source,o.sink=ct.sink,await this.components.connectionGater.denyInboundConnection(o))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptConnection"),codes$2.ERR_CONNECTION_INTERCEPTED);(at=this.components.metrics)==null||at.trackMultiaddrConnection(o),log$u("starting the inbound connection upgrade");let ut=o;if(($==null?void 0:$.skipProtection)!==!0){const ft=this.components.connectionProtector;ft!=null&&(log$u("protecting the inbound connection"),ut=await ft.protect(o))}try{if(et=ut,($==null?void 0:$.skipEncryption)!==!0){if({conn:et,remotePeer:tt,protocol:it}=await this._encryptInbound(ut),await this.components.connectionGater.denyInboundEncryptedConnection(tt,{...ut,...et}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$2.ERR_CONNECTION_INTERCEPTED)}else{const ft=o.remoteAddr.getPeerId();if(ft==null)throw errCode(new Error("inbound connection that skipped encryption must have a peer id"),codes$2.ERR_INVALID_MULTIADDR);const ht=peerIdFromString(ft);it="native",tt=ht}if(rt=et,($==null?void 0:$.muxerFactory)!=null)nt=$.muxerFactory;else if(this.muxers.size>0){const ft=await this._multiplexInbound({...ut,...et},this.muxers);nt=ft.muxerFactory,rt=ft.stream}}catch(ft){throw log$u.error("Failed to upgrade inbound connection",ft),ft}if(await this.components.connectionGater.denyInboundUpgradedConnection(tt,{...ut,...et}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$2.ERR_CONNECTION_INTERCEPTED);return log$u("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:it,direction:"inbound",maConn:o,upgradedConn:rt,muxerFactory:nt,remotePeer:tt})}finally{this.components.connectionManager.afterUpgradeInbound(),st.clear()}}async upgradeOutbound(o,$){var at;const j=o.remoteAddr.getPeerId();let et;if(j!=null&&(et=peerIdFromString(j),await this.components.connectionGater.denyOutboundConnection(et,o)))throw errCode(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),codes$2.ERR_CONNECTION_INTERCEPTED);let tt,rt,nt,it,st;(at=this.components.metrics)==null||at.trackMultiaddrConnection(o),log$u("Starting the outbound connection upgrade");let ot=o;if(($==null?void 0:$.skipProtection)!==!0){const ct=this.components.connectionProtector;ct!=null&&(ot=await ct.protect(o))}try{if(tt=ot,($==null?void 0:$.skipEncryption)!==!0){if({conn:tt,remotePeer:rt,protocol:it}=await this._encryptOutbound(ot,et),await this.components.connectionGater.denyOutboundEncryptedConnection(rt,{...ot,...tt}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$2.ERR_CONNECTION_INTERCEPTED)}else{if(et==null)throw errCode(new Error("Encryption was skipped but no peer id was passed"),codes$2.ERR_INVALID_PEER);it="native",rt=et}if(nt=tt,($==null?void 0:$.muxerFactory)!=null)st=$.muxerFactory;else if(this.muxers.size>0){const ct=await this._multiplexOutbound({...ot,...tt},this.muxers);st=ct.muxerFactory,nt=ct.stream}}catch(ct){throw log$u.error("Failed to upgrade outbound connection",ct),await o.close(ct),ct}if(await this.components.connectionGater.denyOutboundUpgradedConnection(rt,{...ot,...tt}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$2.ERR_CONNECTION_INTERCEPTED);return log$u("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:it,direction:"outbound",maConn:o,upgradedConn:nt,muxerFactory:st,remotePeer:rt})}_createConnection(o){const{cryptoProtocol:$,direction:j,maConn:et,upgradedConn:tt,remotePeer:rt,muxerFactory:nt}=o;let it,st,ot;nt!=null&&(it=nt.createStreamMuxer({direction:j,onIncomingStream:ut=>{ot!=null&&Promise.resolve().then(async()=>{var St;const ft=this.components.registrar.getProtocols(),{stream:ht,protocol:mt}=await handle(ut,ft);if(log$u("%s: incoming stream opened on %s",j,mt),ot==null)return;const gt=findIncomingStreamLimit(mt,this.components.registrar);if(countStreams(mt,"inbound",ot)===gt){ut.abort(errCode(new Error(`Too many inbound protocol streams for protocol "${mt}" - limit ${gt}`),codes$2.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS));return}ut.source=ht.source,ut.sink=ht.sink,ut.stat.protocol=mt,this.components.peerStore.protoBook.add(rt,[mt]).catch(At=>log$u.error(At)),ot.addStream(ut),(St=this.components.metrics)==null||St.trackProtocolStream(ut,ot),this._onStream({connection:ot,stream:ut,protocol:mt})}).catch(ft=>{log$u.error(ft),ut.stat.timeline.close==null&&ut.close()})},onStreamEnd:ut=>{ot==null||ot.removeStream(ut.id)}}),st=async(ut,ft={})=>{var gt,Et;if(it==null)throw errCode(new Error("Stream is not multiplexed"),codes$2.ERR_MUXER_UNAVAILABLE);log$u("%s: starting new stream on %s",j,ut);const ht=await it.newStream();let mt;try{if(ft.signal==null){log$u("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",ut),mt=new timeoutAbortController.TimeoutController(3e4),ft.signal=mt.signal;try{(gt=eventsExports.setMaxListeners)==null||gt.call(eventsExports,1/0,mt.signal)}catch{}}const{stream:St,protocol:At}=await select(ht,ut,ft),kt=findOutgoingStreamLimit(At,this.components.registrar);if(countStreams(At,"outbound",ot)===kt){const Tt=errCode(new Error(`Too many outbound protocol streams for protocol "${At}" - limit ${kt}`),codes$2.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw ht.abort(Tt),Tt}return this.components.peerStore.protoBook.add(rt,[At]).catch(Tt=>log$u.error(Tt)),ht.source=St.source,ht.sink=St.sink,ht.stat.protocol=At,(Et=this.components.metrics)==null||Et.trackProtocolStream(ht,ot),ht}catch(St){throw log$u.error("could not create new stream",St),ht.stat.timeline.close==null&&ht.close(),St.code!=null?St:errCode(St,codes$2.ERR_UNSUPPORTED_PROTOCOL)}finally{mt!=null&&mt.clear()}},Promise.all([it.sink(tt.source),tt.sink(it.source)]).catch(ut=>{log$u.error(ut)}));const at=et.timeline;et.timeline=new Proxy(at,{set:(...ut)=>(ot!=null&&ut[1]==="close"&&ut[2]!=null&&at.close==null&&(async()=>{try{ot.stat.status==="OPEN"&&await ot.close()}catch(ft){log$u.error(ft)}finally{this.dispatchEvent(new CustomEvent("connectionEnd",{detail:ot}))}})().catch(ft=>{log$u.error(ft)}),Reflect.set(...ut))}),et.timeline.upgraded=Date.now();const ct=()=>{throw errCode(new Error("connection is not multiplexed"),codes$2.ERR_CONNECTION_NOT_MULTIPLEXED)};return ot=createConnection({remoteAddr:et.remoteAddr,remotePeer:rt,stat:{status:"OPEN",direction:j,timeline:et.timeline,multiplexer:it==null?void 0:it.protocol,encryption:$},newStream:st??ct,getStreams:()=>it!=null?it.streams:ct(),close:async()=>{await et.close(),it!=null&&it.close()}}),this.dispatchEvent(new CustomEvent("connection",{detail:ot})),ot}_onStream(o){const{connection:$,stream:j,protocol:et}=o,{handler:tt}=this.components.registrar.getHandler(et);tt({connection:$,stream:j})}async _encryptInbound(o){const $=Array.from(this.connectionEncryption.keys());log$u("handling inbound crypto protocol selection",$);try{const{stream:j,protocol:et}=await handle(o,$,{writeBytes:!0}),tt=this.connectionEncryption.get(et);if(tt==null)throw new Error(`no crypto module found for ${et}`);return log$u("encrypting inbound connection..."),{...await tt.secureInbound(this.components.peerId,j),protocol:et}}catch(j){throw errCode(j,codes$2.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(o,$){const j=Array.from(this.connectionEncryption.keys());log$u("selecting outbound crypto protocol",j);try{const{stream:et,protocol:tt}=await select(o,j,{writeBytes:!0}),rt=this.connectionEncryption.get(tt);if(rt==null)throw new Error(`no crypto module found for ${tt}`);return log$u("encrypting outbound connection to %p",$),{...await rt.secureOutbound(this.components.peerId,et,$),protocol:tt}}catch(et){throw errCode(et,codes$2.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(o,$){const j=Array.from($.keys());log$u("outbound selecting muxer %s",j);try{const{stream:et,protocol:tt}=await select(o,j,{writeBytes:!0});log$u("%s selected as muxer protocol",tt);const rt=$.get(tt);return{stream:et,muxerFactory:rt}}catch(et){throw log$u.error("error multiplexing outbound stream",et),errCode(et,codes$2.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(o,$){const j=Array.from($.keys());log$u("inbound handling muxers %s",j);try{const{stream:et,protocol:tt}=await handle(o,j,{writeBytes:!0}),rt=$.get(tt);return{stream:et,muxerFactory:rt}}catch(et){throw log$u.error("error multiplexing inbound stream",et),errCode(et,codes$2.ERR_MUXER_UNAVAILABLE)}}}var Identify;(function(_){let o;_.codec=()=>(o==null&&(o=message$1(($,j,et={})=>{if(et.lengthDelimited!==!1&&j.fork(),$.protocolVersion!=null&&(j.uint32(42),j.string($.protocolVersion)),$.agentVersion!=null&&(j.uint32(50),j.string($.agentVersion)),$.publicKey!=null&&(j.uint32(10),j.bytes($.publicKey)),$.listenAddrs!=null)for(const tt of $.listenAddrs)j.uint32(18),j.bytes(tt);if($.observedAddr!=null&&(j.uint32(34),j.bytes($.observedAddr)),$.protocols!=null)for(const tt of $.protocols)j.uint32(26),j.string(tt);$.signedPeerRecord!=null&&(j.uint32(66),j.bytes($.signedPeerRecord)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={listenAddrs:[],protocols:[]},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 5:et.protocolVersion=$.string();break;case 6:et.agentVersion=$.string();break;case 1:et.publicKey=$.bytes();break;case 2:et.listenAddrs.push($.bytes());break;case 4:et.observedAddr=$.bytes();break;case 3:et.protocols.push($.string());break;case 8:et.signedPeerRecord=$.bytes();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$1($,_.codec()),_.decode=$=>decodeMessage$1($,_.codec())})(Identify||(Identify={}));const version="0.0.0",name="libp2p",AGENT_VERSION=`js-libp2p/${version}`,IDENTIFY_PROTOCOL_VERSION="0.1.0",MULTICODEC_IDENTIFY_PROTOCOL_NAME="id",MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push",MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0",MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0",log$t=logger$1("libp2p:identify"),MAX_IDENTIFY_MESSAGE_SIZE=1024*8;class IdentifyService{constructor(o,$){this.components=o,this.started=!1,this.init=$,this.identifyProtocolStr=`/${$.protocolPrefix}/${MULTICODEC_IDENTIFY_PROTOCOL_NAME}/${MULTICODEC_IDENTIFY_PROTOCOL_VERSION}`,this.identifyPushProtocolStr=`/${$.protocolPrefix}/${MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME}/${MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION}`,this.host={protocolVersion:`${$.protocolPrefix}/${IDENTIFY_PROTOCOL_VERSION}`,...$.host},this.components.connectionManager.addEventListener("peer:connect",j=>{const et=j.detail;this.identify(et).catch(log$t.error)}),this.components.peerStore.addEventListener("change:multiaddrs",j=>{const{peerId:et}=j.detail;this.components.peerId.equals(et)&&this.pushToPeerStore().catch(tt=>log$t.error(tt))}),this.components.peerStore.addEventListener("change:protocols",j=>{const{peerId:et}=j.detail;this.components.peerId.equals(et)&&this.pushToPeerStore().catch(tt=>log$t.error(tt))})}isStarted(){return this.started}async start(){this.started||(await this.components.peerStore.metadataBook.setValue(this.components.peerId,"AgentVersion",fromString$8(this.host.agentVersion)),await this.components.peerStore.metadataBook.setValue(this.components.peerId,"ProtocolVersion",fromString$8(this.host.protocolVersion)),await this.components.registrar.handle(this.identifyProtocolStr,o=>{this._handleIdentify(o).catch($=>{log$t.error($)})},{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),await this.components.registrar.handle(this.identifyPushProtocolStr,o=>{this._handlePush(o).catch($=>{log$t.error($)})},{maxInboundStreams:this.init.maxPushIncomingStreams,maxOutboundStreams:this.init.maxPushOutgoingStreams}),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.identifyProtocolStr),await this.components.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async push(o){const $=await this.components.peerStore.addressBook.getRawEnvelope(this.components.peerId),j=this.components.addressManager.getAddresses().map(rt=>rt.bytes),et=await this.components.peerStore.protoBook.get(this.components.peerId),tt=o.map(async rt=>{var st;let nt;const it=new timeoutAbortController.TimeoutController(this.init.timeout);try{(st=eventsExports.setMaxListeners)==null||st.call(eventsExports,1/0,it.signal)}catch{}try{nt=await rt.newStream([this.identifyPushProtocolStr],{signal:it.signal}),await abortableDuplex(nt,it.signal).sink(pipe([Identify.encode({listenAddrs:j,signedPeerRecord:$,protocols:et})],encode$5()))}catch(ot){log$t.error("could not push identify update to peer",ot)}finally{nt!=null&&nt.close(),it.clear()}});await Promise.all(tt)}async pushToPeerStore(){if(!this.isStarted())return;const o=[];for(const $ of this.components.connectionManager.getConnections()){const j=$.remotePeer;(await this.components.peerStore.get(j)).protocols.includes(this.identifyPushProtocolStr)&&o.push($)}await this.push(o)}async _identify(o,$={}){var rt;let j,et=$.signal,tt;if(et==null){j=new timeoutAbortController.TimeoutController(this.init.timeout),et=j.signal;try{(rt=eventsExports.setMaxListeners)==null||rt.call(eventsExports,1/0,j.signal)}catch{}}try{tt=await o.newStream([this.identifyProtocolStr],{signal:et});const nt=abortableDuplex(tt,et),it=await pipe([],nt,decode$3({maxDataLength:this.init.maxIdentifyMessageSize??MAX_IDENTIFY_MESSAGE_SIZE}),async st=>await first(st));if(it==null)throw errCode(new Error("No data could be retrieved"),codes$2.ERR_CONNECTION_ENDED);try{return Identify.decode(it)}catch(st){throw errCode(st,codes$2.ERR_INVALID_MESSAGE)}}finally{j!=null&&j.clear(),tt!=null&&tt.close()}}async identify(o,$={}){const j=await this._identify(o,$),{publicKey:et,listenAddrs:tt,protocols:rt,observedAddr:nt,signedPeerRecord:it,agentVersion:st,protocolVersion:ot}=j;if(et==null)throw errCode(new Error("public key was missing from identify message"),codes$2.ERR_MISSING_PUBLIC_KEY);const at=await peerIdFromKeys(et);if(!o.remotePeer.equals(at))throw errCode(new Error("identified peer does not match the expected peer"),codes$2.ERR_INVALID_PEER);if(this.components.peerId.equals(at))throw errCode(new Error("identified peer is our own peer id?"),codes$2.ERR_INVALID_PEER);const ct=IdentifyService.getCleanMultiaddr(nt);if(it!=null){log$t("received signed peer record from %p",at);try{const ut=await RecordEnvelope.openAndCertify(it,PeerRecord.DOMAIN);if(!ut.peerId.equals(at))throw errCode(new Error("identified peer does not match the expected peer"),codes$2.ERR_INVALID_PEER);if(await this.components.peerStore.addressBook.consumePeerRecord(ut)){await this.components.peerStore.protoBook.set(at,rt),st!=null&&await this.components.peerStore.metadataBook.setValue(at,"AgentVersion",fromString$8(st)),ot!=null&&await this.components.peerStore.metadataBook.setValue(at,"ProtocolVersion",fromString$8(ot)),log$t("identify completed for peer %p and protocols %o",at,rt);return}}catch(ut){log$t("received invalid envelope, discard it and fallback to listenAddrs is available",ut)}}else log$t("no signed peer record received from %p",at);log$t("falling back to legacy addresses from %p",at);try{await this.components.peerStore.addressBook.set(at,tt.map(ut=>multiaddr$3(ut)))}catch(ut){log$t.error("received invalid addrs",ut)}await this.components.peerStore.protoBook.set(at,rt),st!=null&&await this.components.peerStore.metadataBook.setValue(at,"AgentVersion",fromString$8(st)),ot!=null&&await this.components.peerStore.metadataBook.setValue(at,"ProtocolVersion",fromString$8(ot)),log$t("identify completed for peer %p and protocols %o",at,rt),log$t("received observed address of %s",ct==null?void 0:ct.toString())}async _handleIdentify(o){var tt;const{connection:$,stream:j}=o,et=new timeoutAbortController.TimeoutController(this.init.timeout);try{(tt=eventsExports.setMaxListeners)==null||tt.call(eventsExports,1/0,et.signal)}catch{}try{const rt=this.components.peerId.publicKey??new Uint8Array(0),nt=await this.components.peerStore.get(this.components.peerId),it=this.components.addressManager.getAddresses().map(ut=>ut.decapsulateCode(getProtocol$3("p2p").code));let st=nt.peerRecordEnvelope;if(it.length>0&&st==null){const ut=new PeerRecord({peerId:this.components.peerId,multiaddrs:it}),ft=await RecordEnvelope.seal(ut,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(ft),st=ft.marshal().subarray()}const ot=Identify.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:rt,listenAddrs:it.map(ut=>ut.bytes),signedPeerRecord:st,observedAddr:$.remoteAddr.bytes,protocols:nt.protocols}),at=abortableDuplex(j,et.signal),ct=pipe([ot],encode$5());await at.sink(ct)}catch(rt){log$t.error("could not respond to identify request",rt)}finally{j.close(),et.clear()}}async _handlePush(o){var nt;const{connection:$,stream:j}=o,et=new timeoutAbortController.TimeoutController(this.init.timeout);try{(nt=eventsExports.setMaxListeners)==null||nt.call(eventsExports,1/0,et.signal)}catch{}let tt;try{const it=abortableDuplex(j,et.signal),st=await pipe([],it,decode$3({maxDataLength:this.init.maxIdentifyMessageSize??MAX_IDENTIFY_MESSAGE_SIZE}),async ot=>await first(ot));st!=null&&(tt=Identify.decode(st))}catch(it){return log$t.error("received invalid message",it)}finally{j.close(),et.clear()}if(tt==null)return log$t.error("received invalid message");const rt=$.remotePeer;if(this.components.peerId.equals(rt)){log$t("received push from ourselves?");return}if(log$t("received push from %p",rt),tt.signedPeerRecord!=null){log$t("received signedPeerRecord in push");try{const it=await RecordEnvelope.openAndCertify(tt.signedPeerRecord,PeerRecord.DOMAIN);if(await this.components.peerStore.addressBook.consumePeerRecord(it)){log$t("consumed signedPeerRecord sent in push"),await this.components.peerStore.protoBook.set(rt,tt.protocols);return}else log$t("failed to consume signedPeerRecord sent in push")}catch(it){log$t("received invalid envelope, discard it and fallback to listenAddrs is available",it)}}else log$t("did not receive signedPeerRecord in push");try{await this.components.peerStore.addressBook.set(rt,tt.listenAddrs.map(it=>multiaddr$3(it)))}catch(it){log$t.error("received invalid addrs",it)}try{await this.components.peerStore.protoBook.set(rt,tt.protocols)}catch(it){log$t.error("received invalid protocols",it)}log$t("handled push from %p",rt)}static getCleanMultiaddr(o){if(o!=null&&o.length>0)try{return multiaddr$3(o)}catch{}}}var FetchRequest;(function(_){let o;_.codec=()=>(o==null&&(o=message$1(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),(et.writeDefaults===!0||$.identifier!=="")&&(j.uint32(10),j.string($.identifier)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={identifier:""},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.identifier=$.string();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$1($,_.codec()),_.decode=$=>decodeMessage$1($,_.codec())})(FetchRequest||(FetchRequest={}));var FetchResponse;(function(_){let o;(function(et){et.OK="OK",et.NOT_FOUND="NOT_FOUND",et.ERROR="ERROR"})(o=_.StatusCode||(_.StatusCode={}));let $;(function(et){et[et.OK=0]="OK",et[et.NOT_FOUND=1]="NOT_FOUND",et[et.ERROR=2]="ERROR"})($||($={})),function(et){et.codec=()=>enumeration($)}(o=_.StatusCode||(_.StatusCode={}));let j;_.codec=()=>(j==null&&(j=message$1((et,tt,rt={})=>{rt.lengthDelimited!==!1&&tt.fork(),(rt.writeDefaults===!0||et.status!=null&&$[et.status]!==0)&&(tt.uint32(8),_.StatusCode.codec().encode(et.status,tt)),(rt.writeDefaults===!0||et.data!=null&&et.data.byteLength>0)&&(tt.uint32(18),tt.bytes(et.data)),rt.lengthDelimited!==!1&&tt.ldelim()},(et,tt)=>{const rt={status:o.OK,data:new Uint8Array(0)},nt=tt==null?et.len:et.pos+tt;for(;et.pos<nt;){const it=et.uint32();switch(it>>>3){case 1:rt.status=_.StatusCode.codec().decode(et);break;case 2:rt.data=et.bytes();break;default:et.skipType(it&7);break}}return rt})),j),_.encode=et=>encodeMessage$1(et,_.codec()),_.decode=et=>decodeMessage$1(et,_.codec())})(FetchResponse||(FetchResponse={}));const PROTOCOL_VERSION$1="0.0.1",PROTOCOL_NAME$1="fetch",log$s=logger$1("libp2p:fetch");class FetchService{constructor(o,$){this.started=!1,this.components=o,this.protocol=`/${$.protocolPrefix??"libp2p"}/${PROTOCOL_NAME$1}/${PROTOCOL_VERSION$1}`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this),this.init=$}async start(){await this.components.registrar.handle(this.protocol,o=>{this.handleMessage(o).catch($=>{log$s.error($)}).finally(()=>{o.stream.close()})},{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(o,$,j={}){var it;log$s("dialing %s to %p",this.protocol,o);const et=await this.components.connectionManager.openConnection(o,j);let tt,rt=j.signal,nt;if(rt==null){log$s("using default timeout of %d ms",this.init.timeout),tt=new timeoutAbortController.TimeoutController(this.init.timeout),rt=tt.signal;try{(it=eventsExports.setMaxListeners)==null||it.call(eventsExports,1/0,tt.signal)}catch{}}try{nt=await et.newStream(this.protocol,{signal:rt});const st=abortableDuplex(nt,rt);return log$s("fetch %s",$),await pipe([FetchRequest.encode({identifier:$})],encode$5(),st,decode$3(),async function(at){const ct=await first(at);if(ct==null)throw errCode(new Error("No data received"),codes$2.ERR_INVALID_MESSAGE);const ut=FetchResponse.decode(ct);switch(ut.status){case FetchResponse.StatusCode.OK:return log$s("received status for %s ok",$),ut.data;case FetchResponse.StatusCode.NOT_FOUND:return log$s("received status for %s not found",$),null;case FetchResponse.StatusCode.ERROR:{log$s("received status for %s error",$);const ft=toString$a(ut.data);throw errCode(new Error("Error in fetch protocol response: "+ft),codes$2.ERR_INVALID_PARAMETERS)}default:throw log$s("received status for %s unknown",$),errCode(new Error("Unknown response status"),codes$2.ERR_INVALID_MESSAGE)}})??null}finally{tt!=null&&tt.clear(),nt!=null&&nt.close()}}async handleMessage(o){const{stream:$}=o,j=this;await pipe($,decode$3(),async function*(et){const tt=await first(et);if(tt==null)throw errCode(new Error("No data received"),codes$2.ERR_INVALID_MESSAGE);const rt=FetchRequest.decode(tt);let nt;const it=j._getLookupFunction(rt.identifier);if(it!=null){log$s("look up data with identifier %s",rt.identifier);const st=await it(rt.identifier);st!=null?(log$s("sending status for %s ok",rt.identifier),nt={status:FetchResponse.StatusCode.OK,data:st}):(log$s("sending status for %s not found",rt.identifier),nt={status:FetchResponse.StatusCode.NOT_FOUND,data:new Uint8Array(0)})}else{log$s("sending status for %s error",rt.identifier);const st=fromString$8(`No lookup function registered for key: ${rt.identifier}`);nt={status:FetchResponse.StatusCode.ERROR,data:st}}yield FetchResponse.encode(nt)},encode$5(),$)}_getLookupFunction(o){for(const $ of this.lookupFunctions.keys())if(o.startsWith($))return this.lookupFunctions.get($)}registerLookupFunction(o,$){if(this.lookupFunctions.has(o))throw errCode(new Error("Fetch protocol handler for key prefix '"+o+"' already registered"),codes$2.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(o,$)}unregisterLookupFunction(o,$){$!=null&&this.lookupFunctions.get(o)!==$||this.lookupFunctions.delete(o)}}const PING_LENGTH=32,PROTOCOL_VERSION="1.0.0",PROTOCOL_NAME="ping",log$r=logger$1("libp2p:ping");class PingService{constructor(o,$){this.components=o,this.started=!1,this.protocol=`/${$.protocolPrefix}/${PROTOCOL_NAME}/${PROTOCOL_VERSION}`,this.init=$}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(o){const{stream:$}=o;pipe($,$).catch(j=>{log$r.error(j)})}async ping(o,$={}){var st;log$r("dialing %s to %p",this.protocol,o);const j=Date.now(),et=randomBytes$3(PING_LENGTH),tt=await this.components.connectionManager.openConnection(o,$);let rt,nt=$.signal,it;if(nt==null){rt=new timeoutAbortController.TimeoutController(this.init.timeout),nt=rt.signal;try{(st=eventsExports.setMaxListeners)==null||st.call(eventsExports,1/0,rt.signal)}catch{}}try{it=await tt.newStream([this.protocol],{signal:nt});const ot=abortableDuplex(it,nt),at=await pipe([et],ot,async ut=>await first(ut)),ct=Date.now();if(at==null||!equals$6(et,at.subarray()))throw errCode(new Error("Received wrong ping ack"),codes$2.ERR_WRONG_PING_ACK);return ct-j}finally{rt!=null&&rt.clear(),it!=null&&it.close()}}}async function upnpNat(){throw new Error("Not supported in browsers")}function isLoopbackAddr(_){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(_)||/^::1$/.test(_)}function isLoopback(_){const{address:o}=_.nodeAddress();return isLoopbackAddr(o)}const log$q=logger$1("libp2p:nat"),DEFAULT_TTL=7200;function highPort(_=1024,o=65535){return Math.floor(Math.random()*(o-_+1)+_)}class NatManager{constructor(o,$){if(this.components=o,this.started=!1,this.enabled=$.enabled,this.externalAddress=$.externalAddress,this.localAddress=$.localAddress,this.description=$.description??`${name}@${version} ${this.components.peerId.toString()}`,this.ttl=$.ttl??DEFAULT_TTL,this.keepAlive=$.keepAlive??!0,this.gateway=$.gateway,this.ttl<DEFAULT_TTL)throw errCode(new Error(`NatManager ttl should be at least ${DEFAULT_TTL} seconds`),codes$2.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){isBrowser$2||!this.enabled||this.started||(this.started=!0,this._start().catch(o=>{log$q.error(o)}))}async _start(){const o=this.components.transportManager.getAddrs();for(const $ of o){const{family:j,host:et,port:tt,transport:rt}=$.toOptions();if(!$.isThinWaistAddress()||rt!=="tcp"||isLoopback($)||j!==4)continue;const nt=await this._getClient(),it=this.externalAddress??await nt.externalIp(),st=is_ip_private(it);if(st===!0)throw new Error(`${it} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);if(st==null)throw new Error(`${it} is not an IP address`);const ot=highPort();log$q(`opening uPnP connection from ${it}:${ot} to ${et}:${tt}`),await nt.map({publicPort:ot,localPort:tt,localAddress:this.localAddress,protocol:rt.toUpperCase()==="TCP"?"TCP":"UDP"}),this.components.addressManager.addObservedAddr(fromNodeAddress({family:4,address:it,port:ot},rt))}}async _getClient(){return this.client!=null?this.client:(this.client=await upnpNat({description:this.description,ttl:this.ttl,keepAlive:this.keepAlive,gateway:this.gateway}),this.client)}async stop(){if(!(isBrowser$2||this.client==null))try{await this.client.close(),this.client=void 0}catch(o){log$q.error(o)}}}const log$p=logger$1("libp2p:peer-record-updater");class PeerRecordUpdater{constructor(o){this.components=o,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.transportManager.addEventListener("listener:listening",this.update),this.components.transportManager.addEventListener("listener:close",this.update),this.components.addressManager.addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.transportManager.removeEventListener("listener:listening",this.update),this.components.transportManager.removeEventListener("listener:close",this.update),this.components.addressManager.removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then(async()=>{const o=new PeerRecord({peerId:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map(j=>j.decapsulateCode(getProtocol$3("p2p").code))}),$=await RecordEnvelope.seal(o,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord($)}).catch(o=>{log$p.error("Could not update self peer record: %o",o)})}}class DHTPeerRouting{constructor(o){this.dht=o}async findPeer(o,$={}){for await(const j of this.dht.findPeer(o,$))if(j.name==="FINAL_PEER")return j.peer;throw errCode(new Error(messages.NOT_FOUND),codes$2.ERR_NOT_FOUND)}async*getClosestPeers(o,$={}){for await(const j of this.dht.getClosestPeers(o,$))j.name==="FINAL_PEER"&&(yield j.peer)}}const codes$1={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"},log$o=logger$1("libp2p:peer-store:address-book"),EVENT_NAME$3="change:multiaddrs";async function allowAll(){return!0}class PeerStoreAddressBook{constructor(o,$,j){this.dispatchEvent=o,this.store=$,this.addressFilter=j??allowAll}async consumePeerRecord(o){log$o.trace("consumePeerRecord await write lock");const $=await this.store.lock.writeLock();log$o.trace("consumePeerRecord got write lock");let j,et,tt;try{let rt;try{rt=PeerRecord.createFromProtobuf(o.payload)}catch{return log$o.error("invalid peer record received"),!1}j=rt.peerId;const nt=rt.multiaddrs;if(!j.equals(o.peerId))return log$o("signing key does not match PeerId in the PeerRecord"),!1;if(nt==null||nt.length===0)return!1;if(await this.store.has(j)&&(et=await this.store.load(j),et.peerRecordEnvelope!=null)){const st=await RecordEnvelope.createFromProtobuf(et.peerRecordEnvelope),ot=PeerRecord.createFromProtobuf(st.payload);if(ot.seqNumber>=rt.seqNumber)return log$o("sequence number was lower or equal to existing sequence number - stored: %d received: %d",ot.seqNumber,rt.seqNumber),!1}const it=await filterMultiaddrs(j,nt,this.addressFilter,!0);tt=await this.store.patchOrCreate(j,{addresses:it,peerRecordEnvelope:o.marshal().subarray()}),log$o("stored provided peer record for %p",rt.peerId)}finally{log$o.trace("consumePeerRecord release write lock"),$()}return this.dispatchEvent(new CustomEvent(EVENT_NAME$3,{detail:{peerId:j,multiaddrs:tt.addresses.map(({multiaddr:rt})=>rt),oldMultiaddrs:et==null?[]:et.addresses.map(({multiaddr:rt})=>rt)}})),!0}async getRawEnvelope(o){log$o.trace("getRawEnvelope await read lock");const $=await this.store.lock.readLock();log$o.trace("getRawEnvelope got read lock");try{return(await this.store.load(o)).peerRecordEnvelope}catch(j){if(j.code!==codes$1.ERR_NOT_FOUND)throw j}finally{log$o.trace("getRawEnvelope release read lock"),$()}}async getPeerRecord(o){const $=await this.getRawEnvelope(o);if($!=null)return await RecordEnvelope.createFromProtobuf($)}async get(o){o=peerIdFromPeerId(o),log$o.trace("get wait for read lock");const $=await this.store.lock.readLock();log$o.trace("get got read lock");try{return(await this.store.load(o)).addresses}catch(j){if(j.code!==codes$1.ERR_NOT_FOUND)throw j}finally{log$o.trace("get release read lock"),$()}return[]}async set(o,$){if(o=peerIdFromPeerId(o),!Array.isArray($))throw log$o.error("multiaddrs must be an array of Multiaddrs"),new CodeError("multiaddrs must be an array of Multiaddrs",codes$1.ERR_INVALID_PARAMETERS);log$o.trace("set await write lock");const j=await this.store.lock.writeLock();log$o.trace("set got write lock");let et=!1,tt,rt;try{const nt=await filterMultiaddrs(o,$,this.addressFilter);if(nt.length===0)return;try{if(tt=await this.store.load(o),et=!0,new Set([...nt.map(({multiaddr:it})=>it.toString()),...tt.addresses.map(({multiaddr:it})=>it.toString())]).size===tt.addresses.length&&nt.length===tt.addresses.length)return}catch(it){if(it.code!==codes$1.ERR_NOT_FOUND)throw it}rt=await this.store.patchOrCreate(o,{addresses:nt}),log$o("set multiaddrs for %p",o)}finally{log$o.trace("set multiaddrs for %p",o),log$o("set release write lock"),j()}this.dispatchEvent(new CustomEvent(EVENT_NAME$3,{detail:{peerId:o,multiaddrs:rt.addresses.map(nt=>nt.multiaddr),oldMultiaddrs:tt==null?[]:tt.addresses.map(({multiaddr:nt})=>nt)}})),et||this.dispatchEvent(new CustomEvent("peer",{detail:{id:o,multiaddrs:rt.addresses.map(nt=>nt.multiaddr),protocols:rt.protocols}}))}async add(o,$){if(o=peerIdFromPeerId(o),!Array.isArray($))throw log$o.error("multiaddrs must be an array of Multiaddrs"),new CodeError("multiaddrs must be an array of Multiaddrs",codes$1.ERR_INVALID_PARAMETERS);log$o.trace("add await write lock");const j=await this.store.lock.writeLock();log$o.trace("add got write lock");let et,tt,rt;try{const nt=await filterMultiaddrs(o,$,this.addressFilter);if(nt.length===0)return;try{if(tt=await this.store.load(o),et=!0,new Set([...nt.map(({multiaddr:it})=>it.toString()),...tt.addresses.map(({multiaddr:it})=>it.toString())]).size===tt.addresses.length)return}catch(it){if(it.code!==codes$1.ERR_NOT_FOUND)throw it}rt=await this.store.mergeOrCreate(o,{addresses:nt}),log$o("added multiaddrs for %p",o)}finally{log$o.trace("set release write lock"),j()}this.dispatchEvent(new CustomEvent(EVENT_NAME$3,{detail:{peerId:o,multiaddrs:rt.addresses.map(nt=>nt.multiaddr),oldMultiaddrs:tt==null?[]:tt.addresses.map(({multiaddr:nt})=>nt)}})),et===!0&&this.dispatchEvent(new CustomEvent("peer",{detail:{id:o,multiaddrs:rt.addresses.map(nt=>nt.multiaddr),protocols:rt.protocols}}))}async delete(o){o=peerIdFromPeerId(o),log$o.trace("delete await write lock");const $=await this.store.lock.writeLock();log$o.trace("delete got write lock");let j;try{try{j=await this.store.load(o)}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et}await this.store.patchOrCreate(o,{addresses:[]})}finally{log$o.trace("delete release write lock"),$()}j!=null&&this.dispatchEvent(new CustomEvent(EVENT_NAME$3,{detail:{peerId:o,multiaddrs:[],oldMultiaddrs:j==null?[]:j.addresses.map(({multiaddr:et})=>et)}}))}}async function filterMultiaddrs(_,o,$,j=!1){const et=[];return await Promise.all(o.map(async tt=>{if(!isMultiaddr$3(tt))throw log$o.error("multiaddr must be an instance of Multiaddr"),new CodeError("multiaddr must be an instance of Multiaddr",codes$1.ERR_INVALID_PARAMETERS);await $(_,tt)&&et.push({multiaddr:tt,isCertified:j})})),et}const log$n=logger$1("libp2p:peer-store:key-book"),EVENT_NAME$2="change:pubkey";class PeerStoreKeyBook{constructor(o,$){this.dispatchEvent=o,this.store=$}async set(o,$){if(o=peerIdFromPeerId(o),!($ instanceof Uint8Array))throw log$n.error("publicKey must be an instance of Uint8Array to store data"),new CodeError("publicKey must be an instance of PublicKey",codes$1.ERR_INVALID_PARAMETERS);log$n.trace("set await write lock");const j=await this.store.lock.writeLock();log$n.trace("set got write lock");let et=!1,tt;try{try{if(tt=await this.store.load(o),tt.pubKey!=null&&equals$6(tt.pubKey,$))return}catch(rt){if(rt.code!==codes$1.ERR_NOT_FOUND)throw rt}await this.store.patchOrCreate(o,{pubKey:$}),et=!0}finally{log$n.trace("set release write lock"),j()}et&&this.dispatchEvent(new CustomEvent(EVENT_NAME$2,{detail:{peerId:o,publicKey:$,oldPublicKey:tt==null?void 0:tt.pubKey}}))}async get(o){o=peerIdFromPeerId(o),log$n.trace("get await write lock");const $=await this.store.lock.readLock();log$n.trace("get got write lock");try{return(await this.store.load(o)).pubKey}catch(j){if(j.code!==codes$1.ERR_NOT_FOUND)throw j}finally{log$n("get release write lock"),$()}}async delete(o){o=peerIdFromPeerId(o),log$n.trace("delete await write lock");const $=await this.store.lock.writeLock();log$n.trace("delete got write lock");let j;try{try{j=await this.store.load(o)}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et}await this.store.patchOrCreate(o,{pubKey:void 0})}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et}finally{log$n.trace("delete release write lock"),$()}this.dispatchEvent(new CustomEvent(EVENT_NAME$2,{detail:{peerId:o,publicKey:void 0,oldPublicKey:j==null?void 0:j.pubKey}}))}}const log$m=logger$1("libp2p:peer-store:metadata-book"),EVENT_NAME$1="change:metadata";class PeerStoreMetadataBook{constructor(o,$){this.dispatchEvent=o,this.store=$}async get(o){o=peerIdFromPeerId(o),log$m.trace("get await read lock");const $=await this.store.lock.readLock();log$m.trace("get got read lock");try{return(await this.store.load(o)).metadata}catch(j){if(j.code!==codes$1.ERR_NOT_FOUND)throw j}finally{log$m.trace("get release read lock"),$()}return new Map}async getValue(o,$){o=peerIdFromPeerId(o),log$m.trace("getValue await read lock");const j=await this.store.lock.readLock();log$m.trace("getValue got read lock");try{return(await this.store.load(o)).metadata.get($)}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et}finally{log$m.trace("getValue release write lock"),j()}}async set(o,$){if(o=peerIdFromPeerId(o),!($ instanceof Map))throw log$m.error("valid metadata must be provided to store data"),new CodeError("valid metadata must be provided",codes$1.ERR_INVALID_PARAMETERS);log$m.trace("set await write lock");const j=await this.store.lock.writeLock();log$m.trace("set got write lock");let et;try{try{et=await this.store.load(o)}catch(tt){if(tt.code!==codes$1.ERR_NOT_FOUND)throw tt}await this.store.mergeOrCreate(o,{metadata:$})}finally{log$m.trace("set release write lock"),j()}this.dispatchEvent(new CustomEvent(EVENT_NAME$1,{detail:{peerId:o,metadata:$,oldMetadata:et==null?new Map:et.metadata}}))}async setValue(o,$,j){if(o=peerIdFromPeerId(o),typeof $!="string"||!(j instanceof Uint8Array))throw log$m.error("valid key and value must be provided to store data"),new CodeError("valid key and value must be provided",codes$1.ERR_INVALID_PARAMETERS);log$m.trace("setValue await write lock");const et=await this.store.lock.writeLock();log$m.trace("setValue got write lock");let tt,rt;try{try{tt=await this.store.load(o);const nt=tt.metadata.get($);if(nt!=null&&equals$6(j,nt))return}catch(nt){if(nt.code!==codes$1.ERR_NOT_FOUND)throw nt}rt=await this.store.mergeOrCreate(o,{metadata:new Map([[$,j]])})}finally{log$m.trace("setValue release write lock"),et()}this.dispatchEvent(new CustomEvent(EVENT_NAME$1,{detail:{peerId:o,metadata:rt.metadata,oldMetadata:tt==null?new Map:tt.metadata}}))}async delete(o){o=peerIdFromPeerId(o),log$m.trace("delete await write lock");const $=await this.store.lock.writeLock();log$m.trace("delete got write lock");let j;try{try{j=await this.store.load(o)}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et}j!=null&&await this.store.patch(o,{metadata:new Map})}finally{log$m.trace("delete release write lock"),$()}j!=null&&this.dispatchEvent(new CustomEvent(EVENT_NAME$1,{detail:{peerId:o,metadata:new Map,oldMetadata:j.metadata}}))}async deleteValue(o,$){o=peerIdFromPeerId(o),log$m.trace("deleteValue await write lock");const j=await this.store.lock.writeLock();log$m.trace("deleteValue got write lock");let et,tt;try{tt=await this.store.load(o),et=tt.metadata,et.delete($),await this.store.patch(o,{metadata:et})}catch(rt){if(rt.code!==codes$1.ERR_NOT_FOUND)throw rt}finally{log$m.trace("deleteValue release write lock"),j()}et!=null&&this.dispatchEvent(new CustomEvent(EVENT_NAME$1,{detail:{peerId:o,metadata:et,oldMetadata:tt==null?new Map:tt.metadata}}))}}const log$l=logger$1("libp2p:peer-store:proto-book"),EVENT_NAME="change:protocols";class PeerStoreProtoBook{constructor(o,$){this.dispatchEvent=o,this.store=$}async get(o){log$l.trace("get wait for read lock");const $=await this.store.lock.readLock();log$l.trace("get got read lock");try{return(await this.store.load(o)).protocols}catch(j){if(j.code!==codes$1.ERR_NOT_FOUND)throw j}finally{log$l.trace("get release read lock"),$()}return[]}async set(o,$){if(o=peerIdFromPeerId(o),!Array.isArray($))throw log$l.error("protocols must be provided to store data"),new CodeError("protocols must be provided",codes$1.ERR_INVALID_PARAMETERS);log$l.trace("set await write lock");const j=await this.store.lock.writeLock();log$l.trace("set got write lock");let et,tt;try{try{if(et=await this.store.load(o),new Set([...$]).size===et.protocols.length)return}catch(rt){if(rt.code!==codes$1.ERR_NOT_FOUND)throw rt}tt=await this.store.patchOrCreate(o,{protocols:$}),log$l("stored provided protocols for %p",o)}finally{log$l.trace("set release write lock"),j()}this.dispatchEvent(new CustomEvent(EVENT_NAME,{detail:{peerId:o,protocols:tt.protocols,oldProtocols:et==null?[]:et.protocols}}))}async add(o,$){if(o=peerIdFromPeerId(o),!Array.isArray($))throw log$l.error("protocols must be provided to store data"),new CodeError("protocols must be provided",codes$1.ERR_INVALID_PARAMETERS);log$l.trace("add await write lock");const j=await this.store.lock.writeLock();log$l.trace("add got write lock");let et,tt;try{try{if(et=await this.store.load(o),new Set([...et.protocols,...$]).size===et.protocols.length)return}catch(rt){if(rt.code!==codes$1.ERR_NOT_FOUND)throw rt}tt=await this.store.mergeOrCreate(o,{protocols:$}),log$l("added provided protocols for %p",o)}finally{log$l.trace("add release write lock"),j()}this.dispatchEvent(new CustomEvent(EVENT_NAME,{detail:{peerId:o,protocols:tt.protocols,oldProtocols:et==null?[]:et.protocols}}))}async remove(o,$){if(o=peerIdFromPeerId(o),!Array.isArray($))throw log$l.error("protocols must be provided to store data"),new CodeError("protocols must be provided",codes$1.ERR_INVALID_PARAMETERS);log$l.trace("remove await write lock");const j=await this.store.lock.writeLock();log$l.trace("remove got write lock");let et,tt;try{try{et=await this.store.load(o);const rt=new Set(et.protocols);for(const nt of $)rt.delete(nt);if(et.protocols.length===rt.size)return;$=Array.from(rt)}catch(rt){if(rt.code!==codes$1.ERR_NOT_FOUND)throw rt}tt=await this.store.patchOrCreate(o,{protocols:$})}finally{log$l.trace("remove release write lock"),j()}this.dispatchEvent(new CustomEvent(EVENT_NAME,{detail:{peerId:o,protocols:tt.protocols,oldProtocols:et==null?[]:et.protocols}}))}async delete(o){o=peerIdFromPeerId(o),log$l.trace("delete await write lock");const $=await this.store.lock.writeLock();log$l.trace("delete got write lock");let j;try{try{j=await this.store.load(o)}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et}await this.store.patchOrCreate(o,{protocols:[]})}finally{log$l.trace("delete release write lock"),$()}j!=null&&this.dispatchEvent(new CustomEvent(EVENT_NAME,{detail:{peerId:o,protocols:[],oldProtocols:j.protocols}}))}}var Peer;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{if(et.lengthDelimited!==!1&&j.fork(),$.addresses!=null)for(const tt of $.addresses)j.uint32(10),Address.codec().encode(tt,j);if($.protocols!=null)for(const tt of $.protocols)j.uint32(18),j.string(tt);if($.metadata!=null)for(const tt of $.metadata)j.uint32(26),Metadata.codec().encode(tt,j);$.pubKey!=null&&(j.uint32(34),j.bytes($.pubKey)),$.peerRecordEnvelope!=null&&(j.uint32(42),j.bytes($.peerRecordEnvelope)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={addresses:[],protocols:[],metadata:[]},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.addresses.push(Address.codec().decode($,$.uint32()));break;case 2:et.protocols.push($.string());break;case 3:et.metadata.push(Metadata.codec().decode($,$.uint32()));break;case 4:et.pubKey=$.bytes();break;case 5:et.peerRecordEnvelope=$.bytes();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Peer||(Peer={}));var Address;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.multiaddr!=null&&$.multiaddr.byteLength>0&&(j.uint32(10),j.bytes($.multiaddr)),$.isCertified!=null&&(j.uint32(16),j.bool($.isCertified)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={multiaddr:new Uint8Array(0)},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.multiaddr=$.bytes();break;case 2:et.isCertified=$.bool();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Address||(Address={}));var Metadata;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.key!=null&&$.key!==""&&(j.uint32(10),j.string($.key)),$.value!=null&&$.value.byteLength>0&&(j.uint32(18),j.bytes($.value)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={key:"",value:new Uint8Array(0)},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.key=$.string();break;case 2:et.value=$.bytes();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Metadata||(Metadata={}));const log$k=logger$1("libp2p:peer-store:store"),NAMESPACE_COMMON="/peers/";class PersistentStore{constructor(o){this.components=o,this.lock=createMortice({name:"peer-store",singleProcess:!0})}_peerIdToDatastoreKey(o){if(o.type==null)throw log$k.error("peerId must be an instance of peer-id to store data"),new CodeError("peerId must be an instance of peer-id",codes$1.ERR_INVALID_PARAMETERS);const $=o.toCID().toString();return new Key(`${NAMESPACE_COMMON}${$}`)}async has(o){return await this.components.datastore.has(this._peerIdToDatastoreKey(o))}async delete(o){await this.components.datastore.delete(this._peerIdToDatastoreKey(o))}async load(o){const $=await this.components.datastore.get(this._peerIdToDatastoreKey(o)),j=Peer.decode($),et=new Map;for(const tt of j.metadata)et.set(tt.key,tt.value);return{...j,id:o,addresses:j.addresses.map(({multiaddr:tt,isCertified:rt})=>({multiaddr:multiaddr$3(tt),isCertified:rt??!1})),metadata:et,pubKey:j.pubKey??void 0,peerRecordEnvelope:j.peerRecordEnvelope??void 0}}async save(o){if(o.pubKey!=null&&o.id.publicKey!=null&&!equals$6(o.pubKey,o.id.publicKey))throw log$k.error("peer publicKey bytes do not match peer id publicKey bytes"),new CodeError("publicKey bytes do not match peer id publicKey bytes",codes$1.ERR_INVALID_PARAMETERS);const $=new Set,j=o.addresses.filter(rt=>$.has(rt.multiaddr.toString())?!1:($.add(rt.multiaddr.toString()),!0)).sort((rt,nt)=>rt.multiaddr.toString().localeCompare(nt.multiaddr.toString())).map(({multiaddr:rt,isCertified:nt})=>({multiaddr:rt.bytes,isCertified:nt})),et=[];[...o.metadata.keys()].sort().forEach(rt=>{const nt=o.metadata.get(rt);nt!=null&&et.push({key:rt,value:nt})});const tt=Peer.encode({addresses:j,protocols:o.protocols.sort(),pubKey:o.pubKey,metadata:et,peerRecordEnvelope:o.peerRecordEnvelope});return await this.components.datastore.put(this._peerIdToDatastoreKey(o.id),tt.subarray()),await this.load(o.id)}async patch(o,$){const j=await this.load(o);return await this._patch(o,$,j)}async patchOrCreate(o,$){let j;try{j=await this.load(o)}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et;j={id:o,addresses:[],protocols:[],metadata:new Map}}return await this._patch(o,$,j)}async _patch(o,$,j){return await this.save({...j,...$,id:o})}async merge(o,$){const j=await this.load(o);return await this._merge(o,$,j)}async mergeOrCreate(o,$){let j;try{j=await this.load(o)}catch(et){if(et.code!==codes$1.ERR_NOT_FOUND)throw et;j={id:o,addresses:[],protocols:[],metadata:new Map}}return await this._merge(o,$,j)}async _merge(o,$,j){var tt,rt;const et=new Map;return j.addresses.forEach(nt=>{et.set(nt.multiaddr.toString(),nt.isCertified)}),($.addresses??[]).forEach(nt=>{const it=nt.multiaddr.toString(),ot=!!et.get(it)||nt.isCertified;et.set(it,ot)}),await this.save({id:o,addresses:Array.from(et.entries()).map(([nt,it])=>({multiaddr:multiaddr$3(nt),isCertified:it})),protocols:Array.from(new Set([...j.protocols??[],...$.protocols??[]])),metadata:new Map([...((tt=j.metadata)==null?void 0:tt.entries())??[],...((rt=$.metadata)==null?void 0:rt.entries())??[]]),pubKey:$.pubKey??(j!=null?j.pubKey:void 0),peerRecordEnvelope:$.peerRecordEnvelope??(j!=null?j.peerRecordEnvelope:void 0)})}async*all(){for await(const o of this.components.datastore.queryKeys({prefix:NAMESPACE_COMMON})){const $=o.toString().split("/")[2],j=base32$6.decode($);yield this.load(peerIdFromBytes(j))}}}var Tags;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{if(et.lengthDelimited!==!1&&j.fork(),$.tags!=null)for(const tt of $.tags)j.uint32(10),Tag.codec().encode(tt,j);et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={tags:[]},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.tags.push(Tag.codec().decode($,$.uint32()));break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Tags||(Tags={}));var Tag;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.name!=null&&$.name!==""&&(j.uint32(10),j.string($.name)),$.value!=null&&(j.uint32(16),j.uint32($.value)),$.expiry!=null&&(j.uint32(24),j.uint64($.expiry)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={name:""},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.name=$.string();break;case 2:et.value=$.uint32();break;case 3:et.expiry=$.uint64();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Tag||(Tag={}));const log$j=logger$1("libp2p:peer-store");class PersistentPeerStore extends EventEmitter$1{constructor(o,$={}){super(),this.components=o,this.store=new PersistentStore(o),this.addressBook=new PeerStoreAddressBook(this.dispatchEvent.bind(this),this.store,$.addressFilter),this.keyBook=new PeerStoreKeyBook(this.dispatchEvent.bind(this),this.store),this.metadataBook=new PeerStoreMetadataBook(this.dispatchEvent.bind(this),this.store),this.protoBook=new PeerStoreProtoBook(this.dispatchEvent.bind(this),this.store)}async forEach(o){log$j.trace("getPeers await read lock");const $=await this.store.lock.readLock();log$j.trace("getPeers got read lock");try{for await(const j of this.store.all())j.id.equals(this.components.peerId)||o(j)}finally{log$j.trace("getPeers release read lock"),$()}}async all(){const o=[];return await this.forEach($=>{o.push($)}),o}async delete(o){log$j.trace("delete await write lock");const $=await this.store.lock.writeLock();log$j.trace("delete got write lock");try{await this.store.delete(o)}finally{log$j.trace("delete release write lock"),$()}}async get(o){log$j.trace("get await read lock");const $=await this.store.lock.readLock();log$j.trace("get got read lock");try{return await this.store.load(o)}finally{log$j.trace("get release read lock"),$()}}async has(o){log$j.trace("has await read lock");const $=await this.store.lock.readLock();log$j.trace("has got read lock");try{return await this.store.has(o)}finally{log$j.trace("has release read lock"),$()}}async tagPeer(o,$,j={}){const et=j.value??0,tt=Math.round(et),rt=j.ttl??void 0;if(tt!==et||tt<0||tt>100)throw new CodeError("Tag value must be between 0-100","ERR_TAG_VALUE_OUT_OF_BOUNDS");const nt=await this.metadataBook.getValue(o,"tags");let it=[];nt!=null&&(it=Tags.decode(nt).tags),it=it.filter(st=>st.name!==$),it.push({name:$,value:tt,expiry:rt==null?void 0:BigInt(Date.now()+rt)}),await this.metadataBook.setValue(o,"tags",Tags.encode({tags:it}).subarray())}async unTagPeer(o,$){const j=await this.metadataBook.getValue(o,"tags");let et=[];j!=null&&(et=Tags.decode(j).tags),et=et.filter(tt=>tt.name!==$),await this.metadataBook.setValue(o,"tags",Tags.encode({tags:et}).subarray())}async getTags(o){const $=await this.metadataBook.getValue(o,"tags");let j=[];$!=null&&(j=Tags.decode($).tags);const et=BigInt(Date.now()),tt=j.filter(rt=>rt.expiry==null||rt.expiry>et);return tt.length!==j.length&&await this.metadataBook.setValue(o,"tags",Tags.encode({tags:tt}).subarray()),tt.map(rt=>({name:rt.name,value:rt.value??0}))}}class DHTContentRouting{constructor(o){this.dht=o}async provide(o){await drain(this.dht.provide(o))}async*findProviders(o,$={}){for await(const j of this.dht.findProviders(o,$))j.name==="PROVIDER"&&(yield*j.providers)}async put(o,$,j){await drain(this.dht.put(o,$,j))}async get(o,$){for await(const j of this.dht.get(o,$))if(j.name==="VALUE")return j.value;throw errCode(new Error("Not found"),"ERR_NOT_FOUND")}}class DefaultComponents{constructor(o={}){this._started=!1,this._peerId=o.peerId,this._addressManager=o.addressManager,this._peerStore=o.peerStore,this._upgrader=o.upgrader,this._metrics=o.metrics,this._registrar=o.registrar,this._connectionManager=o.connectionManager,this._transportManager=o.transportManager,this._connectionGater=o.connectionGater,this._contentRouting=o.contentRouting,this._peerRouting=o.peerRouting,this._datastore=o.datastore,this._connectionProtector=o.connectionProtector,this._dht=o.dht,this._pubsub=o.pubsub,this._dialer=o.dialer}isStarted(){return this._started}async beforeStart(){await Promise.all(Object.values(this).filter(o=>isStartable(o)).map(async o=>{o.beforeStart!=null&&await o.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(o=>isStartable(o)).map(async o=>{await o.start()})),this._started=!0}async afterStart(){await Promise.all(Object.values(this).filter(o=>isStartable(o)).map(async o=>{o.afterStart!=null&&await o.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(o=>isStartable(o)).map(async o=>{o.beforeStop!=null&&await o.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(o=>isStartable(o)).map(async o=>{await o.stop()})),this._started=!1}async afterStop(){await Promise.all(Object.values(this).filter(o=>isStartable(o)).map(async o=>{o.afterStop!=null&&await o.afterStop()}))}get peerId(){if(this._peerId==null)throw errCode(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this._peerId}set peerId(o){this._peerId=o}get addressManager(){if(this._addressManager==null)throw errCode(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this._addressManager}set addressManager(o){this._addressManager=o}get peerStore(){if(this._peerStore==null)throw errCode(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this._peerStore}set peerStore(o){this._peerStore=o}get upgrader(){if(this._upgrader==null)throw errCode(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this._upgrader}set upgrader(o){this._upgrader=o}get registrar(){if(this._registrar==null)throw errCode(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this._registrar}set registrar(o){this._registrar=o}get connectionManager(){if(this._connectionManager==null)throw errCode(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this._connectionManager}set connectionManager(o){this._connectionManager=o}get transportManager(){if(this._transportManager==null)throw errCode(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this._transportManager}set transportManager(o){this._transportManager=o}get connectionGater(){if(this._connectionGater==null)throw errCode(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this._connectionGater}set connectionGater(o){this._connectionGater=o}get contentRouting(){if(this._contentRouting==null)throw errCode(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this._contentRouting}set contentRouting(o){this._contentRouting=o}get peerRouting(){if(this._peerRouting==null)throw errCode(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this._peerRouting}set peerRouting(o){this._peerRouting=o}get datastore(){if(this._datastore==null)throw errCode(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this._datastore}set datastore(o){this._datastore=o}get connectionProtector(){return this._connectionProtector}set connectionProtector(o){this._connectionProtector=o}get dialer(){if(this._dialer==null)throw errCode(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this._dialer}set dialer(o){this._dialer=o}get metrics(){return this._metrics}set metrics(o){this._metrics=o}get dht(){return this._dht}set dht(o){this._dht=o}get pubsub(){return this._pubsub}set pubsub(o){this._pubsub=o}}var s=1e3,m=s*60,h=m*60,d=h*24,w=d*7,y=d*365.25,ms=function(_,o){o=o||{};var $=typeof _;if($==="string"&&_.length>0)return parse(_);if($==="number"&&isFinite(_))return o.long?fmtLong(_):fmtShort(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function parse(_){if(_=String(_),!(_.length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(o){var $=parseFloat(o[1]),j=(o[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return $*y;case"weeks":case"week":case"w":return $*w;case"days":case"day":case"d":return $*d;case"hours":case"hour":case"hrs":case"hr":case"h":return $*h;case"minutes":case"minute":case"mins":case"min":case"m":return $*m;case"seconds":case"second":case"secs":case"sec":case"s":return $*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return $;default:return}}}}function fmtShort(_){var o=Math.abs(_);return o>=d?Math.round(_/d)+"d":o>=h?Math.round(_/h)+"h":o>=m?Math.round(_/m)+"m":o>=s?Math.round(_/s)+"s":_+"ms"}function fmtLong(_){var o=Math.abs(_);return o>=d?plural(_,o,d,"day"):o>=h?plural(_,o,h,"hour"):o>=m?plural(_,o,m,"minute"):o>=s?plural(_,o,s,"second"):_+" ms"}function plural(_,o,$,j){var et=o>=$*1.5;return Math.round(_/$)+" "+j+(et?"s":"")}var receptacle=Receptacle,toMS=ms,cache=Receptacle.prototype,counter$1=new Date%1e9;function getUID(){return(Math.random()*1e9>>>0)+counter$1++}function Receptacle(_){_=_||{},this.id=_.id||getUID(),this.max=_.max||1/0,this.items=_.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(_.lastModified||new Date);for(var o,$,j=this.items.length;j--;)o=this.items[j],$=new Date(o.expires)-new Date,this._lookup[o.key]=o,$>0?this.expire(o.key,$):$<=0&&this.delete(o.key)}cache.has=function(_){return _ in this._lookup};cache.get=function(_){if(!this.has(_))return null;var o=this._lookup[_];return o.refresh&&this.expire(_,o.refresh),this.items.splice(this.items.indexOf(o),1),this.items.push(o),o.value};cache.meta=function(_){if(!this.has(_))return null;var o=this._lookup[_];return"meta"in o?o.meta:null};cache.set=function(_,o,$){var j=this._lookup[_],et=this._lookup[_]={key:_,value:o};return this.lastModified=new Date,j?(clearTimeout(j.timeout),this.items.splice(this.items.indexOf(j),1,et)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(et),this.size++),$&&("ttl"in $&&this.expire(_,$.ttl),"meta"in $&&(et.meta=$.meta),$.refresh&&(et.refresh=$.ttl)),this};cache.delete=function(_){var o=this._lookup[_];return o?(this.lastModified=new Date,this.items.splice(this.items.indexOf(o),1),clearTimeout(o.timeout),delete this._lookup[_],this.size--,this):!1};cache.expire=function(_,o){var $=o||0,j=this._lookup[_];if(!j)return this;if(typeof $=="string"&&($=toMS(o)),typeof $!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(j.timeout),j.timeout=setTimeout(this.delete.bind(this,j.key),$),j.expires=Number(new Date)+$,this};cache.clear=function(){for(var _=this.items.length;_--;)this.delete(this.items[_].key);return this};cache.toJSON=function(){for(var _=new Array(this.items.length),o,$=_.length;$--;)o=this.items[$],_[$]={key:o.key,meta:o.meta,value:o.value,expires:o.expires,refresh:o.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:_}};const globalFetch=globalThis.fetch,globalHeaders=globalThis.Headers;function buildResource(_,o,$){return`${_}?name=${o}&type=${$}`}async function request(_,o){return await(await globalFetch(_,{headers:new globalHeaders({accept:"application/dns-json"}),signal:o})).json()}function getCacheKey(_,o){return`${o}_${_}`}const log$i=Object.assign(browserExports$1("dns-over-http-resolver"),{error:browserExports$1("dns-over-http-resolver:error")});class Resolver{constructor(o={}){this._cache=new receptacle({max:(o==null?void 0:o.maxCache)??100}),this._TXTcache=new receptacle({max:(o==null?void 0:o.maxCache)??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=o.request??request,this._abortControllers=[]}cancel(){this._abortControllers.forEach(o=>o.abort())}getServers(){return this._servers}_getShuffledServers(){const o=[...this._servers];for(let $=o.length-1;$>0;$--){const j=Math.floor(Math.random()*$),et=o[$];o[$]=o[j],o[j]=et}return o}setServers(o){this._servers=o}async resolve(o,$="A"){switch($){case"A":return await this.resolve4(o);case"AAAA":return await this.resolve6(o);case"TXT":return await this.resolveTxt(o);default:throw new Error(`${$} is not supported`)}}async resolve4(o){const $="A",j=this._cache.get(getCacheKey(o,$));if(j!=null)return j;let et=!1;for(const tt of this._getShuffledServers()){const rt=new AbortController;this._abortControllers.push(rt);try{const nt=await this._request(buildResource(tt,o,$),rt.signal),it=nt.Answer.map(ot=>ot.data),st=Math.min(...nt.Answer.map(ot=>ot.TTL));return this._cache.set(getCacheKey(o,$),it,{ttl:st}),it}catch{rt.signal.aborted&&(et=!0),log$i.error(`${tt} could not resolve ${o} record ${$}`)}finally{this._abortControllers=this._abortControllers.filter(nt=>nt!==rt)}}throw et?Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${o} record ${$}`)}async resolve6(o){const $="AAAA",j=this._cache.get(getCacheKey(o,$));if(j!=null)return j;let et=!1;for(const tt of this._getShuffledServers()){const rt=new AbortController;this._abortControllers.push(rt);try{const nt=await this._request(buildResource(tt,o,$),rt.signal),it=nt.Answer.map(ot=>ot.data),st=Math.min(...nt.Answer.map(ot=>ot.TTL));return this._cache.set(getCacheKey(o,$),it,{ttl:st}),it}catch{rt.signal.aborted&&(et=!0),log$i.error(`${tt} could not resolve ${o} record ${$}`)}finally{this._abortControllers=this._abortControllers.filter(nt=>nt!==rt)}}throw et?Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${o} record ${$}`)}async resolveTxt(o){const $="TXT",j=this._TXTcache.get(getCacheKey(o,$));if(j!=null)return j;let et=!1;for(const tt of this._getShuffledServers()){const rt=new AbortController;this._abortControllers.push(rt);try{const nt=await this._request(buildResource(tt,o,$),rt.signal),it=nt.Answer.map(ot=>[ot.data.replace(/['"]+/g,"")]),st=Math.min(...nt.Answer.map(ot=>ot.TTL));return this._TXTcache.set(getCacheKey(o,$),it,{ttl:st}),it}catch{rt.signal.aborted&&(et=!0),log$i.error(`${tt} could not resolve ${o} record ${$}`)}finally{this._abortControllers=this._abortControllers.filter(nt=>nt!==rt)}}throw et?Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${o} record ${$}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}}const{code:dnsaddrCode}=getProtocol$3("dnsaddr");async function dnsaddrResolver(_,o={}){const $=new Resolver;o.signal!=null&&o.signal.addEventListener("abort",()=>{$.cancel()});const j=_.getPeerId(),[,et]=_.stringTuples().find(([nt])=>nt===dnsaddrCode)??[];if(et==null)throw new Error("No hostname found in multiaddr");let rt=(await $.resolveTxt(`_dnsaddr.${et}`)).flat().map(nt=>nt.split("=")[1]).filter(Boolean);return j!=null&&(rt=rt.filter(nt=>nt.includes(j))),rt}const DIAL_TIMEOUT=3e4,INBOUND_UPGRADE_TIMEOUT=3e4,MAX_PARALLEL_DIALS=100,MAX_PER_PEER_DIALS=4,MAX_ADDRS_TO_DIAL=25,DefaultConfig={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:_=>_},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:MAX_PARALLEL_DIALS,maxDialsPerPeer:MAX_PER_PEER_DIALS,dialTimeout:DIAL_TIMEOUT,inboundUpgradeTimeout:INBOUND_UPGRADE_TIMEOUT,resolvers:{dnsaddr:dnsaddrResolver},addressSorter:publicAddressesFirst},connectionGater:{},transportManager:{faultTolerance:FaultTolerance.FATAL_ALL},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:ADVERTISE_BOOT_DELAY,enabled:!1,ttl:ADVERTISE_TTL},hop:{enabled:!1,active:!1,timeout:3e4},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:AGENT_VERSION},timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1},ping:{protocolPrefix:"ipfs",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4},fetch:{protocolPrefix:"libp2p",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4}};function validateConfig(_){var $,j;const o=mergeOptions$g(DefaultConfig,_);if(o.transports==null||o.transports.length<1)throw errCode(new Error(messages.ERR_TRANSPORTS_REQUIRED),codes$2.ERR_TRANSPORTS_REQUIRED);if(o.connectionEncryption==null||o.connectionEncryption.length===0)throw errCode(new Error(messages.CONN_ENCRYPTION_REQUIRED),codes$2.CONN_ENCRYPTION_REQUIRED);if(o.connectionProtector===null&&((j=($=globalThis.process)==null?void 0:$.env)==null?void 0:j.LIBP2P_FORCE_PNET)!=null)throw errCode(new Error(messages.ERR_PROTECTOR_REQUIRED),codes$2.ERR_PROTECTOR_REQUIRED);return o.identify.host.agentVersion===AGENT_VERSION&&(isNode||isElectronMain?o.identify.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(isBrowser$2||isWebWorker$1||isElectronRenderer||isReactNative$2)&&(o.identify.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`)),o}var PeerIdProto;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.id!=null&&(j.uint32(10),j.bytes($.id)),$.pubKey!=null&&(j.uint32(18),j.bytes($.pubKey)),$.privKey!=null&&(j.uint32(26),j.bytes($.privKey)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.id=$.bytes();break;case 2:et.pubKey=$.bytes();break;case 3:et.privKey=$.bytes();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(PeerIdProto||(PeerIdProto={}));const createEd25519PeerId=async()=>{const _=await generateKeyPair("Ed25519"),o=await createFromPrivKey(_);if(o.type==="Ed25519")return o;throw new Error(`Generated unexpected PeerId type "${o.type}"`)},createRSAPeerId=async _=>{const o=await generateKeyPair("RSA",(_==null?void 0:_.bits)??2048),$=await createFromPrivKey(o);if($.type==="RSA")return $;throw new Error(`Generated unexpected PeerId type "${$.type}"`)};async function createFromPrivKey(_){return await peerIdFromKeys(marshalPublicKey(_.public),marshalPrivateKey(_))}class DummyDHT extends EventEmitter$1{get[symbol$2](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}get lan(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}get(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}findProviders(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}findPeer(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}getClosestPeers(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}provide(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}put(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}async getMode(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}async setMode(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}async refreshRoutingTable(){throw errCode(new Error(messages.DHT_DISABLED),codes$2.DHT_DISABLED)}}class DummyPubSub extends EventEmitter$1{constructor(){super(...arguments),this.topicValidators=new Map}isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}get multicodecs(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}getPeers(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}getTopics(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}subscribe(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}unsubscribe(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}getSubscribers(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}async publish(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$2.ERR_PUBSUB_DISABLED)}}var fixedSize=class{constructor(o){if(!(o>0)||o-1&o)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(o),this.mask=o-1,this.top=0,this.btm=0,this.next=null}push(o){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=o,this.top=this.top+1&this.mask,!0)}shift(){const o=this.buffer[this.btm];if(o!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,o}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}};const FixedFIFO=fixedSize;var fastFifo=class{constructor(o){this.hwm=o||16,this.head=new FixedFIFO(this.hwm),this.tail=this.head}push(o){if(!this.head.push(o)){const $=this.head;this.head=$.next=new FixedFIFO(2*this.head.buffer.length),this.head.push(o)}}shift(){const o=this.tail.shift();if(o===void 0&&this.tail.next){const $=this.tail.next;return this.tail.next=null,this.tail=$,this.tail.shift()}return o}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}};const pDefer=()=>{const _={};return _.promise=new Promise((o,$)=>{_.resolve=o,_.reject=$}),_};var pDefer_1=pDefer;const Fifo=fastFifo,defer=pDefer_1;var pFifo=class{constructor(){this._buffer=new Fifo,this._waitingConsumers=new Fifo}push(o){const{promise:$,resolve:j}=defer();return this._buffer.push({chunk:o,resolve:j}),this._consume(),$}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){const o=this._waitingConsumers.shift(),$=this._buffer.shift();o.resolve($.chunk),$.resolve()}}shift(){const{promise:o,resolve:$}=defer();return this._waitingConsumers.push({resolve:$}),this._consume(),o}isEmpty(){return this._buffer.isEmpty()}};const log$h=logger$1("libp2p:dialer:dial-request");class DialRequest{constructor(o){const{addrs:$,dialAction:j,dialer:et}=o;this.addrs=$,this.dialer=et,this.dialAction=j}async run(o={}){var nt;const $=this.dialer.getTokens(this.addrs.length);if($.length<1)throw errCode(new Error("No dial tokens available"),codes$2.ERR_NO_DIAL_TOKENS);const j=new pFifo;for(const it of $)j.push(it).catch(st=>{log$h.error(st)});const et=this.addrs.map(()=>{var st;const it=new AbortController;try{(st=eventsExports.setMaxListeners)==null||st.call(eventsExports,1/0,it.signal)}catch{}return it});if(o.signal!=null)try{(nt=eventsExports.setMaxListeners)==null||nt.call(eventsExports,1/0,o.signal)}catch{}let tt=0,rt=!1;try{return await Promise.any(this.addrs.map(async(it,st)=>{const ot=await j.shift();if(rt)throw this.dialer.releaseToken($.splice($.indexOf(ot),1)[0]),errCode(new Error("dialAction already succeeded"),codes$2.ERR_ALREADY_SUCCEEDED);const at=et[st];if(at==null)throw errCode(new Error("dialAction did not come with an AbortController"),codes$2.ERR_INVALID_PARAMETERS);let ct;try{const ut=at.signal;ct=await this.dialAction(it,{...o,signal:o.signal!=null?anySignal_2([ut,o.signal]):ut}),et[st]=void 0}finally{tt++,this.addrs.length-tt>=$.length?j.push(ot).catch(ut=>{log$h.error(ut)}):this.dialer.releaseToken($.splice($.indexOf(ot),1)[0])}if(ct==null)throw errCode(new Error("dialAction led to empty object"),codes$2.ERR_TRANSPORT_DIAL_FAILED);return rt=!0,ct}))}finally{et.forEach(it=>{it!==void 0&&it.abort()}),$.forEach(it=>this.dialer.releaseToken(it))}}}const log$g=logger$1("libp2p:dialer");class DefaultDialer{constructor(o,$={}){this.started=!1,this.addressSorter=$.addressSorter??publicAddressesFirst,this.maxAddrsToDial=$.maxAddrsToDial??MAX_ADDRS_TO_DIAL,this.timeout=$.dialTimeout??DIAL_TIMEOUT,this.maxDialsPerPeer=$.maxDialsPerPeer??MAX_PER_PEER_DIALS,this.tokens=[...new Array($.maxParallelDials??MAX_PARALLEL_DIALS)].map((j,et)=>et),this.components=o,this.pendingDials=trackedMap({name:"libp2p_dialler_pending_dials",metrics:o.metrics}),this.pendingDialTargets=trackedMap({name:"libp2p_dialler_pending_dial_targets",metrics:o.metrics});for(const[j,et]of Object.entries($.resolvers??{}))resolvers$4.set(j,et)}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(const o of this.pendingDials.values())try{o.controller.abort()}catch($){log$g.error($)}this.pendingDials.clear();for(const o of this.pendingDialTargets.values())o.abort();this.pendingDialTargets.clear()}async dial(o,$={}){const{peerId:j,multiaddr:et}=getPeerAddress(o);if(j!=null){if(this.components.peerId.equals(j))throw errCode(new Error("Tried to dial self"),codes$2.ERR_DIALED_SELF);if(et!=null&&(log$g("storing multiaddrs %p",j,et),await this.components.peerStore.addressBook.add(j,[et])),await this.components.connectionGater.denyDialPeer(j))throw errCode(new Error("The dial request is blocked by gater.allowDialPeer"),codes$2.ERR_PEER_DIAL_INTERCEPTED)}log$g("creating dial target for %p",j);const tt=new AbortController,rt=randomId();this.pendingDialTargets.set(rt,tt);let nt=tt.signal;$.signal!=null&&(nt=anySignal_2([nt,$.signal]));let it;try{it=await this._createDialTarget({peerId:j,multiaddr:et},{...$,signal:nt})}finally{this.pendingDialTargets.delete(rt)}if(it.addrs.length===0)throw errCode(new Error("The dial request has no valid addresses"),codes$2.ERR_NO_VALID_ADDRESSES);const st=this.pendingDials.get(it.id)??this._createPendingDial(it,$);try{const ot=await st.promise;return log$g("dial succeeded to %s",it.id),ot}catch(ot){throw log$g("dial failed to %s",it.id,ot),st.controller.signal.aborted&&(ot.code=codes$2.ERR_TIMEOUT),log$g.error(ot),ot}finally{st.destroy()}}async _createDialTarget(o,$){let j=[];if(isMultiaddr$3(o.multiaddr)&&j.push(o.multiaddr),!isMultiaddr$3(o.multiaddr)&&isPeerId(o.peerId)&&j.push(...await this._loadAddresses(o.peerId)),j=(await Promise.all(j.map(async tt=>await this._resolve(tt,$)))).flat().filter(tt=>!!this.components.transportManager.transportForMultiaddr(tt)),j=[...new Set(j.map(tt=>tt.toString()))].map(tt=>multiaddr$3(tt)),j.length>this.maxAddrsToDial)throw errCode(new Error("dial with more addresses than allowed"),codes$2.ERR_TOO_MANY_ADDRESSES);const et=isPeerId(o.peerId)?o.peerId:void 0;if(et!=null){const tt=`/p2p/${et.toString()}`;j=j.map(rt=>{const nt=rt.getPeerId();return nt==null||!et.equals(nt)?rt.encapsulate(tt):rt})}return{id:et==null?randomId():et.toString(),addrs:j}}async _loadAddresses(o){const $=await this.components.peerStore.addressBook.get(o);return(await Promise.all($.map(async j=>await this.components.connectionGater.denyDialMultiaddr(o,j.multiaddr)?!1:j))).filter(isTruthy).sort(this.addressSorter).map(j=>j.multiaddr)}_createPendingDial(o,$={}){var st;const j=async(ot,at={})=>{var ct;if(((ct=at.signal)==null?void 0:ct.aborted)===!0)throw errCode(new Error("already aborted"),codes$2.ERR_ALREADY_ABORTED);return await this.components.transportManager.dial(ot,at).catch(ut=>{throw log$g.error("dial to %s failed",ot,ut),ut})},et=new DialRequest({addrs:o.addrs,dialAction:j,dialer:this}),tt=new timeoutAbortController.TimeoutController(this.timeout),rt=[tt.signal];$.signal!=null&&rt.push($.signal);const nt=anySignal_2(rt);try{(st=eventsExports.setMaxListeners)==null||st.call(eventsExports,1/0,nt)}catch{}const it={dialRequest:et,controller:tt,promise:et.run({...$,signal:nt}),destroy:()=>{tt.clear(),this.pendingDials.delete(o.id)}};return this.pendingDials.set(o.id,it),it}getTokens(o){const $=Math.min(o,this.maxDialsPerPeer,this.tokens.length),j=this.tokens.splice(0,$);return log$g("%d tokens request, returning %d, %d remaining",o,$,this.tokens.length),j}releaseToken(o){this.tokens.includes(o)||(log$g("token %d released",o),this.tokens.push(o))}async _resolve(o,$){if(!o.protoNames().includes("dnsaddr"))return[o];const et=await this._resolveRecord(o,$);return(await Promise.all(et.map(async nt=>await this._resolve(nt,$)))).flat().reduce((nt,it)=>(nt.find(st=>st.equals(it))==null&&nt.push(it),nt),[])}async _resolveRecord(o,$){try{return o=multiaddr$3(o.toString()),await o.resolve($)}catch(j){return log$g.error(`multiaddr ${o.toString()} could not be resolved`,j),[]}}}function isTruthy(_){return!!_}function randomId(){return`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`}const log$f=logger$1("libp2p");class Libp2pNode extends EventEmitter$1{constructor(o){super(),this.started=!1,this.peerId=o.peerId;const $=this.components=new DefaultComponents({peerId:o.peerId,datastore:o.datastore??new MemoryDatastore,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...o.connectionGater}});$.peerStore=new PersistentPeerStore($,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...o.peerStore}),this.services=[$],o.metrics!=null&&(this.metrics=this.components.metrics=this.configureComponent(o.metrics(this.components))),this.peerStore=this.components.peerStore,this.peerStore.addEventListener("peer",rt=>{const{detail:nt}=rt;this.dispatchEvent(new CustomEvent("peer:discovery",{detail:nt}))}),o.connectionProtector!=null&&(this.components.connectionProtector=o.connectionProtector($)),this.components.upgrader=new DefaultUpgrader(this.components,{connectionEncryption:(o.connectionEncryption??[]).map(rt=>this.configureComponent(rt(this.components))),muxers:(o.streamMuxers??[]).map(rt=>this.configureComponent(rt(this.components))),inboundUpgradeTimeout:o.connectionManager.inboundUpgradeTimeout}),this.components.dialer=new DefaultDialer(this.components,o.connectionManager),this.connectionManager=this.components.connectionManager=new DefaultConnectionManager(this.components,o.connectionManager),this.components.connectionManager.addEventListener("peer:disconnect",rt=>{this.dispatchEvent(new CustomEvent("peer:disconnect",{detail:rt.detail}))}),this.components.connectionManager.addEventListener("peer:connect",rt=>{this.dispatchEvent(new CustomEvent("peer:connect",{detail:rt.detail}))}),this.registrar=this.components.registrar=new DefaultRegistrar(this.components),this.components.transportManager=new DefaultTransportManager(this.components,o.transportManager),this.components.addressManager=new DefaultAddressManager(this.components,o.addresses),this.configureComponent(new PeerRecordUpdater(this.components)),this.configureComponent(new AutoDialler(this.components,{enabled:o.connectionManager.autoDial,minConnections:o.connectionManager.minConnections,autoDialInterval:o.connectionManager.autoDialInterval}));const j=KeyChain.generateOptions();this.keychain=this.configureComponent(new KeyChain(this.components,{...j,...o.keychain})),this.services.push(new NatManager(this.components,o.nat)),o.transports.forEach(rt=>{this.components.transportManager.add(this.configureComponent(rt(this.components)))}),this.identifyService=new IdentifyService(this.components,{...o.identify}),this.configureComponent(this.identifyService),o.dht!=null?this.dht=this.components.dht=o.dht(this.components):this.dht=new DummyDHT,o.pubsub!=null?this.pubsub=this.components.pubsub=o.pubsub(this.components):this.pubsub=new DummyPubSub;const et=(o.peerRouters??[]).map(rt=>this.configureComponent(rt(this.components)));o.dht!=null&&(et.push(this.configureComponent(new DHTPeerRouting(this.dht))),this.dht.addEventListener("peer",rt=>{this.onDiscoveryPeer(rt)})),this.peerRouting=this.components.peerRouting=this.configureComponent(new DefaultPeerRouting(this.components,{...o.peerRouting,routers:et}));const tt=(o.contentRouters??[]).map(rt=>this.configureComponent(rt(this.components)));o.dht!=null&&tt.push(this.configureComponent(new DHTContentRouting(this.dht))),this.contentRouting=this.components.contentRouting=this.configureComponent(new CompoundContentRouting(this.components,{routers:tt})),o.relay.enabled&&(this.components.transportManager.add(this.configureComponent(new Circuit(this.components,o.relay))),this.configureComponent(new Relay(this.components,{addressSorter:o.connectionManager.addressSorter,...o.relay}))),this.fetchService=this.configureComponent(new FetchService(this.components,{...o.fetch})),this.pingService=this.configureComponent(new PingService(this.components,{...o.ping}));for(const rt of o.peerDiscovery??[])this.configureComponent(rt(this.components)).addEventListener("peer",it=>{this.onDiscoveryPeer(it)})}configureComponent(o){return isStartable(o)&&this.services.push(o),o}async start(){if(!this.started){this.started=!0,log$f("libp2p is starting");try{await Promise.all(this.services.map(async o=>{o.beforeStart!=null&&await o.beforeStart()})),await Promise.all(this.services.map(o=>o.start())),await Promise.all(this.services.map(async o=>{o.afterStart!=null&&await o.afterStart()})),log$f("libp2p has started")}catch(o){throw log$f.error("An error occurred starting libp2p",o),await this.stop(),o}}}async stop(){this.started&&(log$f("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map(async o=>{o.beforeStop!=null&&await o.beforeStop()})),await Promise.all(this.services.map(o=>o.stop())),await Promise.all(this.services.map(async o=>{o.afterStop!=null&&await o.afterStop()})),log$f("libp2p has stopped"))}isStarted(){return this.started}getConnections(o){return this.components.connectionManager.getConnections(o)}getPeers(){const o=new PeerSet;for(const $ of this.components.connectionManager.getConnections())o.add($.remotePeer);return Array.from(o)}async dial(o,$={}){return await this.components.connectionManager.openConnection(o,$)}async dialProtocol(o,$,j={}){if($==null)throw errCode(new Error("no protocols were provided to open a stream"),codes$2.ERR_INVALID_PROTOCOLS_FOR_STREAM);if($=Array.isArray($)?$:[$],$.length===0)throw errCode(new Error("no protocols were provided to open a stream"),codes$2.ERR_INVALID_PROTOCOLS_FOR_STREAM);return await(await this.dial(o,j)).newStream($,j)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(o){isMultiaddr$3(o)&&(o=peerIdFromString(o.getPeerId()??"")),await this.components.connectionManager.closeConnections(o)}async getPublicKey(o,$={}){if(log$f("getPublicKey %p",o),o.publicKey!=null)return o.publicKey;const j=await this.peerStore.get(o);if(j.pubKey!=null)return j.pubKey;if(this.dht==null)throw errCode(new Error("Public key was not in the peer store and the DHT is not enabled"),codes$2.ERR_NO_ROUTERS_AVAILABLE);const et=concat$2([fromString$8("/pk/"),o.multihash.digest]);for await(const tt of this.dht.get(et,$))if(tt.name==="VALUE"){const rt=unmarshalPublicKey(tt.value);return await this.peerStore.keyBook.set(o,tt.value),rt.bytes}throw errCode(new Error(`Node not responding with its public key: ${o.toString()}`),codes$2.ERR_INVALID_RECORD)}async fetch(o,$,j={}){if(isMultiaddr$3(o)){const et=peerIdFromString(o.getPeerId()??"");await this.components.peerStore.addressBook.add(et,[o]),o=et}return await this.fetchService.fetch(o,$,j)}async ping(o,$={}){if(isMultiaddr$3(o)){const j=peerIdFromString(o.getPeerId()??"");await this.components.peerStore.addressBook.add(j,[o]),o=j}return await this.pingService.ping(o,$)}async handle(o,$,j){Array.isArray(o)||(o=[o]),await Promise.all(o.map(async et=>{await this.components.registrar.handle(et,$,j)}))}async unhandle(o){Array.isArray(o)||(o=[o]),await Promise.all(o.map(async $=>{await this.components.registrar.unhandle($)}))}async register(o,$){return await this.registrar.register(o,$)}unregister(o){this.registrar.unregister(o)}onDiscoveryPeer(o){const{detail:$}=o;if($.id.toString()===this.peerId.toString()){log$f.error(new Error(codes$2.ERR_DISCOVERED_SELF));return}$.multiaddrs.length>0&&this.components.peerStore.addressBook.add($.id,$.multiaddrs).catch(j=>log$f.error(j)),$.protocols.length>0&&this.components.peerStore.protoBook.set($.id,$.protocols).catch(j=>log$f.error(j)),this.dispatchEvent(new CustomEvent("peer:discovery",{detail:$}))}}async function createLibp2pNode(_){if(_.peerId==null){const o=_.datastore;if(o!=null)try{const $=new KeyChain({datastore:o},{...KeyChain.generateOptions(),..._.keychain??{}});_.peerId=await $.exportPeerId("self")}catch($){if($.code!=="ERR_NOT_FOUND")throw $}}return _.peerId==null&&(_.peerId=await createEd25519PeerId()),new Libp2pNode(validateConfig(_))}async function createLibp2p$1(_){const o=await createLibp2pNode(_);return _.start!==!1&&await o.start(),o}const randomBytes=requireBrowser$c(),{EventEmitter}=eventsExports;function arrayEquals(_,o){if(_===o)return!0;if(_.length!==o.length)return!1;for(let $=0,j=_.length;$<j;++$)if(_[$]!==o[$])return!1;return!0}function createNode(){return{contacts:[],dontSplit:!1,left:null,right:null}}function ensureInt8(_,o){if(!(o instanceof Uint8Array))throw new TypeError(_+" is not a Uint8Array")}class KBucket extends EventEmitter{constructor(o={}){super(),this.localNodeId=o.localNodeId||randomBytes(20),this.numberOfNodesPerKBucket=o.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=o.numberOfNodesToPing||3,this.distance=o.distance||KBucket.distance,this.arbiter=o.arbiter||KBucket.arbiter,this.metadata=Object.assign({},o.metadata),ensureInt8("option.localNodeId as parameter 1",this.localNodeId),this.root=createNode()}static arbiter(o,$){return o.vectorClock>$.vectorClock?o:$}static distance(o,$){let j=0,et=0;const tt=Math.min(o.length,$.length),rt=Math.max(o.length,$.length);for(;et<tt;++et)j=j*256+(o[et]^$[et]);for(;et<rt;++et)j=j*256+255;return j}add(o){ensureInt8("contact.id",(o||{}).id);let $=0,j=this.root;for(;j.contacts===null;)j=this._determineNode(j,o.id,$++);const et=this._indexOf(j,o.id);return et>=0?(this._update(j,et,o),this):j.contacts.length<this.numberOfNodesPerKBucket?(j.contacts.push(o),this.emit("added",o),this):j.dontSplit?(this.emit("ping",j.contacts.slice(0,this.numberOfNodesToPing),o),this):(this._split(j,$),this.add(o))}closest(o,$=1/0){if(ensureInt8("id",o),!Number.isInteger($)&&$!==1/0||$<=0)throw new TypeError("n is not positive number");let j=[];for(let et=[this.root],tt=0;et.length>0&&j.length<$;){const rt=et.pop();if(rt.contacts===null){const nt=this._determineNode(rt,o,tt++);et.push(rt.left===nt?rt.right:rt.left),et.push(nt)}else j=j.concat(rt.contacts)}return j.map(et=>[this.distance(et.id,o),et]).sort((et,tt)=>et[0]-tt[0]).slice(0,$).map(et=>et[1])}count(){let o=0;for(const $=[this.root];$.length>0;){const j=$.pop();j.contacts===null?$.push(j.right,j.left):o+=j.contacts.length}return o}_determineNode(o,$,j){const et=j>>3,tt=j%8;return $.length<=et&&tt!==0?o.left:$[et]&1<<7-tt?o.right:o.left}get(o){ensureInt8("id",o);let $=0,j=this.root;for(;j.contacts===null;)j=this._determineNode(j,o,$++);const et=this._indexOf(j,o);return et>=0?j.contacts[et]:null}_indexOf(o,$){for(let j=0;j<o.contacts.length;++j)if(arrayEquals(o.contacts[j].id,$))return j;return-1}remove(o){ensureInt8("the id as parameter 1",o);let $=0,j=this.root;for(;j.contacts===null;)j=this._determineNode(j,o,$++);const et=this._indexOf(j,o);if(et>=0){const tt=j.contacts.splice(et,1)[0];this.emit("removed",tt)}return this}_split(o,$){o.left=createNode(),o.right=createNode();for(const tt of o.contacts)this._determineNode(o,tt.id,$).contacts.push(tt);o.contacts=null;const j=this._determineNode(o,this.localNodeId,$),et=o.left===j?o.right:o.left;et.dontSplit=!0}toArray(){let o=[];for(const $=[this.root];$.length>0;){const j=$.pop();j.contacts===null?$.push(j.right,j.left):o=o.concat(j.contacts)}return o}*toIterable(){for(const o=[this.root];o.length>0;){const $=o.pop();$.contacts===null?o.push($.right,$.left):yield*$.contacts}}_update(o,$,j){if(!arrayEquals(o.contacts[$].id,j.id))throw new Error("wrong index for _update");const et=o.contacts[$],tt=this.arbiter(et,j);tt===et&&et!==j||(o.contacts.splice($,1),o.contacts.push(tt),this.emit("updated",et,tt))}}var kBucket=KBucket;const second=1e3,minute=60*second,hour=60*minute,MAX_RECORD_AGE=36*hour,LAN_PREFIX="/lan",PROTOCOL_PREFIX="/ipfs",PROTOCOL_DHT="/kad/1.0.0",RECORD_KEY_PREFIX="/dht/record",PROVIDER_KEY_PREFIX="/dht/provider",PROVIDERS_LRU_CACHE_SIZE=256,PROVIDERS_VALIDITY=24*hour,PROVIDERS_CLEANUP_INTERVAL=hour,K=20,ALPHA=3,QUERY_SELF_INTERVAL=Number(5*minute),QUERY_SELF_TIMEOUT=Number(30*second),TABLE_REFRESH_INTERVAL=Number(5*minute),TABLE_REFRESH_QUERY_TIMEOUT=Number(30*second),DEFAULT_QUERY_TIMEOUT=Number(30*second),PK_PREFIX=fromString$8("/pk/");function removePrivateAddresses(_){return{..._,multiaddrs:_.multiaddrs.filter(o=>{const[[$,j]]=o.stringTuples();if($===53||$===54||$===55)return j!=="localhost";if($!==4&&$!==6||j==null)return!1;const et=is_ip_private(j);return et==null?!0:!et})}}function removePublicAddresses(_){return{..._,multiaddrs:_.multiaddrs.filter(o=>{const[[$,j]]=o.stringTuples();if(j==="localhost")return!0;if($!==4&&$!==6||j==null)return!1;const et=is_ip_private(j);return et??!1})}}async function convertBuffer(_){return(await sha256$8.digest(_)).digest}async function convertPeerId(_){return await convertBuffer(_.toBytes())}function bufferToRecordKey(_){return new Key(`${RECORD_KEY_PREFIX}/${toString$a(_,"base32")}`,!1)}function keyForPublicKey(_){return concat$2([PK_PREFIX,_.toBytes()])}function isPublicKeyKey(_){return toString$a(_.subarray(0,4))==="/pk/"}function fromPublicKeyKey(_){return peerIdFromBytes(_.subarray(4))}function createPutRecord(_,o){const $=new Date;return new Libp2pRecord(_,o,$).serialize()}function debounce$1(_,o=100){let $;return()=>{clearTimeout($),$=setTimeout(()=>{_()},o)}}const KAD_CLOSE_TAG_NAME="kad-close",KAD_CLOSE_TAG_VALUE=50,KBUCKET_SIZE=20,PING_TIMEOUT=1e4,PING_CONCURRENCY=10;class RoutingTable{constructor(o,$){const{kBucketSize:j,pingTimeout:et,lan:tt,pingConcurrency:rt,protocol:nt,tagName:it,tagValue:st}=$;this.components=o,this.log=logger$1(`libp2p:kad-dht:${tt?"lan":"wan"}:routing-table`),this.kBucketSize=j??KBUCKET_SIZE,this.pingTimeout=et??PING_TIMEOUT,this.pingConcurrency=rt??PING_CONCURRENCY,this.lan=tt,this.running=!1,this.protocol=nt,this.tagName=it??KAD_CLOSE_TAG_NAME,this.tagValue=st??KAD_CLOSE_TAG_VALUE;const ot=()=>{var at,ct;(at=this.metrics)==null||at.pingQueueSize.update(this.pingQueue.size),(ct=this.metrics)==null||ct.pingRunning.update(this.pingQueue.pending)};this.pingQueue=new PQueue({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",ot),this.pingQueue.addListener("next",ot),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}async start(){this.running=!0,this.components.metrics!=null&&(this.metrics={routingTableSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_routing_table_size`),pingQueueSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_queue_size`),pingRunning:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_running`)});const o=new kBucket({localNodeId:await convertPeerId(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=o,o.on("ping",this._onPing),this._tagPeers(o)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(o){let $=new PeerSet;const j=debounce$1(()=>{const et=new PeerSet(o.closest(o.localNodeId,KBUCKET_SIZE).map(nt=>nt.peer)),tt=et.difference($),rt=$.difference(et);Promise.resolve().then(async()=>{for(const nt of tt)await this.components.peerStore.tagPeer(nt,this.tagName,{value:this.tagValue});for(const nt of rt)await this.components.peerStore.unTagPeer(nt,this.tagName)}).catch(nt=>{this.log.error("Could not update peer tags",nt)}),$=et});o.on("added",()=>{j()}),o.on("removed",()=>{j()})}_onPing(o,$){this.pingQueue.add(async()=>{if(!this.running)return;let j=0;try{await Promise.all(o.map(async et=>{var rt;let tt;try{tt=new timeoutAbortController.TimeoutController(this.pingTimeout);const nt={signal:tt.signal};this.log("pinging old contact %p",et.peer),(await(await this.components.connectionManager.openConnection(et.peer,nt)).newStream(this.protocol,nt)).close(),j++}catch(nt){this.running&&this.kb!=null&&(this.log.error("could not ping peer %p",et.peer,nt),this.log("evicting old contact after ping failed %p",et),this.kb.remove(et.id))}finally{tt!=null&&tt.clear(),(rt=this.metrics)==null||rt.routingTableSize.update(this.size)}})),this.running&&j<o.length&&this.kb!=null&&(this.log("adding new contact %p",$.peer),this.kb.add($))}catch(et){this.log.error("could not process k-bucket ping event",et)}}).catch(j=>{this.log.error("could not process k-bucket ping event",j)})}get size(){return this.kb==null?0:this.kb.count()}async find(o){const $=await convertPeerId(o),j=this.closestPeer($);if(j!=null&&o.equals(j))return j}closestPeer(o){const $=this.closestPeers(o,1);if($.length>0)return $[0]}closestPeers(o,$=this.kBucketSize){return this.kb==null?[]:this.kb.closest(o,$).map(et=>et.peer)}async add(o){var j;if(this.kb==null)throw new Error("RoutingTable is not started");const $=await convertPeerId(o);this.kb.add({id:$,peer:o}),this.log("added %p with kad id %b",o,$),(j=this.metrics)==null||j.routingTableSize.update(this.size)}async remove(o){var j;if(this.kb==null)throw new Error("RoutingTable is not started");const $=await convertPeerId(o);this.kb.remove($),(j=this.metrics)==null||j.routingTableSize.update(this.size)}}const GENERATED_PREFIXES=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782],MAX_COMMON_PREFIX_LENGTH=15;class RoutingTableRefresh{constructor(o){const{peerRouting:$,routingTable:j,refreshInterval:et,refreshQueryTimeout:tt,lan:rt}=o;this.log=logger$1(`libp2p:kad-dht:${rt?"lan":"wan"}:routing-table:refresh`),this.peerRouting=$,this.routingTable=j,this.refreshInterval=et??TABLE_REFRESH_INTERVAL,this.refreshQueryTimeout=tt??TABLE_REFRESH_QUERY_TIMEOUT,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){this.refreshTimeoutId!=null&&clearTimeout(this.refreshTimeoutId)}refreshTable(o=!1){this.log("refreshing routing table");const $=this._maxCommonPrefix(),j=this._getTrackedCommonPrefixLengthsForRefresh($);this.log(`max common prefix length ${$}`),this.log(`tracked CPLs [ ${j.map(et=>et.toISOString()).join(", ")} ]`),Promise.all(j.map(async(et,tt)=>{try{if(await this._refreshCommonPrefixLength(tt,et,o),this._numPeersForCpl($)===0){const rt=Math.min(2*(tt+1),j.length-1);for(let nt=tt+1;nt<rt+1;nt++)try{await this._refreshCommonPrefixLength(nt,et,o)}catch(it){this.log.error(it)}}}catch(rt){this.log.error(rt)}})).catch(et=>{this.log.error(et)}).then(()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),this.refreshTimeoutId.unref!=null&&this.refreshTimeoutId.unref()}).catch(et=>{this.log.error(et)})}async _refreshCommonPrefixLength(o,$,j){if(!j&&$.getTime()>Date.now()-this.refreshInterval){this.log("not running refresh for cpl %s as time since last refresh not above interval",o);return}const et=await this._generateRandomPeerId(o);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",o,et,this.routingTable.size);const tt=new timeoutAbortController.TimeoutController(this.refreshQueryTimeout);try{const rt=await length$2(this.peerRouting.getClosestPeers(et.toBytes(),{signal:tt.signal}));this.log(`found ${rt} peers that were close to imaginary peer %p`,et),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",o,et,this.routingTable.size)}finally{tt.clear()}}_getTrackedCommonPrefixLengthsForRefresh(o){o>MAX_COMMON_PREFIX_LENGTH&&(o=MAX_COMMON_PREFIX_LENGTH);const $=[];for(let j=0;j<=o;j++)$[j]=this.commonPrefixLengthRefreshedAt[j]??new Date;return $}async _generateRandomPeerId(o){if(this.routingTable.kb==null)throw new Error("Routing table not started");const $=randomBytes$3(2),j=($[1]<<8)+$[0],et=await this._makePeerId(this.routingTable.kb.localNodeId,j,o);return peerIdFromBytes(et)}async _makePeerId(o,$,j){if(j>MAX_COMMON_PREFIX_LENGTH)throw new Error(`Cannot generate peer ID for common prefix length greater than ${MAX_COMMON_PREFIX_LENGTH}`);const rt=new DataView(o.buffer,o.byteOffset,o.byteLength).getUint16(0,!1)^32768>>j,nt=65535<<16-(j+1),it=rt&nt|$&~nt,st=GENERATED_PREFIXES[it],ot=new ArrayBuffer(34),at=new DataView(ot,0,ot.byteLength);return at.setUint8(0,sha256$8.code),at.setUint8(1,32),at.setUint32(2,st,!1),new Uint8Array(at.buffer,at.byteOffset,at.byteLength)}_maxCommonPrefix(){let o=0;for(const $ of this._prefixLengths())$>o&&(o=$);return o}_numPeersForCpl(o){let $=0;for(const j of this._prefixLengths())j===o&&$++;return $}*_prefixLengths(){if(this.routingTable.kb!=null)for(const{id:o}of this.routingTable.kb.toIterable()){const $=xor(this.routingTable.kb.localNodeId,o);let j=0;for(const et of $)if(et===0)j++;else break;yield j}}}var Record;(function(_){let o;_.codec=()=>(o==null&&(o=message$3(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),$.key!=null&&(j.uint32(10),j.bytes($.key)),$.value!=null&&(j.uint32(18),j.bytes($.value)),$.author!=null&&(j.uint32(26),j.bytes($.author)),$.signature!=null&&(j.uint32(34),j.bytes($.signature)),$.timeReceived!=null&&(j.uint32(42),j.string($.timeReceived)),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.key=$.bytes();break;case 2:et.value=$.bytes();break;case 3:et.author=$.bytes();break;case 4:et.signature=$.bytes();break;case 5:et.timeReceived=$.string();break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage$3($,_.codec()),_.decode=$=>decodeMessage$4($,_.codec())})(Record||(Record={}));var Message$2;(function(_){(function(et){et.PUT_VALUE="PUT_VALUE",et.GET_VALUE="GET_VALUE",et.ADD_PROVIDER="ADD_PROVIDER",et.GET_PROVIDERS="GET_PROVIDERS",et.FIND_NODE="FIND_NODE",et.PING="PING"})(_.MessageType||(_.MessageType={}));let o;(function(et){et[et.PUT_VALUE=0]="PUT_VALUE",et[et.GET_VALUE=1]="GET_VALUE",et[et.ADD_PROVIDER=2]="ADD_PROVIDER",et[et.GET_PROVIDERS=3]="GET_PROVIDERS",et[et.FIND_NODE=4]="FIND_NODE",et[et.PING=5]="PING"})(o||(o={})),function(et){et.codec=()=>enumeration$2(o)}(_.MessageType||(_.MessageType={})),function(et){et.NOT_CONNECTED="NOT_CONNECTED",et.CONNECTED="CONNECTED",et.CAN_CONNECT="CAN_CONNECT",et.CANNOT_CONNECT="CANNOT_CONNECT"}(_.ConnectionType||(_.ConnectionType={}));let $;(function(et){et[et.NOT_CONNECTED=0]="NOT_CONNECTED",et[et.CONNECTED=1]="CONNECTED",et[et.CAN_CONNECT=2]="CAN_CONNECT",et[et.CANNOT_CONNECT=3]="CANNOT_CONNECT"})($||($={})),function(et){et.codec=()=>enumeration$2($)}(_.ConnectionType||(_.ConnectionType={})),function(et){let tt;et.codec=()=>(tt==null&&(tt=message$3((rt,nt,it={})=>{if(it.lengthDelimited!==!1&&nt.fork(),rt.id!=null&&(nt.uint32(10),nt.bytes(rt.id)),rt.addrs!=null)for(const st of rt.addrs)nt.uint32(18),nt.bytes(st);rt.connection!=null&&(nt.uint32(24),_.ConnectionType.codec().encode(rt.connection,nt)),it.lengthDelimited!==!1&&nt.ldelim()},(rt,nt)=>{const it={addrs:[]},st=nt==null?rt.len:rt.pos+nt;for(;rt.pos<st;){const ot=rt.uint32();switch(ot>>>3){case 1:it.id=rt.bytes();break;case 2:it.addrs.push(rt.bytes());break;case 3:it.connection=_.ConnectionType.codec().decode(rt);break;default:rt.skipType(ot&7);break}}return it})),tt),et.encode=rt=>encodeMessage$3(rt,et.codec()),et.decode=rt=>decodeMessage$4(rt,et.codec())}(_.Peer||(_.Peer={}));let j;_.codec=()=>(j==null&&(j=message$3((et,tt,rt={})=>{if(rt.lengthDelimited!==!1&&tt.fork(),et.type!=null&&(tt.uint32(8),_.MessageType.codec().encode(et.type,tt)),et.clusterLevelRaw!=null&&(tt.uint32(80),tt.int32(et.clusterLevelRaw)),et.key!=null&&(tt.uint32(18),tt.bytes(et.key)),et.record!=null&&(tt.uint32(26),tt.bytes(et.record)),et.closerPeers!=null)for(const nt of et.closerPeers)tt.uint32(66),_.Peer.codec().encode(nt,tt);if(et.providerPeers!=null)for(const nt of et.providerPeers)tt.uint32(74),_.Peer.codec().encode(nt,tt);rt.lengthDelimited!==!1&&tt.ldelim()},(et,tt)=>{const rt={closerPeers:[],providerPeers:[]},nt=tt==null?et.len:et.pos+tt;for(;et.pos<nt;){const it=et.uint32();switch(it>>>3){case 1:rt.type=_.MessageType.codec().decode(et);break;case 10:rt.clusterLevelRaw=et.int32();break;case 2:rt.key=et.bytes();break;case 3:rt.record=et.bytes();break;case 8:rt.closerPeers.push(_.Peer.codec().decode(et,et.uint32()));break;case 9:rt.providerPeers.push(_.Peer.codec().decode(et,et.uint32()));break;default:et.skipType(it&7);break}}return rt})),j),_.encode=et=>encodeMessage$3(et,_.codec()),_.decode=et=>decodeMessage$4(et,_.codec())})(Message$2||(Message$2={}));const MESSAGE_TYPE=Message$2.MessageType,CONNECTION_TYPE=Message$2.ConnectionType,MESSAGE_TYPE_LOOKUP=Object.keys(MESSAGE_TYPE);let Message$1=class No{constructor(o,$,j){if(!($ instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=o,this.key=$,this.clusterLevelRaw=j,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const o=this.clusterLevelRaw-1;return o<0?0:o}set clusterLevel(o){this.clusterLevelRaw=o}serialize(){return Message$2.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(toPbPeer),providerPeers:this.providerPeers.map(toPbPeer),record:this.record==null?void 0:this.record.serialize().subarray()})}static deserialize(o){var et;const $=Message$2.decode(o),j=new No($.type??Message$2.MessageType.PUT_VALUE,$.key??Uint8Array.from([]),$.clusterLevelRaw??0);return j.closerPeers=$.closerPeers.map(fromPbPeer),j.providerPeers=$.providerPeers.map(fromPbPeer),((et=$.record)==null?void 0:et.length)!=null&&(j.record=Libp2pRecord.deserialize($.record)),j}};function toPbPeer(_){return{id:_.id.toBytes(),addrs:(_.multiaddrs??[]).map($=>$.bytes),connection:CONNECTION_TYPE.CONNECTED}}function fromPbPeer(_){if(_.id==null)throw new Error("Invalid peer in message");return{id:peerIdFromBytes(_.id),multiaddrs:(_.addrs??[]).map(o=>multiaddr$3(o)),protocols:[]}}function sendingQueryEvent(_){return{..._,name:"SENDING_QUERY",type:0,messageName:_.type,messageType:MESSAGE_TYPE_LOOKUP.indexOf(_.type.toString())}}function peerResponseEvent(_){return{..._,name:"PEER_RESPONSE",type:1,messageName:_.messageType,closer:_.closer!=null?_.closer:[],providers:_.providers!=null?_.providers:[]}}function finalPeerEvent(_){return{..._,name:"FINAL_PEER",type:2}}function queryErrorEvent(_){return{..._,name:"QUERY_ERROR",type:3}}function providerEvent(_){return{..._,name:"PROVIDER",type:4}}function valueEvent(_){return{..._,name:"VALUE",type:5}}function dialingPeerEvent(_){return{..._,name:"DIALING_PEER",type:7}}let Network$2=class extends EventEmitter$1{constructor(o,$){super();const{protocol:j,lan:et}=$;this.components=o,this.log=logger$1(`libp2p:kad-dht:${et?"lan":"wan"}:network`),this.running=!1,this.protocol=j}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(o,$,j={}){if(this.running){this.log("sending %s to %p",$.type,o),yield dialingPeerEvent({peer:o}),yield sendingQueryEvent({to:o,type:$.type});try{const tt=await(await this.components.connectionManager.openConnection(o,j)).newStream(this.protocol,j),rt=await this._writeReadMessage(tt,$.serialize(),j);yield peerResponseEvent({from:o,messageType:rt.type,closer:rt.closerPeers,providers:rt.providerPeers,record:rt.record})}catch(et){yield queryErrorEvent({from:o,error:et})}finally{}}}async*sendMessage(o,$,j={}){if(this.running){this.log("sending %s to %p",$.type,o),yield dialingPeerEvent({peer:o}),yield sendingQueryEvent({to:o,type:$.type});try{const tt=await(await this.components.connectionManager.openConnection(o,j)).newStream(this.protocol,j);await this._writeMessage(tt,$.serialize(),j),yield peerResponseEvent({from:o,messageType:$.type})}catch(et){yield queryErrorEvent({from:o,error:et})}finally{}}}async _writeMessage(o,$,j){j.signal!=null&&(o=abortableDuplex(o,j.signal)),await pipe([$],encode$5(),o,drain)}async _writeReadMessage(o,$,j){j.signal!=null&&(o=abortableDuplex(o,j.signal));const et=await pipe([$],encode$5(),o,decode$3(),async rt=>{const nt=await first(rt);if(nt!=null)return nt;throw new CodeError("No message received","ERR_NO_MESSAGE_RECEIVED")}),tt=Message$1.deserialize(et);return tt.closerPeers.forEach(rt=>{this.dispatchEvent(new CustomEvent("peer",{detail:rt}))}),tt.providerPeers.forEach(rt=>{this.dispatchEvent(new CustomEvent("peer",{detail:rt}))}),tt}};async function verifyRecord(_,o){const $=o.key,et=toString$a($).split("/");if(et.length<3)return;const tt=_[et[1].toString()];if(tt==null){const rt="Invalid record keytype";throw new CodeError(rt,"ERR_INVALID_RECORD_KEY_TYPE")}await tt($,o.value)}const validatePublicKeyRecord=async(_,o)=>{if(!(_ instanceof Uint8Array))throw new CodeError('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(_.byteLength<5)throw new CodeError("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");if(toString$a(_.subarray(0,4))!=="/pk/")throw new CodeError("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");const j=_.slice(4),et=await sha256$8.digest(o);if(!equals$6(j,et.bytes))throw new CodeError("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH")},validators={pk:validatePublicKeyRecord};function bestRecord(_,o,$){if($.length===0){const rt="No records given";throw new CodeError(rt,"ERR_NO_RECORDS_RECEIVED")}const et=toString$a(o).split("/");if(et.length<3){const rt="Record key does not have a selector function";throw new CodeError(rt,"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const tt=_[et[1].toString()];if(tt==null){const rt=`Unrecognized key prefix: ${et[1]}`;throw new CodeError(rt,"ERR_UNRECOGNIZED_KEY_PREFIX")}return $.length===1?0:tt(o,$)}function publickKey(_,o){return 0}const selectors={pk:publickKey};class ContentFetching{constructor(o,$){const{validators:j,selectors:et,peerRouting:tt,queryManager:rt,routingTable:nt,network:it,lan:st}=$;this.components=o,this.log=logger$1(`libp2p:kad-dht:${st?"lan":"wan"}:content-fetching`),this.validators=j,this.selectors=et,this.peerRouting=tt,this.queryManager=rt,this.routingTable=nt,this.network=it}async putLocal(o,$){const j=bufferToRecordKey(o);await this.components.datastore.put(j,$)}async getLocal(o){this.log("getLocal %b",o);const $=bufferToRecordKey(o);this.log("fetching record for key %k",$);const j=await this.components.datastore.get($);this.log("found %k in local datastore",$);const et=Libp2pRecord.deserialize(j);return await verifyRecord(this.validators,et),et}async*sendCorrectionRecord(o,$,j,et={}){this.log("sendCorrection for %b",o);const tt=createPutRecord(o,j);for(const{value:rt,from:nt}of $){if(equals$6(rt,j)){this.log("record was ok");continue}if(this.components.peerId.equals(nt)){try{const ot=bufferToRecordKey(o);this.log(`Storing corrected record for key ${ot.toString()}`),await this.components.datastore.put(ot,tt.subarray())}catch(ot){this.log.error("Failed error correcting self",ot)}continue}let it=!1;const st=new Message$1(MESSAGE_TYPE.PUT_VALUE,o,0);st.record=Libp2pRecord.deserialize(tt);for await(const ot of this.network.sendRequest(nt,st,et))ot.name==="PEER_RESPONSE"&&ot.record!=null&&equals$6(ot.record.value,Libp2pRecord.deserialize(tt).value)&&(it=!0),yield ot;it||(yield queryErrorEvent({from:nt,error:new CodeError("value not put correctly","ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(o,$,j={}){this.log("put key %b value %b",o,$);const et=createPutRecord(o,$),tt=bufferToRecordKey(o);this.log(`storing record for key ${tt.toString()}`),await this.components.datastore.put(tt,et.subarray()),yield*pipe(this.peerRouting.getClosestPeers(o,{signal:j.signal}),rt=>map$3(rt,nt=>async()=>{if(nt.name!=="FINAL_PEER")return[nt];const it=[],st=new Message$1(MESSAGE_TYPE.PUT_VALUE,o,0);st.record=Libp2pRecord.deserialize(et),this.log("send put to %p",nt.peer.id);for await(const ot of this.network.sendRequest(nt.peer.id,st,j))it.push(ot),ot.name==="PEER_RESPONSE"&&(ot.record!=null&&equals$6(ot.record.value,Libp2pRecord.deserialize(et).value)||it.push(queryErrorEvent({from:nt.peer.id,error:new CodeError("value not put correctly","ERR_PUT_VALUE_INVALID")})));return it}),rt=>parallel(rt,{ordered:!1,concurrency:ALPHA}),async function*(rt){for await(const nt of rt)yield*nt})}async*get(o,$={}){this.log("get %b",o);const j=[];for await(const nt of this.getMany(o,$))nt.name==="VALUE"&&j.push(nt),yield nt;if(j.length===0)return;const et=j.map(nt=>nt.value);let tt=0;try{tt=bestRecord(this.selectors,o,et)}catch(nt){if(nt.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw nt}const rt=et[tt];if(this.log("GetValue %b %b",o,rt),rt==null)throw new CodeError("best value was not found","ERR_NOT_FOUND");yield*this.sendCorrectionRecord(o,j,rt,$),yield j[tt]}async*getMany(o,$={}){this.log("getMany values for %b",o);try{const nt=await this.getLocal(o);yield valueEvent({value:nt.value,from:this.components.peerId})}catch(nt){this.log("error getting local value for %b",o,nt)}const j=await convertBuffer(o),et=this.routingTable.closestPeers(j);this.log("found %d peers in routing table",et.length);const tt=this,rt=async function*({peer:nt,signal:it}){for await(const st of tt.peerRouting.getValueOrPeers(nt,o,{signal:it}))yield st,st.name==="PEER_RESPONSE"&&st.record!=null&&(yield valueEvent({from:nt,value:st.record.value}))};yield*this.queryManager.run(o,et,rt,$)}}class ContentRouting{constructor(o,$){const{network:j,peerRouting:et,queryManager:tt,routingTable:rt,providers:nt,lan:it}=$;this.components=o,this.log=logger$1(`libp2p:kad-dht:${it?"lan":"wan"}:content-routing`),this.network=j,this.peerRouting=et,this.queryManager=tt,this.routingTable=rt,this.providers=nt}async*provide(o,$,j={}){this.log("provide %s",o),await this.providers.addProvider(o,this.components.peerId);const et=new Message$1(MESSAGE_TYPE.ADD_PROVIDER,o.multihash.bytes,0);et.providerPeers=[{id:this.components.peerId,multiaddrs:$,protocols:[]}];let tt=0;const rt=nt=>async()=>{if(nt.name!=="FINAL_PEER")return[nt];const it=[];this.log("putProvider %s to %p",o,nt.peer.id);try{this.log("sending provider record for %s to %p",o,nt.peer.id);for await(const st of this.network.sendMessage(nt.peer.id,et,j))st.name==="PEER_RESPONSE"&&(this.log("sent provider record for %s to %p",o,nt.peer.id),tt++),it.push(st)}catch(st){this.log.error("error sending provide record to peer %p",nt.peer.id,st),it.push(queryErrorEvent({from:nt.peer.id,error:st}))}return it};yield*pipe(this.peerRouting.getClosestPeers(o.multihash.bytes,j),nt=>map$3(nt,it=>rt(it)),nt=>parallel(nt,{ordered:!1,concurrency:ALPHA}),async function*(nt){for await(const it of nt)yield*it}),this.log("sent provider records to %d peers",tt)}async*findProviders(o,$){const j=this.routingTable.kBucketSize,et=o.multihash.bytes,tt=await convertBuffer(et),rt=this;this.log("findProviders %c",o);const nt=await this.providers.getProviders(o);if(nt.length>0){const ot=[];for(const at of nt.slice(0,j))ot.push({id:at,multiaddrs:(await this.components.peerStore.addressBook.get(at)??[]).map(ct=>ct.multiaddr),protocols:[]});yield peerResponseEvent({from:this.components.peerId,messageType:MESSAGE_TYPE.GET_PROVIDERS,providers:ot}),yield providerEvent({from:this.components.peerId,providers:ot})}if(nt.length>=j)return;const it=async function*({peer:ot,signal:at}){const ct=new Message$1(MESSAGE_TYPE.GET_PROVIDERS,et,0);yield*rt.network.sendRequest(ot,ct,{signal:at})},st=new Set(nt.map(ot=>ot.toString()));for await(const ot of this.queryManager.run(et,this.routingTable.closestPeers(tt),it,$))if(yield ot,ot.name==="PEER_RESPONSE"){this.log("Found %d provider entries for %c and %d closer peers",ot.providers.length,o,ot.closer.length);const at=[];for(const ct of ot.providers)st.has(ct.id.toString())||(st.add(ct.id.toString()),at.push(ct));if(at.length>0&&(yield providerEvent({from:ot.from,providers:at})),st.size===j)return}}}class PeerDistanceList{constructor(o,$){this.originDhtKey=o,this.capacity=$,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(o=>o.peerId)}async add(o){if(this.peerDistances.find(et=>et.peerId.equals(o))!=null)return;const $=await convertPeerId(o),j={peerId:o,distance:xor(this.originDhtKey,$)};this.peerDistances.push(j),this.peerDistances.sort((et,tt)=>compare$1(et.distance,tt.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(o){if(o.length===0)return!1;if(this.length===0)return!0;const $=await Promise.all(o.map(convertPeerId)),j=this.peerDistances[this.peerDistances.length-1].distance;for(const et of $){const tt=xor(this.originDhtKey,et);if(compare$1(tt,j)<0)return!0}return!1}}class PeerRouting{constructor(o,$){const{routingTable:j,network:et,validators:tt,queryManager:rt,lan:nt}=$;this.components=o,this.routingTable=j,this.network=et,this.validators=tt,this.queryManager=rt,this.log=logger$1(`libp2p:kad-dht:${nt?"lan":"wan"}:peer-routing`)}async findPeerLocal(o){let $;const j=await this.routingTable.find(o);if(j!=null){this.log("findPeerLocal found %p in routing table",o);try{$=await this.components.peerStore.get(j)}catch(et){if(et.code!=="ERR_NOT_FOUND")throw et}}if($==null)try{$=await this.components.peerStore.get(o)}catch(et){if(et.code!=="ERR_NOT_FOUND")throw et}if($!=null)return this.log("findPeerLocal found %p in peer store",o),{id:$.id,multiaddrs:$.addresses.map(et=>et.multiaddr),protocols:[]}}async*_getValueSingle(o,$,j={}){const et=new Message$1(MESSAGE_TYPE.GET_VALUE,$,0);yield*this.network.sendRequest(o,et,j)}async*getPublicKeyFromNode(o,$={}){const j=keyForPublicKey(o);for await(const et of this._getValueSingle(o,j,$))if(yield et,et.name==="PEER_RESPONSE"&&et.record!=null){const tt=await peerIdFromKeys(marshalPublicKey({bytes:et.record.value}));if(!tt.equals(o))throw new CodeError("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(tt.publicKey==null)throw new CodeError("public key missing","ERR_PUBLIC_KEY_MISSING");yield valueEvent({from:o,value:tt.publicKey})}throw new CodeError(`Node not responding with its public key: ${o.toString()}`,"ERR_INVALID_RECORD")}async*findPeer(o,$={}){this.log("findPeer %p",o);const j=await this.findPeerLocal(o);if(j!=null){this.log("found local"),yield finalPeerEvent({from:this.components.peerId,peer:j});return}const et=await convertPeerId(o),tt=this.routingTable.closestPeers(et);if(tt.find(ot=>ot.equals(o))!=null)try{const ot=await this.components.peerStore.get(o);this.log("found in peerStore"),yield finalPeerEvent({from:this.components.peerId,peer:{id:ot.id,multiaddrs:ot.addresses.map(at=>at.multiaddr),protocols:[]}});return}catch(ot){if(ot.code!=="ERR_NOT_FOUND")throw ot}const nt=this,it=async function*({peer:ot,signal:at}){const ct=new Message$1(MESSAGE_TYPE.FIND_NODE,o.toBytes(),0);for await(const ut of nt.network.sendRequest(ot,ct,{signal:at}))if(yield ut,ut.name==="PEER_RESPONSE"){const ft=ut.closer.find(ht=>ht.id.equals(o));ft!=null&&(yield finalPeerEvent({from:ut.from,peer:ft}))}};let st=!1;for await(const ot of this.queryManager.run(o.toBytes(),tt,it,$))ot.name==="FINAL_PEER"&&(st=!0),yield ot;st||(yield queryErrorEvent({from:this.components.peerId,error:new CodeError("Not found","ERR_NOT_FOUND")}))}async*getClosestPeers(o,$={}){this.log("getClosestPeers to %b",o);const j=await convertBuffer(o),et=this.routingTable.closestPeers(j),tt=this,rt=new PeerDistanceList(j,this.routingTable.kBucketSize);await Promise.all(et.map(async it=>{await rt.add(it)}));const nt=async function*({peer:it,signal:st}){tt.log("closerPeersSingle %s from %p",toString$a(o,"base32"),it);const ot=new Message$1(MESSAGE_TYPE.FIND_NODE,o,0);yield*tt.network.sendRequest(it,ot,{signal:st})};for await(const it of this.queryManager.run(o,et,nt,$))yield it,it.name==="PEER_RESPONSE"&&await Promise.all(it.closer.map(async st=>{await rt.add(st.id)}));this.log("found %d peers close to %b",rt.length,o);for(const it of rt.peers)yield finalPeerEvent({from:this.components.peerId,peer:{id:it,multiaddrs:(await this.components.peerStore.addressBook.get(it)??[]).map(st=>st.multiaddr),protocols:[]}})}async*getValueOrPeers(o,$,j={}){for await(const et of this._getValueSingle(o,$,j)){if(et.name==="PEER_RESPONSE"&&et.record!=null)try{await this._verifyRecordOnline(et.record)}catch{const rt="invalid record received, discarded";this.log(rt),yield queryErrorEvent({from:et.from,error:new CodeError(rt,"ERR_INVALID_RECORD")});continue}yield et}}async _verifyRecordOnline(o){if(o.timeReceived==null)throw new CodeError("invalid record received","ERR_INVALID_RECORD");await verifyRecord(this.validators,new Libp2pRecord(o.key,o.value,o.timeReceived))}async getCloserPeersOffline(o,$){const j=await convertBuffer(o),et=this.routingTable.closestPeers(j),tt=[];for(const rt of et)if(!rt.equals($))try{const nt=await this.components.peerStore.addressBook.get(rt),it=await this.components.peerStore.protoBook.get(rt);tt.push({id:rt,multiaddrs:nt.map(st=>st.multiaddr),protocols:it})}catch(nt){if(nt.code!=="ERR_NOT_FOUND")throw nt}return tt.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",tt.length,o,$):this.log("getCloserPeersOffline could not find peer closer to %b than %p",o,$),tt}}const log$e=logger$1("libp2p:kad-dht:providers");class Providers{constructor(o,$={}){const{cacheSize:j,cleanupInterval:et,provideValidity:tt}=$;this.components=o,this.cleanupInterval=et??PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=tt??PROVIDERS_VALIDITY,this.cache=hashlru(j??PROVIDERS_LRU_CACHE_SIZE),this.syncQueue=new PQueue({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval(()=>{this._cleanup().catch(o=>{log$e.error(o)})},this.cleanupInterval))}async stop(){this.started=!1,this.cleaner!=null&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){await this.syncQueue.add(async()=>{const o=Date.now();let $=0,j=0;const et=new Map,tt=this.components.datastore.batch(),rt=this.components.datastore.query({prefix:PROVIDER_KEY_PREFIX});for await(const nt of rt)try{const{cid:it,peerId:st}=parseProviderKey(nt.key),ot=readTime(nt.value).getTime(),at=Date.now(),ct=at-ot,ut=ct>this.provideValidity;if(log$e("comparing: %d - %d = %d > %d %s",at,ot,ct,this.provideValidity,ut?"(expired)":""),ut){j++,tt.delete(nt.key);const ft=et.get(it)??new Set;ft.add(st),et.set(it,ft)}$++}catch(it){log$e.error(it.message)}et.size>0?(log$e("deleting %d / %d entries",j,$),await tt.commit()):log$e("nothing to delete");for(const[nt,it]of et){const st=makeProviderKey(nt),ot=this.cache.get(st);if(ot!=null){for(const at of it)ot.delete(at);ot.size===0?this.cache.remove(st):this.cache.set(st,ot)}}log$e("Cleanup successful (%dms)",Date.now()-o)})}async _getProvidersMap(o){const $=makeProviderKey(o);let j=this.cache.get($);return j==null&&(j=await loadProviders(this.components.datastore,o),this.cache.set($,j)),j}async addProvider(o,$){await this.syncQueue.add(async()=>{log$e("%p provides %s",$,o);const j=await this._getProvidersMap(o);log$e("loaded %s provs",j.size);const et=new Date;j.set($.toString(),et);const tt=makeProviderKey(o);this.cache.set(tt,j),await writeProviderEntry(this.components.datastore,o,$,et)})}async getProviders(o){return await this.syncQueue.add(async()=>(log$e("get providers for %s",o),[...(await this._getProvidersMap(o)).keys()].map(j=>peerIdFromString(j))),{throwOnTimeout:!0})}}function makeProviderKey(_){const o=typeof _=="string"?_:toString$a(_.multihash.bytes,"base32");return`${PROVIDER_KEY_PREFIX}/${o}`}async function writeProviderEntry(_,o,$,j){const et=[makeProviderKey(o),"/",$.toString()].join(""),tt=new Key(et),rt=Uint8Array.from(varint$2.encode(j.getTime()));await _.put(tt,rt)}function parseProviderKey(_){const o=_.toString().split("/");if(o.length!==5)throw new Error(`incorrectly formatted provider entry key in datastore: ${_.toString()}`);return{cid:o[3],peerId:o[4]}}async function loadProviders(_,o){const $=new Map,j=_.query({prefix:makeProviderKey(o)});for await(const et of j){const{peerId:tt}=parseProviderKey(et.key);$.set(tt,readTime(et.value))}return $}function readTime(_){return new Date(varint$2.decode(_))}const MAX_XOR=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*queryPath(_){const{key:o,startingPeer:$,ourPeerId:j,signal:et,query:tt,alpha:rt,pathIndex:nt,numPaths:it,cleanUp:st,queryFuncTimeout:ot,log:at,peersSeen:ct}=_,ut=new PQueue({concurrency:rt}),ft=await convertBuffer(o);function ht(mt,gt){if(mt==null)return;ct.add(mt);const Et=BigInt("0x"+toString$a(xor(gt,ft),"base16"));ut.add(async()=>{let St;const At=[et];ot!=null&&(St=new timeoutAbortController.TimeoutController(ot),At.push(St.signal));const kt=anySignal_2(At);try{for await(const Rt of tt({key:o,peer:mt,signal:kt,pathIndex:nt,numPaths:it})){if(kt.aborted)return;if(Rt.name==="PEER_RESPONSE")for(const Tt of Rt.closer){if(ct.has(Tt.id)){at("already seen %p in query",Tt.id);continue}if(j.equals(Tt.id)){at("not querying ourselves");continue}const Dt=await convertPeerId(Tt.id);if(BigInt("0x"+toString$a(xor(Dt,ft),"base16"))>Et){at("skipping %p as they are not closer to %b than %p",Tt.id,o,mt);continue}at("querying closer peer %p",Tt.id),ht(Tt.id,Dt)}ut.emit("completed",Rt)}St==null||St.clear()}catch(Rt){et.aborted?ut.emit("error",Rt):ut.emit("completed",queryErrorEvent({from:mt,error:Rt}))}finally{St==null||St.clear()}},{priority:MAX_XOR-Et}).catch(St=>{at.error(St)})}ht($,await convertPeerId($)),yield*toGenerator(ut,et,st,at)}async function*toGenerator(_,o,$,j){let et=pDefer$1(),tt=!0;const rt=[],nt=()=>{tt&&(j("clean up queue, results %d, queue size %d, pending tasks %d",rt.length,_.size,_.pending),tt=!1,_.clear(),rt.splice(0,rt.length))};for(_.on("completed",it=>{rt.push(it),et.resolve()}),_.on("error",it=>{j("queue error",it),nt(),et.reject(it)}),_.on("idle",()=>{j("queue idle"),tt=!1,et.resolve()}),o.addEventListener("abort",()=>{j("abort queue");const it=tt;nt(),it&&et.reject(new CodeError("Query aborted","ERR_QUERY_ABORTED"))}),$.addEventListener("cleanup",()=>{nt(),et.resolve()});tt;)for(await et.promise,et=pDefer$1();rt.length>0;){const it=rt.shift();it!=null&&(yield it)}yield*rt}class QueryManager{constructor(o,$){const{lan:j=!1,disjointPaths:et=K,alpha:tt=ALPHA}=$;this.components=o,this.disjointPaths=et??K,this.controllers=new Set,this.running=!1,this.alpha=tt??ALPHA,this.lan=j,this.queries=0}isStarted(){return this.running}async start(){this.running=!0,this.components.metrics!=null&&this.metrics==null&&(this.metrics={runningQueries:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_running_queries`),queryTime:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_query_time_seconds`)})}async stop(){this.running=!1;for(const o of this.controllers)o.abort();this.controllers.clear()}async*run(o,$,j,et={}){var ft,ht,mt;if(!this.running)throw new Error("QueryManager not started");const tt=(ft=this.metrics)==null?void 0:ft.queryTime.timer();let rt;if(et.signal==null){rt=new timeoutAbortController.TimeoutController(DEFAULT_QUERY_TIMEOUT),et.signal=rt.signal;try{eventsExports.setMaxListeners!=null&&eventsExports.setMaxListeners(1/0,rt.signal)}catch{}}const nt=new AbortController;this.controllers.add(nt);const it=[nt.signal];et.signal!=null&&it.push(et.signal);const st=anySignal_2(it);try{eventsExports.setMaxListeners!=null&&eventsExports.setMaxListeners(1/0,st)}catch{}const ot=logger$1(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+toString$a(o,"base58btc")),at=$.slice(0,Math.min(this.disjointPaths,$.length)),ct=Date.now(),ut=new EventEmitter$1;try{if(ot("query:start"),this.queries++,(ht=this.metrics)==null||ht.runningQueries.update(this.queries),$.length===0){ot.error("Running query with no peers");return}const gt=new PeerSet,Et=at.map((St,At)=>queryPath({key:o,startingPeer:St,ourPeerId:this.components.peerId,signal:st,query:j,pathIndex:At,numPaths:at.length,alpha:this.alpha,cleanUp:ut,queryFuncTimeout:et.queryFuncTimeout,log:ot,peersSeen:gt}));for await(const St of merge$1(...Et))yield St,St.name==="QUERY_ERROR"&&ot("error",St.error)}catch(gt){if(!(!this.running&&gt.code==="ERR_QUERY_ABORTED"))throw gt}finally{this.controllers.delete(nt),rt!=null&&rt.clear(),this.queries--,(mt=this.metrics)==null||mt.runningQueries.update(this.queries),tt!=null&&tt(),ut.dispatchEvent(new CustomEvent("cleanup")),ot("query:done in %dms",Date.now()-ct)}}}const log$d=logger$1("libp2p:kad-dht:rpc:handlers:add-provider");class AddProviderHandler{constructor(o){const{providers:$}=o;this.providers=$}async handle(o,$){if(log$d("start"),$.key==null||$.key.length===0)throw new CodeError("Missing key","ERR_MISSING_KEY");let j;try{j=CID$3.decode($.key)}catch{throw new CodeError("Invalid CID","ERR_INVALID_CID")}($.providerPeers==null||$.providerPeers.length===0)&&log$d.error("no providers found in message"),await Promise.all($.providerPeers.map(async et=>{if(!et.id.equals(o)){log$d("invalid provider peer %p from %p",et.id,o);return}if(et.multiaddrs.length<1){log$d("no valid addresses for provider %p. Ignore",o);return}log$d("received provider %p for %s (addrs %s)",o,j,et.multiaddrs.map(tt=>tt.toString())),await this.providers.addProvider(j,et.id)}))}}const log$c=logger$1("libp2p:kad-dht:rpc:handlers:find-node");class FindNodeHandler{constructor(o,$){const{peerRouting:j,lan:et}=$;this.components=o,this.peerRouting=j,this.lan=!!et}async handle(o,$){log$c("incoming request from %p for peers closer to %b",o,$.key);let j=[];equals$6(this.components.peerId.toBytes(),$.key)?j=[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map(tt=>tt.decapsulateCode(getProtocol$3("p2p").code)),protocols:[]}]:j=await this.peerRouting.getCloserPeersOffline($.key,o),j=j.map(this.lan?removePublicAddresses:removePrivateAddresses).filter(({multiaddrs:tt})=>tt.length);const et=new Message$1($.type,new Uint8Array(0),$.clusterLevel);return j.length>0?et.closerPeers=j:log$c("could not find any peers closer to %b than %p",$.key,o),et}}const log$b=logger$1("libp2p:kad-dht:rpc:handlers:get-providers");class GetProvidersHandler{constructor(o,$){const{peerRouting:j,providers:et,lan:tt}=$;this.components=o,this.peerRouting=j,this.providers=et,this.lan=!!tt}async handle(o,$){let j;try{j=CID$3.decode($.key)}catch{throw new CodeError("Invalid CID","ERR_INVALID_CID")}log$b("%p asking for providers for %s",o,j);const[et,tt]=await Promise.all([this.providers.getProviders(j),this.peerRouting.getCloserPeersOffline($.key,o)]),rt=await this._getPeers(et),nt=await this._getPeers(tt.map(({id:st})=>st)),it=new Message$1($.type,$.key,$.clusterLevel);return rt.length>0&&(it.providerPeers=rt),nt.length>0&&(it.closerPeers=nt),log$b("got %s providers %s closerPeers",rt.length,nt.length),it}async _getAddresses(o){return(await this.components.peerStore.addressBook.get(o)).map(j=>j.multiaddr)}async _getPeers(o){const $=[],j=this.lan?removePublicAddresses:removePrivateAddresses;for(const et of o){const tt=j({id:et,multiaddrs:await this._getAddresses(et),protocols:[]});tt.multiaddrs.length>0&&$.push(tt)}return $}}const log$a=logger$1("libp2p:kad-dht:rpc:handlers:get-value");class GetValueHandler{constructor(o,$){const{peerRouting:j}=$;this.components=o,this.peerRouting=j}async handle(o,$){const j=$.key;if(log$a("%p asked for key %b",o,j),j==null||j.length===0)throw new CodeError("Invalid key","ERR_INVALID_KEY");const et=new Message$1(MESSAGE_TYPE.GET_VALUE,j,$.clusterLevel);if(isPublicKeyKey(j)){log$a("is public key");const nt=fromPublicKeyKey(j);let it;try{const st=await this.components.peerStore.keyBook.get(nt);if(st==null)throw new CodeError("No public key found in key book","ERR_NOT_FOUND");it=st}catch(st){if(st.code!=="ERR_NOT_FOUND")throw st}if(it!=null)return log$a("returning found public key"),et.record=new Libp2pRecord(j,it,new Date),et}const[tt,rt]=await Promise.all([this._checkLocalDatastore(j),this.peerRouting.getCloserPeersOffline($.key,o)]);return tt!=null&&(log$a("had record for %b in local datastore",j),et.record=tt),rt.length>0&&(log$a("had %s closer peers in routing table",rt.length),et.closerPeers=rt),et}async _checkLocalDatastore(o){log$a("checkLocalDatastore looking for %b",o);const $=bufferToRecordKey(o);let j;try{j=await this.components.datastore.get($)}catch(tt){if(tt.code==="ERR_NOT_FOUND")return;throw tt}const et=Libp2pRecord.deserialize(j);if(et==null)throw new CodeError("Invalid record","ERR_INVALID_RECORD");if(et.timeReceived==null||Date.now()-et.timeReceived.getTime()>MAX_RECORD_AGE){await this.components.datastore.delete($);return}return et}}const log$9=logger$1("libp2p:kad-dht:rpc:handlers:ping");class PingHandler{async handle(o,$){return log$9("ping from %p",o),$}}class PutValueHandler{constructor(o,$){const{validators:j}=$;this.components=o,this.log=logger$1("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=j}async handle(o,$){const j=$.key;this.log("%p asked us to store value for key %b",o,j);const et=$.record;if(et==null){const tt=`Empty record from: ${o.toString()}`;throw this.log.error(tt),new CodeError(tt,"ERR_EMPTY_RECORD")}try{await verifyRecord(this.validators,et),et.timeReceived=new Date;const tt=bufferToRecordKey(et.key);await this.components.datastore.put(tt,et.serialize().subarray()),this.log("put record for %b into datastore under key %k",j,tt)}catch(tt){this.log("did not put record for key %b into datastore %o",j,tt)}return $}}class RPC{constructor(o,$){const{providers:j,peerRouting:et,validators:tt,lan:rt}=$;this.log=logger$1("libp2p:kad-dht:rpc"),this.routingTable=$.routingTable,this.handlers={[MESSAGE_TYPE.GET_VALUE]:new GetValueHandler(o,{peerRouting:et}),[MESSAGE_TYPE.PUT_VALUE]:new PutValueHandler(o,{validators:tt}),[MESSAGE_TYPE.FIND_NODE]:new FindNodeHandler(o,{peerRouting:et,lan:rt}),[MESSAGE_TYPE.ADD_PROVIDER]:new AddProviderHandler({providers:j}),[MESSAGE_TYPE.GET_PROVIDERS]:new GetProvidersHandler(o,{peerRouting:et,providers:j,lan:rt}),[MESSAGE_TYPE.PING]:new PingHandler}}async handleMessage(o,$){try{await this.routingTable.add(o)}catch(et){this.log.error("Failed to update the kbucket store",et)}const j=this.handlers[$.type];if(j==null){this.log.error(`no handler found for message type: ${$.type}`);return}return await j.handle(o,$)}onIncomingStream(o){Promise.resolve().then(async()=>{const{stream:$,connection:j}=o,et=j.remotePeer;try{await this.routingTable.add(et)}catch(rt){this.log.error(rt)}const tt=this;await pipe($,decode$3(),async function*(rt){for await(const nt of rt){const it=Message$1.deserialize(nt);tt.log("incoming %s from %p",it.type,et);const st=await tt.handleMessage(et,it);st!=null&&(yield st.serialize())}},encode$5(),$)}).catch($=>{this.log.error($)})}}class TopologyListener extends EventEmitter$1{constructor(o,$){super();const{protocol:j,lan:et}=$;this.components=o,this.log=logger$1(`libp2p:kad-dht:topology-listener:${et?"lan":"wan"}`),this.running=!1,this.protocol=j}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;const o=createTopology({onConnect:$=>{this.log("observed peer %p with protocol %s",$,this.protocol),this.dispatchEvent(new CustomEvent("peer",{detail:$}))}});this.registrarId=await this.components.registrar.register(this.protocol,o)}async stop(){this.running=!1,this.registrarId!=null&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class QuerySelf{constructor(o,$){const{peerRouting:j,lan:et,count:tt,interval:rt,queryTimeout:nt}=$;this.components=o,this.log=logger$1(`libp2p:kad-dht:${et?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=j,this.count=tt??K,this.interval=rt??QUERY_SELF_INTERVAL,this.queryTimeout=nt??QUERY_SELF_TIMEOUT}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,this.timeoutId!=null&&clearTimeout(this.timeoutId),this.controller!=null&&this.controller.abort()}_querySelf(){Promise.resolve().then(async()=>{const o=new timeoutAbortController.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;const $=anySignal_2([this.controller.signal,o.signal]);try{eventsExports.setMaxListeners!=null&&eventsExports.setMaxListeners(1/0,$)}catch{}const j=await pipe(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:$}),et=>take(et,this.count),async et=>await length$2(et));this.log("query ran successfully - found %d peers",j)}catch($){this.log("query error",$)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),o.clear()}}).catch(o=>{this.log("query error",o)})}}const DEFAULT_MAX_INBOUND_STREAMS$1=32,DEFAULT_MAX_OUTBOUND_STREAMS$1=64;let KadDHT$1=class extends EventEmitter$1{constructor(o,$){super();const{kBucketSize:j,clientMode:et,validators:tt,selectors:rt,querySelfInterval:nt,lan:it,protocolPrefix:st,pingTimeout:ot,pingConcurrency:at,maxInboundStreams:ct,maxOutboundStreams:ut,providers:ft}=$;this.running=!1,this.components=o,this.lan=!!it,this.log=logger$1(`libp2p:kad-dht:${it===!0?"lan":"wan"}`),this.protocol=`${st??PROTOCOL_PREFIX}${it===!0?LAN_PREFIX:""}${PROTOCOL_DHT}`,this.kBucketSize=j??20,this.clientMode=et??!0,this.maxInboundStreams=ct??DEFAULT_MAX_INBOUND_STREAMS$1,this.maxOutboundStreams=ut??DEFAULT_MAX_OUTBOUND_STREAMS$1,this.routingTable=new RoutingTable(o,{kBucketSize:j,lan:this.lan,pingTimeout:ot,pingConcurrency:at,protocol:this.protocol}),this.providers=new Providers(o,ft??{}),this.validators={...validators,...tt},this.selectors={...selectors,...rt},this.network=new Network$2(o,{protocol:this.protocol,lan:this.lan}),this.queryManager=new QueryManager(o,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:it}),this.peerRouting=new PeerRouting(o,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new ContentFetching(o,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new ContentRouting(o,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new RoutingTableRefresh({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new RPC(o,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new TopologyListener(o,{protocol:this.protocol,lan:this.lan}),this.querySelf=new QuerySelf(o,{peerRouting:this.peerRouting,interval:nt,lan:this.lan}),this.network.addEventListener("peer",ht=>{const mt=ht.detail;this.onPeerConnect(mt).catch(gt=>{this.log.error("could not add %p to routing table",mt.id,gt)}),this.dispatchEvent(new CustomEvent("peer",{detail:mt}))}),this.topologyListener.addEventListener("peer",ht=>{const mt=ht.detail;Promise.resolve().then(async()=>{const gt=await this.components.peerStore.addressBook.get(mt),Et={id:mt,multiaddrs:gt.map(St=>St.multiaddr),protocols:[]};await this.onPeerConnect(Et)}).catch(gt=>{this.log.error("could not add %p to routing table",mt,gt)})})}get[symbol$2](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}async onPeerConnect(o){if(this.log("peer %p connected with protocols %s",o.id,o.protocols),this.lan?o=removePublicAddresses(o):o=removePrivateAddresses(o),o.multiaddrs.length===0){this.log("ignoring %p as they do not have any %s addresses in %s",o.id,this.lan?"private":"public",o.multiaddrs.map($=>$.toString()));return}try{await this.routingTable.add(o.id)}catch($){this.log.error("could not add %p to routing table",o.id,$)}}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(o){await this.components.registrar.unhandle(this.protocol),o==="client"?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(o,$,j={}){yield*this.contentFetching.put(o,$,j)}async*get(o,$={}){yield*this.contentFetching.get(o,$)}async*provide(o,$={}){yield*this.contentRouting.provide(o,this.components.addressManager.getAddresses(),$)}async*findProviders(o,$={}){yield*this.contentRouting.findProviders(o,$)}async*findPeer(o,$={}){yield*this.peerRouting.findPeer(o,$)}async*getClosestPeers(o,$={}){yield*this.peerRouting.getClosestPeers(o,$)}async refreshRoutingTable(){this.routingTableRefresh.refreshTable(!0)}};const log$8=logger$1("libp2p:kad-dht");class DualKadDHT extends EventEmitter$1{constructor(o,$,j){super(),this.components=o,this.wan=$,this.lan=j,this.wan.addEventListener("peer",et=>{this.dispatchEvent(new CustomEvent("peer",{detail:et.detail}))}),this.lan.addEventListener("peer",et=>{this.dispatchEvent(new CustomEvent("peer",{detail:et.detail}))})}get[symbol$2](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(o){await this.wan.setMode(o)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(o,$,j={}){for await(const et of merge$1(this.lan.put(o,$,j),this.wan.put(o,$,j)))yield et}async*get(o,$={}){let j=!1,et=!1;for await(const tt of merge$1(this.lan.get(o,$),this.wan.get(o,$)))yield tt,tt.name==="DIALING_PEER"&&(j=!0),tt.name==="VALUE"&&(j=!0,tt.value!=null&&(et=!0)),tt.name==="SENDING_QUERY"&&(j=!0);if(!j)throw new CodeError("No peers found in routing table!","ERR_NO_PEERS_IN_ROUTING_TABLE");et||(yield queryErrorEvent({from:this.components.peerId,error:new CodeError("Not found","ERR_NOT_FOUND")}))}async*provide(o,$={}){let j=0,et=0;const tt=[],rt=[this.lan];await this.wan.getMode()==="server"&&rt.push(this.wan);for await(const nt of merge$1(...rt.map(it=>it.provide(o,$))))yield nt,nt.name==="SENDING_QUERY"&&j++,nt.name==="QUERY_ERROR"&&tt.push(nt.error),nt.name==="PEER_RESPONSE"&&nt.messageName==="ADD_PROVIDER"&&(log$8("sent provider record for %s to %p",o,nt.from),et++);if(et===0)throw tt.length>0?new CodeError(`Failed to provide to ${tt.length} of ${j} peers`,"ERR_PROVIDES_FAILED",{errors:tt}):new CodeError("Failed to provide - no peers found","ERR_PROVIDES_FAILED")}async*findProviders(o,$={}){yield*merge$1(this.lan.findProviders(o,$),this.wan.findProviders(o,$))}async*findPeer(o,$={}){let j=!1;for await(const et of merge$1(this.lan.findPeer(o,$),this.wan.findPeer(o,$)))yield et,(et.name==="SENDING_QUERY"||et.name==="FINAL_PEER")&&(j=!0);if(!j)throw new CodeError("Peer lookup failed","ERR_LOOKUP_FAILED")}async*getClosestPeers(o,$={}){yield*merge$1(this.lan.getClosestPeers(o,$),this.wan.getClosestPeers(o,$))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}class KadDHT extends DualKadDHT{constructor(o,$){super(o,new KadDHT$1(o,{protocolPrefix:"/ipfs",...$,lan:!1}),new KadDHT$1(o,{protocolPrefix:"/ipfs",...$,clientMode:!1,lan:!0}))}}function kadDHT(_){return o=>new KadDHT(o,_)}const isV4=isIPv4,isV6=isIPv6,toBytes=function(_){let o=0;if(_=_.toString().trim(),isV4(_)){const $=new Uint8Array(o+4);return _.split(/\./g).forEach(j=>{$[o++]=parseInt(j,10)&255}),$}if(isV6(_)){const $=_.split(":",8);let j;for(j=0;j<$.length;j++){const tt=isV4($[j]);let rt;tt&&(rt=toBytes($[j]),$[j]=toString$a(rt.slice(0,2),"base16")),rt!=null&&++j<8&&$.splice(j,0,toString$a(rt.slice(2,4),"base16"))}if($[0]==="")for(;$.length<8;)$.unshift("0");else if($[$.length-1]==="")for(;$.length<8;)$.push("0");else if($.length<8){for(j=0;j<$.length&&$[j]!=="";j++);const tt=[j,1];for(j=9-$.length;j>0;j--)tt.push("0");$.splice.apply($,tt)}const et=new Uint8Array(o+16);for(j=0;j<$.length;j++){const tt=parseInt($[j],16);et[o++]=tt>>8&255,et[o++]=tt&255}return et}throw new Error("invalid ip address")},toString=function(_,o=0,$){o=~~o,$=$??_.length-o;const j=new DataView(_.buffer);if($===4){const et=[];for(let tt=0;tt<$;tt++)et.push(_[o+tt]);return et.join(".")}if($===16){const et=[];for(let tt=0;tt<$;tt+=2)et.push(j.getUint16(o+tt).toString(16));return et.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V=-1,names={},codes={},table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V,"ip6zone"],[43,8,"ipcidr"],[53,V,"dns",!0],[54,V,"dns4",!0],[55,V,"dns6",!0],[56,V,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V,"unix",!1,!0],[421,V,"ipfs"],[421,V,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V,"garlic64"],[448,0,"tls"],[449,V,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V,"memory"]];table.forEach(_=>{const o=createProtocol(..._);codes[o.code]=o,names[o.name]=o});function createProtocol(_,o,$,j,et){return{code:_,size:o,name:$,resolvable:!!j,path:!!et}}function getProtocol(_){if(typeof _=="number"){if(codes[_]!=null)return codes[_];throw new Error(`no protocol with code: ${_}`)}else if(typeof _=="string"){if(names[_]!=null)return names[_];throw new Error(`no protocol with name: ${_}`)}throw new Error(`invalid protocol id type: ${typeof _}`)}function convertToString(_,o){switch(getProtocol(_).code){case 4:case 41:return bytes2ip(o);case 42:return bytes2str(o);case 6:case 273:case 33:case 132:return bytes2port(o).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str(o);case 421:return bytes2mh(o);case 444:return bytes2onion(o);case 445:return bytes2onion(o);case 466:return bytes2mb(o);default:return toString$a(o,"base16")}}function convertToBytes(_,o){switch(getProtocol(_).code){case 4:return ip2bytes(o);case 41:return ip2bytes(o);case 42:return str2bytes(o);case 6:case 273:case 33:case 132:return port2bytes(parseInt(o,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes(o);case 421:return mh2bytes(o);case 444:return onion2bytes(o);case 445:return onion32bytes(o);case 466:return mb2bytes(o);default:return fromString$8(o,"base16")}}const decoders=Object.values(bases$2).map(_=>_.decoder),anybaseDecoder=function(){let _=decoders[0].or(decoders[1]);return decoders.slice(2).forEach(o=>_=_.or(o)),_}();function ip2bytes(_){if(!isIP(_))throw new Error("invalid ip address");return toBytes(_)}function bytes2ip(_){const o=toString(_,0,_.length);if(o==null)throw new Error("ipBuff is required");if(!isIP(o))throw new Error("invalid ip address");return o}function port2bytes(_){const o=new ArrayBuffer(2);return new DataView(o).setUint16(0,_),new Uint8Array(o)}function bytes2port(_){return new DataView(_.buffer).getUint16(_.byteOffset)}function str2bytes(_){const o=fromString$8(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2str(_){const o=varint$2.decode(_);if(_=_.slice(varint$2.decode.bytes),_.length!==o)throw new Error("inconsistent lengths");return toString$a(_)}function mh2bytes(_){let o;_[0]==="Q"||_[0]==="1"?o=decode$B(base58btc$4.decode(`z${_}`)).bytes:o=CID$3.parse(_).multihash.bytes;const $=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function mb2bytes(_){const o=anybaseDecoder.decode(_),$=Uint8Array.from(varint$2.encode(o.length));return concat$2([$,o],$.length+o.length)}function bytes2mb(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return"u"+toString$a($,"base64url")}function bytes2mh(_){const o=varint$2.decode(_),$=_.slice(varint$2.decode.bytes);if($.length!==o)throw new Error("inconsistent lengths");return toString$a($,"base58btc")}function onion2bytes(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==16)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion address.`);const $=base32$6.decode("b"+o[0]),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes(j);return concat$2([$,et],$.length+et.length)}function onion32bytes(_){const o=_.split(":");if(o.length!==2)throw new Error(`failed to parse onion addr: ["'${o.join('", "')}'"]' does not contain a port number`);if(o[0].length!==56)throw new Error(`failed to parse onion addr: ${o[0]} not a Tor onion3 address.`);const $=base32$6.decode(`b${o[0]}`),j=parseInt(o[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const et=port2bytes(j);return concat$2([$,et],$.length+et.length)}function bytes2onion(_){const o=_.slice(0,_.length-2),$=_.slice(_.length-2),j=toString$a(o,"base32"),et=bytes2port($);return`${j}:${et}`}function stringToStringTuples(_){const o=[],$=_.split("/").slice(1);if($.length===1&&$[0]==="")return[];for(let j=0;j<$.length;j++){const et=$[j],tt=getProtocol(et);if(tt.size===0){o.push([et]);continue}if(j++,j>=$.length)throw ParseError("invalid address: "+_);if(tt.path===!0){o.push([et,cleanPath($.slice(j).join("/"))]);break}o.push([et,$[j]])}return o}function stringTuplesToString(_){const o=[];return _.map($=>{const j=protoFromTuple($);return o.push(j.name),$.length>1&&$[1]!=null&&o.push($[1]),null}),cleanPath(o.join("/"))}function stringTuplesToTuples(_){return _.map(o=>{Array.isArray(o)||(o=[o]);const $=protoFromTuple(o);return o.length>1?[$.code,convertToBytes($.code,o[1])]:[$.code]})}function tuplesToStringTuples(_){return _.map(o=>{const $=protoFromTuple(o);return o[1]!=null?[$.code,convertToString($.code,o[1])]:[$.code]})}function tuplesToBytes(_){return fromBytes(concat$2(_.map(o=>{const $=protoFromTuple(o);let j=Uint8Array.from(varint$2.encode($.code));return o.length>1&&o[1]!=null&&(j=concat$2([j,o[1]])),j})))}function sizeForAddr(_,o){return _.size>0?_.size/8:_.size===0?0:varint$2.decode(o)+(varint$2.decode.bytes??0)}function bytesToTuples(_){const o=[];let $=0;for(;$<_.length;){const j=varint$2.decode(_,$),et=varint$2.decode.bytes??0,tt=getProtocol(j),rt=sizeForAddr(tt,_.slice($+et));if(rt===0){o.push([j]),$+=et;continue}const nt=_.slice($+et,$+et+rt);if($+=rt+et,$>_.length)throw ParseError("Invalid address Uint8Array: "+toString$a(_,"base16"));o.push([j,nt])}return o}function bytesToString(_){const o=bytesToTuples(_),$=tuplesToStringTuples(o);return stringTuplesToString($)}function stringToBytes(_){_=cleanPath(_);const o=stringToStringTuples(_),$=stringTuplesToTuples(o);return tuplesToBytes($)}function fromString(_){return stringToBytes(_)}function fromBytes(_){const o=validateBytes(_);if(o!=null)throw o;return Uint8Array.from(_)}function validateBytes(_){try{bytesToTuples(_)}catch(o){return o}}function cleanPath(_){return"/"+_.trim().split("/").filter(o=>o).join("/")}function ParseError(_){return new Error("Error parsing address: "+_)}function protoFromTuple(_){return getProtocol(_[0])}var __classPrivateFieldGet=globalThis&&globalThis.__classPrivateFieldGet||function(_,o,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?_!==o||!j:!o.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:o.get(_)},__classPrivateFieldSet=globalThis&&globalThis.__classPrivateFieldSet||function(_,o,$,j,et){if(j==="m")throw new TypeError("Private method is not writable");if(j==="a"&&!et)throw new TypeError("Private accessor was defined without a setter");if(typeof o=="function"?_!==o||!et:!o.has(_))throw new TypeError("Cannot write private member to an object whose class did not declare it");return j==="a"?et.call(_,$):et?et.value=$:o.set(_,$),$},_DefaultMultiaddr_string,_DefaultMultiaddr_tuples,_DefaultMultiaddr_stringTuples,_a;const inspect=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES=[getProtocol("dns").code,getProtocol("dns4").code,getProtocol("dns6").code,getProtocol("dnsaddr").code],resolvers=new Map,symbol=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr(_){return!!(_!=null&&_[symbol])}class DefaultMultiaddr{constructor(o){if(_DefaultMultiaddr_string.set(this,void 0),_DefaultMultiaddr_tuples.set(this,void 0),_DefaultMultiaddr_stringTuples.set(this,void 0),this[_a]=!0,o==null&&(o=""),o instanceof Uint8Array)this.bytes=fromBytes(o);else if(typeof o=="string"){if(o.length>0&&o.charAt(0)!=="/")throw new Error(`multiaddr "${o}" must start with a "/"`);this.bytes=fromString(o)}else if(isMultiaddr(o))this.bytes=fromBytes(o.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_string,bytesToString(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")}toJSON(){return this.toString()}toOptions(){let o,$,j,et,tt="";const rt=getProtocol("tcp"),nt=getProtocol("udp"),it=getProtocol("ip4"),st=getProtocol("ip6"),ot=getProtocol("dns6"),at=getProtocol("ip6zone");for(const[ut,ft]of this.stringTuples())ut===at.code&&(tt=`%${ft??""}`),DNS_CODES.includes(ut)&&($=rt.name,et=443,j=`${ft??""}${tt}`,o=ut===ot.code?6:4),(ut===rt.code||ut===nt.code)&&($=getProtocol(ut).name,et=parseInt(ft??"")),(ut===it.code||ut===st.code)&&($=getProtocol(ut).name,j=`${ft??""}${tt}`,o=ut===st.code?6:4);if(o==null||$==null||j==null||et==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:o,host:j,transport:$,port:et}}protos(){return this.protoCodes().map(o=>Object.assign({},getProtocol(o)))}protoCodes(){const o=[],$=this.bytes;let j=0;for(;j<$.length;){const et=varint$2.decode($,j),tt=varint$2.decode.bytes??0,rt=getProtocol(et),nt=sizeForAddr(rt,$.slice(j+tt));j+=nt+tt,o.push(et)}return o}protoNames(){return this.protos().map(o=>o.name)}tuples(){return __classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_tuples,bytesToTuples(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")}stringTuples(){return __classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_stringTuples,tuplesToStringTuples(this.tuples()),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")}encapsulate(o){return o=new DefaultMultiaddr(o),new DefaultMultiaddr(this.toString()+o.toString())}decapsulate(o){const $=o.toString(),j=this.toString(),et=j.lastIndexOf($);if(et<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${o.toString()}`);return new DefaultMultiaddr(j.slice(0,et))}decapsulateCode(o){const $=this.tuples();for(let j=$.length-1;j>=0;j--)if($[j][0]===o)return new DefaultMultiaddr(tuplesToBytes($.slice(0,j)));return this}getPeerId(){try{const $=this.stringTuples().filter(j=>j[0]===names.ipfs.code).pop();if(($==null?void 0:$[1])!=null){const j=$[1];return j[0]==="Q"||j[0]==="1"?toString$a(base58btc$4.decode(`z${j}`),"base58btc"):toString$a(CID$3.parse(j).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let o=null;try{o=this.stringTuples().filter($=>getProtocol($[0]).path===!0)[0][1],o==null&&(o=null)}catch{o=null}return o}equals(o){return equals$6(this.bytes,o.bytes)}async resolve(o){const $=this.protos().find(tt=>tt.resolvable);if($==null)return[this];const j=resolvers.get($.name);if(j==null)throw errCode(new Error(`no available resolver for ${$.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await j(this,o)).map(tt=>new DefaultMultiaddr(tt))}nodeAddress(){const o=this.toOptions();if(o.transport!=="tcp"&&o.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${o.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:o.family,address:o.host,port:o.port}}isThinWaistAddress(o){const $=(o??this).protos();return!($.length!==2||$[0].code!==4&&$[0].code!==41||$[1].code!==6&&$[1].code!==273)}[(_DefaultMultiaddr_string=new WeakMap,_DefaultMultiaddr_tuples=new WeakMap,_DefaultMultiaddr_stringTuples=new WeakMap,_a=symbol,inspect)](){return`Multiaddr(${bytesToString(this.bytes)})`}}function multiaddr(_){return new DefaultMultiaddr(_)}const log$7=logger$1("libp2p:bootstrap"),DEFAULT_BOOTSTRAP_TAG_NAME="bootstrap",DEFAULT_BOOTSTRAP_TAG_VALUE=50,DEFAULT_BOOTSTRAP_TAG_TTL=12e4,DEFAULT_BOOTSTRAP_DISCOVERY_TIMEOUT=1e3;class Bootstrap extends EventEmitter$1{constructor(o,$={list:[]}){if($.list==null||$.list.length===0)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=o,this.timeout=$.timeout??DEFAULT_BOOTSTRAP_DISCOVERY_TIMEOUT,this.list=[];for(const j of $.list){if(!P2P.matches(j)){log$7.error("Invalid multiaddr");continue}const et=multiaddr(j),tt=et.getPeerId();if(tt==null){log$7.error("Invalid bootstrap multiaddr without peer id");continue}const rt={id:peerIdFromString(tt),multiaddrs:[et],protocols:[]};this.list.push(rt)}this._init=$}get[symbol$2](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return!!this.timer}start(){this.isStarted()||(log$7("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout(()=>{this._discoverBootstrapPeers().catch(o=>{log$7.error(o)})},this.timeout))}async _discoverBootstrapPeers(){if(this.timer!=null)for(const o of this.list){if(await this.components.peerStore.tagPeer(o.id,this._init.tagName??DEFAULT_BOOTSTRAP_TAG_NAME,{value:this._init.tagValue??DEFAULT_BOOTSTRAP_TAG_VALUE,ttl:this._init.tagTTL??DEFAULT_BOOTSTRAP_TAG_TTL}),this.timer==null)return;this.dispatchEvent(new CustomEvent("peer",{detail:o}))}}stop(){this.timer!=null&&clearTimeout(this.timer),this.timer=void 0}}Bootstrap.tag="bootstrap";function bootstrap(_){return o=>new Bootstrap(o,_)}const WebSocket$1=WebSocket;var dom={},eventIterator={};Object.defineProperty(eventIterator,"__esModule",{value:!0});class EventQueue{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(o){if(this.isStopped)return;const $={value:o,done:!1};if(this.pullQueue.length){const j=this.pullQueue.shift();j&&j.resolve($)}else this.pushQueue.push(Promise.resolve($)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const o of this.pullQueue)o.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(o){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const $ of this.pullQueue)$.reject(o);this.pullQueue.length=0}else{const $=Promise.reject(o);$.catch(()=>{}),this.pushQueue.push($)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:o=>{const $=this.pushQueue.shift();return $?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),$):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((j,et)=>{this.pullQueue.push({resolve:j,reject:et})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}let EventIterator$1=class{constructor(o,{highWaterMark:$=100,lowWaterMark:j=1}={}){const et=new EventQueue;et.highWaterMark=$,et.lowWaterMark=j,et.removeCallback=o({push:tt=>et.push(tt),stop:()=>et.stop(),fail:tt=>et.fail(tt),on:(tt,rt)=>{et.eventHandlers[tt]=rt}})||(()=>{}),this[Symbol.asyncIterator]=()=>et[Symbol.asyncIterator](),Object.freeze(this)}};eventIterator.EventIterator=EventIterator$1;eventIterator.default=EventIterator$1;Object.defineProperty(dom,"__esModule",{value:!0});const event_iterator_1=eventIterator;var EventIterator=dom.EventIterator=event_iterator_1.EventIterator;function subscribe(_,o,$){return new event_iterator_1.EventIterator(({push:j})=>(this.addEventListener(_,j,o),()=>this.removeEventListener(_,j,o)),$)}dom.subscribe=subscribe;dom.default=event_iterator_1.EventIterator;function isArrayBuffer(_){var o;return _ instanceof ArrayBuffer||((o=_==null?void 0:_.constructor)==null?void 0:o.name)==="ArrayBuffer"&&typeof(_==null?void 0:_.byteLength)=="number"}const source=_=>{_.binaryType="arraybuffer";const o=async()=>await new Promise((tt,rt)=>{if(j)return tt();if(et!=null)return rt(et);const nt=ot=>{_.removeEventListener("open",it),_.removeEventListener("error",st),ot()},it=()=>nt(tt),st=ot=>{nt(()=>rt(ot.error??new Error(`connect ECONNREFUSED ${_.url}`)))};_.addEventListener("open",it),_.addEventListener("error",st)}),$=async function*(){const tt=new EventIterator(({push:rt,stop:nt,fail:it})=>{const st=at=>{let ct=null;typeof at.data=="string"&&(ct=fromString$8(at.data)),isArrayBuffer(at.data)&&(ct=new Uint8Array(at.data)),at.data instanceof Uint8Array&&(ct=at.data),ct!=null&&rt(ct)},ot=at=>it(at.error??new Error("Socket error"));return _.addEventListener("message",st),_.addEventListener("error",ot),_.addEventListener("close",nt),()=>{_.removeEventListener("message",st),_.removeEventListener("error",ot),_.removeEventListener("close",nt)}},{highWaterMark:1/0});await o();for await(const rt of tt)yield isArrayBuffer(rt)?new Uint8Array(rt):rt}();let j=_.readyState===1,et;return _.addEventListener("open",()=>{j=!0,et=null}),_.addEventListener("close",()=>{j=!1,et=null}),_.addEventListener("error",tt=>{j||(et=tt.error??new Error(`connect ECONNREFUSED ${_.url}`))}),Object.assign($,{connected:o})},ready=_=>{if(_.readyState>=2)throw new Error("socket closed");if(_.readyState!==1)return new Promise((o,$)=>{function j(){_.removeEventListener("open",et),_.removeEventListener("error",tt)}function et(){j(),o()}function tt(rt){j(),$(rt.error??new Error(`connect ECONNREFUSED ${_.url}`))}_.addEventListener("open",et),_.addEventListener("error",tt)})},sink=(_,o)=>(o=o??{},o.closeOnEnd=o.closeOnEnd!==!1,async j=>{for await(const et of j){try{await ready(_)}catch(tt){if(tt.message==="socket closed")break;throw tt}_.send(et)}if(o.closeOnEnd!=null&&_.readyState<=1)return await new Promise((et,tt)=>{_.addEventListener("close",rt=>{if(rt.wasClean||rt.code===1006)et();else{const nt=Object.assign(new Error("ws error"),{event:rt});tt(nt)}}),setTimeout(()=>_.close())})}),duplex=(_,o)=>{o=o??{};const $=source(_);let j=o.remoteAddress,et=o.remotePort;if(_.url!=null)try{const rt=new URL(_.url);j=rt.hostname,et=parseInt(rt.port,10)}catch{}if(j==null||et==null)throw new Error("Remote connection did not have address and/or port");return{sink:sink(_,o),source:$,connected:async()=>await $.connected(),close:async()=>{(_.readyState===_.CONNECTING||_.readyState===_.OPEN)&&await new Promise(rt=>{_.addEventListener("close",()=>{rt()}),_.close()})},destroy:()=>{_.terminate!=null?_.terminate():_.close()},remoteAddress:j,remotePort:et,socket:_}},map={http:"ws",https:"wss"},def="ws",wsurl=(_,o)=>isoUrl.relative(_,o,map,def);function connect(_,o){const $=typeof window>"u"?"":window.location;o=o??{};const j=wsurl(_,$.toString()),et=new WebSocket$1(j,o.websocket);return duplex(et,o)}function createListener(){throw new Error("WebSocket Servers can not be created in the browser!")}const CODE_P2P=421,CODE_CIRCUIT=290,CLOSE_TIMEOUT=2e3;class TimeoutError extends Error{constructor(o){super(o),this.name="TimeoutError"}}class AbortError extends Error{constructor(o){super(),this.name="AbortError",this.message=o}}const getDOMException=_=>globalThis.DOMException===void 0?new AbortError(_):new DOMException(_),getAbortedReason=_=>{const o=_.reason===void 0?getDOMException("This operation was aborted."):_.reason;return o instanceof Error?o:getDOMException(o)};function pTimeout(_,o){const{milliseconds:$,fallback:j,message:et,customTimers:tt={setTimeout,clearTimeout}}=o;let rt;const nt=new Promise((it,st)=>{if(typeof $!="number"||Math.sign($)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${$}\``);if($===Number.POSITIVE_INFINITY){it(_);return}if(o.signal){const{signal:at}=o;at.aborted&&st(getAbortedReason(at)),at.addEventListener("abort",()=>{st(getAbortedReason(at))})}const ot=new TimeoutError;rt=tt.setTimeout.call(void 0,()=>{if(j){try{it(j())}catch(at){st(at)}return}typeof _.cancel=="function"&&_.cancel(),et===!1?it():et instanceof Error?st(et):(ot.message=et??`Promise timed out after ${$} milliseconds`,st(ot))},$),(async()=>{try{it(await _)}catch(at){st(at)}finally{tt.clearTimeout.call(void 0,rt)}})()});return nt.clear=()=>{tt.clearTimeout.call(void 0,rt),rt=void 0},nt}const log$6=logger$1("libp2p:websockets:socket");function socketToMaConn(_,o,$){$=$??{};const j={async sink(et){($==null?void 0:$.signal)!=null&&(et=abortableSource(et,$.signal));try{await _.sink(et)}catch(tt){tt.type!=="aborted"&&log$6.error(tt)}},source:$.signal!=null?abortableSource(_.source,$.signal):_.source,remoteAddr:o,timeline:{open:Date.now()},async close(){const et=Date.now();try{await pTimeout(_.close(),{milliseconds:CLOSE_TIMEOUT})}catch{const{host:rt,port:nt}=j.remoteAddr.toOptions();log$6("timeout closing stream to %s:%s after %dms, destroying it manually",rt,nt,Date.now()-et),_.destroy()}finally{j.timeline.close=Date.now()}}};return _.socket.addEventListener("close",()=>{j.timeline.close==null&&(j.timeline.close=Date.now())},{once:!0}),j}function all(_){return _.filter(o=>{if(o.protoCodes().includes(CODE_CIRCUIT))return!1;const $=o.decapsulateCode(CODE_P2P);return WebSockets$1.matches($)||WebSocketsSecure.matches($)})}function wss(_){return _.filter(o=>{if(o.protoCodes().includes(CODE_CIRCUIT))return!1;const $=o.decapsulateCode(CODE_P2P);return WebSocketsSecure.matches($)})}const log$5=logger$1("libp2p:websockets");class WebSockets{constructor(o){this.init=o}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[symbol$3](){return!0}async dial(o,$){log$5("dialing %s",o),$=$??{};const j=await this._connect(o,$),et=socketToMaConn(j,o);log$5("new outbound connection %s",et.remoteAddr);const tt=await $.upgrader.upgradeOutbound(et);return log$5("outbound connection %s upgraded",et.remoteAddr),tt}async _connect(o,$){var st,ot;if(((st=$==null?void 0:$.signal)==null?void 0:st.aborted)===!0)throw new AbortError$5;const j=o.toOptions();log$5("dialing %s:%s",j.host,j.port);const et=pDefer$1(),tt=at=>{log$5.error("connection error:",at),et.reject(at)},rt=connect(multiaddrToUri(o),this.init);if(rt.socket.on!=null?rt.socket.on("error",tt):rt.socket.onerror=tt,$.signal==null)return await Promise.race([rt.connected(),et.promise]),log$5("connected %s",o),rt;let nt;const it=new Promise((at,ct)=>{var ut,ft;if(nt=()=>{ct(new AbortError$5),rt.close().catch(ht=>{log$5.error("error closing raw socket",ht)})},((ut=$==null?void 0:$.signal)==null?void 0:ut.aborted)===!0){nt();return}(ft=$==null?void 0:$.signal)==null||ft.addEventListener("abort",nt)});try{await Promise.race([it,et.promise,rt.connected()])}finally{nt!=null&&((ot=$==null?void 0:$.signal)==null||ot.removeEventListener("abort",nt))}return log$5("connected %s",o),rt}createListener(o){return createListener({...this.init,...o})}filter(o){var $,j;return o=Array.isArray(o)?o:[o],(($=this.init)==null?void 0:$.filter)!=null?(j=this.init)==null?void 0:j.filter(o):isBrowser$2||isWebWorker$1?wss(o):all(o)}}function webSockets(_={}){return()=>new WebSockets(_)}function allocUnsafe$1(_){return new Uint8Array(_)}var MessageTypes;(function(_){_[_.NEW_STREAM=0]="NEW_STREAM",_[_.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",_[_.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",_[_.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",_[_.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",_[_.RESET_RECEIVER=5]="RESET_RECEIVER",_[_.RESET_INITIATOR=6]="RESET_INITIATOR"})(MessageTypes||(MessageTypes={}));const MessageTypeNames=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),InitiatorMessageTypes=Object.freeze({NEW_STREAM:MessageTypes.NEW_STREAM,MESSAGE:MessageTypes.MESSAGE_INITIATOR,CLOSE:MessageTypes.CLOSE_INITIATOR,RESET:MessageTypes.RESET_INITIATOR}),ReceiverMessageTypes=Object.freeze({MESSAGE:MessageTypes.MESSAGE_RECEIVER,CLOSE:MessageTypes.CLOSE_RECEIVER,RESET:MessageTypes.RESET_RECEIVER}),DEFAULT_BATCH_SIZE=1024*1024,DEFAULT_SERIALIZE=(_,o)=>{o.append(_)};async function*batchedBytes(_,o={}){let $=new Uint8ArrayList,j=!1,et=pDefer$1(),tt=Number(o.size??DEFAULT_BATCH_SIZE);(isNaN(tt)||tt===0||tt<0)&&(tt=DEFAULT_BATCH_SIZE);const rt=o.yieldAfter??0,nt=o.serialize??DEFAULT_SERIALIZE;for(Promise.resolve().then(async()=>{try{let it;for await(const st of _){if(nt(st,$),$.byteLength>=tt){clearTimeout(it),et.resolve();continue}it=setTimeout(()=>{et.resolve()},rt)}clearTimeout(it),et.resolve()}catch(it){et.reject(it)}finally{j=!0}});!j;)if(await et.promise,et=pDefer$1(),$.byteLength>0){const it=$;$=new Uint8ArrayList,yield it.subarray()}}const POOL_SIZE=10*1024;class Encoder{constructor(){this._pool=allocUnsafe$1(POOL_SIZE),this._poolOffset=0}write(o,$){const j=this._pool;let et=this._poolOffset;varint$2.encode(o.id<<3|o.type,j,et),et+=varint$2.encode.bytes??0,(o.type===MessageTypes.NEW_STREAM||o.type===MessageTypes.MESSAGE_INITIATOR||o.type===MessageTypes.MESSAGE_RECEIVER)&&o.data!=null?varint$2.encode(o.data.length,j,et):varint$2.encode(0,j,et),et+=varint$2.encode.bytes??0;const tt=j.subarray(this._poolOffset,et);POOL_SIZE-et<100?(this._pool=allocUnsafe$1(POOL_SIZE),this._poolOffset=0):this._poolOffset=et,$.append(tt),(o.type===MessageTypes.NEW_STREAM||o.type===MessageTypes.MESSAGE_INITIATOR||o.type===MessageTypes.MESSAGE_RECEIVER)&&o.data!=null&&$.append(o.data)}}const encoder=new Encoder;async function*encode$1(_,o=0){if(o==null||o===0){for await(const $ of _){const j=new Uint8ArrayList;for(const et of $)encoder.write(et,j);yield j.subarray()}return}yield*batchedBytes(_,{size:o,serialize:($,j)=>{for(const et of $)encoder.write(et,j)}})}const MAX_MSG_SIZE=1<<20,MAX_MSG_QUEUE_SIZE=4<<20;class Decoder{constructor(o=MAX_MSG_SIZE,$=MAX_MSG_QUEUE_SIZE){this._buffer=new Uint8ArrayList,this._headerInfo=null,this._maxMessageSize=o,this._maxUnprocessedMessageQueueSize=$}write(o){if(o==null||o.length===0)return[];if(this._buffer.append(o),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const $=[];for(;this._buffer.length!==0;){if(this._headerInfo==null)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(st){if(st.code==="ERR_MSG_TOO_BIG")throw st;break}const{id:j,type:et,length:tt,offset:rt}=this._headerInfo;if(this._buffer.length-rt<tt)break;const it={id:j,type:et};(et===MessageTypes.NEW_STREAM||et===MessageTypes.MESSAGE_INITIATOR||et===MessageTypes.MESSAGE_RECEIVER)&&(it.data=this._buffer.sublist(rt,rt+tt)),$.push(it),this._buffer.consume(rt+tt),this._headerInfo=null}return $}_decodeHeader(o){const{value:$,offset:j}=readVarInt(o),{value:et,offset:tt}=readVarInt(o,j),rt=$&7;if(MessageTypeNames[rt]==null)throw new Error(`Invalid type received: ${rt}`);if(et>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:$>>3,type:rt,offset:j+tt,length:et}}}const MSB$2=128,REST$2=127;function readVarInt(_,o=0){let $=0,j=0,et=o,tt;const rt=_.length;do{if(et>=rt||j>49)throw o=0,new RangeError("Could not decode varint");tt=_.get(et++),$+=j<28?(tt&REST$2)<<j:(tt&REST$2)*Math.pow(2,j),j+=7}while(tt>=MSB$2);return o=et-o,{value:$,offset:o}}const log$4=logger$1("libp2p:mplex:stream"),ERR_STREAM_RESET="ERR_STREAM_RESET",ERR_STREAM_ABORT="ERR_STREAM_ABORT",ERR_SINK_ENDED="ERR_SINK_ENDED",ERR_DOUBLE_SINK="ERR_DOUBLE_SINK";function createStream(_){const{id:o,name:$,send:j,onEnd:et,type:tt="initiator",maxMsgSize:rt=MAX_MSG_SIZE}=_,nt=new AbortController,it=new AbortController,st=new AbortController,ot=tt==="initiator"?InitiatorMessageTypes:ReceiverMessageTypes,at=tt==="initiator"?`i${o}`:`r${o}`,ct=`${$??o}`;let ut=!1,ft=!1,ht=!1,mt;const gt={open:Date.now()},Et=Rt=>{ut||(ut=!0,log$4.trace("%s stream %s source end - err: %o",tt,ct,Rt),Rt!=null&&mt==null&&(mt=Rt),ft&&(kt.stat.timeline.close=Date.now(),et!=null&&et(mt)))},St=Rt=>{ft||(ft=!0,log$4.trace("%s stream %s sink end - err: %o",tt,ct,Rt),Rt!=null&&mt==null&&(mt=Rt),ut&&(gt.close=Date.now(),et!=null&&et(mt)))},At=pushable({onEnd:Et}),kt={close:()=>{log$4.trace("%s stream %s close",tt,ct),kt.closeRead(),kt.closeWrite()},closeRead:()=>{log$4.trace("%s stream %s closeRead",tt,ct),!ut&&At.end()},closeWrite:()=>{if(log$4.trace("%s stream %s closeWrite",tt,ct),!ft){st.abort();try{j({id:o,type:ot.CLOSE})}catch(Rt){log$4.trace("%s stream %s error sending close",tt,$,Rt)}St()}},abort:Rt=>{log$4.trace("%s stream %s abort",tt,ct,Rt),At.end(Rt),nt.abort(),St(Rt)},reset:()=>{const Rt=errCode(new Error("stream reset"),ERR_STREAM_RESET);it.abort(),At.end(Rt),St(Rt)},sink:async Rt=>{if(ht)throw errCode(new Error("sink already called on stream"),ERR_DOUBLE_SINK);if(ht=!0,ft)throw errCode(new Error("stream closed for writing"),ERR_SINK_ENDED);Rt=abortableSource(Rt,anySignal_2([nt.signal,it.signal,st.signal]));try{tt==="initiator"&&j({id:o,type:InitiatorMessageTypes.NEW_STREAM,data:new Uint8ArrayList(fromString$8(ct))});for await(let Tt of Rt)for(;Tt.length>0;){if(Tt.length<=rt){j({id:o,type:ot.MESSAGE,data:Tt instanceof Uint8Array?new Uint8ArrayList(Tt):Tt});break}Tt=Tt instanceof Uint8Array?new Uint8ArrayList(Tt):Tt,j({id:o,type:ot.MESSAGE,data:Tt.sublist(0,rt)}),Tt.consume(rt)}}catch(Tt){if(Tt.type==="aborted"&&Tt.message==="The operation was aborted"){if(st.signal.aborted)return;it.signal.aborted&&(Tt.message="stream reset",Tt.code=ERR_STREAM_RESET),nt.signal.aborted&&(Tt.message="stream aborted",Tt.code=ERR_STREAM_ABORT)}if(Tt.code===ERR_STREAM_RESET)log$4.trace("%s stream %s reset",tt,$);else{log$4.trace("%s stream %s error",tt,$,Tt);try{j({id:o,type:ot.RESET})}catch(Dt){log$4.trace("%s stream %s error sending reset",tt,$,Dt)}}At.end(Tt),St(Tt);return}try{j({id:o,type:ot.CLOSE})}catch(Tt){log$4.trace("%s stream %s error sending close",tt,$,Tt)}St()},source:At,sourcePush:Rt=>{At.push(Rt)},sourceReadableLength(){return At.readableLength},stat:{direction:tt==="initiator"?"outbound":"inbound",timeline:gt},metadata:{},id:at};return kt}const log$3=logger$1("libp2p:mplex"),MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION=1024,MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION=1024,MAX_STREAM_BUFFER_SIZE=1024*1024*4,DISCONNECT_THRESHOLD=5;function printMessage(_){const o={..._,type:`${MessageTypeNames[_.type]} (${_.type})`};return _.type===MessageTypes.NEW_STREAM&&(o.data=toString$a(_.data instanceof Uint8Array?_.data:_.data.subarray())),(_.type===MessageTypes.MESSAGE_INITIATOR||_.type===MessageTypes.MESSAGE_RECEIVER)&&(o.data=toString$a(_.data instanceof Uint8Array?_.data:_.data.subarray(),"base16")),o}class MplexStreamMuxer{constructor(o){this.protocol="/mplex/6.7.0",o=o??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=o,this.sink=this._createSink();const $=this._createSource();this._source=$,this.source=$,this.closeController=new AbortController,this.rateLimiter=new rateLimiterFlexible.RateLimiterMemory({points:o.disconnectThreshold??DISCONNECT_THRESHOLD,duration:1})}get streams(){const o=[];for(const $ of this._streams.initiators.values())o.push($);for(const $ of this._streams.receivers.values())o.push($);return o}newStream(o){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const $=this._streamId++;o=o==null?$.toString():o.toString();const j=this._streams.initiators;return this._newStream({id:$,name:o,type:"initiator",registry:j})}close(o){this.closeController.signal.aborted||(o!=null?this.streams.forEach($=>$.abort(o)):this.streams.forEach($=>$.close()),this.closeController.abort())}_newReceiverStream(o){const{id:$,name:j}=o,et=this._streams.receivers;return this._newStream({id:$,name:j,type:"receiver",registry:et})}_newStream(o){const{id:$,name:j,type:et,registry:tt}=o;if(log$3("new %s stream %s",et,$),et==="initiator"&&this._streams.initiators.size===(this._init.maxOutboundStreams??MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION))throw errCode(new Error("Too many outbound streams open"),"ERR_TOO_MANY_OUTBOUND_STREAMS");if(tt.has($))throw new Error(`${et} stream ${$} already exists!`);const it=createStream({id:$,name:j,send:st=>{log$3.enabled&&log$3.trace("%s stream %s send",et,$,printMessage(st)),this._source.push(st)},type:et,onEnd:()=>{log$3("%s stream with id %s and protocol %s ended",et,$,it.stat.protocol),tt.delete($),this._init.onStreamEnd!=null&&this._init.onStreamEnd(it)},maxMsgSize:this._init.maxMsgSize});return tt.set($,it),it}_createSink(){return async $=>{const j=[this.closeController.signal];this._init.signal!=null&&j.push(this._init.signal),$=abortableSource($,anySignalExports(j));try{const et=new Decoder(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const tt of $)for(const rt of et.write(tt))await this._handleIncoming(rt);this._source.end()}catch(et){log$3("error in sink",et),this._source.end(et)}}}_createSource(){const $=pushableV({objectMode:!0,onEnd:j=>{this.close(j)}});return Object.assign(encode$1($,this._init.minSendBytes),{push:$.push,end:$.end,return:$.return})}async _handleIncoming(o){const{id:$,type:j}=o;if(log$3.enabled&&log$3.trace("incoming message",printMessage(o)),o.type===MessageTypes.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION)){log$3("too many inbound streams open"),this._source.push({id:$,type:MessageTypes.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{log$3("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),this._source.end(new Error("Too many open streams"));return}return}const nt=this._newReceiverStream({id:$,name:toString$a(o.data instanceof Uint8Array?o.data:o.data.subarray())});this._init.onIncomingStream!=null&&this._init.onIncomingStream(nt);return}const tt=((j&1)===1?this._streams.initiators:this._streams.receivers).get($);if(tt==null){log$3("missing stream %s for message type %s",$,MessageTypeNames[j]);return}const rt=this._init.maxStreamBufferSize??MAX_STREAM_BUFFER_SIZE;switch(j){case MessageTypes.MESSAGE_INITIATOR:case MessageTypes.MESSAGE_RECEIVER:if(tt.sourceReadableLength()>rt){this._source.push({id:o.id,type:j===MessageTypes.MESSAGE_INITIATOR?MessageTypes.RESET_RECEIVER:MessageTypes.RESET_INITIATOR});const nt=errCode(new Error("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");tt.abort(nt);return}tt.sourcePush(o.data);break;case MessageTypes.CLOSE_INITIATOR:case MessageTypes.CLOSE_RECEIVER:tt.closeRead();break;case MessageTypes.RESET_INITIATOR:case MessageTypes.RESET_RECEIVER:tt.reset();break;default:log$3("unknown message type %s",j)}}}class Mplex{constructor(o={}){this.protocol="/mplex/6.7.0",this._init=o}createStreamMuxer(o={}){return new MplexStreamMuxer({...o,...this._init})}}function mplex(_={}){return()=>new Mplex(_)}function pbStream(_,o={}){const $=handshake(_),j=decode$3.fromReader($.reader,o),et={read:async tt=>{const{value:rt}=await $.reader.next(tt);if(rt==null)throw new Error("Value is null");return rt},readLP:async()=>{const{value:tt}=await j.next();if(tt==null)throw new Error("Value is null");return tt},readPB:async tt=>{const rt=await et.readLP();if(rt==null)throw new Error("Value is null");const nt=rt instanceof Uint8Array?rt:rt.subarray();return tt.decode(nt)},write:tt=>{tt instanceof Uint8Array?$.writer.push(tt):$.writer.push(tt.subarray())},writeLP:tt=>{et.write(encode$5.single(tt,o))},writePB:(tt,rt)=>{et.writeLP(rt.encode(tt))},pb:tt=>({read:async()=>await et.readPB(tt),write:rt=>{et.writePB(rt,tt)}}),unwrap:()=>($.rest(),$.stream)};return et}function pair(){const _=pDefer$1();let o=!1;return{sink:async $=>{if(o)throw new Error("already piped");o=!0,_.resolve($)},source:async function*(){yield*await _.promise}()}}function duplexPair(){const _=pair(),o=pair();return[{source:_.source,sink:o.sink},{source:o.source,sink:_.sink}]}const NOISE_MSG_MAX_LENGTH_BYTES=65535,NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=NOISE_MSG_MAX_LENGTH_BYTES-16;var Ro,Io;const DUMP_SESSION_KEYS=!!((Io=(Ro=globalThis.process)==null?void 0:Ro.env)!=null&&Io.DUMP_SESSION_KEYS);var hkdf={},hmac$1={},hash={};Object.defineProperty(hash,"__esModule",{value:!0});function isSerializableHash(_){return typeof _.saveState<"u"&&typeof _.restoreState<"u"&&typeof _.cleanSavedState<"u"}hash.isSerializableHash=isSerializableHash;Object.defineProperty(hmac$1,"__esModule",{value:!0});var hash_1=hash,constant_time_1=constantTime,wipe_1$1=wipe$1,HMAC=function(){function _(o,$){this._finished=!1,this._inner=new o,this._outer=new o,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var j=new Uint8Array(this.blockSize);$.length>this.blockSize?this._inner.update($).finish(j).clean():j.set($);for(var et=0;et<j.length;et++)j[et]^=54;this._inner.update(j);for(var et=0;et<j.length;et++)j[et]^=106;this._outer.update(j),hash_1.isSerializableHash(this._inner)&&hash_1.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),wipe_1$1.wipe(j)}return _.prototype.reset=function(){if(!hash_1.isSerializableHash(this._inner)||!hash_1.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},_.prototype.clean=function(){hash_1.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),hash_1.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},_.prototype.update=function(o){return this._inner.update(o),this},_.prototype.finish=function(o){return this._finished?(this._outer.finish(o),this):(this._inner.finish(o),this._outer.update(o.subarray(0,this.digestLength)).finish(o),this._finished=!0,this)},_.prototype.digest=function(){var o=new Uint8Array(this.digestLength);return this.finish(o),o},_.prototype.saveState=function(){if(!hash_1.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},_.prototype.restoreState=function(o){if(!hash_1.isSerializableHash(this._inner)||!hash_1.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(o),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},_.prototype.cleanSavedState=function(o){if(!hash_1.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(o)},_}();hmac$1.HMAC=HMAC;function hmac(_,o,$){var j=new HMAC(_,o);j.update($);var et=j.digest();return j.clean(),et}hmac$1.hmac=hmac;hmac$1.equal=constant_time_1.equal;Object.defineProperty(hkdf,"__esModule",{value:!0});var hmac_1=hmac$1,wipe_1=wipe$1,HKDF=function(){function _(o,$,j,et){j===void 0&&(j=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=o,this._info=et;var tt=hmac_1.hmac(this._hash,j,$);this._hmac=new hmac_1.HMAC(o,tt),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return _.prototype._fillBuffer=function(){this._counter[0]++;var o=this._counter[0];if(o===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),o>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},_.prototype.expand=function(o){for(var $=new Uint8Array(o),j=0;j<$.length;j++)this._bufpos===this._buffer.length&&this._fillBuffer(),$[j]=this._buffer[this._bufpos++];return $},_.prototype.clean=function(){this._hmac.clean(),wipe_1.wipe(this._buffer),wipe_1.wipe(this._counter),this._bufpos=0},_}(),HKDF_1=hkdf.HKDF=HKDF;const stablelib={hashSHA256(_){return sha256$4.hash(_)},getHKDF(_,o){const et=new HKDF_1(sha256$4.SHA256,o,_).expand(96),tt=et.subarray(0,32),rt=et.subarray(32,64),nt=et.subarray(64,96);return[tt,rt,nt]},generateX25519KeyPair(){const _=x25519.generateKeyPair();return{publicKey:_.publicKey,privateKey:_.secretKey}},generateX25519KeyPairFromSeed(_){const o=x25519.generateKeyPairFromSeed(_);return{publicKey:o.publicKey,privateKey:o.secretKey}},generateX25519SharedKey(_,o){return x25519.sharedKey(_,o)},chaCha20Poly1305Encrypt(_,o,$,j){return new chacha20poly1305.ChaCha20Poly1305(j).seal(o,_,$)},chaCha20Poly1305Decrypt(_,o,$,j,et){return new chacha20poly1305.ChaCha20Poly1305(j).open(o,_,$,et)}},allocUnsafe=_=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(_):new Uint8Array(_),uint16BEEncode=_=>{const o=allocUnsafe(2);return new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,_,!1),o};uint16BEEncode.bytes=2;const uint16BEDecode=_=>{if(_.length<2)throw RangeError("Could not decode int16BE");return _ instanceof Uint8Array?new DataView(_.buffer,_.byteOffset,_.byteLength).getUint16(0,!1):_.getUint16(0)};uint16BEDecode.bytes=2;function encode0(_){return concat$2([_.ne,_.ciphertext],_.ne.length+_.ciphertext.length)}function encode1(_){return concat$2([_.ne,_.ns,_.ciphertext],_.ne.length+_.ns.length+_.ciphertext.length)}function encode2(_){return concat$2([_.ns,_.ciphertext],_.ns.length+_.ciphertext.length)}function decode0(_){if(_.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:_.subarray(0,32),ciphertext:_.subarray(32,_.length),ns:new Uint8Array(0)}}function decode1(_){if(_.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:_.subarray(0,32),ns:_.subarray(32,80),ciphertext:_.subarray(80,_.length)}}function decode2(_){if(_.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:_.subarray(0,48),ciphertext:_.subarray(48,_.length)}}function encryptStream(_,o){return async function*($){for await(const j of $)for(let et=0;et<j.length;et+=NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let tt=et+NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;tt>j.length&&(tt=j.length);const rt=_.encrypt(j.subarray(et,tt),_.session);o==null||o.encryptedPackets.increment(),yield uint16BEEncode(rt.byteLength),yield rt}}}function decryptStream(_,o){return async function*($){for await(const j of $)for(let et=0;et<j.length;et+=NOISE_MSG_MAX_LENGTH_BYTES){let tt=et+NOISE_MSG_MAX_LENGTH_BYTES;if(tt>j.length&&(tt=j.length),tt-chacha20poly1305.TAG_LENGTH<et)throw new Error("Invalid chunk");const rt=j.subarray(et,tt),nt=j.subarray(et,tt-chacha20poly1305.TAG_LENGTH),{plaintext:it,valid:st}=_.decrypt(rt,_.session,nt);if(!st)throw o==null||o.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");o==null||o.decryptedPackets.increment(),yield it}}}class UnexpectedPeerError extends Error{constructor(o="Unexpected Peer"){super(o),this.code=UnexpectedPeerError.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class InvalidCryptoExchangeError extends Error{constructor(o="Invalid crypto exchange"){super(o),this.code=InvalidCryptoExchangeError.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}function configure(){util$4._configure(),reader$6._configure(reader_buffer$1),writer$5._configure(writer_buffer$1)}configure();const methods=["uint64","int64","sint64","fixed64","sfixed64"];function patchReader(_){for(const o of methods){if(_[o]==null)continue;const $=_[o];_[o]=function(){return BigInt($.call(this).toString())}}return _}function reader(_){return patchReader(new reader$6(_))}function patchWriter(_){for(const o of methods){if(_[o]==null)continue;const $=_[o];_[o]=function(j){return $.call(this,j.toString())}}return _}function writer(){return patchWriter(writer$5.create())}function decodeMessage(_,o){const $=reader(_ instanceof Uint8Array?_:_.subarray());return o.decode($)}function encodeMessage(_,o){const $=writer();return o.encode(_,$,{lengthDelimited:!1}),$.finish()}var CODEC_TYPES;(function(_){_[_.VARINT=0]="VARINT",_[_.BIT64=1]="BIT64",_[_.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",_[_.START_GROUP=3]="START_GROUP",_[_.END_GROUP=4]="END_GROUP",_[_.BIT32=5]="BIT32"})(CODEC_TYPES||(CODEC_TYPES={}));function createCodec(_,o,$,j){return{name:_,type:o,encode:$,decode:j}}function message(_,o){return createCodec("message",CODEC_TYPES.LENGTH_DELIMITED,_,o)}var NoiseExtensions;(function(_){let o;_.codec=()=>(o==null&&(o=message(($,j,et={})=>{if(et.lengthDelimited!==!1&&j.fork(),$.webtransportCerthashes!=null)for(const tt of $.webtransportCerthashes)j.uint32(10),j.bytes(tt);et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={webtransportCerthashes:[]},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.webtransportCerthashes.push($.bytes());break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(NoiseExtensions||(NoiseExtensions={}));var NoiseHandshakePayload;(function(_){let o;_.codec=()=>(o==null&&(o=message(($,j,et={})=>{et.lengthDelimited!==!1&&j.fork(),(et.writeDefaults===!0||$.identityKey!=null&&$.identityKey.byteLength>0)&&(j.uint32(10),j.bytes($.identityKey)),(et.writeDefaults===!0||$.identitySig!=null&&$.identitySig.byteLength>0)&&(j.uint32(18),j.bytes($.identitySig)),$.extensions!=null&&(j.uint32(34),NoiseExtensions.codec().encode($.extensions,j,{writeDefaults:!1})),et.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const et={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},tt=j==null?$.len:$.pos+j;for(;$.pos<tt;){const rt=$.uint32();switch(rt>>>3){case 1:et.identityKey=$.bytes();break;case 2:et.identitySig=$.bytes();break;case 4:et.extensions=NoiseExtensions.codec().decode($,$.uint32());break;default:$.skipType(rt&7);break}}return et})),o),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(NoiseHandshakePayload||(NoiseHandshakePayload={}));async function getPayload(_,o,$){const j=await signPayload(_,getHandshakePayload(o));if(_.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return createHandshakePayload(_.publicKey,j,$)}function createHandshakePayload(_,o,$){return NoiseHandshakePayload.encode({identityKey:_,identitySig:o,extensions:$??{webtransportCerthashes:[]}}).subarray()}async function signPayload(_,o){if(_.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return await(await unmarshalPrivateKey(_.privateKey)).sign(o)}async function getPeerIdFromPayload(_){return await peerIdFromKeys(_.identityKey)}function decodePayload(_){return NoiseHandshakePayload.decode(_)}function getHandshakePayload(_){const o=fromString$8("noise-libp2p-static-key:");return concat$2([o,_],o.length+_.length)}async function verifySignedPayload(_,o,$){const j=await peerIdFromKeys(o.identityKey);if(!j.equals($))throw new Error(`Payload identity key ${j.toString()} does not match expected remote peer ${$.toString()}`);const et=getHandshakePayload(_);if(j.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(o.identitySig==null)throw new Error("Signature was missing from message");if(!await unmarshalPublicKey(j.publicKey).verify(et,o.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return j}function isValidPublicKey(_){return!(!(_ instanceof Uint8Array)||_.length!==32)}const log$2=logger$1("libp2p:noise");let keyLogger;DUMP_SESSION_KEYS?keyLogger=log$2:keyLogger=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function logLocalStaticKeys(_){keyLogger(`LOCAL_STATIC_PUBLIC_KEY ${toString$a(_.publicKey,"hex")}`),keyLogger(`LOCAL_STATIC_PRIVATE_KEY ${toString$a(_.privateKey,"hex")}`)}function logLocalEphemeralKeys(_){_?(keyLogger(`LOCAL_PUBLIC_EPHEMERAL_KEY ${toString$a(_.publicKey,"hex")}`),keyLogger(`LOCAL_PRIVATE_EPHEMERAL_KEY ${toString$a(_.privateKey,"hex")}`)):keyLogger("Missing local ephemeral keys.")}function logRemoteStaticKey(_){keyLogger(`REMOTE_STATIC_PUBLIC_KEY ${toString$a(_,"hex")}`)}function logRemoteEphemeralKey(_){keyLogger(`REMOTE_EPHEMERAL_PUBLIC_KEY ${toString$a(_,"hex")}`)}function logCipherState(_){_.cs1&&_.cs2?(keyLogger(`CIPHER_STATE_1 ${_.cs1.n.getUint64()} ${toString$a(_.cs1.k,"hex")}`),keyLogger(`CIPHER_STATE_2 ${_.cs2.n.getUint64()} ${toString$a(_.cs2.k,"hex")}`)):keyLogger("Missing cipher state.")}const MIN_NONCE=0,MAX_NONCE=4294967295,ERR_MAX_NONCE="Cipherstate has reached maximum n, a new handshake must be performed";class Nonce{constructor(o=MIN_NONCE){this.n=o,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,o,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>MAX_NONCE)throw new Error(ERR_MAX_NONCE)}}class AbstractHandshake{constructor(o){this.crypto=o}encryptWithAd(o,$,j){const et=this.encrypt(o.k,o.n,$,j);return o.n.increment(),et}decryptWithAd(o,$,j,et){const{plaintext:tt,valid:rt}=this.decrypt(o.k,o.n,$,j,et);return rt&&o.n.increment(),{plaintext:tt,valid:rt}}hasKey(o){return!this.isEmptyKey(o.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(o){const $=this.createEmptyKey();return equals$6($,o)}encrypt(o,$,j,et){return $.assertValue(),this.crypto.chaCha20Poly1305Encrypt(et,$.getBytes(),j,o)}encryptAndHash(o,$){let j;return this.hasKey(o.cs)?j=this.encryptWithAd(o.cs,o.h,$):j=$,this.mixHash(o,j),j}decrypt(o,$,j,et,tt){$.assertValue();const rt=this.crypto.chaCha20Poly1305Decrypt(et,$.getBytes(),j,o,tt);return rt?{plaintext:rt,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(o,$){let j,et=!0;return this.hasKey(o.cs)?{plaintext:j,valid:et}=this.decryptWithAd(o.cs,o.h,$):j=$,this.mixHash(o,$),{plaintext:j,valid:et}}dh(o,$){try{const j=this.crypto.generateX25519SharedKey(o,$);return j.length===32?j:j.subarray(0,32)}catch(j){return log$2(j.message),new Uint8Array(32)}}mixHash(o,$){o.h=this.getHash(o.h,$)}getHash(o,$){return this.crypto.hashSHA256(concat$2([o,$],o.length+$.length))}mixKey(o,$){const[j,et]=this.crypto.getHKDF(o.ck,$);o.cs=this.initializeKey(et),o.ck=j}initializeKey(o){return{k:o,n:new Nonce}}initializeSymmetric(o){const $=fromString$8(o,"utf-8"),j=this.hashProtocolName($),et=j,tt=this.createEmptyKey();return{cs:this.initializeKey(tt),ck:et,h:j}}hashProtocolName(o){if(o.length<=32){const $=new Uint8Array(32);return $.set(o),$}else return this.getHash(o,new Uint8Array(0))}split(o){const[$,j]=this.crypto.getHKDF(o.ck,new Uint8Array(0)),et=this.initializeKey($),tt=this.initializeKey(j);return{cs1:et,cs2:tt}}writeMessageRegular(o,$){const j=this.encryptWithAd(o,new Uint8Array(0),$),et=this.createEmptyKey(),tt=new Uint8Array(0);return{ne:et,ns:tt,ciphertext:j}}readMessageRegular(o,$){return this.decryptWithAd(o,new Uint8Array(0),$.ciphertext)}}class XX extends AbstractHandshake{initializeInitiator(o,$,j,et){const tt="Noise_XX_25519_ChaChaPoly_SHA256",rt=this.initializeSymmetric(tt);this.mixHash(rt,o);const nt=new Uint8Array(32);return{ss:rt,s:$,rs:j,psk:et,re:nt}}initializeResponder(o,$,j,et){const tt="Noise_XX_25519_ChaChaPoly_SHA256",rt=this.initializeSymmetric(tt);this.mixHash(rt,o);const nt=new Uint8Array(32);return{ss:rt,s:$,rs:j,psk:et,re:nt}}writeMessageA(o,$,j){const et=new Uint8Array(0);j!==void 0?o.e=j:o.e=this.crypto.generateX25519KeyPair();const tt=o.e.publicKey;this.mixHash(o.ss,tt);const rt=this.encryptAndHash(o.ss,$);return{ne:tt,ns:et,ciphertext:rt}}writeMessageB(o,$){o.e=this.crypto.generateX25519KeyPair();const j=o.e.publicKey;this.mixHash(o.ss,j),this.mixKey(o.ss,this.dh(o.e.privateKey,o.re));const et=o.s.publicKey,tt=this.encryptAndHash(o.ss,et);this.mixKey(o.ss,this.dh(o.s.privateKey,o.re));const rt=this.encryptAndHash(o.ss,$);return{ne:j,ns:tt,ciphertext:rt}}writeMessageC(o,$){const j=o.s.publicKey,et=this.encryptAndHash(o.ss,j);this.mixKey(o.ss,this.dh(o.s.privateKey,o.re));const tt=this.encryptAndHash(o.ss,$),nt={ne:this.createEmptyKey(),ns:et,ciphertext:tt},{cs1:it,cs2:st}=this.split(o.ss);return{h:o.ss.h,messageBuffer:nt,cs1:it,cs2:st}}readMessageA(o,$){return isValidPublicKey($.ne)&&(o.re=$.ne),this.mixHash(o.ss,o.re),this.decryptAndHash(o.ss,$.ciphertext)}readMessageB(o,$){if(isValidPublicKey($.ne)&&(o.re=$.ne),this.mixHash(o.ss,o.re),!o.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(o.ss,this.dh(o.e.privateKey,o.re));const{plaintext:j,valid:et}=this.decryptAndHash(o.ss,$.ns);et&&isValidPublicKey(j)&&(o.rs=j),this.mixKey(o.ss,this.dh(o.e.privateKey,o.rs));const{plaintext:tt,valid:rt}=this.decryptAndHash(o.ss,$.ciphertext);return{plaintext:tt,valid:et&&rt}}readMessageC(o,$){const{plaintext:j,valid:et}=this.decryptAndHash(o.ss,$.ns);if(et&&isValidPublicKey(j)&&(o.rs=j),!o.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(o.ss,this.dh(o.e.privateKey,o.rs));const{plaintext:tt,valid:rt}=this.decryptAndHash(o.ss,$.ciphertext),{cs1:nt,cs2:it}=this.split(o.ss);return{h:o.ss.h,plaintext:tt,valid:et&&rt,cs1:nt,cs2:it}}initSession(o,$,j){const et=this.createEmptyKey(),tt=new Uint8Array(32);let rt;return o?rt=this.initializeInitiator($,j,tt,et):rt=this.initializeResponder($,j,tt,et),{hs:rt,i:o,mc:0}}sendMessage(o,$,j){let et;if(o.mc===0)et=this.writeMessageA(o.hs,$,j);else if(o.mc===1)et=this.writeMessageB(o.hs,$);else if(o.mc===2){const{h:tt,messageBuffer:rt,cs1:nt,cs2:it}=this.writeMessageC(o.hs,$);et=rt,o.h=tt,o.cs1=nt,o.cs2=it}else if(o.mc>2)if(o.i){if(!o.cs1)throw new Error("CS1 (cipher state) is not defined");et=this.writeMessageRegular(o.cs1,$)}else{if(!o.cs2)throw new Error("CS2 (cipher state) is not defined");et=this.writeMessageRegular(o.cs2,$)}else throw new Error("Session invalid.");return o.mc++,et}recvMessage(o,$){let j=new Uint8Array(0),et=!1;if(o.mc===0)({plaintext:j,valid:et}=this.readMessageA(o.hs,$));else if(o.mc===1)({plaintext:j,valid:et}=this.readMessageB(o.hs,$));else if(o.mc===2){const{h:tt,plaintext:rt,valid:nt,cs1:it,cs2:st}=this.readMessageC(o.hs,$);j=rt,et=nt,o.h=tt,o.cs1=it,o.cs2=st}return o.mc++,{plaintext:j,valid:et}}}class XXHandshake{constructor(o,$,j,et,tt,rt,nt,it){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=o,this.payload=$,this.prologue=j,this.staticKeypair=tt,this.connection=rt,nt&&(this.remotePeer=nt),this.xx=it??new XX(et),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(logLocalStaticKeys(this.session.hs.s),this.isInitiator){log$2("Stage 0 - Initiator starting to send first message.");const o=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(encode0(o)),log$2("Stage 0 - Initiator finished sending first message."),logLocalEphemeralKeys(this.session.hs.e)}else{log$2("Stage 0 - Responder waiting to receive first message...");const o=decode0((await this.connection.readLP()).subarray()),{valid:$}=this.xx.recvMessage(this.session,o);if(!$)throw new InvalidCryptoExchangeError("xx handshake stage 0 validation fail");log$2("Stage 0 - Responder received first message."),logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){log$2("Stage 1 - Initiator waiting to receive first message from responder...");const o=decode1((await this.connection.readLP()).subarray()),{plaintext:$,valid:j}=this.xx.recvMessage(this.session,o);if(!j)throw new InvalidCryptoExchangeError("xx handshake stage 1 validation fail");log$2("Stage 1 - Initiator received the message."),logRemoteEphemeralKey(this.session.hs.re),logRemoteStaticKey(this.session.hs.rs),log$2("Initiator going to check remote's signature...");try{const et=decodePayload($);this.remotePeer=this.remotePeer||await getPeerIdFromPayload(et),await verifySignedPayload(this.session.hs.rs,et,this.remotePeer),this.setRemoteNoiseExtension(et.extensions)}catch(et){const tt=et;throw new UnexpectedPeerError(`Error occurred while verifying signed payload: ${tt.message}`)}log$2("All good with the signature!")}else{log$2("Stage 1 - Responder sending out first message with signed payload and static key.");const o=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(encode1(o)),log$2("Stage 1 - Responder sent the second handshake message with signed payload."),logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){log$2("Stage 2 - Initiator sending third handshake message.");const o=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(encode2(o)),log$2("Stage 2 - Initiator sent message with signed payload.")}else{log$2("Stage 2 - Responder waiting for third handshake message...");const o=decode2((await this.connection.readLP()).subarray()),{plaintext:$,valid:j}=this.xx.recvMessage(this.session,o);if(!j)throw new InvalidCryptoExchangeError("xx handshake stage 2 validation fail");log$2("Stage 2 - Responder received the message, finished handshake.");try{const et=decodePayload($);this.remotePeer=this.remotePeer||await getPeerIdFromPayload(et),await verifySignedPayload(this.session.hs.rs,et,this.remotePeer),this.setRemoteNoiseExtension(et.extensions)}catch(et){const tt=et;throw new UnexpectedPeerError(`Error occurred while verifying signed payload: ${tt.message}`)}}logCipherState(this.session)}encrypt(o,$){const j=this.getCS($);return this.xx.encryptWithAd(j,new Uint8Array(0),o)}decrypt(o,$,j){const et=this.getCS($,!1);return this.xx.decryptWithAd(et,new Uint8Array(0),o,j)}getRemoteStaticKey(){return this.session.hs.rs}getCS(o,$=!0){if(!o.cs1||!o.cs2)throw new InvalidCryptoExchangeError("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?$?o.cs1:o.cs2:$?o.cs2:o.cs1}setRemoteNoiseExtension(o){o&&(this.remoteExtensions=o)}}function registerMetrics(_){return{xxHandshakeSuccesses:_.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:_.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:_.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:_.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:_.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}class Noise{constructor(o={}){this.protocol="/noise";const{staticNoiseKey:$,extensions:j,crypto:et,prologueBytes:tt,metrics:rt}=o;this.crypto=et??stablelib,this.extensions=j,this.metrics=rt?registerMetrics(rt):void 0,$?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed($):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=tt??new Uint8Array(0)}async secureOutbound(o,$,j){const et=pbStream($,{lengthEncoder:uint16BEEncode,lengthDecoder:uint16BEDecode,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES}),tt=await this.performHandshake({connection:et,isInitiator:!0,localPeer:o,remotePeer:j});return{conn:await this.createSecureConnection(et,tt),remoteExtensions:tt.remoteExtensions,remotePeer:tt.remotePeer}}async secureInbound(o,$,j){const et=pbStream($,{lengthEncoder:uint16BEEncode,lengthDecoder:uint16BEDecode,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES}),tt=await this.performHandshake({connection:et,isInitiator:!1,localPeer:o,remotePeer:j});return{conn:await this.createSecureConnection(et,tt),remotePeer:tt.remotePeer,remoteExtensions:tt.remoteExtensions}}async performHandshake(o){const $=await getPayload(o.localPeer,this.staticKeys.publicKey,this.extensions);return await this.performXXHandshake(o,$)}async performXXHandshake(o,$){var nt,it;const{isInitiator:j,remotePeer:et,connection:tt}=o,rt=new XXHandshake(j,$,this.prologue,this.crypto,this.staticKeys,tt,et);try{await rt.propose(),await rt.exchange(),await rt.finish(),(nt=this.metrics)==null||nt.xxHandshakeSuccesses.increment()}catch(st){if((it=this.metrics)==null||it.xxHandshakeErrors.increment(),st instanceof Error)throw st.message=`Error occurred during XX handshake: ${st.message}`,st}return rt}async createSecureConnection(o,$){const[j,et]=duplexPair(),tt=o.unwrap();return await pipe(j,encryptStream($,this.metrics),tt,decode$3({lengthDecoder:uint16BEDecode}),decryptStream($,this.metrics),j),et}}function noise(_={}){return()=>new Noise(_)}const mergeOptions$2=mergeOptions$g.bind({ignoreUndefined:!0,concatArrays:!0});function createLibp2p({options:_={},peerId:o,multiaddrs:$=[],repo:j,keychainConfig:et={},config:tt={}}){const{datastore:rt}=j,nt=getLibp2pOptions({options:_,config:tt,datastore:rt,keychainConfig:et,peerId:o,multiaddrs:$});return typeof _.libp2p=="function"?_.libp2p({libp2pOptions:nt,options:_,config:tt,datastore:rt,peerId:o}):(nt.start=!1,createLibp2p$1(nt))}function getLibp2pOptions({options:_,config:o,datastore:$,keychainConfig:j,peerId:et,multiaddrs:tt}){var ut,ft,ht,mt;const rt=()=>{const gt=get$1(o,"Pubsub.Router")||"gossipsub",Et=routers();if(!Et[gt])throw errCode(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${gt} router.`),"ERR_NOT_SUPPORTED");return Et[gt]},nt={datastore:$,peerId:et},it={addresses:{listen:tt.map(gt=>gt.toString()),announce:get$1(_,"addresses.announce",get$1(o,"Addresses.Announce",[])),noAnnounce:get$1(_,"addresses.noAnnounce",get$1(o,"Addresses.NoAnnounce",[]))},connectionManager:get$1(_,"connectionManager",{maxConnections:get$1(_,"config.Swarm.ConnMgr.HighWater",get$1(o,"Swarm.ConnMgr.HighWater")),minConnections:get$1(_,"config.Swarm.ConnMgr.LowWater",get$1(o,"Swarm.ConnMgr.LowWater"))}),keychain:j,identify:{host:{agentVersion:`js-ipfs/${ipfsCore}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[mplex({maxInboundStreams:256,maxOutboundStreams:1024})],connectionEncryption:[noise()],relay:{enabled:get$1(_,"relay.enabled",get$1(o,"relay.enabled",!0)),hop:{enabled:get$1(_,"relay.hop.enabled",get$1(o,"relay.hop.enabled",!1)),active:get$1(_,"relay.hop.active",get$1(o,"relay.hop.active",!1))}},nat:{enabled:!get$1(o,"Swarm.DisableNatPortMap",!1)}};get$1(_,"config.Pubsub.Enabled",get$1(o,"Pubsub.Enabled",!0))&&(it.pubsub=rt()),get$1(o,"Routing.Type","dhtclient")!=="none"&&(it.dht=kadDHT({clientMode:get$1(o,"Routing.Type","dht")!=="dhtserver",kBucketSize:get$1(_,"dht.kBucketSize",20),validators:{ipns:ipnsValidator},selectors:{ipns:ipnsSelector}}));const st=get$1(_,"config.Bootstrap",get$1(o,"Bootstrap",[]));st.length>0&&((ut=it.peerDiscovery)==null||ut.push(bootstrap({list:st})));let ot=get$1(_,"libp2p",void 0);typeof ot=="function"&&(ot=void 0);const at=mergeOptions$2(nt,libp2pConfig(),it,ot),ct=get$1(_,"config.Addresses.Delegates",get$1(o,"Addresses.Delegates",[]));if(ct.length>0){const gt=ct[Math.floor(Math.random()*ct.length)],Et=multiaddr$3(gt).toOptions(),St={host:Et.host,protocol:parseInt(Et.port)===443?"https":"http",port:Et.port},At=create$2(St);(ft=at.contentRouters)==null||ft.push(delegatedContentRouting(At)),(ht=at.peerRouters)==null||ht.push(delegatedPeerRouting(At))}return get$1(_,"config.Discovery.MDNS.Enabled",get$1(o,"Discovery.MDNS.Enabled",!0))||(at.peerDiscovery=(mt=at.peerDiscovery)==null?void 0:mt.filter(gt=>{try{if(typeof gt=="function")return gt({})[Symbol.toStringTag]!=="@libp2p/mdns"}catch{}return!0})),at.transports==null&&(at.transports=[]),at.transports.find(gt=>{try{if(typeof gt=="function")return gt({})[Symbol.toStringTag]==="@libp2p/websockets"}catch{}return!1})==null&&at.transports.push(webSockets()),at}const mergeOptions$1=mergeOptions$g.bind({ignoreUndefined:!0}),log$1=logger$1("ipfs:components:peer:storage");class Storage{constructor(o,$,j,et,tt){this.print=et,this.peerId=o,this.keychain=$,this.repo=j,this.print=et,this.isNew=tt}static async start(o,$,j){const{repoAutoMigrate:et,repo:tt,onMigrationProgress:rt}=j,nt=typeof tt=="string"||tt==null?createRepo$1(o,$,{path:tt,autoMigrate:et,onMigrationProgress:rt}):tt,{peerId:it,keychain:st,isNew:ot}=await loadRepo(o,nt,j);return new Storage(it,st,nt,o,ot)}}const loadRepo=async(_,o,$)=>{if(!o.closed)return{...await configureRepo(o,$),isNew:!1};try{return await o.open(),{...await configureRepo(o,$),isNew:!1}}catch(j){if(j.code!==ERR_REPO_NOT_INITIALIZED)throw j;if($.init&&$.init.allowNew===!1)throw new NotEnabledError("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await initRepo(_,o,$),isNew:!0}}},initRepo=async(_,o,$)=>{const j=$.init||{},et=await o.exists();if(log$1("repo exists?",et),et===!0)throw new Error("repo already exists");const tt=j.privateKey?await decodePeerId(j.privateKey):await initPeerId(_,j),rt=peerIdToIdentity(tt);log$1("peer identity: %s",rt.PeerID);const nt={...mergeOptions$1(applyProfiles(getDefaultConfig(),j.profiles),$.config),Identity:rt};await o.init(nt),await o.open(),log$1("repo opened");const it={pass:$.pass};try{it.dek=await o.config.get("Keychain.DEK")}catch(ot){if(ot.code!=="ERR_NOT_FOUND")throw ot}const st=await createLibp2p({options:void 0,multiaddrs:void 0,peerId:tt,repo:o,config:nt,keychainConfig:it});return await o.datastore.has(new Key("/info/self"))||await st.keychain.importPeer("self",tt),await o.config.set("Keychain",{DEK:st.keychain.init.dek}),{peerId:tt,keychain:st.keychain}},decodePeerId=async _=>{if(log$1("using user-supplied private-key"),isPeerId(_))return _;const o=fromString$8(_,"base64pad"),$=await unmarshalPrivateKey(o);return await peerIdFromKeys($.public.bytes,$.bytes)},initPeerId=(_,{algorithm:o="Ed25519",bits:$=2048})=>{if(_("generating %s keypair...",o),o==="Ed25519")return createEd25519PeerId();if(o==="RSA")return createRSAPeerId({bits:$});throw errCode(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},peerIdToIdentity=_=>{if(_.privateKey==null)throw errCode(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:_.toString(),PrivKey:toString$a(_.privateKey,"base64pad")}},configureRepo=async(_,o)=>{const $=o.config,j=o.init&&o.init.profiles||[],et=o.pass,tt=await _.config.getAll(),rt=mergeConfigs(applyProfiles(tt,j),$);if(tt!==rt&&await _.config.replace(rt),!rt.Identity||!rt.Identity.PrivKey)throw new NotInitializedError("No private key was found in the config, please intialize the repo");const nt=fromString$8(rt.Identity.PrivKey,"base64pad"),it=await unmarshalPrivateKey(nt),st=await peerIdFromKeys(it.public.bytes,it.bytes),ot=await createLibp2p({options:void 0,multiaddrs:void 0,peerId:st,repo:_,config:rt,keychainConfig:{pass:et,...rt.Keychain}});return{peerId:st,keychain:ot.keychain}},mergeConfigs=(_,o)=>o?mergeOptions$1(_,o):_,applyProfiles=(_,o)=>(o||[]).reduce(($,j)=>{const et=profiles[j];if(!et)throw new Error(`Could not find profile with name '${j}'`);return log$1("applying profile %s",j),et.transform($)},_);var encode_1=encode,MSB$1=128,REST$1=127,MSBALL=~REST$1,INT=Math.pow(2,31);function encode(_,o,$){o=o||[],$=$||0;for(var j=$;_>=INT;)o[$++]=_&255|MSB$1,_/=128;for(;_&MSBALL;)o[$++]=_&255|MSB$1,_>>>=7;return o[$]=_|0,encode.bytes=$-j+1,o}var decode=read,MSB=128,REST=127;function read(_,j){var $=0,j=j||0,et=0,tt=j,rt,nt=_.length;do{if(tt>=nt)throw read.bytes=0,new RangeError("Could not decode varint");rt=_[tt++],$+=et<28?(rt&REST)<<et:(rt&REST)*Math.pow(2,et),et+=7}while(rt>=MSB);return read.bytes=tt-j,$}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(_){return _<N1?1:_<N2?2:_<N3?3:_<N4?4:_<N5?5:_<N6?6:_<N7?7:_<N8?8:_<N9?9:10},varint$1={encode:encode_1,decode,encodingLength:length};const varint=varint$1;var src=_=>{if(!(_ instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const o=[];for(;_.length>0;){const $=varint.decode(_);o.push($),_=_.slice(varint.decode.bytes)}return o};function varintEncoder(_){let o=new Uint8Array(_.reduce((j,et)=>j+varint$2.encodingLength(et),0)),$=0;for(const j of _)o=varint$2.encode(j,o,$),$+=varint$2.encodingLength(j);return o}class WantListEntry{constructor(o,$,j){this._refCounter=1,this.cid=o,this.priority=$||1,this.wantType=j}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(base58btc$4)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(o){return this._refCounter===o._refCounter&&this.cid.equals(o.cid)&&this.priority===o.priority&&this.wantType===o.wantType}}const $Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots["ipfs-bitswap"]||($protobuf.roots["ipfs-bitswap"]={}),Message=$root.Message=(()=>{function _(o){if(this.blocks=[],this.payload=[],this.blockPresences=[],o)for(var $=Object.keys(o),j=0;j<$.length;++j)o[$[j]]!=null&&(this[$[j]]=o[$[j]])}return _.prototype.wantlist=null,_.prototype.blocks=$util.emptyArray,_.prototype.payload=$util.emptyArray,_.prototype.blockPresences=$util.emptyArray,_.prototype.pendingBytes=0,_.encode=function($,j){if(j||(j=$Writer.create()),$.wantlist!=null&&Object.hasOwnProperty.call($,"wantlist")&&$root.Message.Wantlist.encode($.wantlist,j.uint32(10).fork()).ldelim(),$.blocks!=null&&$.blocks.length)for(var et=0;et<$.blocks.length;++et)j.uint32(18).bytes($.blocks[et]);if($.payload!=null&&$.payload.length)for(var et=0;et<$.payload.length;++et)$root.Message.Block.encode($.payload[et],j.uint32(26).fork()).ldelim();if($.blockPresences!=null&&$.blockPresences.length)for(var et=0;et<$.blockPresences.length;++et)$root.Message.BlockPresence.encode($.blockPresences[et],j.uint32(34).fork()).ldelim();return $.pendingBytes!=null&&Object.hasOwnProperty.call($,"pendingBytes")&&j.uint32(40).int32($.pendingBytes),j},_.decode=function($,j){$ instanceof $Reader||($=$Reader.create($));for(var et=j===void 0?$.len:$.pos+j,tt=new $root.Message;$.pos<et;){var rt=$.uint32();switch(rt>>>3){case 1:{tt.wantlist=$root.Message.Wantlist.decode($,$.uint32());break}case 2:{tt.blocks&&tt.blocks.length||(tt.blocks=[]),tt.blocks.push($.bytes());break}case 3:{tt.payload&&tt.payload.length||(tt.payload=[]),tt.payload.push($root.Message.Block.decode($,$.uint32()));break}case 4:{tt.blockPresences&&tt.blockPresences.length||(tt.blockPresences=[]),tt.blockPresences.push($root.Message.BlockPresence.decode($,$.uint32()));break}case 5:{tt.pendingBytes=$.int32();break}default:$.skipType(rt&7);break}}return tt},_.fromObject=function($){if($ instanceof $root.Message)return $;var j=new $root.Message;if($.wantlist!=null){if(typeof $.wantlist!="object")throw TypeError(".Message.wantlist: object expected");j.wantlist=$root.Message.Wantlist.fromObject($.wantlist)}if($.blocks){if(!Array.isArray($.blocks))throw TypeError(".Message.blocks: array expected");j.blocks=[];for(var et=0;et<$.blocks.length;++et)typeof $.blocks[et]=="string"?$util.base64.decode($.blocks[et],j.blocks[et]=$util.newBuffer($util.base64.length($.blocks[et])),0):$.blocks[et].length>=0&&(j.blocks[et]=$.blocks[et])}if($.payload){if(!Array.isArray($.payload))throw TypeError(".Message.payload: array expected");j.payload=[];for(var et=0;et<$.payload.length;++et){if(typeof $.payload[et]!="object")throw TypeError(".Message.payload: object expected");j.payload[et]=$root.Message.Block.fromObject($.payload[et])}}if($.blockPresences){if(!Array.isArray($.blockPresences))throw TypeError(".Message.blockPresences: array expected");j.blockPresences=[];for(var et=0;et<$.blockPresences.length;++et){if(typeof $.blockPresences[et]!="object")throw TypeError(".Message.blockPresences: object expected");j.blockPresences[et]=$root.Message.BlockPresence.fromObject($.blockPresences[et])}}return $.pendingBytes!=null&&(j.pendingBytes=$.pendingBytes|0),j},_.toObject=function($,j){j||(j={});var et={};if((j.arrays||j.defaults)&&(et.blocks=[],et.payload=[],et.blockPresences=[]),j.defaults&&(et.wantlist=null,et.pendingBytes=0),$.wantlist!=null&&$.hasOwnProperty("wantlist")&&(et.wantlist=$root.Message.Wantlist.toObject($.wantlist,j)),$.blocks&&$.blocks.length){et.blocks=[];for(var tt=0;tt<$.blocks.length;++tt)et.blocks[tt]=j.bytes===String?$util.base64.encode($.blocks[tt],0,$.blocks[tt].length):j.bytes===Array?Array.prototype.slice.call($.blocks[tt]):$.blocks[tt]}if($.payload&&$.payload.length){et.payload=[];for(var tt=0;tt<$.payload.length;++tt)et.payload[tt]=$root.Message.Block.toObject($.payload[tt],j)}if($.blockPresences&&$.blockPresences.length){et.blockPresences=[];for(var tt=0;tt<$.blockPresences.length;++tt)et.blockPresences[tt]=$root.Message.BlockPresence.toObject($.blockPresences[tt],j)}return $.pendingBytes!=null&&$.hasOwnProperty("pendingBytes")&&(et.pendingBytes=$.pendingBytes),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.getTypeUrl=function($){return $===void 0&&($="type.googleapis.com"),$+"/Message"},_.Wantlist=function(){function o($){if(this.entries=[],$)for(var j=Object.keys($),et=0;et<j.length;++et)$[j[et]]!=null&&(this[j[et]]=$[j[et]])}return o.prototype.entries=$util.emptyArray,o.prototype.full=!1,o.encode=function(j,et){if(et||(et=$Writer.create()),j.entries!=null&&j.entries.length)for(var tt=0;tt<j.entries.length;++tt)$root.Message.Wantlist.Entry.encode(j.entries[tt],et.uint32(10).fork()).ldelim();return j.full!=null&&Object.hasOwnProperty.call(j,"full")&&et.uint32(16).bool(j.full),et},o.decode=function(j,et){j instanceof $Reader||(j=$Reader.create(j));for(var tt=et===void 0?j.len:j.pos+et,rt=new $root.Message.Wantlist;j.pos<tt;){var nt=j.uint32();switch(nt>>>3){case 1:{rt.entries&&rt.entries.length||(rt.entries=[]),rt.entries.push($root.Message.Wantlist.Entry.decode(j,j.uint32()));break}case 2:{rt.full=j.bool();break}default:j.skipType(nt&7);break}}return rt},o.fromObject=function(j){if(j instanceof $root.Message.Wantlist)return j;var et=new $root.Message.Wantlist;if(j.entries){if(!Array.isArray(j.entries))throw TypeError(".Message.Wantlist.entries: array expected");et.entries=[];for(var tt=0;tt<j.entries.length;++tt){if(typeof j.entries[tt]!="object")throw TypeError(".Message.Wantlist.entries: object expected");et.entries[tt]=$root.Message.Wantlist.Entry.fromObject(j.entries[tt])}}return j.full!=null&&(et.full=!!j.full),et},o.toObject=function(j,et){et||(et={});var tt={};if((et.arrays||et.defaults)&&(tt.entries=[]),et.defaults&&(tt.full=!1),j.entries&&j.entries.length){tt.entries=[];for(var rt=0;rt<j.entries.length;++rt)tt.entries[rt]=$root.Message.Wantlist.Entry.toObject(j.entries[rt],et)}return j.full!=null&&j.hasOwnProperty("full")&&(tt.full=j.full),tt},o.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},o.getTypeUrl=function(j){return j===void 0&&(j="type.googleapis.com"),j+"/Message.Wantlist"},o.WantType=function(){const $={},j=Object.create($);return j[$[0]="Block"]=0,j[$[1]="Have"]=1,j}(),o.Entry=function(){function $(j){if(j)for(var et=Object.keys(j),tt=0;tt<et.length;++tt)j[et[tt]]!=null&&(this[et[tt]]=j[et[tt]])}return $.prototype.block=$util.newBuffer([]),$.prototype.priority=0,$.prototype.cancel=!1,$.prototype.wantType=0,$.prototype.sendDontHave=!1,$.encode=function(et,tt){return tt||(tt=$Writer.create()),et.block!=null&&Object.hasOwnProperty.call(et,"block")&&tt.uint32(10).bytes(et.block),et.priority!=null&&Object.hasOwnProperty.call(et,"priority")&&tt.uint32(16).int32(et.priority),et.cancel!=null&&Object.hasOwnProperty.call(et,"cancel")&&tt.uint32(24).bool(et.cancel),et.wantType!=null&&Object.hasOwnProperty.call(et,"wantType")&&tt.uint32(32).int32(et.wantType),et.sendDontHave!=null&&Object.hasOwnProperty.call(et,"sendDontHave")&&tt.uint32(40).bool(et.sendDontHave),tt},$.decode=function(et,tt){et instanceof $Reader||(et=$Reader.create(et));for(var rt=tt===void 0?et.len:et.pos+tt,nt=new $root.Message.Wantlist.Entry;et.pos<rt;){var it=et.uint32();switch(it>>>3){case 1:{nt.block=et.bytes();break}case 2:{nt.priority=et.int32();break}case 3:{nt.cancel=et.bool();break}case 4:{nt.wantType=et.int32();break}case 5:{nt.sendDontHave=et.bool();break}default:et.skipType(it&7);break}}return nt},$.fromObject=function(et){if(et instanceof $root.Message.Wantlist.Entry)return et;var tt=new $root.Message.Wantlist.Entry;switch(et.block!=null&&(typeof et.block=="string"?$util.base64.decode(et.block,tt.block=$util.newBuffer($util.base64.length(et.block)),0):et.block.length>=0&&(tt.block=et.block)),et.priority!=null&&(tt.priority=et.priority|0),et.cancel!=null&&(tt.cancel=!!et.cancel),et.wantType){case"Block":case 0:tt.wantType=0;break;case"Have":case 1:tt.wantType=1;break}return et.sendDontHave!=null&&(tt.sendDontHave=!!et.sendDontHave),tt},$.toObject=function(et,tt){tt||(tt={});var rt={};return tt.defaults&&(tt.bytes===String?rt.block="":(rt.block=[],tt.bytes!==Array&&(rt.block=$util.newBuffer(rt.block))),rt.priority=0,rt.cancel=!1,rt.wantType=tt.enums===String?"Block":0,rt.sendDontHave=!1),et.block!=null&&et.hasOwnProperty("block")&&(rt.block=tt.bytes===String?$util.base64.encode(et.block,0,et.block.length):tt.bytes===Array?Array.prototype.slice.call(et.block):et.block),et.priority!=null&&et.hasOwnProperty("priority")&&(rt.priority=et.priority),et.cancel!=null&&et.hasOwnProperty("cancel")&&(rt.cancel=et.cancel),et.wantType!=null&&et.hasOwnProperty("wantType")&&(rt.wantType=tt.enums===String?$root.Message.Wantlist.WantType[et.wantType]:et.wantType),et.sendDontHave!=null&&et.hasOwnProperty("sendDontHave")&&(rt.sendDontHave=et.sendDontHave),rt},$.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},$.getTypeUrl=function(et){return et===void 0&&(et="type.googleapis.com"),et+"/Message.Wantlist.Entry"},$}(),o}(),_.Block=function(){function o($){if($)for(var j=Object.keys($),et=0;et<j.length;++et)$[j[et]]!=null&&(this[j[et]]=$[j[et]])}return o.prototype.prefix=$util.newBuffer([]),o.prototype.data=$util.newBuffer([]),o.encode=function(j,et){return et||(et=$Writer.create()),j.prefix!=null&&Object.hasOwnProperty.call(j,"prefix")&&et.uint32(10).bytes(j.prefix),j.data!=null&&Object.hasOwnProperty.call(j,"data")&&et.uint32(18).bytes(j.data),et},o.decode=function(j,et){j instanceof $Reader||(j=$Reader.create(j));for(var tt=et===void 0?j.len:j.pos+et,rt=new $root.Message.Block;j.pos<tt;){var nt=j.uint32();switch(nt>>>3){case 1:{rt.prefix=j.bytes();break}case 2:{rt.data=j.bytes();break}default:j.skipType(nt&7);break}}return rt},o.fromObject=function(j){if(j instanceof $root.Message.Block)return j;var et=new $root.Message.Block;return j.prefix!=null&&(typeof j.prefix=="string"?$util.base64.decode(j.prefix,et.prefix=$util.newBuffer($util.base64.length(j.prefix)),0):j.prefix.length>=0&&(et.prefix=j.prefix)),j.data!=null&&(typeof j.data=="string"?$util.base64.decode(j.data,et.data=$util.newBuffer($util.base64.length(j.data)),0):j.data.length>=0&&(et.data=j.data)),et},o.toObject=function(j,et){et||(et={});var tt={};return et.defaults&&(et.bytes===String?tt.prefix="":(tt.prefix=[],et.bytes!==Array&&(tt.prefix=$util.newBuffer(tt.prefix))),et.bytes===String?tt.data="":(tt.data=[],et.bytes!==Array&&(tt.data=$util.newBuffer(tt.data)))),j.prefix!=null&&j.hasOwnProperty("prefix")&&(tt.prefix=et.bytes===String?$util.base64.encode(j.prefix,0,j.prefix.length):et.bytes===Array?Array.prototype.slice.call(j.prefix):j.prefix),j.data!=null&&j.hasOwnProperty("data")&&(tt.data=et.bytes===String?$util.base64.encode(j.data,0,j.data.length):et.bytes===Array?Array.prototype.slice.call(j.data):j.data),tt},o.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},o.getTypeUrl=function(j){return j===void 0&&(j="type.googleapis.com"),j+"/Message.Block"},o}(),_.BlockPresenceType=function(){const o={},$=Object.create(o);return $[o[0]="Have"]=0,$[o[1]="DontHave"]=1,$}(),_.BlockPresence=function(){function o($){if($)for(var j=Object.keys($),et=0;et<j.length;++et)$[j[et]]!=null&&(this[j[et]]=$[j[et]])}return o.prototype.cid=$util.newBuffer([]),o.prototype.type=0,o.encode=function(j,et){return et||(et=$Writer.create()),j.cid!=null&&Object.hasOwnProperty.call(j,"cid")&&et.uint32(10).bytes(j.cid),j.type!=null&&Object.hasOwnProperty.call(j,"type")&&et.uint32(16).int32(j.type),et},o.decode=function(j,et){j instanceof $Reader||(j=$Reader.create(j));for(var tt=et===void 0?j.len:j.pos+et,rt=new $root.Message.BlockPresence;j.pos<tt;){var nt=j.uint32();switch(nt>>>3){case 1:{rt.cid=j.bytes();break}case 2:{rt.type=j.int32();break}default:j.skipType(nt&7);break}}return rt},o.fromObject=function(j){if(j instanceof $root.Message.BlockPresence)return j;var et=new $root.Message.BlockPresence;switch(j.cid!=null&&(typeof j.cid=="string"?$util.base64.decode(j.cid,et.cid=$util.newBuffer($util.base64.length(j.cid)),0):j.cid.length>=0&&(et.cid=j.cid)),j.type){case"Have":case 0:et.type=0;break;case"DontHave":case 1:et.type=1;break}return et},o.toObject=function(j,et){et||(et={});var tt={};return et.defaults&&(et.bytes===String?tt.cid="":(tt.cid=[],et.bytes!==Array&&(tt.cid=$util.newBuffer(tt.cid))),tt.type=et.enums===String?"Have":0),j.cid!=null&&j.hasOwnProperty("cid")&&(tt.cid=et.bytes===String?$util.base64.encode(j.cid,0,j.cid.length):et.bytes===Array?Array.prototype.slice.call(j.cid):j.cid),j.type!=null&&j.hasOwnProperty("type")&&(tt.type=et.enums===String?$root.Message.BlockPresenceType[j.type]:j.type),tt},o.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},o.getTypeUrl=function(j){return j===void 0&&(j="type.googleapis.com"),j+"/Message.BlockPresence"},o}(),_})(),WantType$1={Block:Message.Wantlist.WantType.Block,Have:Message.Wantlist.WantType.Have},sortBy=(_,o)=>Array.prototype.slice.call(o,0).sort(($,j)=>{const et=_($),tt=_(j);return et<tt?-1:et>tt?1:0});class Wantlist{constructor(o,$){this.set=$?trackedMap({name:"ipfs_bitswap_wantlist",metrics:$.metrics}):new Map,this._stats=o}get length(){return this.set.size}add(o,$,j){const et=o.toString(base58btc$4),tt=this.set.get(et);tt?(tt.inc(),tt.priority=$,tt.wantType===WantType$1.Have&&j===WantType$1.Block&&(tt.wantType=j)):(this.set.set(et,new WantListEntry(o,$,j)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(o){const $=o.toString(base58btc$4),j=this.set.get($);j&&(j.dec(),!j.hasRefs()&&(this.set.delete($),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(o){this.set.has(o)&&this.set.delete(o)}forEach(o){return this.set.forEach(o)}entries(){return this.set.entries()}sortedEntries(){return new Map(sortBy(o=>o[1].key,Array.from(this.set.entries())))}contains(o){const $=o.toString(base58btc$4);return this.set.has($)}get(o){const $=o.toString(base58btc$4);return this.set.get($)}}Wantlist.Entry=WantListEntry;const WantlistEntry=Wantlist.Entry;class BitswapMessageEntry{constructor(o,$,j,et,tt){this.entry=new WantlistEntry(o,$,j),this.cancel=!!et,this.sendDontHave=!!tt}get cid(){return this.entry.cid}set cid(o){this.entry.cid=o}get priority(){return this.entry.priority}set priority(o){this.entry.priority=o}get wantType(){return this.entry.wantType}set wantType(o){this.entry.wantType=o}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(base58btc$4)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(o){return this.cancel===o.cancel&&this.sendDontHave===o.sendDontHave&&this.wantType===o.wantType&&this.entry.equals(o.entry)}}const logger=(_,o)=>{const $=["bitswap"];return o&&$.push(o),_&&$.push(`${_.toString().slice(0,8)}`),logger$1($.join(":"))},isMapEqual=(_,o)=>{if(_.size!==o.size)return!1;for(const[$,j]of _){const et=o.get($);if(et===void 0||j instanceof Uint8Array&&et instanceof Uint8Array&&!equals$6(j,et)||j instanceof BitswapMessageEntry&&et instanceof BitswapMessageEntry&&!j.equals(et))return!1}return!0};class BitswapMessage{constructor(o){this.full=o,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(o,$,j,et,tt){j==null&&(j=BitswapMessage.WantType.Block);const rt=o.toString(base58btc$4),nt=this.wantlist.get(rt);nt?(nt.wantType===j&&(nt.priority=$),et&&(nt.cancel=!!et),tt&&(nt.sendDontHave=!!tt),j===BitswapMessage.WantType.Block&&nt.wantType===BitswapMessage.WantType.Have&&(nt.wantType=j)):this.wantlist.set(rt,new BitswapMessageEntry(o,$,j,et,tt))}addBlock(o,$){const j=o.toString(base58btc$4);this.blocks.set(j,$)}addHave(o){const $=o.toString(base58btc$4);this.blockPresences.has($)||this.blockPresences.set($,BitswapMessage.BlockPresenceType.Have)}addDontHave(o){const $=o.toString(base58btc$4);this.blockPresences.has($)||this.blockPresences.set($,BitswapMessage.BlockPresenceType.DontHave)}cancel(o){const $=o.toString(base58btc$4);this.wantlist.delete($),this.addEntry(o,0,BitswapMessage.WantType.Block,!0,!1)}setPendingBytes(o){this.pendingBytes=o}serializeToBitswap100(){const o={wantlist:{entries:Array.from(this.wantlist.values()).map($=>({block:$.cid.bytes,priority:Number($.priority),cancel:!!$.cancel})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return Message.encode(o).finish()}serializeToBitswap110(){const o={wantlist:{entries:Array.from(this.wantlist.values()).map($=>({block:$.cid.bytes,priority:Number($.priority),wantType:$.wantType,cancel:!!$.cancel,sendDontHave:!!$.sendDontHave})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[$,j]of this.blocks.entries()){const et=CID$3.parse($),tt=et.version,rt=et.code,nt=et.multihash.code,it=et.multihash.digest.length,st=varintEncoder([tt,rt,nt,it]);o.payload.push(new Message.Block({prefix:st,data:j}))}for(const[$,j]of this.blockPresences)o.blockPresences.push(new Message.BlockPresence({cid:CID$3.parse($).bytes,type:j}));return this.pendingBytes>0&&(o.pendingBytes=this.pendingBytes),Message.encode(o).finish()}equals(o){return!(this.full!==o.full||this.pendingBytes!==o.pendingBytes||!isMapEqual(this.wantlist,o.wantlist)||!isMapEqual(this.blocks,o.blocks)||!isMapEqual(this.blockPresences,o.blockPresences))}get[Symbol.toStringTag](){const o=Array.from(this.wantlist.keys()),$=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${o}, blocks: ${$}>`}}BitswapMessage.deserialize=async(_,o)=>{const $=Message.decode(_),j=$.wantlist&&$.wantlist.full||!1,et=new BitswapMessage(j);return $.wantlist&&$.wantlist.entries&&$.wantlist.entries.forEach(tt=>{if(!tt.block)return;const rt=CID$3.decode(tt.block);et.addEntry(rt,tt.priority||0,tt.wantType,!!tt.cancel,!!tt.sendDontHave)}),$.blockPresences&&$.blockPresences.forEach(tt=>{if(!tt.cid)return;const rt=CID$3.decode(tt.cid);tt.type===BitswapMessage.BlockPresenceType.Have?et.addHave(rt):et.addDontHave(rt)}),$.blocks.length>0?(await Promise.all($.blocks.map(async tt=>{const rt=await sha256$8.digest(tt),nt=CID$3.createV0(rt);et.addBlock(nt,tt)})),et):($.payload.length>0&&(await Promise.all($.payload.map(async tt=>{if(!tt.prefix||!tt.data)return;const rt=src(tt.prefix),nt=rt[0],it=rt[1],st=rt[2],ot=st===sha256$8.code?sha256$8:o&&await o.getHasher(st);if(!ot)throw new CodeError("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");const at=await ot.digest(tt.data),ct=CID$3.create(nt,it,at);et.addBlock(ct,tt.data)})),et.setPendingBytes($.pendingBytes)),et)};BitswapMessage.blockPresenceSize=_=>_.bytes.length+1;BitswapMessage.Entry=BitswapMessageEntry;BitswapMessage.WantType={Block:Message.Wantlist.WantType.Block,Have:Message.Wantlist.WantType.Have};BitswapMessage.BlockPresenceType={Have:Message.BlockPresenceType.Have,DontHave:Message.BlockPresenceType.DontHave};const maxProvidersPerRequest=3,kMaxPriority=Math.pow(2,31)-1,maxListeners=1e3,wantlistSendDebounceMs=1;var functionDebounce=debounce;function debounce(_,o,$){var j=null,et=null,tt=function(){j&&(clearTimeout(j),et=null,j=null)},rt=function(){var it=et;tt(),it&&it()},nt=function(){if(!o)return _.apply(this,arguments);var it=this,st=arguments,ot=$&&!j;if(tt(),et=function(){_.apply(it,st)},j=setTimeout(function(){if(j=null,!ot){var at=et;return et=null,at()}},o),ot)return et()};return nt.cancel=tt,nt.flush=rt,nt}class MsgQueue{constructor(o,$,j){this.peerId=$,this.network=j,this.refcnt=1,this._entries=[],this._log=logger(o,"msgqueue"),this.sendEntries=functionDebounce(this._sendEntries.bind(this),wantlistSendDebounceMs)}addMessage(o){o.empty||this.send(o)}addEntries(o){this._entries=this._entries.concat(o),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const o=new BitswapMessage(!1);this._entries.forEach($=>{$.cancel?o.cancel($.cid):o.addEntry($.cid,$.priority)}),this._entries=[],this.addMessage(o)}async send(o){try{await this.network.connectTo(this.peerId)}catch($){this._log.error("cant connect to peer %s: %s",this.peerId.toString(),$.message);return}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,o).catch($=>{this._log.error("send error: %s",$.message)})}}class WantManager{constructor(o,$,j,et){this.peers=trackedMap({name:"ipfs_bitswap_want_manager_peers",metrics:et.metrics}),this.wantlist=new Wantlist(j,et),this.network=$,this._stats=j,this._peerId=o,this._log=logger(o,"want")}_addEntries(o,$,j){const et=o.map((tt,rt)=>new BitswapMessage.Entry(tt,kMaxPriority-rt,BitswapMessage.WantType.Block,$));et.forEach(tt=>{tt.cancel?j?this.wantlist.removeForce(tt.cid.toString(base58btc$4)):this.wantlist.remove(tt.cid):(this._log("adding to wl"),this.wantlist.add(tt.cid,tt.priority))});for(const tt of this.peers.values())tt.addEntries(et)}_startPeerHandler(o){let $=this.peers.get(o.toString());if($){$.refcnt++;return}$=new MsgQueue(this._peerId,o,this.network);const j=new BitswapMessage(!0);for(const et of this.wantlist.entries())j.addEntry(et[1].cid,et[1].priority);return $.addMessage(j),this.peers.set(o.toString(),$),$}_stopPeerHandler(o){const $=this.peers.get(o.toString());$&&($.refcnt--,!($.refcnt>0)&&this.peers.delete(o.toString()))}wantBlocks(o,$={}){this._addEntries(o,!1),$&&$.signal&&$.signal.addEventListener("abort",()=>{this.cancelWants(o)})}unwantBlocks(o){this._log("unwant blocks: %s",o.length),this._addEntries(o,!0,!0)}cancelWants(o){this._log("cancel wants: %s",o.length),this._addEntries(o,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(o){this._startPeerHandler(o)}disconnected(o){this._stopPeerHandler(o)}start(){}stop(){this.peers.forEach(o=>this.disconnected(o.peerId))}}const BITSWAP100="/ipfs/bitswap/1.0.0",BITSWAP110="/ipfs/bitswap/1.1.0",BITSWAP120="/ipfs/bitswap/1.2.0",DEFAULT_MAX_INBOUND_STREAMS=32,DEFAULT_MAX_OUTBOUND_STREAMS=128,DEFAULT_INCOMING_STREAM_TIMEOUT=3e4;let Network$1=class{constructor(o,$,j,et={}){this._log=logger(o.peerId,"network"),this._libp2p=o,this._bitswap=$,this._protocols=[BITSWAP100],et.b100Only||(this._protocols.unshift(BITSWAP110),this._protocols.unshift(BITSWAP120)),this._stats=j,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=et.hashLoader,this._maxInboundStreams=et.maxInboundStreams??DEFAULT_MAX_INBOUND_STREAMS,this._maxOutboundStreams=et.maxOutboundStreams??DEFAULT_MAX_OUTBOUND_STREAMS,this._incomingStreamTimeout=et.incomingStreamTimeout??DEFAULT_INCOMING_STREAM_TIMEOUT}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const o=createTopology({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(const $ of this._protocols)this._registrarIds.push(await this._libp2p.register($,o));this._libp2p.getConnections().forEach($=>{this._onPeerConnect($.remotePeer)})}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarIds!=null){for(const o of this._registrarIds)this._libp2p.unregister(o);this._registrarIds=[]}}_onConnection({stream:o,connection:$}){if(!this._running)return;const j=new timeoutAbortController.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",o.stat.protocol,$.remotePeer),await pipe(abortableSource(o.source,j.signal),decode$3(),async et=>{for await(const tt of et){try{const rt=await BitswapMessage.deserialize(tt.subarray(),this._hashLoader);await this._bitswap._receiveMessage($.remotePeer,rt)}catch(rt){this._bitswap._receiveError(rt);break}j.reset()}})}).catch(et=>{this._log(et),o.abort(et)}).finally(()=>{j.clear(),o.close()})}_onPeerConnect(o){this._bitswap._onPeerConnected(o)}_onPeerDisconnect(o){this._bitswap._onPeerDisconnected(o)}findProviders(o,$={}){return this._libp2p.contentRouting.findProviders(o,$)}async findAndConnect(o,$){const j=[];let et=0;for await(const tt of this.findProviders(o,$))if(this._log(`connecting to provider ${tt.id}`),j.push(this.connectTo(tt.id,$).catch(rt=>{this._log.error(rt)})),et++,et===maxProvidersPerRequest)break;await Promise.all(j)}async provide(o,$){await this._libp2p.contentRouting.provide(o,$)}async sendMessage(o,$){if(!this._running)throw new Error("network isn't running");const j=o.toString();this._log("sendMessage to %s",j,$);const tt=await(await this._libp2p.dial(o)).newStream([BITSWAP120,BITSWAP110,BITSWAP100]);await writeMessage(tt,$,this._log),this._updateSentStats(o,$.blocks)}async connectTo(o,$){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(o,$)}_updateSentStats(o,$){const j=o.toString();if(this._stats){for(const et of $.values())this._stats.push(j,"dataSent",et.length);this._stats.push(j,"blocksSent",$.size)}}};async function writeMessage(_,o,$){try{let j;switch(_.stat.protocol){case BITSWAP100:j=o.serializeToBitswap100();break;case BITSWAP110:case BITSWAP120:j=o.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+_.stat.protocol)}await pipe([j],encode$5(),_)}catch(j){$(j)}finally{_.close()}}class Ledger{constructor(o){this.partner=o,this.wantlist=new Wantlist,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(o){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=o}receivedBytes(o){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=o}wants(o,$,j){this.wantlist.add(o,$,j)}cancelWant(o){this.wantlist.remove(o)}wantlistContains(o){return this.wantlist.get(o)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class SortedMap extends Map{constructor(o,$){super(),this._cmp=$||this._defaultSort,this._keys=[];for(const[j,et]of o||[])this.set(j,et)}update(o){if(o<0||o>=this._keys.length)return;const $=this._keys[o];this._keys.splice(o,1);const j=this._find($);this._keys.splice(j,0,$)}set(o,$){if(this.has(o)){const et=this.indexOf(o);this._keys.splice(et,1)}super.set(o,$);const j=this._find(o);return this._keys.splice(j,0,o),this}clear(){super.clear(),this._keys=[]}delete(o){if(!this.has(o))return!1;const $=this.indexOf(o);return this._keys.splice($,1),super.delete(o)}indexOf(o){if(!this.has(o))return-1;const $=this._find(o);if(this._keys[$]===o)return $;for(let j=1;j<this._keys.length;j++){if(this._keys[$+j]===o)return $+j;if(this._keys[$-j]===o)return $-j}return-1}_find(o){let $=0,j=this._keys.length;for(;$<j;){const et=$+j>>>1,tt=this._kCmp(this._keys[et],o);if(tt<0)$=et+1;else if(tt>0)j=et;else return et}return $}*keys(){for(const o of this._keys)yield o}*values(){for(const o of this._keys)yield this.get(o)}*entries(){for(const o of this._keys)yield[o,this.get(o)]}*[Symbol.iterator](){yield*this.entries()}forEach(o,$){if(o)for(const j of this._keys)o.apply($,[[j,this.get(j)]])}_defaultSort(o,$){return o[0]<$[0]?-1:$[0]<o[0]?1:0}_kCmp(o,$){return this._cmp([o,this.get(o)],[$,this.get($)])}}const DefaultTaskMerger={hasNewInfo(){return!1},merge(){}};class RequestQueue{constructor(o=DefaultTaskMerger){this._taskMerger=o,this._byPeer=new SortedMap([],PeerTasks.compare)}pushTasks(o,$){let j=this._byPeer.get(o.toString());j||(j=new PeerTasks(o,this._taskMerger)),j.pushTasks($),this._byPeer.set(o.toString(),j)}popTasks(o){const $=this._head();if($===void 0)return{tasks:[],pendingSize:0};const{tasks:j,pendingSize:et}=$.popTasks(o);if(j.length===0)return{tasks:j,pendingSize:et};const tt=$.peerId;return $.isIdle()?this._byPeer.delete(tt.toString()):this._byPeer.update(0),{peerId:tt,tasks:j,pendingSize:et}}_head(){if(this._byPeer.size!==0)for(const[,o]of this._byPeer)return o}remove(o,$){const j=this._byPeer.get($.toString());j&&j.remove(o)}tasksDone(o,$){const j=this._byPeer.get(o.toString());if(!j)return;const et=this._byPeer.indexOf(o.toString());for(const tt of $)j.taskDone(tt);this._byPeer.update(et)}}class PeerTasks{constructor(o,$){this.peerId=o,this._taskMerger=$,this._activeTotalSize=0,this._pending=new PendingTasks,this._active=new Set}pushTasks(o){for(const $ of o)this._pushTask($)}_pushTask(o){if(!this._taskHasMoreInfoThanActiveTasks(o))return;const $=this._pending.get(o.topic);if($){o.priority>$.priority&&this._pending.updatePriority(o.topic,o.priority),this._taskMerger.merge(o,$);return}this._pending.add(o)}_taskHasMoreInfoThanActiveTasks(o){const $=[];for(const j of this._active)j.topic===o.topic&&$.push(j);return $.length===0?!0:this._taskMerger.hasNewInfo(o,$)}popTasks(o){let $=0;const j=[],et=this._pending.tasks();for(let tt=0;tt<et.length&&$<o;tt++){const rt=et[tt];j.push(rt),$+=rt.size,this._pending.delete(rt.topic),this._activeTotalSize+=rt.size,this._active.add(rt)}return{tasks:j,pendingSize:this._pending.totalSize}}taskDone(o){this._active.has(o)&&(this._activeTotalSize-=o.size,this._active.delete(o))}remove(o){this._pending.delete(o)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(o,$){return o[1]._pending.length===0?1:$[1]._pending.length===0?-1:o[1]._activeTotalSize===$[1]._activeTotalSize?$[1]._pending.length-o[1]._pending.length:o[1]._activeTotalSize-$[1]._activeTotalSize}}class PendingTasks{constructor(){this._tasks=new SortedMap([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((o,$)=>o+$.task.size,0)}get(o){return(this._tasks.get(o)||{}).task}add(o){this._tasks.set(o.topic,{created:Date.now(),task:o})}delete(o){this._tasks.delete(o)}tasks(){return[...this._tasks.values()].map(o=>o.task)}updatePriority(o,$){const j=this._tasks.get(o);if(!j)return;const et=this._tasks.indexOf(o);j.task.priority=$,this._tasks.update(et)}_compare(o,$){return o[1].task.priority===$[1].task.priority?o[1].created-$[1].created:$[1].task.priority-o[1].task.priority}}const TaskMerger={hasNewInfo(_,o){let $=!1,j=!1;for(const et of o)et.data.haveBlock&&($=!0),et.data.isWantBlock&&(j=!0);return!!(!j&&_.data.isWantBlock||!$&&_.data.haveBlock)},merge(_,o){const $=_.data,j=o.data;!j.haveBlock&&$.haveBlock&&(j.haveBlock=$.haveBlock,j.blockSize=$.blockSize),!j.isWantBlock&&$.isWantBlock&&(j.isWantBlock=!0,(!j.haveBlock||$.haveBlock)&&(j.haveBlock=$.haveBlock,o.size=_.size)),j.isWantBlock&&j.haveBlock&&(o.size=j.blockSize)}},WantType=BitswapMessage.WantType,TARGET_MESSAGE_SIZE=16*1024,MAX_SIZE_REPLACE_HAS_WITH_BLOCK=1024;class DecisionEngine{constructor(o,$,j,et,tt,rt={}){this._log=logger(o,"engine"),this.blockstore=$,this.network=j,this._stats=et,this._opts=this._processOpts(rt),this.ledgerMap=trackedMap({name:"ipfs_bitswap_ledger_map",metrics:tt.metrics}),this._running=!1,this._requestQueue=new RequestQueue(TaskMerger)}_processOpts(o){return{maxSizeReplaceHasWithBlock:MAX_SIZE_REPLACE_HAS_WITH_BLOCK,targetMessageSize:TARGET_MESSAGE_SIZE,...o}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;const{peerId:o,tasks:$,pendingSize:j}=this._requestQueue.popTasks(this._opts.targetMessageSize);if($.length===0)return;const et=new BitswapMessage(!1);et.setPendingBytes(j);const tt=[],rt=new Map;for(const it of $){const st=CID$3.parse(it.topic);it.data.haveBlock?it.data.isWantBlock?(tt.push(st),rt.set(it.topic,it.data)):et.addHave(st):et.addDontHave(st)}const nt=await this._getBlocks(tt);for(const[it,st]of rt){const ot=CID$3.parse(it),at=nt.get(it);at?et.addBlock(ot,at):st.sendDontHave&&et.addDontHave(ot)}if(et.empty){o&&this._requestQueue.tasksDone(o,$),this._scheduleProcessTasks();return}try{o&&await this.network.sendMessage(o,et);for(const[it,st]of nt.entries())o&&this.messageSent(o,CID$3.parse(it),st)}catch(it){this._log.error(it)}o&&this._requestQueue.tasksDone(o,$),this._scheduleProcessTasks()}wantlistForPeer(o){const $=o.toString(),j=this.ledgerMap.get($);return j?j.wantlist.sortedEntries():new Map}ledgerForPeer(o){const $=o.toString(),j=this.ledgerMap.get($);return j?{peer:j.partner,value:j.debtRatio(),sent:j.accounting.bytesSent,recv:j.accounting.bytesRecv,exchanged:j.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(o=>o.partner)}receivedBlocks(o){if(o.length){for(const $ of this.ledgerMap.values())for(const j of o){const et=$.wantlistContains(j.cid);if(!et)continue;const tt=j.data.length,rt=this._sendAsBlock(et.wantType,tt);let nt=tt;rt||(nt=BitswapMessage.blockPresenceSize(et.cid)),this._requestQueue.pushTasks($.partner,[{topic:et.cid.toString(base58btc$4),priority:et.priority,size:nt,data:{blockSize:tt,isWantBlock:rt,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(o,$){const j=this._findOrCreate(o);if($.empty)return;if($.full&&(j.wantlist=new Wantlist),this._updateBlockAccounting($.blocks,j),$.wantlist.size===0){this._scheduleProcessTasks();return}const et=[],tt=[];$.wantlist.forEach(rt=>{rt.cancel?(j.cancelWant(rt.cid),et.push(rt.cid)):(j.wants(rt.cid,rt.priority,rt.wantType),tt.push(rt))}),this._cancelWants(o,et),await this._addWants(o,tt),this._scheduleProcessTasks()}_cancelWants(o,$){for(const j of $)this._requestQueue.remove(j.toString(base58btc$4),o)}async _addWants(o,$){const j=await this._getBlockSizes($.map(tt=>tt.cid)),et=[];for(const tt of $){const rt=tt.cid.toString(base58btc$4),nt=j.get(rt);if(nt==null)tt.sendDontHave&&et.push({topic:rt,priority:tt.priority,size:BitswapMessage.blockPresenceSize(tt.cid),data:{isWantBlock:tt.wantType===WantType.Block,blockSize:0,haveBlock:!1,sendDontHave:tt.sendDontHave}});else{const it=this._sendAsBlock(tt.wantType,nt);let st=nt;it||(st=BitswapMessage.blockPresenceSize(tt.cid)),et.push({topic:rt,priority:tt.priority,size:st,data:{isWantBlock:it,blockSize:nt,haveBlock:!0,sendDontHave:tt.sendDontHave}})}this._requestQueue.pushTasks(o,et)}}_sendAsBlock(o,$){return o===WantType.Block||$<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(o){const $=await this._getBlocks(o);return new Map([...$].map(([j,et])=>[j,et.length]))}async _getBlocks(o){const $=new Map;return await Promise.all(o.map(async j=>{try{const et=await this.blockstore.get(j);$.set(j.toString(base58btc$4),et)}catch(et){et.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",j,et)}})),$}_updateBlockAccounting(o,$){for(const j of o.values())this._log("got block (%s bytes)",j.length),$.receivedBytes(j.length)}messageSent(o,$,j){const et=this._findOrCreate(o);et.sentBytes(j.length),et.wantlist.remove($)}numBytesSentTo(o){return this._findOrCreate(o).accounting.bytesSent}numBytesReceivedFrom(o){return this._findOrCreate(o).accounting.bytesRecv}peerDisconnected(o){this.ledgerMap.delete(o.toString())}_findOrCreate(o){const $=o.toString(),j=this.ledgerMap.get($);if(j)return j;const et=new Ledger(o);return this.ledgerMap.set($,et),this._stats&&this._stats.push($,"peerCount",1),et}start(){this._running=!0}stop(){this._running=!1}}const unwantEvent=_=>`unwant:${toString$a(_.multihash.bytes,"base64")}`,blockEvent=_=>`block:${toString$a(_.multihash.bytes,"base64")}`;class Notifications extends eventsExports.EventEmitter{constructor(o){super(),this.setMaxListeners(maxListeners),this._log=logger(o,"notif")}hasBlock(o,$){const j=blockEvent(o);this._log(j),this.emit(j,$)}wantBlock(o,$={}){if(!o)throw new Error("Not a valid cid");const j=blockEvent(o),et=unwantEvent(o);return this._log(`wantBlock:${o}`),new Promise((tt,rt)=>{const nt=()=>{this.removeListener(j,it),rt(new Error(`Block for ${o} unwanted`))},it=st=>{this.removeListener(et,nt),tt(st)};this.once(et,nt),this.once(j,it),$&&$.signal&&$.signal.addEventListener("abort",()=>{this.removeListener(j,it),this.removeListener(et,nt),rt(new Error(`Want for ${o} aborted`))})})}unwantBlock(o){const $=unwantEvent(o);this._log($),this.emit($)}}var movingAverageExports={},movingAverage={get exports(){return movingAverageExports},set exports(_){movingAverageExports=_}};(function(_,o){const $=Math.exp;_.exports=function(et){if(typeof et!="number")throw new Error("must provide a timespan to the moving average constructor");if(et<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let tt,rt=0,nt=0,it=0,st,ot={};function at(ct,ut){return 1-$(-(ct-ut)/et)}return ot.push=function(ut,ft){if(st){const ht=at(ut,st),mt=ft-tt,gt=ht*mt;tt=ht*ft+(1-ht)*tt,rt=(1-ht)*(rt+mt*gt),nt=Math.sqrt(rt),it=tt+ht*mt}else tt=ft;st=ut},ot.movingAverage=function(){return tt},ot.variance=function(){return rt},ot.deviation=function(){return nt},ot.forecast=function(){return it},ot}})(movingAverage);class Stat extends eventsExports.EventEmitter{constructor(o,$){super(),this._options=$,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),o.forEach(j=>{this._stats[j]=BigInt(0),this._movingAverages[j]={},this._options.movingAverageIntervals.forEach(et=>{(this._movingAverages[j][et]=movingAverageExports(et)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(o,$){this._enabled&&(this._queue.push([o,$,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const o=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-o),0)}_update(){if(this._timeout=null,this._queue.length){let o;for(;this._queue.length;){const $=o=this._queue.shift();$&&this._applyOp($)}o&&this._updateFrequency(o[2]),this.emit("update",this._stats)}}_updateFrequency(o){const $=o-this._frequencyLastTime;$&&Object.keys(this._stats).forEach(j=>{this._updateFrequencyFor(j,$,o)}),this._frequencyLastTime=o}_updateFrequencyFor(o,$,j){const et=this._frequencyAccumulators[o]||0;this._frequencyAccumulators[o]=0;const tt=et/$*1e3;let rt=this._movingAverages[o];rt||(rt=this._movingAverages[o]={}),this._options.movingAverageIntervals.forEach(nt=>{let it=rt[nt];it||(it=rt[nt]=movingAverageExports(nt)),it.push(j,tt)})}_applyOp(o){const $=o[0],j=o[1];if(typeof j!="number")throw new Error(`invalid increment number: ${j}`);Object.prototype.hasOwnProperty.call(this._stats,$)||(this._stats[$]=BigInt(0)),this._stats[$]=BigInt(this._stats[$])+BigInt(j),this._frequencyAccumulators[$]||(this._frequencyAccumulators[$]=0),this._frequencyAccumulators[$]+=j}}const defaultOptions$2={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]};class Stats extends eventsExports.EventEmitter{constructor(o,$=[],j=defaultOptions$2){super();const et=Object.assign({},defaultOptions$2,j);if(typeof et.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof et.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=$,this._options=et,this._enabled=this._options.enabled,this._global=new Stat($,et),this._global.on("update",tt=>this.emit("update",tt)),this._peers=trackedMap({name:"ipfs_bitswap_stats_peers",metrics:o.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const o of this._peers)o[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(o){const $=typeof o!="string"&&o.toString?o.toString():`${o}`;return this._peers.get($)}push(o,$,j){if(this._enabled&&(this._global.push($,j),o)){let et=this._peers.get(o);et||(et=new Stat(this._initialCounters,this._options),this._peers.set(o,et)),et.push($,j)}}disconnected(o){const $=o.toString(),j=this._peers.get($);j&&(j.stop(),this._peers.delete($))}}const defaultOptions$1={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},statsKeys=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class Bitswap extends BaseBlockstore{constructor(o,$,j={}){super(),this._libp2p=o,this._log=logger(this.peerId),this._options=Object.assign({},defaultOptions$1,j),this._stats=new Stats(o,statsKeys,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new Network$1(o,this,this._stats,{hashLoader:j.hashLoader,maxInboundStreams:j.maxInboundStreams,maxOutboundStreams:j.maxOutboundStreams,incomingStreamTimeout:j.incomingStreamTimeout}),this.blockstore=$,this.engine=new DecisionEngine(this.peerId,$,this.network,this._stats,o),this.wm=new WantManager(this.peerId,this.network,this._stats,o),this.notifications=new Notifications(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(o,$){try{await this.engine.messageReceived(o,$)}catch{this._log("failed to receive message",$)}if($.blocks.size===0)return;const j=[];for(const[et,tt]of $.blocks.entries()){const rt=CID$3.parse(et);j.push({wasWanted:this.wm.wantlist.contains(rt),cid:rt,data:tt})}this.wm.cancelWants(j.filter(({wasWanted:et})=>et).map(({cid:et})=>et)),await Promise.all(j.map(({cid:et,wasWanted:tt,data:rt})=>this._handleReceivedBlock(o,et,rt,tt)))}async _handleReceivedBlock(o,$,j,et){this._log("received block");const tt=await this.blockstore.has($);this._updateReceiveCounters(o.toString(),$,j,tt),et&&await this.put($,j)}_updateReceiveCounters(o,$,j,et){this._stats.push(o,"blocksReceived",1),this._stats.push(o,"dataReceived",j.length),et&&(this._stats.push(o,"dupBlksReceived",1),this._stats.push(o,"dupDataReceived",j.length))}_receiveError(o){this._log.error("ReceiveError: %s",o.message)}_onPeerConnected(o){this.wm.connected(o)}_onPeerDisconnected(o){this.wm.disconnected(o),this.engine.peerDisconnected(o),this._stats.disconnected(o)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(o,$){return this.engine.wantlistForPeer(o)}ledgerForPeer(o){return this.engine.ledgerForPeer(o)}async get(o,$={}){const j=(it,st)=>(this.wm.wantBlocks([it],st),this.notifications.wantBlock(it,st));let et=!1;const tt=async(it,st)=>{try{return await this.blockstore.get(it,st)}catch(ot){if(ot.code!=="ERR_NOT_FOUND")throw ot;return et||(et=!0,this.network.findAndConnect(it,st).catch(at=>this._log.error(at))),j(it,st)}},rt=new AbortController,nt=$.signal?anySignal_2([$.signal,rt.signal]):rt.signal;try{return await Promise.race([this.notifications.wantBlock(o,{signal:nt}),tt(o,{signal:nt})])}finally{rt.abort()}}async*getMany(o,$={}){for await(const j of o)yield this.get(j,$)}unwant(o){const $=Array.isArray(o)?o:[o];this.wm.unwantBlocks($),$.forEach(j=>this.notifications.unwantBlock(j))}cancelWants(o){this.wm.cancelWants(Array.isArray(o)?o:[o])}async put(o,$,j){await this.blockstore.put(o,$),this._sendHaveBlockNotifications(o,$)}async*putMany(o,$){for await(const{key:j,value:et}of this.blockstore.putMany(o,$))this._sendHaveBlockNotifications(j,et),yield{key:j,value:et}}_sendHaveBlockNotifications(o,$){this.notifications.hasBlock(o,$),this.engine.receivedBlocks([{cid:o,data:$}]),this.network.provide(o).catch(j=>{this._log.error("Failed to provide: %s",j.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}has(o){return this.blockstore.has(o)}}const createBitswap=(_,o,$={})=>new Bitswap(_,o,$);class BlockStorage extends BaseBlockstore{constructor(o,$){super(),this.child=o,this.bitswap=$}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(o,$,j={}){await this.has(o)||(this.bitswap.isStarted()?await this.bitswap.put(o,$,j):await this.child.put(o,$,j))}async*putMany(o,$={}){const j=filter$1(o,async({key:et})=>!await this.has(et));this.bitswap.isStarted()?yield*this.bitswap.putMany(j,$):yield*this.child.putMany(j,$)}async get(o,$={}){return!await this.has(o)&&this.bitswap.isStarted()?this.bitswap.get(o,$):this.child.get(o,$)}async*getMany(o,$={}){const j=pushable({objectMode:!0}),et=pushable({objectMode:!0});Promise.resolve().then(async()=>{for await(const tt of o)!await this.has(tt)&&this.bitswap.isStarted()?j.push(tt):et.push(tt);j.end(),et.end()}),yield*merge$1(this.bitswap.getMany(j,$),this.child.getMany(et,$))}async delete(o,$){await this.child.delete(o,$)}async*deleteMany(o,$){yield*this.child.deleteMany(o,$)}async has(o,$={}){return this.child.has(o,$)}async*query(o,$={}){yield*this.child.query(o,$)}async*queryKeys(o,$={}){yield*this.child.queryKeys(o,$)}}class Network{constructor(o,$,j,et,tt){this.peerId=o,this.libp2p=$,this.bitswap=j,this.repo=et,this.blockstore=tt}static async start({peerId:o,repo:$,print:j,hashers:et,options:tt}){$.closed&&await $.open();const rt=await $.config.getAll(),nt=await createLibp2p({options:tt,repo:$,peerId:o,multiaddrs:readAddrs(o,rt),config:rt,keychainConfig:void 0});await nt.start();for(const ot of nt.getMultiaddrs())j(`Swarm listening on ${ot.toString()}`);const it=createBitswap(nt,$.blocks,{statsEnabled:!0,hashLoader:et,maxInboundStreams:1024,maxOutboundStreams:1024});await it.start();const st=new BlockStorage($.blocks,it);return $.blocks=st,$.pins.blockstore=st,new Network(o,nt,it,$,st)}static async stop(o){o.repo.blocks=o.blockstore.unwrap(),o.repo.pins.blockstore=o.blockstore.unwrap(),await o.bitswap.stop(),await o.libp2p.stop()}}const readAddrs=(_,o)=>{const $=_.toString(),j=[],et=o.Addresses&&o.Addresses.Swarm||[];for(const tt of et){let rt=multiaddr$3(tt);if(rt.protoCodes().includes(WEBSOCKET_STAR_PROTO_CODE))throw errCode(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");const nt=rt.getPeerId();nt&&nt!==$&&(rt=rt.encapsulate(`/p2p/${$}`)),j.push(rt)}return j},WEBSOCKET_STAR_PROTO_CODE=479;function createAddrs({network:_}){async function o($={}){const j=[],{libp2p:et}=await _.use($);return await et.peerStore.forEach(tt=>{j.push({id:tt.id,addrs:tt.addresses.map(rt=>rt.multiaddr)})}),j}return withTimeoutOption(o)}function createConnect({network:_}){async function o($,j={}){const{libp2p:et}=await _.use(j);await et.dial($,j)}return withTimeoutOption(o)}function createDisconnect({network:_}){async function o($,j={}){const{libp2p:et}=await _.use(j);await et.hangUp($)}return withTimeoutOption(o)}function createLocalAddrs({network:_}){async function o($={}){const{libp2p:j}=await _.use($);return j.getMultiaddrs()}return withTimeoutOption(o)}function createPeers({network:_}){async function o($={}){const{libp2p:j}=await _.use($);if($.verbose){const tt=[];for(const rt of j.getConnections()){const nt={addr:rt.remoteAddr,peer:rt.remotePeer};($.verbose||$.direction)&&(nt.direction=rt.stat.direction),$.verbose&&(nt.muxer=rt.stat.multiplexer,nt.latency="n/a",nt.streams=[]),tt.push(nt)}return tt}const et=new Map;for(const tt of j.getConnections()){const rt={addr:tt.remoteAddr,peer:tt.remotePeer};et.set(tt.remotePeer.toString(),rt)}return Array.from(et.values())}return withTimeoutOption(o)}class SwarmAPI{constructor({network:o}){this.addrs=createAddrs({network:o}),this.connect=createConnect({network:o}),this.disconnect=createDisconnect({network:o}),this.localAddrs=createLocalAddrs({network:o}),this.peers=createPeers({network:o})}}const basePacket={success:!0,time:0,text:""};function createPing({network:_}){async function*o($,j={}){const{libp2p:et}=await _.use();j.count=j.count||10;const tt=await et.peerStore.get($);let rt=tt&&tt.id;if(!rt){yield{...basePacket,text:`Looking up peer ${$}`};const st=await et.peerRouting.findPeer($);rt=st&&st.id}if(!rt)throw new Error("Peer was not found");yield{...basePacket,text:`PING ${rt.toString()}`};let nt=0,it=0;for(let st=0;st<j.count;st++)try{const ot=await et.ping(rt);it+=ot,nt++,yield{...basePacket,time:ot}}catch(ot){yield{...basePacket,success:!1,text:ot.toString()}}if(nt){const st=it/nt;yield{...basePacket,text:`Average latency: ${st}ms`}}}return withTimeoutOption(o)}const IPNS_PREFIX="/ipns/";function toDHTKey(_){_.startsWith(IPNS_PREFIX)&&(_=_.substring(IPNS_PREFIX.length));let o;if((_[0]==="1"||_[0]==="Q")&&(_=`z${_}`),_[0]==="z"&&(o=base58btc$4.decode(_)),_[0]==="k"&&(o=base36$4.decode(_)),!o)throw new Error("Could not parse string");if(o[0]!==1&&o[1]!==114&&(o=concat$2([[1,114],o])),o.length!==40)throw new Error("Incorrect length "+o.length);return concat$2([fromString$8(IPNS_PREFIX),o.subarray(2)])}function createDht({network:_,repo:o,peerId:$}){const{get:j,put:et,findProvs:tt,findPeer:rt,provide:nt,query:it}={async*get(st,ot={}){const{libp2p:at}=await use(_,$,ot),ct=st instanceof Uint8Array?st:toDHTKey(st);if(at.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*at.dht.get(ct,ot)},async*put(st,ot,at){const{libp2p:ct}=await use(_,$,at),ut=st instanceof Uint8Array?st:toDHTKey(st);if(ct.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*ct.dht.put(ut,ot,at)},async*findProvs(st,ot={}){const{libp2p:at}=await use(_,$,ot);if(at.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*at.dht.findProviders(st,{signal:ot.signal})},async*findPeer(st,ot={}){const{libp2p:at}=await use(_,$,ot);if(at.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*at.dht.findPeer(st,{signal:ot.signal})},async*provide(st,ot={recursive:!1}){const{libp2p:at}=await use(_,$,ot);if(!await o.blocks.has(st))throw errCode(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(ot.recursive)throw errCode(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(at.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*at.dht.provide(st)},async*query(st,ot={}){const{libp2p:at}=await use(_,$,ot);let ct;const ut=CID$3.asCID(st);if(ut!=null?ct=ut.multihash.bytes:ct=peerIdFromString(st.toString()).toBytes(),at.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*at.dht.getClosestPeers(ct,ot)}};return{get:withTimeoutOption(j),put:withTimeoutOption(et),findProvs:withTimeoutOption(tt),findPeer:withTimeoutOption(rt),provide:withTimeoutOption(nt),query:withTimeoutOption(it)}}const use=async(_,o,$)=>{const j=await _.use($);if(j.libp2p.dht!=null)return j;{const et=async function*(){yield{from:o,name:"QUERY_ERROR",type:3,error:new NotEnabledError("dht not enabled")}};return{libp2p:{dht:{get:et,put:et,findProviders:et,findPeer:et,provide:et,getClosestPeers:et}}}}};function createPubsub({network:_,config:o}){const $=get$1(o||{},"Pubsub.Enabled",!0),j={};let et;return{subscribe:$?withTimeoutOption(tt):notEnabled,unsubscribe:$?withTimeoutOption(rt):notEnabled,publish:$?withTimeoutOption(nt):notEnabled,ls:$?withTimeoutOption(it):notEnabled,peers:$?withTimeoutOption(st):notEnabled};async function tt(ot,at,ct={}){const{libp2p:ut}=await _.use(ct);ut.pubsub.subscribe(ot),et==null&&(et=ft=>{const ht=ft.detail;j[ht.topic]&&j[ht.topic].forEach(mt=>{if(typeof mt=="function"){mt(ht);return}mt!=null&&mt.handleEvent!=null&&mt.handleEvent(ht)})},ut.pubsub.addEventListener("message",et)),at!=null&&(j[ot]==null&&(j[ot]=[]),j[ot].push(at))}async function rt(ot,at,ct={}){const{libp2p:ut}=await _.use(ct);at!=null&&j[ot]!=null&&(j[ot]=j[ot].filter(ft=>ft!==at),j[ot].length===0&&delete j[ot]),typeof at!="function"&&delete j[ot],j[ot]==null&&ut.pubsub.unsubscribe(ot),Object.keys(j).length===0&&(ut.pubsub.removeEventListener("message",et),et=void 0)}async function nt(ot,at,ct={}){const{libp2p:ut}=await _.use(ct);if(!at)throw errCode(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await ut.pubsub.publish(ot,at)}async function it(ot={}){const{libp2p:at}=await _.use(ot);return at.pubsub.getTopics()}async function st(ot,at={}){const{libp2p:ct}=await _.use(at);return ct.pubsub.getSubscribers(ot)}}const notEnabled=async()=>{throw new NotEnabledError("pubsub not enabled")},mergeOptions=mergeOptions$g.bind({ignoreUndefined:!0}),log=logger$1("ipfs"),IPNS_INIT_KEYSPACE_TIMEOUT=3e4;class IPFS{constructor({print:o,storage:$,codecs:j,options:et}){const{peerId:tt,repo:rt,keychain:nt}=$,it=Service.create(Network),st=createPreloader(et.preload),ot=createDns$1(),at=createIsOnline$1({network:it}),ct=new IPNSAPI(et),ut=Object.values(hashes);(et.ipld&&et.ipld.hashers?et.ipld.hashers:[]).forEach(lt=>ut.push(lt)),this.hashers=new Multihashes({hashers:ut,loadHasher:et.ipld&&et.ipld.loadHasher});const ft=Object.values(bases$2);(et.ipld&&et.ipld.bases?et.ipld.bases:[]).forEach(lt=>ft.push(lt)),this.bases=new Multibases({bases:ft,loadBase:et.ipld&&et.ipld.loadBase});const ht=new PinAPI({repo:rt,codecs:j}),mt=new BlockAPI({codecs:j,hashers:this.hashers,preload:st,repo:rt}),gt=new NameAPI({dns:ot,ipns:ct,repo:rt,codecs:j,peerId:tt,isOnline:at,keychain:nt,options:et}),Et=createResolve$5({repo:rt,codecs:j,bases:this.bases,name:gt}),St=new DagAPI({repo:rt,codecs:j,hashers:this.hashers,preload:st}),At=Object.assign(createRefs$1({repo:rt,codecs:j,resolve:Et,preload:st}),{local:createLocal$1({repo:$.repo})}),{add:kt,addAll:Rt,cat:Tt,get:Dt,ls:Ot}=new RootAPI({preload:st,repo:rt,options:et.EXPERIMENTAL,hashers:this.hashers}),jt=createFiles$1({repo:rt,preload:st,hashers:this.hashers,options:et}),Nt=createMfsPreloader({files:jt,preload:st,options:et.preload});this.preload=st,this.name=gt,this.ipns=ct,this.pin=ht,this.resolve=Et,this.block=mt,this.refs=At,this.start=createStart$1({network:it,peerId:tt,repo:rt,preload:st,ipns:ct,mfsPreload:Nt,print:o,keychain:nt,hashers:this.hashers,options:et}),this.stop=createStop$1({network:it,preload:st,mfsPreload:Nt,ipns:ct,repo:rt}),this.dht=createDht({network:it,repo:rt,peerId:tt}),this.pubsub=createPubsub({network:it,config:et.config}),this.dns=ot,this.isOnline=at,this.id=createId$1({network:it,peerId:tt}),this.version=createVersion$3({repo:rt}),this.bitswap=new BitswapAPI({network:it}),this.bootstrap=new BootstrapAPI({repo:rt}),this.config=createConfig$1({repo:rt}),this.ping=createPing({network:it}),this.add=kt,this.addAll=Rt,this.cat=Tt,this.get=Dt,this.ls=Ot,this.dag=St,this.files=jt,this.key=new KeyAPI({keychain:nt}),this.object=new ObjectAPI({preload:st,codecs:j,repo:rt}),this.repo=new RepoAPI({repo:rt,hashers:this.hashers}),this.stats=new StatsAPI({repo:rt,network:it}),this.swarm=new SwarmAPI({network:it}),Object.defineProperty(this,"libp2p",{get(){const lt=it.try();return lt?lt.libp2p:void 0}});const It=()=>Promise.reject(errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),yt=async function*(){throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=It,this.diag={cmds:It,net:It,sys:It},this.log={level:It,ls:It,tail:yt},this.mount=It,this.codecs=j}async init(){throw new AlreadyInitializedError}}const addEmptyDir=async _=>{const o=encode$B({Data:new UnixFS({type:"directory"}).marshal(),Links:[]}),$=await _.block.put(o,{mhtype:"sha2-256",format:"dag-pb"});return await _.pin.add($),$},getDefaultOptions$1=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!env.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function create$1(_={}){_=mergeOptions(getDefaultOptions$1(),_);const o=_.init||{},$={name:identity$3.name,code:identity$3.code,encode:st=>st,decode:st=>st},j=Object.values(codecs);[dagPB,dagCBOR$1,dagJSON,dagJOSE,$].concat(_.ipld&&_.ipld.codecs||[]).forEach(st=>j.push(st));const et=new Multicodecs({codecs:j,loadCodec:_.ipld&&_.ipld.loadCodec}),tt=_.silent?log:console.log;log("creating repo");const rt=await Storage.start(tt,et,_);log("getting repo config");const nt=await rt.repo.config.getAll(),it=new IPFS({storage:rt,print:tt,codecs:et,options:{..._,config:nt}});if(log("starting preload"),await it.preload.start(),log("starting storage"),it.ipns.startOffline(rt),rt.isNew&&!o.emptyRepo){const st=await addEmptyDir(it);if(log("adding default assets"),await(it.addAll,void 0),log("initializing IPNS keyspace"),rt.peerId.publicKey==null)throw errCode(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");const ot=new timeoutAbortController.TimeoutController(IPNS_INIT_KEYSPACE_TIMEOUT);try{await it.ipns.initializeKeyspace(rt.peerId,fromString$8(`/ipfs/${st}`),{signal:ot.signal})}finally{ot.clear()}}return _.start!==!1&&(log("starting node"),await it.start()),it}const create=create$1,config={ipfs:{preload:{enabled:!1},config:{Addresses:{Swarm:["/dns4/wrtc-star1.par.dwebops.pub/tcp/443/wss/p2p-webrtc-star/","/dns4/wrtc-star2.sjc.dwebops.pub/tcp/443/wss/p2p-webrtc-star/","/dns4/webrtc-star.discovery.libp2p.io/tcp/443/wss/p2p-webrtc-star/"]}}}};function validateParams(_){const o=Object.keys(_);for(let $=0;$<o.length;$++){const j=o[$];if(!_[j])throw new Error(`${j} is required`)}}async function AddEntry({docstore:_,entry:o,pin:$}){return validateParams({docstore:_,entry:o}),await _.put(o,{pin:$})}function queryEntries({docstore:_,options:o,mapper:$}){return validateParams({docstore:_,mapper:$}),_.query($,o||{})}function deleteEntry$1({docstore:_,key:o}){return validateParams({docstore:_,key:o}),_.del(o)}async function addEntry$1({feedstore:_,entry:o,pin:$}){return validateParams({feedstore:_,entry:o}),await _.add(o,{pin:$})}function iterator({feedstore:_,query:o,fullOp:$}){return validateParams({feedstore:_}),_.iterator(o||{}).collect().map(et=>$?et:et.payload.value)}function deleteEntry({feedstore:_,hash:o}){return validateParams({feedstore:_,hash:o}),_.remove(o)}let orbitdb=null,program=null,ipfs=null,starting_ipfs=!1;const initIPFS=async()=>ipfs||(starting_ipfs?new Promise((_,o)=>{const $=setInterval(()=>{ipfs&&(clearInterval($),_(ipfs))},100)}):(starting_ipfs=!0,ipfs=await create(config.ipfs),starting_ipfs=!1,ipfs)),initOrbitDB=async _=>orbitdb||(orbitdb=await OrbitDB.createInstance(_,{}),orbitdb),getAllDatabases=async()=>(!program&&orbitdb&&(program=await orbitdb.feed("network.programs",{accessController:{write:[orbitdb.identity.id]},create:!0}),program&&await program.load()),program?program.iterator({limit:-1}).collect():[]),getDB=async _=>{let o=null;return orbitdb&&(o=await orbitdb.open(_),await o.load()),o},fetchEntry=async(_,o)=>{const $=await getDB(_);if(!$)return null;switch($.type){case"feed":return await $.get(o);case"eventlog":return await $.get(o);case"docstore":return await $.get(o);case"keyvalue":return await $.get(o);case"counter":return $.value||0;default:return null}},fetchEntries=async(_,o={dbInstance:null,hash:"",docsOptions:{fullOp:!1},query:{limit:10,gt:"",gte:"",lt:"",lte:"",reverse:!0}})=>{const{dbInstance:$,docsOptions:j,query:et}=o,{fullOp:tt=!1}=j||{},rt=await $?await new Promise(nt=>nt($)):await getDB(_);if(!rt)return null;switch(rt.type){case"feed":return iterator({feedstore:rt,fullOp:tt,query:et||{limit:1}});case"eventlog":return await rt.iterator(et).collect();case"docstore":return queryEntries({docstore:rt,mapper:st=>st!==null,options:{fullOp:tt}});case"keyvalue":const it=await rt.all;return Object.keys(it).map(st=>({payload:{key:st,value:rt.get(st)}}));case"counter":return rt.value||0;default:return null}},addEntry=async(_,o)=>{const $=await getDB(_);if(!$)return null;const{pin:j=!1,entry:et}=o||{},tt=Object.keys(et)[0],rt=et[tt];switch($.type){case"feed":return addEntry$1({feedstore:$,entry:et,pin:j});case"eventlog":return $.add(et,{pin:j});case"docstore":return AddEntry({docstore:$,entry:et,pin:j});case"keyvalue":if(!et.key)return Promise.reject("Key is required for keyvalue database");const nt=et.key,it={...et};return delete it.key,$.put(nt,it);case"counter":return $.inc(rt);default:return null}},removeEntry=async(_,o)=>{const $=await getDB(_);if(!$)throw new Error("Database not found");switch($.type){case"feed":return deleteEntry({feedstore:$,hash:o});case"eventlog":throw new Error("Eventlog database does not support delete operation");case"docstore":return deleteEntry$1({docstore:$,key:o});case"keyvalue":return $.del(o);case"counter":throw new Error("Counter database does not support delete operation");default:throw new Error("Database type not supported")}},addDatabase=async _=>{if(!orbitdb)return Promise.reject("OrbitDB not initialized");if(!program)return Promise.reject("Programs database not initialized");const o=await orbitdb.open(_);return program.add({name:o.dbname,type:o.type,address:_,added:Date.now()})},createDatabase=async({name:_,type:o,permissions:$})=>{if(!orbitdb&&(await initOrbitDB(ipfs),!orbitdb))return Promise.reject("OrbitDB not initialized");if(!program&&(await getAllDatabases(),!program))return Promise.reject("Programs database not initialized");let j={};switch($){case"public":j={write:["*"]};break;default:j={write:[orbitdb.identity.id]};break}const et={accessController:j};let tt=null;switch(o){case DBType.keyvalue:tt=await orbitdb.keyvalue(_,et);break;case DBType.counter:tt=await orbitdb.counter(_,et);break;case DBType.feed:tt=await orbitdb.feed(_,et);break;case DBType.eventlog:tt=await orbitdb.eventlog(_,et);break;case DBType.docstore:tt=await orbitdb.docstore(_,et);break;default:throw new Error("Invalid database type")}const rt=program.add({name:_,type:o,address:tt.address.toString(),added:Date.now()});return{db:tt,hash:rt}};function SytemStatusIcon({color:_,label:o}){return jsxs(Fragment,{children:[jsx(Icon$1,{viewBox:"0 0 200 200",color:_,children:jsx("path",{fill:"currentColor",d:"M 100, 100 m -75, 0 a 75,75 0 1,0 150,0 a 75,75 0 1,0 -150,0"})}),jsxs(Text,{children:[" ",o," "]})]})}function IFPSSystem({onIpfsReady:_}){const o=useAppLogDispatch(),$=useIsMounted(),[j,et]=reactExports.useState(SystemState.connecting),tt=useToken("colors",j===SystemState.connected?"green.500":j===SystemState.error?"red.500":j===SystemState.disconnected?"black.500":"orange.500");return reactExports.useEffect(()=>{const rt=async()=>{try{o({type:"add",log:{text:"Connecting to IPFS node",type:"connecting"}});const nt=await initIPFS();if(!$())return;Object.keys(nt).length>0?(et(()=>SystemState.connected),_(nt),o({type:"add",log:{text:"Connected to IPFS",type:"connected"}})):et(()=>SystemState.disconnected)}catch(nt){et(()=>SystemState.error),o({type:"add",log:{text:`Error connecting to IPFS : ${nt.message}`,type:"error"}})}};setTimeout(()=>{rt()},1500)},[o,$,_]),jsx(SytemStatusIcon,{label:"IPFS",color:tt})}function OrbitDbSystem({ipfs:_,onOrbitDbReady:o}){const $=useAppLogDispatch(),j=useIsMounted(),[et,tt]=reactExports.useState(SystemState.connecting),rt=useToken("colors",et===SystemState.connected?"green.500":et===SystemState.error?"red.500":et===SystemState.disconnected?"black.500":"orange.700");return reactExports.useEffect(()=>{const nt=async()=>{try{if(!_)return;$({type:"add",log:{text:"Connecting to OrbitDB",type:"connecting"}});const it=await initOrbitDB(_);if(!j())return;it!=null&&it.id?(tt(()=>SystemState.connected),o(),$({type:"add",log:{text:`Connected to OrbitDB Id : ${it.id}`,type:"connected"}})):tt(()=>SystemState.disconnected)}catch(it){tt(()=>SystemState.error),$({type:"add",log:{text:`Error connecting to OrbitDB : ${it.message}`,type:"error"}})}};setTimeout(()=>{nt()},1500)},[_,$,j,o]),jsx(SytemStatusIcon,{label:"OrbitDB",color:rt})}function MapOrbitDbEntry(_){var o,$,j,et,tt,rt,nt,it,st,ot,at,ct,ut,ft,ht,mt,gt,Et,St,At;return{id:(_==null?void 0:_.id)||"",hash:(_==null?void 0:_.hash)||"",key:(_==null?void 0:_.key)||"",sig:(_==null?void 0:_.sig)||"",v:(_==null?void 0:_.v)||0,clock:{id:((o=_==null?void 0:_.clock)==null?void 0:o.id)||"",time:(($=_==null?void 0:_.clock)==null?void 0:$.time)||0},next:(j=_==null?void 0:_.next)!=null&&j.length?_==null?void 0:_.next:[],identity:{id:((et=_==null?void 0:_.identity)==null?void 0:et.id)||"",publicKey:((tt=_==null?void 0:_.identity)==null?void 0:tt.publicKey)||"",type:((rt=_==null?void 0:_.identity)==null?void 0:rt.type)||"",signatures:{id:((it=(nt=_==null?void 0:_.identity)==null?void 0:nt.signatures)==null?void 0:it.id)||"",publicKey:((ot=(st=_==null?void 0:_.identity)==null?void 0:st.signatures)==null?void 0:ot.publicKey)||""}},payload:{key:((at=_==null?void 0:_.payload)==null?void 0:at.key)||"",op:((ct=_==null?void 0:_.payload)==null?void 0:ct.op)||"",value:{added:((ft=(ut=_==null?void 0:_.payload)==null?void 0:ut.value)==null?void 0:ft.added)||0,address:((mt=(ht=_==null?void 0:_.payload)==null?void 0:ht.value)==null?void 0:mt.address)||"",name:((Et=(gt=_==null?void 0:_.payload)==null?void 0:gt.value)==null?void 0:Et.name)||"",type:((At=(St=_==null?void 0:_.payload)==null?void 0:St.value)==null?void 0:At.type)||""}}}}function Systems(){const _=useAppDbDispatch(),[o,$]=reactExports.useState(null);return jsxs(Fragment,{children:[jsx(IFPSSystem,{onIpfsReady:$}),jsx(OrbitDbSystem,{ipfs:o,onOrbitDbReady:async()=>{const tt=(await getAllDatabases()).map(rt=>MapOrbitDbEntry(rt));_({type:"init",dbs:tt})}})]})}const matchIconName=/^[a-z0-9]+(-[a-z0-9]+)*$/,stringToIcon=(_,o,$,j="")=>{const et=_.split(":");if(_.slice(0,1)==="@"){if(et.length<2||et.length>3)return null;j=et.shift().slice(1)}if(et.length>3||!et.length)return null;if(et.length>1){const nt=et.pop(),it=et.pop(),st={provider:et.length>0?et[0]:j,prefix:it,name:nt};return o&&!validateIconName(st)?null:st}const tt=et[0],rt=tt.split("-");if(rt.length>1){const nt={provider:j,prefix:rt.shift(),name:rt.join("-")};return o&&!validateIconName(nt)?null:nt}if($&&j===""){const nt={provider:j,prefix:"",name:tt};return o&&!validateIconName(nt,$)?null:nt}return null},validateIconName=(_,o)=>_?!!((_.provider===""||_.provider.match(matchIconName))&&(o&&_.prefix===""||_.prefix.match(matchIconName))&&_.name.match(matchIconName)):!1,defaultIconDimensions=Object.freeze({left:0,top:0,width:16,height:16}),defaultIconTransformations=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),defaultIconProps=Object.freeze({...defaultIconDimensions,...defaultIconTransformations}),defaultExtendedIconProps=Object.freeze({...defaultIconProps,body:"",hidden:!1});function mergeIconTransformations(_,o){const $={};!_.hFlip!=!o.hFlip&&($.hFlip=!0),!_.vFlip!=!o.vFlip&&($.vFlip=!0);const j=((_.rotate||0)+(o.rotate||0))%4;return j&&($.rotate=j),$}function mergeIconData(_,o){const $=mergeIconTransformations(_,o);for(const j in defaultExtendedIconProps)j in defaultIconTransformations?j in _&&!(j in $)&&($[j]=defaultIconTransformations[j]):j in o?$[j]=o[j]:j in _&&($[j]=_[j]);return $}function getIconsTree(_,o){const $=_.icons,j=_.aliases||Object.create(null),et=Object.create(null);function tt(rt){if($[rt])return et[rt]=[];if(!(rt in et)){et[rt]=null;const nt=j[rt]&&j[rt].parent,it=nt&&tt(nt);it&&(et[rt]=[nt].concat(it))}return et[rt]}return(o||Object.keys($).concat(Object.keys(j))).forEach(tt),et}function internalGetIconData(_,o,$){const j=_.icons,et=_.aliases||Object.create(null);let tt={};function rt(nt){tt=mergeIconData(j[nt]||et[nt],tt)}return rt(o),$.forEach(rt),mergeIconData(_,tt)}function parseIconSet(_,o){const $=[];if(typeof _!="object"||typeof _.icons!="object")return $;_.not_found instanceof Array&&_.not_found.forEach(et=>{o(et,null),$.push(et)});const j=getIconsTree(_);for(const et in j){const tt=j[et];tt&&(o(et,internalGetIconData(_,et,tt)),$.push(et))}return $}const optionalPropertyDefaults={provider:"",aliases:{},not_found:{},...defaultIconDimensions};function checkOptionalProps(_,o){for(const $ in o)if($ in _&&typeof _[$]!=typeof o[$])return!1;return!0}function quicklyValidateIconSet(_){if(typeof _!="object"||_===null)return null;const o=_;if(typeof o.prefix!="string"||!_.icons||typeof _.icons!="object"||!checkOptionalProps(_,optionalPropertyDefaults))return null;const $=o.icons;for(const et in $){const tt=$[et];if(!et.match(matchIconName)||typeof tt.body!="string"||!checkOptionalProps(tt,defaultExtendedIconProps))return null}const j=o.aliases||Object.create(null);for(const et in j){const tt=j[et],rt=tt.parent;if(!et.match(matchIconName)||typeof rt!="string"||!$[rt]&&!j[rt]||!checkOptionalProps(tt,defaultExtendedIconProps))return null}return o}const dataStorage=Object.create(null);function newStorage(_,o){return{provider:_,prefix:o,icons:Object.create(null),missing:new Set}}function getStorage(_,o){const $=dataStorage[_]||(dataStorage[_]=Object.create(null));return $[o]||($[o]=newStorage(_,o))}function addIconSet(_,o){return quicklyValidateIconSet(o)?parseIconSet(o,($,j)=>{j?_.icons[$]=j:_.missing.add($)}):[]}function addIconToStorage(_,o,$){try{if(typeof $.body=="string")return _.icons[o]={...$},!0}catch{}return!1}let simpleNames=!1;function allowSimpleNames(_){return typeof _=="boolean"&&(simpleNames=_),simpleNames}function getIconData(_){const o=typeof _=="string"?stringToIcon(_,!0,simpleNames):_;if(o){const $=getStorage(o.provider,o.prefix),j=o.name;return $.icons[j]||($.missing.has(j)?null:void 0)}}function addIcon(_,o){const $=stringToIcon(_,!0,simpleNames);if(!$)return!1;const j=getStorage($.provider,$.prefix);return addIconToStorage(j,$.name,o)}function addCollection(_,o){if(typeof _!="object")return!1;if(typeof o!="string"&&(o=_.provider||""),simpleNames&&!o&&!_.prefix){let et=!1;return quicklyValidateIconSet(_)&&(_.prefix="",parseIconSet(_,(tt,rt)=>{rt&&addIcon(tt,rt)&&(et=!0)})),et}const $=_.prefix;if(!validateIconName({provider:o,prefix:$,name:"a"}))return!1;const j=getStorage(o,$);return!!addIconSet(j,_)}const defaultIconSizeCustomisations=Object.freeze({width:null,height:null}),defaultIconCustomisations=Object.freeze({...defaultIconSizeCustomisations,...defaultIconTransformations}),unitsSplit=/(-?[0-9.]*[0-9]+[0-9.]*)/g,unitsTest=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function calculateSize(_,o,$){if(o===1)return _;if($=$||100,typeof _=="number")return Math.ceil(_*o*$)/$;if(typeof _!="string")return _;const j=_.split(unitsSplit);if(j===null||!j.length)return _;const et=[];let tt=j.shift(),rt=unitsTest.test(tt);for(;;){if(rt){const nt=parseFloat(tt);isNaN(nt)?et.push(tt):et.push(Math.ceil(nt*o*$)/$)}else et.push(tt);if(tt=j.shift(),tt===void 0)return et.join("");rt=!rt}}const isUnsetKeyword=_=>_==="unset"||_==="undefined"||_==="none";function iconToSVG(_,o){const $={...defaultIconProps,..._},j={...defaultIconCustomisations,...o},et={left:$.left,top:$.top,width:$.width,height:$.height};let tt=$.body;[$,j].forEach(ft=>{const ht=[],mt=ft.hFlip,gt=ft.vFlip;let Et=ft.rotate;mt?gt?Et+=2:(ht.push("translate("+(et.width+et.left).toString()+" "+(0-et.top).toString()+")"),ht.push("scale(-1 1)"),et.top=et.left=0):gt&&(ht.push("translate("+(0-et.left).toString()+" "+(et.height+et.top).toString()+")"),ht.push("scale(1 -1)"),et.top=et.left=0);let St;switch(Et<0&&(Et-=Math.floor(Et/4)*4),Et=Et%4,Et){case 1:St=et.height/2+et.top,ht.unshift("rotate(90 "+St.toString()+" "+St.toString()+")");break;case 2:ht.unshift("rotate(180 "+(et.width/2+et.left).toString()+" "+(et.height/2+et.top).toString()+")");break;case 3:St=et.width/2+et.left,ht.unshift("rotate(-90 "+St.toString()+" "+St.toString()+")");break}Et%2===1&&(et.left!==et.top&&(St=et.left,et.left=et.top,et.top=St),et.width!==et.height&&(St=et.width,et.width=et.height,et.height=St)),ht.length&&(tt='<g transform="'+ht.join(" ")+'">'+tt+"</g>")});const rt=j.width,nt=j.height,it=et.width,st=et.height;let ot,at;rt===null?(at=nt===null?"1em":nt==="auto"?st:nt,ot=calculateSize(at,it/st)):(ot=rt==="auto"?it:rt,at=nt===null?calculateSize(ot,st/it):nt==="auto"?st:nt);const ct={},ut=(ft,ht)=>{isUnsetKeyword(ht)||(ct[ft]=ht.toString())};return ut("width",ot),ut("height",at),ct.viewBox=et.left.toString()+" "+et.top.toString()+" "+it.toString()+" "+st.toString(),{attributes:ct,body:tt}}const regex=/\sid="(\S+)"/g,randomPrefix="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let counter=0;function replaceIDs(_,o=randomPrefix){const $=[];let j;for(;j=regex.exec(_);)$.push(j[1]);if(!$.length)return _;const et="suffix"+(Math.random()*16777216|Date.now()).toString(16);return $.forEach(tt=>{const rt=typeof o=="function"?o(tt):o+(counter++).toString(),nt=tt.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");_=_.replace(new RegExp('([#;"])('+nt+')([")]|\\.[a-z])',"g"),"$1"+rt+et+"$3")}),_=_.replace(new RegExp(et,"g"),""),_}const storage=Object.create(null);function setAPIModule(_,o){storage[_]=o}function getAPIModule(_){return storage[_]||storage[""]}function createAPIConfig(_){let o;if(typeof _.resources=="string")o=[_.resources];else if(o=_.resources,!(o instanceof Array)||!o.length)return null;return{resources:o,path:_.path||"/",maxURL:_.maxURL||500,rotate:_.rotate||750,timeout:_.timeout||5e3,random:_.random===!0,index:_.index||0,dataAfterTimeout:_.dataAfterTimeout!==!1}}const configStorage=Object.create(null),fallBackAPISources=["https://api.simplesvg.com","https://api.unisvg.com"],fallBackAPI=[];for(;fallBackAPISources.length>0;)fallBackAPISources.length===1||Math.random()>.5?fallBackAPI.push(fallBackAPISources.shift()):fallBackAPI.push(fallBackAPISources.pop());configStorage[""]=createAPIConfig({resources:["https://api.iconify.design"].concat(fallBackAPI)});function addAPIProvider(_,o){const $=createAPIConfig(o);return $===null?!1:(configStorage[_]=$,!0)}function getAPIConfig(_){return configStorage[_]}const detectFetch=()=>{let _;try{if(_=fetch,typeof _=="function")return _}catch{}};let fetchModule=detectFetch();function calculateMaxLength(_,o){const $=getAPIConfig(_);if(!$)return 0;let j;if(!$.maxURL)j=0;else{let et=0;$.resources.forEach(rt=>{et=Math.max(et,rt.length)});const tt=o+".json?icons=";j=$.maxURL-et-$.path.length-tt.length}return j}function shouldAbort(_){return _===404}const prepare=(_,o,$)=>{const j=[],et=calculateMaxLength(_,o),tt="icons";let rt={type:tt,provider:_,prefix:o,icons:[]},nt=0;return $.forEach((it,st)=>{nt+=it.length+1,nt>=et&&st>0&&(j.push(rt),rt={type:tt,provider:_,prefix:o,icons:[]},nt=it.length),rt.icons.push(it)}),j.push(rt),j};function getPath(_){if(typeof _=="string"){const o=getAPIConfig(_);if(o)return o.path}return"/"}const send=(_,o,$)=>{if(!fetchModule){$("abort",424);return}let j=getPath(o.provider);switch(o.type){case"icons":{const tt=o.prefix,nt=o.icons.join(","),it=new URLSearchParams({icons:nt});j+=tt+".json?"+it.toString();break}case"custom":{const tt=o.uri;j+=tt.slice(0,1)==="/"?tt.slice(1):tt;break}default:$("abort",400);return}let et=503;fetchModule(_+j).then(tt=>{const rt=tt.status;if(rt!==200){setTimeout(()=>{$(shouldAbort(rt)?"abort":"next",rt)});return}return et=501,tt.json()}).then(tt=>{if(typeof tt!="object"||tt===null){setTimeout(()=>{tt===404?$("abort",tt):$("next",et)});return}setTimeout(()=>{$("success",tt)})}).catch(()=>{$("next",et)})},fetchAPIModule={prepare,send};function sortIcons(_){const o={loaded:[],missing:[],pending:[]},$=Object.create(null);_.sort((et,tt)=>et.provider!==tt.provider?et.provider.localeCompare(tt.provider):et.prefix!==tt.prefix?et.prefix.localeCompare(tt.prefix):et.name.localeCompare(tt.name));let j={provider:"",prefix:"",name:""};return _.forEach(et=>{if(j.name===et.name&&j.prefix===et.prefix&&j.provider===et.provider)return;j=et;const tt=et.provider,rt=et.prefix,nt=et.name,it=$[tt]||($[tt]=Object.create(null)),st=it[rt]||(it[rt]=getStorage(tt,rt));let ot;nt in st.icons?ot=o.loaded:rt===""||st.missing.has(nt)?ot=o.missing:ot=o.pending;const at={provider:tt,prefix:rt,name:nt};ot.push(at)}),o}function removeCallback(_,o){_.forEach($=>{const j=$.loaderCallbacks;j&&($.loaderCallbacks=j.filter(et=>et.id!==o))})}function updateCallbacks(_){_.pendingCallbacksFlag||(_.pendingCallbacksFlag=!0,setTimeout(()=>{_.pendingCallbacksFlag=!1;const o=_.loaderCallbacks?_.loaderCallbacks.slice(0):[];if(!o.length)return;let $=!1;const j=_.provider,et=_.prefix;o.forEach(tt=>{const rt=tt.icons,nt=rt.pending.length;rt.pending=rt.pending.filter(it=>{if(it.prefix!==et)return!0;const st=it.name;if(_.icons[st])rt.loaded.push({provider:j,prefix:et,name:st});else if(_.missing.has(st))rt.missing.push({provider:j,prefix:et,name:st});else return $=!0,!0;return!1}),rt.pending.length!==nt&&($||removeCallback([_],tt.id),tt.callback(rt.loaded.slice(0),rt.missing.slice(0),rt.pending.slice(0),tt.abort))})}))}let idCounter=0;function storeCallback(_,o,$){const j=idCounter++,et=removeCallback.bind(null,$,j);if(!o.pending.length)return et;const tt={id:j,icons:o,callback:_,abort:et};return $.forEach(rt=>{(rt.loaderCallbacks||(rt.loaderCallbacks=[])).push(tt)}),et}function listToIcons(_,o=!0,$=!1){const j=[];return _.forEach(et=>{const tt=typeof et=="string"?stringToIcon(et,o,$):et;tt&&j.push(tt)}),j}var defaultConfig={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function sendQuery(_,o,$,j){const et=_.resources.length,tt=_.random?Math.floor(Math.random()*et):_.index;let rt;if(_.random){let Rt=_.resources.slice(0);for(rt=[];Rt.length>1;){const Tt=Math.floor(Math.random()*Rt.length);rt.push(Rt[Tt]),Rt=Rt.slice(0,Tt).concat(Rt.slice(Tt+1))}rt=rt.concat(Rt)}else rt=_.resources.slice(tt).concat(_.resources.slice(0,tt));const nt=Date.now();let it="pending",st=0,ot,at=null,ct=[],ut=[];typeof j=="function"&&ut.push(j);function ft(){at&&(clearTimeout(at),at=null)}function ht(){it==="pending"&&(it="aborted"),ft(),ct.forEach(Rt=>{Rt.status==="pending"&&(Rt.status="aborted")}),ct=[]}function mt(Rt,Tt){Tt&&(ut=[]),typeof Rt=="function"&&ut.push(Rt)}function gt(){return{startTime:nt,payload:o,status:it,queriesSent:st,queriesPending:ct.length,subscribe:mt,abort:ht}}function Et(){it="failed",ut.forEach(Rt=>{Rt(void 0,ot)})}function St(){ct.forEach(Rt=>{Rt.status==="pending"&&(Rt.status="aborted")}),ct=[]}function At(Rt,Tt,Dt){const Ot=Tt!=="success";switch(ct=ct.filter(jt=>jt!==Rt),it){case"pending":break;case"failed":if(Ot||!_.dataAfterTimeout)return;break;default:return}if(Tt==="abort"){ot=Dt,Et();return}if(Ot){ot=Dt,ct.length||(rt.length?kt():Et());return}if(ft(),St(),!_.random){const jt=_.resources.indexOf(Rt.resource);jt!==-1&&jt!==_.index&&(_.index=jt)}it="completed",ut.forEach(jt=>{jt(Dt)})}function kt(){if(it!=="pending")return;ft();const Rt=rt.shift();if(Rt===void 0){if(ct.length){at=setTimeout(()=>{ft(),it==="pending"&&(St(),Et())},_.timeout);return}Et();return}const Tt={status:"pending",resource:Rt,callback:(Dt,Ot)=>{At(Tt,Dt,Ot)}};ct.push(Tt),st++,at=setTimeout(kt,_.rotate),$(Rt,o,Tt.callback)}return setTimeout(kt),gt}function initRedundancy(_){const o={...defaultConfig,..._};let $=[];function j(){$=$.filter(nt=>nt().status==="pending")}function et(nt,it,st){const ot=sendQuery(o,nt,it,(at,ct)=>{j(),st&&st(at,ct)});return $.push(ot),ot}function tt(nt){return $.find(it=>nt(it))||null}return{query:et,find:tt,setIndex:nt=>{o.index=nt},getIndex:()=>o.index,cleanup:j}}function emptyCallback$1(){}const redundancyCache=Object.create(null);function getRedundancyCache(_){if(!redundancyCache[_]){const o=getAPIConfig(_);if(!o)return;const $=initRedundancy(o),j={config:o,redundancy:$};redundancyCache[_]=j}return redundancyCache[_]}function sendAPIQuery(_,o,$){let j,et;if(typeof _=="string"){const tt=getAPIModule(_);if(!tt)return $(void 0,424),emptyCallback$1;et=tt.send;const rt=getRedundancyCache(_);rt&&(j=rt.redundancy)}else{const tt=createAPIConfig(_);if(tt){j=initRedundancy(tt);const rt=_.resources?_.resources[0]:"",nt=getAPIModule(rt);nt&&(et=nt.send)}}return!j||!et?($(void 0,424),emptyCallback$1):j.query(o,et,$)().abort}const browserCacheVersion="iconify2",browserCachePrefix="iconify",browserCacheCountKey=browserCachePrefix+"-count",browserCacheVersionKey=browserCachePrefix+"-version",browserStorageHour=36e5,browserStorageCacheExpiration=168;function getStoredItem(_,o){try{return _.getItem(o)}catch{}}function setStoredItem(_,o,$){try{return _.setItem(o,$),!0}catch{}}function removeStoredItem(_,o){try{_.removeItem(o)}catch{}}function setBrowserStorageItemsCount(_,o){return setStoredItem(_,browserCacheCountKey,o.toString())}function getBrowserStorageItemsCount(_){return parseInt(getStoredItem(_,browserCacheCountKey))||0}const browserStorageConfig={local:!0,session:!0},browserStorageEmptyItems={local:new Set,session:new Set};let browserStorageStatus=!1;function setBrowserStorageStatus(_){browserStorageStatus=_}let _window=typeof window>"u"?{}:window;function getBrowserStorage(_){const o=_+"Storage";try{if(_window&&_window[o]&&typeof _window[o].length=="number")return _window[o]}catch{}browserStorageConfig[_]=!1}function iterateBrowserStorage(_,o){const $=getBrowserStorage(_);if(!$)return;const j=getStoredItem($,browserCacheVersionKey);if(j!==browserCacheVersion){if(j){const nt=getBrowserStorageItemsCount($);for(let it=0;it<nt;it++)removeStoredItem($,browserCachePrefix+it.toString())}setStoredItem($,browserCacheVersionKey,browserCacheVersion),setBrowserStorageItemsCount($,0);return}const et=Math.floor(Date.now()/browserStorageHour)-browserStorageCacheExpiration,tt=nt=>{const it=browserCachePrefix+nt.toString(),st=getStoredItem($,it);if(typeof st=="string"){try{const ot=JSON.parse(st);if(typeof ot=="object"&&typeof ot.cached=="number"&&ot.cached>et&&typeof ot.provider=="string"&&typeof ot.data=="object"&&typeof ot.data.prefix=="string"&&o(ot,nt))return!0}catch{}removeStoredItem($,it)}};let rt=getBrowserStorageItemsCount($);for(let nt=rt-1;nt>=0;nt--)tt(nt)||(nt===rt-1?(rt--,setBrowserStorageItemsCount($,rt)):browserStorageEmptyItems[_].add(nt))}function initBrowserStorage(){if(!browserStorageStatus){setBrowserStorageStatus(!0);for(const _ in browserStorageConfig)iterateBrowserStorage(_,o=>{const $=o.data,j=o.provider,et=$.prefix,tt=getStorage(j,et);if(!addIconSet(tt,$).length)return!1;const rt=$.lastModified||-1;return tt.lastModifiedCached=tt.lastModifiedCached?Math.min(tt.lastModifiedCached,rt):rt,!0})}}function updateLastModified(_,o){const $=_.lastModifiedCached;if($&&$>=o)return $===o;if(_.lastModifiedCached=o,$)for(const j in browserStorageConfig)iterateBrowserStorage(j,et=>{const tt=et.data;return et.provider!==_.provider||tt.prefix!==_.prefix||tt.lastModified===o});return!0}function storeInBrowserStorage(_,o){browserStorageStatus||initBrowserStorage();function $(j){let et;if(!browserStorageConfig[j]||!(et=getBrowserStorage(j)))return;const tt=browserStorageEmptyItems[j];let rt;if(tt.size)tt.delete(rt=Array.from(tt).shift());else if(rt=getBrowserStorageItemsCount(et),!setBrowserStorageItemsCount(et,rt+1))return;const nt={cached:Math.floor(Date.now()/browserStorageHour),provider:_.provider,data:o};return setStoredItem(et,browserCachePrefix+rt.toString(),JSON.stringify(nt))}o.lastModified&&!updateLastModified(_,o.lastModified)||Object.keys(o.icons).length&&(o.not_found&&(o=Object.assign({},o),delete o.not_found),$("local")||$("session"))}function emptyCallback(){}function loadedNewIcons(_){_.iconsLoaderFlag||(_.iconsLoaderFlag=!0,setTimeout(()=>{_.iconsLoaderFlag=!1,updateCallbacks(_)}))}function loadNewIcons(_,o){_.iconsToLoad?_.iconsToLoad=_.iconsToLoad.concat(o).sort():_.iconsToLoad=o,_.iconsQueueFlag||(_.iconsQueueFlag=!0,setTimeout(()=>{_.iconsQueueFlag=!1;const{provider:$,prefix:j}=_,et=_.iconsToLoad;delete _.iconsToLoad;let tt;if(!et||!(tt=getAPIModule($)))return;tt.prepare($,j,et).forEach(nt=>{sendAPIQuery($,nt,it=>{if(typeof it!="object")nt.icons.forEach(st=>{_.missing.add(st)});else try{const st=addIconSet(_,it);if(!st.length)return;const ot=_.pendingIcons;ot&&st.forEach(at=>{ot.delete(at)}),storeInBrowserStorage(_,it)}catch(st){console.error(st)}loadedNewIcons(_)})})}))}const loadIcons=(_,o)=>{const $=listToIcons(_,!0,allowSimpleNames()),j=sortIcons($);if(!j.pending.length){let it=!0;return o&&setTimeout(()=>{it&&o(j.loaded,j.missing,j.pending,emptyCallback)}),()=>{it=!1}}const et=Object.create(null),tt=[];let rt,nt;return j.pending.forEach(it=>{const{provider:st,prefix:ot}=it;if(ot===nt&&st===rt)return;rt=st,nt=ot,tt.push(getStorage(st,ot));const at=et[st]||(et[st]=Object.create(null));at[ot]||(at[ot]=[])}),j.pending.forEach(it=>{const{provider:st,prefix:ot,name:at}=it,ct=getStorage(st,ot),ut=ct.pendingIcons||(ct.pendingIcons=new Set);ut.has(at)||(ut.add(at),et[st][ot].push(at))}),tt.forEach(it=>{const{provider:st,prefix:ot}=it;et[st][ot].length&&loadNewIcons(it,et[st][ot])}),o?storeCallback(o,j,tt):emptyCallback};function mergeCustomisations(_,o){const $={..._};for(const j in o){const et=o[j],tt=typeof et;j in defaultIconSizeCustomisations?(et===null||et&&(tt==="string"||tt==="number"))&&($[j]=et):tt===typeof $[j]&&($[j]=j==="rotate"?et%4:et)}return $}const separator=/[\s,]+/;function flipFromString(_,o){o.split(separator).forEach($=>{switch($.trim()){case"horizontal":_.hFlip=!0;break;case"vertical":_.vFlip=!0;break}})}function rotateFromString(_,o=0){const $=_.replace(/^-?[0-9.]*/,"");function j(et){for(;et<0;)et+=4;return et%4}if($===""){const et=parseInt(_);return isNaN(et)?0:j(et)}else if($!==_){let et=0;switch($){case"%":et=25;break;case"deg":et=90}if(et){let tt=parseFloat(_.slice(0,_.length-$.length));return isNaN(tt)?0:(tt=tt/et,tt%1===0?j(tt):0)}}return o}function iconToHTML(_,o){let $=_.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const j in o)$+=" "+j+'="'+o[j]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+$+">"+_+"</svg>"}function encodeSVGforURL(_){return _.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function svgToURL(_){return'url("data:image/svg+xml,'+encodeSVGforURL(_)+'")'}const defaultExtendedIconCustomisations={...defaultIconCustomisations,inline:!1},svgDefaults={xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},commonProps={display:"inline-block"},monotoneProps={backgroundColor:"currentColor"},coloredProps={backgroundColor:"transparent"},propsToAdd={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},propsToAddTo={webkitMask:monotoneProps,mask:monotoneProps,background:coloredProps};for(const _ in propsToAddTo){const o=propsToAddTo[_];for(const $ in propsToAdd)o[_+$]=propsToAdd[$]}const inlineDefaults={...defaultExtendedIconCustomisations,inline:!0};function fixSize(_){return _+(_.match(/^[-0-9.]+$/)?"px":"")}const render=(_,o,$,j)=>{const et=$?inlineDefaults:defaultExtendedIconCustomisations,tt=mergeCustomisations(et,o),rt=o.mode||"svg",nt={},it=o.style||{},st={...rt==="svg"?svgDefaults:{},ref:j};for(let gt in o){const Et=o[gt];if(Et!==void 0)switch(gt){case"icon":case"style":case"children":case"onLoad":case"mode":case"_ref":case"_inline":break;case"inline":case"hFlip":case"vFlip":tt[gt]=Et===!0||Et==="true"||Et===1;break;case"flip":typeof Et=="string"&&flipFromString(tt,Et);break;case"color":nt.color=Et;break;case"rotate":typeof Et=="string"?tt[gt]=rotateFromString(Et):typeof Et=="number"&&(tt[gt]=Et);break;case"ariaHidden":case"aria-hidden":Et!==!0&&Et!=="true"&&delete st["aria-hidden"];break;default:et[gt]===void 0&&(st[gt]=Et)}}const ot=iconToSVG(_,tt),at=ot.attributes;if(tt.inline&&(nt.verticalAlign="-0.125em"),rt==="svg"){st.style={...nt,...it},Object.assign(st,at);let gt=0,Et=o.id;return typeof Et=="string"&&(Et=Et.replace(/-/g,"_")),st.dangerouslySetInnerHTML={__html:replaceIDs(ot.body,Et?()=>Et+"ID"+gt++:"iconifyReact")},React.createElement("svg",st)}const{body:ct,width:ut,height:ft}=_,ht=rt==="mask"||(rt==="bg"?!1:ct.indexOf("currentColor")!==-1),mt=iconToHTML(ct,{...at,width:ut+"",height:ft+""});return st.style={...nt,"--svg":svgToURL(mt),width:fixSize(at.width),height:fixSize(at.height),...commonProps,...ht?monotoneProps:coloredProps,...it},React.createElement("span",st)};allowSimpleNames(!0);setAPIModule("",fetchAPIModule);if(typeof document<"u"&&typeof window<"u"){initBrowserStorage();const _=window;if(_.IconifyPreload!==void 0){const o=_.IconifyPreload,$="Invalid IconifyPreload syntax.";typeof o=="object"&&o!==null&&(o instanceof Array?o:[o]).forEach(j=>{try{(typeof j!="object"||j===null||j instanceof Array||typeof j.icons!="object"||typeof j.prefix!="string"||!addCollection(j))&&console.error($)}catch{console.error($)}})}if(_.IconifyProviders!==void 0){const o=_.IconifyProviders;if(typeof o=="object"&&o!==null)for(let $ in o){const j="IconifyProviders["+$+"] is invalid.";try{const et=o[$];if(typeof et!="object"||!et||et.resources===void 0)continue;addAPIProvider($,et)||console.error(j)}catch{console.error(j)}}}}class IconComponent extends React.Component{constructor(o){super(o),this.state={icon:null}}_abortLoading(){this._loading&&(this._loading.abort(),this._loading=null)}_setData(o){this.state.icon!==o&&this.setState({icon:o})}_checkIcon(o){const $=this.state,j=this.props.icon;if(typeof j=="object"&&j!==null&&typeof j.body=="string"){this._icon="",this._abortLoading(),(o||$.icon===null)&&this._setData({data:j});return}let et;if(typeof j!="string"||(et=stringToIcon(j,!1,!0))===null){this._abortLoading(),this._setData(null);return}const tt=getIconData(et);if(!tt){(!this._loading||this._loading.name!==j)&&(this._abortLoading(),this._icon="",this._setData(null),tt!==null&&(this._loading={name:j,abort:loadIcons([et],this._checkIcon.bind(this,!1))}));return}if(this._icon!==j||$.icon===null){this._abortLoading(),this._icon=j;const rt=["iconify"];et.prefix!==""&&rt.push("iconify--"+et.prefix),et.provider!==""&&rt.push("iconify--"+et.provider),this._setData({data:tt,classes:rt}),this.props.onLoad&&this.props.onLoad(j)}}componentDidMount(){this._checkIcon(!1)}componentDidUpdate(o){o.icon!==this.props.icon&&this._checkIcon(!0)}componentWillUnmount(){this._abortLoading()}render(){const o=this.props,$=this.state.icon;if($===null)return o.children?o.children:React.createElement("span",{});let j=o;return $.classes&&(j={...o,className:(typeof o.className=="string"?o.className+" ":"")+$.classes.join(" ")}),render({...defaultIconProps,...$.data},j,o._inline,o._ref)}}const Icon=React.forwardRef(function _(o,$){const j={...o,_ref:$,_inline:!1};return React.createElement(IconComponent,j)});React.forwardRef(function _(o,$){const j={...o,_ref:$,_inline:!0};return React.createElement(IconComponent,j)});function SvgIconify({icon:_,sx:o,rotate:$=180,width:j=24,height:et=24,color:tt,...rt}){const{colorMode:nt}=useColorMode(),[it,st]=useToken("colors",["gray.600","gray.500"]);return jsx(Box,{...rt,children:jsx(Icon,{icon:_,rotate:$,width:j,height:et,color:tt||(nt==="light"?it:st)})})}const HeaderLayout=({children:_})=>{const o=useColorModeValue("gray.50","gray.800"),$=useColorModeValue("gray.100","gray.700");return jsxs(Flex,{direction:"column",w:"full",h:"100vh",children:[jsxs(chakra.div,{bg:o,children:[jsxs(Flex,{minWidth:"max-content",alignItems:"center",gap:"2",children:[jsx(Link,{as:Link$1,to:"/",textDecoration:"none",children:jsxs(HStack,{p:"2",children:[jsx(Avatar,{size:"md",name:"Orbit",src:"/orbit-db.png"}),jsx(Heading,{children:"OrbitDB Control Center"})]})}),jsx(Spacer,{}),jsx(ColorModeToggle,{}),jsx(IconButton,{as:Link$1,target:"_blank",to:"https://github.com/davidramos-om/orbit-db-control-center","aria-label":"GitHub repository",icon:jsx(SvgIconify,{icon:"bi:github"})})]}),jsx(Divider,{}),jsx(Flex,{minWidth:"max-content",alignItems:"center",gap:"2",children:jsxs(HStack,{spacing:1,p:2,children:[jsx(Text,{as:"b",children:"System Status:"}),jsx(Systems,{})]})})]}),jsx(Divider,{}),jsx(Box,{p:4,bg:$,children:_}),jsx(AppLogs,{})]})},scriptRel="modulepreload",assetsURL=function(_){return"/orbit-db/"+_},seen={},__vitePreload=function _(o,$,j){if(!$||$.length===0)return o();const et=document.getElementsByTagName("link");return Promise.all($.map(tt=>{if(tt=assetsURL(tt),tt in seen)return;seen[tt]=!0;const rt=tt.endsWith(".css"),nt=rt?'[rel="stylesheet"]':"";if(!!j)for(let ot=et.length-1;ot>=0;ot--){const at=et[ot];if(at.href===tt&&(!rt||at.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${tt}"]${nt}`))return;const st=document.createElement("link");if(st.rel=rt?"stylesheet":scriptRel,rt||(st.as="script",st.crossOrigin=""),st.href=tt,document.head.appendChild(st),rt)return new Promise((ot,at)=>{st.addEventListener("load",ot),st.addEventListener("error",()=>at(new Error(`Unable to preload CSS for ${tt}`)))})})).then(()=>o())};function CreateDbDialog(){const _=useToast(),o=useAppDbDispatch(),$=useAppLogDispatch(),{isOpen:j,onOpen:et,onClose:tt}=useDisclosure(),rt=reactExports.useRef(),[nt,it]=useControllableState({defaultValue:""}),[st,ot]=useControllableState({defaultValue:""}),[at,ct]=useControllableState({defaultValue:""}),ut=async()=>{try{if(!nt||!st||!at){_({position:"top",description:"Please enter all the fields",status:"error",isClosable:!0});return}const{db:ft}=await createDatabase({name:nt,type:st,permissions:at}),ht=MapOrbitDbEntry(ft);o({type:"added",db:ht}),$({type:"add",log:{id:ht.payload.value.address,text:`Created new database ${ht.payload.value.name}`,type:"created"}}),tt()}catch(ft){$({type:"add",log:{text:`Failed to create database ${nt} : ${(ft==null?void 0:ft.message)||"Something went wrong"}`,type:"error"}})}};return jsxs(Fragment,{children:[jsx(Button,{variant:"solid",colorScheme:"pink",onClick:et,children:"New Database"}),jsx(AlertDialog,{motionPreset:"slideInBottom",isOpen:j,leastDestructiveRef:rt,onClose:tt,size:"xl",children:jsx(ModalOverlay,{children:jsxs(AlertDialogContent,{children:[jsx(ModalHeader,{fontSize:"lg",fontWeight:"bold",children:"Create Database"}),jsx(ModalCloseButton,{}),jsx(ModalBody,{children:jsxs(Stack,{spacing:4,children:[jsxs(FormControl,{id:"dbname",children:[jsx(FormLabel,{children:"Database Name"}),jsx(Input,{type:"text",placeholder:"Enter database name",value:nt,onChange:ft=>it(ft.target.value)})]}),jsxs(FormControl,{id:"dbtype",children:[jsx(FormLabel,{children:"Database type"}),jsx(Select,{placeholder:"Select option",value:st,onChange:ft=>ot(ft.target.value),children:DbTypeExtendedDescription.map(ft=>jsx("option",{value:ft.type,children:`${ft.type} : ${ft.description}`},ft.type))})]}),jsxs(FormControl,{id:"permission",children:[jsx(FormLabel,{children:"Write Permissions"}),jsx(Select,{placeholder:"Select option",value:at,onChange:ft=>ct(ft.target.value),children:DBPermissionExtendedDescription.map(ft=>jsx("option",{value:ft.type,children:`${ft.type} : ${ft.description}`},ft.type))})]})]})}),jsxs(ModalFooter,{children:[jsx(Button,{ref:rt,onClick:tt,children:"Cancel"}),jsx(Button,{colorScheme:"pink",onClick:ut,ml:3,children:"Create"})]})]})})})]})}var sweetalert2_allExports={},sweetalert2_all={get exports(){return sweetalert2_allExports},set exports(_){sweetalert2_allExports=_}};/*!
* sweetalert2 v11.7.3
* Released under the MIT License.
*/(function(_,o){(function($,j){_.exports=j()})(commonjsGlobal,function(){var $={awaitingPromise:new WeakMap,promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const j="swal2-",et=Ht=>{const Kt={};for(const Jt in Ht)Kt[Ht[Jt]]=j+Ht[Jt];return Kt},tt=et(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),rt=et(["success","warning","info","question","error"]),nt="SweetAlert2:",it=Ht=>{const Kt=[];for(let Jt=0;Jt<Ht.length;Jt++)Kt.indexOf(Ht[Jt])===-1&&Kt.push(Ht[Jt]);return Kt},st=Ht=>Ht.charAt(0).toUpperCase()+Ht.slice(1),ot=Ht=>{console.warn(`${nt} ${typeof Ht=="object"?Ht.join(" "):Ht}`)},at=Ht=>{console.error(`${nt} ${Ht}`)},ct=[],ut=Ht=>{ct.includes(Ht)||(ct.push(Ht),ot(Ht))},ft=(Ht,Kt)=>{ut(`"${Ht}" is deprecated and will be removed in the next major release. Please use "${Kt}" instead.`)},ht=Ht=>typeof Ht=="function"?Ht():Ht,mt=Ht=>Ht&&typeof Ht.toPromise=="function",gt=Ht=>mt(Ht)?Ht.toPromise():Promise.resolve(Ht),Et=Ht=>Ht&&Promise.resolve(Ht)===Ht,St=()=>document.body.querySelector(`.${tt.container}`),At=Ht=>{const Kt=St();return Kt?Kt.querySelector(Ht):null},kt=Ht=>At(`.${Ht}`),Rt=()=>kt(tt.popup),Tt=()=>kt(tt.icon),Dt=()=>kt(tt["icon-content"]),Ot=()=>kt(tt.title),jt=()=>kt(tt["html-container"]),Nt=()=>kt(tt.image),It=()=>kt(tt["progress-steps"]),yt=()=>kt(tt["validation-message"]),lt=()=>At(`.${tt.actions} .${tt.confirm}`),pt=()=>At(`.${tt.actions} .${tt.cancel}`),bt=()=>At(`.${tt.actions} .${tt.deny}`),_t=()=>kt(tt["input-label"]),$t=()=>At(`.${tt.loader}`),Ct=()=>kt(tt.actions),xt=()=>kt(tt.footer),vt=()=>kt(tt["timer-progress-bar"]),dt=()=>kt(tt.close),wt=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,qt=()=>{const Ht=Array.from(Rt().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((Jt,dr)=>{const kr=parseInt(Jt.getAttribute("tabindex")),rn=parseInt(dr.getAttribute("tabindex"));return kr>rn?1:kr<rn?-1:0}),Kt=Array.from(Rt().querySelectorAll(wt)).filter(Jt=>Jt.getAttribute("tabindex")!=="-1");return it(Ht.concat(Kt)).filter(Jt=>vr(Jt))},Pt=()=>Mt(document.body,tt.shown)&&!Mt(document.body,tt["toast-shown"])&&!Mt(document.body,tt["no-backdrop"]),Gt=()=>Rt()&&Mt(Rt(),tt.toast),Wt=()=>Rt().hasAttribute("data-loading"),Vt={previousBodyPadding:null},Ut=(Ht,Kt)=>{if(Ht.textContent="",Kt){const dr=new DOMParser().parseFromString(Kt,"text/html");Array.from(dr.querySelector("head").childNodes).forEach(kr=>{Ht.appendChild(kr)}),Array.from(dr.querySelector("body").childNodes).forEach(kr=>{kr instanceof HTMLVideoElement||kr instanceof HTMLAudioElement?Ht.appendChild(kr.cloneNode(!0)):Ht.appendChild(kr)})}},Mt=(Ht,Kt)=>{if(!Kt)return!1;const Jt=Kt.split(/\s+/);for(let dr=0;dr<Jt.length;dr++)if(!Ht.classList.contains(Jt[dr]))return!1;return!0},Lt=(Ht,Kt)=>{Array.from(Ht.classList).forEach(Jt=>{!Object.values(tt).includes(Jt)&&!Object.values(rt).includes(Jt)&&!Object.values(Kt.showClass).includes(Jt)&&Ht.classList.remove(Jt)})},Yt=(Ht,Kt,Jt)=>{if(Lt(Ht,Kt),Kt.customClass&&Kt.customClass[Jt]){if(typeof Kt.customClass[Jt]!="string"&&!Kt.customClass[Jt].forEach){ot(`Invalid type of customClass.${Jt}! Expected string or iterable object, got "${typeof Kt.customClass[Jt]}"`);return}Zt(Ht,Kt.customClass[Jt])}},lr=(Ht,Kt)=>{if(!Kt)return null;switch(Kt){case"select":case"textarea":case"file":return Ht.querySelector(`.${tt.popup} > .${tt[Kt]}`);case"checkbox":return Ht.querySelector(`.${tt.popup} > .${tt.checkbox} input`);case"radio":return Ht.querySelector(`.${tt.popup} > .${tt.radio} input:checked`)||Ht.querySelector(`.${tt.popup} > .${tt.radio} input:first-child`);case"range":return Ht.querySelector(`.${tt.popup} > .${tt.range} input`);default:return Ht.querySelector(`.${tt.popup} > .${tt.input}`)}},cr=Ht=>{if(Ht.focus(),Ht.type!=="file"){const Kt=Ht.value;Ht.value="",Ht.value=Kt}},ir=(Ht,Kt,Jt)=>{!Ht||!Kt||(typeof Kt=="string"&&(Kt=Kt.split(/\s+/).filter(Boolean)),Kt.forEach(dr=>{Array.isArray(Ht)?Ht.forEach(kr=>{Jt?kr.classList.add(dr):kr.classList.remove(dr)}):Jt?Ht.classList.add(dr):Ht.classList.remove(dr)}))},Zt=(Ht,Kt)=>{ir(Ht,Kt,!0)},Bt=(Ht,Kt)=>{ir(Ht,Kt,!1)},Ft=(Ht,Kt)=>{const Jt=Array.from(Ht.children);for(let dr=0;dr<Jt.length;dr++){const kr=Jt[dr];if(kr instanceof HTMLElement&&Mt(kr,Kt))return kr}},zt=(Ht,Kt,Jt)=>{Jt===`${parseInt(Jt)}`&&(Jt=parseInt(Jt)),Jt||parseInt(Jt)===0?Ht.style[Kt]=typeof Jt=="number"?`${Jt}px`:Jt:Ht.style.removeProperty(Kt)},Qt=function(Ht){let Kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";Ht.style.display=Kt},nr=Ht=>{Ht.style.display="none"},gr=(Ht,Kt,Jt,dr)=>{const kr=Ht.querySelector(Kt);kr&&(kr.style[Jt]=dr)},br=function(Ht,Kt){let Jt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";Kt?Qt(Ht,Jt):nr(Ht)},vr=Ht=>!!(Ht&&(Ht.offsetWidth||Ht.offsetHeight||Ht.getClientRects().length)),Nr=()=>!vr(lt())&&!vr(bt())&&!vr(pt()),ar=Ht=>Ht.scrollHeight>Ht.clientHeight,er=Ht=>{const Kt=window.getComputedStyle(Ht),Jt=parseFloat(Kt.getPropertyValue("animation-duration")||"0"),dr=parseFloat(Kt.getPropertyValue("transition-duration")||"0");return Jt>0||dr>0},Xt=function(Ht){let Kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const Jt=vt();vr(Jt)&&(Kt&&(Jt.style.transition="none",Jt.style.width="100%"),setTimeout(()=>{Jt.style.transition=`width ${Ht/1e3}s linear`,Jt.style.width="0%"},10))},tr=()=>{const Ht=vt(),Kt=parseInt(window.getComputedStyle(Ht).width);Ht.style.removeProperty("transition"),Ht.style.width="100%";const Jt=parseInt(window.getComputedStyle(Ht).width),dr=Kt/Jt*100;Ht.style.width=`${dr}%`},ur=100,pr={},yr=()=>{pr.previousActiveElement instanceof HTMLElement?(pr.previousActiveElement.focus(),pr.previousActiveElement=null):document.body&&document.body.focus()},wr=Ht=>new Promise(Kt=>{if(!Ht)return Kt();const Jt=window.scrollX,dr=window.scrollY;pr.restoreFocusTimeout=setTimeout(()=>{yr(),Kt()},ur),window.scrollTo(Jt,dr)}),Gr=()=>typeof window>"u"||typeof document>"u",$r=`
 <div aria-labelledby="${tt.title}" aria-describedby="${tt["html-container"]}" class="${tt.popup}" tabindex="-1">
   <button type="button" class="${tt.close}"></button>
   <ul class="${tt["progress-steps"]}"></ul>
   <div class="${tt.icon}"></div>
   <img class="${tt.image}" />
   <h2 class="${tt.title}" id="${tt.title}"></h2>
   <div class="${tt["html-container"]}" id="${tt["html-container"]}"></div>
   <input class="${tt.input}" />
   <input type="file" class="${tt.file}" />
   <div class="${tt.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${tt.select}"></select>
   <div class="${tt.radio}"></div>
   <label for="${tt.checkbox}" class="${tt.checkbox}">
     <input type="checkbox" />
     <span class="${tt.label}"></span>
   </label>
   <textarea class="${tt.textarea}"></textarea>
   <div class="${tt["validation-message"]}" id="${tt["validation-message"]}"></div>
   <div class="${tt.actions}">
     <div class="${tt.loader}"></div>
     <button type="button" class="${tt.confirm}"></button>
     <button type="button" class="${tt.deny}"></button>
     <button type="button" class="${tt.cancel}"></button>
   </div>
   <div class="${tt.footer}"></div>
   <div class="${tt["timer-progress-bar-container"]}">
     <div class="${tt["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),Er=()=>{const Ht=St();return Ht?(Ht.remove(),Bt([document.documentElement,document.body],[tt["no-backdrop"],tt["toast-shown"],tt["has-column"]]),!0):!1},Wr=()=>{pr.currentInstance.resetValidationMessage()},Vr=()=>{const Ht=Rt(),Kt=Ft(Ht,tt.input),Jt=Ft(Ht,tt.file),dr=Ht.querySelector(`.${tt.range} input`),kr=Ht.querySelector(`.${tt.range} output`),rn=Ft(Ht,tt.select),wn=Ht.querySelector(`.${tt.checkbox} input`),Fn=Ft(Ht,tt.textarea);Kt.oninput=Wr,Jt.onchange=Wr,rn.onchange=Wr,wn.onchange=Wr,Fn.oninput=Wr,dr.oninput=()=>{Wr(),kr.value=dr.value},dr.onchange=()=>{Wr(),kr.value=dr.value}},Pr=Ht=>typeof Ht=="string"?document.querySelector(Ht):Ht,nn=Ht=>{const Kt=Rt();Kt.setAttribute("role",Ht.toast?"alert":"dialog"),Kt.setAttribute("aria-live",Ht.toast?"polite":"assertive"),Ht.toast||Kt.setAttribute("aria-modal","true")},Kr=Ht=>{window.getComputedStyle(Ht).direction==="rtl"&&Zt(St(),tt.rtl)},Dr=Ht=>{const Kt=Er();if(Gr()){at("SweetAlert2 requires document to initialize");return}const Jt=document.createElement("div");Jt.className=tt.container,Kt&&Zt(Jt,tt["no-transition"]),Ut(Jt,$r);const dr=Pr(Ht.target);dr.appendChild(Jt),nn(Ht),Kr(dr),Vr()},Qr=(Ht,Kt)=>{Ht instanceof HTMLElement?Kt.appendChild(Ht):typeof Ht=="object"?Or(Ht,Kt):Ht&&Ut(Kt,Ht)},Or=(Ht,Kt)=>{Ht.jquery?Cr(Kt,Ht):Ut(Kt,Ht.toString())},Cr=(Ht,Kt)=>{if(Ht.textContent="",0 in Kt)for(let Jt=0;Jt in Kt;Jt++)Ht.appendChild(Kt[Jt].cloneNode(!0));else Ht.appendChild(Kt.cloneNode(!0))},Zr=(()=>{if(Gr())return!1;const Ht=document.createElement("div"),Kt={WebkitAnimation:"webkitAnimationEnd",animation:"animationend"};for(const Jt in Kt)if(Object.prototype.hasOwnProperty.call(Kt,Jt)&&typeof Ht.style[Jt]<"u")return Kt[Jt];return!1})(),Fr=()=>{const Ht=document.createElement("div");Ht.className=tt["scrollbar-measure"],document.body.appendChild(Ht);const Kt=Ht.getBoundingClientRect().width-Ht.clientWidth;return document.body.removeChild(Ht),Kt},Ar=(Ht,Kt)=>{const Jt=Ct(),dr=$t();!Kt.showConfirmButton&&!Kt.showDenyButton&&!Kt.showCancelButton?nr(Jt):Qt(Jt),Yt(Jt,Kt,"actions"),Xr(Jt,dr,Kt),Ut(dr,Kt.loaderHtml),Yt(dr,Kt,"loader")};function Xr(Ht,Kt,Jt){const dr=lt(),kr=bt(),rn=pt();Sr(dr,"confirm",Jt),Sr(kr,"deny",Jt),Sr(rn,"cancel",Jt),Mr(dr,kr,rn,Jt),Jt.reverseButtons&&(Jt.toast?(Ht.insertBefore(rn,dr),Ht.insertBefore(kr,dr)):(Ht.insertBefore(rn,Kt),Ht.insertBefore(kr,Kt),Ht.insertBefore(dr,Kt)))}function Mr(Ht,Kt,Jt,dr){if(!dr.buttonsStyling){Bt([Ht,Kt,Jt],tt.styled);return}Zt([Ht,Kt,Jt],tt.styled),dr.confirmButtonColor&&(Ht.style.backgroundColor=dr.confirmButtonColor,Zt(Ht,tt["default-outline"])),dr.denyButtonColor&&(Kt.style.backgroundColor=dr.denyButtonColor,Zt(Kt,tt["default-outline"])),dr.cancelButtonColor&&(Jt.style.backgroundColor=dr.cancelButtonColor,Zt(Jt,tt["default-outline"]))}function Sr(Ht,Kt,Jt){br(Ht,Jt[`show${st(Kt)}Button`],"inline-block"),Ut(Ht,Jt[`${Kt}ButtonText`]),Ht.setAttribute("aria-label",Jt[`${Kt}ButtonAriaLabel`]),Ht.className=tt[Kt],Yt(Ht,Jt,`${Kt}Button`),Zt(Ht,Jt[`${Kt}ButtonClass`])}const Jr=(Ht,Kt)=>{const Jt=dt();Ut(Jt,Kt.closeButtonHtml),Yt(Jt,Kt,"closeButton"),br(Jt,Kt.showCloseButton),Jt.setAttribute("aria-label",Kt.closeButtonAriaLabel)},Ur=(Ht,Kt)=>{const Jt=St();Jt&&(Rr(Jt,Kt.backdrop),en(Jt,Kt.position),Br(Jt,Kt.grow),Yt(Jt,Kt,"container"))};function Rr(Ht,Kt){typeof Kt=="string"?Ht.style.background=Kt:Kt||Zt([document.documentElement,document.body],tt["no-backdrop"])}function en(Ht,Kt){Kt in tt?Zt(Ht,tt[Kt]):(ot('The "position" parameter is not valid, defaulting to "center"'),Zt(Ht,tt.center))}function Br(Ht,Kt){if(Kt&&typeof Kt=="string"){const Jt=`grow-${Kt}`;Jt in tt&&Zt(Ht,tt[Jt])}}const Ir=["input","file","range","select","radio","checkbox","textarea"],tn=(Ht,Kt)=>{const Jt=Rt(),dr=$.innerParams.get(Ht),kr=!dr||Kt.input!==dr.input;Ir.forEach(rn=>{const wn=Ft(Jt,tt[rn]);sn(rn,Kt.inputAttributes),wn.className=tt[rn],kr&&nr(wn)}),Kt.input&&(kr&&qr(Kt),Hr(Kt))},qr=Ht=>{if(!an[Ht.input]){at(`Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "${Ht.input}"`);return}const Kt=dn(Ht.input),Jt=an[Ht.input](Kt,Ht);Qt(Kt),Ht.inputAutoFocus&&setTimeout(()=>{cr(Jt)})},Lr=Ht=>{for(let Kt=0;Kt<Ht.attributes.length;Kt++){const Jt=Ht.attributes[Kt].name;["type","value","style"].includes(Jt)||Ht.removeAttribute(Jt)}},sn=(Ht,Kt)=>{const Jt=lr(Rt(),Ht);if(Jt){Lr(Jt);for(const dr in Kt)Jt.setAttribute(dr,Kt[dr])}},Hr=Ht=>{const Kt=dn(Ht.input);typeof Ht.customClass=="object"&&Zt(Kt,Ht.customClass.input)},jr=(Ht,Kt)=>{(!Ht.placeholder||Kt.inputPlaceholder)&&(Ht.placeholder=Kt.inputPlaceholder)},un=(Ht,Kt,Jt)=>{if(Jt.inputLabel){Ht.id=tt.input;const dr=document.createElement("label"),kr=tt["input-label"];dr.setAttribute("for",Ht.id),dr.className=kr,typeof Jt.customClass=="object"&&Zt(dr,Jt.customClass.inputLabel),dr.innerText=Jt.inputLabel,Kt.insertAdjacentElement("beforebegin",dr)}},dn=Ht=>Ft(Rt(),tt[Ht]||tt.input),fn=(Ht,Kt)=>{["string","number"].includes(typeof Kt)?Ht.value=`${Kt}`:Et(Kt)||ot(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof Kt}"`)},an={};an.text=an.email=an.password=an.number=an.tel=an.url=(Ht,Kt)=>(fn(Ht,Kt.inputValue),un(Ht,Ht,Kt),jr(Ht,Kt),Ht.type=Kt.input,Ht),an.file=(Ht,Kt)=>(un(Ht,Ht,Kt),jr(Ht,Kt),Ht),an.range=(Ht,Kt)=>{const Jt=Ht.querySelector("input"),dr=Ht.querySelector("output");return fn(Jt,Kt.inputValue),Jt.type=Kt.input,fn(dr,Kt.inputValue),un(Jt,Ht,Kt),Ht},an.select=(Ht,Kt)=>{if(Ht.textContent="",Kt.inputPlaceholder){const Jt=document.createElement("option");Ut(Jt,Kt.inputPlaceholder),Jt.value="",Jt.disabled=!0,Jt.selected=!0,Ht.appendChild(Jt)}return un(Ht,Ht,Kt),Ht},an.radio=Ht=>(Ht.textContent="",Ht),an.checkbox=(Ht,Kt)=>{const Jt=lr(Rt(),"checkbox");Jt.value="1",Jt.id=tt.checkbox,Jt.checked=!!Kt.inputValue;const dr=Ht.querySelector("span");return Ut(dr,Kt.inputPlaceholder),Jt},an.textarea=(Ht,Kt)=>{fn(Ht,Kt.inputValue),jr(Ht,Kt),un(Ht,Ht,Kt);const Jt=dr=>parseInt(window.getComputedStyle(dr).marginLeft)+parseInt(window.getComputedStyle(dr).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const dr=parseInt(window.getComputedStyle(Rt()).width),kr=()=>{const rn=Ht.offsetWidth+Jt(Ht);rn>dr?Rt().style.width=`${rn}px`:Rt().style.width=null};new MutationObserver(kr).observe(Ht,{attributes:!0,attributeFilter:["style"]})}}),Ht};const pn=(Ht,Kt)=>{const Jt=jt();Yt(Jt,Kt,"htmlContainer"),Kt.html?(Qr(Kt.html,Jt),Qt(Jt,"block")):Kt.text?(Jt.textContent=Kt.text,Qt(Jt,"block")):nr(Jt),tn(Ht,Kt)},_n=(Ht,Kt)=>{const Jt=xt();br(Jt,Kt.footer),Kt.footer&&Qr(Kt.footer,Jt),Yt(Jt,Kt,"footer")},Tn=(Ht,Kt)=>{const Jt=$.innerParams.get(Ht),dr=Tt();if(Jt&&Kt.icon===Jt.icon){xn(dr,Kt),gn(dr,Kt);return}if(!Kt.icon&&!Kt.iconHtml){nr(dr);return}if(Kt.icon&&Object.keys(rt).indexOf(Kt.icon)===-1){at(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${Kt.icon}"`),nr(dr);return}Qt(dr),xn(dr,Kt),gn(dr,Kt),Zt(dr,Kt.showClass.icon)},gn=(Ht,Kt)=>{for(const Jt in rt)Kt.icon!==Jt&&Bt(Ht,rt[Jt]);Zt(Ht,rt[Kt.icon]),An(Ht,Kt),En(),Yt(Ht,Kt,"icon")},En=()=>{const Ht=Rt(),Kt=window.getComputedStyle(Ht).getPropertyValue("background-color"),Jt=Ht.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let dr=0;dr<Jt.length;dr++)Jt[dr].style.backgroundColor=Kt},Cn=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,mn=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,xn=(Ht,Kt)=>{let Jt=Ht.innerHTML,dr;Kt.iconHtml?dr=$n(Kt.iconHtml):Kt.icon==="success"?(dr=Cn,Jt=Jt.replace(/ style=".*?"/g,"")):Kt.icon==="error"?dr=mn:dr=$n({question:"?",warning:"!",info:"i"}[Kt.icon]),Jt.trim()!==dr.trim()&&Ut(Ht,dr)},An=(Ht,Kt)=>{if(Kt.iconColor){Ht.style.color=Kt.iconColor,Ht.style.borderColor=Kt.iconColor;for(const Jt of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])gr(Ht,Jt,"backgroundColor",Kt.iconColor);gr(Ht,".swal2-success-ring","borderColor",Kt.iconColor)}},$n=Ht=>`<div class="${tt["icon-content"]}">${Ht}</div>`,Rn=(Ht,Kt)=>{const Jt=Nt();if(!Kt.imageUrl){nr(Jt);return}Qt(Jt,""),Jt.setAttribute("src",Kt.imageUrl),Jt.setAttribute("alt",Kt.imageAlt),zt(Jt,"width",Kt.imageWidth),zt(Jt,"height",Kt.imageHeight),Jt.className=tt.image,Yt(Jt,Kt,"image")},Sn=(Ht,Kt)=>{const Jt=St(),dr=Rt();Kt.toast?(zt(Jt,"width",Kt.width),dr.style.width="100%",dr.insertBefore($t(),Tt())):zt(dr,"width",Kt.width),zt(dr,"padding",Kt.padding),Kt.color&&(dr.style.color=Kt.color),Kt.background&&(dr.style.background=Kt.background),nr(yt()),In(dr,Kt)},In=(Ht,Kt)=>{Ht.className=`${tt.popup} ${vr(Ht)?Kt.showClass.popup:""}`,Kt.toast?(Zt([document.documentElement,document.body],tt["toast-shown"]),Zt(Ht,tt.toast)):Zt(Ht,tt.modal),Yt(Ht,Kt,"popup"),typeof Kt.customClass=="string"&&Zt(Ht,Kt.customClass),Kt.icon&&Zt(Ht,tt[`icon-${Kt.icon}`])},kn=(Ht,Kt)=>{const Jt=It();if(!Kt.progressSteps||Kt.progressSteps.length===0){nr(Jt);return}Qt(Jt),Jt.textContent="",Kt.currentProgressStep>=Kt.progressSteps.length&&ot("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),Kt.progressSteps.forEach((dr,kr)=>{const rn=Pn(dr);if(Jt.appendChild(rn),kr===Kt.currentProgressStep&&Zt(rn,tt["active-progress-step"]),kr!==Kt.progressSteps.length-1){const wn=Ls(Kt);Jt.appendChild(wn)}})},Pn=Ht=>{const Kt=document.createElement("li");return Zt(Kt,tt["progress-step"]),Ut(Kt,Ht),Kt},Ls=Ht=>{const Kt=document.createElement("li");return Zt(Kt,tt["progress-step-line"]),Ht.progressStepsDistance&&zt(Kt,"width",Ht.progressStepsDistance),Kt},Fs=(Ht,Kt)=>{const Jt=Ot();br(Jt,Kt.title||Kt.titleText,"block"),Kt.title&&Qr(Kt.title,Jt),Kt.titleText&&(Jt.innerText=Kt.titleText),Yt(Jt,Kt,"title")},Ss=(Ht,Kt)=>{Sn(Ht,Kt),Ur(Ht,Kt),kn(Ht,Kt),Tn(Ht,Kt),Rn(Ht,Kt),Fs(Ht,Kt),Jr(Ht,Kt),pn(Ht,Kt),Ar(Ht,Kt),_n(Ht,Kt),typeof Kt.didRender=="function"&&Kt.didRender(Rt())};function Ts(){const Ht=$.innerParams.get(this);if(!Ht)return;const Kt=$.domCache.get(this);nr(Kt.loader),Gt()?Ht.icon&&Qt(Tt()):Us(Kt),Bt([Kt.popup,Kt.actions],tt.loading),Kt.popup.removeAttribute("aria-busy"),Kt.popup.removeAttribute("data-loading"),Kt.confirmButton.disabled=!1,Kt.denyButton.disabled=!1,Kt.cancelButton.disabled=!1}const Us=Ht=>{const Kt=Ht.popup.getElementsByClassName(Ht.loader.getAttribute("data-button-to-replace"));Kt.length?Qt(Kt[0],"inline-block"):Nr()&&nr(Ht.actions)};function Vs(Ht){const Kt=$.innerParams.get(Ht||this),Jt=$.domCache.get(Ht||this);return Jt?lr(Jt.popup,Kt.input):null}const zs=()=>vr(Rt()),Yn=()=>lt()&&lt().click(),ds=()=>bt()&&bt().click(),Hs=()=>pt()&&pt().click(),qn=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),hs=Ht=>{Ht.keydownTarget&&Ht.keydownHandlerAdded&&(Ht.keydownTarget.removeEventListener("keydown",Ht.keydownHandler,{capture:Ht.keydownListenerCapture}),Ht.keydownHandlerAdded=!1)},Ks=(Ht,Kt,Jt,dr)=>{hs(Kt),Jt.toast||(Kt.keydownHandler=kr=>js(Ht,kr,dr),Kt.keydownTarget=Jt.keydownListenerCapture?window:Rt(),Kt.keydownListenerCapture=Jt.keydownListenerCapture,Kt.keydownTarget.addEventListener("keydown",Kt.keydownHandler,{capture:Kt.keydownListenerCapture}),Kt.keydownHandlerAdded=!0)},ps=(Ht,Kt)=>{const Jt=qt();if(Jt.length){Ht=Ht+Kt,Ht===Jt.length?Ht=0:Ht===-1&&(Ht=Jt.length-1),Jt[Ht].focus();return}Rt().focus()},Cs=["ArrowRight","ArrowDown"],As=["ArrowLeft","ArrowUp"],js=(Ht,Kt,Jt)=>{const dr=$.innerParams.get(Ht);dr&&(Kt.isComposing||Kt.keyCode===229||(dr.stopKeydownPropagation&&Kt.stopPropagation(),Kt.key==="Enter"?qs(Ht,Kt,dr):Kt.key==="Tab"?Gs(Kt):[...Cs,...As].includes(Kt.key)?gs(Kt.key):Kt.key==="Escape"&&Ws(Kt,dr,Jt)))},qs=(Ht,Kt,Jt)=>{if(ht(Jt.allowEnterKey)&&Kt.target&&Ht.getInput()&&Kt.target instanceof HTMLElement&&Kt.target.outerHTML===Ht.getInput().outerHTML){if(["textarea","file"].includes(Jt.input))return;Yn(),Kt.preventDefault()}},Gs=Ht=>{const Kt=Ht.target,Jt=qt();let dr=-1;for(let kr=0;kr<Jt.length;kr++)if(Kt===Jt[kr]){dr=kr;break}Ht.shiftKey?ps(dr,-1):ps(dr,1),Ht.stopPropagation(),Ht.preventDefault()},gs=Ht=>{const Kt=lt(),Jt=bt(),dr=pt(),kr=[Kt,Jt,dr];if(document.activeElement instanceof HTMLElement&&!kr.includes(document.activeElement))return;const rn=Cs.includes(Ht)?"nextElementSibling":"previousElementSibling";let wn=document.activeElement;for(let Fn=0;Fn<Ct().children.length;Fn++){if(wn=wn[rn],!wn)return;if(wn instanceof HTMLButtonElement&&vr(wn))break}wn instanceof HTMLButtonElement&&wn.focus()},Ws=(Ht,Kt,Jt)=>{ht(Kt.allowEscapeKey)&&(Ht.preventDefault(),Jt(qn.esc))};var Zn={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Ys=()=>{Array.from(document.body.children).forEach(Kt=>{Kt===St()||Kt.contains(St())||(Kt.hasAttribute("aria-hidden")&&Kt.setAttribute("data-previous-aria-hidden",Kt.getAttribute("aria-hidden")),Kt.setAttribute("aria-hidden","true"))})},Qn=()=>{Array.from(document.body.children).forEach(Kt=>{Kt.hasAttribute("data-previous-aria-hidden")?(Kt.setAttribute("aria-hidden",Kt.getAttribute("data-previous-aria-hidden")),Kt.removeAttribute("data-previous-aria-hidden")):Kt.removeAttribute("aria-hidden")})},ys=()=>{if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!Mt(document.body,tt.iosfix)){const Kt=document.body.scrollTop;document.body.style.top=`${Kt*-1}px`,Zt(document.body,tt.iosfix),vs(),bs()}},bs=()=>{const Ht=navigator.userAgent,Kt=!!Ht.match(/iPad/i)||!!Ht.match(/iPhone/i),Jt=!!Ht.match(/WebKit/i);Kt&&Jt&&!Ht.match(/CriOS/i)&&Rt().scrollHeight>window.innerHeight-44&&(St().style.paddingBottom="44px")},vs=()=>{const Ht=St();let Kt;Ht.ontouchstart=Jt=>{Kt=Zs(Jt)},Ht.ontouchmove=Jt=>{Kt&&(Jt.preventDefault(),Jt.stopPropagation())}},Zs=Ht=>{const Kt=Ht.target,Jt=St();return Rs(Ht)||ws(Ht)?!1:Kt===Jt||!ar(Jt)&&Kt instanceof HTMLElement&&Kt.tagName!=="INPUT"&&Kt.tagName!=="TEXTAREA"&&!(ar(jt())&&jt().contains(Kt))},Rs=Ht=>Ht.touches&&Ht.touches.length&&Ht.touches[0].touchType==="stylus",ws=Ht=>Ht.touches&&Ht.touches.length>1,Is=()=>{if(Mt(document.body,tt.iosfix)){const Ht=parseInt(document.body.style.top,10);Bt(document.body,tt.iosfix),document.body.style.top="",document.body.scrollTop=Ht*-1}},Kn=()=>{Vt.previousBodyPadding===null&&document.body.scrollHeight>window.innerHeight&&(Vt.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Vt.previousBodyPadding+Fr()}px`)},Xn=()=>{Vt.previousBodyPadding!==null&&(document.body.style.paddingRight=`${Vt.previousBodyPadding}px`,Vt.previousBodyPadding=null)};function ks(Ht,Kt,Jt,dr){Gt()?xr(Ht,dr):(wr(Jt).then(()=>xr(Ht,dr)),hs(pr)),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(Kt.setAttribute("style","display:none !important"),Kt.removeAttribute("class"),Kt.innerHTML=""):Kt.remove(),Pt()&&(Xn(),Is(),Qn()),Ps()}function Ps(){Bt([document.documentElement,document.body],[tt.shown,tt["height-auto"],tt["no-backdrop"],tt["toast-shown"]])}function ts(Ht){Ht=Js(Ht);const Kt=Zn.swalPromiseResolve.get(this),Jt=Qs(this);this.isAwaitingPromise()?Ht.isDismissed||(Gn(this),Kt(Ht)):Jt&&Kt(Ht)}function Ds(){return!!$.awaitingPromise.get(this)}const Qs=Ht=>{const Kt=Rt();if(!Kt)return!1;const Jt=$.innerParams.get(Ht);if(!Jt||Mt(Kt,Jt.hideClass.popup))return!1;Bt(Kt,Jt.showClass.popup),Zt(Kt,Jt.hideClass.popup);const dr=St();return Bt(dr,Jt.showClass.backdrop),Zt(dr,Jt.hideClass.backdrop),fr(Ht,Kt,Jt),!0};function Xs(Ht){const Kt=Zn.swalPromiseReject.get(this);Gn(this),Kt&&Kt(Ht)}const Gn=Ht=>{Ht.isAwaitingPromise()&&($.awaitingPromise.delete(Ht),$.innerParams.get(Ht)||Ht._destroy())},Js=Ht=>typeof Ht>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},Ht),fr=(Ht,Kt,Jt)=>{const dr=St(),kr=Zr&&er(Kt);typeof Jt.willClose=="function"&&Jt.willClose(Kt),kr?_r(Ht,Kt,dr,Jt.returnFocus,Jt.didClose):ks(Ht,dr,Jt.returnFocus,Jt.didClose)},_r=(Ht,Kt,Jt,dr,kr)=>{pr.swalCloseEventFinishedCallback=ks.bind(null,Ht,Jt,dr,kr),Kt.addEventListener(Zr,function(rn){rn.target===Kt&&(pr.swalCloseEventFinishedCallback(),delete pr.swalCloseEventFinishedCallback)})},xr=(Ht,Kt)=>{setTimeout(()=>{typeof Kt=="function"&&Kt.bind(Ht.params)(),Ht._destroy()})};function Yr(Ht,Kt,Jt){const dr=$.domCache.get(Ht);Kt.forEach(kr=>{dr[kr].disabled=Jt})}function cn(Ht,Kt){if(Ht)if(Ht.type==="radio"){const dr=Ht.parentNode.parentNode.querySelectorAll("input");for(let kr=0;kr<dr.length;kr++)dr[kr].disabled=Kt}else Ht.disabled=Kt}function hn(){Yr(this,["confirmButton","denyButton","cancelButton"],!1)}function yn(){Yr(this,["confirmButton","denyButton","cancelButton"],!0)}function ln(){cn(this.getInput(),!1)}function vn(){cn(this.getInput(),!0)}function Ln(Ht){const Kt=$.domCache.get(this),Jt=$.innerParams.get(this);Ut(Kt.validationMessage,Ht),Kt.validationMessage.className=tt["validation-message"],Jt.customClass&&Jt.customClass.validationMessage&&Zt(Kt.validationMessage,Jt.customClass.validationMessage),Qt(Kt.validationMessage);const dr=this.getInput();dr&&(dr.setAttribute("aria-invalid",!0),dr.setAttribute("aria-describedby",tt["validation-message"]),cr(dr),Zt(dr,tt.inputerror))}function Mn(){const Ht=$.domCache.get(this);Ht.validationMessage&&nr(Ht.validationMessage);const Kt=this.getInput();Kt&&(Kt.removeAttribute("aria-invalid"),Kt.removeAttribute("aria-describedby"),Bt(Kt,tt.inputerror))}const Un={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},_s=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Es={},Ms=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],uo=Ht=>Object.prototype.hasOwnProperty.call(Un,Ht),fo=Ht=>_s.indexOf(Ht)!==-1,eo=Ht=>Es[Ht],Lo=Ht=>{uo(Ht)||ot(`Unknown parameter "${Ht}"`)},Fo=Ht=>{Ms.includes(Ht)&&ot(`The parameter "${Ht}" is incompatible with toasts`)},Uo=Ht=>{eo(Ht)&&ft(Ht,eo(Ht))},Vo=Ht=>{Ht.backdrop===!1&&Ht.allowOutsideClick&&ot('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const Kt in Ht)Lo(Kt),Ht.toast&&Fo(Kt),Uo(Kt)};function zo(Ht){const Kt=Rt(),Jt=$.innerParams.get(this);if(!Kt||Mt(Kt,Jt.hideClass.popup)){ot("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const dr=Ho(Ht),kr=Object.assign({},Jt,dr);Ss(this,kr),$.innerParams.set(this,kr),Object.defineProperties(this,{params:{value:Object.assign({},this.params,Ht),writable:!1,enumerable:!0}})}const Ho=Ht=>{const Kt={};return Object.keys(Ht).forEach(Jt=>{fo(Jt)?Kt[Jt]=Ht[Jt]:ot(`Invalid parameter to update: ${Jt}`)}),Kt};function Ko(){const Ht=$.domCache.get(this),Kt=$.innerParams.get(this);if(!Kt){ho(this);return}Ht.popup&&pr.swalCloseEventFinishedCallback&&(pr.swalCloseEventFinishedCallback(),delete pr.swalCloseEventFinishedCallback),typeof Kt.didDestroy=="function"&&Kt.didDestroy(),jo(this)}const jo=Ht=>{ho(Ht),delete Ht.params,delete pr.keydownHandler,delete pr.keydownTarget,delete pr.currentInstance},ho=Ht=>{Ht.isAwaitingPromise()?(to($,Ht),$.awaitingPromise.set(Ht,!0)):(to(Zn,Ht),to($,Ht))},to=(Ht,Kt)=>{for(const Jt in Ht)Ht[Jt].delete(Kt)};var po=Object.freeze({__proto__:null,_destroy:Ko,close:ts,closeModal:ts,closePopup:ts,closeToast:ts,disableButtons:yn,disableInput:vn,disableLoading:Ts,enableButtons:hn,enableInput:ln,getInput:Vs,handleAwaitingPromise:Gn,hideLoading:Ts,isAwaitingPromise:Ds,rejectPromise:Xs,resetValidationMessage:Mn,showValidationMessage:Ln,update:zo});const rs=Ht=>{let Kt=Rt();Kt||new Bs,Kt=Rt();const Jt=$t();Gt()?nr(Tt()):qo(Kt,Ht),Qt(Jt),Kt.setAttribute("data-loading","true"),Kt.setAttribute("aria-busy","true"),Kt.focus()},qo=(Ht,Kt)=>{const Jt=Ct(),dr=$t();!Kt&&vr(lt())&&(Kt=lt()),Qt(Jt),Kt&&(nr(Kt),dr.setAttribute("data-button-to-replace",Kt.className)),dr.parentNode.insertBefore(dr,Kt),Zt([Ht,Jt],tt.loading)},Go=(Ht,Kt)=>{Kt.input==="select"||Kt.input==="radio"?Xo(Ht,Kt):["text","email","number","tel","textarea"].includes(Kt.input)&&(mt(Kt.inputValue)||Et(Kt.inputValue))&&(rs(lt()),Jo(Ht,Kt))},Wo=(Ht,Kt)=>{const Jt=Ht.getInput();if(!Jt)return null;switch(Kt.input){case"checkbox":return Yo(Jt);case"radio":return Zo(Jt);case"file":return Qo(Jt);default:return Kt.inputAutoTrim?Jt.value.trim():Jt.value}},Yo=Ht=>Ht.checked?1:0,Zo=Ht=>Ht.checked?Ht.value:null,Qo=Ht=>Ht.files.length?Ht.getAttribute("multiple")!==null?Ht.files:Ht.files[0]:null,Xo=(Ht,Kt)=>{const Jt=Rt(),dr=kr=>{na[Kt.input](Jt,ro(kr),Kt)};mt(Kt.inputOptions)||Et(Kt.inputOptions)?(rs(lt()),gt(Kt.inputOptions).then(kr=>{Ht.hideLoading(),dr(kr)})):typeof Kt.inputOptions=="object"?dr(Kt.inputOptions):at(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof Kt.inputOptions}`)},Jo=(Ht,Kt)=>{const Jt=Ht.getInput();nr(Jt),gt(Kt.inputValue).then(dr=>{Jt.value=Kt.input==="number"?`${parseFloat(dr)||0}`:`${dr}`,Qt(Jt),Jt.focus(),Ht.hideLoading()}).catch(dr=>{at(`Error in inputValue promise: ${dr}`),Jt.value="",Qt(Jt),Jt.focus(),Ht.hideLoading()})},na={select:(Ht,Kt,Jt)=>{const dr=Ft(Ht,tt.select),kr=(rn,wn,Fn)=>{const On=document.createElement("option");On.value=Fn,Ut(On,wn),On.selected=go(Fn,Jt.inputValue),rn.appendChild(On)};Kt.forEach(rn=>{const wn=rn[0],Fn=rn[1];if(Array.isArray(Fn)){const On=document.createElement("optgroup");On.label=wn,On.disabled=!1,dr.appendChild(On),Fn.forEach(ss=>kr(On,ss[1],ss[0]))}else kr(dr,Fn,wn)}),dr.focus()},radio:(Ht,Kt,Jt)=>{const dr=Ft(Ht,tt.radio);Kt.forEach(rn=>{const wn=rn[0],Fn=rn[1],On=document.createElement("input"),ss=document.createElement("label");On.type="radio",On.name=tt.radio,On.value=wn,go(wn,Jt.inputValue)&&(On.checked=!0);const oo=document.createElement("span");Ut(oo,Fn),oo.className=tt.label,ss.appendChild(On),ss.appendChild(oo),dr.appendChild(ss)});const kr=dr.querySelectorAll("input");kr.length&&kr[0].focus()}},ro=Ht=>{const Kt=[];return typeof Map<"u"&&Ht instanceof Map?Ht.forEach((Jt,dr)=>{let kr=Jt;typeof kr=="object"&&(kr=ro(kr)),Kt.push([dr,kr])}):Object.keys(Ht).forEach(Jt=>{let dr=Ht[Jt];typeof dr=="object"&&(dr=ro(dr)),Kt.push([Jt,dr])}),Kt},go=(Ht,Kt)=>Kt&&Kt.toString()===Ht.toString(),ga=Ht=>{const Kt=$.innerParams.get(Ht);Ht.disableButtons(),Kt.input?mo(Ht,"confirm"):io(Ht,!0)},ba=Ht=>{const Kt=$.innerParams.get(Ht);Ht.disableButtons(),Kt.returnInputValueOnDeny?mo(Ht,"deny"):no(Ht,!1)},xa=(Ht,Kt)=>{Ht.disableButtons(),Kt(qn.cancel)},mo=(Ht,Kt)=>{const Jt=$.innerParams.get(Ht);if(!Jt.input){at(`The "input" parameter is needed to be set when using returnInputValueOn${st(Kt)}`);return}const dr=Wo(Ht,Jt);Jt.inputValidator?$a(Ht,dr,Kt):Ht.getInput().checkValidity()?Kt==="deny"?no(Ht,dr):io(Ht,dr):(Ht.enableButtons(),Ht.showValidationMessage(Jt.validationMessage))},$a=(Ht,Kt,Jt)=>{const dr=$.innerParams.get(Ht);Ht.disableInput(),Promise.resolve().then(()=>gt(dr.inputValidator(Kt,dr.validationMessage))).then(rn=>{Ht.enableButtons(),Ht.enableInput(),rn?Ht.showValidationMessage(rn):Jt==="deny"?no(Ht,Kt):io(Ht,Kt)})},no=(Ht,Kt)=>{const Jt=$.innerParams.get(Ht||void 0);Jt.showLoaderOnDeny&&rs(bt()),Jt.preDeny?($.awaitingPromise.set(Ht||void 0,!0),Promise.resolve().then(()=>gt(Jt.preDeny(Kt,Jt.validationMessage))).then(kr=>{kr===!1?(Ht.hideLoading(),Gn(Ht)):Ht.close({isDenied:!0,value:typeof kr>"u"?Kt:kr})}).catch(kr=>bo(Ht||void 0,kr))):Ht.close({isDenied:!0,value:Kt})},yo=(Ht,Kt)=>{Ht.close({isConfirmed:!0,value:Kt})},bo=(Ht,Kt)=>{Ht.rejectPromise(Kt)},io=(Ht,Kt)=>{const Jt=$.innerParams.get(Ht||void 0);Jt.showLoaderOnConfirm&&rs(),Jt.preConfirm?(Ht.resetValidationMessage(),$.awaitingPromise.set(Ht||void 0,!0),Promise.resolve().then(()=>gt(Jt.preConfirm(Kt,Jt.validationMessage))).then(kr=>{vr(yt())||kr===!1?(Ht.hideLoading(),Gn(Ht)):yo(Ht,typeof kr>"u"?Kt:kr)}).catch(kr=>bo(Ht||void 0,kr))):yo(Ht,Kt)},yl=(Ht,Kt,Jt)=>{$.innerParams.get(Ht).toast?_l(Ht,Kt,Jt):(xl(Kt),$l(Kt),Sl(Ht,Kt,Jt))},_l=(Ht,Kt,Jt)=>{Kt.popup.onclick=()=>{const dr=$.innerParams.get(Ht);dr&&(El(dr)||dr.timer||dr.input)||Jt(qn.close)}},El=Ht=>Ht.showConfirmButton||Ht.showDenyButton||Ht.showCancelButton||Ht.showCloseButton;let Os=!1;const xl=Ht=>{Ht.popup.onmousedown=()=>{Ht.container.onmouseup=function(Kt){Ht.container.onmouseup=void 0,Kt.target===Ht.container&&(Os=!0)}}},$l=Ht=>{Ht.container.onmousedown=()=>{Ht.popup.onmouseup=function(Kt){Ht.popup.onmouseup=void 0,(Kt.target===Ht.popup||Ht.popup.contains(Kt.target))&&(Os=!0)}}},Sl=(Ht,Kt,Jt)=>{Kt.container.onclick=dr=>{const kr=$.innerParams.get(Ht);if(Os){Os=!1;return}dr.target===Kt.container&&ht(kr.allowOutsideClick)&&Jt(qn.backdrop)}},Tl=Ht=>typeof Ht=="object"&&Ht.jquery,vo=Ht=>Ht instanceof Element||Tl(Ht),Cl=Ht=>{const Kt={};return typeof Ht[0]=="object"&&!vo(Ht[0])?Object.assign(Kt,Ht[0]):["title","html","icon"].forEach((Jt,dr)=>{const kr=Ht[dr];typeof kr=="string"||vo(kr)?Kt[Jt]=kr:kr!==void 0&&at(`Unexpected type of ${Jt}! Expected "string" or "Element", got ${typeof kr}`)}),Kt};function Al(){const Ht=this;for(var Kt=arguments.length,Jt=new Array(Kt),dr=0;dr<Kt;dr++)Jt[dr]=arguments[dr];return new Ht(...Jt)}function Rl(Ht){class Kt extends this{_main(dr,kr){return super._main(dr,Object.assign({},Ht,kr))}}return Kt}const Il=()=>pr.timeout&&pr.timeout.getTimerLeft(),wo=()=>{if(pr.timeout)return tr(),pr.timeout.stop()},_o=()=>{if(pr.timeout){const Ht=pr.timeout.start();return Xt(Ht),Ht}},Pl=()=>{const Ht=pr.timeout;return Ht&&(Ht.running?wo():_o())},Dl=Ht=>{if(pr.timeout){const Kt=pr.timeout.increase(Ht);return Xt(Kt,!0),Kt}},Ml=()=>pr.timeout&&pr.timeout.isRunning();let Eo=!1;const so={};function Ol(){let Ht=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";so[Ht]=this,Eo||(document.body.addEventListener("click",Nl),Eo=!0)}const Nl=Ht=>{for(let Kt=Ht.target;Kt&&Kt!==document;Kt=Kt.parentNode)for(const Jt in so){const dr=Kt.getAttribute(Jt);if(dr){so[Jt].fire({template:dr});return}}};var Ll=Object.freeze({__proto__:null,argsToParams:Cl,bindClickHandler:Ol,clickCancel:Hs,clickConfirm:Yn,clickDeny:ds,enableLoading:rs,fire:Al,getActions:Ct,getCancelButton:pt,getCloseButton:dt,getConfirmButton:lt,getContainer:St,getDenyButton:bt,getFocusableElements:qt,getFooter:xt,getHtmlContainer:jt,getIcon:Tt,getIconContent:Dt,getImage:Nt,getInputLabel:_t,getLoader:$t,getPopup:Rt,getProgressSteps:It,getTimerLeft:Il,getTimerProgressBar:vt,getTitle:Ot,getValidationMessage:yt,increaseTimer:Dl,isDeprecatedParameter:eo,isLoading:Wt,isTimerRunning:Ml,isUpdatableParameter:fo,isValidParameter:uo,isVisible:zs,mixin:Rl,resumeTimer:_o,showLoading:rs,stopTimer:wo,toggleTimer:Pl});class Fl{constructor(Kt,Jt){this.callback=Kt,this.remaining=Jt,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(Kt){const Jt=this.running;return Jt&&this.stop(),this.remaining+=Kt,Jt&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const xo=["swal-title","swal-html","swal-footer"],Ul=Ht=>{const Kt=typeof Ht.template=="string"?document.querySelector(Ht.template):Ht.template;if(!Kt)return{};const Jt=Kt.content;return Ql(Jt),Object.assign(Vl(Jt),Hl(Jt),Kl(Jt),Gl(Jt),Wl(Jt),Yl(Jt),Zl(Jt,xo))},Vl=Ht=>{const Kt={};return Array.from(Ht.querySelectorAll("swal-param")).forEach(dr=>{Jn(dr,["name","value"]);const kr=dr.getAttribute("name"),rn=dr.getAttribute("value");typeof Un[kr]=="boolean"?Kt[kr]=rn!=="false":typeof Un[kr]=="object"?Kt[kr]=JSON.parse(rn):Kt[kr]=rn}),Kt},Hl=Ht=>{const Kt={};return Array.from(Ht.querySelectorAll("swal-function-param")).forEach(dr=>{const kr=dr.getAttribute("name"),rn=dr.getAttribute("value");Kt[kr]=new Function(`return ${rn}`)()}),Kt},Kl=Ht=>{const Kt={};return Array.from(Ht.querySelectorAll("swal-button")).forEach(dr=>{Jn(dr,["type","color","aria-label"]);const kr=dr.getAttribute("type");Kt[`${kr}ButtonText`]=dr.innerHTML,Kt[`show${st(kr)}Button`]=!0,dr.hasAttribute("color")&&(Kt[`${kr}ButtonColor`]=dr.getAttribute("color")),dr.hasAttribute("aria-label")&&(Kt[`${kr}ButtonAriaLabel`]=dr.getAttribute("aria-label"))}),Kt},Gl=Ht=>{const Kt={},Jt=Ht.querySelector("swal-image");return Jt&&(Jn(Jt,["src","width","height","alt"]),Jt.hasAttribute("src")&&(Kt.imageUrl=Jt.getAttribute("src")),Jt.hasAttribute("width")&&(Kt.imageWidth=Jt.getAttribute("width")),Jt.hasAttribute("height")&&(Kt.imageHeight=Jt.getAttribute("height")),Jt.hasAttribute("alt")&&(Kt.imageAlt=Jt.getAttribute("alt"))),Kt},Wl=Ht=>{const Kt={},Jt=Ht.querySelector("swal-icon");return Jt&&(Jn(Jt,["type","color"]),Jt.hasAttribute("type")&&(Kt.icon=Jt.getAttribute("type")),Jt.hasAttribute("color")&&(Kt.iconColor=Jt.getAttribute("color")),Kt.iconHtml=Jt.innerHTML),Kt},Yl=Ht=>{const Kt={},Jt=Ht.querySelector("swal-input");Jt&&(Jn(Jt,["type","label","placeholder","value"]),Kt.input=Jt.getAttribute("type")||"text",Jt.hasAttribute("label")&&(Kt.inputLabel=Jt.getAttribute("label")),Jt.hasAttribute("placeholder")&&(Kt.inputPlaceholder=Jt.getAttribute("placeholder")),Jt.hasAttribute("value")&&(Kt.inputValue=Jt.getAttribute("value")));const dr=Array.from(Ht.querySelectorAll("swal-input-option"));return dr.length&&(Kt.inputOptions={},dr.forEach(kr=>{Jn(kr,["value"]);const rn=kr.getAttribute("value"),wn=kr.innerHTML;Kt.inputOptions[rn]=wn})),Kt},Zl=(Ht,Kt)=>{const Jt={};for(const dr in Kt){const kr=Kt[dr],rn=Ht.querySelector(kr);rn&&(Jn(rn,[]),Jt[kr.replace(/^swal-/,"")]=rn.innerHTML.trim())}return Jt},Ql=Ht=>{const Kt=xo.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(Ht.children).forEach(Jt=>{const dr=Jt.tagName.toLowerCase();Kt.includes(dr)||ot(`Unrecognized element <${dr}>`)})},Jn=(Ht,Kt)=>{Array.from(Ht.attributes).forEach(Jt=>{Kt.indexOf(Jt.name)===-1&&ot([`Unrecognized attribute "${Jt.name}" on <${Ht.tagName.toLowerCase()}>.`,`${Kt.length?`Allowed attributes are: ${Kt.join(", ")}`:"To set the value, use HTML within the element."}`])})},$o=10,Xl=Ht=>{const Kt=St(),Jt=Rt();typeof Ht.willOpen=="function"&&Ht.willOpen(Jt);const kr=window.getComputedStyle(document.body).overflowY;tu(Kt,Jt,Ht),setTimeout(()=>{Jl(Kt,Jt)},$o),Pt()&&(eu(Kt,Ht.scrollbarPadding,kr),Ys()),!Gt()&&!pr.previousActiveElement&&(pr.previousActiveElement=document.activeElement),typeof Ht.didOpen=="function"&&setTimeout(()=>Ht.didOpen(Jt)),Bt(Kt,tt["no-transition"])},So=Ht=>{const Kt=Rt();if(Ht.target!==Kt)return;const Jt=St();Kt.removeEventListener(Zr,So),Jt.style.overflowY="auto"},Jl=(Ht,Kt)=>{Zr&&er(Kt)?(Ht.style.overflowY="hidden",Kt.addEventListener(Zr,So)):Ht.style.overflowY="auto"},eu=(Ht,Kt,Jt)=>{ys(),Kt&&Jt!=="hidden"&&Kn(),setTimeout(()=>{Ht.scrollTop=0})},tu=(Ht,Kt,Jt)=>{Zt(Ht,Jt.showClass.backdrop),Kt.style.setProperty("opacity","0","important"),Qt(Kt,"grid"),setTimeout(()=>{Zt(Kt,Jt.showClass.popup),Kt.style.removeProperty("opacity")},$o),Zt([document.documentElement,document.body],tt.shown),Jt.heightAuto&&Jt.backdrop&&!Jt.toast&&Zt([document.documentElement,document.body],tt["height-auto"])};var To={email:(Ht,Kt)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(Ht)?Promise.resolve():Promise.resolve(Kt||"Invalid email address"),url:(Ht,Kt)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(Ht)?Promise.resolve():Promise.resolve(Kt||"Invalid URL")};function ru(Ht){Ht.inputValidator||Object.keys(To).forEach(Kt=>{Ht.input===Kt&&(Ht.inputValidator=To[Kt])})}function nu(Ht){(!Ht.target||typeof Ht.target=="string"&&!document.querySelector(Ht.target)||typeof Ht.target!="string"&&!Ht.target.appendChild)&&(ot('Target parameter is not valid, defaulting to "body"'),Ht.target="body")}function iu(Ht){ru(Ht),Ht.showLoaderOnConfirm&&!Ht.preConfirm&&ot(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),nu(Ht),typeof Ht.title=="string"&&(Ht.title=Ht.title.split(`
`).join("<br />")),Dr(Ht)}let Vn;class ns{constructor(){if(typeof window>"u")return;Vn=this;for(var Kt=arguments.length,Jt=new Array(Kt),dr=0;dr<Kt;dr++)Jt[dr]=arguments[dr];const kr=Object.freeze(this.constructor.argsToParams(Jt));Object.defineProperties(this,{params:{value:kr,writable:!1,enumerable:!0,configurable:!0}});const rn=Vn._main(Vn.params);$.promise.set(this,rn)}_main(Kt){let Jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Vo(Object.assign({},Jt,Kt)),pr.currentInstance&&(pr.currentInstance._destroy(),Pt()&&Qn()),pr.currentInstance=Vn;const dr=ou(Kt,Jt);iu(dr),Object.freeze(dr),pr.timeout&&(pr.timeout.stop(),delete pr.timeout),clearTimeout(pr.restoreFocusTimeout);const kr=au(Vn);return Ss(Vn,dr),$.innerParams.set(Vn,dr),su(Vn,kr,dr)}then(Kt){return $.promise.get(this).then(Kt)}finally(Kt){return $.promise.get(this).finally(Kt)}}const su=(Ht,Kt,Jt)=>new Promise((dr,kr)=>{const rn=wn=>{Ht.close({isDismissed:!0,dismiss:wn})};Zn.swalPromiseResolve.set(Ht,dr),Zn.swalPromiseReject.set(Ht,kr),Kt.confirmButton.onclick=()=>{ga(Ht)},Kt.denyButton.onclick=()=>{ba(Ht)},Kt.cancelButton.onclick=()=>{xa(Ht,rn)},Kt.closeButton.onclick=()=>{rn(qn.close)},yl(Ht,Kt,rn),Ks(Ht,pr,Jt,rn),Go(Ht,Jt),Xl(Jt),cu(pr,Jt,rn),lu(Kt,Jt),setTimeout(()=>{Kt.container.scrollTop=0})}),ou=(Ht,Kt)=>{const Jt=Ul(Ht),dr=Object.assign({},Un,Kt,Jt,Ht);return dr.showClass=Object.assign({},Un.showClass,dr.showClass),dr.hideClass=Object.assign({},Un.hideClass,dr.hideClass),dr},au=Ht=>{const Kt={popup:Rt(),container:St(),actions:Ct(),confirmButton:lt(),denyButton:bt(),cancelButton:pt(),loader:$t(),closeButton:dt(),validationMessage:yt(),progressSteps:It()};return $.domCache.set(Ht,Kt),Kt},cu=(Ht,Kt,Jt)=>{const dr=vt();nr(dr),Kt.timer&&(Ht.timeout=new Fl(()=>{Jt("timer"),delete Ht.timeout},Kt.timer),Kt.timerProgressBar&&(Qt(dr),Yt(dr,Kt,"timerProgressBar"),setTimeout(()=>{Ht.timeout&&Ht.timeout.running&&Xt(Kt.timer)})))},lu=(Ht,Kt)=>{if(!Kt.toast){if(!ht(Kt.allowEnterKey)){fu();return}uu(Ht,Kt)||ps(-1,1)}},uu=(Ht,Kt)=>Kt.focusDeny&&vr(Ht.denyButton)?(Ht.denyButton.focus(),!0):Kt.focusCancel&&vr(Ht.cancelButton)?(Ht.cancelButton.focus(),!0):Kt.focusConfirm&&vr(Ht.confirmButton)?(Ht.confirmButton.focus(),!0):!1,fu=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|xn--p1ai)$/)){const Ht=new Date,Kt=localStorage.getItem("swal-initiation");Kt?(Ht.getTime()-Date.parse(Kt))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const Jt=document.createElement("audio");Jt.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",Jt.loop=!0,document.body.appendChild(Jt),setTimeout(()=>{Jt.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${Ht}`)}Object.assign(ns.prototype,po),Object.assign(ns,Ll),Object.keys(po).forEach(Ht=>{ns[Ht]=function(){if(Vn)return Vn[Ht](...arguments)}}),ns.DismissReason=qn,ns.version="11.7.3";const Bs=ns;return Bs.default=Bs,Bs}),typeof commonjsGlobal<"u"&&commonjsGlobal.Sweetalert2&&(commonjsGlobal.swal=commonjsGlobal.sweetAlert=commonjsGlobal.Swal=commonjsGlobal.SweetAlert=commonjsGlobal.Sweetalert2),typeof document<"u"&&function($,j){var et=$.createElement("style");if($.getElementsByTagName("head")[0].appendChild(et),et.styleSheet)et.styleSheet.disabled||(et.styleSheet.cssText=j);else try{et.innerHTML=j}catch{et.innerText=j}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}.swal2-container{display:grid;position:fixed;z-index:1060;top:0;right:0;bottom:0;left:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:rgba(0,0,0,0) !important}.swal2-container.swal2-top-start,.swal2-container.swal2-center-start,.swal2-container.swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}.swal2-container.swal2-top,.swal2-container.swal2-center,.swal2-container.swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}.swal2-container.swal2-top-end,.swal2-container.swal2-center-end,.swal2-container.swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}.swal2-container.swal2-top-start>.swal2-popup{align-self:start}.swal2-container.swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}.swal2-container.swal2-top-end>.swal2-popup,.swal2-container.swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}.swal2-container.swal2-center-start>.swal2-popup,.swal2-container.swal2-center-left>.swal2-popup{grid-row:2;align-self:center}.swal2-container.swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}.swal2-container.swal2-center-end>.swal2-popup,.swal2-container.swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}.swal2-container.swal2-bottom-start>.swal2-popup,.swal2-container.swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}.swal2-container.swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}.swal2-container.swal2-bottom-end>.swal2-popup,.swal2-container.swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}.swal2-container.swal2-grow-row>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}.swal2-container.swal2-grow-column>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}.swal2-container.swal2-no-transition{transition:none !important}.swal2-popup{display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:none}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-title{position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}.swal2-styled{margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}.swal2-styled.swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}.swal2-styled.swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}.swal2-styled.swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}.swal2-styled.swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled:focus{outline:none}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:2em auto 1em}.swal2-close{z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:serif;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}.swal2-close:hover{transform:none;background:rgba(0,0,0,0);color:#f27474}.swal2-close:focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}.swal2-input,.swal2-file,.swal2-textarea,.swal2-select,.swal2-radio,.swal2-checkbox{margin:1em 2em 3px}.swal2-input,.swal2-file,.swal2-textarea{box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-input.swal2-inputerror,.swal2-file.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}.swal2-input:focus,.swal2-file:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}.swal2-input::placeholder,.swal2-file::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em 2em 3px;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-radio,.swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-radio label,.swal2-checkbox label{margin:0 .6em;font-size:1.125em}.swal2-radio input,.swal2-checkbox input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto 0}.swal2-validation-message{align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{top:0;right:auto;bottom:auto;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{top:0;right:0;bottom:auto;left:auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{top:0;right:auto;bottom:auto;left:0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{top:50%;right:auto;bottom:auto;left:0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{top:50%;right:auto;bottom:auto;left:50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{top:50%;right:0;bottom:auto;left:auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{top:auto;right:auto;bottom:0;left:0}body.swal2-toast-shown .swal2-container.swal2-bottom{top:auto;right:auto;bottom:0;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{top:auto;right:0;bottom:0;left:auto}')})(sweetalert2_all);const Swal=sweetalert2_allExports,mounts=[{key:"title",getter:_=>_.getTitle()},{key:"html",getter:_=>_.getHtmlContainer()},{key:"confirmButtonText",getter:_=>_.getConfirmButton()},{key:"denyButtonText",getter:_=>_.getDenyButton()},{key:"cancelButtonText",getter:_=>_.getCancelButton()},{key:"footer",getter:_=>_.getFooter()},{key:"closeButtonHtml",getter:_=>_.getCloseButton()},{key:"iconHtml",getter:_=>_.getIconContent()},{key:"loaderHtml",getter:_=>_.getLoader()}],noop=()=>{};function withReactContent(_){function o(et){const tt={},rt={},nt=mounts.map(it=>it.key);return Object.entries(et).forEach(it=>{let[st,ot]=it;nt.includes(st)&&React.isValidElement(ot)?(tt[st]=ot,rt[st]=" "):rt[st]=ot}),[tt,rt]}function $(et,tt){Object.entries(tt).forEach(rt=>{let[nt,it]=rt;const ot=mounts.find(ct=>ct.key===nt).getter(_),at=createRoot(ot);at.render(it),et.__roots.push(at)})}function j(et){et.__roots.forEach(tt=>{tt.unmount()}),et.__roots=[]}return class extends _{static argsToParams(et){if(React.isValidElement(et[0])||React.isValidElement(et[1])){const tt={};return["title","html","icon"].forEach((rt,nt)=>{et[nt]!==void 0&&(tt[rt]=et[nt])}),tt}else return _.argsToParams(et)}_main(et,tt){this.__roots=[],this.__params=Object.assign({},tt,et);const[rt,nt]=o(this.__params),it=nt.willOpen||noop,st=nt.didOpen||noop,ot=nt.didDestroy||noop;return super._main(Object.assign({},nt,{willOpen:at=>{$(this,rt),it(at)},didOpen:at=>{setTimeout(()=>{st(at)})},didDestroy:at=>{ot(at),j(this)}}))}update(et){Object.assign(this.__params,et),j(this);const[tt,rt]=o(this.__params);super.update(rt),$(this,tt)}}}const MySwal=withReactContent(Swal),confirmAlert=async({title:_="Are you sure?",text:o="You won't be able to revert this!",cancelLabel:$="Cancel",confirmLabel:j="Yes, delete it!",icon:et="question",isWarning:tt=!0,html:rt=!1,footer:nt=null,confirmButtonColor:it,cancelButtonColor:st})=>await MySwal.fire({title:_,text:o,html:rt?o:"",icon:et,showCancelButton:!0,confirmButtonColor:it,cancelButtonColor:st,cancelButtonText:$,confirmButtonText:j,focusCancel:!0,allowOutsideClick:!1,customClass:{container:"my-swal"},reverseButtons:!0,footer:nt||void 0}),showAlert=async({title:_="",text:o="",icon:$="success",allowOutsideClick:j=!1,allowEscapeKey:et=!1,html:tt=!1,confirmButtonColor:rt,cancelButtonColor:nt})=>await MySwal.fire({title:_,text:o,html:tt?o:"",icon:$==="none"?void 0:$,confirmButtonColor:rt,cancelButtonColor:nt,showCloseButton:!1,allowOutsideClick:j,allowEscapeKey:et,customClass:{container:"my-swal"}});Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:_=>{_.addEventListener("mouseenter",Swal.stopTimer),_.addEventListener("mouseleave",Swal.resumeTimer)}});const ShowLoading=async({title:_="",position:o="center",timer:$,timerProgressBar:j=!1})=>{let et=null;MySwal.fire({title:_,timer:$,timerProgressBar:!0,didOpen:()=>{MySwal.showLoading()},willClose:()=>{clearInterval(et)}})},StopLoading=()=>{MySwal&&MySwal.close()};function RegreshDataBases(){const _=useAppDbDispatch(),o=useAppLogDispatch();return jsx(Button,{variant:"outline",colorScheme:"pink",onClick:async()=>{try{ShowLoading({title:"Refreshing DataBases"});const et=(await getAllDatabases()).map(tt=>MapOrbitDbEntry(tt));_({type:"init",dbs:et}),o({type:"add",log:{text:"Refreshed DataBases",type:"synced"}}),StopLoading()}catch(j){StopLoading(),o({type:"add",log:{text:`Failed to refresh DataBases : ${(j==null?void 0:j.message)||"Something went wrong"}`,type:"error"}})}},children:"Refresh DataBases"})}function OpenDbDialog({onDbOpened:_}){const o=useToast(),{isOpen:$,onOpen:j,onClose:et}=useDisclosure(),[tt,rt]=useControllableState({defaultValue:""}),nt=reactExports.useRef(),it=useAppLogDispatch();return jsxs(Fragment,{children:[jsx(Button,{variant:"ghost",colorScheme:"pink",onClick:j,children:"Open Database"}),jsx(AlertDialog,{motionPreset:"slideInBottom",isOpen:$,leastDestructiveRef:nt,onClose:et,size:"xl",children:jsx(ModalOverlay,{children:jsxs(AlertDialogContent,{children:[jsx(ModalHeader,{fontSize:"lg",fontWeight:"bold",children:"Connect to Database"}),jsx(ModalCloseButton,{}),jsx(ModalBody,{children:jsx(Stack,{spacing:4,children:jsxs(FormControl,{id:"dbname",children:[jsx(FormLabel,{children:"Database Address"}),jsx(Input,{type:"text",placeholder:"Enter database address",value:tt,onChange:ot=>rt(ot.target.value)})]})})}),jsxs(ModalFooter,{children:[jsx(Button,{ref:nt,onClick:et,children:"Cancel"}),jsx(Button,{colorScheme:"pink",onClick:async()=>{try{if(!tt){o({position:"top",description:"Please enter database address",status:"error",isClosable:!0});return}const{hash:ot}=await addDatabase(tt);it({type:"add",log:{text:`Connected to database ${tt}`,type:"connected"}}),et(),_(ot)}catch(ot){it({type:"add",log:{text:`Failed to connect to database ${tt} : ${(ot==null?void 0:ot.message)||"Something went wrong"}`,type:"error"}})}},ml:3,children:"Connect"})]})]})})})]})}function toInteger(_){if(_===null||_===!0||_===!1)return NaN;var o=Number(_);return isNaN(o)?o:o<0?Math.ceil(o):Math.floor(o)}function requiredArgs(_,o){if(o.length<_)throw new TypeError(_+" argument"+(_>1?"s":"")+" required, but only "+o.length+" present")}function _typeof$1(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$1=function($){return typeof $}:_typeof$1=function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},_typeof$1(_)}function toDate(_){requiredArgs(1,arguments);var o=Object.prototype.toString.call(_);return _ instanceof Date||_typeof$1(_)==="object"&&o==="[object Date]"?new Date(_.getTime()):typeof _=="number"||o==="[object Number]"?new Date(_):((typeof _=="string"||o==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function addDays(_,o){requiredArgs(2,arguments);var $=toDate(_),j=toInteger(o);return isNaN(j)?new Date(NaN):(j&&$.setDate($.getDate()+j),$)}function addMilliseconds(_,o){requiredArgs(2,arguments);var $=toDate(_).getTime(),j=toInteger(o);return new Date($+j)}var defaultOptions={};function getDefaultOptions(){return defaultOptions}function startOfWeek(_,o){var $,j,et,tt,rt,nt,it,st;requiredArgs(1,arguments);var ot=getDefaultOptions(),at=toInteger(($=(j=(et=(tt=o==null?void 0:o.weekStartsOn)!==null&&tt!==void 0?tt:o==null||(rt=o.locale)===null||rt===void 0||(nt=rt.options)===null||nt===void 0?void 0:nt.weekStartsOn)!==null&&et!==void 0?et:ot.weekStartsOn)!==null&&j!==void 0?j:(it=ot.locale)===null||it===void 0||(st=it.options)===null||st===void 0?void 0:st.weekStartsOn)!==null&&$!==void 0?$:0);if(!(at>=0&&at<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var ct=toDate(_),ut=ct.getDay(),ft=(ut<at?7:0)+ut-at;return ct.setDate(ct.getDate()-ft),ct.setHours(0,0,0,0),ct}function getTimezoneOffsetInMilliseconds(_){var o=new Date(Date.UTC(_.getFullYear(),_.getMonth(),_.getDate(),_.getHours(),_.getMinutes(),_.getSeconds(),_.getMilliseconds()));return o.setUTCFullYear(_.getFullYear()),_.getTime()-o.getTime()}function startOfDay(_){requiredArgs(1,arguments);var o=toDate(_);return o.setHours(0,0,0,0),o}function isSameDay(_,o){requiredArgs(2,arguments);var $=startOfDay(_),j=startOfDay(o);return $.getTime()===j.getTime()}function _typeof(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function($){return typeof $}:_typeof=function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},_typeof(_)}function isDate(_){return requiredArgs(1,arguments),_ instanceof Date||_typeof(_)==="object"&&Object.prototype.toString.call(_)==="[object Date]"}function isValid(_){if(requiredArgs(1,arguments),!isDate(_)&&typeof _!="number")return!1;var o=toDate(_);return!isNaN(Number(o))}function subMilliseconds(_,o){requiredArgs(2,arguments);var $=toInteger(o);return addMilliseconds(_,-$)}var MILLISECONDS_IN_DAY=864e5;function getUTCDayOfYear(_){requiredArgs(1,arguments);var o=toDate(_),$=o.getTime();o.setUTCMonth(0,1),o.setUTCHours(0,0,0,0);var j=o.getTime(),et=$-j;return Math.floor(et/MILLISECONDS_IN_DAY)+1}function startOfUTCISOWeek(_){requiredArgs(1,arguments);var o=1,$=toDate(_),j=$.getUTCDay(),et=(j<o?7:0)+j-o;return $.setUTCDate($.getUTCDate()-et),$.setUTCHours(0,0,0,0),$}function getUTCISOWeekYear(_){requiredArgs(1,arguments);var o=toDate(_),$=o.getUTCFullYear(),j=new Date(0);j.setUTCFullYear($+1,0,4),j.setUTCHours(0,0,0,0);var et=startOfUTCISOWeek(j),tt=new Date(0);tt.setUTCFullYear($,0,4),tt.setUTCHours(0,0,0,0);var rt=startOfUTCISOWeek(tt);return o.getTime()>=et.getTime()?$+1:o.getTime()>=rt.getTime()?$:$-1}function startOfUTCISOWeekYear(_){requiredArgs(1,arguments);var o=getUTCISOWeekYear(_),$=new Date(0);$.setUTCFullYear(o,0,4),$.setUTCHours(0,0,0,0);var j=startOfUTCISOWeek($);return j}var MILLISECONDS_IN_WEEK$1=6048e5;function getUTCISOWeek(_){requiredArgs(1,arguments);var o=toDate(_),$=startOfUTCISOWeek(o).getTime()-startOfUTCISOWeekYear(o).getTime();return Math.round($/MILLISECONDS_IN_WEEK$1)+1}function startOfUTCWeek(_,o){var $,j,et,tt,rt,nt,it,st;requiredArgs(1,arguments);var ot=getDefaultOptions(),at=toInteger(($=(j=(et=(tt=o==null?void 0:o.weekStartsOn)!==null&&tt!==void 0?tt:o==null||(rt=o.locale)===null||rt===void 0||(nt=rt.options)===null||nt===void 0?void 0:nt.weekStartsOn)!==null&&et!==void 0?et:ot.weekStartsOn)!==null&&j!==void 0?j:(it=ot.locale)===null||it===void 0||(st=it.options)===null||st===void 0?void 0:st.weekStartsOn)!==null&&$!==void 0?$:0);if(!(at>=0&&at<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var ct=toDate(_),ut=ct.getUTCDay(),ft=(ut<at?7:0)+ut-at;return ct.setUTCDate(ct.getUTCDate()-ft),ct.setUTCHours(0,0,0,0),ct}function getUTCWeekYear(_,o){var $,j,et,tt,rt,nt,it,st;requiredArgs(1,arguments);var ot=toDate(_),at=ot.getUTCFullYear(),ct=getDefaultOptions(),ut=toInteger(($=(j=(et=(tt=o==null?void 0:o.firstWeekContainsDate)!==null&&tt!==void 0?tt:o==null||(rt=o.locale)===null||rt===void 0||(nt=rt.options)===null||nt===void 0?void 0:nt.firstWeekContainsDate)!==null&&et!==void 0?et:ct.firstWeekContainsDate)!==null&&j!==void 0?j:(it=ct.locale)===null||it===void 0||(st=it.options)===null||st===void 0?void 0:st.firstWeekContainsDate)!==null&&$!==void 0?$:1);if(!(ut>=1&&ut<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var ft=new Date(0);ft.setUTCFullYear(at+1,0,ut),ft.setUTCHours(0,0,0,0);var ht=startOfUTCWeek(ft,o),mt=new Date(0);mt.setUTCFullYear(at,0,ut),mt.setUTCHours(0,0,0,0);var gt=startOfUTCWeek(mt,o);return ot.getTime()>=ht.getTime()?at+1:ot.getTime()>=gt.getTime()?at:at-1}function startOfUTCWeekYear(_,o){var $,j,et,tt,rt,nt,it,st;requiredArgs(1,arguments);var ot=getDefaultOptions(),at=toInteger(($=(j=(et=(tt=o==null?void 0:o.firstWeekContainsDate)!==null&&tt!==void 0?tt:o==null||(rt=o.locale)===null||rt===void 0||(nt=rt.options)===null||nt===void 0?void 0:nt.firstWeekContainsDate)!==null&&et!==void 0?et:ot.firstWeekContainsDate)!==null&&j!==void 0?j:(it=ot.locale)===null||it===void 0||(st=it.options)===null||st===void 0?void 0:st.firstWeekContainsDate)!==null&&$!==void 0?$:1),ct=getUTCWeekYear(_,o),ut=new Date(0);ut.setUTCFullYear(ct,0,at),ut.setUTCHours(0,0,0,0);var ft=startOfUTCWeek(ut,o);return ft}var MILLISECONDS_IN_WEEK=6048e5;function getUTCWeek(_,o){requiredArgs(1,arguments);var $=toDate(_),j=startOfUTCWeek($,o).getTime()-startOfUTCWeekYear($,o).getTime();return Math.round(j/MILLISECONDS_IN_WEEK)+1}function addLeadingZeros(_,o){for(var $=_<0?"-":"",j=Math.abs(_).toString();j.length<o;)j="0"+j;return $+j}var formatters$2={y:function _(o,$){var j=o.getUTCFullYear(),et=j>0?j:1-j;return addLeadingZeros($==="yy"?et%100:et,$.length)},M:function _(o,$){var j=o.getUTCMonth();return $==="M"?String(j+1):addLeadingZeros(j+1,2)},d:function _(o,$){return addLeadingZeros(o.getUTCDate(),$.length)},a:function _(o,$){var j=o.getUTCHours()/12>=1?"pm":"am";switch($){case"a":case"aa":return j.toUpperCase();case"aaa":return j;case"aaaaa":return j[0];case"aaaa":default:return j==="am"?"a.m.":"p.m."}},h:function _(o,$){return addLeadingZeros(o.getUTCHours()%12||12,$.length)},H:function _(o,$){return addLeadingZeros(o.getUTCHours(),$.length)},m:function _(o,$){return addLeadingZeros(o.getUTCMinutes(),$.length)},s:function _(o,$){return addLeadingZeros(o.getUTCSeconds(),$.length)},S:function _(o,$){var j=$.length,et=o.getUTCMilliseconds(),tt=Math.floor(et*Math.pow(10,j-3));return addLeadingZeros(tt,$.length)}};const formatters$3=formatters$2;var dayPeriodEnum={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters={G:function _(o,$,j){var et=o.getUTCFullYear()>0?1:0;switch($){case"G":case"GG":case"GGG":return j.era(et,{width:"abbreviated"});case"GGGGG":return j.era(et,{width:"narrow"});case"GGGG":default:return j.era(et,{width:"wide"})}},y:function _(o,$,j){if($==="yo"){var et=o.getUTCFullYear(),tt=et>0?et:1-et;return j.ordinalNumber(tt,{unit:"year"})}return formatters$3.y(o,$)},Y:function _(o,$,j,et){var tt=getUTCWeekYear(o,et),rt=tt>0?tt:1-tt;if($==="YY"){var nt=rt%100;return addLeadingZeros(nt,2)}return $==="Yo"?j.ordinalNumber(rt,{unit:"year"}):addLeadingZeros(rt,$.length)},R:function _(o,$){var j=getUTCISOWeekYear(o);return addLeadingZeros(j,$.length)},u:function _(o,$){var j=o.getUTCFullYear();return addLeadingZeros(j,$.length)},Q:function _(o,$,j){var et=Math.ceil((o.getUTCMonth()+1)/3);switch($){case"Q":return String(et);case"QQ":return addLeadingZeros(et,2);case"Qo":return j.ordinalNumber(et,{unit:"quarter"});case"QQQ":return j.quarter(et,{width:"abbreviated",context:"formatting"});case"QQQQQ":return j.quarter(et,{width:"narrow",context:"formatting"});case"QQQQ":default:return j.quarter(et,{width:"wide",context:"formatting"})}},q:function _(o,$,j){var et=Math.ceil((o.getUTCMonth()+1)/3);switch($){case"q":return String(et);case"qq":return addLeadingZeros(et,2);case"qo":return j.ordinalNumber(et,{unit:"quarter"});case"qqq":return j.quarter(et,{width:"abbreviated",context:"standalone"});case"qqqqq":return j.quarter(et,{width:"narrow",context:"standalone"});case"qqqq":default:return j.quarter(et,{width:"wide",context:"standalone"})}},M:function _(o,$,j){var et=o.getUTCMonth();switch($){case"M":case"MM":return formatters$3.M(o,$);case"Mo":return j.ordinalNumber(et+1,{unit:"month"});case"MMM":return j.month(et,{width:"abbreviated",context:"formatting"});case"MMMMM":return j.month(et,{width:"narrow",context:"formatting"});case"MMMM":default:return j.month(et,{width:"wide",context:"formatting"})}},L:function _(o,$,j){var et=o.getUTCMonth();switch($){case"L":return String(et+1);case"LL":return addLeadingZeros(et+1,2);case"Lo":return j.ordinalNumber(et+1,{unit:"month"});case"LLL":return j.month(et,{width:"abbreviated",context:"standalone"});case"LLLLL":return j.month(et,{width:"narrow",context:"standalone"});case"LLLL":default:return j.month(et,{width:"wide",context:"standalone"})}},w:function _(o,$,j,et){var tt=getUTCWeek(o,et);return $==="wo"?j.ordinalNumber(tt,{unit:"week"}):addLeadingZeros(tt,$.length)},I:function _(o,$,j){var et=getUTCISOWeek(o);return $==="Io"?j.ordinalNumber(et,{unit:"week"}):addLeadingZeros(et,$.length)},d:function _(o,$,j){return $==="do"?j.ordinalNumber(o.getUTCDate(),{unit:"date"}):formatters$3.d(o,$)},D:function _(o,$,j){var et=getUTCDayOfYear(o);return $==="Do"?j.ordinalNumber(et,{unit:"dayOfYear"}):addLeadingZeros(et,$.length)},E:function _(o,$,j){var et=o.getUTCDay();switch($){case"E":case"EE":case"EEE":return j.day(et,{width:"abbreviated",context:"formatting"});case"EEEEE":return j.day(et,{width:"narrow",context:"formatting"});case"EEEEEE":return j.day(et,{width:"short",context:"formatting"});case"EEEE":default:return j.day(et,{width:"wide",context:"formatting"})}},e:function _(o,$,j,et){var tt=o.getUTCDay(),rt=(tt-et.weekStartsOn+8)%7||7;switch($){case"e":return String(rt);case"ee":return addLeadingZeros(rt,2);case"eo":return j.ordinalNumber(rt,{unit:"day"});case"eee":return j.day(tt,{width:"abbreviated",context:"formatting"});case"eeeee":return j.day(tt,{width:"narrow",context:"formatting"});case"eeeeee":return j.day(tt,{width:"short",context:"formatting"});case"eeee":default:return j.day(tt,{width:"wide",context:"formatting"})}},c:function _(o,$,j,et){var tt=o.getUTCDay(),rt=(tt-et.weekStartsOn+8)%7||7;switch($){case"c":return String(rt);case"cc":return addLeadingZeros(rt,$.length);case"co":return j.ordinalNumber(rt,{unit:"day"});case"ccc":return j.day(tt,{width:"abbreviated",context:"standalone"});case"ccccc":return j.day(tt,{width:"narrow",context:"standalone"});case"cccccc":return j.day(tt,{width:"short",context:"standalone"});case"cccc":default:return j.day(tt,{width:"wide",context:"standalone"})}},i:function _(o,$,j){var et=o.getUTCDay(),tt=et===0?7:et;switch($){case"i":return String(tt);case"ii":return addLeadingZeros(tt,$.length);case"io":return j.ordinalNumber(tt,{unit:"day"});case"iii":return j.day(et,{width:"abbreviated",context:"formatting"});case"iiiii":return j.day(et,{width:"narrow",context:"formatting"});case"iiiiii":return j.day(et,{width:"short",context:"formatting"});case"iiii":default:return j.day(et,{width:"wide",context:"formatting"})}},a:function _(o,$,j){var et=o.getUTCHours(),tt=et/12>=1?"pm":"am";switch($){case"a":case"aa":return j.dayPeriod(tt,{width:"abbreviated",context:"formatting"});case"aaa":return j.dayPeriod(tt,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return j.dayPeriod(tt,{width:"narrow",context:"formatting"});case"aaaa":default:return j.dayPeriod(tt,{width:"wide",context:"formatting"})}},b:function _(o,$,j){var et=o.getUTCHours(),tt;switch(et===12?tt=dayPeriodEnum.noon:et===0?tt=dayPeriodEnum.midnight:tt=et/12>=1?"pm":"am",$){case"b":case"bb":return j.dayPeriod(tt,{width:"abbreviated",context:"formatting"});case"bbb":return j.dayPeriod(tt,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return j.dayPeriod(tt,{width:"narrow",context:"formatting"});case"bbbb":default:return j.dayPeriod(tt,{width:"wide",context:"formatting"})}},B:function _(o,$,j){var et=o.getUTCHours(),tt;switch(et>=17?tt=dayPeriodEnum.evening:et>=12?tt=dayPeriodEnum.afternoon:et>=4?tt=dayPeriodEnum.morning:tt=dayPeriodEnum.night,$){case"B":case"BB":case"BBB":return j.dayPeriod(tt,{width:"abbreviated",context:"formatting"});case"BBBBB":return j.dayPeriod(tt,{width:"narrow",context:"formatting"});case"BBBB":default:return j.dayPeriod(tt,{width:"wide",context:"formatting"})}},h:function _(o,$,j){if($==="ho"){var et=o.getUTCHours()%12;return et===0&&(et=12),j.ordinalNumber(et,{unit:"hour"})}return formatters$3.h(o,$)},H:function _(o,$,j){return $==="Ho"?j.ordinalNumber(o.getUTCHours(),{unit:"hour"}):formatters$3.H(o,$)},K:function _(o,$,j){var et=o.getUTCHours()%12;return $==="Ko"?j.ordinalNumber(et,{unit:"hour"}):addLeadingZeros(et,$.length)},k:function _(o,$,j){var et=o.getUTCHours();return et===0&&(et=24),$==="ko"?j.ordinalNumber(et,{unit:"hour"}):addLeadingZeros(et,$.length)},m:function _(o,$,j){return $==="mo"?j.ordinalNumber(o.getUTCMinutes(),{unit:"minute"}):formatters$3.m(o,$)},s:function _(o,$,j){return $==="so"?j.ordinalNumber(o.getUTCSeconds(),{unit:"second"}):formatters$3.s(o,$)},S:function _(o,$){return formatters$3.S(o,$)},X:function _(o,$,j,et){var tt=et._originalDate||o,rt=tt.getTimezoneOffset();if(rt===0)return"Z";switch($){case"X":return formatTimezoneWithOptionalMinutes(rt);case"XXXX":case"XX":return formatTimezone(rt);case"XXXXX":case"XXX":default:return formatTimezone(rt,":")}},x:function _(o,$,j,et){var tt=et._originalDate||o,rt=tt.getTimezoneOffset();switch($){case"x":return formatTimezoneWithOptionalMinutes(rt);case"xxxx":case"xx":return formatTimezone(rt);case"xxxxx":case"xxx":default:return formatTimezone(rt,":")}},O:function _(o,$,j,et){var tt=et._originalDate||o,rt=tt.getTimezoneOffset();switch($){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(rt,":");case"OOOO":default:return"GMT"+formatTimezone(rt,":")}},z:function _(o,$,j,et){var tt=et._originalDate||o,rt=tt.getTimezoneOffset();switch($){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(rt,":");case"zzzz":default:return"GMT"+formatTimezone(rt,":")}},t:function _(o,$,j,et){var tt=et._originalDate||o,rt=Math.floor(tt.getTime()/1e3);return addLeadingZeros(rt,$.length)},T:function _(o,$,j,et){var tt=et._originalDate||o,rt=tt.getTime();return addLeadingZeros(rt,$.length)}};function formatTimezoneShort(_,o){var $=_>0?"-":"+",j=Math.abs(_),et=Math.floor(j/60),tt=j%60;if(tt===0)return $+String(et);var rt=o||"";return $+String(et)+rt+addLeadingZeros(tt,2)}function formatTimezoneWithOptionalMinutes(_,o){if(_%60===0){var $=_>0?"-":"+";return $+addLeadingZeros(Math.abs(_)/60,2)}return formatTimezone(_,o)}function formatTimezone(_,o){var $=o||"",j=_>0?"-":"+",et=Math.abs(_),tt=addLeadingZeros(Math.floor(et/60),2),rt=addLeadingZeros(et%60,2);return j+tt+$+rt}const formatters$1=formatters;var dateLongFormatter=function _(o,$){switch(o){case"P":return $.date({width:"short"});case"PP":return $.date({width:"medium"});case"PPP":return $.date({width:"long"});case"PPPP":default:return $.date({width:"full"})}},timeLongFormatter=function _(o,$){switch(o){case"p":return $.time({width:"short"});case"pp":return $.time({width:"medium"});case"ppp":return $.time({width:"long"});case"pppp":default:return $.time({width:"full"})}},dateTimeLongFormatter=function _(o,$){var j=o.match(/(P+)(p+)?/)||[],et=j[1],tt=j[2];if(!tt)return dateLongFormatter(o,$);var rt;switch(et){case"P":rt=$.dateTime({width:"short"});break;case"PP":rt=$.dateTime({width:"medium"});break;case"PPP":rt=$.dateTime({width:"long"});break;case"PPPP":default:rt=$.dateTime({width:"full"});break}return rt.replace("{{date}}",dateLongFormatter(et,$)).replace("{{time}}",timeLongFormatter(tt,$))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter};const longFormatters$1=longFormatters;var protectedDayOfYearTokens=["D","DD"],protectedWeekYearTokens=["YY","YYYY"];function isProtectedDayOfYearToken(_){return protectedDayOfYearTokens.indexOf(_)!==-1}function isProtectedWeekYearToken(_){return protectedWeekYearTokens.indexOf(_)!==-1}function throwProtectedError(_,o,$){if(_==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(o,"`) for formatting years to the input `").concat($,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(_==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(o,"`) for formatting years to the input `").concat($,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(_==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(o,"`) for formatting days of the month to the input `").concat($,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(_==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(o,"`) for formatting days of the month to the input `").concat($,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=function _(o,$,j){var et,tt=formatDistanceLocale[o];return typeof tt=="string"?et=tt:$===1?et=tt.one:et=tt.other.replace("{{count}}",$.toString()),j!=null&&j.addSuffix?j.comparison&&j.comparison>0?"in "+et:et+" ago":et};const formatDistance$1=formatDistance;function buildFormatLongFn(_){return function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$=o.width?String(o.width):_.defaultWidth,j=_.formats[$]||_.formats[_.defaultWidth];return j}}var dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})};const formatLong$1=formatLong;var formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=function _(o,$,j,et){return formatRelativeLocale[o]};const formatRelative$1=formatRelative;function buildLocalizeFn(_){return function(o,$){var j=$!=null&&$.context?String($.context):"standalone",et;if(j==="formatting"&&_.formattingValues){var tt=_.defaultFormattingWidth||_.defaultWidth,rt=$!=null&&$.width?String($.width):tt;et=_.formattingValues[rt]||_.formattingValues[tt]}else{var nt=_.defaultWidth,it=$!=null&&$.width?String($.width):_.defaultWidth;et=_.values[it]||_.values[nt]}var st=_.argumentCallback?_.argumentCallback(o):o;return et[st]}}var eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=function _(o,$){var j=Number(o),et=j%100;if(et>20||et<10)switch(et%10){case 1:return j+"st";case 2:return j+"nd";case 3:return j+"rd"}return j+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:function _(o){return o-1}}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};const localize$1=localize;function buildMatchFn(_){return function(o){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},j=$.width,et=j&&_.matchPatterns[j]||_.matchPatterns[_.defaultMatchWidth],tt=o.match(et);if(!tt)return null;var rt=tt[0],nt=j&&_.parsePatterns[j]||_.parsePatterns[_.defaultParseWidth],it=Array.isArray(nt)?findIndex(nt,function(at){return at.test(rt)}):findKey(nt,function(at){return at.test(rt)}),st;st=_.valueCallback?_.valueCallback(it):it,st=$.valueCallback?$.valueCallback(st):st;var ot=o.slice(rt.length);return{value:st,rest:ot}}}function findKey(_,o){for(var $ in _)if(_.hasOwnProperty($)&&o(_[$]))return $}function findIndex(_,o){for(var $=0;$<_.length;$++)if(o(_[$]))return $}function buildMatchPatternFn(_){return function(o){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},j=o.match(_.matchPattern);if(!j)return null;var et=j[0],tt=o.match(_.parsePattern);if(!tt)return null;var rt=_.valueCallback?_.valueCallback(tt[0]):tt[0];rt=$.valueCallback?$.valueCallback(rt):rt;var nt=o.slice(et.length);return{value:rt,rest:nt}}}var matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:function _(o){return parseInt(o,10)}}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:function _(o){return o+1}}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})};const match$1=match;var locale={code:"en-US",formatDistance:formatDistance$1,formatLong:formatLong$1,formatRelative:formatRelative$1,localize:localize$1,match:match$1,options:{weekStartsOn:0,firstWeekContainsDate:1}};const enUS=locale;var formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(_,o,$){var j,et,tt,rt,nt,it,st,ot,at,ct,ut,ft,ht,mt,gt,Et,St,At;requiredArgs(2,arguments);var kt=String(o),Rt=getDefaultOptions(),Tt=(j=(et=$==null?void 0:$.locale)!==null&&et!==void 0?et:Rt.locale)!==null&&j!==void 0?j:enUS,Dt=toInteger((tt=(rt=(nt=(it=$==null?void 0:$.firstWeekContainsDate)!==null&&it!==void 0?it:$==null||(st=$.locale)===null||st===void 0||(ot=st.options)===null||ot===void 0?void 0:ot.firstWeekContainsDate)!==null&&nt!==void 0?nt:Rt.firstWeekContainsDate)!==null&&rt!==void 0?rt:(at=Rt.locale)===null||at===void 0||(ct=at.options)===null||ct===void 0?void 0:ct.firstWeekContainsDate)!==null&&tt!==void 0?tt:1);if(!(Dt>=1&&Dt<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Ot=toInteger((ut=(ft=(ht=(mt=$==null?void 0:$.weekStartsOn)!==null&&mt!==void 0?mt:$==null||(gt=$.locale)===null||gt===void 0||(Et=gt.options)===null||Et===void 0?void 0:Et.weekStartsOn)!==null&&ht!==void 0?ht:Rt.weekStartsOn)!==null&&ft!==void 0?ft:(St=Rt.locale)===null||St===void 0||(At=St.options)===null||At===void 0?void 0:At.weekStartsOn)!==null&&ut!==void 0?ut:0);if(!(Ot>=0&&Ot<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!Tt.localize)throw new RangeError("locale must contain localize property");if(!Tt.formatLong)throw new RangeError("locale must contain formatLong property");var jt=toDate(_);if(!isValid(jt))throw new RangeError("Invalid time value");var Nt=getTimezoneOffsetInMilliseconds(jt),It=subMilliseconds(jt,Nt),yt={firstWeekContainsDate:Dt,weekStartsOn:Ot,locale:Tt,_originalDate:jt},lt=kt.match(longFormattingTokensRegExp).map(function(pt){var bt=pt[0];if(bt==="p"||bt==="P"){var _t=longFormatters$1[bt];return _t(pt,Tt.formatLong)}return pt}).join("").match(formattingTokensRegExp).map(function(pt){if(pt==="''")return"'";var bt=pt[0];if(bt==="'")return cleanEscapedString(pt);var _t=formatters$1[bt];if(_t)return!($!=null&&$.useAdditionalWeekYearTokens)&&isProtectedWeekYearToken(pt)&&throwProtectedError(pt,o,String(_)),!($!=null&&$.useAdditionalDayOfYearTokens)&&isProtectedDayOfYearToken(pt)&&throwProtectedError(pt,o,String(_)),_t(It,pt,Tt.localize,yt);if(bt.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+bt+"`");return pt}).join("");return lt}function cleanEscapedString(_){var o=_.match(escapedStringRegExp);return o?o[1].replace(doubleQuoteRegExp,"'"):_}function isSameWeek(_,o,$){requiredArgs(2,arguments);var j=startOfWeek(_,$),et=startOfWeek(o,$);return j.getTime()===et.getTime()}function isSameYear(_,o){requiredArgs(2,arguments);var $=toDate(_),j=toDate(o);return $.getFullYear()===j.getFullYear()}function isToday(_){return requiredArgs(1,arguments),isSameDay(_,Date.now())}function subDays(_,o){requiredArgs(2,arguments);var $=toInteger(o);return addDays(_,-$)}function isYesterday(_){return requiredArgs(1,arguments),isSameDay(_,subDays(Date.now(),1))}const DateFormat=(_,o="dd/MM/yyyy")=>isValid(_)?format(_,o,{weekStartsOn:1,locale:enUS}):"";function ShortDateDividerHelper(_,o=!1){try{if(!_)return"invalid";const $=new Date(_);if(!isValid($))return"";const j=new Date,et="hh:mm aaaa",tt=o?` ${et}`:"";return isToday($)?DateFormat($,et):isYesterday($)?"Yesterday "+(o?DateFormat($,et):""):isSameWeek($,j)?DateFormat($,"EEEE"+tt):isSameYear($,j)?DateFormat($,"MMM dd"+tt):DateFormat($,"MM/dd/yyyy"+tt)}catch{return"error"}}function DataTable({rows:_,keyField:o,columns:$,caption:j={title:"",placement:"top",show:!0}}){const et=useColorModeValue("gray.100","gray.800"),tt=useColorModeValue("gray.300","gray.600"),rt=useColorModeValue("white","gray.700");return jsx(TableContainer,{children:jsxs(Table,{variant:"simple",colorScheme:"blackAlpha",children:[j.show&&jsx(TableCaption,{placement:j.placement,children:j.title}),jsx(Thead,{bg:et,borderColor:tt,borderWidth:"thin",borderStyle:"solid",children:jsx(Tr,{children:$.map(nt=>jsx(Th,{children:nt.headerNode||nt.name},nt.name))})}),jsx(Tbody,{children:_.map((nt,it)=>jsx(Tr,{bg:rt,children:$.map(st=>jsxs(Td,{children:[st.type==="node"&&(st.renderRowNode?st.renderRowNode(nt):nt[st.selector]),st.type==="string"&&nt[st.selector],st.type==="number"&&nt[st.selector],st.type==="date"&&(nt[st.selector]?ShortDateDividerHelper(nt[st.selector],!0):""),st.type==="boolean"&&(nt[st.selector]?"Yes":"No")]},`${nt[o]}_${st.name}`))},nt[o]))})]})})}const colorSchema={feed:"green",eventlog:"blue",keyvalue:"purple",counter:"orange",docstore:"teal",none:"yellow"},getColumns=({onDelete:_,onOpen:o})=>[{name:"settings",selector:"",type:"node",headerNode:jsx(ViewIcon,{boxSize:5}),renderRowNode:j=>jsx(IconButton,{icon:jsx(SettingsIcon,{color:"black.500",boxSize:5}),"aria-label":"settings",size:"sm",onClick:()=>o==null?void 0:o(j)})},{name:"Name",selector:"name",type:"string"},{name:"Type",selector:"type",type:"node",renderRowNode:j=>jsx(Badge,{variant:"subtle",colorScheme:colorSchema[j.type]||"yellow",children:j.type})},{name:"Address",selector:"address",type:"string"},{name:"Date",selector:"date",type:"date"},{name:"delete",selector:"",type:"node",headerNode:jsx(DeleteIcon,{color:"black.500",boxSize:5}),renderRowNode:j=>jsx(IconButton,{icon:jsx(CloseIcon,{color:"red.500",boxSize:4}),"aria-label":"delete",size:"sm",onClick:()=>_==null?void 0:_(j)})}];function DataBaseList({dbs:_=[]}){const o=useNavigate(),$=reactExports.useCallback(tt=>{},[]),j=reactExports.useCallback(tt=>{let rt="";switch(tt.type){case"feed":rt=PATH.DB.FEED.replace(":id",tt.multiHash).replace(":name",tt.name);break;case"eventlog":rt=PATH.DB.EVENTLOG.replace(":id",tt.multiHash).replace(":name",tt.name);break;case"keyvalue":rt=PATH.DB.KEYVALUE.replace(":id",tt.multiHash).replace(":name",tt.name);break;case"counter":rt=PATH.DB.COUNTER.replace(":id",tt.multiHash).replace(":name",tt.name);break;case"docstore":case"docs":rt=PATH.DB.DOCSTORE.replace(":id",tt.multiHash).replace(":name",tt.name);break}rt&&o(rt)},[o]),et=reactExports.useMemo(()=>getColumns({onDelete:$,onOpen:j}),[$,j]);return jsx(DataTable,{keyField:"multiHash",rows:_,columns:et,caption:{show:!1}})}const HomePage=()=>{const{dbs:_}=useAppDb(),o=_.map($=>{const j=MapOrbitDbEntry($);return{id:j.id,multiHash:j.hash,name:j.payload.value.name,address:j.payload.value.address,date:new Date(j.payload.value.added),type:j.payload.value.type}});return jsx(Box,{id:"home-page",children:jsxs(Stack,{spacing:4,children:[jsx(Text,{as:"b",children:"DATABASES:"}),jsxs(Stack,{direction:["column","row"],children:[jsx(CreateDbDialog,{}),jsx(RegreshDataBases,{}),jsx(OpenDbDialog,{onDbOpened:()=>{}})]}),jsx(Stack,{children:jsx(DataBaseList,{dbs:o})})]})})},NotFoundPage=reactExports.lazy(()=>__vitePreload(()=>import("./404-6565b6bf.js"),[])),CounterDbPage=reactExports.lazy(()=>__vitePreload(()=>import("./index-7b4d4f12.js"),["assets/index-7b4d4f12.js","assets/DbHeader-8252df35.js"])),DocumentDbPage=reactExports.lazy(()=>__vitePreload(()=>import("./index-b6039f28.js"),["assets/index-b6039f28.js","assets/DbHeader-8252df35.js","assets/DeleteEntryButton-8c1c613d.js","assets/ShowPayload-71f75581.js","assets/Virtuoso-46c58dc7.js"])),EventLogDbPage=reactExports.lazy(()=>__vitePreload(()=>import("./index-7d5847e7.js"),["assets/index-7d5847e7.js","assets/DbHeader-8252df35.js","assets/ShowPayload-71f75581.js","assets/Virtuoso-46c58dc7.js"])),FeedDbPage=reactExports.lazy(()=>__vitePreload(()=>import("./index-33df0689.js"),["assets/index-33df0689.js","assets/DbHeader-8252df35.js","assets/DeleteEntryButton-8c1c613d.js","assets/ShowPayload-71f75581.js","assets/Virtuoso-46c58dc7.js"])),KeyValueDbPage=reactExports.lazy(()=>__vitePreload(()=>import("./index-da032400.js"),["assets/index-da032400.js","assets/DbHeader-8252df35.js","assets/ShowPayload-71f75581.js"])),PATH={HOME:"/",ABOUT:"/about",BLOG:"/blog",DB:{COUNTER:"/db/counter/:id/:name",DOCSTORE:"/db/document/:id/:name",EVENTLOG:"/db/eventlog/:id/:name",FEED:"/db/feed/:id/:name",KEYVALUE:"/db/keyvalue/:id/:name"}},routes=[{path:PATH.HOME,index:!0,element:jsx(HomePage,{})},{path:PATH.DB.COUNTER,index:!0,element:jsx(CounterDbPage,{})},{path:PATH.DB.DOCSTORE,index:!0,element:jsx(DocumentDbPage,{})},{path:PATH.DB.EVENTLOG,index:!0,element:jsx(EventLogDbPage,{})},{path:PATH.DB.FEED,index:!0,element:jsx(FeedDbPage,{})},{path:PATH.DB.KEYVALUE,index:!0,element:jsx(KeyValueDbPage,{})},{path:"*",index:!0,element:jsx(NotFoundPage,{})}],App=()=>{const _=useAppDbDispatch(),o=reactExports.useCallback(async()=>{const j=(await getAllDatabases()).map(et=>MapOrbitDbEntry(et));_({type:"init",dbs:j})},[_]);return reactExports.useEffect(()=>{o()},[o]),jsx(reactExports.Suspense,{fallback:jsx("p",{children:"Loading..."}),children:jsx(HeaderLayout,{children:useRoutes(routes)})})},theme=extendTheme({config:{cssVarPrefix:"obc"},colors:{transparent:"transparent",black:"#171923",white:"#F7FAFC"},background:{primary:"#171923",secondary:"#F7FAFC"}});client.createRoot(document.getElementById("root")).render(jsx(React.StrictMode,{children:jsx(ChakraProvider,{theme,children:jsx(AppLogProvider,{children:jsx(AppDbProvider,{children:jsx(BrowserRouter,{children:jsx(App,{})})})})})}));export{ModalCloseButton as $,useSafeLayoutEffect$2 as A,Button as B,useUpdateEffect as C,dataAttr as D,callAllHandlers$1 as E,Fragment as F,mergeRefs as G,Heading as H,Input as I,keyframes$2 as J,forwardRef as K,useMultiStyleConfig as L,omitThemingProps as M,callAll as N,cx as O,getValidChildren as P,compact as Q,useStyleConfig as R,Stack as S,Text as T,useFormControl as U,useDisclosure as V,prettyJson as W,AlertDialog as X,ModalOverlay as Y,AlertDialogContent as Z,ModalHeader as _,jsx as a,ModalBody as a0,ModalFooter as a1,confirmAlert as a2,IconButton as a3,DeleteIcon as a4,Table as a5,Thead as a6,TableCaption as a7,TableContainer as a8,Tbody as a9,React as aa,ReactDOM as ab,ViewIcon as ac,createStylesContext as ad,createIcon as ae,useNavigate as af,PATH as ag,Badge as ah,colorSchema as ai,useAppDb as b,useAppLogDispatch as c,addEntry as d,useToast as e,fetchEntries as f,Spacer as g,removeEntry as h,isValidJson as i,jsxs as j,Td as k,HStack as l,useColorModeValue as m,Tr as n,Th as o,useIsMounted as p,ShowLoading as q,reactExports as r,showAlert as s,StopLoading as t,useParams as u,fetchEntry as v,createContext$1 as w,chakra as x,useFormControlProps as y,useCallbackRef$2 as z};
